{"tables" : [{"name" : "documents", "columns" : [{"name" : "id", "type" : "uuid", "nullable" : "NO"}, {"name" : "owner_id", "type" : "uuid", "nullable" : "NO"}, {"name" : "title", "type" : "text", "nullable" : "YES"}, {"name" : "content", "type" : "bytea", "nullable" : "YES"}, {"name" : "updated_at", "type" : "timestamp with time zone", "nullable" : "YES"}, {"name" : "created_at", "type" : "timestamp with time zone", "nullable" : "YES"}, {"name" : "is_public", "type" : "boolean", "nullable" : "YES"}, {"name" : "public_permission", "type" : "text", "nullable" : "YES"}], "rls_enabled" : true, "policies" : [{"name" : "Allow Create", "command" : "INSERT", "roles" : ["public"], "using" : null, "check" : "(auth.uid() = owner_id)"}, {"name" : "Allow Delete", "command" : "DELETE", "roles" : ["public"], "using" : "(auth.uid() = owner_id)", "check" : null}, {"name" : "Allow Read Access", "command" : "SELECT", "roles" : ["public"], "using" : "((auth.uid() = owner_id) OR (is_public = true) OR (EXISTS ( SELECT 1\n   FROM document_permissions\n  WHERE ((document_permissions.document_id = documents.id) AND (document_permissions.user_email = (auth.jwt() ->> 'email'::text))))))", "check" : null}, {"name" : "Allow Update (Owner Only)", "command" : "UPDATE", "roles" : ["public"], "using" : "(auth.uid() = owner_id)", "check" : "(auth.uid() = owner_id)"}]}, {"name" : "document_permissions", "columns" : [{"name" : "id", "type" : "bigint", "nullable" : "NO"}, {"name" : "document_id", "type" : "uuid", "nullable" : "NO"}, {"name" : "user_email", "type" : "text", "nullable" : "NO"}, {"name" : "permission_level", "type" : "text", "nullable" : "NO"}, {"name" : "created_at", "type" : "timestamp with time zone", "nullable" : "YES"}], "rls_enabled" : true, "policies" : [{"name" : "Owners manage permissions", "command" : "ALL", "roles" : ["public"], "using" : "is_document_owner(document_id)", "check" : null}, {"name" : "Users see own permissions", "command" : "SELECT", "roles" : ["public"], "using" : "(user_email = (auth.jwt() ->> 'email'::text))", "check" : null}]}]}