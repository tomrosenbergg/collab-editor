(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();var wh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $D(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Qp={exports:{}},Ba={};var $1;function PD(){if($1)return Ba;$1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,l){var a=null;if(l!==void 0&&(a=""+l),s.key!==void 0&&(a=""+s.key),"key"in s){l={};for(var u in s)u!=="key"&&(l[u]=s[u])}else l=s;return s=l.ref,{$$typeof:n,type:i,key:a,ref:s!==void 0?s:null,props:l}}return Ba.Fragment=e,Ba.jsx=t,Ba.jsxs=t,Ba}var P1;function GD(){return P1||(P1=1,Qp.exports=PD()),Qp.exports}var Te=GD(),Zp={exports:{}},be={};var G1;function KD(){if(G1)return be;G1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),a=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),b=Symbol.iterator;function v(T){return T===null||typeof T!="object"?null:(T=b&&T[b]||T["@@iterator"],typeof T=="function"?T:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,k={};function A(T,H,W){this.props=T,this.context=H,this.refs=k,this.updater=W||S}A.prototype.isReactComponent={},A.prototype.setState=function(T,H){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,H,"setState")},A.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function M(){}M.prototype=A.prototype;function O(T,H,W){this.props=T,this.context=H,this.refs=k,this.updater=W||S}var z=O.prototype=new M;z.constructor=O,_(z,A.prototype),z.isPureReactComponent=!0;var q=Array.isArray;function V(){}var j={H:null,A:null,T:null,S:null},ee=Object.prototype.hasOwnProperty;function se(T,H,W){var Q=W.ref;return{$$typeof:n,type:T,key:H,ref:Q!==void 0?Q:null,props:W}}function Me(T,H){return se(T.type,H,T.props)}function he(T){return typeof T=="object"&&T!==null&&T.$$typeof===n}function te(T){var H={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(W){return H[W]})}var oe=/\/+/g;function fe(T,H){return typeof T=="object"&&T!==null&&T.key!=null?te(""+T.key):H.toString(36)}function ye(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(V,V):(T.status="pending",T.then(function(H){T.status==="pending"&&(T.status="fulfilled",T.value=H)},function(H){T.status==="pending"&&(T.status="rejected",T.reason=H)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function B(T,H,W,Q,ge){var ve=typeof T;(ve==="undefined"||ve==="boolean")&&(T=null);var Ue=!1;if(T===null)Ue=!0;else switch(ve){case"bigint":case"string":case"number":Ue=!0;break;case"object":switch(T.$$typeof){case n:case e:Ue=!0;break;case g:return Ue=T._init,B(Ue(T._payload),H,W,Q,ge)}}if(Ue)return ge=ge(T),Ue=Q===""?"."+fe(T,0):Q,q(ge)?(W="",Ue!=null&&(W=Ue.replace(oe,"$&/")+"/"),B(ge,H,W,"",function(Vo){return Vo})):ge!=null&&(he(ge)&&(ge=Me(ge,W+(ge.key==null||T&&T.key===ge.key?"":(""+ge.key).replace(oe,"$&/")+"/")+Ue)),H.push(ge)),1;Ue=0;var Qt=Q===""?".":Q+":";if(q(T))for(var ct=0;ct<T.length;ct++)Q=T[ct],ve=Qt+fe(Q,ct),Ue+=B(Q,H,W,ve,ge);else if(ct=v(T),typeof ct=="function")for(T=ct.call(T),ct=0;!(Q=T.next()).done;)Q=Q.value,ve=Qt+fe(Q,ct++),Ue+=B(Q,H,W,ve,ge);else if(ve==="object"){if(typeof T.then=="function")return B(ye(T),H,W,Q,ge);throw H=String(T),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return Ue}function K(T,H,W){if(T==null)return T;var Q=[],ge=0;return B(T,Q,"","",function(ve){return H.call(W,ve,ge++)}),Q}function re(T){if(T._status===-1){var H=T._result;H=H(),H.then(function(W){(T._status===0||T._status===-1)&&(T._status=1,T._result=W)},function(W){(T._status===0||T._status===-1)&&(T._status=2,T._result=W)}),T._status===-1&&(T._status=0,T._result=H)}if(T._status===1)return T._result.default;throw T._result}var me=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)},Ae={map:K,forEach:function(T,H,W){K(T,function(){H.apply(this,arguments)},W)},count:function(T){var H=0;return K(T,function(){H++}),H},toArray:function(T){return K(T,function(H){return H})||[]},only:function(T){if(!he(T))throw Error("React.Children.only expected to receive a single React element child.");return T}};return be.Activity=m,be.Children=Ae,be.Component=A,be.Fragment=t,be.Profiler=s,be.PureComponent=O,be.StrictMode=i,be.Suspense=h,be.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,be.__COMPILER_RUNTIME={__proto__:null,c:function(T){return j.H.useMemoCache(T)}},be.cache=function(T){return function(){return T.apply(null,arguments)}},be.cacheSignal=function(){return null},be.cloneElement=function(T,H,W){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var Q=_({},T.props),ge=T.key;if(H!=null)for(ve in H.key!==void 0&&(ge=""+H.key),H)!ee.call(H,ve)||ve==="key"||ve==="__self"||ve==="__source"||ve==="ref"&&H.ref===void 0||(Q[ve]=H[ve]);var ve=arguments.length-2;if(ve===1)Q.children=W;else if(1<ve){for(var Ue=Array(ve),Qt=0;Qt<ve;Qt++)Ue[Qt]=arguments[Qt+2];Q.children=Ue}return se(T.type,ge,Q)},be.createContext=function(T){return T={$$typeof:a,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:l,_context:T},T},be.createElement=function(T,H,W){var Q,ge={},ve=null;if(H!=null)for(Q in H.key!==void 0&&(ve=""+H.key),H)ee.call(H,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(ge[Q]=H[Q]);var Ue=arguments.length-2;if(Ue===1)ge.children=W;else if(1<Ue){for(var Qt=Array(Ue),ct=0;ct<Ue;ct++)Qt[ct]=arguments[ct+2];ge.children=Qt}if(T&&T.defaultProps)for(Q in Ue=T.defaultProps,Ue)ge[Q]===void 0&&(ge[Q]=Ue[Q]);return se(T,ve,ge)},be.createRef=function(){return{current:null}},be.forwardRef=function(T){return{$$typeof:u,render:T}},be.isValidElement=he,be.lazy=function(T){return{$$typeof:g,_payload:{_status:-1,_result:T},_init:re}},be.memo=function(T,H){return{$$typeof:d,type:T,compare:H===void 0?null:H}},be.startTransition=function(T){var H=j.T,W={};j.T=W;try{var Q=T(),ge=j.S;ge!==null&&ge(W,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(V,me)}catch(ve){me(ve)}finally{H!==null&&W.types!==null&&(H.types=W.types),j.T=H}},be.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},be.use=function(T){return j.H.use(T)},be.useActionState=function(T,H,W){return j.H.useActionState(T,H,W)},be.useCallback=function(T,H){return j.H.useCallback(T,H)},be.useContext=function(T){return j.H.useContext(T)},be.useDebugValue=function(){},be.useDeferredValue=function(T,H){return j.H.useDeferredValue(T,H)},be.useEffect=function(T,H){return j.H.useEffect(T,H)},be.useEffectEvent=function(T){return j.H.useEffectEvent(T)},be.useId=function(){return j.H.useId()},be.useImperativeHandle=function(T,H,W){return j.H.useImperativeHandle(T,H,W)},be.useInsertionEffect=function(T,H){return j.H.useInsertionEffect(T,H)},be.useLayoutEffect=function(T,H){return j.H.useLayoutEffect(T,H)},be.useMemo=function(T,H){return j.H.useMemo(T,H)},be.useOptimistic=function(T,H){return j.H.useOptimistic(T,H)},be.useReducer=function(T,H,W){return j.H.useReducer(T,H,W)},be.useRef=function(T){return j.H.useRef(T)},be.useState=function(T){return j.H.useState(T)},be.useSyncExternalStore=function(T,H,W){return j.H.useSyncExternalStore(T,H,W)},be.useTransition=function(){return j.H.useTransition()},be.version="19.2.4",be}var K1;function Ey(){return K1||(K1=1,Zp.exports=KD()),Zp.exports}var gt=Ey(),em={exports:{}},Ua={},tm={exports:{}},nm={};var W1;function WD(){return W1||(W1=1,(function(n){function e(B,K){var re=B.length;B.push(K);e:for(;0<re;){var me=re-1>>>1,Ae=B[me];if(0<s(Ae,K))B[me]=K,B[re]=Ae,re=me;else break e}}function t(B){return B.length===0?null:B[0]}function i(B){if(B.length===0)return null;var K=B[0],re=B.pop();if(re!==K){B[0]=re;e:for(var me=0,Ae=B.length,T=Ae>>>1;me<T;){var H=2*(me+1)-1,W=B[H],Q=H+1,ge=B[Q];if(0>s(W,re))Q<Ae&&0>s(ge,W)?(B[me]=ge,B[Q]=re,me=Q):(B[me]=W,B[H]=re,me=H);else if(Q<Ae&&0>s(ge,re))B[me]=ge,B[Q]=re,me=Q;else break e}}return K}function s(B,K){var re=B.sortIndex-K.sortIndex;return re!==0?re:B.id-K.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var a=Date,u=a.now();n.unstable_now=function(){return a.now()-u}}var h=[],d=[],g=1,m=null,b=3,v=!1,S=!1,_=!1,k=!1,A=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function z(B){for(var K=t(d);K!==null;){if(K.callback===null)i(d);else if(K.startTime<=B)i(d),K.sortIndex=K.expirationTime,e(h,K);else break;K=t(d)}}function q(B){if(_=!1,z(B),!S)if(t(h)!==null)S=!0,V||(V=!0,te());else{var K=t(d);K!==null&&ye(q,K.startTime-B)}}var V=!1,j=-1,ee=5,se=-1;function Me(){return k?!0:!(n.unstable_now()-se<ee)}function he(){if(k=!1,V){var B=n.unstable_now();se=B;var K=!0;try{e:{S=!1,_&&(_=!1,M(j),j=-1),v=!0;var re=b;try{t:{for(z(B),m=t(h);m!==null&&!(m.expirationTime>B&&Me());){var me=m.callback;if(typeof me=="function"){m.callback=null,b=m.priorityLevel;var Ae=me(m.expirationTime<=B);if(B=n.unstable_now(),typeof Ae=="function"){m.callback=Ae,z(B),K=!0;break t}m===t(h)&&i(h),z(B)}else i(h);m=t(h)}if(m!==null)K=!0;else{var T=t(d);T!==null&&ye(q,T.startTime-B),K=!1}}break e}finally{m=null,b=re,v=!1}K=void 0}}finally{K?te():V=!1}}}var te;if(typeof O=="function")te=function(){O(he)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,fe=oe.port2;oe.port1.onmessage=he,te=function(){fe.postMessage(null)}}else te=function(){A(he,0)};function ye(B,K){j=A(function(){B(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(B){switch(b){case 1:case 2:case 3:var K=3;break;default:K=b}var re=b;b=K;try{return B()}finally{b=re}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(B,K){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var re=b;b=B;try{return K()}finally{b=re}},n.unstable_scheduleCallback=function(B,K,re){var me=n.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?me+re:me):re=me,B){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=re+Ae,B={id:g++,callback:K,priorityLevel:B,startTime:re,expirationTime:Ae,sortIndex:-1},re>me?(B.sortIndex=re,e(d,B),t(h)===null&&B===t(d)&&(_?(M(j),j=-1):_=!0,ye(q,re-me))):(B.sortIndex=Ae,e(h,B),S||v||(S=!0,V||(V=!0,te()))),B},n.unstable_shouldYield=Me,n.unstable_wrapCallback=function(B){var K=b;return function(){var re=b;b=K;try{return B.apply(this,arguments)}finally{b=re}}}})(nm)),nm}var Y1;function YD(){return Y1||(Y1=1,tm.exports=WD()),tm.exports}var im={exports:{}},Wt={};var F1;function FD(){if(F1)return Wt;F1=1;var n=Ey();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(h,d,g){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:m==null?null:""+m,children:h,containerInfo:d,implementation:g}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Wt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Wt.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return l(h,d,null,g)},Wt.flushSync=function(h){var d=a.T,g=i.p;try{if(a.T=null,i.p=2,h)return h()}finally{a.T=d,i.p=g,i.d.f()}},Wt.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(h,d))},Wt.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},Wt.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,m=u(g,d.crossOrigin),b=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?i.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:m,integrity:b,fetchPriority:v}):g==="script"&&i.d.X(h,{crossOrigin:m,integrity:b,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Wt.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);i.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(h)},Wt.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,m=u(g,d.crossOrigin);i.d.L(h,g,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Wt.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);i.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(h)},Wt.requestFormReset=function(h){i.d.r(h)},Wt.unstable_batchedUpdates=function(h,d){return h(d)},Wt.useFormState=function(h,d,g){return a.H.useFormState(h,d,g)},Wt.useFormStatus=function(){return a.H.useHostTransitionStatus()},Wt.version="19.2.4",Wt}var J1;function JD(){if(J1)return im.exports;J1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),im.exports=FD(),im.exports}var X1;function XD(){if(X1)return Ua;X1=1;var n=YD(),e=Ey(),t=JD();function i(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var o=r,c=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(c=o.return),r=o.return;while(r)}return o.tag===3?c:null}function a(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function u(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function h(r){if(l(r)!==r)throw Error(i(188))}function d(r){var o=r.alternate;if(!o){if(o=l(r),o===null)throw Error(i(188));return o!==r?null:r}for(var c=r,f=o;;){var p=c.return;if(p===null)break;var y=p.alternate;if(y===null){if(f=p.return,f!==null){c=f;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===c)return h(p),r;if(y===f)return h(p),o;y=y.sibling}throw Error(i(188))}if(c.return!==f.return)c=p,f=y;else{for(var w=!1,x=p.child;x;){if(x===c){w=!0,c=p,f=y;break}if(x===f){w=!0,f=p,c=y;break}x=x.sibling}if(!w){for(x=y.child;x;){if(x===c){w=!0,c=y,f=p;break}if(x===f){w=!0,f=y,c=p;break}x=x.sibling}if(!w)throw Error(i(189))}}if(c.alternate!==f)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?r:o}function g(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=g(r),o!==null)return o;r=r.sibling}return null}var m=Object.assign,b=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),O=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),se=Symbol.for("react.activity"),Me=Symbol.for("react.memo_cache_sentinel"),he=Symbol.iterator;function te(r){return r===null||typeof r!="object"?null:(r=he&&r[he]||r["@@iterator"],typeof r=="function"?r:null)}var oe=Symbol.for("react.client.reference");function fe(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===oe?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case _:return"Fragment";case A:return"Profiler";case k:return"StrictMode";case q:return"Suspense";case V:return"SuspenseList";case se:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case S:return"Portal";case O:return r.displayName||"Context";case M:return(r._context.displayName||"Context")+".Consumer";case z:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case j:return o=r.displayName||null,o!==null?o:fe(r.type)||"Memo";case ee:o=r._payload,r=r._init;try{return fe(r(o))}catch{}}return null}var ye=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},me=[],Ae=-1;function T(r){return{current:r}}function H(r){0>Ae||(r.current=me[Ae],me[Ae]=null,Ae--)}function W(r,o){Ae++,me[Ae]=r.current,r.current=o}var Q=T(null),ge=T(null),ve=T(null),Ue=T(null);function Qt(r,o){switch(W(ve,o),W(ge,r),W(Q,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?f1(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=f1(o),r=d1(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}H(Q),W(Q,r)}function ct(){H(Q),H(ge),H(ve)}function Vo(r){r.memoizedState!==null&&W(Ue,r);var o=Q.current,c=d1(o,r.type);o!==c&&(W(ge,r),W(Q,c))}function nu(r){ge.current===r&&(H(Q),H(ge)),Ue.current===r&&(H(Ue),Ma._currentValue=re)}var Nd,Vb;function ar(r){if(Nd===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);Nd=o&&o[1]||"",Vb=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Nd+r+Vb}var Bd=!1;function Ud(r,o){if(!r||Bd)return"";Bd=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var G=function(){throw Error()};if(Object.defineProperty(G.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(G,[])}catch(U){var N=U}Reflect.construct(r,[],G)}else{try{G.call()}catch(U){N=U}r.call(G.prototype)}}else{try{throw Error()}catch(U){N=U}(G=r())&&typeof G.catch=="function"&&G.catch(function(){})}}catch(U){if(U&&N&&typeof U.stack=="string")return[U.stack,N.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=f.DetermineComponentFrameRoot(),w=y[0],x=y[1];if(w&&x){var C=w.split(`
`),L=x.split(`
`);for(p=f=0;f<C.length&&!C[f].includes("DetermineComponentFrameRoot");)f++;for(;p<L.length&&!L[p].includes("DetermineComponentFrameRoot");)p++;if(f===C.length||p===L.length)for(f=C.length-1,p=L.length-1;1<=f&&0<=p&&C[f]!==L[p];)p--;for(;1<=f&&0<=p;f--,p--)if(C[f]!==L[p]){if(f!==1||p!==1)do if(f--,p--,0>p||C[f]!==L[p]){var I=`
`+C[f].replace(" at new "," at ");return r.displayName&&I.includes("<anonymous>")&&(I=I.replace("<anonymous>",r.displayName)),I}while(1<=f&&0<=p);break}}}finally{Bd=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?ar(c):""}function wO(r,o){switch(r.tag){case 26:case 27:case 5:return ar(r.type);case 16:return ar("Lazy");case 13:return r.child!==o&&o!==null?ar("Suspense Fallback"):ar("Suspense");case 19:return ar("SuspenseList");case 0:case 15:return Ud(r.type,!1);case 11:return Ud(r.type.render,!1);case 1:return Ud(r.type,!0);case 31:return ar("Activity");default:return""}}function $b(r){try{var o="",c=null;do o+=wO(r,c),c=r,r=r.return;while(r);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var jd=Object.prototype.hasOwnProperty,zd=n.unstable_scheduleCallback,Id=n.unstable_cancelCallback,SO=n.unstable_shouldYield,_O=n.unstable_requestPaint,vn=n.unstable_now,xO=n.unstable_getCurrentPriorityLevel,Pb=n.unstable_ImmediatePriority,Gb=n.unstable_UserBlockingPriority,iu=n.unstable_NormalPriority,kO=n.unstable_LowPriority,Kb=n.unstable_IdlePriority,AO=n.log,CO=n.unstable_setDisableYieldValue,$o=null,wn=null;function bs(r){if(typeof AO=="function"&&CO(r),wn&&typeof wn.setStrictMode=="function")try{wn.setStrictMode($o,r)}catch{}}var Sn=Math.clz32?Math.clz32:OO,TO=Math.log,EO=Math.LN2;function OO(r){return r>>>=0,r===0?32:31-(TO(r)/EO|0)|0}var su=256,ru=262144,lu=4194304;function cr(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ou(r,o,c){var f=r.pendingLanes;if(f===0)return 0;var p=0,y=r.suspendedLanes,w=r.pingedLanes;r=r.warmLanes;var x=f&134217727;return x!==0?(f=x&~y,f!==0?p=cr(f):(w&=x,w!==0?p=cr(w):c||(c=x&~r,c!==0&&(p=cr(c))))):(x=f&~y,x!==0?p=cr(x):w!==0?p=cr(w):c||(c=f&~r,c!==0&&(p=cr(c)))),p===0?0:o!==0&&o!==p&&(o&y)===0&&(y=p&-p,c=o&-o,y>=c||y===32&&(c&4194048)!==0)?o:p}function Po(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function DO(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wb(){var r=lu;return lu<<=1,(lu&62914560)===0&&(lu=4194304),r}function Hd(r){for(var o=[],c=0;31>c;c++)o.push(r);return o}function Go(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function MO(r,o,c,f,p,y){var w=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var x=r.entanglements,C=r.expirationTimes,L=r.hiddenUpdates;for(c=w&~c;0<c;){var I=31-Sn(c),G=1<<I;x[I]=0,C[I]=-1;var N=L[I];if(N!==null)for(L[I]=null,I=0;I<N.length;I++){var U=N[I];U!==null&&(U.lane&=-536870913)}c&=~G}f!==0&&Yb(r,f,0),y!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=y&~(w&~o))}function Yb(r,o,c){r.pendingLanes|=o,r.suspendedLanes&=~o;var f=31-Sn(o);r.entangledLanes|=o,r.entanglements[f]=r.entanglements[f]|1073741824|c&261930}function Fb(r,o){var c=r.entangledLanes|=o;for(r=r.entanglements;c;){var f=31-Sn(c),p=1<<f;p&o|r[f]&o&&(r[f]|=o),c&=~p}}function Jb(r,o){var c=o&-o;return c=(c&42)!==0?1:qd(c),(c&(r.suspendedLanes|o))!==0?0:c}function qd(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Vd(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Xb(){var r=K.p;return r!==0?r:(r=window.event,r===void 0?32:U1(r.type))}function Qb(r,o){var c=K.p;try{return K.p=r,o()}finally{K.p=c}}var vs=Math.random().toString(36).slice(2),Bt="__reactFiber$"+vs,rn="__reactProps$"+vs,il="__reactContainer$"+vs,$d="__reactEvents$"+vs,RO="__reactListeners$"+vs,LO="__reactHandles$"+vs,Zb="__reactResources$"+vs,Ko="__reactMarker$"+vs;function Pd(r){delete r[Bt],delete r[rn],delete r[$d],delete r[RO],delete r[LO]}function sl(r){var o=r[Bt];if(o)return o;for(var c=r.parentNode;c;){if(o=c[il]||c[Bt]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(r=w1(r);r!==null;){if(c=r[Bt])return c;r=w1(r)}return o}r=c,c=r.parentNode}return null}function rl(r){if(r=r[Bt]||r[il]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function Wo(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(i(33))}function ll(r){var o=r[Zb];return o||(o=r[Zb]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Ot(r){r[Ko]=!0}var ev=new Set,tv={};function ur(r,o){ol(r,o),ol(r+"Capture",o)}function ol(r,o){for(tv[r]=o,r=0;r<o.length;r++)ev.add(o[r])}var NO=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),nv={},iv={};function BO(r){return jd.call(iv,r)?!0:jd.call(nv,r)?!1:NO.test(r)?iv[r]=!0:(nv[r]=!0,!1)}function au(r,o,c){if(BO(o))if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+c)}}function cu(r,o,c){if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+c)}}function $i(r,o,c,f){if(f===null)r.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(o,c,""+f)}}function In(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function sv(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function UO(r,o,c){var f=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var p=f.get,y=f.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return p.call(this)},set:function(w){c=""+w,y.call(this,w)}}),Object.defineProperty(r,o,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(w){c=""+w},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Gd(r){if(!r._valueTracker){var o=sv(r)?"checked":"value";r._valueTracker=UO(r,o,""+r[o])}}function rv(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var c=o.getValue(),f="";return r&&(f=sv(r)?r.checked?"true":"false":r.value),r=f,r!==c?(o.setValue(r),!0):!1}function uu(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var jO=/[\n"\\]/g;function Hn(r){return r.replace(jO,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Kd(r,o,c,f,p,y,w,x){r.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.type=w:r.removeAttribute("type"),o!=null?w==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+In(o)):r.value!==""+In(o)&&(r.value=""+In(o)):w!=="submit"&&w!=="reset"||r.removeAttribute("value"),o!=null?Wd(r,w,In(o)):c!=null?Wd(r,w,In(c)):f!=null&&r.removeAttribute("value"),p==null&&y!=null&&(r.defaultChecked=!!y),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?r.name=""+In(x):r.removeAttribute("name")}function lv(r,o,c,f,p,y,w,x){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),o!=null||c!=null){if(!(y!=="submit"&&y!=="reset"||o!=null)){Gd(r);return}c=c!=null?""+In(c):"",o=o!=null?""+In(o):c,x||o===r.value||(r.value=o),r.defaultValue=o}f=f??p,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=x?r.checked:!!f,r.defaultChecked=!!f,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(r.name=w),Gd(r)}function Wd(r,o,c){o==="number"&&uu(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function al(r,o,c,f){if(r=r.options,o){o={};for(var p=0;p<c.length;p++)o["$"+c[p]]=!0;for(c=0;c<r.length;c++)p=o.hasOwnProperty("$"+r[c].value),r[c].selected!==p&&(r[c].selected=p),p&&f&&(r[c].defaultSelected=!0)}else{for(c=""+In(c),o=null,p=0;p<r.length;p++){if(r[p].value===c){r[p].selected=!0,f&&(r[p].defaultSelected=!0);return}o!==null||r[p].disabled||(o=r[p])}o!==null&&(o.selected=!0)}}function ov(r,o,c){if(o!=null&&(o=""+In(o),o!==r.value&&(r.value=o),c==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=c!=null?""+In(c):""}function av(r,o,c,f){if(o==null){if(f!=null){if(c!=null)throw Error(i(92));if(ye(f)){if(1<f.length)throw Error(i(93));f=f[0]}c=f}c==null&&(c=""),o=c}c=In(o),r.defaultValue=c,f=r.textContent,f===c&&f!==""&&f!==null&&(r.value=f),Gd(r)}function cl(r,o){if(o){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=o;return}}r.textContent=o}var zO=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cv(r,o,c){var f=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":f?r.setProperty(o,c):typeof c!="number"||c===0||zO.has(o)?o==="float"?r.cssFloat=c:r[o]=(""+c).trim():r[o]=c+"px"}function uv(r,o,c){if(o!=null&&typeof o!="object")throw Error(i(62));if(r=r.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var p in o)f=o[p],o.hasOwnProperty(p)&&c[p]!==f&&cv(r,p,f)}else for(var y in o)o.hasOwnProperty(y)&&cv(r,y,o[y])}function Yd(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var IO=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),HO=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function hu(r){return HO.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Pi(){}var Fd=null;function Jd(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ul=null,hl=null;function hv(r){var o=rl(r);if(o&&(r=o.stateNode)){var c=r[rn]||null;e:switch(r=o.stateNode,o.type){case"input":if(Kd(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Hn(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var f=c[o];if(f!==r&&f.form===r.form){var p=f[rn]||null;if(!p)throw Error(i(90));Kd(f,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(o=0;o<c.length;o++)f=c[o],f.form===r.form&&rv(f)}break e;case"textarea":ov(r,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&al(r,!!c.multiple,o,!1)}}}var Xd=!1;function fv(r,o,c){if(Xd)return r(o,c);Xd=!0;try{var f=r(o);return f}finally{if(Xd=!1,(ul!==null||hl!==null)&&(Qu(),ul&&(o=ul,r=hl,hl=ul=null,hv(o),r)))for(o=0;o<r.length;o++)hv(r[o])}}function Yo(r,o){var c=r.stateNode;if(c===null)return null;var f=c[rn]||null;if(f===null)return null;c=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(i(231,o,typeof c));return c}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qd=!1;if(Gi)try{var Fo={};Object.defineProperty(Fo,"passive",{get:function(){Qd=!0}}),window.addEventListener("test",Fo,Fo),window.removeEventListener("test",Fo,Fo)}catch{Qd=!1}var ws=null,Zd=null,fu=null;function dv(){if(fu)return fu;var r,o=Zd,c=o.length,f,p="value"in ws?ws.value:ws.textContent,y=p.length;for(r=0;r<c&&o[r]===p[r];r++);var w=c-r;for(f=1;f<=w&&o[c-f]===p[y-f];f++);return fu=p.slice(r,1<f?1-f:void 0)}function du(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function gu(){return!0}function gv(){return!1}function ln(r){function o(c,f,p,y,w){this._reactName=c,this._targetInst=p,this.type=f,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var x in r)r.hasOwnProperty(x)&&(c=r[x],this[x]=c?c(y):y[x]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?gu:gv,this.isPropagationStopped=gv,this}return m(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=gu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=gu)},persist:function(){},isPersistent:gu}),o}var hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pu=ln(hr),Jo=m({},hr,{view:0,detail:0}),qO=ln(Jo),eg,tg,Xo,mu=m({},Jo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ig,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Xo&&(Xo&&r.type==="mousemove"?(eg=r.screenX-Xo.screenX,tg=r.screenY-Xo.screenY):tg=eg=0,Xo=r),eg)},movementY:function(r){return"movementY"in r?r.movementY:tg}}),pv=ln(mu),VO=m({},mu,{dataTransfer:0}),$O=ln(VO),PO=m({},Jo,{relatedTarget:0}),ng=ln(PO),GO=m({},hr,{animationName:0,elapsedTime:0,pseudoElement:0}),KO=ln(GO),WO=m({},hr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),YO=ln(WO),FO=m({},hr,{data:0}),mv=ln(FO),JO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},XO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZO(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=QO[r])?!!o[r]:!1}function ig(){return ZO}var e2=m({},Jo,{key:function(r){if(r.key){var o=JO[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=du(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?XO[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ig,charCode:function(r){return r.type==="keypress"?du(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?du(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),t2=ln(e2),n2=m({},mu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yv=ln(n2),i2=m({},Jo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ig}),s2=ln(i2),r2=m({},hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),l2=ln(r2),o2=m({},mu,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),a2=ln(o2),c2=m({},hr,{newState:0,oldState:0}),u2=ln(c2),h2=[9,13,27,32],sg=Gi&&"CompositionEvent"in window,Qo=null;Gi&&"documentMode"in document&&(Qo=document.documentMode);var f2=Gi&&"TextEvent"in window&&!Qo,bv=Gi&&(!sg||Qo&&8<Qo&&11>=Qo),vv=" ",wv=!1;function Sv(r,o){switch(r){case"keyup":return h2.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _v(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var fl=!1;function d2(r,o){switch(r){case"compositionend":return _v(o);case"keypress":return o.which!==32?null:(wv=!0,vv);case"textInput":return r=o.data,r===vv&&wv?null:r;default:return null}}function g2(r,o){if(fl)return r==="compositionend"||!sg&&Sv(r,o)?(r=dv(),fu=Zd=ws=null,fl=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return bv&&o.locale!=="ko"?null:o.data;default:return null}}var p2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xv(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!p2[r.type]:o==="textarea"}function kv(r,o,c,f){ul?hl?hl.push(f):hl=[f]:ul=f,o=rh(o,"onChange"),0<o.length&&(c=new pu("onChange","change",null,c,f),r.push({event:c,listeners:o}))}var Zo=null,ea=null;function m2(r){l1(r,0)}function yu(r){var o=Wo(r);if(rv(o))return r}function Av(r,o){if(r==="change")return o}var Cv=!1;if(Gi){var rg;if(Gi){var lg="oninput"in document;if(!lg){var Tv=document.createElement("div");Tv.setAttribute("oninput","return;"),lg=typeof Tv.oninput=="function"}rg=lg}else rg=!1;Cv=rg&&(!document.documentMode||9<document.documentMode)}function Ev(){Zo&&(Zo.detachEvent("onpropertychange",Ov),ea=Zo=null)}function Ov(r){if(r.propertyName==="value"&&yu(ea)){var o=[];kv(o,ea,r,Jd(r)),fv(m2,o)}}function y2(r,o,c){r==="focusin"?(Ev(),Zo=o,ea=c,Zo.attachEvent("onpropertychange",Ov)):r==="focusout"&&Ev()}function b2(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return yu(ea)}function v2(r,o){if(r==="click")return yu(o)}function w2(r,o){if(r==="input"||r==="change")return yu(o)}function S2(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var _n=typeof Object.is=="function"?Object.is:S2;function ta(r,o){if(_n(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var c=Object.keys(r),f=Object.keys(o);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var p=c[f];if(!jd.call(o,p)||!_n(r[p],o[p]))return!1}return!0}function Dv(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Mv(r,o){var c=Dv(r);r=0;for(var f;c;){if(c.nodeType===3){if(f=r+c.textContent.length,r<=o&&f>=o)return{node:c,offset:o-r};r=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Dv(c)}}function Rv(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?Rv(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Lv(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=uu(r.document);o instanceof r.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)r=o.contentWindow;else break;o=uu(r.document)}return o}function og(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var _2=Gi&&"documentMode"in document&&11>=document.documentMode,dl=null,ag=null,na=null,cg=!1;function Nv(r,o,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;cg||dl==null||dl!==uu(f)||(f=dl,"selectionStart"in f&&og(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),na&&ta(na,f)||(na=f,f=rh(ag,"onSelect"),0<f.length&&(o=new pu("onSelect","select",null,o,c),r.push({event:o,listeners:f}),o.target=dl)))}function fr(r,o){var c={};return c[r.toLowerCase()]=o.toLowerCase(),c["Webkit"+r]="webkit"+o,c["Moz"+r]="moz"+o,c}var gl={animationend:fr("Animation","AnimationEnd"),animationiteration:fr("Animation","AnimationIteration"),animationstart:fr("Animation","AnimationStart"),transitionrun:fr("Transition","TransitionRun"),transitionstart:fr("Transition","TransitionStart"),transitioncancel:fr("Transition","TransitionCancel"),transitionend:fr("Transition","TransitionEnd")},ug={},Bv={};Gi&&(Bv=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function dr(r){if(ug[r])return ug[r];if(!gl[r])return r;var o=gl[r],c;for(c in o)if(o.hasOwnProperty(c)&&c in Bv)return ug[r]=o[c];return r}var Uv=dr("animationend"),jv=dr("animationiteration"),zv=dr("animationstart"),x2=dr("transitionrun"),k2=dr("transitionstart"),A2=dr("transitioncancel"),Iv=dr("transitionend"),Hv=new Map,hg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hg.push("scrollEnd");function ri(r,o){Hv.set(r,o),ur(o,[r])}var bu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},qn=[],pl=0,fg=0;function vu(){for(var r=pl,o=fg=pl=0;o<r;){var c=qn[o];qn[o++]=null;var f=qn[o];qn[o++]=null;var p=qn[o];qn[o++]=null;var y=qn[o];if(qn[o++]=null,f!==null&&p!==null){var w=f.pending;w===null?p.next=p:(p.next=w.next,w.next=p),f.pending=p}y!==0&&qv(c,p,y)}}function wu(r,o,c,f){qn[pl++]=r,qn[pl++]=o,qn[pl++]=c,qn[pl++]=f,fg|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function dg(r,o,c,f){return wu(r,o,c,f),Su(r)}function gr(r,o){return wu(r,null,null,o),Su(r)}function qv(r,o,c){r.lanes|=c;var f=r.alternate;f!==null&&(f.lanes|=c);for(var p=!1,y=r.return;y!==null;)y.childLanes|=c,f=y.alternate,f!==null&&(f.childLanes|=c),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(p=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,p&&o!==null&&(p=31-Sn(c),r=y.hiddenUpdates,f=r[p],f===null?r[p]=[o]:f.push(o),o.lane=c|536870912),y):null}function Su(r){if(50<ka)throw ka=0,_p=null,Error(i(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var ml={};function C2(r,o,c,f){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(r,o,c,f){return new C2(r,o,c,f)}function gg(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ki(r,o){var c=r.alternate;return c===null?(c=xn(r.tag,o,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=o,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,o=r.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function Vv(r,o){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,o=c.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function _u(r,o,c,f,p,y){var w=0;if(f=r,typeof r=="function")gg(r)&&(w=1);else if(typeof r=="string")w=MD(r,c,Q.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case se:return r=xn(31,c,o,p),r.elementType=se,r.lanes=y,r;case _:return pr(c.children,p,y,o);case k:w=8,p|=24;break;case A:return r=xn(12,c,o,p|2),r.elementType=A,r.lanes=y,r;case q:return r=xn(13,c,o,p),r.elementType=q,r.lanes=y,r;case V:return r=xn(19,c,o,p),r.elementType=V,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case O:w=10;break e;case M:w=9;break e;case z:w=11;break e;case j:w=14;break e;case ee:w=16,f=null;break e}w=29,c=Error(i(130,r===null?"null":typeof r,"")),f=null}return o=xn(w,c,o,p),o.elementType=r,o.type=f,o.lanes=y,o}function pr(r,o,c,f){return r=xn(7,r,f,o),r.lanes=c,r}function pg(r,o,c){return r=xn(6,r,null,o),r.lanes=c,r}function $v(r){var o=xn(18,null,null,0);return o.stateNode=r,o}function mg(r,o,c){return o=xn(4,r.children!==null?r.children:[],r.key,o),o.lanes=c,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var Pv=new WeakMap;function Vn(r,o){if(typeof r=="object"&&r!==null){var c=Pv.get(r);return c!==void 0?c:(o={value:r,source:o,stack:$b(o)},Pv.set(r,o),o)}return{value:r,source:o,stack:$b(o)}}var yl=[],bl=0,xu=null,ia=0,$n=[],Pn=0,Ss=null,wi=1,Si="";function Wi(r,o){yl[bl++]=ia,yl[bl++]=xu,xu=r,ia=o}function Gv(r,o,c){$n[Pn++]=wi,$n[Pn++]=Si,$n[Pn++]=Ss,Ss=r;var f=wi;r=Si;var p=32-Sn(f)-1;f&=~(1<<p),c+=1;var y=32-Sn(o)+p;if(30<y){var w=p-p%5;y=(f&(1<<w)-1).toString(32),f>>=w,p-=w,wi=1<<32-Sn(o)+p|c<<p|f,Si=y+r}else wi=1<<y|c<<p|f,Si=r}function yg(r){r.return!==null&&(Wi(r,1),Gv(r,1,0))}function bg(r){for(;r===xu;)xu=yl[--bl],yl[bl]=null,ia=yl[--bl],yl[bl]=null;for(;r===Ss;)Ss=$n[--Pn],$n[Pn]=null,Si=$n[--Pn],$n[Pn]=null,wi=$n[--Pn],$n[Pn]=null}function Kv(r,o){$n[Pn++]=wi,$n[Pn++]=Si,$n[Pn++]=Ss,wi=o.id,Si=o.overflow,Ss=r}var Ut=null,tt=null,Ne=!1,_s=null,Gn=!1,vg=Error(i(519));function xs(r){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw sa(Vn(o,r)),vg}function Wv(r){var o=r.stateNode,c=r.type,f=r.memoizedProps;switch(o[Bt]=r,o[rn]=f,c){case"dialog":De("cancel",o),De("close",o);break;case"iframe":case"object":case"embed":De("load",o);break;case"video":case"audio":for(c=0;c<Ca.length;c++)De(Ca[c],o);break;case"source":De("error",o);break;case"img":case"image":case"link":De("error",o),De("load",o);break;case"details":De("toggle",o);break;case"input":De("invalid",o),lv(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":De("invalid",o);break;case"textarea":De("invalid",o),av(o,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||f.suppressHydrationWarning===!0||u1(o.textContent,c)?(f.popover!=null&&(De("beforetoggle",o),De("toggle",o)),f.onScroll!=null&&De("scroll",o),f.onScrollEnd!=null&&De("scrollend",o),f.onClick!=null&&(o.onclick=Pi),o=!0):o=!1,o||xs(r,!0)}function Yv(r){for(Ut=r.return;Ut;)switch(Ut.tag){case 5:case 31:case 13:Gn=!1;return;case 27:case 3:Gn=!0;return;default:Ut=Ut.return}}function vl(r){if(r!==Ut)return!1;if(!Ne)return Yv(r),Ne=!0,!1;var o=r.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||jp(r.type,r.memoizedProps)),c=!c),c&&tt&&xs(r),Yv(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));tt=v1(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));tt=v1(r)}else o===27?(o=tt,js(r.type)?(r=Vp,Vp=null,tt=r):tt=o):tt=Ut?Wn(r.stateNode.nextSibling):null;return!0}function mr(){tt=Ut=null,Ne=!1}function wg(){var r=_s;return r!==null&&(un===null?un=r:un.push.apply(un,r),_s=null),r}function sa(r){_s===null?_s=[r]:_s.push(r)}var Sg=T(null),yr=null,Yi=null;function ks(r,o,c){W(Sg,o._currentValue),o._currentValue=c}function Fi(r){r._currentValue=Sg.current,H(Sg)}function _g(r,o,c){for(;r!==null;){var f=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),r===c)break;r=r.return}}function xg(r,o,c,f){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var y=p.dependencies;if(y!==null){var w=p.child;y=y.firstContext;e:for(;y!==null;){var x=y;y=p;for(var C=0;C<o.length;C++)if(x.context===o[C]){y.lanes|=c,x=y.alternate,x!==null&&(x.lanes|=c),_g(y.return,c,r),f||(w=null);break e}y=x.next}}else if(p.tag===18){if(w=p.return,w===null)throw Error(i(341));w.lanes|=c,y=w.alternate,y!==null&&(y.lanes|=c),_g(w,c,r),w=null}else w=p.child;if(w!==null)w.return=p;else for(w=p;w!==null;){if(w===r){w=null;break}if(p=w.sibling,p!==null){p.return=w.return,w=p;break}w=w.return}p=w}}function wl(r,o,c,f){r=null;for(var p=o,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var w=p.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var x=p.type;_n(p.pendingProps.value,w.value)||(r!==null?r.push(x):r=[x])}}else if(p===Ue.current){if(w=p.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(Ma):r=[Ma])}p=p.return}r!==null&&xg(o,r,c,f),o.flags|=262144}function ku(r){for(r=r.firstContext;r!==null;){if(!_n(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function br(r){yr=r,Yi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function jt(r){return Fv(yr,r)}function Au(r,o){return yr===null&&br(r),Fv(r,o)}function Fv(r,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},Yi===null){if(r===null)throw Error(i(308));Yi=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else Yi=Yi.next=o;return c}var T2=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(c,f){r.push(f)}};this.abort=function(){o.aborted=!0,r.forEach(function(c){return c()})}},E2=n.unstable_scheduleCallback,O2=n.unstable_NormalPriority,mt={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function kg(){return{controller:new T2,data:new Map,refCount:0}}function ra(r){r.refCount--,r.refCount===0&&E2(O2,function(){r.controller.abort()})}var la=null,Ag=0,Sl=0,_l=null;function D2(r,o){if(la===null){var c=la=[];Ag=0,Sl=Ep(),_l={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Ag++,o.then(Jv,Jv),o}function Jv(){if(--Ag===0&&la!==null){_l!==null&&(_l.status="fulfilled");var r=la;la=null,Sl=0,_l=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function M2(r,o){var c=[],f={status:"pending",value:null,reason:null,then:function(p){c.push(p)}};return r.then(function(){f.status="fulfilled",f.value=o;for(var p=0;p<c.length;p++)(0,c[p])(o)},function(p){for(f.status="rejected",f.reason=p,p=0;p<c.length;p++)(0,c[p])(void 0)}),f}var Xv=B.S;B.S=function(r,o){NS=vn(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&D2(r,o),Xv!==null&&Xv(r,o)};var vr=T(null);function Cg(){var r=vr.current;return r!==null?r:Ye.pooledCache}function Cu(r,o){o===null?W(vr,vr.current):W(vr,o.pool)}function Qv(){var r=Cg();return r===null?null:{parent:mt._currentValue,pool:r}}var xl=Error(i(460)),Tg=Error(i(474)),Tu=Error(i(542)),Eu={then:function(){}};function Zv(r){return r=r.status,r==="fulfilled"||r==="rejected"}function ew(r,o,c){switch(c=r[c],c===void 0?r.push(o):c!==o&&(o.then(Pi,Pi),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,nw(r),r;default:if(typeof o.status=="string")o.then(Pi,Pi);else{if(r=Ye,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=o,r.status="pending",r.then(function(f){if(o.status==="pending"){var p=o;p.status="fulfilled",p.value=f}},function(f){if(o.status==="pending"){var p=o;p.status="rejected",p.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,nw(r),r}throw Sr=o,xl}}function wr(r){try{var o=r._init;return o(r._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Sr=c,xl):c}}var Sr=null;function tw(){if(Sr===null)throw Error(i(459));var r=Sr;return Sr=null,r}function nw(r){if(r===xl||r===Tu)throw Error(i(483))}var kl=null,oa=0;function Ou(r){var o=oa;return oa+=1,kl===null&&(kl=[]),ew(kl,r,o)}function aa(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Du(r,o){throw o.$$typeof===b?Error(i(525)):(r=Object.prototype.toString.call(o),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function iw(r){function o(D,E){if(r){var R=D.deletions;R===null?(D.deletions=[E],D.flags|=16):R.push(E)}}function c(D,E){if(!r)return null;for(;E!==null;)o(D,E),E=E.sibling;return null}function f(D){for(var E=new Map;D!==null;)D.key!==null?E.set(D.key,D):E.set(D.index,D),D=D.sibling;return E}function p(D,E){return D=Ki(D,E),D.index=0,D.sibling=null,D}function y(D,E,R){return D.index=R,r?(R=D.alternate,R!==null?(R=R.index,R<E?(D.flags|=67108866,E):R):(D.flags|=67108866,E)):(D.flags|=1048576,E)}function w(D){return r&&D.alternate===null&&(D.flags|=67108866),D}function x(D,E,R,$){return E===null||E.tag!==6?(E=pg(R,D.mode,$),E.return=D,E):(E=p(E,R),E.return=D,E)}function C(D,E,R,$){var ce=R.type;return ce===_?I(D,E,R.props.children,$,R.key):E!==null&&(E.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===ee&&wr(ce)===E.type)?(E=p(E,R.props),aa(E,R),E.return=D,E):(E=_u(R.type,R.key,R.props,null,D.mode,$),aa(E,R),E.return=D,E)}function L(D,E,R,$){return E===null||E.tag!==4||E.stateNode.containerInfo!==R.containerInfo||E.stateNode.implementation!==R.implementation?(E=mg(R,D.mode,$),E.return=D,E):(E=p(E,R.children||[]),E.return=D,E)}function I(D,E,R,$,ce){return E===null||E.tag!==7?(E=pr(R,D.mode,$,ce),E.return=D,E):(E=p(E,R),E.return=D,E)}function G(D,E,R){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return E=pg(""+E,D.mode,R),E.return=D,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case v:return R=_u(E.type,E.key,E.props,null,D.mode,R),aa(R,E),R.return=D,R;case S:return E=mg(E,D.mode,R),E.return=D,E;case ee:return E=wr(E),G(D,E,R)}if(ye(E)||te(E))return E=pr(E,D.mode,R,null),E.return=D,E;if(typeof E.then=="function")return G(D,Ou(E),R);if(E.$$typeof===O)return G(D,Au(D,E),R);Du(D,E)}return null}function N(D,E,R,$){var ce=E!==null?E.key:null;if(typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint")return ce!==null?null:x(D,E,""+R,$);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case v:return R.key===ce?C(D,E,R,$):null;case S:return R.key===ce?L(D,E,R,$):null;case ee:return R=wr(R),N(D,E,R,$)}if(ye(R)||te(R))return ce!==null?null:I(D,E,R,$,null);if(typeof R.then=="function")return N(D,E,Ou(R),$);if(R.$$typeof===O)return N(D,E,Au(D,R),$);Du(D,R)}return null}function U(D,E,R,$,ce){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return D=D.get(R)||null,x(E,D,""+$,ce);if(typeof $=="object"&&$!==null){switch($.$$typeof){case v:return D=D.get($.key===null?R:$.key)||null,C(E,D,$,ce);case S:return D=D.get($.key===null?R:$.key)||null,L(E,D,$,ce);case ee:return $=wr($),U(D,E,R,$,ce)}if(ye($)||te($))return D=D.get(R)||null,I(E,D,$,ce,null);if(typeof $.then=="function")return U(D,E,R,Ou($),ce);if($.$$typeof===O)return U(D,E,R,Au(E,$),ce);Du(E,$)}return null}function ne(D,E,R,$){for(var ce=null,ze=null,ie=E,xe=E=0,Le=null;ie!==null&&xe<R.length;xe++){ie.index>xe?(Le=ie,ie=null):Le=ie.sibling;var Ie=N(D,ie,R[xe],$);if(Ie===null){ie===null&&(ie=Le);break}r&&ie&&Ie.alternate===null&&o(D,ie),E=y(Ie,E,xe),ze===null?ce=Ie:ze.sibling=Ie,ze=Ie,ie=Le}if(xe===R.length)return c(D,ie),Ne&&Wi(D,xe),ce;if(ie===null){for(;xe<R.length;xe++)ie=G(D,R[xe],$),ie!==null&&(E=y(ie,E,xe),ze===null?ce=ie:ze.sibling=ie,ze=ie);return Ne&&Wi(D,xe),ce}for(ie=f(ie);xe<R.length;xe++)Le=U(ie,D,xe,R[xe],$),Le!==null&&(r&&Le.alternate!==null&&ie.delete(Le.key===null?xe:Le.key),E=y(Le,E,xe),ze===null?ce=Le:ze.sibling=Le,ze=Le);return r&&ie.forEach(function(Vs){return o(D,Vs)}),Ne&&Wi(D,xe),ce}function ue(D,E,R,$){if(R==null)throw Error(i(151));for(var ce=null,ze=null,ie=E,xe=E=0,Le=null,Ie=R.next();ie!==null&&!Ie.done;xe++,Ie=R.next()){ie.index>xe?(Le=ie,ie=null):Le=ie.sibling;var Vs=N(D,ie,Ie.value,$);if(Vs===null){ie===null&&(ie=Le);break}r&&ie&&Vs.alternate===null&&o(D,ie),E=y(Vs,E,xe),ze===null?ce=Vs:ze.sibling=Vs,ze=Vs,ie=Le}if(Ie.done)return c(D,ie),Ne&&Wi(D,xe),ce;if(ie===null){for(;!Ie.done;xe++,Ie=R.next())Ie=G(D,Ie.value,$),Ie!==null&&(E=y(Ie,E,xe),ze===null?ce=Ie:ze.sibling=Ie,ze=Ie);return Ne&&Wi(D,xe),ce}for(ie=f(ie);!Ie.done;xe++,Ie=R.next())Ie=U(ie,D,xe,Ie.value,$),Ie!==null&&(r&&Ie.alternate!==null&&ie.delete(Ie.key===null?xe:Ie.key),E=y(Ie,E,xe),ze===null?ce=Ie:ze.sibling=Ie,ze=Ie);return r&&ie.forEach(function(VD){return o(D,VD)}),Ne&&Wi(D,xe),ce}function Ke(D,E,R,$){if(typeof R=="object"&&R!==null&&R.type===_&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case v:e:{for(var ce=R.key;E!==null;){if(E.key===ce){if(ce=R.type,ce===_){if(E.tag===7){c(D,E.sibling),$=p(E,R.props.children),$.return=D,D=$;break e}}else if(E.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===ee&&wr(ce)===E.type){c(D,E.sibling),$=p(E,R.props),aa($,R),$.return=D,D=$;break e}c(D,E);break}else o(D,E);E=E.sibling}R.type===_?($=pr(R.props.children,D.mode,$,R.key),$.return=D,D=$):($=_u(R.type,R.key,R.props,null,D.mode,$),aa($,R),$.return=D,D=$)}return w(D);case S:e:{for(ce=R.key;E!==null;){if(E.key===ce)if(E.tag===4&&E.stateNode.containerInfo===R.containerInfo&&E.stateNode.implementation===R.implementation){c(D,E.sibling),$=p(E,R.children||[]),$.return=D,D=$;break e}else{c(D,E);break}else o(D,E);E=E.sibling}$=mg(R,D.mode,$),$.return=D,D=$}return w(D);case ee:return R=wr(R),Ke(D,E,R,$)}if(ye(R))return ne(D,E,R,$);if(te(R)){if(ce=te(R),typeof ce!="function")throw Error(i(150));return R=ce.call(R),ue(D,E,R,$)}if(typeof R.then=="function")return Ke(D,E,Ou(R),$);if(R.$$typeof===O)return Ke(D,E,Au(D,R),$);Du(D,R)}return typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint"?(R=""+R,E!==null&&E.tag===6?(c(D,E.sibling),$=p(E,R),$.return=D,D=$):(c(D,E),$=pg(R,D.mode,$),$.return=D,D=$),w(D)):c(D,E)}return function(D,E,R,$){try{oa=0;var ce=Ke(D,E,R,$);return kl=null,ce}catch(ie){if(ie===xl||ie===Tu)throw ie;var ze=xn(29,ie,null,D.mode);return ze.lanes=$,ze.return=D,ze}}}var _r=iw(!0),sw=iw(!1),As=!1;function Eg(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Og(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Cs(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ts(r,o,c){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(qe&2)!==0){var p=f.pending;return p===null?o.next=o:(o.next=p.next,p.next=o),f.pending=o,o=Su(r),qv(r,null,c),o}return wu(r,f,o,c),Su(r)}function ca(r,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var f=o.lanes;f&=r.pendingLanes,c|=f,o.lanes=c,Fb(r,c)}}function Dg(r,o){var c=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var p=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var w={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};y===null?p=y=w:y=y.next=w,c=c.next}while(c!==null);y===null?p=y=o:y=y.next=o}else p=y=o;c={baseState:f.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:f.shared,callbacks:f.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=o:r.next=o,c.lastBaseUpdate=o}var Mg=!1;function ua(){if(Mg){var r=_l;if(r!==null)throw r}}function ha(r,o,c,f){Mg=!1;var p=r.updateQueue;As=!1;var y=p.firstBaseUpdate,w=p.lastBaseUpdate,x=p.shared.pending;if(x!==null){p.shared.pending=null;var C=x,L=C.next;C.next=null,w===null?y=L:w.next=L,w=C;var I=r.alternate;I!==null&&(I=I.updateQueue,x=I.lastBaseUpdate,x!==w&&(x===null?I.firstBaseUpdate=L:x.next=L,I.lastBaseUpdate=C))}if(y!==null){var G=p.baseState;w=0,I=L=C=null,x=y;do{var N=x.lane&-536870913,U=N!==x.lane;if(U?(Re&N)===N:(f&N)===N){N!==0&&N===Sl&&(Mg=!0),I!==null&&(I=I.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var ne=r,ue=x;N=o;var Ke=c;switch(ue.tag){case 1:if(ne=ue.payload,typeof ne=="function"){G=ne.call(Ke,G,N);break e}G=ne;break e;case 3:ne.flags=ne.flags&-65537|128;case 0:if(ne=ue.payload,N=typeof ne=="function"?ne.call(Ke,G,N):ne,N==null)break e;G=m({},G,N);break e;case 2:As=!0}}N=x.callback,N!==null&&(r.flags|=64,U&&(r.flags|=8192),U=p.callbacks,U===null?p.callbacks=[N]:U.push(N))}else U={lane:N,tag:x.tag,payload:x.payload,callback:x.callback,next:null},I===null?(L=I=U,C=G):I=I.next=U,w|=N;if(x=x.next,x===null){if(x=p.shared.pending,x===null)break;U=x,x=U.next,U.next=null,p.lastBaseUpdate=U,p.shared.pending=null}}while(!0);I===null&&(C=G),p.baseState=C,p.firstBaseUpdate=L,p.lastBaseUpdate=I,y===null&&(p.shared.lanes=0),Rs|=w,r.lanes=w,r.memoizedState=G}}function rw(r,o){if(typeof r!="function")throw Error(i(191,r));r.call(o)}function lw(r,o){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)rw(c[r],o)}var Al=T(null),Mu=T(0);function ow(r,o){r=ss,W(Mu,r),W(Al,o),ss=r|o.baseLanes}function Rg(){W(Mu,ss),W(Al,Al.current)}function Lg(){ss=Mu.current,H(Al),H(Mu)}var kn=T(null),Kn=null;function Es(r){var o=r.alternate;W(ut,ut.current&1),W(kn,r),Kn===null&&(o===null||Al.current!==null||o.memoizedState!==null)&&(Kn=r)}function Ng(r){W(ut,ut.current),W(kn,r),Kn===null&&(Kn=r)}function aw(r){r.tag===22?(W(ut,ut.current),W(kn,r),Kn===null&&(Kn=r)):Os()}function Os(){W(ut,ut.current),W(kn,kn.current)}function An(r){H(kn),Kn===r&&(Kn=null),H(ut)}var ut=T(0);function Ru(r){for(var o=r;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Hp(c)||qp(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Ji=0,we=null,Pe=null,yt=null,Lu=!1,Cl=!1,xr=!1,Nu=0,fa=0,Tl=null,R2=0;function lt(){throw Error(i(321))}function Bg(r,o){if(o===null)return!1;for(var c=0;c<o.length&&c<r.length;c++)if(!_n(r[c],o[c]))return!1;return!0}function Ug(r,o,c,f,p,y){return Ji=y,we=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,B.H=r===null||r.memoizedState===null?Gw:Xg,xr=!1,y=c(f,p),xr=!1,Cl&&(y=uw(o,c,f,p)),cw(r),y}function cw(r){B.H=pa;var o=Pe!==null&&Pe.next!==null;if(Ji=0,yt=Pe=we=null,Lu=!1,fa=0,Tl=null,o)throw Error(i(300));r===null||bt||(r=r.dependencies,r!==null&&ku(r)&&(bt=!0))}function uw(r,o,c,f){we=r;var p=0;do{if(Cl&&(Tl=null),fa=0,Cl=!1,25<=p)throw Error(i(301));if(p+=1,yt=Pe=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}B.H=Kw,y=o(c,f)}while(Cl);return y}function L2(){var r=B.H,o=r.useState()[0];return o=typeof o.then=="function"?da(o):o,r=r.useState()[0],(Pe!==null?Pe.memoizedState:null)!==r&&(we.flags|=1024),o}function jg(){var r=Nu!==0;return Nu=0,r}function zg(r,o,c){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~c}function Ig(r){if(Lu){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Lu=!1}Ji=0,yt=Pe=we=null,Cl=!1,fa=Nu=0,Tl=null}function Zt(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?we.memoizedState=yt=r:yt=yt.next=r,yt}function ht(){if(Pe===null){var r=we.alternate;r=r!==null?r.memoizedState:null}else r=Pe.next;var o=yt===null?we.memoizedState:yt.next;if(o!==null)yt=o,Pe=r;else{if(r===null)throw we.alternate===null?Error(i(467)):Error(i(310));Pe=r,r={memoizedState:Pe.memoizedState,baseState:Pe.baseState,baseQueue:Pe.baseQueue,queue:Pe.queue,next:null},yt===null?we.memoizedState=yt=r:yt=yt.next=r}return yt}function Bu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function da(r){var o=fa;return fa+=1,Tl===null&&(Tl=[]),r=ew(Tl,r,o),o=we,(yt===null?o.memoizedState:yt.next)===null&&(o=o.alternate,B.H=o===null||o.memoizedState===null?Gw:Xg),r}function Uu(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return da(r);if(r.$$typeof===O)return jt(r)}throw Error(i(438,String(r)))}function Hg(r){var o=null,c=we.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var f=we.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(p){return p.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Bu(),we.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(r),f=0;f<r;f++)c[f]=Me;return o.index++,c}function Xi(r,o){return typeof o=="function"?o(r):o}function ju(r){var o=ht();return qg(o,Pe,r)}function qg(r,o,c){var f=r.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=c;var p=r.baseQueue,y=f.pending;if(y!==null){if(p!==null){var w=p.next;p.next=y.next,y.next=w}o.baseQueue=p=y,f.pending=null}if(y=r.baseState,p===null)r.memoizedState=y;else{o=p.next;var x=w=null,C=null,L=o,I=!1;do{var G=L.lane&-536870913;if(G!==L.lane?(Re&G)===G:(Ji&G)===G){var N=L.revertLane;if(N===0)C!==null&&(C=C.next={lane:0,revertLane:0,gesture:null,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),G===Sl&&(I=!0);else if((Ji&N)===N){L=L.next,N===Sl&&(I=!0);continue}else G={lane:0,revertLane:L.revertLane,gesture:null,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},C===null?(x=C=G,w=y):C=C.next=G,we.lanes|=N,Rs|=N;G=L.action,xr&&c(y,G),y=L.hasEagerState?L.eagerState:c(y,G)}else N={lane:G,revertLane:L.revertLane,gesture:L.gesture,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},C===null?(x=C=N,w=y):C=C.next=N,we.lanes|=G,Rs|=G;L=L.next}while(L!==null&&L!==o);if(C===null?w=y:C.next=x,!_n(y,r.memoizedState)&&(bt=!0,I&&(c=_l,c!==null)))throw c;r.memoizedState=y,r.baseState=w,r.baseQueue=C,f.lastRenderedState=y}return p===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function Vg(r){var o=ht(),c=o.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=r;var f=c.dispatch,p=c.pending,y=o.memoizedState;if(p!==null){c.pending=null;var w=p=p.next;do y=r(y,w.action),w=w.next;while(w!==p);_n(y,o.memoizedState)||(bt=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),c.lastRenderedState=y}return[y,f]}function hw(r,o,c){var f=we,p=ht(),y=Ne;if(y){if(c===void 0)throw Error(i(407));c=c()}else c=o();var w=!_n((Pe||p).memoizedState,c);if(w&&(p.memoizedState=c,bt=!0),p=p.queue,Gg(gw.bind(null,f,p,r),[r]),p.getSnapshot!==o||w||yt!==null&&yt.memoizedState.tag&1){if(f.flags|=2048,El(9,{destroy:void 0},dw.bind(null,f,p,c,o),null),Ye===null)throw Error(i(349));y||(Ji&127)!==0||fw(f,o,c)}return c}function fw(r,o,c){r.flags|=16384,r={getSnapshot:o,value:c},o=we.updateQueue,o===null?(o=Bu(),we.updateQueue=o,o.stores=[r]):(c=o.stores,c===null?o.stores=[r]:c.push(r))}function dw(r,o,c,f){o.value=c,o.getSnapshot=f,pw(o)&&mw(r)}function gw(r,o,c){return c(function(){pw(o)&&mw(r)})}function pw(r){var o=r.getSnapshot;r=r.value;try{var c=o();return!_n(r,c)}catch{return!0}}function mw(r){var o=gr(r,2);o!==null&&hn(o,r,2)}function $g(r){var o=Zt();if(typeof r=="function"){var c=r;if(r=c(),xr){bs(!0);try{c()}finally{bs(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xi,lastRenderedState:r},o}function yw(r,o,c,f){return r.baseState=c,qg(r,Pe,typeof f=="function"?f:Xi)}function N2(r,o,c,f,p){if(Hu(r))throw Error(i(485));if(r=o.action,r!==null){var y={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};B.T!==null?c(!0):y.isTransition=!1,f(y),c=o.pending,c===null?(y.next=o.pending=y,bw(o,y)):(y.next=c.next,o.pending=c.next=y)}}function bw(r,o){var c=o.action,f=o.payload,p=r.state;if(o.isTransition){var y=B.T,w={};B.T=w;try{var x=c(p,f),C=B.S;C!==null&&C(w,x),vw(r,o,x)}catch(L){Pg(r,o,L)}finally{y!==null&&w.types!==null&&(y.types=w.types),B.T=y}}else try{y=c(p,f),vw(r,o,y)}catch(L){Pg(r,o,L)}}function vw(r,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){ww(r,o,f)},function(f){return Pg(r,o,f)}):ww(r,o,c)}function ww(r,o,c){o.status="fulfilled",o.value=c,Sw(o),r.state=c,o=r.pending,o!==null&&(c=o.next,c===o?r.pending=null:(c=c.next,o.next=c,bw(r,c)))}function Pg(r,o,c){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=c,Sw(o),o=o.next;while(o!==f)}r.action=null}function Sw(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function _w(r,o){return o}function xw(r,o){if(Ne){var c=Ye.formState;if(c!==null){e:{var f=we;if(Ne){if(tt){t:{for(var p=tt,y=Gn;p.nodeType!==8;){if(!y){p=null;break t}if(p=Wn(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){tt=Wn(p.nextSibling),f=p.data==="F!";break e}}xs(f)}f=!1}f&&(o=c[0])}}return c=Zt(),c.memoizedState=c.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_w,lastRenderedState:o},c.queue=f,c=Vw.bind(null,we,f),f.dispatch=c,f=$g(!1),y=Jg.bind(null,we,!1,f.queue),f=Zt(),p={state:o,dispatch:null,action:r,pending:null},f.queue=p,c=N2.bind(null,we,p,y,c),p.dispatch=c,f.memoizedState=r,[o,c,!1]}function kw(r){var o=ht();return Aw(o,Pe,r)}function Aw(r,o,c){if(o=qg(r,o,_w)[0],r=ju(Xi)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=da(o)}catch(w){throw w===xl?Tu:w}else f=o;o=ht();var p=o.queue,y=p.dispatch;return c!==o.memoizedState&&(we.flags|=2048,El(9,{destroy:void 0},B2.bind(null,p,c),null)),[f,y,r]}function B2(r,o){r.action=o}function Cw(r){var o=ht(),c=Pe;if(c!==null)return Aw(o,c,r);ht(),o=o.memoizedState,c=ht();var f=c.queue.dispatch;return c.memoizedState=r,[o,f,!1]}function El(r,o,c,f){return r={tag:r,create:c,deps:f,inst:o,next:null},o=we.updateQueue,o===null&&(o=Bu(),we.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=r.next=r:(f=c.next,c.next=r,r.next=f,o.lastEffect=r),r}function Tw(){return ht().memoizedState}function zu(r,o,c,f){var p=Zt();we.flags|=r,p.memoizedState=El(1|o,{destroy:void 0},c,f===void 0?null:f)}function Iu(r,o,c,f){var p=ht();f=f===void 0?null:f;var y=p.memoizedState.inst;Pe!==null&&f!==null&&Bg(f,Pe.memoizedState.deps)?p.memoizedState=El(o,y,c,f):(we.flags|=r,p.memoizedState=El(1|o,y,c,f))}function Ew(r,o){zu(8390656,8,r,o)}function Gg(r,o){Iu(2048,8,r,o)}function U2(r){we.flags|=4;var o=we.updateQueue;if(o===null)o=Bu(),we.updateQueue=o,o.events=[r];else{var c=o.events;c===null?o.events=[r]:c.push(r)}}function Ow(r){var o=ht().memoizedState;return U2({ref:o,nextImpl:r}),function(){if((qe&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function Dw(r,o){return Iu(4,2,r,o)}function Mw(r,o){return Iu(4,4,r,o)}function Rw(r,o){if(typeof o=="function"){r=r();var c=o(r);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Lw(r,o,c){c=c!=null?c.concat([r]):null,Iu(4,4,Rw.bind(null,o,r),c)}function Kg(){}function Nw(r,o){var c=ht();o=o===void 0?null:o;var f=c.memoizedState;return o!==null&&Bg(o,f[1])?f[0]:(c.memoizedState=[r,o],r)}function Bw(r,o){var c=ht();o=o===void 0?null:o;var f=c.memoizedState;if(o!==null&&Bg(o,f[1]))return f[0];if(f=r(),xr){bs(!0);try{r()}finally{bs(!1)}}return c.memoizedState=[f,o],f}function Wg(r,o,c){return c===void 0||(Ji&1073741824)!==0&&(Re&261930)===0?r.memoizedState=o:(r.memoizedState=c,r=US(),we.lanes|=r,Rs|=r,c)}function Uw(r,o,c,f){return _n(c,o)?c:Al.current!==null?(r=Wg(r,c,f),_n(r,o)||(bt=!0),r):(Ji&42)===0||(Ji&1073741824)!==0&&(Re&261930)===0?(bt=!0,r.memoizedState=c):(r=US(),we.lanes|=r,Rs|=r,o)}function jw(r,o,c,f,p){var y=K.p;K.p=y!==0&&8>y?y:8;var w=B.T,x={};B.T=x,Jg(r,!1,o,c);try{var C=p(),L=B.S;if(L!==null&&L(x,C),C!==null&&typeof C=="object"&&typeof C.then=="function"){var I=M2(C,f);ga(r,o,I,En(r))}else ga(r,o,f,En(r))}catch(G){ga(r,o,{then:function(){},status:"rejected",reason:G},En())}finally{K.p=y,w!==null&&x.types!==null&&(w.types=x.types),B.T=w}}function j2(){}function Yg(r,o,c,f){if(r.tag!==5)throw Error(i(476));var p=zw(r).queue;jw(r,p,o,re,c===null?j2:function(){return Iw(r),c(f)})}function zw(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xi,lastRenderedState:re},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xi,lastRenderedState:c},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function Iw(r){var o=zw(r);o.next===null&&(o=r.alternate.memoizedState),ga(r,o.next.queue,{},En())}function Fg(){return jt(Ma)}function Hw(){return ht().memoizedState}function qw(){return ht().memoizedState}function z2(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var c=En();r=Cs(c);var f=Ts(o,r,c);f!==null&&(hn(f,o,c),ca(f,o,c)),o={cache:kg()},r.payload=o;return}o=o.return}}function I2(r,o,c){var f=En();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Hu(r)?$w(o,c):(c=dg(r,o,c,f),c!==null&&(hn(c,r,f),Pw(c,o,f)))}function Vw(r,o,c){var f=En();ga(r,o,c,f)}function ga(r,o,c,f){var p={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Hu(r))$w(o,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var w=o.lastRenderedState,x=y(w,c);if(p.hasEagerState=!0,p.eagerState=x,_n(x,w))return wu(r,o,p,0),Ye===null&&vu(),!1}catch{}if(c=dg(r,o,p,f),c!==null)return hn(c,r,f),Pw(c,o,f),!0}return!1}function Jg(r,o,c,f){if(f={lane:2,revertLane:Ep(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Hu(r)){if(o)throw Error(i(479))}else o=dg(r,c,f,2),o!==null&&hn(o,r,2)}function Hu(r){var o=r.alternate;return r===we||o!==null&&o===we}function $w(r,o){Cl=Lu=!0;var c=r.pending;c===null?o.next=o:(o.next=c.next,c.next=o),r.pending=o}function Pw(r,o,c){if((c&4194048)!==0){var f=o.lanes;f&=r.pendingLanes,c|=f,o.lanes=c,Fb(r,c)}}var pa={readContext:jt,use:Uu,useCallback:lt,useContext:lt,useEffect:lt,useImperativeHandle:lt,useLayoutEffect:lt,useInsertionEffect:lt,useMemo:lt,useReducer:lt,useRef:lt,useState:lt,useDebugValue:lt,useDeferredValue:lt,useTransition:lt,useSyncExternalStore:lt,useId:lt,useHostTransitionStatus:lt,useFormState:lt,useActionState:lt,useOptimistic:lt,useMemoCache:lt,useCacheRefresh:lt};pa.useEffectEvent=lt;var Gw={readContext:jt,use:Uu,useCallback:function(r,o){return Zt().memoizedState=[r,o===void 0?null:o],r},useContext:jt,useEffect:Ew,useImperativeHandle:function(r,o,c){c=c!=null?c.concat([r]):null,zu(4194308,4,Rw.bind(null,o,r),c)},useLayoutEffect:function(r,o){return zu(4194308,4,r,o)},useInsertionEffect:function(r,o){zu(4,2,r,o)},useMemo:function(r,o){var c=Zt();o=o===void 0?null:o;var f=r();if(xr){bs(!0);try{r()}finally{bs(!1)}}return c.memoizedState=[f,o],f},useReducer:function(r,o,c){var f=Zt();if(c!==void 0){var p=c(o);if(xr){bs(!0);try{c(o)}finally{bs(!1)}}}else p=o;return f.memoizedState=f.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},f.queue=r,r=r.dispatch=I2.bind(null,we,r),[f.memoizedState,r]},useRef:function(r){var o=Zt();return r={current:r},o.memoizedState=r},useState:function(r){r=$g(r);var o=r.queue,c=Vw.bind(null,we,o);return o.dispatch=c,[r.memoizedState,c]},useDebugValue:Kg,useDeferredValue:function(r,o){var c=Zt();return Wg(c,r,o)},useTransition:function(){var r=$g(!1);return r=jw.bind(null,we,r.queue,!0,!1),Zt().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,c){var f=we,p=Zt();if(Ne){if(c===void 0)throw Error(i(407));c=c()}else{if(c=o(),Ye===null)throw Error(i(349));(Re&127)!==0||fw(f,o,c)}p.memoizedState=c;var y={value:c,getSnapshot:o};return p.queue=y,Ew(gw.bind(null,f,y,r),[r]),f.flags|=2048,El(9,{destroy:void 0},dw.bind(null,f,y,c,o),null),c},useId:function(){var r=Zt(),o=Ye.identifierPrefix;if(Ne){var c=Si,f=wi;c=(f&~(1<<32-Sn(f)-1)).toString(32)+c,o="_"+o+"R_"+c,c=Nu++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=R2++,o="_"+o+"r_"+c.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:Fg,useFormState:xw,useActionState:xw,useOptimistic:function(r){var o=Zt();o.memoizedState=o.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=Jg.bind(null,we,!0,c),c.dispatch=o,[r,o]},useMemoCache:Hg,useCacheRefresh:function(){return Zt().memoizedState=z2.bind(null,we)},useEffectEvent:function(r){var o=Zt(),c={impl:r};return o.memoizedState=c,function(){if((qe&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},Xg={readContext:jt,use:Uu,useCallback:Nw,useContext:jt,useEffect:Gg,useImperativeHandle:Lw,useInsertionEffect:Dw,useLayoutEffect:Mw,useMemo:Bw,useReducer:ju,useRef:Tw,useState:function(){return ju(Xi)},useDebugValue:Kg,useDeferredValue:function(r,o){var c=ht();return Uw(c,Pe.memoizedState,r,o)},useTransition:function(){var r=ju(Xi)[0],o=ht().memoizedState;return[typeof r=="boolean"?r:da(r),o]},useSyncExternalStore:hw,useId:Hw,useHostTransitionStatus:Fg,useFormState:kw,useActionState:kw,useOptimistic:function(r,o){var c=ht();return yw(c,Pe,r,o)},useMemoCache:Hg,useCacheRefresh:qw};Xg.useEffectEvent=Ow;var Kw={readContext:jt,use:Uu,useCallback:Nw,useContext:jt,useEffect:Gg,useImperativeHandle:Lw,useInsertionEffect:Dw,useLayoutEffect:Mw,useMemo:Bw,useReducer:Vg,useRef:Tw,useState:function(){return Vg(Xi)},useDebugValue:Kg,useDeferredValue:function(r,o){var c=ht();return Pe===null?Wg(c,r,o):Uw(c,Pe.memoizedState,r,o)},useTransition:function(){var r=Vg(Xi)[0],o=ht().memoizedState;return[typeof r=="boolean"?r:da(r),o]},useSyncExternalStore:hw,useId:Hw,useHostTransitionStatus:Fg,useFormState:Cw,useActionState:Cw,useOptimistic:function(r,o){var c=ht();return Pe!==null?yw(c,Pe,r,o):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:Hg,useCacheRefresh:qw};Kw.useEffectEvent=Ow;function Qg(r,o,c,f){o=r.memoizedState,c=c(f,o),c=c==null?o:m({},o,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Zg={enqueueSetState:function(r,o,c){r=r._reactInternals;var f=En(),p=Cs(f);p.payload=o,c!=null&&(p.callback=c),o=Ts(r,p,f),o!==null&&(hn(o,r,f),ca(o,r,f))},enqueueReplaceState:function(r,o,c){r=r._reactInternals;var f=En(),p=Cs(f);p.tag=1,p.payload=o,c!=null&&(p.callback=c),o=Ts(r,p,f),o!==null&&(hn(o,r,f),ca(o,r,f))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var c=En(),f=Cs(c);f.tag=2,o!=null&&(f.callback=o),o=Ts(r,f,c),o!==null&&(hn(o,r,c),ca(o,r,c))}};function Ww(r,o,c,f,p,y,w){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,y,w):o.prototype&&o.prototype.isPureReactComponent?!ta(c,f)||!ta(p,y):!0}function Yw(r,o,c,f){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,f),o.state!==r&&Zg.enqueueReplaceState(o,o.state,null)}function kr(r,o){var c=o;if("ref"in o){c={};for(var f in o)f!=="ref"&&(c[f]=o[f])}if(r=r.defaultProps){c===o&&(c=m({},c));for(var p in r)c[p]===void 0&&(c[p]=r[p])}return c}function Fw(r){bu(r)}function Jw(r){console.error(r)}function Xw(r){bu(r)}function qu(r,o){try{var c=r.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function Qw(r,o,c){try{var f=r.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function ep(r,o,c){return c=Cs(c),c.tag=3,c.payload={element:null},c.callback=function(){qu(r,o)},c}function Zw(r){return r=Cs(r),r.tag=3,r}function eS(r,o,c,f){var p=c.type.getDerivedStateFromError;if(typeof p=="function"){var y=f.value;r.payload=function(){return p(y)},r.callback=function(){Qw(o,c,f)}}var w=c.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(r.callback=function(){Qw(o,c,f),typeof p!="function"&&(Ls===null?Ls=new Set([this]):Ls.add(this));var x=f.stack;this.componentDidCatch(f.value,{componentStack:x!==null?x:""})})}function H2(r,o,c,f,p){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=c.alternate,o!==null&&wl(o,c,p,!0),c=kn.current,c!==null){switch(c.tag){case 31:case 13:return Kn===null?Zu():c.alternate===null&&ot===0&&(ot=3),c.flags&=-257,c.flags|=65536,c.lanes=p,f===Eu?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([f]):o.add(f),Ap(r,f,p)),!1;case 22:return c.flags|=65536,f===Eu?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([f]):c.add(f)),Ap(r,f,p)),!1}throw Error(i(435,c.tag))}return Ap(r,f,p),Zu(),!1}if(Ne)return o=kn.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=p,f!==vg&&(r=Error(i(422),{cause:f}),sa(Vn(r,c)))):(f!==vg&&(o=Error(i(423),{cause:f}),sa(Vn(o,c))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,f=Vn(f,c),p=ep(r.stateNode,f,p),Dg(r,p),ot!==4&&(ot=2)),!1;var y=Error(i(520),{cause:f});if(y=Vn(y,c),xa===null?xa=[y]:xa.push(y),ot!==4&&(ot=2),o===null)return!0;f=Vn(f,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,r=p&-p,c.lanes|=r,r=ep(c.stateNode,f,r),Dg(c,r),!1;case 1:if(o=c.type,y=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ls===null||!Ls.has(y))))return c.flags|=65536,p&=-p,c.lanes|=p,p=Zw(p),eS(p,r,c,f),Dg(c,p),!1}c=c.return}while(c!==null);return!1}var tp=Error(i(461)),bt=!1;function zt(r,o,c,f){o.child=r===null?sw(o,null,c,f):_r(o,r.child,c,f)}function tS(r,o,c,f,p){c=c.render;var y=o.ref;if("ref"in f){var w={};for(var x in f)x!=="ref"&&(w[x]=f[x])}else w=f;return br(o),f=Ug(r,o,c,w,y,p),x=jg(),r!==null&&!bt?(zg(r,o,p),Qi(r,o,p)):(Ne&&x&&yg(o),o.flags|=1,zt(r,o,f,p),o.child)}function nS(r,o,c,f,p){if(r===null){var y=c.type;return typeof y=="function"&&!gg(y)&&y.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=y,iS(r,o,y,f,p)):(r=_u(c.type,null,f,o,o.mode,p),r.ref=o.ref,r.return=o,o.child=r)}if(y=r.child,!cp(r,p)){var w=y.memoizedProps;if(c=c.compare,c=c!==null?c:ta,c(w,f)&&r.ref===o.ref)return Qi(r,o,p)}return o.flags|=1,r=Ki(y,f),r.ref=o.ref,r.return=o,o.child=r}function iS(r,o,c,f,p){if(r!==null){var y=r.memoizedProps;if(ta(y,f)&&r.ref===o.ref)if(bt=!1,o.pendingProps=f=y,cp(r,p))(r.flags&131072)!==0&&(bt=!0);else return o.lanes=r.lanes,Qi(r,o,p)}return np(r,o,c,f,p)}function sS(r,o,c,f){var p=f.children,y=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((o.flags&128)!==0){if(y=y!==null?y.baseLanes|c:c,r!==null){for(f=o.child=r.child,p=0;f!==null;)p=p|f.lanes|f.childLanes,f=f.sibling;f=p&~y}else f=0,o.child=null;return rS(r,o,y,c,f)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Cu(o,y!==null?y.cachePool:null),y!==null?ow(o,y):Rg(),aw(o);else return f=o.lanes=536870912,rS(r,o,y!==null?y.baseLanes|c:c,c,f)}else y!==null?(Cu(o,y.cachePool),ow(o,y),Os(),o.memoizedState=null):(r!==null&&Cu(o,null),Rg(),Os());return zt(r,o,p,c),o.child}function ma(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function rS(r,o,c,f,p){var y=Cg();return y=y===null?null:{parent:mt._currentValue,pool:y},o.memoizedState={baseLanes:c,cachePool:y},r!==null&&Cu(o,null),Rg(),aw(o),r!==null&&wl(r,o,f,!0),o.childLanes=p,null}function Vu(r,o){return o=Pu({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function lS(r,o,c){return _r(o,r.child,null,c),r=Vu(o,o.pendingProps),r.flags|=2,An(o),o.memoizedState=null,r}function q2(r,o,c){var f=o.pendingProps,p=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Ne){if(f.mode==="hidden")return r=Vu(o,f),o.lanes=536870912,ma(null,r);if(Ng(o),(r=tt)?(r=b1(r,Gn),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Ss!==null?{id:wi,overflow:Si}:null,retryLane:536870912,hydrationErrors:null},c=$v(r),c.return=o,o.child=c,Ut=o,tt=null)):r=null,r===null)throw xs(o);return o.lanes=536870912,null}return Vu(o,f)}var y=r.memoizedState;if(y!==null){var w=y.dehydrated;if(Ng(o),p)if(o.flags&256)o.flags&=-257,o=lS(r,o,c);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(i(558));else if(bt||wl(r,o,c,!1),p=(c&r.childLanes)!==0,bt||p){if(f=Ye,f!==null&&(w=Jb(f,c),w!==0&&w!==y.retryLane))throw y.retryLane=w,gr(r,w),hn(f,r,w),tp;Zu(),o=lS(r,o,c)}else r=y.treeContext,tt=Wn(w.nextSibling),Ut=o,Ne=!0,_s=null,Gn=!1,r!==null&&Kv(o,r),o=Vu(o,f),o.flags|=4096;return o}return r=Ki(r.child,{mode:f.mode,children:f.children}),r.ref=o.ref,o.child=r,r.return=o,r}function $u(r,o){var c=o.ref;if(c===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(r===null||r.ref!==c)&&(o.flags|=4194816)}}function np(r,o,c,f,p){return br(o),c=Ug(r,o,c,f,void 0,p),f=jg(),r!==null&&!bt?(zg(r,o,p),Qi(r,o,p)):(Ne&&f&&yg(o),o.flags|=1,zt(r,o,c,p),o.child)}function oS(r,o,c,f,p,y){return br(o),o.updateQueue=null,c=uw(o,f,c,p),cw(r),f=jg(),r!==null&&!bt?(zg(r,o,y),Qi(r,o,y)):(Ne&&f&&yg(o),o.flags|=1,zt(r,o,c,y),o.child)}function aS(r,o,c,f,p){if(br(o),o.stateNode===null){var y=ml,w=c.contextType;typeof w=="object"&&w!==null&&(y=jt(w)),y=new c(f,y),o.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Zg,o.stateNode=y,y._reactInternals=o,y=o.stateNode,y.props=f,y.state=o.memoizedState,y.refs={},Eg(o),w=c.contextType,y.context=typeof w=="object"&&w!==null?jt(w):ml,y.state=o.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(Qg(o,c,w,f),y.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&Zg.enqueueReplaceState(y,y.state,null),ha(o,f,y,p),ua(),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(r===null){y=o.stateNode;var x=o.memoizedProps,C=kr(c,x);y.props=C;var L=y.context,I=c.contextType;w=ml,typeof I=="object"&&I!==null&&(w=jt(I));var G=c.getDerivedStateFromProps;I=typeof G=="function"||typeof y.getSnapshotBeforeUpdate=="function",x=o.pendingProps!==x,I||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(x||L!==w)&&Yw(o,y,f,w),As=!1;var N=o.memoizedState;y.state=N,ha(o,f,y,p),ua(),L=o.memoizedState,x||N!==L||As?(typeof G=="function"&&(Qg(o,c,G,f),L=o.memoizedState),(C=As||Ww(o,c,C,f,N,L,w))?(I||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(o.flags|=4194308)):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=L),y.props=f,y.state=L,y.context=w,f=C):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{y=o.stateNode,Og(r,o),w=o.memoizedProps,I=kr(c,w),y.props=I,G=o.pendingProps,N=y.context,L=c.contextType,C=ml,typeof L=="object"&&L!==null&&(C=jt(L)),x=c.getDerivedStateFromProps,(L=typeof x=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==G||N!==C)&&Yw(o,y,f,C),As=!1,N=o.memoizedState,y.state=N,ha(o,f,y,p),ua();var U=o.memoizedState;w!==G||N!==U||As||r!==null&&r.dependencies!==null&&ku(r.dependencies)?(typeof x=="function"&&(Qg(o,c,x,f),U=o.memoizedState),(I=As||Ww(o,c,I,f,N,U,C)||r!==null&&r.dependencies!==null&&ku(r.dependencies))?(L||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(f,U,C),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(f,U,C)),typeof y.componentDidUpdate=="function"&&(o.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===r.memoizedProps&&N===r.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&N===r.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=U),y.props=f,y.state=U,y.context=C,f=I):(typeof y.componentDidUpdate!="function"||w===r.memoizedProps&&N===r.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===r.memoizedProps&&N===r.memoizedState||(o.flags|=1024),f=!1)}return y=f,$u(r,o),f=(o.flags&128)!==0,y||f?(y=o.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:y.render(),o.flags|=1,r!==null&&f?(o.child=_r(o,r.child,null,p),o.child=_r(o,null,c,p)):zt(r,o,c,p),o.memoizedState=y.state,r=o.child):r=Qi(r,o,p),r}function cS(r,o,c,f){return mr(),o.flags|=256,zt(r,o,c,f),o.child}var ip={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function sp(r){return{baseLanes:r,cachePool:Qv()}}function rp(r,o,c){return r=r!==null?r.childLanes&~c:0,o&&(r|=Tn),r}function uS(r,o,c){var f=o.pendingProps,p=!1,y=(o.flags&128)!==0,w;if((w=y)||(w=r!==null&&r.memoizedState===null?!1:(ut.current&2)!==0),w&&(p=!0,o.flags&=-129),w=(o.flags&32)!==0,o.flags&=-33,r===null){if(Ne){if(p?Es(o):Os(),(r=tt)?(r=b1(r,Gn),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Ss!==null?{id:wi,overflow:Si}:null,retryLane:536870912,hydrationErrors:null},c=$v(r),c.return=o,o.child=c,Ut=o,tt=null)):r=null,r===null)throw xs(o);return qp(r)?o.lanes=32:o.lanes=536870912,null}var x=f.children;return f=f.fallback,p?(Os(),p=o.mode,x=Pu({mode:"hidden",children:x},p),f=pr(f,p,c,null),x.return=o,f.return=o,x.sibling=f,o.child=x,f=o.child,f.memoizedState=sp(c),f.childLanes=rp(r,w,c),o.memoizedState=ip,ma(null,f)):(Es(o),lp(o,x))}var C=r.memoizedState;if(C!==null&&(x=C.dehydrated,x!==null)){if(y)o.flags&256?(Es(o),o.flags&=-257,o=op(r,o,c)):o.memoizedState!==null?(Os(),o.child=r.child,o.flags|=128,o=null):(Os(),x=f.fallback,p=o.mode,f=Pu({mode:"visible",children:f.children},p),x=pr(x,p,c,null),x.flags|=2,f.return=o,x.return=o,f.sibling=x,o.child=f,_r(o,r.child,null,c),f=o.child,f.memoizedState=sp(c),f.childLanes=rp(r,w,c),o.memoizedState=ip,o=ma(null,f));else if(Es(o),qp(x)){if(w=x.nextSibling&&x.nextSibling.dataset,w)var L=w.dgst;w=L,f=Error(i(419)),f.stack="",f.digest=w,sa({value:f,source:null,stack:null}),o=op(r,o,c)}else if(bt||wl(r,o,c,!1),w=(c&r.childLanes)!==0,bt||w){if(w=Ye,w!==null&&(f=Jb(w,c),f!==0&&f!==C.retryLane))throw C.retryLane=f,gr(r,f),hn(w,r,f),tp;Hp(x)||Zu(),o=op(r,o,c)}else Hp(x)?(o.flags|=192,o.child=r.child,o=null):(r=C.treeContext,tt=Wn(x.nextSibling),Ut=o,Ne=!0,_s=null,Gn=!1,r!==null&&Kv(o,r),o=lp(o,f.children),o.flags|=4096);return o}return p?(Os(),x=f.fallback,p=o.mode,C=r.child,L=C.sibling,f=Ki(C,{mode:"hidden",children:f.children}),f.subtreeFlags=C.subtreeFlags&65011712,L!==null?x=Ki(L,x):(x=pr(x,p,c,null),x.flags|=2),x.return=o,f.return=o,f.sibling=x,o.child=f,ma(null,f),f=o.child,x=r.child.memoizedState,x===null?x=sp(c):(p=x.cachePool,p!==null?(C=mt._currentValue,p=p.parent!==C?{parent:C,pool:C}:p):p=Qv(),x={baseLanes:x.baseLanes|c,cachePool:p}),f.memoizedState=x,f.childLanes=rp(r,w,c),o.memoizedState=ip,ma(r.child,f)):(Es(o),c=r.child,r=c.sibling,c=Ki(c,{mode:"visible",children:f.children}),c.return=o,c.sibling=null,r!==null&&(w=o.deletions,w===null?(o.deletions=[r],o.flags|=16):w.push(r)),o.child=c,o.memoizedState=null,c)}function lp(r,o){return o=Pu({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function Pu(r,o){return r=xn(22,r,null,o),r.lanes=0,r}function op(r,o,c){return _r(o,r.child,null,c),r=lp(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function hS(r,o,c){r.lanes|=o;var f=r.alternate;f!==null&&(f.lanes|=o),_g(r.return,o,c)}function ap(r,o,c,f,p,y){var w=r.memoizedState;w===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:p,treeForkCount:y}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=c,w.tailMode=p,w.treeForkCount=y)}function fS(r,o,c){var f=o.pendingProps,p=f.revealOrder,y=f.tail;f=f.children;var w=ut.current,x=(w&2)!==0;if(x?(w=w&1|2,o.flags|=128):w&=1,W(ut,w),zt(r,o,f,c),f=Ne?ia:0,!x&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&hS(r,c,o);else if(r.tag===19)hS(r,c,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(p){case"forwards":for(c=o.child,p=null;c!==null;)r=c.alternate,r!==null&&Ru(r)===null&&(p=c),c=c.sibling;c=p,c===null?(p=o.child,o.child=null):(p=c.sibling,c.sibling=null),ap(o,!1,p,c,y,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,p=o.child,o.child=null;p!==null;){if(r=p.alternate,r!==null&&Ru(r)===null){o.child=p;break}r=p.sibling,p.sibling=c,c=p,p=r}ap(o,!0,c,null,y,f);break;case"together":ap(o,!1,null,null,void 0,f);break;default:o.memoizedState=null}return o.child}function Qi(r,o,c){if(r!==null&&(o.dependencies=r.dependencies),Rs|=o.lanes,(c&o.childLanes)===0)if(r!==null){if(wl(r,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(i(153));if(o.child!==null){for(r=o.child,c=Ki(r,r.pendingProps),o.child=c,c.return=o;r.sibling!==null;)r=r.sibling,c=c.sibling=Ki(r,r.pendingProps),c.return=o;c.sibling=null}return o.child}function cp(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&ku(r)))}function V2(r,o,c){switch(o.tag){case 3:Qt(o,o.stateNode.containerInfo),ks(o,mt,r.memoizedState.cache),mr();break;case 27:case 5:Vo(o);break;case 4:Qt(o,o.stateNode.containerInfo);break;case 10:ks(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Ng(o),null;break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(Es(o),o.flags|=128,null):(c&o.child.childLanes)!==0?uS(r,o,c):(Es(o),r=Qi(r,o,c),r!==null?r.sibling:null);Es(o);break;case 19:var p=(r.flags&128)!==0;if(f=(c&o.childLanes)!==0,f||(wl(r,o,c,!1),f=(c&o.childLanes)!==0),p){if(f)return fS(r,o,c);o.flags|=128}if(p=o.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),W(ut,ut.current),f)break;return null;case 22:return o.lanes=0,sS(r,o,c,o.pendingProps);case 24:ks(o,mt,r.memoizedState.cache)}return Qi(r,o,c)}function dS(r,o,c){if(r!==null)if(r.memoizedProps!==o.pendingProps)bt=!0;else{if(!cp(r,c)&&(o.flags&128)===0)return bt=!1,V2(r,o,c);bt=(r.flags&131072)!==0}else bt=!1,Ne&&(o.flags&1048576)!==0&&Gv(o,ia,o.index);switch(o.lanes=0,o.tag){case 16:e:{var f=o.pendingProps;if(r=wr(o.elementType),o.type=r,typeof r=="function")gg(r)?(f=kr(r,f),o.tag=1,o=aS(null,o,r,f,c)):(o.tag=0,o=np(null,o,r,f,c));else{if(r!=null){var p=r.$$typeof;if(p===z){o.tag=11,o=tS(null,o,r,f,c);break e}else if(p===j){o.tag=14,o=nS(null,o,r,f,c);break e}}throw o=fe(r)||r,Error(i(306,o,""))}}return o;case 0:return np(r,o,o.type,o.pendingProps,c);case 1:return f=o.type,p=kr(f,o.pendingProps),aS(r,o,f,p,c);case 3:e:{if(Qt(o,o.stateNode.containerInfo),r===null)throw Error(i(387));f=o.pendingProps;var y=o.memoizedState;p=y.element,Og(r,o),ha(o,f,null,c);var w=o.memoizedState;if(f=w.cache,ks(o,mt,f),f!==y.cache&&xg(o,[mt],c,!0),ua(),f=w.element,y.isDehydrated)if(y={element:f,isDehydrated:!1,cache:w.cache},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){o=cS(r,o,f,c);break e}else if(f!==p){p=Vn(Error(i(424)),o),sa(p),o=cS(r,o,f,c);break e}else for(r=o.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,tt=Wn(r.firstChild),Ut=o,Ne=!0,_s=null,Gn=!0,c=sw(o,null,f,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(mr(),f===p){o=Qi(r,o,c);break e}zt(r,o,f,c)}o=o.child}return o;case 26:return $u(r,o),r===null?(c=k1(o.type,null,o.pendingProps,null))?o.memoizedState=c:Ne||(c=o.type,r=o.pendingProps,f=lh(ve.current).createElement(c),f[Bt]=o,f[rn]=r,It(f,c,r),Ot(f),o.stateNode=f):o.memoizedState=k1(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Vo(o),r===null&&Ne&&(f=o.stateNode=S1(o.type,o.pendingProps,ve.current),Ut=o,Gn=!0,p=tt,js(o.type)?(Vp=p,tt=Wn(f.firstChild)):tt=p),zt(r,o,o.pendingProps.children,c),$u(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Ne&&((p=f=tt)&&(f=bD(f,o.type,o.pendingProps,Gn),f!==null?(o.stateNode=f,Ut=o,tt=Wn(f.firstChild),Gn=!1,p=!0):p=!1),p||xs(o)),Vo(o),p=o.type,y=o.pendingProps,w=r!==null?r.memoizedProps:null,f=y.children,jp(p,y)?f=null:w!==null&&jp(p,w)&&(o.flags|=32),o.memoizedState!==null&&(p=Ug(r,o,L2,null,null,c),Ma._currentValue=p),$u(r,o),zt(r,o,f,c),o.child;case 6:return r===null&&Ne&&((r=c=tt)&&(c=vD(c,o.pendingProps,Gn),c!==null?(o.stateNode=c,Ut=o,tt=null,r=!0):r=!1),r||xs(o)),null;case 13:return uS(r,o,c);case 4:return Qt(o,o.stateNode.containerInfo),f=o.pendingProps,r===null?o.child=_r(o,null,f,c):zt(r,o,f,c),o.child;case 11:return tS(r,o,o.type,o.pendingProps,c);case 7:return zt(r,o,o.pendingProps,c),o.child;case 8:return zt(r,o,o.pendingProps.children,c),o.child;case 12:return zt(r,o,o.pendingProps.children,c),o.child;case 10:return f=o.pendingProps,ks(o,o.type,f.value),zt(r,o,f.children,c),o.child;case 9:return p=o.type._context,f=o.pendingProps.children,br(o),p=jt(p),f=f(p),o.flags|=1,zt(r,o,f,c),o.child;case 14:return nS(r,o,o.type,o.pendingProps,c);case 15:return iS(r,o,o.type,o.pendingProps,c);case 19:return fS(r,o,c);case 31:return q2(r,o,c);case 22:return sS(r,o,c,o.pendingProps);case 24:return br(o),f=jt(mt),r===null?(p=Cg(),p===null&&(p=Ye,y=kg(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=c),p=y),o.memoizedState={parent:f,cache:p},Eg(o),ks(o,mt,p)):((r.lanes&c)!==0&&(Og(r,o),ha(o,null,null,c),ua()),p=r.memoizedState,y=o.memoizedState,p.parent!==f?(p={parent:f,cache:f},o.memoizedState=p,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=p),ks(o,mt,f)):(f=y.cache,ks(o,mt,f),f!==p.cache&&xg(o,[mt],c,!0))),zt(r,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function Zi(r){r.flags|=4}function up(r,o,c,f,p){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(p&335544128)===p)if(r.stateNode.complete)r.flags|=8192;else if(HS())r.flags|=8192;else throw Sr=Eu,Tg}else r.flags&=-16777217}function gS(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!O1(o))if(HS())r.flags|=8192;else throw Sr=Eu,Tg}function Gu(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?Wb():536870912,r.lanes|=o,Rl|=o)}function ya(r,o){if(!Ne)switch(r.tailMode){case"hidden":o=r.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function nt(r){var o=r.alternate!==null&&r.alternate.child===r.child,c=0,f=0;if(o)for(var p=r.child;p!==null;)c|=p.lanes|p.childLanes,f|=p.subtreeFlags&65011712,f|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)c|=p.lanes|p.childLanes,f|=p.subtreeFlags,f|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=f,r.childLanes=c,o}function $2(r,o,c){var f=o.pendingProps;switch(bg(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nt(o),null;case 1:return nt(o),null;case 3:return c=o.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),Fi(mt),ct(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(vl(o)?Zi(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,wg())),nt(o),null;case 26:var p=o.type,y=o.memoizedState;return r===null?(Zi(o),y!==null?(nt(o),gS(o,y)):(nt(o),up(o,p,null,f,c))):y?y!==r.memoizedState?(Zi(o),nt(o),gS(o,y)):(nt(o),o.flags&=-16777217):(r=r.memoizedProps,r!==f&&Zi(o),nt(o),up(o,p,r,f,c)),null;case 27:if(nu(o),c=ve.current,p=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&Zi(o);else{if(!f){if(o.stateNode===null)throw Error(i(166));return nt(o),null}r=Q.current,vl(o)?Wv(o):(r=S1(p,f,c),o.stateNode=r,Zi(o))}return nt(o),null;case 5:if(nu(o),p=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&Zi(o);else{if(!f){if(o.stateNode===null)throw Error(i(166));return nt(o),null}if(y=Q.current,vl(o))Wv(o);else{var w=lh(ve.current);switch(y){case 1:y=w.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=w.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=w.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof f.is=="string"?w.createElement("select",{is:f.is}):w.createElement("select"),f.multiple?y.multiple=!0:f.size&&(y.size=f.size);break;default:y=typeof f.is=="string"?w.createElement(p,{is:f.is}):w.createElement(p)}}y[Bt]=o,y[rn]=f;e:for(w=o.child;w!==null;){if(w.tag===5||w.tag===6)y.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===o)break e;for(;w.sibling===null;){if(w.return===null||w.return===o)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}o.stateNode=y;e:switch(It(y,p,f),p){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Zi(o)}}return nt(o),up(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,c),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==f&&Zi(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(i(166));if(r=ve.current,vl(o)){if(r=o.stateNode,c=o.memoizedProps,f=null,p=Ut,p!==null)switch(p.tag){case 27:case 5:f=p.memoizedProps}r[Bt]=o,r=!!(r.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||u1(r.nodeValue,c)),r||xs(o,!0)}else r=lh(r).createTextNode(f),r[Bt]=o,o.stateNode=r}return nt(o),null;case 31:if(c=o.memoizedState,r===null||r.memoizedState!==null){if(f=vl(o),c!==null){if(r===null){if(!f)throw Error(i(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Bt]=o}else mr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;nt(o),r=!1}else c=wg(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=c),r=!0;if(!r)return o.flags&256?(An(o),o):(An(o),null);if((o.flags&128)!==0)throw Error(i(558))}return nt(o),null;case 13:if(f=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=vl(o),f!==null&&f.dehydrated!==null){if(r===null){if(!p)throw Error(i(318));if(p=o.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Bt]=o}else mr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;nt(o),p=!1}else p=wg(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return o.flags&256?(An(o),o):(An(o),null)}return An(o),(o.flags&128)!==0?(o.lanes=c,o):(c=f!==null,r=r!==null&&r.memoizedState!==null,c&&(f=o.child,p=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(p=f.alternate.memoizedState.cachePool.pool),y=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==p&&(f.flags|=2048)),c!==r&&c&&(o.child.flags|=8192),Gu(o,o.updateQueue),nt(o),null);case 4:return ct(),r===null&&Rp(o.stateNode.containerInfo),nt(o),null;case 10:return Fi(o.type),nt(o),null;case 19:if(H(ut),f=o.memoizedState,f===null)return nt(o),null;if(p=(o.flags&128)!==0,y=f.rendering,y===null)if(p)ya(f,!1);else{if(ot!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(y=Ru(r),y!==null){for(o.flags|=128,ya(f,!1),r=y.updateQueue,o.updateQueue=r,Gu(o,r),o.subtreeFlags=0,r=c,c=o.child;c!==null;)Vv(c,r),c=c.sibling;return W(ut,ut.current&1|2),Ne&&Wi(o,f.treeForkCount),o.child}r=r.sibling}f.tail!==null&&vn()>Ju&&(o.flags|=128,p=!0,ya(f,!1),o.lanes=4194304)}else{if(!p)if(r=Ru(y),r!==null){if(o.flags|=128,p=!0,r=r.updateQueue,o.updateQueue=r,Gu(o,r),ya(f,!0),f.tail===null&&f.tailMode==="hidden"&&!y.alternate&&!Ne)return nt(o),null}else 2*vn()-f.renderingStartTime>Ju&&c!==536870912&&(o.flags|=128,p=!0,ya(f,!1),o.lanes=4194304);f.isBackwards?(y.sibling=o.child,o.child=y):(r=f.last,r!==null?r.sibling=y:o.child=y,f.last=y)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=vn(),r.sibling=null,c=ut.current,W(ut,p?c&1|2:c&1),Ne&&Wi(o,f.treeForkCount),r):(nt(o),null);case 22:case 23:return An(o),Lg(),f=o.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(c&536870912)!==0&&(o.flags&128)===0&&(nt(o),o.subtreeFlags&6&&(o.flags|=8192)):nt(o),c=o.updateQueue,c!==null&&Gu(o,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==c&&(o.flags|=2048),r!==null&&H(vr),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),Fi(mt),nt(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function P2(r,o){switch(bg(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Fi(mt),ct(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return nu(o),null;case 31:if(o.memoizedState!==null){if(An(o),o.alternate===null)throw Error(i(340));mr()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(An(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(i(340));mr()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return H(ut),null;case 4:return ct(),null;case 10:return Fi(o.type),null;case 22:case 23:return An(o),Lg(),r!==null&&H(vr),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return Fi(mt),null;case 25:return null;default:return null}}function pS(r,o){switch(bg(o),o.tag){case 3:Fi(mt),ct();break;case 26:case 27:case 5:nu(o);break;case 4:ct();break;case 31:o.memoizedState!==null&&An(o);break;case 13:An(o);break;case 19:H(ut);break;case 10:Fi(o.type);break;case 22:case 23:An(o),Lg(),r!==null&&H(vr);break;case 24:Fi(mt)}}function ba(r,o){try{var c=o.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var p=f.next;c=p;do{if((c.tag&r)===r){f=void 0;var y=c.create,w=c.inst;f=y(),w.destroy=f}c=c.next}while(c!==p)}}catch(x){$e(o,o.return,x)}}function Ds(r,o,c){try{var f=o.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var y=p.next;f=y;do{if((f.tag&r)===r){var w=f.inst,x=w.destroy;if(x!==void 0){w.destroy=void 0,p=o;var C=c,L=x;try{L()}catch(I){$e(p,C,I)}}}f=f.next}while(f!==y)}}catch(I){$e(o,o.return,I)}}function mS(r){var o=r.updateQueue;if(o!==null){var c=r.stateNode;try{lw(o,c)}catch(f){$e(r,r.return,f)}}}function yS(r,o,c){c.props=kr(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(f){$e(r,o,f)}}function va(r,o){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof c=="function"?r.refCleanup=c(f):c.current=f}}catch(p){$e(r,o,p)}}function _i(r,o){var c=r.ref,f=r.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(p){$e(r,o,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(p){$e(r,o,p)}else c.current=null}function bS(r){var o=r.type,c=r.memoizedProps,f=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(p){$e(r,r.return,p)}}function hp(r,o,c){try{var f=r.stateNode;fD(f,r.type,c,o),f[rn]=o}catch(p){$e(r,r.return,p)}}function vS(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&js(r.type)||r.tag===4}function fp(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||vS(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&js(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function dp(r,o,c){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(r),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Pi));else if(f!==4&&(f===27&&js(r.type)&&(c=r.stateNode,o=null),r=r.child,r!==null))for(dp(r,o,c),r=r.sibling;r!==null;)dp(r,o,c),r=r.sibling}function Ku(r,o,c){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?c.insertBefore(r,o):c.appendChild(r);else if(f!==4&&(f===27&&js(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(Ku(r,o,c),r=r.sibling;r!==null;)Ku(r,o,c),r=r.sibling}function wS(r){var o=r.stateNode,c=r.memoizedProps;try{for(var f=r.type,p=o.attributes;p.length;)o.removeAttributeNode(p[0]);It(o,f,c),o[Bt]=r,o[rn]=c}catch(y){$e(r,r.return,y)}}var es=!1,vt=!1,gp=!1,SS=typeof WeakSet=="function"?WeakSet:Set,Dt=null;function G2(r,o){if(r=r.containerInfo,Bp=dh,r=Lv(r),og(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var p=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var w=0,x=-1,C=-1,L=0,I=0,G=r,N=null;t:for(;;){for(var U;G!==c||p!==0&&G.nodeType!==3||(x=w+p),G!==y||f!==0&&G.nodeType!==3||(C=w+f),G.nodeType===3&&(w+=G.nodeValue.length),(U=G.firstChild)!==null;)N=G,G=U;for(;;){if(G===r)break t;if(N===c&&++L===p&&(x=w),N===y&&++I===f&&(C=w),(U=G.nextSibling)!==null)break;G=N,N=G.parentNode}G=U}c=x===-1||C===-1?null:{start:x,end:C}}else c=null}c=c||{start:0,end:0}}else c=null;for(Up={focusedElem:r,selectionRange:c},dh=!1,Dt=o;Dt!==null;)if(o=Dt,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Dt=r;else for(;Dt!==null;){switch(o=Dt,y=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(c=0;c<r.length;c++)p=r[c],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,c=o,p=y.memoizedProps,y=y.memoizedState,f=c.stateNode;try{var ne=kr(c.type,p);r=f.getSnapshotBeforeUpdate(ne,y),f.__reactInternalSnapshotBeforeUpdate=r}catch(ue){$e(c,c.return,ue)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,c=r.nodeType,c===9)Ip(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Ip(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=o.sibling,r!==null){r.return=o.return,Dt=r;break}Dt=o.return}}function _S(r,o,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:ns(r,c),f&4&&ba(5,c);break;case 1:if(ns(r,c),f&4)if(r=c.stateNode,o===null)try{r.componentDidMount()}catch(w){$e(c,c.return,w)}else{var p=kr(c.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(p,o,r.__reactInternalSnapshotBeforeUpdate)}catch(w){$e(c,c.return,w)}}f&64&&mS(c),f&512&&va(c,c.return);break;case 3:if(ns(r,c),f&64&&(r=c.updateQueue,r!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{lw(r,o)}catch(w){$e(c,c.return,w)}}break;case 27:o===null&&f&4&&wS(c);case 26:case 5:ns(r,c),o===null&&f&4&&bS(c),f&512&&va(c,c.return);break;case 12:ns(r,c);break;case 31:ns(r,c),f&4&&AS(r,c);break;case 13:ns(r,c),f&4&&CS(r,c),f&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=eD.bind(null,c),wD(r,c))));break;case 22:if(f=c.memoizedState!==null||es,!f){o=o!==null&&o.memoizedState!==null||vt,p=es;var y=vt;es=f,(vt=o)&&!y?is(r,c,(c.subtreeFlags&8772)!==0):ns(r,c),es=p,vt=y}break;case 30:break;default:ns(r,c)}}function xS(r){var o=r.alternate;o!==null&&(r.alternate=null,xS(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&Pd(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var it=null,on=!1;function ts(r,o,c){for(c=c.child;c!==null;)kS(r,o,c),c=c.sibling}function kS(r,o,c){if(wn&&typeof wn.onCommitFiberUnmount=="function")try{wn.onCommitFiberUnmount($o,c)}catch{}switch(c.tag){case 26:vt||_i(c,o),ts(r,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:vt||_i(c,o);var f=it,p=on;js(c.type)&&(it=c.stateNode,on=!1),ts(r,o,c),Ea(c.stateNode),it=f,on=p;break;case 5:vt||_i(c,o);case 6:if(f=it,p=on,it=null,ts(r,o,c),it=f,on=p,it!==null)if(on)try{(it.nodeType===9?it.body:it.nodeName==="HTML"?it.ownerDocument.body:it).removeChild(c.stateNode)}catch(y){$e(c,o,y)}else try{it.removeChild(c.stateNode)}catch(y){$e(c,o,y)}break;case 18:it!==null&&(on?(r=it,m1(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),Hl(r)):m1(it,c.stateNode));break;case 4:f=it,p=on,it=c.stateNode.containerInfo,on=!0,ts(r,o,c),it=f,on=p;break;case 0:case 11:case 14:case 15:Ds(2,c,o),vt||Ds(4,c,o),ts(r,o,c);break;case 1:vt||(_i(c,o),f=c.stateNode,typeof f.componentWillUnmount=="function"&&yS(c,o,f)),ts(r,o,c);break;case 21:ts(r,o,c);break;case 22:vt=(f=vt)||c.memoizedState!==null,ts(r,o,c),vt=f;break;default:ts(r,o,c)}}function AS(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Hl(r)}catch(c){$e(o,o.return,c)}}}function CS(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Hl(r)}catch(c){$e(o,o.return,c)}}function K2(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new SS),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new SS),o;default:throw Error(i(435,r.tag))}}function Wu(r,o){var c=K2(r);o.forEach(function(f){if(!c.has(f)){c.add(f);var p=tD.bind(null,r,f);f.then(p,p)}})}function an(r,o){var c=o.deletions;if(c!==null)for(var f=0;f<c.length;f++){var p=c[f],y=r,w=o,x=w;e:for(;x!==null;){switch(x.tag){case 27:if(js(x.type)){it=x.stateNode,on=!1;break e}break;case 5:it=x.stateNode,on=!1;break e;case 3:case 4:it=x.stateNode.containerInfo,on=!0;break e}x=x.return}if(it===null)throw Error(i(160));kS(y,w,p),it=null,on=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)TS(o,r),o=o.sibling}var li=null;function TS(r,o){var c=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:an(o,r),cn(r),f&4&&(Ds(3,r,r.return),ba(3,r),Ds(5,r,r.return));break;case 1:an(o,r),cn(r),f&512&&(vt||c===null||_i(c,c.return)),f&64&&es&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var p=li;if(an(o,r),cn(r),f&512&&(vt||c===null||_i(c,c.return)),f&4){var y=c!==null?c.memoizedState:null;if(f=r.memoizedState,c===null)if(f===null)if(r.stateNode===null){e:{f=r.type,c=r.memoizedProps,p=p.ownerDocument||p;t:switch(f){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Ko]||y[Bt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(f),p.head.insertBefore(y,p.querySelector("head > title"))),It(y,f,c),y[Bt]=r,Ot(y),f=y;break e;case"link":var w=T1("link","href",p).get(f+(c.href||""));if(w){for(var x=0;x<w.length;x++)if(y=w[x],y.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&y.getAttribute("rel")===(c.rel==null?null:c.rel)&&y.getAttribute("title")===(c.title==null?null:c.title)&&y.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){w.splice(x,1);break t}}y=p.createElement(f),It(y,f,c),p.head.appendChild(y);break;case"meta":if(w=T1("meta","content",p).get(f+(c.content||""))){for(x=0;x<w.length;x++)if(y=w[x],y.getAttribute("content")===(c.content==null?null:""+c.content)&&y.getAttribute("name")===(c.name==null?null:c.name)&&y.getAttribute("property")===(c.property==null?null:c.property)&&y.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&y.getAttribute("charset")===(c.charSet==null?null:c.charSet)){w.splice(x,1);break t}}y=p.createElement(f),It(y,f,c),p.head.appendChild(y);break;default:throw Error(i(468,f))}y[Bt]=r,Ot(y),f=y}r.stateNode=f}else E1(p,r.type,r.stateNode);else r.stateNode=C1(p,f,r.memoizedProps);else y!==f?(y===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):y.count--,f===null?E1(p,r.type,r.stateNode):C1(p,f,r.memoizedProps)):f===null&&r.stateNode!==null&&hp(r,r.memoizedProps,c.memoizedProps)}break;case 27:an(o,r),cn(r),f&512&&(vt||c===null||_i(c,c.return)),c!==null&&f&4&&hp(r,r.memoizedProps,c.memoizedProps);break;case 5:if(an(o,r),cn(r),f&512&&(vt||c===null||_i(c,c.return)),r.flags&32){p=r.stateNode;try{cl(p,"")}catch(ne){$e(r,r.return,ne)}}f&4&&r.stateNode!=null&&(p=r.memoizedProps,hp(r,p,c!==null?c.memoizedProps:p)),f&1024&&(gp=!0);break;case 6:if(an(o,r),cn(r),f&4){if(r.stateNode===null)throw Error(i(162));f=r.memoizedProps,c=r.stateNode;try{c.nodeValue=f}catch(ne){$e(r,r.return,ne)}}break;case 3:if(ch=null,p=li,li=oh(o.containerInfo),an(o,r),li=p,cn(r),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Hl(o.containerInfo)}catch(ne){$e(r,r.return,ne)}gp&&(gp=!1,ES(r));break;case 4:f=li,li=oh(r.stateNode.containerInfo),an(o,r),cn(r),li=f;break;case 12:an(o,r),cn(r);break;case 31:an(o,r),cn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Wu(r,f)));break;case 13:an(o,r),cn(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Fu=vn()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Wu(r,f)));break;case 22:p=r.memoizedState!==null;var C=c!==null&&c.memoizedState!==null,L=es,I=vt;if(es=L||p,vt=I||C,an(o,r),vt=I,es=L,cn(r),f&8192)e:for(o=r.stateNode,o._visibility=p?o._visibility&-2:o._visibility|1,p&&(c===null||C||es||vt||Ar(r)),c=null,o=r;;){if(o.tag===5||o.tag===26){if(c===null){C=c=o;try{if(y=C.stateNode,p)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{x=C.stateNode;var G=C.memoizedProps.style,N=G!=null&&G.hasOwnProperty("display")?G.display:null;x.style.display=N==null||typeof N=="boolean"?"":(""+N).trim()}}catch(ne){$e(C,C.return,ne)}}}else if(o.tag===6){if(c===null){C=o;try{C.stateNode.nodeValue=p?"":C.memoizedProps}catch(ne){$e(C,C.return,ne)}}}else if(o.tag===18){if(c===null){C=o;try{var U=C.stateNode;p?y1(U,!0):y1(C.stateNode,!1)}catch(ne){$e(C,C.return,ne)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=r.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,Wu(r,c))));break;case 19:an(o,r),cn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Wu(r,f)));break;case 30:break;case 21:break;default:an(o,r),cn(r)}}function cn(r){var o=r.flags;if(o&2){try{for(var c,f=r.return;f!==null;){if(vS(f)){c=f;break}f=f.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var p=c.stateNode,y=fp(r);Ku(r,y,p);break;case 5:var w=c.stateNode;c.flags&32&&(cl(w,""),c.flags&=-33);var x=fp(r);Ku(r,x,w);break;case 3:case 4:var C=c.stateNode.containerInfo,L=fp(r);dp(r,L,C);break;default:throw Error(i(161))}}catch(I){$e(r,r.return,I)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function ES(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;ES(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function ns(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)_S(r,o.alternate,o),o=o.sibling}function Ar(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:Ds(4,o,o.return),Ar(o);break;case 1:_i(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&yS(o,o.return,c),Ar(o);break;case 27:Ea(o.stateNode);case 26:case 5:_i(o,o.return),Ar(o);break;case 22:o.memoizedState===null&&Ar(o);break;case 30:Ar(o);break;default:Ar(o)}r=r.sibling}}function is(r,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,p=r,y=o,w=y.flags;switch(y.tag){case 0:case 11:case 15:is(p,y,c),ba(4,y);break;case 1:if(is(p,y,c),f=y,p=f.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(L){$e(f,f.return,L)}if(f=y,p=f.updateQueue,p!==null){var x=f.stateNode;try{var C=p.shared.hiddenCallbacks;if(C!==null)for(p.shared.hiddenCallbacks=null,p=0;p<C.length;p++)rw(C[p],x)}catch(L){$e(f,f.return,L)}}c&&w&64&&mS(y),va(y,y.return);break;case 27:wS(y);case 26:case 5:is(p,y,c),c&&f===null&&w&4&&bS(y),va(y,y.return);break;case 12:is(p,y,c);break;case 31:is(p,y,c),c&&w&4&&AS(p,y);break;case 13:is(p,y,c),c&&w&4&&CS(p,y);break;case 22:y.memoizedState===null&&is(p,y,c),va(y,y.return);break;case 30:break;default:is(p,y,c)}o=o.sibling}}function pp(r,o){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&ra(c))}function mp(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&ra(r))}function oi(r,o,c,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)OS(r,o,c,f),o=o.sibling}function OS(r,o,c,f){var p=o.flags;switch(o.tag){case 0:case 11:case 15:oi(r,o,c,f),p&2048&&ba(9,o);break;case 1:oi(r,o,c,f);break;case 3:oi(r,o,c,f),p&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&ra(r)));break;case 12:if(p&2048){oi(r,o,c,f),r=o.stateNode;try{var y=o.memoizedProps,w=y.id,x=y.onPostCommit;typeof x=="function"&&x(w,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(C){$e(o,o.return,C)}}else oi(r,o,c,f);break;case 31:oi(r,o,c,f);break;case 13:oi(r,o,c,f);break;case 23:break;case 22:y=o.stateNode,w=o.alternate,o.memoizedState!==null?y._visibility&2?oi(r,o,c,f):wa(r,o):y._visibility&2?oi(r,o,c,f):(y._visibility|=2,Ol(r,o,c,f,(o.subtreeFlags&10256)!==0||!1)),p&2048&&pp(w,o);break;case 24:oi(r,o,c,f),p&2048&&mp(o.alternate,o);break;default:oi(r,o,c,f)}}function Ol(r,o,c,f,p){for(p=p&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var y=r,w=o,x=c,C=f,L=w.flags;switch(w.tag){case 0:case 11:case 15:Ol(y,w,x,C,p),ba(8,w);break;case 23:break;case 22:var I=w.stateNode;w.memoizedState!==null?I._visibility&2?Ol(y,w,x,C,p):wa(y,w):(I._visibility|=2,Ol(y,w,x,C,p)),p&&L&2048&&pp(w.alternate,w);break;case 24:Ol(y,w,x,C,p),p&&L&2048&&mp(w.alternate,w);break;default:Ol(y,w,x,C,p)}o=o.sibling}}function wa(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=r,f=o,p=f.flags;switch(f.tag){case 22:wa(c,f),p&2048&&pp(f.alternate,f);break;case 24:wa(c,f),p&2048&&mp(f.alternate,f);break;default:wa(c,f)}o=o.sibling}}var Sa=8192;function Dl(r,o,c){if(r.subtreeFlags&Sa)for(r=r.child;r!==null;)DS(r,o,c),r=r.sibling}function DS(r,o,c){switch(r.tag){case 26:Dl(r,o,c),r.flags&Sa&&r.memoizedState!==null&&RD(c,li,r.memoizedState,r.memoizedProps);break;case 5:Dl(r,o,c);break;case 3:case 4:var f=li;li=oh(r.stateNode.containerInfo),Dl(r,o,c),li=f;break;case 22:r.memoizedState===null&&(f=r.alternate,f!==null&&f.memoizedState!==null?(f=Sa,Sa=16777216,Dl(r,o,c),Sa=f):Dl(r,o,c));break;default:Dl(r,o,c)}}function MS(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function _a(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var f=o[c];Dt=f,LS(f,r)}MS(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)RS(r),r=r.sibling}function RS(r){switch(r.tag){case 0:case 11:case 15:_a(r),r.flags&2048&&Ds(9,r,r.return);break;case 3:_a(r);break;case 12:_a(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Yu(r)):_a(r);break;default:_a(r)}}function Yu(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var f=o[c];Dt=f,LS(f,r)}MS(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:Ds(8,o,o.return),Yu(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,Yu(o));break;default:Yu(o)}r=r.sibling}}function LS(r,o){for(;Dt!==null;){var c=Dt;switch(c.tag){case 0:case 11:case 15:Ds(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:ra(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,Dt=f;else e:for(c=r;Dt!==null;){f=Dt;var p=f.sibling,y=f.return;if(xS(f),f===c){Dt=null;break e}if(p!==null){p.return=y,Dt=p;break e}Dt=y}}}var W2={getCacheForType:function(r){var o=jt(mt),c=o.data.get(r);return c===void 0&&(c=r(),o.data.set(r,c)),c},cacheSignal:function(){return jt(mt).controller.signal}},Y2=typeof WeakMap=="function"?WeakMap:Map,qe=0,Ye=null,Oe=null,Re=0,Ve=0,Cn=null,Ms=!1,Ml=!1,yp=!1,ss=0,ot=0,Rs=0,Cr=0,bp=0,Tn=0,Rl=0,xa=null,un=null,vp=!1,Fu=0,NS=0,Ju=1/0,Xu=null,Ls=null,xt=0,Ns=null,Ll=null,rs=0,wp=0,Sp=null,BS=null,ka=0,_p=null;function En(){return(qe&2)!==0&&Re!==0?Re&-Re:B.T!==null?Ep():Xb()}function US(){if(Tn===0)if((Re&536870912)===0||Ne){var r=ru;ru<<=1,(ru&3932160)===0&&(ru=262144),Tn=r}else Tn=536870912;return r=kn.current,r!==null&&(r.flags|=32),Tn}function hn(r,o,c){(r===Ye&&(Ve===2||Ve===9)||r.cancelPendingCommit!==null)&&(Nl(r,0),Bs(r,Re,Tn,!1)),Go(r,c),((qe&2)===0||r!==Ye)&&(r===Ye&&((qe&2)===0&&(Cr|=c),ot===4&&Bs(r,Re,Tn,!1)),xi(r))}function jS(r,o,c){if((qe&6)!==0)throw Error(i(327));var f=!c&&(o&127)===0&&(o&r.expiredLanes)===0||Po(r,o),p=f?X2(r,o):kp(r,o,!0),y=f;do{if(p===0){Ml&&!f&&Bs(r,o,0,!1);break}else{if(c=r.current.alternate,y&&!F2(c)){p=kp(r,o,!1),y=!1;continue}if(p===2){if(y=o,r.errorRecoveryDisabledLanes&y)var w=0;else w=r.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){o=w;e:{var x=r;p=xa;var C=x.current.memoizedState.isDehydrated;if(C&&(Nl(x,w).flags|=256),w=kp(x,w,!1),w!==2){if(yp&&!C){x.errorRecoveryDisabledLanes|=y,Cr|=y,p=4;break e}y=un,un=p,y!==null&&(un===null?un=y:un.push.apply(un,y))}p=w}if(y=!1,p!==2)continue}}if(p===1){Nl(r,0),Bs(r,o,0,!0);break}e:{switch(f=r,y=p,y){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:Bs(f,o,Tn,!Ms);break e;case 2:un=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(p=Fu+300-vn(),10<p)){if(Bs(f,o,Tn,!Ms),ou(f,0,!0)!==0)break e;rs=o,f.timeoutHandle=g1(zS.bind(null,f,c,un,Xu,vp,o,Tn,Cr,Rl,Ms,y,"Throttled",-0,0),p);break e}zS(f,c,un,Xu,vp,o,Tn,Cr,Rl,Ms,y,null,-0,0)}}break}while(!0);xi(r)}function zS(r,o,c,f,p,y,w,x,C,L,I,G,N,U){if(r.timeoutHandle=-1,G=o.subtreeFlags,G&8192||(G&16785408)===16785408){G={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pi},DS(o,y,G);var ne=(y&62914560)===y?Fu-vn():(y&4194048)===y?NS-vn():0;if(ne=LD(G,ne),ne!==null){rs=y,r.cancelPendingCommit=ne(KS.bind(null,r,o,y,c,f,p,w,x,C,I,G,null,N,U)),Bs(r,y,w,!L);return}}KS(r,o,y,c,f,p,w,x,C)}function F2(r){for(var o=r;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var p=c[f],y=p.getSnapshot;p=p.value;try{if(!_n(y(),p))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Bs(r,o,c,f){o&=~bp,o&=~Cr,r.suspendedLanes|=o,r.pingedLanes&=~o,f&&(r.warmLanes|=o),f=r.expirationTimes;for(var p=o;0<p;){var y=31-Sn(p),w=1<<y;f[y]=-1,p&=~w}c!==0&&Yb(r,c,o)}function Qu(){return(qe&6)===0?(Aa(0),!1):!0}function xp(){if(Oe!==null){if(Ve===0)var r=Oe.return;else r=Oe,Yi=yr=null,Ig(r),kl=null,oa=0,r=Oe;for(;r!==null;)pS(r.alternate,r),r=r.return;Oe=null}}function Nl(r,o){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,pD(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),rs=0,xp(),Ye=r,Oe=c=Ki(r.current,null),Re=o,Ve=0,Cn=null,Ms=!1,Ml=Po(r,o),yp=!1,Rl=Tn=bp=Cr=Rs=ot=0,un=xa=null,vp=!1,(o&8)!==0&&(o|=o&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=o;0<f;){var p=31-Sn(f),y=1<<p;o|=r[p],f&=~y}return ss=o,vu(),c}function IS(r,o){we=null,B.H=pa,o===xl||o===Tu?(o=tw(),Ve=3):o===Tg?(o=tw(),Ve=4):Ve=o===tp?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Cn=o,Oe===null&&(ot=1,qu(r,Vn(o,r.current)))}function HS(){var r=kn.current;return r===null?!0:(Re&4194048)===Re?Kn===null:(Re&62914560)===Re||(Re&536870912)!==0?r===Kn:!1}function qS(){var r=B.H;return B.H=pa,r===null?pa:r}function VS(){var r=B.A;return B.A=W2,r}function Zu(){ot=4,Ms||(Re&4194048)!==Re&&kn.current!==null||(Ml=!0),(Rs&134217727)===0&&(Cr&134217727)===0||Ye===null||Bs(Ye,Re,Tn,!1)}function kp(r,o,c){var f=qe;qe|=2;var p=qS(),y=VS();(Ye!==r||Re!==o)&&(Xu=null,Nl(r,o)),o=!1;var w=ot;e:do try{if(Ve!==0&&Oe!==null){var x=Oe,C=Cn;switch(Ve){case 8:xp(),w=6;break e;case 3:case 2:case 9:case 6:kn.current===null&&(o=!0);var L=Ve;if(Ve=0,Cn=null,Bl(r,x,C,L),c&&Ml){w=0;break e}break;default:L=Ve,Ve=0,Cn=null,Bl(r,x,C,L)}}J2(),w=ot;break}catch(I){IS(r,I)}while(!0);return o&&r.shellSuspendCounter++,Yi=yr=null,qe=f,B.H=p,B.A=y,Oe===null&&(Ye=null,Re=0,vu()),w}function J2(){for(;Oe!==null;)$S(Oe)}function X2(r,o){var c=qe;qe|=2;var f=qS(),p=VS();Ye!==r||Re!==o?(Xu=null,Ju=vn()+500,Nl(r,o)):Ml=Po(r,o);e:do try{if(Ve!==0&&Oe!==null){o=Oe;var y=Cn;t:switch(Ve){case 1:Ve=0,Cn=null,Bl(r,o,y,1);break;case 2:case 9:if(Zv(y)){Ve=0,Cn=null,PS(o);break}o=function(){Ve!==2&&Ve!==9||Ye!==r||(Ve=7),xi(r)},y.then(o,o);break e;case 3:Ve=7;break e;case 4:Ve=5;break e;case 7:Zv(y)?(Ve=0,Cn=null,PS(o)):(Ve=0,Cn=null,Bl(r,o,y,7));break;case 5:var w=null;switch(Oe.tag){case 26:w=Oe.memoizedState;case 5:case 27:var x=Oe;if(w?O1(w):x.stateNode.complete){Ve=0,Cn=null;var C=x.sibling;if(C!==null)Oe=C;else{var L=x.return;L!==null?(Oe=L,eh(L)):Oe=null}break t}}Ve=0,Cn=null,Bl(r,o,y,5);break;case 6:Ve=0,Cn=null,Bl(r,o,y,6);break;case 8:xp(),ot=6;break e;default:throw Error(i(462))}}Q2();break}catch(I){IS(r,I)}while(!0);return Yi=yr=null,B.H=f,B.A=p,qe=c,Oe!==null?0:(Ye=null,Re=0,vu(),ot)}function Q2(){for(;Oe!==null&&!SO();)$S(Oe)}function $S(r){var o=dS(r.alternate,r,ss);r.memoizedProps=r.pendingProps,o===null?eh(r):Oe=o}function PS(r){var o=r,c=o.alternate;switch(o.tag){case 15:case 0:o=oS(c,o,o.pendingProps,o.type,void 0,Re);break;case 11:o=oS(c,o,o.pendingProps,o.type.render,o.ref,Re);break;case 5:Ig(o);default:pS(c,o),o=Oe=Vv(o,ss),o=dS(c,o,ss)}r.memoizedProps=r.pendingProps,o===null?eh(r):Oe=o}function Bl(r,o,c,f){Yi=yr=null,Ig(o),kl=null,oa=0;var p=o.return;try{if(H2(r,p,o,c,Re)){ot=1,qu(r,Vn(c,r.current)),Oe=null;return}}catch(y){if(p!==null)throw Oe=p,y;ot=1,qu(r,Vn(c,r.current)),Oe=null;return}o.flags&32768?(Ne||f===1?r=!0:Ml||(Re&536870912)!==0?r=!1:(Ms=r=!0,(f===2||f===9||f===3||f===6)&&(f=kn.current,f!==null&&f.tag===13&&(f.flags|=16384))),GS(o,r)):eh(o)}function eh(r){var o=r;do{if((o.flags&32768)!==0){GS(o,Ms);return}r=o.return;var c=$2(o.alternate,o,ss);if(c!==null){Oe=c;return}if(o=o.sibling,o!==null){Oe=o;return}Oe=o=r}while(o!==null);ot===0&&(ot=5)}function GS(r,o){do{var c=P2(r.alternate,r);if(c!==null){c.flags&=32767,Oe=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(r=r.sibling,r!==null)){Oe=r;return}Oe=r=c}while(r!==null);ot=6,Oe=null}function KS(r,o,c,f,p,y,w,x,C){r.cancelPendingCommit=null;do th();while(xt!==0);if((qe&6)!==0)throw Error(i(327));if(o!==null){if(o===r.current)throw Error(i(177));if(y=o.lanes|o.childLanes,y|=fg,MO(r,c,y,w,x,C),r===Ye&&(Oe=Ye=null,Re=0),Ll=o,Ns=r,rs=c,wp=y,Sp=p,BS=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,nD(iu,function(){return XS(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=B.T,B.T=null,p=K.p,K.p=2,w=qe,qe|=4;try{G2(r,o,c)}finally{qe=w,K.p=p,B.T=f}}xt=1,WS(),YS(),FS()}}function WS(){if(xt===1){xt=0;var r=Ns,o=Ll,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=B.T,B.T=null;var f=K.p;K.p=2;var p=qe;qe|=4;try{TS(o,r);var y=Up,w=Lv(r.containerInfo),x=y.focusedElem,C=y.selectionRange;if(w!==x&&x&&x.ownerDocument&&Rv(x.ownerDocument.documentElement,x)){if(C!==null&&og(x)){var L=C.start,I=C.end;if(I===void 0&&(I=L),"selectionStart"in x)x.selectionStart=L,x.selectionEnd=Math.min(I,x.value.length);else{var G=x.ownerDocument||document,N=G&&G.defaultView||window;if(N.getSelection){var U=N.getSelection(),ne=x.textContent.length,ue=Math.min(C.start,ne),Ke=C.end===void 0?ue:Math.min(C.end,ne);!U.extend&&ue>Ke&&(w=Ke,Ke=ue,ue=w);var D=Mv(x,ue),E=Mv(x,Ke);if(D&&E&&(U.rangeCount!==1||U.anchorNode!==D.node||U.anchorOffset!==D.offset||U.focusNode!==E.node||U.focusOffset!==E.offset)){var R=G.createRange();R.setStart(D.node,D.offset),U.removeAllRanges(),ue>Ke?(U.addRange(R),U.extend(E.node,E.offset)):(R.setEnd(E.node,E.offset),U.addRange(R))}}}}for(G=[],U=x;U=U.parentNode;)U.nodeType===1&&G.push({element:U,left:U.scrollLeft,top:U.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<G.length;x++){var $=G[x];$.element.scrollLeft=$.left,$.element.scrollTop=$.top}}dh=!!Bp,Up=Bp=null}finally{qe=p,K.p=f,B.T=c}}r.current=o,xt=2}}function YS(){if(xt===2){xt=0;var r=Ns,o=Ll,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=B.T,B.T=null;var f=K.p;K.p=2;var p=qe;qe|=4;try{_S(r,o.alternate,o)}finally{qe=p,K.p=f,B.T=c}}xt=3}}function FS(){if(xt===4||xt===3){xt=0,_O();var r=Ns,o=Ll,c=rs,f=BS;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?xt=5:(xt=0,Ll=Ns=null,JS(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&(Ls=null),Vd(c),o=o.stateNode,wn&&typeof wn.onCommitFiberRoot=="function")try{wn.onCommitFiberRoot($o,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=B.T,p=K.p,K.p=2,B.T=null;try{for(var y=r.onRecoverableError,w=0;w<f.length;w++){var x=f[w];y(x.value,{componentStack:x.stack})}}finally{B.T=o,K.p=p}}(rs&3)!==0&&th(),xi(r),p=r.pendingLanes,(c&261930)!==0&&(p&42)!==0?r===_p?ka++:(ka=0,_p=r):ka=0,Aa(0)}}function JS(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,ra(o)))}function th(){return WS(),YS(),FS(),XS()}function XS(){if(xt!==5)return!1;var r=Ns,o=wp;wp=0;var c=Vd(rs),f=B.T,p=K.p;try{K.p=32>c?32:c,B.T=null,c=Sp,Sp=null;var y=Ns,w=rs;if(xt=0,Ll=Ns=null,rs=0,(qe&6)!==0)throw Error(i(331));var x=qe;if(qe|=4,RS(y.current),OS(y,y.current,w,c),qe=x,Aa(0,!1),wn&&typeof wn.onPostCommitFiberRoot=="function")try{wn.onPostCommitFiberRoot($o,y)}catch{}return!0}finally{K.p=p,B.T=f,JS(r,o)}}function QS(r,o,c){o=Vn(c,o),o=ep(r.stateNode,o,2),r=Ts(r,o,2),r!==null&&(Go(r,2),xi(r))}function $e(r,o,c){if(r.tag===3)QS(r,r,c);else for(;o!==null;){if(o.tag===3){QS(o,r,c);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Ls===null||!Ls.has(f))){r=Vn(c,r),c=Zw(2),f=Ts(o,c,2),f!==null&&(eS(c,f,o,r),Go(f,2),xi(f));break}}o=o.return}}function Ap(r,o,c){var f=r.pingCache;if(f===null){f=r.pingCache=new Y2;var p=new Set;f.set(o,p)}else p=f.get(o),p===void 0&&(p=new Set,f.set(o,p));p.has(c)||(yp=!0,p.add(c),r=Z2.bind(null,r,o,c),o.then(r,r))}function Z2(r,o,c){var f=r.pingCache;f!==null&&f.delete(o),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,Ye===r&&(Re&c)===c&&(ot===4||ot===3&&(Re&62914560)===Re&&300>vn()-Fu?(qe&2)===0&&Nl(r,0):bp|=c,Rl===Re&&(Rl=0)),xi(r)}function ZS(r,o){o===0&&(o=Wb()),r=gr(r,o),r!==null&&(Go(r,o),xi(r))}function eD(r){var o=r.memoizedState,c=0;o!==null&&(c=o.retryLane),ZS(r,c)}function tD(r,o){var c=0;switch(r.tag){case 31:case 13:var f=r.stateNode,p=r.memoizedState;p!==null&&(c=p.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(i(314))}f!==null&&f.delete(o),ZS(r,c)}function nD(r,o){return zd(r,o)}var nh=null,Ul=null,Cp=!1,ih=!1,Tp=!1,Us=0;function xi(r){r!==Ul&&r.next===null&&(Ul===null?nh=Ul=r:Ul=Ul.next=r),ih=!0,Cp||(Cp=!0,sD())}function Aa(r,o){if(!Tp&&ih){Tp=!0;do for(var c=!1,f=nh;f!==null;){if(r!==0){var p=f.pendingLanes;if(p===0)var y=0;else{var w=f.suspendedLanes,x=f.pingedLanes;y=(1<<31-Sn(42|r)+1)-1,y&=p&~(w&~x),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(c=!0,i1(f,y))}else y=Re,y=ou(f,f===Ye?y:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(y&3)===0||Po(f,y)||(c=!0,i1(f,y));f=f.next}while(c);Tp=!1}}function iD(){e1()}function e1(){ih=Cp=!1;var r=0;Us!==0&&gD()&&(r=Us);for(var o=vn(),c=null,f=nh;f!==null;){var p=f.next,y=t1(f,o);y===0?(f.next=null,c===null?nh=p:c.next=p,p===null&&(Ul=c)):(c=f,(r!==0||(y&3)!==0)&&(ih=!0)),f=p}xt!==0&&xt!==5||Aa(r),Us!==0&&(Us=0)}function t1(r,o){for(var c=r.suspendedLanes,f=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var w=31-Sn(y),x=1<<w,C=p[w];C===-1?((x&c)===0||(x&f)!==0)&&(p[w]=DO(x,o)):C<=o&&(r.expiredLanes|=x),y&=~x}if(o=Ye,c=Re,c=ou(r,r===o?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,c===0||r===o&&(Ve===2||Ve===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&Id(f),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||Po(r,c)){if(o=c&-c,o===r.callbackPriority)return o;switch(f!==null&&Id(f),Vd(c)){case 2:case 8:c=Gb;break;case 32:c=iu;break;case 268435456:c=Kb;break;default:c=iu}return f=n1.bind(null,r),c=zd(c,f),r.callbackPriority=o,r.callbackNode=c,o}return f!==null&&f!==null&&Id(f),r.callbackPriority=2,r.callbackNode=null,2}function n1(r,o){if(xt!==0&&xt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(th()&&r.callbackNode!==c)return null;var f=Re;return f=ou(r,r===Ye?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(jS(r,f,o),t1(r,vn()),r.callbackNode!=null&&r.callbackNode===c?n1.bind(null,r):null)}function i1(r,o){if(th())return null;jS(r,o,!0)}function sD(){mD(function(){(qe&6)!==0?zd(Pb,iD):e1()})}function Ep(){if(Us===0){var r=Sl;r===0&&(r=su,su<<=1,(su&261888)===0&&(su=256)),Us=r}return Us}function s1(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:hu(""+r)}function r1(r,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,r.id&&c.setAttribute("form",r.id),o.parentNode.insertBefore(c,o),r=new FormData(r),c.parentNode.removeChild(c),r}function rD(r,o,c,f,p){if(o==="submit"&&c&&c.stateNode===p){var y=s1((p[rn]||null).action),w=f.submitter;w&&(o=(o=w[rn]||null)?s1(o.formAction):w.getAttribute("formAction"),o!==null&&(y=o,w=null));var x=new pu("action","action",null,f,p);r.push({event:x,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Us!==0){var C=w?r1(p,w):new FormData(p);Yg(c,{pending:!0,data:C,method:p.method,action:y},null,C)}}else typeof y=="function"&&(x.preventDefault(),C=w?r1(p,w):new FormData(p),Yg(c,{pending:!0,data:C,method:p.method,action:y},y,C))},currentTarget:p}]})}}for(var Op=0;Op<hg.length;Op++){var Dp=hg[Op],lD=Dp.toLowerCase(),oD=Dp[0].toUpperCase()+Dp.slice(1);ri(lD,"on"+oD)}ri(Uv,"onAnimationEnd"),ri(jv,"onAnimationIteration"),ri(zv,"onAnimationStart"),ri("dblclick","onDoubleClick"),ri("focusin","onFocus"),ri("focusout","onBlur"),ri(x2,"onTransitionRun"),ri(k2,"onTransitionStart"),ri(A2,"onTransitionCancel"),ri(Iv,"onTransitionEnd"),ol("onMouseEnter",["mouseout","mouseover"]),ol("onMouseLeave",["mouseout","mouseover"]),ol("onPointerEnter",["pointerout","pointerover"]),ol("onPointerLeave",["pointerout","pointerover"]),ur("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ur("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ur("onBeforeInput",["compositionend","keypress","textInput","paste"]),ur("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ur("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ur("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ca="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ca));function l1(r,o){o=(o&4)!==0;for(var c=0;c<r.length;c++){var f=r[c],p=f.event;f=f.listeners;e:{var y=void 0;if(o)for(var w=f.length-1;0<=w;w--){var x=f[w],C=x.instance,L=x.currentTarget;if(x=x.listener,C!==y&&p.isPropagationStopped())break e;y=x,p.currentTarget=L;try{y(p)}catch(I){bu(I)}p.currentTarget=null,y=C}else for(w=0;w<f.length;w++){if(x=f[w],C=x.instance,L=x.currentTarget,x=x.listener,C!==y&&p.isPropagationStopped())break e;y=x,p.currentTarget=L;try{y(p)}catch(I){bu(I)}p.currentTarget=null,y=C}}}}function De(r,o){var c=o[$d];c===void 0&&(c=o[$d]=new Set);var f=r+"__bubble";c.has(f)||(o1(o,r,2,!1),c.add(f))}function Mp(r,o,c){var f=0;o&&(f|=4),o1(c,r,f,o)}var sh="_reactListening"+Math.random().toString(36).slice(2);function Rp(r){if(!r[sh]){r[sh]=!0,ev.forEach(function(c){c!=="selectionchange"&&(aD.has(c)||Mp(c,!1,r),Mp(c,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[sh]||(o[sh]=!0,Mp("selectionchange",!1,o))}}function o1(r,o,c,f){switch(U1(o)){case 2:var p=UD;break;case 8:p=jD;break;default:p=Wp}c=p.bind(null,o,c,r),p=void 0,!Qd||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(p=!0),f?p!==void 0?r.addEventListener(o,c,{capture:!0,passive:p}):r.addEventListener(o,c,!0):p!==void 0?r.addEventListener(o,c,{passive:p}):r.addEventListener(o,c,!1)}function Lp(r,o,c,f,p){var y=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var w=f.tag;if(w===3||w===4){var x=f.stateNode.containerInfo;if(x===p)break;if(w===4)for(w=f.return;w!==null;){var C=w.tag;if((C===3||C===4)&&w.stateNode.containerInfo===p)return;w=w.return}for(;x!==null;){if(w=sl(x),w===null)return;if(C=w.tag,C===5||C===6||C===26||C===27){f=y=w;continue e}x=x.parentNode}}f=f.return}fv(function(){var L=y,I=Jd(c),G=[];e:{var N=Hv.get(r);if(N!==void 0){var U=pu,ne=r;switch(r){case"keypress":if(du(c)===0)break e;case"keydown":case"keyup":U=t2;break;case"focusin":ne="focus",U=ng;break;case"focusout":ne="blur",U=ng;break;case"beforeblur":case"afterblur":U=ng;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=pv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=$O;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=s2;break;case Uv:case jv:case zv:U=KO;break;case Iv:U=l2;break;case"scroll":case"scrollend":U=qO;break;case"wheel":U=a2;break;case"copy":case"cut":case"paste":U=YO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=yv;break;case"toggle":case"beforetoggle":U=u2}var ue=(o&4)!==0,Ke=!ue&&(r==="scroll"||r==="scrollend"),D=ue?N!==null?N+"Capture":null:N;ue=[];for(var E=L,R;E!==null;){var $=E;if(R=$.stateNode,$=$.tag,$!==5&&$!==26&&$!==27||R===null||D===null||($=Yo(E,D),$!=null&&ue.push(Ta(E,$,R))),Ke)break;E=E.return}0<ue.length&&(N=new U(N,ne,null,c,I),G.push({event:N,listeners:ue}))}}if((o&7)===0){e:{if(N=r==="mouseover"||r==="pointerover",U=r==="mouseout"||r==="pointerout",N&&c!==Fd&&(ne=c.relatedTarget||c.fromElement)&&(sl(ne)||ne[il]))break e;if((U||N)&&(N=I.window===I?I:(N=I.ownerDocument)?N.defaultView||N.parentWindow:window,U?(ne=c.relatedTarget||c.toElement,U=L,ne=ne?sl(ne):null,ne!==null&&(Ke=l(ne),ue=ne.tag,ne!==Ke||ue!==5&&ue!==27&&ue!==6)&&(ne=null)):(U=null,ne=L),U!==ne)){if(ue=pv,$="onMouseLeave",D="onMouseEnter",E="mouse",(r==="pointerout"||r==="pointerover")&&(ue=yv,$="onPointerLeave",D="onPointerEnter",E="pointer"),Ke=U==null?N:Wo(U),R=ne==null?N:Wo(ne),N=new ue($,E+"leave",U,c,I),N.target=Ke,N.relatedTarget=R,$=null,sl(I)===L&&(ue=new ue(D,E+"enter",ne,c,I),ue.target=R,ue.relatedTarget=Ke,$=ue),Ke=$,U&&ne)t:{for(ue=cD,D=U,E=ne,R=0,$=D;$;$=ue($))R++;$=0;for(var ce=E;ce;ce=ue(ce))$++;for(;0<R-$;)D=ue(D),R--;for(;0<$-R;)E=ue(E),$--;for(;R--;){if(D===E||E!==null&&D===E.alternate){ue=D;break t}D=ue(D),E=ue(E)}ue=null}else ue=null;U!==null&&a1(G,N,U,ue,!1),ne!==null&&Ke!==null&&a1(G,Ke,ne,ue,!0)}}e:{if(N=L?Wo(L):window,U=N.nodeName&&N.nodeName.toLowerCase(),U==="select"||U==="input"&&N.type==="file")var ze=Av;else if(xv(N))if(Cv)ze=w2;else{ze=b2;var ie=y2}else U=N.nodeName,!U||U.toLowerCase()!=="input"||N.type!=="checkbox"&&N.type!=="radio"?L&&Yd(L.elementType)&&(ze=Av):ze=v2;if(ze&&(ze=ze(r,L))){kv(G,ze,c,I);break e}ie&&ie(r,N,L),r==="focusout"&&L&&N.type==="number"&&L.memoizedProps.value!=null&&Wd(N,"number",N.value)}switch(ie=L?Wo(L):window,r){case"focusin":(xv(ie)||ie.contentEditable==="true")&&(dl=ie,ag=L,na=null);break;case"focusout":na=ag=dl=null;break;case"mousedown":cg=!0;break;case"contextmenu":case"mouseup":case"dragend":cg=!1,Nv(G,c,I);break;case"selectionchange":if(_2)break;case"keydown":case"keyup":Nv(G,c,I)}var xe;if(sg)e:{switch(r){case"compositionstart":var Le="onCompositionStart";break e;case"compositionend":Le="onCompositionEnd";break e;case"compositionupdate":Le="onCompositionUpdate";break e}Le=void 0}else fl?Sv(r,c)&&(Le="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(Le="onCompositionStart");Le&&(bv&&c.locale!=="ko"&&(fl||Le!=="onCompositionStart"?Le==="onCompositionEnd"&&fl&&(xe=dv()):(ws=I,Zd="value"in ws?ws.value:ws.textContent,fl=!0)),ie=rh(L,Le),0<ie.length&&(Le=new mv(Le,r,null,c,I),G.push({event:Le,listeners:ie}),xe?Le.data=xe:(xe=_v(c),xe!==null&&(Le.data=xe)))),(xe=f2?d2(r,c):g2(r,c))&&(Le=rh(L,"onBeforeInput"),0<Le.length&&(ie=new mv("onBeforeInput","beforeinput",null,c,I),G.push({event:ie,listeners:Le}),ie.data=xe)),rD(G,r,L,c,I)}l1(G,o)})}function Ta(r,o,c){return{instance:r,listener:o,currentTarget:c}}function rh(r,o){for(var c=o+"Capture",f=[];r!==null;){var p=r,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Yo(r,c),p!=null&&f.unshift(Ta(r,p,y)),p=Yo(r,o),p!=null&&f.push(Ta(r,p,y))),r.tag===3)return f;r=r.return}return[]}function cD(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function a1(r,o,c,f,p){for(var y=o._reactName,w=[];c!==null&&c!==f;){var x=c,C=x.alternate,L=x.stateNode;if(x=x.tag,C!==null&&C===f)break;x!==5&&x!==26&&x!==27||L===null||(C=L,p?(L=Yo(c,y),L!=null&&w.unshift(Ta(c,L,C))):p||(L=Yo(c,y),L!=null&&w.push(Ta(c,L,C)))),c=c.return}w.length!==0&&r.push({event:o,listeners:w})}var uD=/\r\n?/g,hD=/\u0000|\uFFFD/g;function c1(r){return(typeof r=="string"?r:""+r).replace(uD,`
`).replace(hD,"")}function u1(r,o){return o=c1(o),c1(r)===o}function Ge(r,o,c,f,p,y){switch(c){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||cl(r,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&cl(r,""+f);break;case"className":cu(r,"class",f);break;case"tabIndex":cu(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":cu(r,c,f);break;case"style":uv(r,f,y);break;case"data":if(o!=="object"){cu(r,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||c!=="href")){r.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(c);break}f=hu(""+f),r.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(c==="formAction"?(o!=="input"&&Ge(r,o,"name",p.name,p,null),Ge(r,o,"formEncType",p.formEncType,p,null),Ge(r,o,"formMethod",p.formMethod,p,null),Ge(r,o,"formTarget",p.formTarget,p,null)):(Ge(r,o,"encType",p.encType,p,null),Ge(r,o,"method",p.method,p,null),Ge(r,o,"target",p.target,p,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(c);break}f=hu(""+f),r.setAttribute(c,f);break;case"onClick":f!=null&&(r.onclick=Pi);break;case"onScroll":f!=null&&De("scroll",r);break;case"onScrollEnd":f!=null&&De("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(c=f.__html,c!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}c=hu(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(c,""+f):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":f===!0?r.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(c,f):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(c,f):r.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(c):r.setAttribute(c,f);break;case"popover":De("beforetoggle",r),De("toggle",r),au(r,"popover",f);break;case"xlinkActuate":$i(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":$i(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":$i(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":$i(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":$i(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":$i(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":$i(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":$i(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":$i(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":au(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=IO.get(c)||c,au(r,c,f))}}function Np(r,o,c,f,p,y){switch(c){case"style":uv(r,f,y);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(c=f.__html,c!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"children":typeof f=="string"?cl(r,f):(typeof f=="number"||typeof f=="bigint")&&cl(r,""+f);break;case"onScroll":f!=null&&De("scroll",r);break;case"onScrollEnd":f!=null&&De("scrollend",r);break;case"onClick":f!=null&&(r.onclick=Pi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!tv.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(p=c.endsWith("Capture"),o=c.slice(2,p?c.length-7:void 0),y=r[rn]||null,y=y!=null?y[c]:null,typeof y=="function"&&r.removeEventListener(o,y,p),typeof f=="function")){typeof y!="function"&&y!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(o,f,p);break e}c in r?r[c]=f:f===!0?r.setAttribute(c,""):au(r,c,f)}}}function It(r,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":De("error",r),De("load",r);var f=!1,p=!1,y;for(y in c)if(c.hasOwnProperty(y)){var w=c[y];if(w!=null)switch(y){case"src":f=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Ge(r,o,y,w,c,null)}}p&&Ge(r,o,"srcSet",c.srcSet,c,null),f&&Ge(r,o,"src",c.src,c,null);return;case"input":De("invalid",r);var x=y=w=p=null,C=null,L=null;for(f in c)if(c.hasOwnProperty(f)){var I=c[f];if(I!=null)switch(f){case"name":p=I;break;case"type":w=I;break;case"checked":C=I;break;case"defaultChecked":L=I;break;case"value":y=I;break;case"defaultValue":x=I;break;case"children":case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(137,o));break;default:Ge(r,o,f,I,c,null)}}lv(r,y,x,C,L,w,p,!1);return;case"select":De("invalid",r),f=w=y=null;for(p in c)if(c.hasOwnProperty(p)&&(x=c[p],x!=null))switch(p){case"value":y=x;break;case"defaultValue":w=x;break;case"multiple":f=x;default:Ge(r,o,p,x,c,null)}o=y,c=w,r.multiple=!!f,o!=null?al(r,!!f,o,!1):c!=null&&al(r,!!f,c,!0);return;case"textarea":De("invalid",r),y=p=f=null;for(w in c)if(c.hasOwnProperty(w)&&(x=c[w],x!=null))switch(w){case"value":f=x;break;case"defaultValue":p=x;break;case"children":y=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(i(91));break;default:Ge(r,o,w,x,c,null)}av(r,f,p,y);return;case"option":for(C in c)c.hasOwnProperty(C)&&(f=c[C],f!=null)&&(C==="selected"?r.selected=f&&typeof f!="function"&&typeof f!="symbol":Ge(r,o,C,f,c,null));return;case"dialog":De("beforetoggle",r),De("toggle",r),De("cancel",r),De("close",r);break;case"iframe":case"object":De("load",r);break;case"video":case"audio":for(f=0;f<Ca.length;f++)De(Ca[f],r);break;case"image":De("error",r),De("load",r);break;case"details":De("toggle",r);break;case"embed":case"source":case"link":De("error",r),De("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(L in c)if(c.hasOwnProperty(L)&&(f=c[L],f!=null))switch(L){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Ge(r,o,L,f,c,null)}return;default:if(Yd(o)){for(I in c)c.hasOwnProperty(I)&&(f=c[I],f!==void 0&&Np(r,o,I,f,c,void 0));return}}for(x in c)c.hasOwnProperty(x)&&(f=c[x],f!=null&&Ge(r,o,x,f,c,null))}function fD(r,o,c,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,w=null,x=null,C=null,L=null,I=null;for(U in c){var G=c[U];if(c.hasOwnProperty(U)&&G!=null)switch(U){case"checked":break;case"value":break;case"defaultValue":C=G;default:f.hasOwnProperty(U)||Ge(r,o,U,null,f,G)}}for(var N in f){var U=f[N];if(G=c[N],f.hasOwnProperty(N)&&(U!=null||G!=null))switch(N){case"type":y=U;break;case"name":p=U;break;case"checked":L=U;break;case"defaultChecked":I=U;break;case"value":w=U;break;case"defaultValue":x=U;break;case"children":case"dangerouslySetInnerHTML":if(U!=null)throw Error(i(137,o));break;default:U!==G&&Ge(r,o,N,U,f,G)}}Kd(r,w,x,C,L,I,y,p);return;case"select":U=w=x=N=null;for(y in c)if(C=c[y],c.hasOwnProperty(y)&&C!=null)switch(y){case"value":break;case"multiple":U=C;default:f.hasOwnProperty(y)||Ge(r,o,y,null,f,C)}for(p in f)if(y=f[p],C=c[p],f.hasOwnProperty(p)&&(y!=null||C!=null))switch(p){case"value":N=y;break;case"defaultValue":x=y;break;case"multiple":w=y;default:y!==C&&Ge(r,o,p,y,f,C)}o=x,c=w,f=U,N!=null?al(r,!!c,N,!1):!!f!=!!c&&(o!=null?al(r,!!c,o,!0):al(r,!!c,c?[]:"",!1));return;case"textarea":U=N=null;for(x in c)if(p=c[x],c.hasOwnProperty(x)&&p!=null&&!f.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:Ge(r,o,x,null,f,p)}for(w in f)if(p=f[w],y=c[w],f.hasOwnProperty(w)&&(p!=null||y!=null))switch(w){case"value":N=p;break;case"defaultValue":U=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==y&&Ge(r,o,w,p,f,y)}ov(r,N,U);return;case"option":for(var ne in c)N=c[ne],c.hasOwnProperty(ne)&&N!=null&&!f.hasOwnProperty(ne)&&(ne==="selected"?r.selected=!1:Ge(r,o,ne,null,f,N));for(C in f)N=f[C],U=c[C],f.hasOwnProperty(C)&&N!==U&&(N!=null||U!=null)&&(C==="selected"?r.selected=N&&typeof N!="function"&&typeof N!="symbol":Ge(r,o,C,N,f,U));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ue in c)N=c[ue],c.hasOwnProperty(ue)&&N!=null&&!f.hasOwnProperty(ue)&&Ge(r,o,ue,null,f,N);for(L in f)if(N=f[L],U=c[L],f.hasOwnProperty(L)&&N!==U&&(N!=null||U!=null))switch(L){case"children":case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(137,o));break;default:Ge(r,o,L,N,f,U)}return;default:if(Yd(o)){for(var Ke in c)N=c[Ke],c.hasOwnProperty(Ke)&&N!==void 0&&!f.hasOwnProperty(Ke)&&Np(r,o,Ke,void 0,f,N);for(I in f)N=f[I],U=c[I],!f.hasOwnProperty(I)||N===U||N===void 0&&U===void 0||Np(r,o,I,N,f,U);return}}for(var D in c)N=c[D],c.hasOwnProperty(D)&&N!=null&&!f.hasOwnProperty(D)&&Ge(r,o,D,null,f,N);for(G in f)N=f[G],U=c[G],!f.hasOwnProperty(G)||N===U||N==null&&U==null||Ge(r,o,G,N,f,U)}function h1(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function dD(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var p=c[f],y=p.transferSize,w=p.initiatorType,x=p.duration;if(y&&x&&h1(w)){for(w=0,x=p.responseEnd,f+=1;f<c.length;f++){var C=c[f],L=C.startTime;if(L>x)break;var I=C.transferSize,G=C.initiatorType;I&&h1(G)&&(C=C.responseEnd,w+=I*(C<x?1:(x-L)/(C-L)))}if(--f,o+=8*(y+w)/(p.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Bp=null,Up=null;function lh(r){return r.nodeType===9?r:r.ownerDocument}function f1(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function d1(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function jp(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var zp=null;function gD(){var r=window.event;return r&&r.type==="popstate"?r===zp?!1:(zp=r,!0):(zp=null,!1)}var g1=typeof setTimeout=="function"?setTimeout:void 0,pD=typeof clearTimeout=="function"?clearTimeout:void 0,p1=typeof Promise=="function"?Promise:void 0,mD=typeof queueMicrotask=="function"?queueMicrotask:typeof p1<"u"?function(r){return p1.resolve(null).then(r).catch(yD)}:g1;function yD(r){setTimeout(function(){throw r})}function js(r){return r==="head"}function m1(r,o){var c=o,f=0;do{var p=c.nextSibling;if(r.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"||c==="/&"){if(f===0){r.removeChild(p),Hl(o);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")Ea(r.ownerDocument.documentElement);else if(c==="head"){c=r.ownerDocument.head,Ea(c);for(var y=c.firstChild;y;){var w=y.nextSibling,x=y.nodeName;y[Ko]||x==="SCRIPT"||x==="STYLE"||x==="LINK"&&y.rel.toLowerCase()==="stylesheet"||c.removeChild(y),y=w}}else c==="body"&&Ea(r.ownerDocument.body);c=p}while(c);Hl(o)}function y1(r,o){var c=r;r=0;do{var f=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(r===0)break;r--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||r++;c=f}while(c)}function Ip(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Ip(c),Pd(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function bD(r,o,c,f){for(;r.nodeType===1;){var p=c;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[Ko])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=Wn(r.nextSibling),r===null)break}return null}function vD(r,o,c){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=Wn(r.nextSibling),r===null))return null;return r}function b1(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Wn(r.nextSibling),r===null))return null;return r}function Hp(r){return r.data==="$?"||r.data==="$~"}function qp(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function wD(r,o){var c=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||c.readyState!=="loading")o();else{var f=function(){o(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function Wn(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var Vp=null;function v1(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"||c==="/&"){if(o===0)return Wn(r.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}r=r.nextSibling}return null}function w1(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return r;o--}else c!=="/$"&&c!=="/&"||o++}r=r.previousSibling}return null}function S1(r,o,c){switch(o=lh(c),r){case"html":if(r=o.documentElement,!r)throw Error(i(452));return r;case"head":if(r=o.head,!r)throw Error(i(453));return r;case"body":if(r=o.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Ea(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);Pd(r)}var Yn=new Map,_1=new Set;function oh(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var ls=K.d;K.d={f:SD,r:_D,D:xD,C:kD,L:AD,m:CD,X:ED,S:TD,M:OD};function SD(){var r=ls.f(),o=Qu();return r||o}function _D(r){var o=rl(r);o!==null&&o.tag===5&&o.type==="form"?Iw(o):ls.r(r)}var jl=typeof document>"u"?null:document;function x1(r,o,c){var f=jl;if(f&&typeof o=="string"&&o){var p=Hn(o);p='link[rel="'+r+'"][href="'+p+'"]',typeof c=="string"&&(p+='[crossorigin="'+c+'"]'),_1.has(p)||(_1.add(p),r={rel:r,crossOrigin:c,href:o},f.querySelector(p)===null&&(o=f.createElement("link"),It(o,"link",r),Ot(o),f.head.appendChild(o)))}}function xD(r){ls.D(r),x1("dns-prefetch",r,null)}function kD(r,o){ls.C(r,o),x1("preconnect",r,o)}function AD(r,o,c){ls.L(r,o,c);var f=jl;if(f&&r&&o){var p='link[rel="preload"][as="'+Hn(o)+'"]';o==="image"&&c&&c.imageSrcSet?(p+='[imagesrcset="'+Hn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(p+='[imagesizes="'+Hn(c.imageSizes)+'"]')):p+='[href="'+Hn(r)+'"]';var y=p;switch(o){case"style":y=zl(r);break;case"script":y=Il(r)}Yn.has(y)||(r=m({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:r,as:o},c),Yn.set(y,r),f.querySelector(p)!==null||o==="style"&&f.querySelector(Oa(y))||o==="script"&&f.querySelector(Da(y))||(o=f.createElement("link"),It(o,"link",r),Ot(o),f.head.appendChild(o)))}}function CD(r,o){ls.m(r,o);var c=jl;if(c&&r){var f=o&&typeof o.as=="string"?o.as:"script",p='link[rel="modulepreload"][as="'+Hn(f)+'"][href="'+Hn(r)+'"]',y=p;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Il(r)}if(!Yn.has(y)&&(r=m({rel:"modulepreload",href:r},o),Yn.set(y,r),c.querySelector(p)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Da(y)))return}f=c.createElement("link"),It(f,"link",r),Ot(f),c.head.appendChild(f)}}}function TD(r,o,c){ls.S(r,o,c);var f=jl;if(f&&r){var p=ll(f).hoistableStyles,y=zl(r);o=o||"default";var w=p.get(y);if(!w){var x={loading:0,preload:null};if(w=f.querySelector(Oa(y)))x.loading=5;else{r=m({rel:"stylesheet",href:r,"data-precedence":o},c),(c=Yn.get(y))&&$p(r,c);var C=w=f.createElement("link");Ot(C),It(C,"link",r),C._p=new Promise(function(L,I){C.onload=L,C.onerror=I}),C.addEventListener("load",function(){x.loading|=1}),C.addEventListener("error",function(){x.loading|=2}),x.loading|=4,ah(w,o,f)}w={type:"stylesheet",instance:w,count:1,state:x},p.set(y,w)}}}function ED(r,o){ls.X(r,o);var c=jl;if(c&&r){var f=ll(c).hoistableScripts,p=Il(r),y=f.get(p);y||(y=c.querySelector(Da(p)),y||(r=m({src:r,async:!0},o),(o=Yn.get(p))&&Pp(r,o),y=c.createElement("script"),Ot(y),It(y,"link",r),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(p,y))}}function OD(r,o){ls.M(r,o);var c=jl;if(c&&r){var f=ll(c).hoistableScripts,p=Il(r),y=f.get(p);y||(y=c.querySelector(Da(p)),y||(r=m({src:r,async:!0,type:"module"},o),(o=Yn.get(p))&&Pp(r,o),y=c.createElement("script"),Ot(y),It(y,"link",r),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(p,y))}}function k1(r,o,c,f){var p=(p=ve.current)?oh(p):null;if(!p)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=zl(c.href),c=ll(p).hoistableStyles,f=c.get(o),f||(f={type:"style",instance:null,count:0,state:null},c.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=zl(c.href);var y=ll(p).hoistableStyles,w=y.get(r);if(w||(p=p.ownerDocument||p,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,w),(y=p.querySelector(Oa(r)))&&!y._p&&(w.instance=y,w.state.loading=5),Yn.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Yn.set(r,c),y||DD(p,r,c,w.state))),o&&f===null)throw Error(i(528,""));return w}if(o&&f!==null)throw Error(i(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Il(c),c=ll(p).hoistableScripts,f=c.get(o),f||(f={type:"script",instance:null,count:0,state:null},c.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function zl(r){return'href="'+Hn(r)+'"'}function Oa(r){return'link[rel="stylesheet"]['+r+"]"}function A1(r){return m({},r,{"data-precedence":r.precedence,precedence:null})}function DD(r,o,c,f){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=r.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),It(o,"link",c),Ot(o),r.head.appendChild(o))}function Il(r){return'[src="'+Hn(r)+'"]'}function Da(r){return"script[async]"+r}function C1(r,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var f=r.querySelector('style[data-href~="'+Hn(c.href)+'"]');if(f)return o.instance=f,Ot(f),f;var p=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),Ot(f),It(f,"style",p),ah(f,c.precedence,r),o.instance=f;case"stylesheet":p=zl(c.href);var y=r.querySelector(Oa(p));if(y)return o.state.loading|=4,o.instance=y,Ot(y),y;f=A1(c),(p=Yn.get(p))&&$p(f,p),y=(r.ownerDocument||r).createElement("link"),Ot(y);var w=y;return w._p=new Promise(function(x,C){w.onload=x,w.onerror=C}),It(y,"link",f),o.state.loading|=4,ah(y,c.precedence,r),o.instance=y;case"script":return y=Il(c.src),(p=r.querySelector(Da(y)))?(o.instance=p,Ot(p),p):(f=c,(p=Yn.get(y))&&(f=m({},c),Pp(f,p)),r=r.ownerDocument||r,p=r.createElement("script"),Ot(p),It(p,"link",f),r.head.appendChild(p),o.instance=p);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,ah(f,c.precedence,r));return o.instance}function ah(r,o,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=f.length?f[f.length-1]:null,y=p,w=0;w<f.length;w++){var x=f[w];if(x.dataset.precedence===o)y=x;else if(y!==p)break}y?y.parentNode.insertBefore(r,y.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(r,o.firstChild))}function $p(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function Pp(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var ch=null;function T1(r,o,c){if(ch===null){var f=new Map,p=ch=new Map;p.set(c,f)}else p=ch,f=p.get(c),f||(f=new Map,p.set(c,f));if(f.has(r))return f;for(f.set(r,null),c=c.getElementsByTagName(r),p=0;p<c.length;p++){var y=c[p];if(!(y[Ko]||y[Bt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(o)||"";w=r+w;var x=f.get(w);x?x.push(y):f.set(w,[y])}}return f}function E1(r,o,c){r=r.ownerDocument||r,r.head.insertBefore(c,o==="title"?r.querySelector("head > title"):null)}function MD(r,o,c){if(c===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(r=o.disabled,typeof o.precedence=="string"&&r==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function O1(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function RD(r,o,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var p=zl(f.href),y=o.querySelector(Oa(p));if(y){o=y._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=uh.bind(r),o.then(r,r)),c.state.loading|=4,c.instance=y,Ot(y);return}y=o.ownerDocument||o,f=A1(f),(p=Yn.get(p))&&$p(f,p),y=y.createElement("link"),Ot(y);var w=y;w._p=new Promise(function(x,C){w.onload=x,w.onerror=C}),It(y,"link",f),c.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(r.count++,c=uh.bind(r),o.addEventListener("load",c),o.addEventListener("error",c))}}var Gp=0;function LD(r,o){return r.stylesheets&&r.count===0&&fh(r,r.stylesheets),0<r.count||0<r.imgCount?function(c){var f=setTimeout(function(){if(r.stylesheets&&fh(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+o);0<r.imgBytes&&Gp===0&&(Gp=62500*dD());var p=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&fh(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>Gp?50:800)+o);return r.unsuspend=c,function(){r.unsuspend=null,clearTimeout(f),clearTimeout(p)}}:null}function uh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fh(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var hh=null;function fh(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,hh=new Map,o.forEach(ND,r),hh=null,uh.call(r))}function ND(r,o){if(!(o.state.loading&4)){var c=hh.get(r);if(c)var f=c.get(null);else{c=new Map,hh.set(r,c);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var w=p[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(c.set(w.dataset.precedence,w),f=w)}f&&c.set(null,f)}p=o.instance,w=p.getAttribute("data-precedence"),y=c.get(w)||f,y===f&&c.set(null,p),c.set(w,p),this.count++,f=uh.bind(this),p.addEventListener("load",f),p.addEventListener("error",f),y?y.parentNode.insertBefore(p,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),o.state.loading|=4}}var Ma={$$typeof:O,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function BD(r,o,c,f,p,y,w,x,C){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Hd(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hd(0),this.hiddenUpdates=Hd(null),this.identifierPrefix=f,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=C,this.incompleteTransitions=new Map}function D1(r,o,c,f,p,y,w,x,C,L,I,G){return r=new BD(r,o,c,w,C,L,I,G,x),o=1,y===!0&&(o|=24),y=xn(3,null,null,o),r.current=y,y.stateNode=r,o=kg(),o.refCount++,r.pooledCache=o,o.refCount++,y.memoizedState={element:f,isDehydrated:c,cache:o},Eg(y),r}function M1(r){return r?(r=ml,r):ml}function R1(r,o,c,f,p,y){p=M1(p),f.context===null?f.context=p:f.pendingContext=p,f=Cs(o),f.payload={element:c},y=y===void 0?null:y,y!==null&&(f.callback=y),c=Ts(r,f,o),c!==null&&(hn(c,r,o),ca(c,r,o))}function L1(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<o?c:o}}function Kp(r,o){L1(r,o),(r=r.alternate)&&L1(r,o)}function N1(r){if(r.tag===13||r.tag===31){var o=gr(r,67108864);o!==null&&hn(o,r,67108864),Kp(r,67108864)}}function B1(r){if(r.tag===13||r.tag===31){var o=En();o=qd(o);var c=gr(r,o);c!==null&&hn(c,r,o),Kp(r,o)}}var dh=!0;function UD(r,o,c,f){var p=B.T;B.T=null;var y=K.p;try{K.p=2,Wp(r,o,c,f)}finally{K.p=y,B.T=p}}function jD(r,o,c,f){var p=B.T;B.T=null;var y=K.p;try{K.p=8,Wp(r,o,c,f)}finally{K.p=y,B.T=p}}function Wp(r,o,c,f){if(dh){var p=Yp(f);if(p===null)Lp(r,o,f,gh,c),j1(r,f);else if(ID(p,r,o,c,f))f.stopPropagation();else if(j1(r,f),o&4&&-1<zD.indexOf(r)){for(;p!==null;){var y=rl(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=cr(y.pendingLanes);if(w!==0){var x=y;for(x.pendingLanes|=2,x.entangledLanes|=2;w;){var C=1<<31-Sn(w);x.entanglements[1]|=C,w&=~C}xi(y),(qe&6)===0&&(Ju=vn()+500,Aa(0))}}break;case 31:case 13:x=gr(y,2),x!==null&&hn(x,y,2),Qu(),Kp(y,2)}if(y=Yp(f),y===null&&Lp(r,o,f,gh,c),y===p)break;p=y}p!==null&&f.stopPropagation()}else Lp(r,o,f,null,c)}}function Yp(r){return r=Jd(r),Fp(r)}var gh=null;function Fp(r){if(gh=null,r=sl(r),r!==null){var o=l(r);if(o===null)r=null;else{var c=o.tag;if(c===13){if(r=a(o),r!==null)return r;r=null}else if(c===31){if(r=u(o),r!==null)return r;r=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return gh=r,null}function U1(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xO()){case Pb:return 2;case Gb:return 8;case iu:case kO:return 32;case Kb:return 268435456;default:return 32}default:return 32}}var Jp=!1,zs=null,Is=null,Hs=null,Ra=new Map,La=new Map,qs=[],zD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function j1(r,o){switch(r){case"focusin":case"focusout":zs=null;break;case"dragenter":case"dragleave":Is=null;break;case"mouseover":case"mouseout":Hs=null;break;case"pointerover":case"pointerout":Ra.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":La.delete(o.pointerId)}}function Na(r,o,c,f,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:o,domEventName:c,eventSystemFlags:f,nativeEvent:y,targetContainers:[p]},o!==null&&(o=rl(o),o!==null&&N1(o)),r):(r.eventSystemFlags|=f,o=r.targetContainers,p!==null&&o.indexOf(p)===-1&&o.push(p),r)}function ID(r,o,c,f,p){switch(o){case"focusin":return zs=Na(zs,r,o,c,f,p),!0;case"dragenter":return Is=Na(Is,r,o,c,f,p),!0;case"mouseover":return Hs=Na(Hs,r,o,c,f,p),!0;case"pointerover":var y=p.pointerId;return Ra.set(y,Na(Ra.get(y)||null,r,o,c,f,p)),!0;case"gotpointercapture":return y=p.pointerId,La.set(y,Na(La.get(y)||null,r,o,c,f,p)),!0}return!1}function z1(r){var o=sl(r.target);if(o!==null){var c=l(o);if(c!==null){if(o=c.tag,o===13){if(o=a(c),o!==null){r.blockedOn=o,Qb(r.priority,function(){B1(c)});return}}else if(o===31){if(o=u(c),o!==null){r.blockedOn=o,Qb(r.priority,function(){B1(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function ph(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var c=Yp(r.nativeEvent);if(c===null){c=r.nativeEvent;var f=new c.constructor(c.type,c);Fd=f,c.target.dispatchEvent(f),Fd=null}else return o=rl(c),o!==null&&N1(o),r.blockedOn=c,!1;o.shift()}return!0}function I1(r,o,c){ph(r)&&c.delete(o)}function HD(){Jp=!1,zs!==null&&ph(zs)&&(zs=null),Is!==null&&ph(Is)&&(Is=null),Hs!==null&&ph(Hs)&&(Hs=null),Ra.forEach(I1),La.forEach(I1)}function mh(r,o){r.blockedOn===o&&(r.blockedOn=null,Jp||(Jp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,HD)))}var yh=null;function H1(r){yh!==r&&(yh=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){yh===r&&(yh=null);for(var o=0;o<r.length;o+=3){var c=r[o],f=r[o+1],p=r[o+2];if(typeof f!="function"){if(Fp(f||c)===null)continue;break}var y=rl(c);y!==null&&(r.splice(o,3),o-=3,Yg(y,{pending:!0,data:p,method:c.method,action:f},f,p))}}))}function Hl(r){function o(C){return mh(C,r)}zs!==null&&mh(zs,r),Is!==null&&mh(Is,r),Hs!==null&&mh(Hs,r),Ra.forEach(o),La.forEach(o);for(var c=0;c<qs.length;c++){var f=qs[c];f.blockedOn===r&&(f.blockedOn=null)}for(;0<qs.length&&(c=qs[0],c.blockedOn===null);)z1(c),c.blockedOn===null&&qs.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var p=c[f],y=c[f+1],w=p[rn]||null;if(typeof y=="function")w||H1(c);else if(w){var x=null;if(y&&y.hasAttribute("formAction")){if(p=y,w=y[rn]||null)x=w.formAction;else if(Fp(p)!==null)continue}else x=w.action;typeof x=="function"?c[f+1]=x:(c.splice(f,3),f-=3),H1(c)}}}function q1(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(w){return p=w})},focusReset:"manual",scroll:"manual"})}function o(){p!==null&&(p(),p=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,p=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),p!==null&&(p(),p=null)}}}function Xp(r){this._internalRoot=r}bh.prototype.render=Xp.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(i(409));var c=o.current,f=En();R1(c,f,r,o,null,null)},bh.prototype.unmount=Xp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;R1(r.current,2,null,r,null,null),Qu(),o[il]=null}};function bh(r){this._internalRoot=r}bh.prototype.unstable_scheduleHydration=function(r){if(r){var o=Xb();r={blockedOn:null,target:r,priority:o};for(var c=0;c<qs.length&&o!==0&&o<qs[c].priority;c++);qs.splice(c,0,r),c===0&&z1(r)}};var V1=e.version;if(V1!=="19.2.4")throw Error(i(527,V1,"19.2.4"));K.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=d(o),r=r!==null?g(r):null,r=r===null?null:r.stateNode,r};var qD={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vh.isDisabled&&vh.supportsFiber)try{$o=vh.inject(qD),wn=vh}catch{}}return Ua.createRoot=function(r,o){if(!s(r))throw Error(i(299));var c=!1,f="",p=Fw,y=Jw,w=Xw;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(y=o.onCaughtError),o.onRecoverableError!==void 0&&(w=o.onRecoverableError)),o=D1(r,1,!1,null,null,c,f,null,p,y,w,q1),r[il]=o.current,Rp(r),new Xp(o)},Ua.hydrateRoot=function(r,o,c){if(!s(r))throw Error(i(299));var f=!1,p="",y=Fw,w=Jw,x=Xw,C=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(w=c.onCaughtError),c.onRecoverableError!==void 0&&(x=c.onRecoverableError),c.formState!==void 0&&(C=c.formState)),o=D1(r,1,!0,o,c??null,f,p,C,y,w,x,q1),o.context=M1(null),c=o.current,f=En(),f=qd(f),p=Cs(f),p.callback=null,Ts(c,p,f),c=f,o.current.lanes=c,Go(o,c),xi(o),r[il]=o.current,Rp(r),new bh(o)},Ua.version="19.2.4",Ua}var Q1;function QD(){if(Q1)return em.exports;Q1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),em.exports=XD(),em.exports}var ZD=QD();function td(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function eM(n,e,t,i){function s(l){return l instanceof t?l:new t(function(a){a(l)})}return new(t||(t=Promise))(function(l,a){function u(g){try{d(i.next(g))}catch(m){a(m)}}function h(g){try{d(i.throw(g))}catch(m){a(m)}}function d(g){g.done?l(g.value):s(g.value).then(u,h)}d((i=i.apply(n,e||[])).next())})}const tM=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class Oy extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class nM extends Oy{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Z1 extends Oy{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class e_ extends Oy{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var f0;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(f0||(f0={}));class iM{constructor(e,{headers:t={},customFetch:i,region:s=f0.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=tM(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return eM(this,arguments,void 0,function*(t,i={}){var s;let l,a;try{const{headers:u,method:h,body:d,signal:g,timeout:m}=i;let b={},{region:v}=i;v||(v=this.region);const S=new URL(`${this.url}/${t}`);v&&v!=="any"&&(b["x-region"]=v,S.searchParams.set("forceFunctionRegion",v));let _;d&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(b["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(b["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(b["Content-Type"]="application/json",_=JSON.stringify(d)):d&&typeof d!="string"&&!(typeof Blob<"u"&&d instanceof Blob)&&!(d instanceof ArrayBuffer)&&!(typeof FormData<"u"&&d instanceof FormData)?_=JSON.stringify(d):_=d;let k=g;m&&(a=new AbortController,l=setTimeout(()=>a.abort(),m),g?(k=a.signal,g.addEventListener("abort",()=>a.abort())):k=a.signal);const A=yield this.fetch(S.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},b),this.headers),u),body:_,signal:k}).catch(q=>{throw new nM(q)}),M=A.headers.get("x-relay-error");if(M&&M==="true")throw new Z1(A);if(!A.ok)throw new e_(A);let O=((s=A.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),z;return O==="application/json"?z=yield A.json():O==="application/octet-stream"||O==="application/pdf"?z=yield A.blob():O==="text/event-stream"?z=A:O==="multipart/form-data"?z=yield A.formData():z=yield A.text(),{data:z,error:null,response:A}}catch(u){return{data:null,error:u,response:u instanceof e_||u instanceof Z1?u.context:void 0}}finally{l&&clearTimeout(l)}})}}var sM=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},rM=class{constructor(n){var e,t,i;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(e=n.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=n.signal,this.isMaybeSingle=(t=n.isMaybeSingle)!==null&&t!==void 0?t:!1,this.urlLengthLimit=(i=n.urlLengthLimit)!==null&&i!==void 0?i:8e3,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,e){return this.headers=new Headers(this.headers),this.headers.set(n,e),this}then(n,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let s=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let a=null,u=null,h=null,d=l.status,g=l.statusText;if(l.ok){var m,b;if(t.method!=="HEAD"){var v;const A=await l.text();A===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((v=t.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?u=A:u=JSON.parse(A))}const _=(m=t.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),k=(b=l.headers.get("content-range"))===null||b===void 0?void 0:b.split("/");_&&k&&k.length>1&&(h=parseInt(k[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(u)&&(u.length>1?(a={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var S;const _=await l.text();try{a=JSON.parse(_),Array.isArray(a)&&l.status===404&&(u=[],a=null,d=200,g="OK")}catch{l.status===404&&_===""?(d=204,g="No Content"):a={message:_}}if(a&&t.isMaybeSingle&&(!(a==null||(S=a.details)===null||S===void 0)&&S.includes("0 rows"))&&(a=null,d=200,g="OK"),a&&t.shouldThrowOnError)throw new sM(a)}return{error:a,data:u,count:h,status:d,statusText:g}});return this.shouldThrowOnError||(s=s.catch(l=>{var a;let u="",h="",d="";const g=l?.cause;if(g){var m,b,v,S;const A=(m=g?.message)!==null&&m!==void 0?m:"",M=(b=g?.code)!==null&&b!==void 0?b:"";u=`${(v=l?.name)!==null&&v!==void 0?v:"FetchError"}: ${l?.message}`,u+=`

Caused by: ${(S=g?.name)!==null&&S!==void 0?S:"Error"}: ${A}`,M&&(u+=` (${M})`),g?.stack&&(u+=`
${g.stack}`)}else{var _;u=(_=l?.stack)!==null&&_!==void 0?_:""}const k=this.url.toString().length;return l?.name==="AbortError"||l?.code==="ABORT_ERR"?(d="",h="Request was aborted (timeout or manual cancellation)",k>this.urlLengthLimit&&(h+=`. Note: Your request URL is ${k} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(g?.name==="HeadersOverflowError"||g?.code==="UND_ERR_HEADERS_OVERFLOW")&&(d="",h="HTTP headers exceeded server limits (typically 16KB)",k>this.urlLengthLimit&&(h+=`. Your request URL is ${k} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(a=l?.name)!==null&&a!==void 0?a:"FetchError"}: ${l?.message}`,details:u,hint:h,code:d},data:null,count:null,status:0,statusText:""}})),s.then(n,e)}returns(){return this}overrideTypes(){return this}},lM=class extends rM{select(n){let e=!1;const t=(n??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:e=!0,nullsFirst:t,foreignTable:i,referencedTable:s=i}={}){const l=s?`${s}.order`:"order",a=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${a?`${a},`:""}${n}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:e,referencedTable:t=e}={}){const i=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(i,`${n}`),this}range(n,e,{foreignTable:t,referencedTable:i=t}={}){const s=typeof i>"u"?"offset":`${i}.offset`,l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${n}`),this.url.searchParams.set(l,`${e-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:e=!1,settings:t=!1,buffers:i=!1,wal:s=!1,format:l="text"}={}){var a;const u=[n?"analyze":null,e?"verbose":null,t?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${h}"; options=${u};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const t_=new RegExp("[,()]");var Yl=class extends lM{eq(n,e){return this.url.searchParams.append(n,`eq.${e}`),this}neq(n,e){return this.url.searchParams.append(n,`neq.${e}`),this}gt(n,e){return this.url.searchParams.append(n,`gt.${e}`),this}gte(n,e){return this.url.searchParams.append(n,`gte.${e}`),this}lt(n,e){return this.url.searchParams.append(n,`lt.${e}`),this}lte(n,e){return this.url.searchParams.append(n,`lte.${e}`),this}like(n,e){return this.url.searchParams.append(n,`like.${e}`),this}likeAllOf(n,e){return this.url.searchParams.append(n,`like(all).{${e.join(",")}}`),this}likeAnyOf(n,e){return this.url.searchParams.append(n,`like(any).{${e.join(",")}}`),this}ilike(n,e){return this.url.searchParams.append(n,`ilike.${e}`),this}ilikeAllOf(n,e){return this.url.searchParams.append(n,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(n,e){return this.url.searchParams.append(n,`ilike(any).{${e.join(",")}}`),this}regexMatch(n,e){return this.url.searchParams.append(n,`match.${e}`),this}regexIMatch(n,e){return this.url.searchParams.append(n,`imatch.${e}`),this}is(n,e){return this.url.searchParams.append(n,`is.${e}`),this}isDistinct(n,e){return this.url.searchParams.append(n,`isdistinct.${e}`),this}in(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&t_.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`in.(${t})`),this}notIn(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&t_.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`not.in.(${t})`),this}contains(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cs.{${e.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(e)}`),this}containedBy(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cd.{${e.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(e)}`),this}rangeGt(n,e){return this.url.searchParams.append(n,`sr.${e}`),this}rangeGte(n,e){return this.url.searchParams.append(n,`nxl.${e}`),this}rangeLt(n,e){return this.url.searchParams.append(n,`sl.${e}`),this}rangeLte(n,e){return this.url.searchParams.append(n,`nxr.${e}`),this}rangeAdjacent(n,e){return this.url.searchParams.append(n,`adj.${e}`),this}overlaps(n,e){return typeof e=="string"?this.url.searchParams.append(n,`ov.${e}`):this.url.searchParams.append(n,`ov.{${e.join(",")}}`),this}textSearch(n,e,{config:t,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const l=t===void 0?"":`(${t})`;return this.url.searchParams.append(n,`${s}fts${l}.${e}`),this}match(n){return Object.entries(n).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(n,e,t){return this.url.searchParams.append(n,`not.${e}.${t}`),this}or(n,{foreignTable:e,referencedTable:t=e}={}){const i=t?`${t}.or`:"or";return this.url.searchParams.append(i,`(${n})`),this}filter(n,e,t){return this.url.searchParams.append(n,`${e}.${t}`),this}},oM=class{constructor(n,{headers:e={},schema:t,fetch:i,urlLengthLimit:s=8e3}){this.url=n,this.headers=new Headers(e),this.schema=t,this.fetch=i,this.urlLengthLimit=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,e){const{head:t=!1,count:i}=e??{},s=t?"HEAD":"GET";let l=!1;const a=(n??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join(""),{url:u,headers:h}=this.cloneRequestState();return u.searchParams.set("select",a),i&&h.append("Prefer",`count=${i}`),new Yl({method:s,url:u,headers:h,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(n,{count:e,defaultToNull:t=!0}={}){var i;const s="POST",{url:l,headers:a}=this.cloneRequestState();if(e&&a.append("Prefer",`count=${e}`),t||a.append("Prefer","missing=default"),Array.isArray(n)){const u=n.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(u.length>0){const h=[...new Set(u)].map(d=>`"${d}"`);l.searchParams.set("columns",h.join(","))}}return new Yl({method:s,url:l,headers:a,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(n,{onConflict:e,ignoreDuplicates:t=!1,count:i,defaultToNull:s=!0}={}){var l;const a="POST",{url:u,headers:h}=this.cloneRequestState();if(h.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&u.searchParams.set("on_conflict",e),i&&h.append("Prefer",`count=${i}`),s||h.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((g,m)=>g.concat(Object.keys(m)),[]);if(d.length>0){const g=[...new Set(d)].map(m=>`"${m}"`);u.searchParams.set("columns",g.join(","))}}return new Yl({method:a,url:u,headers:h,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch,urlLengthLimit:this.urlLengthLimit})}update(n,{count:e}={}){var t;const i="PATCH",{url:s,headers:l}=this.cloneRequestState();return e&&l.append("Prefer",`count=${e}`),new Yl({method:i,url:s,headers:l,schema:this.schema,body:n,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:n}={}){var e;const t="DELETE",{url:i,headers:s}=this.cloneRequestState();return n&&s.append("Prefer",`count=${n}`),new Yl({method:t,url:i,headers:s,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function lc(n){"@babel/helpers - typeof";return lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lc(n)}function aM(n,e){if(lc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(lc(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function cM(n){var e=aM(n,"string");return lc(e)=="symbol"?e:e+""}function uM(n,e,t){return(e=cM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function n_(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function Sh(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?n_(Object(t),!0).forEach(function(i){uM(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):n_(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var hM=class Yk{constructor(e,{headers:t={},schema:i,fetch:s,timeout:l,urlLengthLimit:a=8e3}={}){this.url=e,this.headers=new Headers(t),this.schemaName=i,this.urlLengthLimit=a;const u=s??globalThis.fetch;l!==void 0&&l>0?this.fetch=(h,d)=>{const g=new AbortController,m=setTimeout(()=>g.abort(),l),b=d?.signal;if(b){if(b.aborted)return clearTimeout(m),u(h,d);const v=()=>{clearTimeout(m),g.abort()};return b.addEventListener("abort",v,{once:!0}),u(h,Sh(Sh({},d),{},{signal:g.signal})).finally(()=>{clearTimeout(m),b.removeEventListener("abort",v)})}return u(h,Sh(Sh({},d),{},{signal:g.signal})).finally(()=>clearTimeout(m))}:this.fetch=u}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new oM(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new Yk(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,t={},{head:i=!1,get:s=!1,count:l}={}){var a;let u;const h=new URL(`${this.url}/rpc/${e}`);let d;const g=v=>v!==null&&typeof v=="object"&&(!Array.isArray(v)||v.some(g)),m=i&&Object.values(t).some(g);m?(u="POST",d=t):i||s?(u=i?"HEAD":"GET",Object.entries(t).filter(([v,S])=>S!==void 0).map(([v,S])=>[v,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([v,S])=>{h.searchParams.append(v,S)})):(u="POST",d=t);const b=new Headers(this.headers);return m?b.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&b.set("Prefer",`count=${l}`),new Yl({method:u,url:h,headers:b,schema:this.schemaName,body:d,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}};class fM{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const i=t.versions;if(i&&i.node){const s=i.node,l=parseInt(s.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const dM="2.95.2",gM=`realtime-js/${dM}`,pM="1.0.0",Fk="2.0.0",i_=Fk,d0=1e4,mM=1e3,yM=100;var $s;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})($s||($s={}));var kt;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(kt||(kt={}));var ui;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(ui||(ui={}));var g0;(function(n){n.websocket="websocket"})(g0||(g0={}));var Rr;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Rr||(Rr={}));class bM{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,i;const s=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,i;const s=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:{},a=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,t,i){var s,l;const a=e.topic,u=(s=e.ref)!==null&&s!==void 0?s:"",h=(l=e.join_ref)!==null&&l!==void 0?l:"",d=e.payload.event,g=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},m=Object.keys(g).length===0?"":JSON.stringify(g);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const b=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+u.length+a.length+d.length+m.length,v=new ArrayBuffer(this.HEADER_LENGTH+b);let S=new DataView(v),_=0;S.setUint8(_++,this.KINDS.userBroadcastPush),S.setUint8(_++,h.length),S.setUint8(_++,u.length),S.setUint8(_++,a.length),S.setUint8(_++,d.length),S.setUint8(_++,m.length),S.setUint8(_++,t),Array.from(h,A=>S.setUint8(_++,A.charCodeAt(0))),Array.from(u,A=>S.setUint8(_++,A.charCodeAt(0))),Array.from(a,A=>S.setUint8(_++,A.charCodeAt(0))),Array.from(d,A=>S.setUint8(_++,A.charCodeAt(0))),Array.from(m,A=>S.setUint8(_++,A.charCodeAt(0)));var k=new Uint8Array(v.byteLength+i.byteLength);return k.set(new Uint8Array(v),0),k.set(new Uint8Array(i),v.byteLength),k.buffer}decode(e,t){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return t(i)}if(typeof e=="string"){const i=JSON.parse(e),[s,l,a,u,h]=i;return t({join_ref:s,ref:l,topic:a,event:u,payload:h})}return t({})}_binaryDecode(e){const t=new DataView(e),i=t.getUint8(0),s=new TextDecoder;if(i===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,s)}_decodeUserBroadcast(e,t,i){const s=t.getUint8(1),l=t.getUint8(2),a=t.getUint8(3),u=t.getUint8(4);let h=this.HEADER_LENGTH+4;const d=i.decode(e.slice(h,h+s));h=h+s;const g=i.decode(e.slice(h,h+l));h=h+l;const m=i.decode(e.slice(h,h+a));h=h+a;const b=e.slice(h,e.byteLength),v=u===this.JSON_ENCODING?JSON.parse(i.decode(b)):b,S={type:this.BROADCAST_EVENT,event:g,payload:v};return a>0&&(S.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:S}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>t.includes(i)))}}class Jk{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ze;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ze||(Ze={}));const s_=(n,e,t={})=>{var i;const s=(i=t.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((l,a)=>(l[a]=vM(a,n,e,s),l),{}):{}},vM=(n,e,t,i)=>{const s=e.find(u=>u.name===n),l=s?.type,a=t[n];return l&&!i.includes(l)?Xk(l,a):p0(a)},Xk=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return xM(e,t)}switch(n){case Ze.bool:return wM(e);case Ze.float4:case Ze.float8:case Ze.int2:case Ze.int4:case Ze.int8:case Ze.numeric:case Ze.oid:return SM(e);case Ze.json:case Ze.jsonb:return _M(e);case Ze.timestamp:return kM(e);case Ze.abstime:case Ze.date:case Ze.daterange:case Ze.int4range:case Ze.int8range:case Ze.money:case Ze.reltime:case Ze.text:case Ze.time:case Ze.timestamptz:case Ze.timetz:case Ze.tsrange:case Ze.tstzrange:return p0(e);default:return p0(e)}},p0=n=>n,wM=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},SM=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},_M=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},xM=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let l;const a=n.slice(1,t);try{l=JSON.parse("["+a+"]")}catch{l=a?a.split(","):[]}return l.map(u=>Xk(e,u))}return n},kM=n=>typeof n=="string"?n.replace(" ","T"):n,Qk=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class sm{constructor(e,t,i={},s=d0){this.channel=e,this.event=t,this.payload=i,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var r_;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(r_||(r_={}));class Ja{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},s=>{const{onJoin:l,onLeave:a,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ja.syncState(this.state,s,l,a),this.pendingDiffs.forEach(h=>{this.state=Ja.syncDiff(this.state,h,l,a)}),this.pendingDiffs=[],u()}),this.channel._on(i.diff,{},s=>{const{onJoin:l,onLeave:a,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ja.syncDiff(this.state,s,l,a),u())}),this.onJoin((s,l,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:a})}),this.onLeave((s,l,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,s){const l=this.cloneDeep(e),a=this.transformState(t),u={},h={};return this.map(l,(d,g)=>{a[d]||(h[d]=g)}),this.map(a,(d,g)=>{const m=l[d];if(m){const b=g.map(k=>k.presence_ref),v=m.map(k=>k.presence_ref),S=g.filter(k=>v.indexOf(k.presence_ref)<0),_=m.filter(k=>b.indexOf(k.presence_ref)<0);S.length>0&&(u[d]=S),_.length>0&&(h[d]=_)}else u[d]=g}),this.syncDiff(l,{joins:u,leaves:h},i,s)}static syncDiff(e,t,i,s){const{joins:l,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),s||(s=()=>{}),this.map(l,(u,h)=>{var d;const g=(d=e[u])!==null&&d!==void 0?d:[];if(e[u]=this.cloneDeep(h),g.length>0){const m=e[u].map(v=>v.presence_ref),b=g.filter(v=>m.indexOf(v.presence_ref)<0);e[u].unshift(...b)}i(u,g,h)}),this.map(a,(u,h)=>{let d=e[u];if(!d)return;const g=h.map(m=>m.presence_ref);d=d.filter(m=>g.indexOf(m.presence_ref)<0),e[u]=d,s(u,d,h),d.length===0&&delete e[u]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const s=e[i];return"metas"in s?t[i]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[i]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var l_;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(l_||(l_={}));var Xa;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Xa||(Xa={}));var os;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(os||(os={}));class eo{constructor(e,t={config:{}},i){var s,l;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=kt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new sm(this,ui.join,this.params,this.timeout),this.rejoinTimer=new Jk(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=kt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=kt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ui.reply,{},(a,u)=>{this._trigger(this._replyEventName(u),a)}),this.presence=new Ja(this),this.broadcastEndpointURL=Qk(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,s,l;if(this.socket.isConnected()||this.socket.connect(),this.state==kt.closed){const{config:{broadcast:a,presence:u,private:h}}=this.params,d=(s=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(v=>v.filter))!==null&&s!==void 0?s:[],g=!!this.bindings[Xa.PRESENCE]&&this.bindings[Xa.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,m={},b={broadcast:a,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(os.CHANNEL_ERROR,v)),this._onClose(()=>e?.(os.CLOSED)),this.updateJoinPayload(Object.assign({config:b},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var S;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){e?.(os.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,k=(S=_?.length)!==null&&S!==void 0?S:0,A=[];for(let M=0;M<k;M++){const O=_[M],{filter:{event:z,schema:q,table:V,filter:j}}=O,ee=v&&v[M];if(ee&&ee.event===z&&eo.isFilterValueEqual(ee.schema,q)&&eo.isFilterValueEqual(ee.table,V)&&eo.isFilterValueEqual(ee.filter,j))A.push(Object.assign(Object.assign({},O),{id:ee.id}));else{this.unsubscribe(),this.state=kt.errored,e?.(os.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,e&&e(os.SUBSCRIBED);return}}).receive("error",v=>{this.state=kt.errored,e?.(os.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(os.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===kt.joined&&e===Xa.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,i)}async httpSend(e,t,i={}){var s;if(t==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=i.timeout)!==null&&s!==void 0?s:this.timeout);if(u.status===202)return{success:!0};let h=u.statusText;try{const d=await u.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(e,t={}){var i,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:a}=e,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var a,u,h;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(u=(a=this.params)===null||a===void 0?void 0:a.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),d.receive("ok",()=>l("ok")),d.receive("error",()=>l("error")),d.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=kt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ui.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(s=>{i=new sm(this,ui.leave,{},e),i.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=kt.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const s=new AbortController,l=setTimeout(()=>s.abort(),i),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(l),a}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new sm(this,e,t,i);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>yM){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var s,l;const a=e.toLocaleLowerCase(),{close:u,error:h,leave:d,join:g}=ui;if(i&&[u,h,d,g].indexOf(a)>=0&&i!==this._joinRef())return;let b=this._onMessage(a,t,i);if(t&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var S,_,k;return((S=v.filter)===null||S===void 0?void 0:S.event)==="*"||((k=(_=v.filter)===null||_===void 0?void 0:_.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===a}).map(v=>v.callback(b,i)):(l=this.bindings[a])===null||l===void 0||l.filter(v=>{var S,_,k,A,M,O;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in v){const z=v.id,q=(S=v.filter)===null||S===void 0?void 0:S.event;return z&&((_=t.ids)===null||_===void 0?void 0:_.includes(z))&&(q==="*"||q?.toLocaleLowerCase()===((k=t.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const z=(M=(A=v?.filter)===null||A===void 0?void 0:A.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return z==="*"||z===((O=t?.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===a}).map(v=>{if(typeof b=="object"&&"ids"in b){const S=b.data,{schema:_,table:k,commit_timestamp:A,type:M,errors:O}=S;b=Object.assign(Object.assign({},{schema:_,table:k,commit_timestamp:A,eventType:M,new:{},old:{},errors:O}),this._getPayloadRecords(S))}v.callback(b,i)})}_isClosed(){return this.state===kt.closed}_isJoined(){return this.state===kt.joined}_isJoining(){return this.state===kt.joining}_isLeaving(){return this.state===kt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const s=e.toLocaleLowerCase(),l={type:s,filter:t,callback:i};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&eo.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ui.close,{},e)}_onError(e){this._on(ui.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=kt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=s_(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=s_(e.columns,e.old_record)),t}}const rm=()=>{},_h={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},AM=[1e3,2e3,5e3,1e4],CM=1e4,TM=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class EM{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=d0,this.transport=null,this.heartbeatIntervalMs=_h.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=rm,this.ref=0,this.reconnectTimer=null,this.vsn=i_,this.logger=rm,this.conn=null,this.sendBuffer=[],this.serializer=new bM,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...l)=>s(...l):(...l)=>fetch(...l),!(!((i=t?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${g0.websocket}`,this.httpEndpoint=Qk(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=fM.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case $s.connecting:return Rr.Connecting;case $s.open:return Rr.Open;case $s.closing:return Rr.Closing;default:return Rr.Closed}}isConnected(){return this.connectionState()===Rr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,s=this.getChannels().find(l=>l.topic===i);if(s)return s;{const l=new eo(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:i,payload:s,ref:l}=e,a=()=>{this.encode(e,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${t} ${i} (${l})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(mM,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},_h.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const d=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",d)}catch(g){this.log("error","error in heartbeat callback",g)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:i,event:s,payload:l,ref:a}=t,u=a?`(${a})`:"",h=l.status||"";this.log("receive",`${h} ${i} ${s} ${u}`.trim(),l),this.channels.filter(d=>d._isMember(i)).forEach(d=>d._trigger(s,l,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===$s.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===$s.open||this.conn.readyState===$s.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(ui.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${i}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([TM],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,i=!1;if(e)t=e,i=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),t=this.accessTokenValue}else t=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const l={access_token:t,version:gM};t&&s.updateJoinPayload(l),s.joinedOnce&&s._isJoined()&&s._push(ui.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new Jk(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_h.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,s,l,a,u,h,d,g,m,b,v;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e?.timeout)!==null&&i!==void 0?i:d0,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:_h.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(a=e?.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(u=e?.heartbeatCallback)!==null&&u!==void 0?u:rm,this.vsn=(h=e?.vsn)!==null&&h!==void 0?h:i_,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(S=>AM[S-1]||CM),this.vsn){case pM:this.encode=(g=e?.encode)!==null&&g!==void 0?g:((S,_)=>_(JSON.stringify(S))),this.decode=(m=e?.decode)!==null&&m!==void 0?m:((S,_)=>_(JSON.parse(S)));break;case Fk:this.encode=(b=e?.encode)!==null&&b!==void 0?b:this.serializer.encode.bind(this.serializer),this.decode=(v=e?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var oc=class extends Error{constructor(n,e){super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function OM(n,e,t){const i=new URL(e,n);if(t)for(const[s,l]of Object.entries(t))l!==void 0&&i.searchParams.set(s,l);return i.toString()}async function DM(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function MM(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:i,query:s,body:l,headers:a}){const u=OM(n.baseUrl,i,s),h=await DM(n.auth),d=await e(u,{method:t,headers:{...l?{"Content-Type":"application/json"}:{},...h,...a},body:l?JSON.stringify(l):void 0}),g=await d.text(),m=(d.headers.get("content-type")||"").includes("application/json"),b=m&&g?JSON.parse(g):g;if(!d.ok){const v=m?b:void 0,S=v?.error;throw new oc(S?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:S?.type,icebergCode:S?.code,details:v})}return{status:d.status,headers:d.headers,data:b}}}}function xh(n){return n.join("")}var RM=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:xh(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${xh(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${xh(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${xh(n.namespace)}`}),!0}catch(e){if(e instanceof oc&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof oc&&t.status===409)return;throw t}}};function ql(n){return n.join("")}var LM=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ql(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ql(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ql(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ql(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ql(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ql(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof oc&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof oc&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},NM=class{constructor(n){let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=MM({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=n.accessDelegation?.join(","),this.namespaceOps=new RM(this.client,e),this.tableOps=new LM(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}},nd=class extends Error{constructor(n,e="storage",t,i){super(n),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=t,this.statusCode=i}};function id(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var kh=class extends nd{constructor(n,e,t,i="storage"){super(n,i,e,t),this.name=i==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Zk=class extends nd{constructor(n,e,t="storage"){super(n,t),this.name=t==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const BM=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),UM=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},m0=n=>{if(Array.isArray(n))return n.map(t=>m0(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const s=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[s]=m0(i)}),e},jM=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function ac(n){"@babel/helpers - typeof";return ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ac(n)}function zM(n,e){if(ac(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(ac(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function IM(n){var e=zM(n,"string");return ac(e)=="symbol"?e:e+""}function HM(n,e,t){return(e=IM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o_(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function pe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?o_(Object(t),!0).forEach(function(i){HM(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):o_(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const a_=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},qM=async(n,e,t,i)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!t?.noResolveJson){const s=n,l=s.status||500;if(typeof s.json=="function")s.json().then(a=>{const u=a?.statusCode||a?.code||l+"";e(new kh(a_(a),l,u,i))}).catch(()=>{if(i==="vectors"){const a=l+"";e(new kh(s.statusText||`HTTP ${l} error`,l,a,i))}else{const a=l+"";e(new kh(s.statusText||`HTTP ${l} error`,l,a,i))}});else{const a=l+"";e(new kh(s.statusText||`HTTP ${l} error`,l,a,i))}}else e(new Zk(a_(n),n,i))},VM=(n,e,t,i)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||n==="HEAD"||!i?pe(pe({},s),t):(UM(i)?(s.headers=pe({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(i)):s.body=i,e?.duplex&&(s.duplex=e.duplex),pe(pe({},s),t))};async function ja(n,e,t,i,s,l,a){return new Promise((u,h)=>{n(t,VM(e,i,s,l)).then(d=>{if(!d.ok)throw d;if(i?.noResolveJson)return d;if(a==="vectors"){const g=d.headers.get("content-type");if(d.headers.get("content-length")==="0"||d.status===204)return{};if(!g||!g.includes("application/json"))return{}}return d.json()}).then(d=>u(d)).catch(d=>qM(d,h,i,a))})}function eA(n="storage"){return{get:async(e,t,i,s)=>ja(e,"GET",t,i,s,void 0,n),post:async(e,t,i,s,l)=>ja(e,"POST",t,s,l,i,n),put:async(e,t,i,s,l)=>ja(e,"PUT",t,s,l,i,n),head:async(e,t,i,s)=>ja(e,"HEAD",t,pe(pe({},i),{},{noResolveJson:!0}),s,void 0,n),remove:async(e,t,i,s,l)=>ja(e,"DELETE",t,s,l,i,n)}}const $M=eA("storage"),{get:cc,post:ci,put:y0,head:PM,remove:Dy}=$M,Bn=eA("vectors");var No=class{constructor(n,e={},t,i="storage"){this.shouldThrowOnError=!1,this.url=n,this.headers=e,this.fetch=BM(t),this.namespace=i}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(n){var e=this;try{return{data:await n(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(id(t))return{data:null,error:t};throw t}}},GM=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e}then(n,e){return this.execute().then(n,e)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(id(e))return{data:null,error:e};throw e}}};let tA;tA=Symbol.toStringTag;var KM=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e,this[tA]="BlobDownloadBuilder",this.promise=null}asStream(){return new GM(this.downloadFn,this.shouldThrowOnError)}then(n,e){return this.getPromise().then(n,e)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(id(e))return{data:null,error:e};throw e}}};const WM={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},c_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var YM=class extends No{constructor(n,e={},t,i){super(n,e,i,"storage"),this.bucketId=t}async uploadOrUpdate(n,e,t,i){var s=this;return s.handleOperation(async()=>{let l;const a=pe(pe({},c_),i);let u=pe(pe({},s.headers),n==="POST"&&{"x-upsert":String(a.upsert)});const h=a.metadata;typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",a.cacheControl),h&&l.append("metadata",s.encodeMetadata(h)),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.has("cacheControl")||l.append("cacheControl",a.cacheControl),h&&!l.has("metadata")&&l.append("metadata",s.encodeMetadata(h))):(l=t,u["cache-control"]=`max-age=${a.cacheControl}`,u["content-type"]=a.contentType,h&&(u["x-metadata"]=s.toBase64(s.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!a.duplex&&(a.duplex="half")),i?.headers&&(u=pe(pe({},u),i.headers));const d=s._removeEmptyFolders(e),g=s._getFinalPath(d),m=await(n=="PUT"?y0:ci)(s.fetch,`${s.url}/object/${g}`,l,pe({headers:u},a?.duplex?{duplex:a.duplex}:{}));return{path:d,id:m.Id,fullPath:m.Key}})}async upload(n,e,t){return this.uploadOrUpdate("POST",n,e,t)}async uploadToSignedUrl(n,e,t,i){var s=this;const l=s._removeEmptyFolders(n),a=s._getFinalPath(l),u=new URL(s.url+`/object/upload/sign/${a}`);return u.searchParams.set("token",e),s.handleOperation(async()=>{let h;const d=pe({upsert:c_.upsert},i),g=pe(pe({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&t instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",t)):typeof FormData<"u"&&t instanceof FormData?(h=t,h.append("cacheControl",d.cacheControl)):(h=t,g["cache-control"]=`max-age=${d.cacheControl}`,g["content-type"]=d.contentType),{path:l,fullPath:(await y0(s.fetch,u.toString(),h,{headers:g})).Key}})}async createSignedUploadUrl(n,e){var t=this;return t.handleOperation(async()=>{let i=t._getFinalPath(n);const s=pe({},t.headers);e?.upsert&&(s["x-upsert"]="true");const l=await ci(t.fetch,`${t.url}/object/upload/sign/${i}`,{},{headers:s}),a=new URL(t.url+l.url),u=a.searchParams.get("token");if(!u)throw new nd("No token returned by API");return{signedUrl:a.toString(),path:n,token:u}})}async update(n,e,t){return this.uploadOrUpdate("PUT",n,e,t)}async move(n,e,t){var i=this;return i.handleOperation(async()=>await ci(i.fetch,`${i.url}/object/move`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:i.headers}))}async copy(n,e,t){var i=this;return i.handleOperation(async()=>({path:(await ci(i.fetch,`${i.url}/object/copy`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:i.headers})).Key}))}async createSignedUrl(n,e,t){var i=this;return i.handleOperation(async()=>{let s=i._getFinalPath(n),l=await ci(i.fetch,`${i.url}/object/sign/${s}`,pe({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:i.headers});const a=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{signedUrl:encodeURI(`${i.url}${l.signedURL}${a}`)}})}async createSignedUrls(n,e,t){var i=this;return i.handleOperation(async()=>{const s=await ci(i.fetch,`${i.url}/object/sign/${i.bucketId}`,{expiresIn:e,paths:n},{headers:i.headers}),l=t?.download?`&download=${t.download===!0?"":t.download}`:"";return s.map(a=>pe(pe({},a),{},{signedUrl:a.signedURL?encodeURI(`${i.url}${a.signedURL}${l}`):null}))})}download(n,e){const t=typeof e?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(e?.transform||{}),s=i?`?${i}`:"",l=this._getFinalPath(n),a=()=>cc(this.fetch,`${this.url}/${t}/${l}${s}`,{headers:this.headers,noResolveJson:!0});return new KM(a,this.shouldThrowOnError)}async info(n){var e=this;const t=e._getFinalPath(n);return e.handleOperation(async()=>m0(await cc(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})))}async exists(n){var e=this;const t=e._getFinalPath(n);try{return await PM(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(id(i)&&i instanceof Zk){const s=i.originalError;if([400,404].includes(s?.status))return{data:!1,error:i}}throw i}}getPublicUrl(n,e){const t=this._getFinalPath(n),i=[],s=e?.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&i.push(s);const l=typeof e?.transform<"u"?"render/image":"object",a=this.transformOptsToQueryString(e?.transform||{});a!==""&&i.push(a);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${u}`)}}}async remove(n){var e=this;return e.handleOperation(async()=>await Dy(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:n},{headers:e.headers}))}async list(n,e,t){var i=this;return i.handleOperation(async()=>{const s=pe(pe(pe({},WM),e),{},{prefix:n||""});return await ci(i.fetch,`${i.url}/object/list/${i.bucketId}`,s,{headers:i.headers},t)})}async listV2(n,e){var t=this;return t.handleOperation(async()=>{const i=pe({},n);return await ci(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,i,{headers:t.headers},e)})}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}};const FM="2.95.2",qc={"X-Client-Info":`storage-js/${FM}`};var JM=class extends No{constructor(n,e={},t,i){const s=new URL(n);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."));const l=s.href.replace(/\/$/,""),a=pe(pe({},qc),e);super(l,a,t,"storage")}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=e.listBucketOptionsToQueryString(n);return await cc(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers})})}async getBucket(n){var e=this;return e.handleOperation(async()=>await cc(e.fetch,`${e.url}/bucket/${n}`,{headers:e.headers}))}async createBucket(n,e={public:!1}){var t=this;return t.handleOperation(async()=>await ci(t.fetch,`${t.url}/bucket`,{id:n,name:n,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async updateBucket(n,e){var t=this;return t.handleOperation(async()=>await y0(t.fetch,`${t.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async emptyBucket(n){var e=this;return e.handleOperation(async()=>await ci(e.fetch,`${e.url}/bucket/${n}/empty`,{},{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await Dy(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(n){const e={};return n&&("limit"in n&&(e.limit=String(n.limit)),"offset"in n&&(e.offset=String(n.offset)),n.search&&(e.search=n.search),n.sortColumn&&(e.sortColumn=n.sortColumn),n.sortOrder&&(e.sortOrder=n.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},XM=class extends No{constructor(n,e={},t){const i=n.replace(/\/$/,""),s=pe(pe({},qc),e);super(i,s,t,"storage")}async createBucket(n){var e=this;return e.handleOperation(async()=>await ci(e.fetch,`${e.url}/bucket`,{name:n},{headers:e.headers}))}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=new URLSearchParams;n?.limit!==void 0&&t.set("limit",n.limit.toString()),n?.offset!==void 0&&t.set("offset",n.offset.toString()),n?.sortColumn&&t.set("sortColumn",n.sortColumn),n?.sortOrder&&t.set("sortOrder",n.sortOrder),n?.search&&t.set("search",n.search);const i=t.toString(),s=i?`${e.url}/bucket?${i}`:`${e.url}/bucket`;return await cc(e.fetch,s,{headers:e.headers})})}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await Dy(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}from(n){var e=this;if(!jM(n))throw new nd("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new NM({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(t,{get(s,l){const a=s[l];return typeof a!="function"?a:async(...u)=>{try{return{data:await a.apply(s,u),error:null}}catch(h){if(i)throw h;return{data:null,error:h}}}}})}},QM=class extends No{constructor(n,e={},t){const i=n.replace(/\/$/,""),s=pe(pe({},qc),{},{"Content-Type":"application/json"},e);super(i,s,t,"vectors")}async createIndex(n){var e=this;return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/CreateIndex`,n,{headers:e.headers})||{})}async getIndex(n,e){var t=this;return t.handleOperation(async()=>await Bn.post(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers}))}async listIndexes(n){var e=this;return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/ListIndexes`,n,{headers:e.headers}))}async deleteIndex(n,e){var t=this;return t.handleOperation(async()=>await Bn.post(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers})||{})}},ZM=class extends No{constructor(n,e={},t){const i=n.replace(/\/$/,""),s=pe(pe({},qc),{},{"Content-Type":"application/json"},e);super(i,s,t,"vectors")}async putVectors(n){var e=this;if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/PutVectors`,n,{headers:e.headers})||{})}async getVectors(n){var e=this;return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/GetVectors`,n,{headers:e.headers}))}async listVectors(n){var e=this;if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/ListVectors`,n,{headers:e.headers}))}async queryVectors(n){var e=this;return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/QueryVectors`,n,{headers:e.headers}))}async deleteVectors(n){var e=this;if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/DeleteVectors`,n,{headers:e.headers})||{})}},eR=class extends No{constructor(n,e={},t){const i=n.replace(/\/$/,""),s=pe(pe({},qc),{},{"Content-Type":"application/json"},e);super(i,s,t,"vectors")}async createBucket(n){var e=this;return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}async getBucket(n){var e=this;return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:n},{headers:e.headers}))}async listBuckets(n={}){var e=this;return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/ListVectorBuckets`,n,{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await Bn.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}},tR=class extends eR{constructor(n,e={}){super(n,e.headers||{},e.fetch)}from(n){return new nR(this.url,this.headers,n,this.fetch)}async createBucket(n){var e=()=>super.createBucket,t=this;return e().call(t,n)}async getBucket(n){var e=()=>super.getBucket,t=this;return e().call(t,n)}async listBuckets(n={}){var e=()=>super.listBuckets,t=this;return e().call(t,n)}async deleteBucket(n){var e=()=>super.deleteBucket,t=this;return e().call(t,n)}},nR=class extends QM{constructor(n,e,t,i){super(n,e,i),this.vectorBucketName=t}async createIndex(n){var e=()=>super.createIndex,t=this;return e().call(t,pe(pe({},n),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(n={}){var e=()=>super.listIndexes,t=this;return e().call(t,pe(pe({},n),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(n){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,n)}async deleteIndex(n){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,n)}index(n){return new iR(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},iR=class extends ZM{constructor(n,e,t,i,s){super(n,e,s),this.vectorBucketName=t,this.indexName=i}async putVectors(n){var e=()=>super.putVectors,t=this;return e().call(t,pe(pe({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(n){var e=()=>super.getVectors,t=this;return e().call(t,pe(pe({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(n={}){var e=()=>super.listVectors,t=this;return e().call(t,pe(pe({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(n){var e=()=>super.queryVectors,t=this;return e().call(t,pe(pe({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(n){var e=()=>super.deleteVectors,t=this;return e().call(t,pe(pe({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},sR=class extends JM{constructor(n,e={},t,i){super(n,e,t,i)}from(n){return new YM(this.url,this.headers,n,this.fetch)}get vectors(){return new tR(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new XM(this.url+"/iceberg",this.headers,this.fetch)}};const nA="2.95.2",Fl=30*1e3,b0=3,lm=b0*Fl,rR="http://localhost:9999",lR="supabase.auth.token",oR={"X-Client-Info":`gotrue-js/${nA}`},v0="X-Supabase-Api-Version",iA={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},aR=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,cR=600*1e3;class uc extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function le(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class uR extends uc{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function hR(n){return le(n)&&n.name==="AuthApiError"}class Lr extends uc{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ps extends uc{constructor(e,t,i,s){super(e,i,s),this.name=t,this.status=i}}class Dn extends ps{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function om(n){return le(n)&&n.name==="AuthSessionMissingError"}class Vl extends ps{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ah extends ps{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ch extends ps{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function fR(n){return le(n)&&n.name==="AuthImplicitGrantRedirectError"}class u_ extends ps{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class dR extends ps{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class w0 extends ps{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function am(n){return le(n)&&n.name==="AuthRetryableFetchError"}class h_ extends ps{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class S0 extends ps{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const gf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),f_=` 	
\r=`.split(""),gR=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<f_.length;e+=1)n[f_[e].charCodeAt(0)]=-2;for(let e=0;e<gf.length;e+=1)n[gf[e].charCodeAt(0)]=e;return n})();function d_(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(gf[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(gf[i]),e.queuedBits-=6}}function sA(n,e,t){const i=gR[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function g_(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},i={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=a=>{yR(a,i,t)};for(let a=0;a<n.length;a+=1)sA(n.charCodeAt(a),s,l);return e.join("")}function pR(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function mR(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const s=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}pR(i,e)}}function yR(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function ro(n){const e=[],t={queue:0,queuedBits:0},i=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)sA(n.charCodeAt(s),t,i);return new Uint8Array(e)}function bR(n){const e=[];return mR(n,t=>e.push(t)),new Uint8Array(e)}function Ur(n){const e=[],t={queue:0,queuedBits:0},i=s=>{e.push(s)};return n.forEach(s=>d_(s,t,i)),d_(null,t,i),e.join("")}function vR(n){return Math.round(Date.now()/1e3)+n}function wR(){return Symbol("auth-callback")}const qt=()=>typeof window<"u"&&typeof document<"u",Tr={tested:!1,writable:!1},rA=()=>{if(!qt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Tr.tested)return Tr.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Tr.tested=!0,Tr.writable=!0}catch{Tr.tested=!0,Tr.writable=!1}return Tr.writable};function SR(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,l)=>{e[l]=s})}catch{}return t.searchParams.forEach((i,s)=>{e[s]=i}),e}const lA=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),_R=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Jl=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Er=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ht=async(n,e)=>{await n.removeItem(e)};class sd{constructor(){this.promise=new sd.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}sd.promiseConstructor=Promise;function Th(n){const e=n.split(".");if(e.length!==3)throw new S0("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!aR.test(e[i]))throw new S0("JWT not in base64url format");return{header:JSON.parse(g_(e[0])),payload:JSON.parse(g_(e[1])),signature:ro(e[2]),raw:{header:e[0],payload:e[1]}}}async function xR(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function kR(n,e){return new Promise((i,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const a=await n(l);if(!e(l,null,a)){i(a);return}}catch(a){if(!e(l,a)){s(a);return}}})()})}function AR(n){return("0"+n.toString(16)).substr(-2)}function CR(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let s="";for(let l=0;l<56;l++)s+=t.charAt(Math.floor(Math.random()*i));return s}return crypto.getRandomValues(e),Array.from(e,AR).join("")}async function TR(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(i);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function ER(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await TR(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $l(n,e,t=!1){const i=CR();let s=i;t&&(s+="/PASSWORD_RECOVERY"),await Jl(n,`${e}-code-verifier`,s);const l=await ER(i);return[l,i===l?"plain":"s256"]}const OR=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function DR(n){const e=n.headers.get(v0);if(!e||!e.match(OR))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function MR(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function RR(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const LR=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Pl(n){if(!LR.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function cm(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function NR(n,e){return new Proxy(n,{get:(t,i,s)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const l=i.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,i,s)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,i,s)}})}function p_(n){return JSON.parse(JSON.stringify(n))}const Dr=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),BR=[502,503,504];async function m_(n){var e;if(!_R(n))throw new w0(Dr(n),0);if(BR.includes(n.status))throw new w0(Dr(n),n.status);let t;try{t=await n.json()}catch(l){throw new Lr(Dr(l),l)}let i;const s=DR(n);if(s&&s.getTime()>=iA["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new h_(Dr(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Dn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,a)=>l&&typeof a=="string",!0))throw new h_(Dr(t),n.status,t.weak_password.reasons);throw new uR(Dr(t),n.status||500,i)}const UR=(n,e,t,i)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(i),Object.assign(Object.assign({},s),t))};async function de(n,e,t,i){var s;const l=Object.assign({},i?.headers);l[v0]||(l[v0]=iA["2024-01-01"].name),i?.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const a=(s=i?.query)!==null&&s!==void 0?s:{};i?.redirectTo&&(a.redirect_to=i.redirectTo);const u=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",h=await jR(n,e,t+u,{headers:l,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(h):{data:Object.assign({},h),error:null}}async function jR(n,e,t,i,s,l){const a=UR(e,i,s,l);let u;try{u=await n(t,Object.assign({},a))}catch(h){throw console.error(h),new w0(Dr(h),0)}if(u.ok||await m_(u),i?.noResolveJson)return u;try{return await u.json()}catch(h){await m_(h)}}function ai(n){var e;let t=null;HR(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=vR(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function y_(n){const e=ai(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Ks(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function zR(n){return{data:n,error:null}}function IR(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:s,verification_type:l}=n,a=td(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:e,email_otp:t,hashed_token:i,redirect_to:s,verification_type:l},h=Object.assign({},a);return{data:{properties:u,user:h},error:null}}function b_(n){return n}function HR(n){return n.access_token&&n.refresh_token&&n.expires_in}const um=["global","local","others"];class qR{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=lA(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=um[0]){if(um.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${um.join(", ")}`);try{return await de(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(le(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await de(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ks})}catch(i){if(le(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=td(e,["options"]),s=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(s.new_email=i?.newEmail,delete s.newEmail),await de(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:IR,redirectTo:t?.redirectTo})}catch(t){if(le(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await de(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ks})}catch(t){if(le(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,s,l,a,u,h;try{const d={nextPage:null,lastPage:0,total:0},g=await de(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:b_});if(g.error)throw g.error;const m=await g.json(),b=(a=g.headers.get("x-total-count"))!==null&&a!==void 0?a:0,v=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(S=>{const _=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(S.split(";")[1].split("=")[1]);d[`${k}Page`]=_}),d.total=parseInt(b)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(le(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Pl(e);try{return await de(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ks})}catch(t){if(le(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Pl(e);try{return await de(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ks})}catch(i){if(le(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){Pl(e);try{return await de(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ks})}catch(i){if(le(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){Pl(e.userId);try{const{data:t,error:i}=await de(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:i}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Pl(e.userId),Pl(e.id);try{return{data:await de(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,i,s,l,a,u,h;try{const d={nextPage:null,lastPage:0,total:0},g=await de(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:b_});if(g.error)throw g.error;const m=await g.json(),b=(a=g.headers.get("x-total-count"))!==null&&a!==void 0?a:0,v=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(S=>{const _=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(S.split(";")[1].split("=")[1]);d[`${k}Page`]=_}),d.total=parseInt(b)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(le(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await de(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await de(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await de(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(le(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await de(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await de(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}}function v_(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Gl={debug:!!(globalThis&&rA()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class oA extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class VR extends oA{}async function $R(n,e,t){Gl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),Gl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async s=>{if(s){Gl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Gl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Gl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new VR(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Gl.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function PR(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function aA(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function GR(n){return parseInt(n,16)}function KR(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function WR(n){var e;const{chainId:t,domain:i,expirationTime:s,issuedAt:l=new Date,nonce:a,notBefore:u,requestId:h,resources:d,scheme:g,uri:m,version:b}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(b!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${b}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const v=aA(n.address),S=g?`${g}://${i}`:i,_=n.statement?`${n.statement}
`:"",k=`${S} wants you to sign in with your Ethereum account:
${v}

${_}`;let A=`URI: ${m}
Version: ${b}
Chain ID: ${t}${a?`
Nonce: ${a}`:""}
Issued At: ${l.toISOString()}`;if(s&&(A+=`
Expiration Time: ${s.toISOString()}`),u&&(A+=`
Not Before: ${u.toISOString()}`),h&&(A+=`
Request ID: ${h}`),d){let M=`
Resources:`;for(const O of d){if(!O||typeof O!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${O}`);M+=`
- ${O}`}A+=M}return`${k}
${A}`}class wt extends Error{constructor({message:e,code:t,cause:i,name:s}){var l;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(l=s??(i instanceof Error?i.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=t}}class pf extends wt{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function YR({error:n,options:e}){var t,i,s;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new wt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=l.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new wt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new wt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new wt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new wt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new wt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return l.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new wt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new wt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const a=window.location.hostname;if(cA(a)){if(l.rp.id!==a)return new wt({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new wt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new wt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new wt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new wt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function FR({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new wt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new wt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(cA(i)){if(t.rpId!==i)return new wt({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new wt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new wt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new wt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class JR{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const XR=new JR;function QR(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:i}=n,s=td(n,["challenge","user","excludeCredentials"]),l=ro(e).buffer,a=Object.assign(Object.assign({},t),{id:ro(t.id).buffer}),u=Object.assign(Object.assign({},s),{challenge:l,user:a});if(i&&i.length>0){u.excludeCredentials=new Array(i.length);for(let h=0;h<i.length;h++){const d=i[h];u.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:ro(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return u}function ZR(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,i=td(n,["challenge","allowCredentials"]),s=ro(e).buffer,l=Object.assign(Object.assign({},i),{challenge:s});if(t&&t.length>0){l.allowCredentials=new Array(t.length);for(let a=0;a<t.length;a++){const u=t[a];l.allowCredentials[a]=Object.assign(Object.assign({},u),{id:ro(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function eL(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Ur(new Uint8Array(n.response.attestationObject)),clientDataJSON:Ur(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function tL(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,i=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Ur(new Uint8Array(s.authenticatorData)),clientDataJSON:Ur(new Uint8Array(s.clientDataJSON)),signature:Ur(new Uint8Array(s.signature)),userHandle:s.userHandle?Ur(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function cA(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function w_(){var n,e;return!!(qt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function nL(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new pf("Browser returned unexpected credential type",e)}:{data:null,error:new pf("Empty credential response",e)}}catch(e){return{data:null,error:YR({error:e,options:n})}}}async function iL(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new pf("Browser returned unexpected credential type",e)}:{data:null,error:new pf("Empty credential response",e)}}catch(e){return{data:null,error:FR({error:e,options:n})}}}const sL={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},rL={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function mf(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),i={};for(const s of n)if(s)for(const l in s){const a=s[l];if(a!==void 0)if(Array.isArray(a))i[l]=a;else if(t(a))i[l]=a;else if(e(a)){const u=i[l];e(u)?i[l]=mf(u,a):i[l]=mf(a)}else i[l]=a}return i}function lL(n,e){return mf(sL,n,e||{})}function oL(n,e){return mf(rL,n,e||{})}class aL{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:s},l){var a;try{const{data:u,error:h}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!u)return{data:null,error:h};const d=s??XR.createNewAbortSignal();if(u.webauthn.type==="create"){const{user:g}=u.webauthn.credential_options.publicKey;if(!g.name){const m=i;if(m)g.name=`${g.id}:${m}`;else{const v=(await this.client.getUser()).data.user,S=((a=v?.user_metadata)===null||a===void 0?void 0:a.name)||v?.email||v?.id||"User";g.name=`${g.id}:${S}`}}g.displayName||(g.displayName=g.name)}switch(u.webauthn.type){case"create":{const g=lL(u.webauthn.credential_options.publicKey,l?.create),{data:m,error:b}=await nL({publicKey:g,signal:d});return m?{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:m}},error:null}:{data:null,error:b}}case"request":{const g=oL(u.webauthn.credential_options.publicKey,l?.request),{data:m,error:b}=await iL(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:g,signal:d}));return m?{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:m}},error:null}:{data:null,error:b}}}}catch(u){return le(u)?{data:null,error:u}:{data:null,error:new Lr("Unexpected error in challenge",u)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!t)return{data:null,error:new uc("rpId is required for WebAuthn authentication")};try{if(!w_())return{data:null,error:new Lr("Browser does not support WebAuthn",null)};const{data:a,error:u}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:s},{request:l});if(!a)return{data:null,error:u};const{webauthn:h}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:h.type,rpId:t,rpOrigins:i,credential_response:h.credential_response}})}catch(a){return le(a)?{data:null,error:a}:{data:null,error:new Lr("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!t)return{data:null,error:new uc("rpId is required for WebAuthn registration")};try{if(!w_())return{data:null,error:new Lr("Browser does not support WebAuthn",null)};const{data:a,error:u}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(g=>{var m;return(m=g.data)===null||m===void 0?void 0:m.all.find(b=>b.factor_type==="webauthn"&&b.friendly_name===e&&b.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:u};const{data:h,error:d}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:s},{create:l});return h?this._verify({factorId:a.id,challengeId:h.challengeId,webauthn:{rpId:t,rpOrigins:i,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(a){return le(a)?{data:null,error:a}:{data:null,error:new Lr("Unexpected error in register",a)}}}}PR();const cL={url:rR,storageKey:lR,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:oR,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function S_(n,e,t){return await t()}const Kl={};class hc{get jwks(){var e,t;return(t=(e=Kl[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Kl[this.storageKey]=Object.assign(Object.assign({},Kl[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Kl[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Kl[this.storageKey]=Object.assign(Object.assign({},Kl[this.storageKey]),{cachedAt:e})}constructor(e){var t,i,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},cL),e);if(this.storageKey=l.storageKey,this.instanceID=(t=hc.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,hc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&qt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new qR({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=lA(l.fetch),this.lock=l.lock||S_,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&qt()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=$R:this.lock=S_,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new aL(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:rA()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=v_(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=v_(this.memoryStorage)),qt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a);try{await this._notifyAllSubscribers(a.data.event,a.data.session,!1)}catch(u){this._debug("#broadcastChannel","error",u)}})}this.initialize().catch(a=>{this._debug("#initialize()","error",a)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${nA}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},i="none";if(qt()&&(t=SR(window.location.href),this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce")),qt()&&this.detectSessionInUrl&&i!=="none"){const{data:s,error:l}=await this._getSessionFromURL(t,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),fR(l)){const h=(e=l.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:a,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",u),await this._saveSession(a),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return le(t)?this._returnResult({error:t}):this._returnResult({error:new Lr("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,s;try{const l=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:ai}),{data:a,error:u}=l;if(u||!a)return this._returnResult({data:{user:null,session:null},error:u});const h=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(le(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var t,i,s;try{let l;if("email"in e){const{email:g,password:m,options:b}=e;let v=null,S=null;this.flowType==="pkce"&&([v,S]=await $l(this.storage,this.storageKey)),l=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b?.emailRedirectTo,body:{email:g,password:m,data:(t=b?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:b?.captchaToken},code_challenge:v,code_challenge_method:S},xform:ai})}else if("phone"in e){const{phone:g,password:m,options:b}=e;l=await de(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:m,data:(i=b?.data)!==null&&i!==void 0?i:{},channel:(s=b?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:ai})}else throw new Ah("You must provide either an email or phone number and a password");const{data:a,error:u}=l;if(u||!a)return await Ht(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const h=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),le(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:a,options:u}=e;t=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:a,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:y_})}else if("phone"in e){const{phone:l,password:a,options:u}=e;t=await de(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:a,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:y_})}else throw new Ah("You must provide either an email or phone number and a password");const{data:i,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!i||!i.session||!i.user){const l=new Vl;return this._returnResult({data:{user:null,session:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:s})}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,i,s,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,s,l,a,u,h,d,g,m,b;let v,S;if("message"in e)v=e.message,S=e.signature;else{const{chain:_,wallet:k,statement:A,options:M}=e;let O;if(qt())if(typeof k=="object")O=k;else{const se=window;if("ethereum"in se&&typeof se.ethereum=="object"&&"request"in se.ethereum&&typeof se.ethereum.request=="function")O=se.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=k}const z=new URL((t=M?.url)!==null&&t!==void 0?t:window.location.href),q=await O.request({method:"eth_requestAccounts"}).then(se=>se).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!q||q.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const V=aA(q[0]);let j=(i=M?.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!j){const se=await O.request({method:"eth_chainId"});j=GR(se)}const ee={domain:z.host,address:V,statement:A,uri:z.href,version:"1",chainId:j,nonce:(s=M?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(a=(l=M?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(u=M?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(h=M?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=M?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(g=M?.signInWithEthereum)===null||g===void 0?void 0:g.resources};v=WR(ee),S=await O.request({method:"personal_sign",params:[KR(v),V]})}try{const{data:_,error:k}=await de(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:S},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(b=e.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:ai});if(k)throw k;if(!_||!_.session||!_.user){const A=new Vl;return this._returnResult({data:{user:null,session:null},error:A})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:k})}catch(_){if(le(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var t,i,s,l,a,u,h,d,g,m,b,v;let S,_;if("message"in e)S=e.message,_=e.signature;else{const{chain:k,wallet:A,statement:M,options:O}=e;let z;if(qt())if(typeof A=="object")z=A;else{const V=window;if("solana"in V&&typeof V.solana=="object"&&("signIn"in V.solana&&typeof V.solana.signIn=="function"||"signMessage"in V.solana&&typeof V.solana.signMessage=="function"))z=V.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!O?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");z=A}const q=new URL((t=O?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in z&&z.signIn){const V=await z.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},O?.signInWithSolana),{version:"1",domain:q.host,uri:q.href}),M?{statement:M}:null));let j;if(Array.isArray(V)&&V[0]&&typeof V[0]=="object")j=V[0];else if(V&&typeof V=="object"&&"signedMessage"in V&&"signature"in V)j=V;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)S=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),_=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in z)||typeof z.signMessage!="function"||!("publicKey"in z)||typeof z!="object"||!z.publicKey||!("toBase58"in z.publicKey)||typeof z.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${q.host} wants you to sign in with your Solana account:`,z.publicKey.toBase58(),...M?["",M,""]:[""],"Version: 1",`URI: ${q.href}`,`Issued At: ${(s=(i=O?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=O?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${O.signInWithSolana.notBefore}`]:[],...!((a=O?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${O.signInWithSolana.expirationTime}`]:[],...!((u=O?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${O.signInWithSolana.chainId}`]:[],...!((h=O?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${O.signInWithSolana.nonce}`]:[],...!((d=O?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${O.signInWithSolana.requestId}`]:[],...!((m=(g=O?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||m===void 0)&&m.length?["Resources",...O.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const V=await z.signMessage(new TextEncoder().encode(S),"utf8");if(!V||!(V instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=V}}try{const{data:k,error:A}=await de(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:Ur(_)},!((b=e.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:ai});if(A)throw A;if(!k||!k.session||!k.user){const M=new Vl;return this._returnResult({data:{user:null,session:null},error:M})}return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),this._returnResult({data:Object.assign({},k),error:A})}catch(k){if(le(k))return this._returnResult({data:{user:null,session:null},error:k});throw k}}async _exchangeCodeForSession(e){const t=await Er(this.storage,`${this.storageKey}-code-verifier`),[i,s]=(t??"").split("/");try{if(!i&&this.flowType==="pkce")throw new dR;const{data:l,error:a}=await de(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:ai});if(await Ht(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!l||!l.session||!l.user){const u=new Vl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:a})}catch(l){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),le(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:t,provider:i,token:s,access_token:l,nonce:a}=e,u=await de(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:s,access_token:l,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:ai}),{data:h,error:d}=u;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!h||!h.session||!h.user){const g=new Vl;return this._returnResult({data:{user:null,session:null},error:g})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:d})}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,i,s,l,a;try{if("email"in e){const{email:u,options:h}=e;let d=null,g=null;this.flowType==="pkce"&&([d,g]=await $l(this.storage,this.storageKey));const{error:m}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(t=h?.data)!==null&&t!==void 0?t:{},create_user:(i=h?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:g},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:u,options:h}=e,{data:d,error:g}=await de(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=h?.data)!==null&&s!==void 0?s:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(a=h?.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:g})}throw new Ah("You must provide either an email or phone number.")}catch(u){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),le(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(e){var t,i;try{let s,l;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:a,error:u}=await de(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:ai});if(u)throw u;if(!a)throw new Error("An error occurred on token verification.");const h=a.session,d=a.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(s){if(le(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,i,s,l,a;try{let u=null,h=null;this.flowType==="pkce"&&([u,h]=await $l(this.storage,this.storageKey));const d=await de(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:zR});return!((l=d.data)===null||l===void 0)&&l.url&&qt()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(u){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),le(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new Dn;const{error:s}=await de(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(le(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:s,options:l}=e,{error:a}=await de(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:i,type:s,options:l}=e,{data:a,error:u}=await de(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a?.message_id},error:u})}throw new Ah("You must provide either an email or phone number and a type")}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Er(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<lm:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const a=await Er(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=cm()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=NR(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ks}):await this._useSession(async t=>{var i,s,l;const{data:a,error:u}=t;if(u)throw u;return!(!((i=a.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Dn}:await de(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:Ks})})}catch(t){if(le(t))return om(t)&&(await this._removeSession(),await Ht(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:s,error:l}=i;if(l)throw l;if(!s.session)throw new Dn;const a=s.session;let u=null,h=null;this.flowType==="pkce"&&e.email!=null&&([u,h]=await $l(this.storage,this.storageKey));const{data:d,error:g}=await de(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:u,code_challenge_method:h}),jwt:a.access_token,xform:Ks});if(g)throw g;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(i){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),le(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Dn;const t=Date.now()/1e3;let i=t,s=!0,l=null;const{payload:a}=Th(e.access_token);if(a.exp&&(i=a.exp,s=i<=t),s){const{data:u,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(e.access_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});l={access_token:e.access_token,refresh_token:e.refresh_token,user:u.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(t){if(le(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:a,error:u}=t;if(u)throw u;e=(i=a.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new Dn;const{data:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!qt())throw new Ch("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ch(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new u_("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ch("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new u_("No code detected.");const{data:M,error:O}=await this._exchangeCodeForSession(e.code);if(O)throw O;const z=new URL(window.location.href);return z.searchParams.delete("code"),window.history.replaceState(window.history.state,"",z.toString()),{data:{session:M.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:s,access_token:l,refresh_token:a,expires_in:u,expires_at:h,token_type:d}=e;if(!l||!u||!a||!d)throw new Ch("No session defined in URL");const g=Math.round(Date.now()/1e3),m=parseInt(u);let b=g+m;h&&(b=parseInt(h));const v=b-g;v*1e3<=Fl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${m}s`);const S=b-m;g-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,b,g):g-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,b,g);const{data:_,error:k}=await this._getUser(l);if(k)throw k;const A={provider_token:i,provider_refresh_token:s,access_token:l,expires_in:m,expires_at:b,refresh_token:a,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:e.type},error:null})}catch(i){if(le(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Er(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:s,error:l}=t;if(l&&!om(l))return this._returnResult({error:l});const a=(i=s.session)===null||i===void 0?void 0:i.access_token;if(a){const{error:u}=await this.admin.signOut(a,e);if(u&&!(hR(u)&&(u.status===404||u.status===401||u.status===403)||om(u)))return this._returnResult({error:u})}return e!=="others"&&(await this._removeSession(),await Ht(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=wR(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,s;try{const{data:{session:l},error:a}=t;if(a)throw a;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let i=null,s=null;this.flowType==="pkce"&&([i,s]=await $l(this.storage,this.storageKey,!0));try{return await de(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),le(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:i,error:s}=await this._useSession(async l=>{var a,u,h,d,g;const{data:m,error:b}=l;if(b)throw b;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(u=e.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await de(this.fetch,"GET",v,{headers:this.headers,jwt:(g=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&g!==void 0?g:void 0})});if(s)throw s;return qt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i?.url),this._returnResult({data:{provider:e.provider,url:i?.url},error:null})}catch(i){if(le(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{const{error:s,data:{session:l}}=t;if(s)throw s;const{options:a,provider:u,token:h,access_token:d,nonce:g}=e,m=await de(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=l?.access_token)!==null&&i!==void 0?i:void 0,body:{provider:u,id_token:h,access_token:d,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:ai}),{data:b,error:v}=m;return v?this._returnResult({data:{user:null,session:null},error:v}):!b||!b.session||!b.user?this._returnResult({data:{user:null,session:null},error:new Vl}):(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("USER_UPDATED",b.session)),this._returnResult({data:b,error:v}))}catch(s){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),le(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,s;const{data:l,error:a}=t;if(a)throw a;return await de(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await kR(async s=>(s>0&&await xR(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await de(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ai})),(s,l)=>{const a=200*Math.pow(2,s);return l&&am(l)&&Date.now()+a-i<Fl})}catch(i){if(this._debug(t,"error",i),le(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),qt()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const s=await Er(this.storage,this.storageKey);if(s&&this.userStorage){let a=await Er(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await Jl(this.userStorage,this.storageKey+"-user",a)),s.user=(e=a?.user)!==null&&e!==void 0?e:cm()}else if(s&&!s.user&&!s.user){const a=await Er(this.storage,this.storageKey+"-user");a&&a?.user?(s.user=a.user,await Ht(this.storage,this.storageKey+"-user"),await Jl(this.storage,this.storageKey,s)):s.user=cm()}if(this._debug(i,"session from storage",s),!this._isValidSession(s)){this._debug(i,"session is not valid"),s!==null&&await this._removeSession();return}const l=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<lm;if(this._debug(i,`session has${l?"":" not"} expired with margin of ${lm}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),am(a)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:u}=await this._getUser(s.access_token);!u&&a?.user?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(i,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(i,"error",s),console.error(s);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new Dn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new sd;const{data:l,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!l.session)throw new Dn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={data:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(s,"error",l),le(l)){const a={data:null,error:l};return am(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,i=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],a=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(e,t)}catch(h){l.push(h)}});if(await Promise.all(a),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ht(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Jl(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const l=p_(s);await Jl(this.storage,this.storageKey,l)}else{const s=p_(t);await Jl(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ht(this.storage,this.storageKey),await Ht(this.storage,this.storageKey+"-code-verifier"),await Ht(this.storage,this.storageKey+"-user"),this.userStorage&&await Ht(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&qt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Fl);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((i.expires_at*1e3-e)/Fl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Fl}ms, refresh threshold is ${b0} ticks`),s<=b0&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof oA)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const s=[`provider=${encodeURIComponent(t)}`];if(i?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&s.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,a]=await $l(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(u.toString())}if(i?.queryParams){const l=new URLSearchParams(i.queryParams);s.push(l.toString())}return i?.skipBrowserRedirect&&s.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:s,error:l}=t;return l?this._returnResult({data:null,error:l}):await de(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,s;const{data:l,error:a}=t;if(a)return this._returnResult({data:null,error:a});const u=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:d}=await de(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(i=l?.session)===null||i===void 0?void 0:i.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&h.type==="totp"&&(!((s=h?.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:s,error:l}=t;if(l)return this._returnResult({data:null,error:l});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?eL(e.webauthn.credential_response):tL(e.webauthn.credential_response)})}:{code:e.code}),{data:u,error:h}=await de(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:h}))})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:s,error:l}=t;if(l)return this._returnResult({data:null,error:l});const a=await de(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token});if(a.error)return a;const{data:u}=a;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:QR(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:ZR(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};const s={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(l),l.status==="verified"&&s[l.factor_type].push(l);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,i,s,l;if(e)try{const{payload:v}=Th(e);let S=null;v.aal&&(S=v.aal);let _=S;const{data:{user:k},error:A}=await this.getUser(e);if(A)return this._returnResult({data:null,error:A});((i=(t=k?.factors)===null||t===void 0?void 0:t.filter(z=>z.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(_="aal2");const O=v.amr||[];return{data:{currentLevel:S,nextLevel:_,currentAuthenticationMethods:O},error:null}}catch(v){if(le(v))return this._returnResult({data:null,error:v});throw v}const{data:{session:a},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=Th(a.access_token);let d=null;h.aal&&(d=h.aal);let g=d;((l=(s=a.user.factors)===null||s===void 0?void 0:s.filter(v=>v.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(g="aal2");const b=h.amr||[];return{data:{currentLevel:d,nextLevel:g,currentAuthenticationMethods:b},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:i},error:s}=t;return s?this._returnResult({data:null,error:s}):i?await de(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Dn})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:s},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new Dn});const a=await de(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return a.data&&a.data.redirect_url&&qt()&&!t?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(i){if(le(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:s},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new Dn});const a=await de(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return a.data&&a.data.redirect_url&&qt()&&!t?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(i){if(le(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;return i?this._returnResult({data:null,error:i}):t?await de(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Dn})})}catch(e){if(le(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:i},error:s}=t;return s?this._returnResult({data:null,error:s}):i?(await de(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Dn})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(u=>u.kid===e);if(i)return i;const s=Date.now();if(i=this.jwks.keys.find(u=>u.kid===e),i&&this.jwks_cached_at+cR>s)return i;const{data:l,error:a}=await de(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,i=l.keys.find(u=>u.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:v,error:S}=await this.getSession();if(S||!v.session)return this._returnResult({data:null,error:S});i=v.session.access_token}const{header:s,payload:l,signature:a,raw:{header:u,payload:h}}=Th(i);t?.allowExpired||MR(l.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:v}=await this.getUser(i);if(v)throw v;return{data:{claims:l,header:s,signature:a},error:null}}const g=RR(s.alg),m=await crypto.subtle.importKey("jwk",d,g,!0,["verify"]);if(!await crypto.subtle.verify(g,m,a,bR(`${u}.${h}`)))throw new S0("Invalid JWT signature");return{data:{claims:l,header:s,signature:a},error:null}}catch(i){if(le(i))return this._returnResult({data:null,error:i});throw i}}}hc.nextInstanceID={};const uL=hc,hL="2.95.2";let Pa="";typeof Deno<"u"?Pa="deno":typeof document<"u"?Pa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Pa="react-native":Pa="node";const fL={"X-Client-Info":`supabase-js-${Pa}/${hL}`},dL={headers:fL},gL={schema:"public"},pL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},mL={};function fc(n){"@babel/helpers - typeof";return fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fc(n)}function yL(n,e){if(fc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(fc(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function bL(n){var e=yL(n,"string");return fc(e)=="symbol"?e:e+""}function vL(n,e,t){return(e=bL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function __(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function at(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?__(Object(t),!0).forEach(function(i){vL(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):__(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const wL=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),SL=()=>Headers,_L=(n,e,t)=>{const i=wL(t),s=SL();return async(l,a)=>{var u;const h=(u=await e())!==null&&u!==void 0?u:n;let d=new s(a?.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),i(l,at(at({},a),{},{headers:d}))}};function xL(n){return n.endsWith("/")?n:n+"/"}function kL(n,e){var t,i;const{db:s,auth:l,realtime:a,global:u}=n,{db:h,auth:d,realtime:g,global:m}=e,b={db:at(at({},h),s),auth:at(at({},d),l),realtime:at(at({},g),a),storage:{},global:at(at(at({},m),u),{},{headers:at(at({},(t=m?.headers)!==null&&t!==void 0?t:{}),(i=u?.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return n.accessToken?b.accessToken=n.accessToken:delete b.accessToken,b}function AL(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(xL(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var CL=class extends uL{constructor(n){super(n)}},TL=class{constructor(n,e,t){var i,s;this.supabaseUrl=n,this.supabaseKey=e;const l=AL(n);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const a=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:gL,realtime:mL,auth:at(at({},pL),{},{storageKey:a}),global:dL},h=kL(t??{},u);if(this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(g,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=h.auth)!==null&&d!==void 0?d:{},this.headers,h.global.fetch)}this.fetch=_L(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(at({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new hM(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch,timeout:h.db.timeout,urlLengthLimit:h.db.urlLengthLimit}),this.storage=new sR(this.storageUrl.href,this.headers,this.fetch,t?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new iM(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,e,t)}channel(n,e={config:{}}){return this.realtime.channel(n,e)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,e,t;if(n.accessToken)return await n.accessToken();const{data:i}=await n.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:s,storageKey:l,flowType:a,lock:u,debug:h,throwOnError:d},g,m){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new CL({url:this.authUrl.href,headers:at(at({},b),g),storageKey:l,autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:s,flowType:a,lock:u,debug:h,throwOnError:d,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new EM(this.realtimeUrl.href,at(at({},n),{},{params:at(at({},{apikey:this.supabaseKey}),n?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,e)=>{this._handleTokenChanged(n,"CLIENT",e?.access_token)})}_handleTokenChanged(n,e,t){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const EL=(n,e,t)=>new TL(n,e,t);function OL(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const e=n.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}OL()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const bn=()=>new Map,_0=n=>{const e=bn();return n.forEach((t,i)=>{e.set(i,t)}),e},ms=(n,e,t)=>{let i=n.get(e);return i===void 0&&n.set(e,i=t()),i},DL=(n,e)=>{const t=[];for(const[i,s]of n)t.push(e(s,i));return t},ML=(n,e)=>{for(const[t,i]of n)if(e(i,t))return!0;return!1},Gr=()=>new Set,hm=n=>n[n.length-1],RL=(n,e)=>{for(let t=0;t<e.length;t++)n.push(e[t])},hs=Array.from,My=(n,e)=>{for(let t=0;t<n.length;t++)if(!e(n[t],t,n))return!1;return!0},Ry=(n,e)=>{for(let t=0;t<n.length;t++)if(e(n[t],t,n))return!0;return!1},LL=(n,e)=>{const t=new Array(n);for(let i=0;i<n;i++)t[i]=e(i,t);return t},bo=Array.isArray;class uA{constructor(){this._observers=bn()}on(e,t){return ms(this._observers,e,Gr).add(t),t}once(e,t){const i=(...s)=>{this.off(e,i),t(...s)};this.on(e,i)}off(e,t){const i=this._observers.get(e);i!==void 0&&(i.delete(t),i.size===0&&this._observers.delete(e))}emit(e,t){return hs((this._observers.get(e)||bn()).values()).forEach(i=>i(...t))}destroy(){this._observers=bn()}}class NL{constructor(){this._observers=bn()}on(e,t){ms(this._observers,e,Gr).add(t)}once(e,t){const i=(...s)=>{this.off(e,i),t(...s)};this.on(e,i)}off(e,t){const i=this._observers.get(e);i!==void 0&&(i.delete(t),i.size===0&&this._observers.delete(e))}emit(e,t){return hs((this._observers.get(e)||bn()).values()).forEach(i=>i(...t))}destroy(){this._observers=bn()}}const pi=Math.floor,tf=Math.abs,Ly=(n,e)=>n<e?n:e,lr=(n,e)=>n>e?n:e,hA=n=>n!==0?n<0:1/n<0,x_=1,k_=2,fm=4,dm=8,dc=32,us=64,jn=128,rd=31,x0=63,Hr=127,BL=2147483647,yf=Number.MAX_SAFE_INTEGER,A_=Number.MIN_SAFE_INTEGER,UL=Number.isInteger||(n=>typeof n=="number"&&isFinite(n)&&pi(n)===n),jL=String.fromCharCode,zL=n=>n.toLowerCase(),IL=/^\s*/g,HL=n=>n.replace(IL,""),qL=/([A-Z])/g,C_=(n,e)=>HL(n.replace(qL,t=>`${e}${zL(t)}`)),VL=n=>{const e=unescape(encodeURIComponent(n)),t=e.length,i=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=e.codePointAt(s);return i},gc=typeof TextEncoder<"u"?new TextEncoder:null,$L=n=>gc.encode(n),PL=gc?$L:VL;let Qa=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Qa&&Qa.decode(new Uint8Array).length===1&&(Qa=null);const GL=(n,e)=>LL(e,()=>n).join("");class Vc{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const $c=()=>new Vc,KL=n=>{let e=n.cpos;for(let t=0;t<n.bufs.length;t++)e+=n.bufs[t].length;return e},fi=n=>{const e=new Uint8Array(KL(n));let t=0;for(let i=0;i<n.bufs.length;i++){const s=n.bufs[i];e.set(s,t),t+=s.length}return e.set(new Uint8Array(n.cbuf.buffer,0,n.cpos),t),e},WL=(n,e)=>{const t=n.cbuf.length;t-n.cpos<e&&(n.bufs.push(new Uint8Array(n.cbuf.buffer,0,n.cpos)),n.cbuf=new Uint8Array(lr(t,e)*2),n.cpos=0)},Mt=(n,e)=>{const t=n.cbuf.length;n.cpos===t&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(t*2),n.cpos=0),n.cbuf[n.cpos++]=e},k0=Mt,Ce=(n,e)=>{for(;e>Hr;)Mt(n,jn|Hr&e),e=pi(e/128);Mt(n,Hr&e)},Ny=(n,e)=>{const t=hA(e);for(t&&(e=-e),Mt(n,(e>x0?jn:0)|(t?us:0)|x0&e),e=pi(e/64);e>0;)Mt(n,(e>Hr?jn:0)|Hr&e),e=pi(e/128)},A0=new Uint8Array(3e4),YL=A0.length/3,FL=(n,e)=>{if(e.length<YL){const t=gc.encodeInto(e,A0).written||0;Ce(n,t);for(let i=0;i<t;i++)Mt(n,A0[i])}else Mn(n,PL(e))},JL=(n,e)=>{const t=unescape(encodeURIComponent(e)),i=t.length;Ce(n,i);for(let s=0;s<i;s++)Mt(n,t.codePointAt(s))},qr=gc&&gc.encodeInto?FL:JL,ld=(n,e)=>{const t=n.cbuf.length,i=n.cpos,s=Ly(t-i,e.length),l=e.length-s;n.cbuf.set(e.subarray(0,s),i),n.cpos+=s,l>0&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(lr(t*2,l)),n.cbuf.set(e.subarray(s)),n.cpos=l)},Mn=(n,e)=>{Ce(n,e.byteLength),ld(n,e)},By=(n,e)=>{WL(n,e);const t=new DataView(n.cbuf.buffer,n.cpos,e);return n.cpos+=e,t},XL=(n,e)=>By(n,4).setFloat32(0,e,!1),QL=(n,e)=>By(n,8).setFloat64(0,e,!1),ZL=(n,e)=>By(n,8).setBigInt64(0,e,!1),T_=new DataView(new ArrayBuffer(4)),eN=n=>(T_.setFloat32(0,n),T_.getFloat32(0)===n),pc=(n,e)=>{switch(typeof e){case"string":Mt(n,119),qr(n,e);break;case"number":UL(e)&&tf(e)<=BL?(Mt(n,125),Ny(n,e)):eN(e)?(Mt(n,124),XL(n,e)):(Mt(n,123),QL(n,e));break;case"bigint":Mt(n,122),ZL(n,e);break;case"object":if(e===null)Mt(n,126);else if(bo(e)){Mt(n,117),Ce(n,e.length);for(let t=0;t<e.length;t++)pc(n,e[t])}else if(e instanceof Uint8Array)Mt(n,116),Mn(n,e);else{Mt(n,118);const t=Object.keys(e);Ce(n,t.length);for(let i=0;i<t.length;i++){const s=t[i];qr(n,s),pc(n,e[s])}}break;case"boolean":Mt(n,e?120:121);break;default:Mt(n,127)}};class E_ extends Vc{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Ce(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const O_=n=>{n.count>0&&(Ny(n.encoder,n.count===1?n.s:-n.s),n.count>1&&Ce(n.encoder,n.count-2))};class nf{constructor(){this.encoder=new Vc,this.s=0,this.count=0}write(e){this.s===e?this.count++:(O_(this),this.count=1,this.s=e)}toUint8Array(){return O_(this),fi(this.encoder)}}const D_=n=>{if(n.count>0){const e=n.diff*2+(n.count===1?0:1);Ny(n.encoder,e),n.count>1&&Ce(n.encoder,n.count-2)}};class gm{constructor(){this.encoder=new Vc,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(D_(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return D_(this),fi(this.encoder)}}class tN{constructor(){this.sarr=[],this.s="",this.lensE=new nf}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new Vc;return this.sarr.push(this.s),this.s="",qr(e,this.sarr.join("")),ld(e,this.lensE.toUint8Array()),fi(e)}}const Ui=n=>new Error(n),gi=()=>{throw Ui("Method unimplemented")},zn=()=>{throw Ui("Unexpected case")},fA=Ui("Unexpected end of array"),dA=Ui("Integer out of Range");class od{constructor(e){this.arr=e,this.pos=0}}const Zr=n=>new od(n),nN=n=>n.pos!==n.arr.length,iN=(n,e)=>{const t=new Uint8Array(n.arr.buffer,n.pos+n.arr.byteOffset,e);return n.pos+=e,t},Rn=n=>iN(n,ke(n)),vo=n=>n.arr[n.pos++],ke=n=>{let e=0,t=1;const i=n.arr.length;for(;n.pos<i;){const s=n.arr[n.pos++];if(e=e+(s&Hr)*t,t*=128,s<jn)return e;if(e>yf)throw dA}throw fA},Uy=n=>{let e=n.arr[n.pos++],t=e&x0,i=64;const s=(e&us)>0?-1:1;if((e&jn)===0)return s*t;const l=n.arr.length;for(;n.pos<l;){if(e=n.arr[n.pos++],t=t+(e&Hr)*i,i*=128,e<jn)return s*t;if(t>yf)throw dA}throw fA},sN=n=>{let e=ke(n);if(e===0)return"";{let t=String.fromCodePoint(vo(n));if(--e<100)for(;e--;)t+=String.fromCodePoint(vo(n));else for(;e>0;){const i=e<1e4?e:1e4,s=n.arr.subarray(n.pos,n.pos+i);n.pos+=i,t+=String.fromCodePoint.apply(null,s),e-=i}return decodeURIComponent(escape(t))}},rN=n=>Qa.decode(Rn(n)),Vr=Qa?rN:sN,jy=(n,e)=>{const t=new DataView(n.arr.buffer,n.arr.byteOffset+n.pos,e);return n.pos+=e,t},lN=n=>jy(n,4).getFloat32(0,!1),oN=n=>jy(n,8).getFloat64(0,!1),aN=n=>jy(n,8).getBigInt64(0,!1),cN=[n=>{},n=>null,Uy,lN,oN,aN,n=>!1,n=>!0,Vr,n=>{const e=ke(n),t={};for(let i=0;i<e;i++){const s=Vr(n);t[s]=mc(n)}return t},n=>{const e=ke(n),t=[];for(let i=0;i<e;i++)t.push(mc(n));return t},Rn],mc=n=>cN[127-vo(n)](n);class M_ extends od{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),nN(this)?this.count=ke(this)+1:this.count=-1),this.count--,this.s}}class sf extends od{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=Uy(this);const e=hA(this.s);this.count=1,e&&(this.s=-this.s,this.count=ke(this)+2)}return this.count--,this.s}}class pm extends od{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=Uy(this),t=e&1;this.diff=pi(e/2),this.count=1,t&&(this.count=ke(this)+2)}return this.s+=this.diff,this.count--,this.s}}class uN{constructor(e){this.decoder=new sf(e),this.str=Vr(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const hN=crypto.getRandomValues.bind(crypto),gA=()=>hN(new Uint32Array(1))[0],fN="10000000-1000-4000-8000"+-1e11,dN=()=>fN.replace(/[018]/g,n=>(n^gA()&15>>n/4).toString(16)),yc=Date.now,R_=n=>new Promise(n);Promise.all.bind(Promise);const L_=n=>n===void 0?null:n;class gN{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let pA=new gN,pN=!0;try{typeof localStorage<"u"&&localStorage&&(pA=localStorage,pN=!1)}catch{}const mN=pA,bc=Symbol("Equality"),mA=(n,e)=>n===e||!!n?.[bc]?.(e)||!1,yN=n=>typeof n=="object",bN=Object.assign,vN=Object.keys,wN=(n,e)=>{for(const t in n)e(n[t],t)},bf=n=>vN(n).length,SN=n=>{for(const e in n)return!1;return!0},Pc=(n,e)=>{for(const t in n)if(!e(n[t],t))return!1;return!0},zy=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),_N=(n,e)=>n===e||bf(n)===bf(e)&&Pc(n,(t,i)=>(t!==void 0||zy(e,i))&&mA(e[i],t)),xN=Object.freeze,yA=n=>{for(const e in n){const t=n[e];(typeof t=="object"||typeof t=="function")&&yA(n[e])}return xN(n)},Iy=(n,e,t=0)=>{try{for(;t<n.length;t++)n[t](...e)}finally{t<n.length&&Iy(n,e,t+1)}},kN=n=>n,lo=(n,e)=>{if(n===e)return!0;if(n==null||e==null||n.constructor!==e.constructor&&(n.constructor||Object)!==(e.constructor||Object))return!1;if(n[bc]!=null)return n[bc](e);switch(n.constructor){case ArrayBuffer:n=new Uint8Array(n),e=new Uint8Array(e);case Uint8Array:{if(n.byteLength!==e.byteLength)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;break}case Set:{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;break}case Map:{if(n.size!==e.size)return!1;for(const t of n.keys())if(!e.has(t)||!lo(n.get(t),e.get(t)))return!1;break}case void 0:case Object:if(bf(n)!==bf(e))return!1;for(const t in n)if(!zy(n,t)||!lo(n[t],e[t]))return!1;break;case Array:if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!lo(n[t],e[t]))return!1;break;default:return!1}return!0},AN=(n,e)=>e.includes(n);var bA={};const vc=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let ki;const CN=()=>{if(ki===void 0)if(vc){ki=bn();const n=process.argv;let e=null;for(let t=0;t<n.length;t++){const i=n[t];i[0]==="-"?(e!==null&&ki.set(e,""),e=i):e!==null&&(ki.set(e,i),e=null)}e!==null&&ki.set(e,"")}else typeof location=="object"?(ki=bn(),(location.search||"?").slice(1).split("&").forEach(n=>{if(n.length!==0){const[e,t]=n.split("=");ki.set(`--${C_(e,"-")}`,t),ki.set(`-${C_(e,"-")}`,t)}})):ki=bn();return ki},C0=n=>CN().has(n),vf=n=>L_(vc?bA[n.toUpperCase().replaceAll("-","_")]:mN.getItem(n)),vA=n=>C0("--"+n)||vf(n)!==null,TN=vA("production"),EN=vc&&AN(bA.FORCE_COLOR,["true","1","2"]),ON=EN||!C0("--no-colors")&&!vA("no-color")&&(!vc||process.stdout.isTTY)&&(!vc||C0("--color")||vf("COLORTERM")!==null||(vf("TERM")||"").includes("color")),DN=n=>new Uint8Array(n),MN=n=>{const e=DN(n.byteLength);return e.set(n),e};class RN{constructor(e,t){this.left=e,this.right=t}}const Ln=(n,e)=>new RN(n,e),LN=(n,e)=>n.forEach(t=>e(t.left,t.right)),N_=n=>n.next()>=.5,mm=(n,e,t)=>pi(n.next()*(t+1-e)+e),wA=(n,e,t)=>pi(n.next()*(t+1-e)+e),Hy=(n,e,t)=>wA(n,e,t),NN=n=>jL(Hy(n,97,122)),BN=(n,e=0,t=20)=>{const i=Hy(n,e,t);let s="";for(let l=0;l<i;l++)s+=NN(n);return s},ym=(n,e)=>e[Hy(n,0,e.length-1)],UN=Symbol("0schema");class jN{constructor(){this._rerrs=[]}extend(e,t,i,s=null){this._rerrs.push({path:e,expected:t,has:i,message:s})}toString(){const e=[];for(let t=this._rerrs.length-1;t>0;t--){const i=this._rerrs[t];e.push(GL(" ",(this._rerrs.length-t)*2)+`${i.path!=null?`[${i.path}] `:""}${i.has} doesn't match ${i.expected}. ${i.message}`)}return e.join(`
`)}}const T0=(n,e)=>n===e?!0:n==null||e==null||n.constructor!==e.constructor?!1:n[bc]?mA(n,e):bo(n)?My(n,t=>Ry(e,i=>T0(t,i))):yN(n)?Pc(n,(t,i)=>T0(t,e[i])):!1;class sn{static _dilutes=!1;extends(e){let[t,i]=[this.shape,e.shape];return this.constructor._dilutes&&([i,t]=[t,i]),T0(t,i)}equals(e){return this.constructor===e.constructor&&lo(this.shape,e.shape)}[UN](){return!0}[bc](e){return this.equals(e)}validate(e){return this.check(e)}check(e,t){gi()}get nullable(){return Bo(this,fd)}get optional(){return new xA(this)}cast(e){return B_(e,this),e}expect(e){return B_(e,this),e}}class qy extends sn{constructor(e,t){super(),this.shape=e,this._c=t}check(e,t=void 0){const i=e?.constructor===this.shape&&(this._c==null||this._c(e));return!i&&t?.extend(null,this.shape.name,e?.constructor.name,e?.constructor!==this.shape?"Constructor match failed":"Check failed"),i}}const _t=(n,e=null)=>new qy(n,e);_t(qy);class Vy extends sn{constructor(e){super(),this.shape=e}check(e,t){const i=this.shape(e);return!i&&t?.extend(null,"custom prop",e?.constructor.name,"failed to check custom prop"),i}}const Nt=n=>new Vy(n);_t(Vy);class ad extends sn{constructor(e){super(),this.shape=e}check(e,t){const i=this.shape.some(s=>s===e);return!i&&t?.extend(null,this.shape.join(" | "),e.toString()),i}}const cd=(...n)=>new ad(n),SA=_t(ad),zN=RegExp.escape||(n=>n.replace(/[().|&,$^[\]]/g,e=>"\\"+e)),_A=n=>{if(wo.check(n))return[zN(n)];if(SA.check(n))return n.shape.map(e=>e+"");if(RA.check(n))return["[+-]?\\d+.?\\d*"];if(LA.check(n))return[".*"];if(wf.check(n))return n.shape.map(_A).flat(1);zn()};class IN extends sn{constructor(e){super(),this.shape=e,this._r=new RegExp("^"+e.map(_A).map(t=>`(${t.join("|")})`).join("")+"$")}check(e,t){const i=this._r.exec(e)!=null;return!i&&t?.extend(null,this._r.toString(),e.toString(),"String doesn't match string template."),i}}_t(IN);const HN=Symbol("optional");class xA extends sn{constructor(e){super(),this.shape=e}check(e,t){const i=e===void 0||this.shape.check(e);return!i&&t?.extend(null,"undefined (optional)","()"),i}get[HN](){return!0}}const qN=_t(xA);class VN extends sn{check(e,t){return t?.extend(null,"never",typeof e),!1}}_t(VN);class ud extends sn{constructor(e,t=!1){super(),this.shape=e,this._isPartial=t}static _dilutes=!0;get partial(){return new ud(this.shape,!0)}check(e,t){return e==null?(t?.extend(null,"object","null"),!1):Pc(this.shape,(i,s)=>{const l=this._isPartial&&!zy(e,s)||i.check(e[s],t);return!l&&t?.extend(s.toString(),i.toString(),typeof e[s],"Object property does not match"),l})}}const $N=n=>new ud(n),PN=_t(ud),GN=Nt(n=>n!=null&&(n.constructor===Object||n.constructor==null));class kA extends sn{constructor(e,t){super(),this.shape={keys:e,values:t}}check(e,t){return e!=null&&Pc(e,(i,s)=>{const l=this.shape.keys.check(s,t);return!l&&t?.extend(s+"","Record",typeof e,l?"Key doesn't match schema":"Value doesn't match value"),l&&this.shape.values.check(i,t)})}}const AA=(n,e)=>new kA(n,e),KN=_t(kA);class CA extends sn{constructor(e){super(),this.shape=e}check(e,t){return e!=null&&Pc(this.shape,(i,s)=>{const l=i.check(e[s],t);return!l&&t?.extend(s.toString(),"Tuple",typeof i),l})}}const WN=(...n)=>new CA(n);_t(CA);class TA extends sn{constructor(e){super(),this.shape=e.length===1?e[0]:new $y(e)}check(e,t){const i=bo(e)&&My(e,s=>this.shape.check(s));return!i&&t?.extend(null,"Array",""),i}}const EA=(...n)=>new TA(n),YN=_t(TA),FN=Nt(n=>bo(n));class OA extends sn{constructor(e,t){super(),this.shape=e,this._c=t}check(e,t){const i=e instanceof this.shape&&(this._c==null||this._c(e));return!i&&t?.extend(null,this.shape.name,e?.constructor.name),i}}const JN=(n,e=null)=>new OA(n,e);_t(OA);const XN=JN(sn);class QN extends sn{constructor(e){super(),this.len=e.length-1,this.args=WN(...e.slice(-1)),this.res=e[this.len]}check(e,t){const i=e.constructor===Function&&e.length<=this.len;return!i&&t?.extend(null,"function",typeof e),i}}const ZN=_t(QN),eB=Nt(n=>typeof n=="function");class tB extends sn{constructor(e){super(),this.shape=e}check(e,t){const i=My(this.shape,s=>s.check(e,t));return!i&&t?.extend(null,"Intersectinon",typeof e),i}}_t(tB,n=>n.shape.length>0);class $y extends sn{static _dilutes=!0;constructor(e){super(),this.shape=e}check(e,t){const i=Ry(this.shape,s=>s.check(e,t));return t?.extend(null,"Union",typeof e),i}}const Bo=(...n)=>n.findIndex(e=>wf.check(e))>=0?Bo(...n.map(e=>wc(e)).map(e=>wf.check(e)?e.shape:[e]).flat(1)):n.length===1?n[0]:new $y(n),wf=_t($y),DA=()=>!0,Sf=Nt(DA),nB=_t(Vy,n=>n.shape===DA),Py=Nt(n=>typeof n=="bigint"),iB=Nt(n=>n===Py),MA=Nt(n=>typeof n=="symbol");Nt(n=>n===MA);const oo=Nt(n=>typeof n=="number"),RA=Nt(n=>n===oo),wo=Nt(n=>typeof n=="string"),LA=Nt(n=>n===wo),hd=Nt(n=>typeof n=="boolean"),sB=Nt(n=>n===hd),NA=cd(void 0);_t(ad,n=>n.shape.length===1&&n.shape[0]===void 0);cd(void 0);const fd=cd(null),rB=_t(ad,n=>n.shape.length===1&&n.shape[0]===null);_t(Uint8Array);_t(qy,n=>n.shape===Uint8Array);const lB=Bo(oo,wo,fd,NA,Py,hd,MA);(()=>{const n=EA(Sf),e=AA(wo,Sf),t=Bo(oo,wo,fd,hd,n,e);return n.shape=t,e.shape.values=t,t})();const wc=n=>{if(XN.check(n))return n;if(GN.check(n)){const e={};for(const t in n)e[t]=wc(n[t]);return $N(e)}else{if(FN.check(n))return Bo(...n.map(wc));if(lB.check(n))return cd(n);if(eB.check(n))return _t(n)}zn()},B_=TN?()=>{}:(n,e)=>{const t=new jN;if(!e.check(n,t))throw Ui(`Expected value to be of type ${e.constructor.name}.
${t.toString()}`)};class oB{constructor(e){this.patterns=[],this.$state=e}if(e,t){return this.patterns.push({if:wc(e),h:t}),this}else(e){return this.if(Sf,e)}done(){return(e,t)=>{for(let i=0;i<this.patterns.length;i++){const s=this.patterns[i];if(s.if.check(e))return s.h(e,t)}throw Ui("Unhandled pattern")}}}const aB=n=>new oB(n),BA=aB(Sf).if(RA,(n,e)=>mm(e,A_,yf)).if(LA,(n,e)=>BN(e)).if(sB,(n,e)=>N_(e)).if(iB,(n,e)=>BigInt(mm(e,A_,yf))).if(wf,(n,e)=>Wl(e,ym(e,n.shape))).if(PN,(n,e)=>{const t={};for(const i in n.shape){let s=n.shape[i];if(qN.check(s)){if(N_(e))continue;s=s.shape}t[i]=BA(s,e)}return t}).if(YN,(n,e)=>{const t=[],i=wA(e,0,42);for(let s=0;s<i;s++)t.push(Wl(e,n.shape));return t}).if(SA,(n,e)=>ym(e,n.shape)).if(rB,(n,e)=>null).if(ZN,(n,e)=>{const t=Wl(e,n.res);return()=>t}).if(nB,(n,e)=>Wl(e,ym(e,[oo,wo,fd,NA,Py,hd,EA(oo),AA(Bo("a","b","c"),oo)]))).if(KN,(n,e)=>{const t={},i=mm(e,0,3);for(let s=0;s<i;s++){const l=Wl(e,n.shape.keys),a=Wl(e,n.shape.values);t[l]=a}return t}).done(),Wl=(n,e)=>BA(wc(e),n),Ii=typeof document<"u"?document:{},cB=n=>Ii.createElement(n),uB=()=>Ii.createDocumentFragment();Nt(n=>n.nodeType===vB);const hB=n=>Ii.createTextNode(n);typeof DOMParser<"u"&&new DOMParser;const fB=(n,e)=>(LN(e,(t,i)=>{i===!1?n.removeAttribute(t):i===!0?n.setAttribute(t,""):n.setAttribute(t,i)}),n),dB=n=>{const e=uB();for(let t=0;t<n.length;t++)UA(e,n[t]);return e},gB=(n,e)=>(UA(n,dB(e)),n),bm=(n,e=[],t=[])=>gB(fB(cB(n),e),t);Nt(n=>n.nodeType===mB);const Eh=hB;Nt(n=>n.nodeType===yB);const pB=n=>DL(n,(e,t)=>`${t}:${e};`).join(""),UA=(n,e)=>n.appendChild(e),mB=Ii.ELEMENT_NODE,yB=Ii.TEXT_NODE;Ii.CDATA_SECTION_NODE;Ii.COMMENT_NODE;const bB=Ii.DOCUMENT_NODE;Ii.DOCUMENT_TYPE_NODE;const vB=Ii.DOCUMENT_FRAGMENT_NODE;Nt(n=>n.nodeType===bB);const ys=Symbol,jA=ys(),zA=ys(),wB=ys(),SB=ys(),_B=ys(),IA=ys(),xB=ys(),Gy=ys(),kB=ys(),AB=n=>{n.length===1&&n[0]?.constructor===Function&&(n=n[0]());const e=[],t=[];let i=0;for(;i<n.length;i++){const s=n[i];if(s===void 0)break;if(s.constructor===String||s.constructor===Number)e.push(s);else if(s.constructor===Object)break}for(i>0&&t.push(e.join(""));i<n.length;i++){const s=n[i];s instanceof Symbol||t.push(s)}return t},CB={[jA]:Ln("font-weight","bold"),[zA]:Ln("font-weight","normal"),[wB]:Ln("color","blue"),[_B]:Ln("color","green"),[SB]:Ln("color","grey"),[IA]:Ln("color","red"),[xB]:Ln("color","purple"),[Gy]:Ln("color","orange"),[kB]:Ln("color","black")},TB=n=>{n.length===1&&n[0]?.constructor===Function&&(n=n[0]());const e=[],t=[],i=bn();let s=[],l=0;for(;l<n.length;l++){const a=n[l],u=CB[a];if(u!==void 0)i.set(u.left,u.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const h=pB(i);l>0||h.length>0?(e.push("%c"+a),t.push(h)):e.push(a)}else break}}for(l>0&&(s=t,s.unshift(e.join("")));l<n.length;l++){const a=n[l];a instanceof Symbol||s.push(a)}return s},HA=ON?TB:AB,EB=(...n)=>{console.log(...HA(n)),VA.forEach(e=>e.print(n))},qA=(...n)=>{console.warn(...HA(n)),n.unshift(Gy),VA.forEach(e=>e.print(n))},VA=Gr(),$A=n=>({[Symbol.iterator](){return this},next:n}),OB=(n,e)=>$A(()=>{let t;do t=n.next();while(!t.done&&!e(t.value));return t}),vm=(n,e)=>$A(()=>{const{done:t,value:i}=n.next();return{done:t,value:t?void 0:e(i)}});class Ky{constructor(e,t){this.clock=e,this.len=t}}class Uo{constructor(){this.clients=new Map}}const So=(n,e,t)=>e.clients.forEach((i,s)=>{const l=n.doc.store.clients.get(s);if(l!=null){const a=l[l.length-1],u=a.id.clock+a.length;for(let h=0,d=i[h];h<i.length&&d.clock<u;d=i[++h])rC(n,l,d.clock,d.len,t)}}),DB=(n,e)=>{let t=0,i=n.length-1;for(;t<=i;){const s=pi((t+i)/2),l=n[s],a=l.clock;if(a<=e){if(e<a+l.len)return s;t=s+1}else i=s-1}return null},Gc=(n,e)=>{const t=n.clients.get(e.client);return t!==void 0&&DB(t,e.clock)!==null},Wy=n=>{n.clients.forEach(e=>{e.sort((s,l)=>s.clock-l.clock);let t,i;for(t=1,i=1;t<e.length;t++){const s=e[i-1],l=e[t];s.clock+s.len>=l.clock?s.len=lr(s.len,l.clock+l.len-s.clock):(i<t&&(e[i]=l),i++)}e.length=i})},E0=n=>{const e=new Uo;for(let t=0;t<n.length;t++)n[t].clients.forEach((i,s)=>{if(!e.clients.has(s)){const l=i.slice();for(let a=t+1;a<n.length;a++)RL(l,n[a].clients.get(s)||[]);e.clients.set(s,l)}});return Wy(e),e},Sc=(n,e,t,i)=>{ms(n.clients,e,()=>[]).push(new Ky(t,i))},MB=()=>new Uo,RB=n=>{const e=MB();return n.clients.forEach((t,i)=>{const s=[];for(let l=0;l<t.length;l++){const a=t[l];if(a.deleted){const u=a.id.clock;let h=a.length;if(l+1<t.length)for(let d=t[l+1];l+1<t.length&&d.deleted;d=t[++l+1])h+=d.length;s.push(new Ky(u,h))}}s.length>0&&e.clients.set(i,s)}),e},jo=(n,e)=>{Ce(n.restEncoder,e.clients.size),hs(e.clients.entries()).sort((t,i)=>i[0]-t[0]).forEach(([t,i])=>{n.resetDsCurVal(),Ce(n.restEncoder,t);const s=i.length;Ce(n.restEncoder,s);for(let l=0;l<s;l++){const a=i[l];n.writeDsClock(a.clock),n.writeDsLen(a.len)}})},Yy=n=>{const e=new Uo,t=ke(n.restDecoder);for(let i=0;i<t;i++){n.resetDsCurVal();const s=ke(n.restDecoder),l=ke(n.restDecoder);if(l>0){const a=ms(e.clients,s,()=>[]);for(let u=0;u<l;u++)a.push(new Ky(n.readDsClock(),n.readDsLen()))}}return e},U_=(n,e,t)=>{const i=new Uo,s=ke(n.restDecoder);for(let l=0;l<s;l++){n.resetDsCurVal();const a=ke(n.restDecoder),u=ke(n.restDecoder),h=t.clients.get(a)||[],d=pt(t,a);for(let g=0;g<u;g++){const m=n.readDsClock(),b=m+n.readDsLen();if(m<d){d<b&&Sc(i,a,d,b-d);let v=ji(h,m),S=h[v];for(!S.deleted&&S.id.clock<m&&(h.splice(v+1,0,Of(e,S,m-S.id.clock)),v++);v<h.length&&(S=h[v++],S.id.clock<b);)S.deleted||(b<S.id.clock+S.length&&h.splice(v,0,Of(e,S,b-S.id.clock)),S.delete(e))}else Sc(i,a,m,b-m)}}if(i.clients.size>0){const l=new Kr;return Ce(l.restEncoder,0),jo(l,i),l.toUint8Array()}return null},PA=gA;class el extends uA{constructor({guid:e=dN(),collectionid:t=null,gc:i=!0,gcFilter:s=()=>!0,meta:l=null,autoLoad:a=!1,shouldLoad:u=!0}={}){super(),this.gc=i,this.gcFilter=s,this.clientID=PA(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new iC,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=u,this.autoLoad=a,this.meta=l,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=R_(d=>{this.on("load",()=>{this.isLoaded=!0,d(this)})});const h=()=>R_(d=>{const g=m=>{(m===void 0||m===!0)&&(this.off("sync",g),d())};this.on("sync",g)});this.on("sync",d=>{d===!1&&this.isSynced&&(this.whenSynced=h()),this.isSynced=d===void 0||d===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=h()}load(){const e=this._item;e!==null&&!this.shouldLoad&&Je(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(hs(this.subdocs).map(e=>e.guid))}transact(e,t=null){return Je(this,e,t)}get(e,t=Lt){const i=ms(this.share,e,()=>{const l=new t;return l._integrate(this,null),l}),s=i.constructor;if(t!==Lt&&s!==t)if(s===Lt){const l=new t;l._map=i._map,i._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=l}),l._start=i._start;for(let a=l._start;a!==null;a=a.right)a.parent=l;return l._length=i._length,this.share.set(e,l),l._integrate(this,null),l}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return i}getArray(e=""){return this.get(e,uo)}getText(e=""){return this.get(e,ko)}getMap(e=""){return this.get(e,xo)}getXmlElement(e=""){return this.get(e,Ao)}getXmlFragment(e=""){return this.get(e,Wr)}toJSON(){const e={};return this.share.forEach((t,i)=>{e[i]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,hs(this.subdocs).forEach(t=>t.destroy());const e=this._item;if(e!==null){this._item=null;const t=e.content;t.doc=new el({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,Je(e.parent.doc,i=>{const s=t.doc;e.deleted||i.subdocsAdded.add(s),i.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class GA{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return ke(this.restDecoder)}readDsLen(){return ke(this.restDecoder)}}class KA extends GA{readLeftID(){return Se(ke(this.restDecoder),ke(this.restDecoder))}readRightID(){return Se(ke(this.restDecoder),ke(this.restDecoder))}readClient(){return ke(this.restDecoder)}readInfo(){return vo(this.restDecoder)}readString(){return Vr(this.restDecoder)}readParentInfo(){return ke(this.restDecoder)===1}readTypeRef(){return ke(this.restDecoder)}readLen(){return ke(this.restDecoder)}readAny(){return mc(this.restDecoder)}readBuf(){return MN(Rn(this.restDecoder))}readJSON(){return JSON.parse(Vr(this.restDecoder))}readKey(){return Vr(this.restDecoder)}}class LB{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=ke(this.restDecoder),this.dsCurrVal}readDsLen(){const e=ke(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class _o extends LB{constructor(e){super(e),this.keys=[],ke(e),this.keyClockDecoder=new pm(Rn(e)),this.clientDecoder=new sf(Rn(e)),this.leftClockDecoder=new pm(Rn(e)),this.rightClockDecoder=new pm(Rn(e)),this.infoDecoder=new M_(Rn(e),vo),this.stringDecoder=new uN(Rn(e)),this.parentInfoDecoder=new M_(Rn(e),vo),this.typeRefDecoder=new sf(Rn(e)),this.lenDecoder=new sf(Rn(e))}readLeftID(){return new ao(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ao(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return mc(this.restDecoder)}readBuf(){return Rn(this.restDecoder)}readJSON(){return mc(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class WA{constructor(){this.restEncoder=$c()}toUint8Array(){return fi(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Ce(this.restEncoder,e)}writeDsLen(e){Ce(this.restEncoder,e)}}class Kc extends WA{writeLeftID(e){Ce(this.restEncoder,e.client),Ce(this.restEncoder,e.clock)}writeRightID(e){Ce(this.restEncoder,e.client),Ce(this.restEncoder,e.clock)}writeClient(e){Ce(this.restEncoder,e)}writeInfo(e){k0(this.restEncoder,e)}writeString(e){qr(this.restEncoder,e)}writeParentInfo(e){Ce(this.restEncoder,e?1:0)}writeTypeRef(e){Ce(this.restEncoder,e)}writeLen(e){Ce(this.restEncoder,e)}writeAny(e){pc(this.restEncoder,e)}writeBuf(e){Mn(this.restEncoder,e)}writeJSON(e){qr(this.restEncoder,JSON.stringify(e))}writeKey(e){qr(this.restEncoder,e)}}class YA{constructor(){this.restEncoder=$c(),this.dsCurrVal=0}toUint8Array(){return fi(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,Ce(this.restEncoder,t)}writeDsLen(e){e===0&&zn(),Ce(this.restEncoder,e-1),this.dsCurrVal+=e}}class Kr extends YA{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new gm,this.clientEncoder=new nf,this.leftClockEncoder=new gm,this.rightClockEncoder=new gm,this.infoEncoder=new E_(k0),this.stringEncoder=new tN,this.parentInfoEncoder=new E_(k0),this.typeRefEncoder=new nf,this.lenEncoder=new nf}toUint8Array(){const e=$c();return Ce(e,0),Mn(e,this.keyClockEncoder.toUint8Array()),Mn(e,this.clientEncoder.toUint8Array()),Mn(e,this.leftClockEncoder.toUint8Array()),Mn(e,this.rightClockEncoder.toUint8Array()),Mn(e,fi(this.infoEncoder)),Mn(e,this.stringEncoder.toUint8Array()),Mn(e,fi(this.parentInfoEncoder)),Mn(e,this.typeRefEncoder.toUint8Array()),Mn(e,this.lenEncoder.toUint8Array()),ld(e,fi(this.restEncoder)),fi(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){pc(this.restEncoder,e)}writeBuf(e){Mn(this.restEncoder,e)}writeJSON(e){pc(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const NB=(n,e,t,i)=>{i=lr(i,e[0].id.clock);const s=ji(e,i);Ce(n.restEncoder,e.length-s),n.writeClient(t),Ce(n.restEncoder,i);const l=e[s];l.write(n,i-l.id.clock);for(let a=s+1;a<e.length;a++)e[a].write(n,0)},Fy=(n,e,t)=>{const i=new Map;t.forEach((s,l)=>{pt(e,l)>s&&i.set(l,s)}),dd(e).forEach((s,l)=>{t.has(l)||i.set(l,0)}),Ce(n.restEncoder,i.size),hs(i.entries()).sort((s,l)=>l[0]-s[0]).forEach(([s,l])=>{NB(n,e.clients.get(s),s,l)})},BB=(n,e)=>{const t=bn(),i=ke(n.restDecoder);for(let s=0;s<i;s++){const l=ke(n.restDecoder),a=new Array(l),u=n.readClient();let h=ke(n.restDecoder);t.set(u,{i:0,refs:a});for(let d=0;d<l;d++){const g=n.readInfo();switch(rd&g){case 0:{const m=n.readLen();a[d]=new Jn(Se(u,h),m),h+=m;break}case 10:{const m=ke(n.restDecoder);a[d]=new Xn(Se(u,h),m),h+=m;break}default:{const m=(g&(us|jn))===0,b=new Xe(Se(u,h),null,(g&jn)===jn?n.readLeftID():null,null,(g&us)===us?n.readRightID():null,m?n.readParentInfo()?e.get(n.readString()):n.readLeftID():null,m&&(g&dc)===dc?n.readString():null,CC(n,g));a[d]=b,h+=b.length}}}}return t},UB=(n,e,t)=>{const i=[];let s=hs(t.keys()).sort((v,S)=>v-S);if(s.length===0)return null;const l=()=>{if(s.length===0)return null;let v=t.get(s[s.length-1]);for(;v.refs.length===v.i;)if(s.pop(),s.length>0)v=t.get(s[s.length-1]);else return null;return v};let a=l();if(a===null)return null;const u=new iC,h=new Map,d=(v,S)=>{const _=h.get(v);(_==null||_>S)&&h.set(v,S)};let g=a.refs[a.i++];const m=new Map,b=()=>{for(const v of i){const S=v.id.client,_=t.get(S);_?(_.i--,u.clients.set(S,_.refs.slice(_.i)),t.delete(S),_.i=0,_.refs=[]):u.clients.set(S,[v]),s=s.filter(k=>k!==S)}i.length=0};for(;;){if(g.constructor!==Xn){const S=ms(m,g.id.client,()=>pt(e,g.id.client))-g.id.clock;if(S<0)i.push(g),d(g.id.client,g.id.clock-1),b();else{const _=g.getMissing(n,e);if(_!==null){i.push(g);const k=t.get(_)||{refs:[],i:0};if(k.refs.length===k.i)d(_,pt(e,_)),b();else{g=k.refs[k.i++];continue}}else(S===0||S<g.length)&&(g.integrate(n,S),m.set(g.id.client,g.id.clock+g.length))}}if(i.length>0)g=i.pop();else if(a!==null&&a.i<a.refs.length)g=a.refs[a.i++];else{if(a=l(),a===null)break;g=a.refs[a.i++]}}if(u.clients.size>0){const v=new Kr;return Fy(v,u,new Map),Ce(v.restEncoder,0),{missing:h,update:v.toUint8Array()}}return null},jB=(n,e)=>Fy(n,e.doc.store,e.beforeState),zB=(n,e,t,i=new _o(n))=>Je(e,s=>{s.local=!1;let l=!1;const a=s.doc,u=a.store,h=BB(i,a),d=UB(s,u,h),g=u.pendingStructs;if(g){for(const[b,v]of g.missing)if(v<pt(u,b)){l=!0;break}if(d){for(const[b,v]of d.missing){const S=g.missing.get(b);(S==null||S>v)&&g.missing.set(b,v)}g.update=xf([g.update,d.update])}}else u.pendingStructs=d;const m=U_(i,s,u);if(u.pendingDs){const b=new _o(Zr(u.pendingDs));ke(b.restDecoder);const v=U_(b,s,u);m&&v?u.pendingDs=xf([m,v]):u.pendingDs=m||v}else u.pendingDs=m;if(l){const b=u.pendingStructs.update;u.pendingStructs=null,FA(s.doc,b)}},t,!1),FA=(n,e,t,i=_o)=>{const s=Zr(e);zB(s,n,t,new i(s))},JA=(n,e,t)=>FA(n,e,t,KA),IB=(n,e,t=new Map)=>{Fy(n,e.store,t),jo(n,RB(e.store))},HB=(n,e=new Uint8Array([0]),t=new Kr)=>{const i=QA(e);IB(t,n,i);const s=[t.toUint8Array()];if(n.store.pendingDs&&s.push(n.store.pendingDs),n.store.pendingStructs&&s.push(s3(n.store.pendingStructs.update,e)),s.length>1){if(t.constructor===Kc)return n3(s.map((l,a)=>a===0?l:l3(l)));if(t.constructor===Kr)return xf(s)}return s[0]},XA=(n,e)=>HB(n,e,new Kc),qB=n=>{const e=new Map,t=ke(n.restDecoder);for(let i=0;i<t;i++){const s=ke(n.restDecoder),l=ke(n.restDecoder);e.set(s,l)}return e},QA=n=>qB(new GA(Zr(n))),ZA=(n,e)=>(Ce(n.restEncoder,e.size),hs(e.entries()).sort((t,i)=>i[0]-t[0]).forEach(([t,i])=>{Ce(n.restEncoder,t),Ce(n.restEncoder,i)}),n),VB=(n,e)=>ZA(n,dd(e.store)),$B=(n,e=new YA)=>(n instanceof Map?ZA(e,n):VB(e,n),e.toUint8Array()),PB=n=>$B(n,new WA);class GB{constructor(){this.l=[]}}const j_=()=>new GB,z_=(n,e)=>n.l.push(e),I_=(n,e)=>{const t=n.l,i=t.length;n.l=t.filter(s=>e!==s),i===n.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},eC=(n,e,t)=>Iy(n.l,[e,t]);class ao{constructor(e,t){this.client=e,this.clock=t}}const to=(n,e)=>n===e||n!==null&&e!==null&&n.client===e.client&&n.clock===e.clock,Se=(n,e)=>new ao(n,e),tC=n=>{for(const[e,t]of n.doc.share.entries())if(t===n)return e;throw zn()},_f=(n,e)=>{for(;e!==null;){if(e.parent===n)return!0;e=e.parent._item}return!1};class nC{constructor(e,t,i,s=0){this.type=e,this.tname=t,this.item=i,this.assoc=s}}const H_=n=>{const e={};return n.type&&(e.type=n.type),n.tname&&(e.tname=n.tname),n.item&&(e.item=n.item),n.assoc!=null&&(e.assoc=n.assoc),e},_c=n=>new nC(n.type==null?null:Se(n.type.client,n.type.clock),n.tname??null,n.item==null?null:Se(n.item.client,n.item.clock),n.assoc==null?0:n.assoc);class KB{constructor(e,t,i=0){this.type=e,this.index=t,this.assoc=i}}const WB=(n,e,t=0)=>new KB(n,e,t),Oh=(n,e,t)=>{let i=null,s=null;return n._item===null?s=tC(n):i=Se(n._item.id.client,n._item.id.clock),new nC(i,s,e,t)},O0=(n,e,t=0)=>{let i=n._start;if(t<0){if(e===0)return Oh(n,null,t);e--}for(;i!==null;){if(!i.deleted&&i.countable){if(i.length>e)return Oh(n,Se(i.id.client,i.id.clock+e),t);e-=i.length}if(i.right===null&&t<0)return Oh(n,i.lastId,t);i=i.right}return Oh(n,null,t)},YB=(n,e)=>{const t=co(n,e),i=e.clock-t.id.clock;return{item:t,diff:i}},D0=(n,e,t=!0)=>{const i=e.store,s=n.item,l=n.type,a=n.tname,u=n.assoc;let h=null,d=0;if(s!==null){if(pt(i,s.client)<=s.clock)return null;const g=t?N0(i,s):YB(i,s),m=g.item;if(!(m instanceof Xe))return null;if(h=m.parent,h._item===null||!h._item.deleted){d=m.deleted||!m.countable?0:g.diff+(u>=0?0:1);let b=m.left;for(;b!==null;)!b.deleted&&b.countable&&(d+=b.length),b=b.left}}else{if(a!==null)h=e.get(a);else if(l!==null){if(pt(i,l.client)<=l.clock)return null;const{item:g}=t?N0(i,l):{item:co(i,l)};if(g instanceof Xe&&g.content instanceof Hi)h=g.content.type;else return null}else throw zn();u>=0?d=h._length:d=0}return WB(h,d,n.assoc)},q_=(n,e)=>n===e||n!==null&&e!==null&&n.tname===e.tname&&to(n.item,e.item)&&to(n.type,e.type)&&n.assoc===e.assoc,Xl=(n,e)=>e===void 0?!n.deleted:e.sv.has(n.id.client)&&(e.sv.get(n.id.client)||0)>n.id.clock&&!Gc(e.ds,n.id),M0=(n,e)=>{const t=ms(n.meta,M0,Gr),i=n.doc.store;t.has(e)||(e.sv.forEach((s,l)=>{s<pt(i,l)&&gn(n,Se(l,s))}),So(n,e.ds,s=>{}),t.add(e))};class iC{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const dd=n=>{const e=new Map;return n.clients.forEach((t,i)=>{const s=t[t.length-1];e.set(i,s.id.clock+s.length)}),e},pt=(n,e)=>{const t=n.clients.get(e);if(t===void 0)return 0;const i=t[t.length-1];return i.id.clock+i.length},sC=(n,e)=>{let t=n.clients.get(e.id.client);if(t===void 0)t=[],n.clients.set(e.id.client,t);else{const i=t[t.length-1];if(i.id.clock+i.length!==e.id.clock)throw zn()}t.push(e)},ji=(n,e)=>{let t=0,i=n.length-1,s=n[i],l=s.id.clock;if(l===e)return i;let a=pi(e/(l+s.length-1)*i);for(;t<=i;){if(s=n[a],l=s.id.clock,l<=e){if(e<l+s.length)return a;t=a+1}else i=a-1;a=pi((t+i)/2)}throw zn()},FB=(n,e)=>{const t=n.clients.get(e.client);return t[ji(t,e.clock)]},co=FB,R0=(n,e,t)=>{const i=ji(e,t),s=e[i];return s.id.clock<t&&s instanceof Xe?(e.splice(i+1,0,Of(n,s,t-s.id.clock)),i+1):i},gn=(n,e)=>{const t=n.doc.store.clients.get(e.client);return t[R0(n,t,e.clock)]},V_=(n,e,t)=>{const i=e.clients.get(t.client),s=ji(i,t.clock),l=i[s];return t.clock!==l.id.clock+l.length-1&&l.constructor!==Jn&&i.splice(s+1,0,Of(n,l,t.clock-l.id.clock+1)),l},JB=(n,e,t)=>{const i=n.clients.get(e.id.client);i[ji(i,e.id.clock)]=t},rC=(n,e,t,i,s)=>{if(i===0)return;const l=t+i;let a=R0(n,e,t),u;do u=e[a++],l<u.id.clock+u.length&&R0(n,e,l),s(u);while(a<e.length&&e[a].id.clock<l)};let XB=class{constructor(e,t,i){this.doc=e,this.deleteSet=new Uo,this.beforeState=dd(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}};const $_=(n,e)=>e.deleteSet.clients.size===0&&!ML(e.afterState,(t,i)=>e.beforeState.get(i)!==t)?!1:(Wy(e.deleteSet),jB(n,e),jo(n,e.deleteSet),!0),P_=(n,e,t)=>{const i=e._item;(i===null||i.id.clock<(n.beforeState.get(i.id.client)||0)&&!i.deleted)&&ms(n.changed,e,Gr).add(t)},rf=(n,e)=>{let t=n[e],i=n[e-1],s=e;for(;s>0;t=i,i=n[--s-1]){if(i.deleted===t.deleted&&i.constructor===t.constructor&&i.mergeWith(t)){t instanceof Xe&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,i);continue}break}const l=e-s;return l&&n.splice(e+1-l,l),l},QB=(n,e,t)=>{for(const[i,s]of n.clients.entries()){const l=e.clients.get(i);for(let a=s.length-1;a>=0;a--){const u=s[a],h=u.clock+u.len;for(let d=ji(l,u.clock),g=l[d];d<l.length&&g.id.clock<h;g=l[++d]){const m=l[d];if(u.clock+u.len<=m.id.clock)break;m instanceof Xe&&m.deleted&&!m.keep&&t(m)&&m.gc(e,!1)}}}},ZB=(n,e)=>{n.clients.forEach((t,i)=>{const s=e.clients.get(i);for(let l=t.length-1;l>=0;l--){const a=t[l],u=Ly(s.length-1,1+ji(s,a.clock+a.len-1));for(let h=u,d=s[h];h>0&&d.id.clock>=a.clock;d=s[h])h-=1+rf(s,h)}})},lC=(n,e)=>{if(e<n.length){const t=n[e],i=t.doc,s=i.store,l=t.deleteSet,a=t._mergeStructs;try{Wy(l),t.afterState=dd(t.doc.store),i.emit("beforeObserverCalls",[t,i]);const u=[];t.changed.forEach((h,d)=>u.push(()=>{(d._item===null||!d._item.deleted)&&d._callObserver(t,h)})),u.push(()=>{t.changedParentTypes.forEach((h,d)=>{d._dEH.l.length>0&&(d._item===null||!d._item.deleted)&&(h=h.filter(g=>g.target._item===null||!g.target._item.deleted),h.forEach(g=>{g.currentTarget=d,g._path=null}),h.sort((g,m)=>g.path.length-m.path.length),u.push(()=>{eC(d._dEH,h,t)}))}),u.push(()=>i.emit("afterTransaction",[t,i])),u.push(()=>{t._needFormattingCleanup&&w3(t)})}),Iy(u,[])}finally{i.gc&&QB(l,s,i.gcFilter),ZB(l,s),t.afterState.forEach((g,m)=>{const b=t.beforeState.get(m)||0;if(b!==g){const v=s.clients.get(m),S=lr(ji(v,b),1);for(let _=v.length-1;_>=S;)_-=1+rf(v,_)}});for(let g=a.length-1;g>=0;g--){const{client:m,clock:b}=a[g].id,v=s.clients.get(m),S=ji(v,b);S+1<v.length&&rf(v,S+1)>1||S>0&&rf(v,S)}if(!t.local&&t.afterState.get(i.clientID)!==t.beforeState.get(i.clientID)&&(EB(Gy,jA,"[yjs] ",zA,IA,"Changed the client-id because another client seems to be using it."),i.clientID=PA()),i.emit("afterTransactionCleanup",[t,i]),i._observers.has("update")){const g=new Kc;$_(g,t)&&i.emit("update",[g.toUint8Array(),t.origin,i,t])}if(i._observers.has("updateV2")){const g=new Kr;$_(g,t)&&i.emit("updateV2",[g.toUint8Array(),t.origin,i,t])}const{subdocsAdded:u,subdocsLoaded:h,subdocsRemoved:d}=t;(u.size>0||d.size>0||h.size>0)&&(u.forEach(g=>{g.clientID=i.clientID,g.collectionid==null&&(g.collectionid=i.collectionid),i.subdocs.add(g)}),d.forEach(g=>i.subdocs.delete(g)),i.emit("subdocs",[{loaded:h,added:u,removed:d},i,t]),d.forEach(g=>g.destroy())),n.length<=e+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,n])):lC(n,e+1)}}},Je=(n,e,t=null,i=!0)=>{const s=n._transactionCleanups;let l=!1,a=null;n._transaction===null&&(l=!0,n._transaction=new XB(n,t,i),s.push(n._transaction),s.length===1&&n.emit("beforeAllTransactions",[n]),n.emit("beforeTransaction",[n._transaction,n]));try{a=e(n._transaction)}finally{if(l){const u=n._transaction===s[0];n._transaction=null,u&&lC(s,0)}}return a};class e3{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}const G_=(n,e,t)=>{So(n,t.deletions,i=>{i instanceof Xe&&e.scope.some(s=>s===n.doc||_f(s,i))&&ib(i,!1)})},K_=(n,e,t)=>{let i=null;const s=n.doc,l=n.scope;Je(s,u=>{for(;e.length>0&&n.currStackItem===null;){const h=s.store,d=e.pop(),g=new Set,m=[];let b=!1;So(u,d.insertions,v=>{if(v instanceof Xe){if(v.redone!==null){let{item:S,diff:_}=N0(h,v.id);_>0&&(S=gn(u,Se(S.id.client,S.id.clock+_))),v=S}!v.deleted&&l.some(S=>S===u.doc||_f(S,v))&&m.push(v)}}),So(u,d.deletions,v=>{v instanceof Xe&&l.some(S=>S===u.doc||_f(S,v))&&!Gc(d.insertions,v.id)&&g.add(v)}),g.forEach(v=>{b=AC(u,v,g,d.insertions,n.ignoreRemoteMapChanges,n)!==null||b});for(let v=m.length-1;v>=0;v--){const S=m[v];n.deleteFilter(S)&&(S.delete(u),b=!0)}n.currStackItem=b?d:null}u.changed.forEach((h,d)=>{h.has(null)&&d._searchMarker&&(d._searchMarker.length=0)}),i=u},n);const a=n.currStackItem;if(a!=null){const u=i.changedParentTypes;n.emit("stack-item-popped",[{stackItem:a,type:t,changedParentTypes:u,origin:n},n]),n.currStackItem=null}return a};class oC extends uA{constructor(e,{captureTimeout:t=500,captureTransaction:i=h=>!0,deleteFilter:s=()=>!0,trackedOrigins:l=new Set([null]),ignoreRemoteMapChanges:a=!1,doc:u=bo(e)?e[0].doc:e instanceof el?e:e.doc}={}){super(),this.scope=[],this.doc=u,this.addToScope(e),this.deleteFilter=s,l.add(this),this.trackedOrigins=l,this.captureTransaction=i,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=a,this.captureTimeout=t,this.afterTransactionHandler=h=>{if(!this.captureTransaction(h)||!this.scope.some(k=>h.changedParentTypes.has(k)||k===this.doc)||!this.trackedOrigins.has(h.origin)&&(!h.origin||!this.trackedOrigins.has(h.origin.constructor)))return;const d=this.undoing,g=this.redoing,m=d?this.redoStack:this.undoStack;d?this.stopCapturing():g||this.clear(!1,!0);const b=new Uo;h.afterState.forEach((k,A)=>{const M=h.beforeState.get(A)||0,O=k-M;O>0&&Sc(b,A,M,O)});const v=yc();let S=!1;if(this.lastChange>0&&v-this.lastChange<this.captureTimeout&&m.length>0&&!d&&!g){const k=m[m.length-1];k.deletions=E0([k.deletions,h.deleteSet]),k.insertions=E0([k.insertions,b])}else m.push(new e3(h.deleteSet,b)),S=!0;!d&&!g&&(this.lastChange=v),So(h,h.deleteSet,k=>{k instanceof Xe&&this.scope.some(A=>A===h.doc||_f(A,k))&&ib(k,!0)});const _=[{stackItem:m[m.length-1],origin:h.origin,type:d?"redo":"undo",changedParentTypes:h.changedParentTypes},this];S?this.emit("stack-item-added",_):this.emit("stack-item-updated",_)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){const t=new Set(this.scope);e=bo(e)?e:[e],e.forEach(i=>{t.has(i)||(t.add(i),(i instanceof Lt?i.doc!==this.doc:i!==this.doc)&&qA("[yjs#509] Not same Y.Doc"),this.scope.push(i))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,t=!0){(e&&this.canUndo()||t&&this.canRedo())&&this.doc.transact(i=>{e&&(this.undoStack.forEach(s=>G_(i,this,s)),this.undoStack=[]),t&&(this.redoStack.forEach(s=>G_(i,this,s)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:t}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=K_(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=K_(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*t3(n){const e=ke(n.restDecoder);for(let t=0;t<e;t++){const i=ke(n.restDecoder),s=n.readClient();let l=ke(n.restDecoder);for(let a=0;a<i;a++){const u=n.readInfo();if(u===10){const h=ke(n.restDecoder);yield new Xn(Se(s,l),h),l+=h}else if((rd&u)!==0){const h=(u&(us|jn))===0,d=new Xe(Se(s,l),null,(u&jn)===jn?n.readLeftID():null,null,(u&us)===us?n.readRightID():null,h?n.readParentInfo()?n.readString():n.readLeftID():null,h&&(u&dc)===dc?n.readString():null,CC(n,u));yield d,l+=d.length}else{const h=n.readLen();yield new Jn(Se(s,l),h),l+=h}}}}class Jy{constructor(e,t){this.gen=t3(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Xn);return this.curr}}class Xy{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const n3=n=>xf(n,KA,Kc),i3=(n,e)=>{if(n.constructor===Jn){const{client:t,clock:i}=n.id;return new Jn(Se(t,i+e),n.length-e)}else if(n.constructor===Xn){const{client:t,clock:i}=n.id;return new Xn(Se(t,i+e),n.length-e)}else{const t=n,{client:i,clock:s}=t.id;return new Xe(Se(i,s+e),null,Se(i,s+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},xf=(n,e=_o,t=Kr)=>{if(n.length===1)return n[0];const i=n.map(g=>new e(Zr(g)));let s=i.map(g=>new Jy(g,!0)),l=null;const a=new t,u=new Xy(a);for(;s=s.filter(b=>b.curr!==null),s.sort((b,v)=>{if(b.curr.id.client===v.curr.id.client){const S=b.curr.id.clock-v.curr.id.clock;return S===0?b.curr.constructor===v.curr.constructor?0:b.curr.constructor===Xn?1:-1:S}else return v.curr.id.client-b.curr.id.client}),s.length!==0;){const g=s[0],m=g.curr.id.client;if(l!==null){let b=g.curr,v=!1;for(;b!==null&&b.id.clock+b.length<=l.struct.id.clock+l.struct.length&&b.id.client>=l.struct.id.client;)b=g.next(),v=!0;if(b===null||b.id.client!==m||v&&b.id.clock>l.struct.id.clock+l.struct.length)continue;if(m!==l.struct.id.client)Ws(u,l.struct,l.offset),l={struct:b,offset:0},g.next();else if(l.struct.id.clock+l.struct.length<b.id.clock)if(l.struct.constructor===Xn)l.struct.length=b.id.clock+b.length-l.struct.id.clock;else{Ws(u,l.struct,l.offset);const S=b.id.clock-l.struct.id.clock-l.struct.length;l={struct:new Xn(Se(m,l.struct.id.clock+l.struct.length),S),offset:0}}else{const S=l.struct.id.clock+l.struct.length-b.id.clock;S>0&&(l.struct.constructor===Xn?l.struct.length-=S:b=i3(b,S)),l.struct.mergeWith(b)||(Ws(u,l.struct,l.offset),l={struct:b,offset:0},g.next())}}else l={struct:g.curr,offset:0},g.next();for(let b=g.curr;b!==null&&b.id.client===m&&b.id.clock===l.struct.id.clock+l.struct.length&&b.constructor!==Xn;b=g.next())Ws(u,l.struct,l.offset),l={struct:b,offset:0}}l!==null&&(Ws(u,l.struct,l.offset),l=null),Qy(u);const h=i.map(g=>Yy(g)),d=E0(h);return jo(a,d),a.toUint8Array()},s3=(n,e,t=_o,i=Kr)=>{const s=QA(e),l=new i,a=new Xy(l),u=new t(Zr(n)),h=new Jy(u,!1);for(;h.curr;){const g=h.curr,m=g.id.client,b=s.get(m)||0;if(h.curr.constructor===Xn){h.next();continue}if(g.id.clock+g.length>b)for(Ws(a,g,lr(b-g.id.clock,0)),h.next();h.curr&&h.curr.id.client===m;)Ws(a,h.curr,0),h.next();else for(;h.curr&&h.curr.id.client===m&&h.curr.id.clock+h.curr.length<=b;)h.next()}Qy(a);const d=Yy(u);return jo(l,d),l.toUint8Array()},aC=n=>{n.written>0&&(n.clientStructs.push({written:n.written,restEncoder:fi(n.encoder.restEncoder)}),n.encoder.restEncoder=$c(),n.written=0)},Ws=(n,e,t)=>{n.written>0&&n.currClient!==e.id.client&&aC(n),n.written===0&&(n.currClient=e.id.client,n.encoder.writeClient(e.id.client),Ce(n.encoder.restEncoder,e.id.clock+t)),e.write(n.encoder,t),n.written++},Qy=n=>{aC(n);const e=n.encoder.restEncoder;Ce(e,n.clientStructs.length);for(let t=0;t<n.clientStructs.length;t++){const i=n.clientStructs[t];Ce(e,i.written),ld(e,i.restEncoder)}},r3=(n,e,t,i)=>{const s=new t(Zr(n)),l=new Jy(s,!1),a=new i,u=new Xy(a);for(let d=l.curr;d!==null;d=l.next())Ws(u,e(d),0);Qy(u);const h=Yy(s);return jo(a,h),a.toUint8Array()},l3=n=>r3(n,kN,_o,Kc),W_="You must not compute changes after the event-handler fired.";class gd{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=o3(this.currentTarget,this.target))}deletes(e){return Gc(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ui(W_);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(s=>{if(s!==null){const l=t._map.get(s);let a,u;if(this.adds(l)){let h=l.left;for(;h!==null&&this.adds(h);)h=h.left;if(this.deletes(l))if(h!==null&&this.deletes(h))a="delete",u=hm(h.content.getContent());else return;else h!==null&&this.deletes(h)?(a="update",u=hm(h.content.getContent())):(a="add",u=void 0)}else if(this.deletes(l))a="delete",u=hm(l.content.getContent());else return;e.set(s,{action:a,oldValue:u})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ui(W_);const t=this.target,i=Gr(),s=Gr(),l=[];if(e={added:i,deleted:s,delta:l,keys:this.keys},this.transaction.changed.get(t).has(null)){let u=null;const h=()=>{u&&l.push(u)};for(let d=t._start;d!==null;d=d.right)d.deleted?this.deletes(d)&&!this.adds(d)&&((u===null||u.delete===void 0)&&(h(),u={delete:0}),u.delete+=d.length,s.add(d)):this.adds(d)?((u===null||u.insert===void 0)&&(h(),u={insert:[]}),u.insert=u.insert.concat(d.content.getContent()),i.add(d)):((u===null||u.retain===void 0)&&(h(),u={retain:0}),u.retain+=d.length);u!==null&&u.retain===void 0&&h()}this._changes=e}return e}}const o3=(n,e)=>{const t=[];for(;e._item!==null&&e!==n;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let i=0,s=e._item.parent._start;for(;s!==e._item&&s!==null;)!s.deleted&&s.countable&&(i+=s.length),s=s.right;t.unshift(i)}e=e._item.parent}return t},Ft=()=>{qA("Invalid access: Add Yjs type to a document before reading data.")},cC=80;let Zy=0;class a3{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=Zy++}}const c3=n=>{n.timestamp=Zy++},uC=(n,e,t)=>{n.p.marker=!1,n.p=e,e.marker=!0,n.index=t,n.timestamp=Zy++},u3=(n,e,t)=>{if(n.length>=cC){const i=n.reduce((s,l)=>s.timestamp<l.timestamp?s:l);return uC(i,e,t),i}else{const i=new a3(e,t);return n.push(i),i}},pd=(n,e)=>{if(n._start===null||e===0||n._searchMarker===null)return null;const t=n._searchMarker.length===0?null:n._searchMarker.reduce((l,a)=>tf(e-l.index)<tf(e-a.index)?l:a);let i=n._start,s=0;for(t!==null&&(i=t.p,s=t.index,c3(t));i.right!==null&&s<e;){if(!i.deleted&&i.countable){if(e<s+i.length)break;s+=i.length}i=i.right}for(;i.left!==null&&s>e;)i=i.left,!i.deleted&&i.countable&&(s-=i.length);for(;i.left!==null&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)i=i.left,!i.deleted&&i.countable&&(s-=i.length);return t!==null&&tf(t.index-s)<i.parent.length/cC?(uC(t,i,s),t):u3(n._searchMarker,i,s)},xc=(n,e,t)=>{for(let i=n.length-1;i>=0;i--){const s=n[i];if(t>0){let l=s.p;for(l.marker=!1;l&&(l.deleted||!l.countable);)l=l.left,l&&!l.deleted&&l.countable&&(s.index-=l.length);if(l===null||l.marker===!0){n.splice(i,1);continue}s.p=l,l.marker=!0}(e<s.index||t>0&&e===s.index)&&(s.index=lr(e,s.index+t))}},md=(n,e,t)=>{const i=n,s=e.changedParentTypes;for(;ms(s,n,()=>[]).push(t),n._item!==null;)n=n._item.parent;eC(i._eH,t,e)};class Lt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=j_(),this._dEH=j_(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw gi()}clone(){throw gi()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){z_(this._eH,e)}observeDeep(e){z_(this._dEH,e)}unobserve(e){I_(this._eH,e)}unobserveDeep(e){I_(this._dEH,e)}toJSON(){}}const hC=(n,e,t)=>{n.doc??Ft(),e<0&&(e=n._length+e),t<0&&(t=n._length+t);let i=t-e;const s=[];let l=n._start;for(;l!==null&&i>0;){if(l.countable&&!l.deleted){const a=l.content.getContent();if(a.length<=e)e-=a.length;else{for(let u=e;u<a.length&&i>0;u++)s.push(a[u]),i--;e=0}}l=l.right}return s},fC=n=>{n.doc??Ft();const e=[];let t=n._start;for(;t!==null;){if(t.countable&&!t.deleted){const i=t.content.getContent();for(let s=0;s<i.length;s++)e.push(i[s])}t=t.right}return e},kc=(n,e)=>{let t=0,i=n._start;for(n.doc??Ft();i!==null;){if(i.countable&&!i.deleted){const s=i.content.getContent();for(let l=0;l<s.length;l++)e(s[l],t++,n)}i=i.right}},dC=(n,e)=>{const t=[];return kc(n,(i,s)=>{t.push(e(i,s,n))}),t},h3=n=>{let e=n._start,t=null,i=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),i=0,e=e.right}const s=t[i++];return t.length<=i&&(t=null),{done:!1,value:s}}}},gC=(n,e)=>{n.doc??Ft();const t=pd(n,e);let i=n._start;for(t!==null&&(i=t.p,e-=t.index);i!==null;i=i.right)if(!i.deleted&&i.countable){if(e<i.length)return i.content.getContent()[e];e-=i.length}},kf=(n,e,t,i)=>{let s=t;const l=n.doc,a=l.clientID,u=l.store,h=t===null?e._start:t.right;let d=[];const g=()=>{d.length>0&&(s=new Xe(Se(a,pt(u,a)),s,s&&s.lastId,h,h&&h.id,e,null,new Yr(d)),s.integrate(n,0),d=[])};i.forEach(m=>{if(m===null)d.push(m);else switch(m.constructor){case Number:case Object:case Boolean:case Array:case String:d.push(m);break;default:switch(g(),m.constructor){case Uint8Array:case ArrayBuffer:s=new Xe(Se(a,pt(u,a)),s,s&&s.lastId,h,h&&h.id,e,null,new Wc(new Uint8Array(m))),s.integrate(n,0);break;case el:s=new Xe(Se(a,pt(u,a)),s,s&&s.lastId,h,h&&h.id,e,null,new Yc(m)),s.integrate(n,0);break;default:if(m instanceof Lt)s=new Xe(Se(a,pt(u,a)),s,s&&s.lastId,h,h&&h.id,e,null,new Hi(m)),s.integrate(n,0);else throw new Error("Unexpected content type in insert operation")}}}),g()},pC=()=>Ui("Length exceeded!"),mC=(n,e,t,i)=>{if(t>e._length)throw pC();if(t===0)return e._searchMarker&&xc(e._searchMarker,t,i.length),kf(n,e,null,i);const s=t,l=pd(e,t);let a=e._start;for(l!==null&&(a=l.p,t-=l.index,t===0&&(a=a.prev,t+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(t<=a.length){t<a.length&&gn(n,Se(a.id.client,a.id.clock+t));break}t-=a.length}return e._searchMarker&&xc(e._searchMarker,s,i.length),kf(n,e,a,i)},f3=(n,e,t)=>{let s=(e._searchMarker||[]).reduce((l,a)=>a.index>l.index?a:l,{index:0,p:e._start}).p;if(s)for(;s.right;)s=s.right;return kf(n,e,s,t)},yC=(n,e,t,i)=>{if(i===0)return;const s=t,l=i,a=pd(e,t);let u=e._start;for(a!==null&&(u=a.p,t-=a.index);u!==null&&t>0;u=u.right)!u.deleted&&u.countable&&(t<u.length&&gn(n,Se(u.id.client,u.id.clock+t)),t-=u.length);for(;i>0&&u!==null;)u.deleted||(i<u.length&&gn(n,Se(u.id.client,u.id.clock+i)),u.delete(n),i-=u.length),u=u.right;if(i>0)throw pC();e._searchMarker&&xc(e._searchMarker,s,-l+i)},Af=(n,e,t)=>{const i=e._map.get(t);i!==void 0&&i.delete(n)},eb=(n,e,t,i)=>{const s=e._map.get(t)||null,l=n.doc,a=l.clientID;let u;if(i==null)u=new Yr([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:u=new Yr([i]);break;case Uint8Array:u=new Wc(i);break;case el:u=new Yc(i);break;default:if(i instanceof Lt)u=new Hi(i);else throw new Error("Unexpected content type")}new Xe(Se(a,pt(l.store,a)),s,s&&s.lastId,null,null,e,t,u).integrate(n,0)},tb=(n,e)=>{n.doc??Ft();const t=n._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},bC=n=>{const e={};return n.doc??Ft(),n._map.forEach((t,i)=>{t.deleted||(e[i]=t.content.getContent()[t.length-1])}),e},vC=(n,e)=>{n.doc??Ft();const t=n._map.get(e);return t!==void 0&&!t.deleted},d3=(n,e)=>{const t={};return n._map.forEach((i,s)=>{let l=i;for(;l!==null&&(!e.sv.has(l.id.client)||l.id.clock>=(e.sv.get(l.id.client)||0));)l=l.left;l!==null&&Xl(l,e)&&(t[s]=l.content.getContent()[l.length-1])}),t},Dh=n=>(n.doc??Ft(),OB(n._map.entries(),e=>!e[1].deleted));class g3 extends gd{}class uo extends Lt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new uo;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new uo}clone(){const e=new uo;return e.insert(0,this.toArray().map(t=>t instanceof Lt?t.clone():t)),e}get length(){return this.doc??Ft(),this._length}_callObserver(e,t){super._callObserver(e,t),md(this,e,new g3(this,e))}insert(e,t){this.doc!==null?Je(this.doc,i=>{mC(i,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?Je(this.doc,t=>{f3(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?Je(this.doc,i=>{yC(i,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return gC(this,e)}toArray(){return fC(this)}slice(e=0,t=this.length){return hC(this,e,t)}toJSON(){return this.map(e=>e instanceof Lt?e.toJSON():e)}map(e){return dC(this,e)}forEach(e){kc(this,e)}[Symbol.iterator](){return h3(this)}_write(e){e.writeTypeRef(I3)}}const p3=n=>new uo;class m3 extends gd{constructor(e,t,i){super(e,t),this.keysChanged=i}}class xo extends Lt{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((i,s)=>{this.set(s,i)}),this._prelimContent=null}_copy(){return new xo}clone(){const e=new xo;return this.forEach((t,i)=>{e.set(i,t instanceof Lt?t.clone():t)}),e}_callObserver(e,t){md(this,e,new m3(this,e,t))}toJSON(){this.doc??Ft();const e={};return this._map.forEach((t,i)=>{if(!t.deleted){const s=t.content.getContent()[t.length-1];e[i]=s instanceof Lt?s.toJSON():s}}),e}get size(){return[...Dh(this)].length}keys(){return vm(Dh(this),e=>e[0])}values(){return vm(Dh(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return vm(Dh(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??Ft(),this._map.forEach((t,i)=>{t.deleted||e(t.content.getContent()[t.length-1],i,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Je(this.doc,t=>{Af(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?Je(this.doc,i=>{eb(i,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return tb(this,e)}has(e){return vC(this,e)}clear(){this.doc!==null?Je(this.doc,e=>{this.forEach(function(t,i,s){Af(e,s,i)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(H3)}}const y3=n=>new xo,Fs=(n,e)=>n===e||typeof n=="object"&&typeof e=="object"&&n&&e&&_N(n,e);class L0{constructor(e,t,i,s){this.left=e,this.right=t,this.index=i,this.currentAttributes=s}forward(){this.right===null&&zn(),this.right.content.constructor===Et?this.right.deleted||zo(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}const Y_=(n,e,t)=>{for(;e.right!==null&&t>0;)e.right.content.constructor===Et?e.right.deleted||zo(e.currentAttributes,e.right.content):e.right.deleted||(t<e.right.length&&gn(n,Se(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length),e.left=e.right,e.right=e.right.right;return e},Mh=(n,e,t,i)=>{const s=new Map,l=i?pd(e,t):null;if(l){const a=new L0(l.p.left,l.p,l.index,s);return Y_(n,a,t-l.index)}else{const a=new L0(null,e._start,0,s);return Y_(n,a,t)}},wC=(n,e,t,i)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===Et&&Fs(i.get(t.right.content.key),t.right.content.value));)t.right.deleted||i.delete(t.right.content.key),t.forward();const s=n.doc,l=s.clientID;i.forEach((a,u)=>{const h=t.left,d=t.right,g=new Xe(Se(l,pt(s.store,l)),h,h&&h.lastId,d,d&&d.id,e,null,new Et(u,a));g.integrate(n,0),t.right=g,t.forward()})},zo=(n,e)=>{const{key:t,value:i}=e;i===null?n.delete(t):n.set(t,i)},SC=(n,e)=>{for(;n.right!==null;){if(!(n.right.deleted||n.right.content.constructor===Et&&Fs(e[n.right.content.key]??null,n.right.content.value)))break;n.forward()}},_C=(n,e,t,i)=>{const s=n.doc,l=s.clientID,a=new Map;for(const u in i){const h=i[u],d=t.currentAttributes.get(u)??null;if(!Fs(d,h)){a.set(u,d);const{left:g,right:m}=t;t.right=new Xe(Se(l,pt(s.store,l)),g,g&&g.lastId,m,m&&m.id,e,null,new Et(u,h)),t.right.integrate(n,0),t.forward()}}return a},wm=(n,e,t,i,s)=>{t.currentAttributes.forEach((b,v)=>{s[v]===void 0&&(s[v]=null)});const l=n.doc,a=l.clientID;SC(t,s);const u=_C(n,e,t,s),h=i.constructor===String?new zi(i):i instanceof Lt?new Hi(i):new tl(i);let{left:d,right:g,index:m}=t;e._searchMarker&&xc(e._searchMarker,t.index,h.getLength()),g=new Xe(Se(a,pt(l.store,a)),d,d&&d.lastId,g,g&&g.id,e,null,h),g.integrate(n,0),t.right=g,t.index=m,t.forward(),wC(n,e,t,u)},F_=(n,e,t,i,s)=>{const l=n.doc,a=l.clientID;SC(t,s);const u=_C(n,e,t,s);e:for(;t.right!==null&&(i>0||u.size>0&&(t.right.deleted||t.right.content.constructor===Et));){if(!t.right.deleted)switch(t.right.content.constructor){case Et:{const{key:h,value:d}=t.right.content,g=s[h];if(g!==void 0){if(Fs(g,d))u.delete(h);else{if(i===0)break e;u.set(h,d)}t.right.delete(n)}else t.currentAttributes.set(h,d);break}default:i<t.right.length&&gn(n,Se(t.right.id.client,t.right.id.clock+i)),i-=t.right.length;break}t.forward()}if(i>0){let h="";for(;i>0;i--)h+=`
`;t.right=new Xe(Se(a,pt(l.store,a)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new zi(h)),t.right.integrate(n,0),t.forward()}wC(n,e,t,u)},xC=(n,e,t,i,s)=>{let l=e;const a=bn();for(;l&&(!l.countable||l.deleted);){if(!l.deleted&&l.content.constructor===Et){const d=l.content;a.set(d.key,d)}l=l.right}let u=0,h=!1;for(;e!==l;){if(t===e&&(h=!0),!e.deleted){const d=e.content;if(d.constructor===Et){const{key:g,value:m}=d,b=i.get(g)??null;(a.get(g)!==d||b===m)&&(e.delete(n),u++,!h&&(s.get(g)??null)===m&&b!==m&&(b===null?s.delete(g):s.set(g,b))),!h&&!e.deleted&&zo(s,d)}}e=e.right}return u},b3=(n,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Et){const i=e.content.key;t.has(i)?e.delete(n):t.add(i)}e=e.left}},v3=n=>{let e=0;return Je(n.doc,t=>{let i=n._start,s=n._start,l=bn();const a=_0(l);for(;s;)s.deleted===!1&&(s.content.constructor===Et?zo(a,s.content):(e+=xC(t,i,s,l,a),l=_0(a),i=s)),s=s.right}),e},w3=n=>{const e=new Set,t=n.doc;for(const[i,s]of n.afterState.entries()){const l=n.beforeState.get(i)||0;s!==l&&rC(n,t.store.clients.get(i),l,s,a=>{!a.deleted&&a.content.constructor===Et&&a.constructor!==Jn&&e.add(a.parent)})}Je(t,i=>{So(n,n.deleteSet,s=>{if(s instanceof Jn||!s.parent._hasFormatting||e.has(s.parent))return;const l=s.parent;s.content.constructor===Et?e.add(l):b3(i,s)});for(const s of e)v3(s)})},J_=(n,e,t)=>{const i=t,s=_0(e.currentAttributes),l=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case Hi:case tl:case zi:t<e.right.length&&gn(n,Se(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(n);break}e.forward()}l&&xC(n,l,e.right,s,e.currentAttributes);const a=(e.left||e.right).parent;return a._searchMarker&&xc(a._searchMarker,e.index,-i+t),e};class S3 extends gd{constructor(e,t,i){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,i.forEach(s=>{s===null?this.childListChanged=!0:this.keysChanged.add(s)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,t=[];Je(e,i=>{const s=new Map,l=new Map;let a=this.target._start,u=null;const h={};let d="",g=0,m=0;const b=()=>{if(u!==null){let v=null;switch(u){case"delete":m>0&&(v={delete:m}),m=0;break;case"insert":(typeof d=="object"||d.length>0)&&(v={insert:d},s.size>0&&(v.attributes={},s.forEach((S,_)=>{S!==null&&(v.attributes[_]=S)}))),d="";break;case"retain":g>0&&(v={retain:g},SN(h)||(v.attributes=bN({},h))),g=0;break}v&&t.push(v),u=null}};for(;a!==null;){switch(a.content.constructor){case Hi:case tl:this.adds(a)?this.deletes(a)||(b(),u="insert",d=a.content.getContent()[0],b()):this.deletes(a)?(u!=="delete"&&(b(),u="delete"),m+=1):a.deleted||(u!=="retain"&&(b(),u="retain"),g+=1);break;case zi:this.adds(a)?this.deletes(a)||(u!=="insert"&&(b(),u="insert"),d+=a.content.str):this.deletes(a)?(u!=="delete"&&(b(),u="delete"),m+=a.length):a.deleted||(u!=="retain"&&(b(),u="retain"),g+=a.length);break;case Et:{const{key:v,value:S}=a.content;if(this.adds(a)){if(!this.deletes(a)){const _=s.get(v)??null;Fs(_,S)?S!==null&&a.delete(i):(u==="retain"&&b(),Fs(S,l.get(v)??null)?delete h[v]:h[v]=S)}}else if(this.deletes(a)){l.set(v,S);const _=s.get(v)??null;Fs(_,S)||(u==="retain"&&b(),h[v]=_)}else if(!a.deleted){l.set(v,S);const _=h[v];_!==void 0&&(Fs(_,S)?_!==null&&a.delete(i):(u==="retain"&&b(),S===null?delete h[v]:h[v]=S))}a.deleted||(u==="insert"&&b(),zo(s,a.content));break}}a=a.right}for(b();t.length>0;){const v=t[t.length-1];if(v.retain!==void 0&&v.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}}class ko extends Lt{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Ft(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(i=>i())}catch(i){console.error(i)}this._pending=null}_copy(){return new ko}clone(){const e=new ko;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const i=new S3(this,e,t);md(this,e,i),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??Ft();let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===zi&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?Je(this.doc,i=>{const s=new L0(null,this._start,0,new Map);for(let l=0;l<e.length;l++){const a=e[l];if(a.insert!==void 0){const u=!t&&typeof a.insert=="string"&&l===e.length-1&&s.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof u!="string"||u.length>0)&&wm(i,this,s,u,a.attributes||{})}else a.retain!==void 0?F_(i,this,s,a.retain,a.attributes||{}):a.delete!==void 0&&J_(i,s,a.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,i){this.doc??Ft();const s=[],l=new Map,a=this.doc;let u="",h=this._start;function d(){if(u.length>0){const m={};let b=!1;l.forEach((S,_)=>{b=!0,m[_]=S});const v={insert:u};b&&(v.attributes=m),s.push(v),u=""}}const g=()=>{for(;h!==null;){if(Xl(h,e)||t!==void 0&&Xl(h,t))switch(h.content.constructor){case zi:{const m=l.get("ychange");e!==void 0&&!Xl(h,e)?(m===void 0||m.user!==h.id.client||m.type!=="removed")&&(d(),l.set("ychange",i?i("removed",h.id):{type:"removed"})):t!==void 0&&!Xl(h,t)?(m===void 0||m.user!==h.id.client||m.type!=="added")&&(d(),l.set("ychange",i?i("added",h.id):{type:"added"})):m!==void 0&&(d(),l.delete("ychange")),u+=h.content.str;break}case Hi:case tl:{d();const m={insert:h.content.getContent()[0]};if(l.size>0){const b={};m.attributes=b,l.forEach((v,S)=>{b[S]=v})}s.push(m);break}case Et:Xl(h,e)&&(d(),zo(l,h.content));break}h=h.right}d()};return e||t?Je(a,m=>{e&&M0(m,e),t&&M0(m,t),g()},"cleanup"):g(),s}insert(e,t,i){if(t.length<=0)return;const s=this.doc;s!==null?Je(s,l=>{const a=Mh(l,this,e,!i);i||(i={},a.currentAttributes.forEach((u,h)=>{i[h]=u})),wm(l,this,a,t,i)}):this._pending.push(()=>this.insert(e,t,i))}insertEmbed(e,t,i){const s=this.doc;s!==null?Je(s,l=>{const a=Mh(l,this,e,!i);wm(l,this,a,t,i||{})}):this._pending.push(()=>this.insertEmbed(e,t,i||{}))}delete(e,t){if(t===0)return;const i=this.doc;i!==null?Je(i,s=>{J_(s,Mh(s,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,i){if(t===0)return;const s=this.doc;s!==null?Je(s,l=>{const a=Mh(l,this,e,!1);a.right!==null&&F_(l,this,a,t,i)}):this._pending.push(()=>this.format(e,t,i))}removeAttribute(e){this.doc!==null?Je(this.doc,t=>{Af(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?Je(this.doc,i=>{eb(i,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return tb(this,e)}getAttributes(){return bC(this)}_write(e){e.writeTypeRef(q3)}}const _3=n=>new ko;class Sm{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??Ft()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===Ao||t.constructor===Wr)&&t._start!==null)e=t._start;else for(;e!==null;){const i=e.next;if(i!==null){e=i;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Wr extends Lt{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Wr}clone(){const e=new Wr;return e.insert(0,this.toArray().map(t=>t instanceof Lt?t.clone():t)),e}get length(){return this.doc??Ft(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new Sm(this,e)}querySelector(e){e=e.toUpperCase();const i=new Sm(this,s=>s.nodeName&&s.nodeName.toUpperCase()===e).next();return i.done?null:i.value}querySelectorAll(e){return e=e.toUpperCase(),hs(new Sm(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){md(this,e,new A3(this,t,e))}toString(){return dC(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},i){const s=e.createDocumentFragment();return i!==void 0&&i._createAssociation(s,this),kc(this,l=>{s.insertBefore(l.toDOM(e,t,i),null)}),s}insert(e,t){this.doc!==null?Je(this.doc,i=>{mC(i,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)Je(this.doc,i=>{const s=e&&e instanceof Lt?e._item:e;kf(i,this,s,t)});else{const i=this._prelimContent,s=e===null?0:i.findIndex(l=>l===e)+1;if(s===0&&e!==null)throw Ui("Reference item not found");i.splice(s,0,...t)}}delete(e,t=1){this.doc!==null?Je(this.doc,i=>{yC(i,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return fC(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return gC(this,e)}slice(e=0,t=this.length){return hC(this,e,t)}forEach(e){kc(this,e)}_write(e){e.writeTypeRef($3)}}const x3=n=>new Wr;class Ao extends Wr{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((i,s)=>{this.setAttribute(s,i)}),this._prelimAttrs=null}_copy(){return new Ao(this.nodeName)}clone(){const e=new Ao(this.nodeName),t=this.getAttributes();return wN(t,(i,s)=>{e.setAttribute(s,i)}),e.insert(0,this.toArray().map(i=>i instanceof Lt?i.clone():i)),e}toString(){const e=this.getAttributes(),t=[],i=[];for(const u in e)i.push(u);i.sort();const s=i.length;for(let u=0;u<s;u++){const h=i[u];t.push(h+'="'+e[h]+'"')}const l=this.nodeName.toLocaleLowerCase(),a=t.length>0?" "+t.join(" "):"";return`<${l}${a}>${super.toString()}</${l}>`}removeAttribute(e){this.doc!==null?Je(this.doc,t=>{Af(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?Je(this.doc,i=>{eb(i,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return tb(this,e)}hasAttribute(e){return vC(this,e)}getAttributes(e){return e?d3(this,e):bC(this)}toDOM(e=document,t={},i){const s=e.createElement(this.nodeName),l=this.getAttributes();for(const a in l){const u=l[a];typeof u=="string"&&s.setAttribute(a,u)}return kc(this,a=>{s.appendChild(a.toDOM(e,t,i))}),i!==void 0&&i._createAssociation(s,this),s}_write(e){e.writeTypeRef(V3),e.writeKey(this.nodeName)}}const k3=n=>new Ao(n.readKey());class A3 extends gd{constructor(e,t,i){super(e,i),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(s=>{s===null?this.childListChanged=!0:this.attributesChanged.add(s)})}}class Cf extends xo{constructor(e){super(),this.hookName=e}_copy(){return new Cf(this.hookName)}clone(){const e=new Cf(this.hookName);return this.forEach((t,i)=>{e.set(i,t)}),e}toDOM(e=document,t={},i){const s=t[this.hookName];let l;return s!==void 0?l=s.createDom(this):l=document.createElement(this.hookName),l.setAttribute("data-yjs-hook",this.hookName),i!==void 0&&i._createAssociation(l,this),l}_write(e){e.writeTypeRef(P3),e.writeKey(this.hookName)}}const C3=n=>new Cf(n.readKey());class Tf extends ko{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new Tf}clone(){const e=new Tf;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,i){const s=e.createTextNode(this.toString());return i!==void 0&&i._createAssociation(s,this),s}toString(){return this.toDelta().map(e=>{const t=[];for(const s in e.attributes){const l=[];for(const a in e.attributes[s])l.push({key:a,value:e.attributes[s][a]});l.sort((a,u)=>a.key<u.key?-1:1),t.push({nodeName:s,attrs:l})}t.sort((s,l)=>s.nodeName<l.nodeName?-1:1);let i="";for(let s=0;s<t.length;s++){const l=t[s];i+=`<${l.nodeName}`;for(let a=0;a<l.attrs.length;a++){const u=l.attrs[a];i+=` ${u.key}="${u.value}"`}i+=">"}i+=e.insert;for(let s=t.length-1;s>=0;s--)i+=`</${t[s].nodeName}>`;return i}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(G3)}}const T3=n=>new Tf;class nb{constructor(e,t){this.id=e,this.length=t}get deleted(){throw gi()}mergeWith(e){return!1}write(e,t,i){throw gi()}integrate(e,t){throw gi()}}const E3=0;class Jn extends nb{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),sC(e.doc.store,this)}write(e,t){e.writeInfo(E3),e.writeLen(this.length-t)}getMissing(e,t){return null}}class Wc{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Wc(this.content)}splice(e){throw gi()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}const O3=n=>new Wc(n.readBuf());class Ac{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Ac(this.len)}splice(e){const t=new Ac(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){Sc(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const D3=n=>new Ac(n.readLen()),kC=(n,e)=>new el({guid:n,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class Yc{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Yc(kC(this.doc.guid,this.opts))}splice(e){throw gi()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const M3=n=>new Yc(kC(n.readString(),n.readAny()));class tl{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new tl(this.embed)}splice(e){throw gi()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}const R3=n=>new tl(n.readJSON());class Et{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Et(this.key,this.value)}splice(e){throw gi()}mergeWith(e){return!1}integrate(e,t){const i=t.parent;i._searchMarker=null,i._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const L3=n=>new Et(n.readKey(),n.readJSON());class Ef{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ef(this.arr)}splice(e){const t=new Ef(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const i=this.arr.length;e.writeLen(i-t);for(let s=t;s<i;s++){const l=this.arr[s];e.writeString(l===void 0?"undefined":JSON.stringify(l))}}getRef(){return 2}}const N3=n=>{const e=n.readLen(),t=[];for(let i=0;i<e;i++){const s=n.readString();s==="undefined"?t.push(void 0):t.push(JSON.parse(s))}return new Ef(t)},B3=vf("node_env")==="development";class Yr{constructor(e){this.arr=e,B3&&yA(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Yr(this.arr)}splice(e){const t=new Yr(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const i=this.arr.length;e.writeLen(i-t);for(let s=t;s<i;s++){const l=this.arr[s];e.writeAny(l)}}getRef(){return 8}}const U3=n=>{const e=n.readLen(),t=[];for(let i=0;i<e;i++)t.push(n.readAny());return new Yr(t)};class zi{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new zi(this.str)}splice(e){const t=new zi(this.str.slice(e));this.str=this.str.slice(0,e);const i=this.str.charCodeAt(e-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}}const j3=n=>new zi(n.readString()),z3=[p3,y3,_3,k3,x3,C3,T3],I3=0,H3=1,q3=2,V3=3,$3=4,P3=5,G3=6;class Hi{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Hi(this.type._copy())}splice(e){throw gi()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(i=>{i.deleted?i.id.clock<(e.beforeState.get(i.id.client)||0)&&e._mergeStructs.push(i):i.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(i=>{for(;i!==null;)i.gc(e,!0),i=i.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const K3=n=>new Hi(z3[n.readTypeRef()](n)),N0=(n,e)=>{let t=e,i=0,s;do i>0&&(t=Se(t.client,t.clock+i)),s=co(n,t),i=t.clock-s.id.clock,t=s.redone;while(t!==null&&s instanceof Xe);return{item:s,diff:i}},ib=(n,e)=>{for(;n!==null&&n.keep!==e;)n.keep=e,n=n.parent._item},Of=(n,e,t)=>{const{client:i,clock:s}=e.id,l=new Xe(Se(i,s+t),e,Se(i,s+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&l.markDeleted(),e.keep&&(l.keep=!0),e.redone!==null&&(l.redone=Se(e.redone.client,e.redone.clock+t)),e.right=l,l.right!==null&&(l.right.left=l),n._mergeStructs.push(l),l.parentSub!==null&&l.right===null&&l.parent._map.set(l.parentSub,l),e.length=t,l},X_=(n,e)=>Ry(n,t=>Gc(t.deletions,e)),AC=(n,e,t,i,s,l)=>{const a=n.doc,u=a.store,h=a.clientID,d=e.redone;if(d!==null)return gn(n,d);let g=e.parent._item,m=null,b;if(g!==null&&g.deleted===!0){if(g.redone===null&&(!t.has(g)||AC(n,g,t,i,s,l)===null))return null;for(;g.redone!==null;)g=gn(n,g.redone)}const v=g===null?e.parent:g.content.type;if(e.parentSub===null){for(m=e.left,b=e;m!==null;){let A=m;for(;A!==null&&A.parent._item!==g;)A=A.redone===null?null:gn(n,A.redone);if(A!==null&&A.parent._item===g){m=A;break}m=m.left}for(;b!==null;){let A=b;for(;A!==null&&A.parent._item!==g;)A=A.redone===null?null:gn(n,A.redone);if(A!==null&&A.parent._item===g){b=A;break}b=b.right}}else if(b=null,e.right&&!s){for(m=e;m!==null&&m.right!==null&&(m.right.redone||Gc(i,m.right.id)||X_(l.undoStack,m.right.id)||X_(l.redoStack,m.right.id));)for(m=m.right;m.redone;)m=gn(n,m.redone);if(m&&m.right!==null)return null}else m=v._map.get(e.parentSub)||null;const S=pt(u,h),_=Se(h,S),k=new Xe(_,m,m&&m.lastId,b,b&&b.id,v,e.parentSub,e.content.copy());return e.redone=_,ib(k,!0),k.integrate(n,0),k};class Xe extends nb{constructor(e,t,i,s,l,a,u,h){super(e,h.getLength()),this.origin=i,this.left=t,this.right=s,this.rightOrigin=l,this.parent=a,this.parentSub=u,this.redone=null,this.content=h,this.info=this.content.isCountable()?k_:0}set marker(e){(this.info&dm)>0!==e&&(this.info^=dm)}get marker(){return(this.info&dm)>0}get keep(){return(this.info&x_)>0}set keep(e){this.keep!==e&&(this.info^=x_)}get countable(){return(this.info&k_)>0}get deleted(){return(this.info&fm)>0}set deleted(e){this.deleted!==e&&(this.info^=fm)}markDeleted(){this.info|=fm}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=pt(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=pt(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ao&&this.id.client!==this.parent.client&&this.parent.clock>=pt(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=V_(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=gn(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Jn||this.right&&this.right.constructor===Jn)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Xe?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===Xe&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===ao){const i=co(t,this.parent);i.constructor===Jn?this.parent=null:this.parent=i.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=V_(e,e.doc.store,Se(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let i=this.left,s;if(i!==null)s=i.right;else if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start;const l=new Set,a=new Set;for(;s!==null&&s!==this.right;){if(a.add(s),l.add(s),to(this.origin,s.origin)){if(s.id.client<this.id.client)i=s,l.clear();else if(to(this.rightOrigin,s.rightOrigin))break}else if(s.origin!==null&&a.has(co(e.doc.store,s.origin)))l.has(co(e.doc.store,s.origin))||(i=s,l.clear());else break;s=s.right}this.left=i}if(this.left!==null){const i=this.left.right;this.right=i,this.left.right=this}else{let i;if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start,this.parent._start=this;this.right=i}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),sC(e.doc.store,this),this.content.integrate(e,this),P_(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new Jn(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Se(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&to(e.origin,this.lastId)&&this.right===e&&to(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(i=>{i.p===e&&(i.p=this,!this.deleted&&this.countable&&(i.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),Sc(e.deleteSet,this.id.client,this.id.clock,this.length),P_(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw zn();this.content.gc(e),t?JB(e,this,new Jn(this.id,this.length)):this.content=new Ac(this.length)}write(e,t){const i=t>0?Se(this.id.client,this.id.clock+t-1):this.origin,s=this.rightOrigin,l=this.parentSub,a=this.content.getRef()&rd|(i===null?0:jn)|(s===null?0:us)|(l===null?0:dc);if(e.writeInfo(a),i!==null&&e.writeLeftID(i),s!==null&&e.writeRightID(s),i===null&&s===null){const u=this.parent;if(u._item!==void 0){const h=u._item;if(h===null){const d=tC(u);e.writeParentInfo(!0),e.writeString(d)}else e.writeParentInfo(!1),e.writeLeftID(h.id)}else u.constructor===String?(e.writeParentInfo(!0),e.writeString(u)):u.constructor===ao?(e.writeParentInfo(!1),e.writeLeftID(u)):zn();l!==null&&e.writeString(l)}this.content.write(e,t)}}const CC=(n,e)=>W3[e&rd](n),W3=[()=>{zn()},D3,N3,O3,j3,R3,L3,K3,U3,M3,()=>{zn()}],Y3=10;class Xn extends nb{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){zn()}write(e,t){e.writeInfo(Y3),Ce(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const TC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},EC="__ $YJS$ __";TC[EC]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");TC[EC]=!0;let B0=[],OC=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?OC:B0).push(t=t+n[e])})();function F3(n){if(n<768)return!1;for(let e=0,t=B0.length;;){let i=e+t>>1;if(n<B0[i])t=i;else if(n>=OC[i])e=i+1;else return!0;if(e==t)return!1}}function Q_(n){return n>=127462&&n<=127487}const Z_=8205;function J3(n,e,t=!0,i=!0){return(t?DC:X3)(n,e,i)}function DC(n,e,t){if(e==n.length)return e;e&&MC(n.charCodeAt(e))&&RC(n.charCodeAt(e-1))&&e--;let i=_m(n,e);for(e+=ex(i);e<n.length;){let s=_m(n,e);if(i==Z_||s==Z_||t&&F3(s))e+=ex(s),i=s;else if(Q_(s)){let l=0,a=e-2;for(;a>=0&&Q_(_m(n,a));)l++,a-=2;if(l%2==0)break;e+=2}else break}return e}function X3(n,e,t){for(;e>0;){let i=DC(n,e-2,t);if(i<e)return i;e--}return 0}function _m(n,e){let t=n.charCodeAt(e);if(!RC(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return MC(i)?(t-55296<<10)+(i-56320)+65536:t}function MC(n){return n>=56320&&n<57344}function RC(n){return n>=55296&&n<56320}function ex(n){return n<65536?1:2}class He{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){[e,t]=Co(this,e,t);let s=[];return this.decompose(0,e,s,2),i.length&&i.decompose(0,i.length,s,3),this.decompose(t,this.length,s,1),Oi.from(s,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Co(this,e,t);let i=[];return this.decompose(e,t,i,0),Oi.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),s=new Za(this),l=new Za(e);for(let a=t,u=t;;){if(s.next(a),l.next(a),a=0,s.lineBreak!=l.lineBreak||s.done!=l.done||s.value!=l.value)return!1;if(u+=s.value.length,s.done||u>=i)return!0}}iter(e=1){return new Za(this,e)}iterRange(e,t=this.length){return new LC(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let s=this.line(e).from;i=this.iterRange(s,Math.max(s,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new NC(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?He.empty:e.length<=32?new ft(e):Oi.from(ft.split(e,[]))}}class ft extends He{constructor(e,t=Q3(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,s){for(let l=0;;l++){let a=this.text[l],u=s+a.length;if((t?i:u)>=e)return new Z3(s,u,i,a);s=u+1,i++}}decompose(e,t,i,s){let l=e<=0&&t>=this.length?this:new ft(tx(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(s&1){let a=i.pop(),u=lf(l.text,a.text.slice(),0,l.length);if(u.length<=32)i.push(new ft(u,a.length+l.length));else{let h=u.length>>1;i.push(new ft(u.slice(0,h)),new ft(u.slice(h)))}}else i.push(l)}replace(e,t,i){if(!(i instanceof ft))return super.replace(e,t,i);[e,t]=Co(this,e,t);let s=lf(this.text,lf(i.text,tx(this.text,0,e)),t),l=this.length+i.length-(t-e);return s.length<=32?new ft(s,l):Oi.from(ft.split(s,[]),l)}sliceString(e,t=this.length,i=`
`){[e,t]=Co(this,e,t);let s="";for(let l=0,a=0;l<=t&&a<this.text.length;a++){let u=this.text[a],h=l+u.length;l>e&&a&&(s+=i),e<h&&t>l&&(s+=u.slice(Math.max(0,e-l),t-l)),l=h+1}return s}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],s=-1;for(let l of e)i.push(l),s+=l.length+1,i.length==32&&(t.push(new ft(i,s)),i=[],s=-1);return s>-1&&t.push(new ft(i,s)),t}}class Oi extends He{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,s){for(let l=0;;l++){let a=this.children[l],u=s+a.length,h=i+a.lines-1;if((t?h:u)>=e)return a.lineInner(e,t,i,s);s=u+1,i=h+1}}decompose(e,t,i,s){for(let l=0,a=0;a<=t&&l<this.children.length;l++){let u=this.children[l],h=a+u.length;if(e<=h&&t>=a){let d=s&((a<=e?1:0)|(h>=t?2:0));a>=e&&h<=t&&!d?i.push(u):u.decompose(e-a,t-a,i,d)}a=h+1}}replace(e,t,i){if([e,t]=Co(this,e,t),i.lines<this.lines)for(let s=0,l=0;s<this.children.length;s++){let a=this.children[s],u=l+a.length;if(e>=l&&t<=u){let h=a.replace(e-l,t-l,i),d=this.lines-a.lines+h.lines;if(h.lines<d>>4&&h.lines>d>>6){let g=this.children.slice();return g[s]=h,new Oi(g,this.length-(t-e)+i.length)}return super.replace(l,u,h)}l=u+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){[e,t]=Co(this,e,t);let s="";for(let l=0,a=0;l<this.children.length&&a<=t;l++){let u=this.children[l],h=a+u.length;a>e&&l&&(s+=i),e<h&&t>a&&(s+=u.sliceString(e-a,t-a,i)),a=h+1}return s}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Oi))return 0;let i=0,[s,l,a,u]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=t,l+=t){if(s==a||l==u)return i;let h=this.children[s],d=e.children[l];if(h!=d)return i+h.scanIdentical(d,t);i+=h.length+1}}static from(e,t=e.reduce((i,s)=>i+s.length+1,-1)){let i=0;for(let v of e)i+=v.lines;if(i<32){let v=[];for(let S of e)S.flatten(v);return new ft(v,t)}let s=Math.max(32,i>>5),l=s<<1,a=s>>1,u=[],h=0,d=-1,g=[];function m(v){let S;if(v.lines>l&&v instanceof Oi)for(let _ of v.children)m(_);else v.lines>a&&(h>a||!h)?(b(),u.push(v)):v instanceof ft&&h&&(S=g[g.length-1])instanceof ft&&v.lines+S.lines<=32?(h+=v.lines,d+=v.length+1,g[g.length-1]=new ft(S.text.concat(v.text),S.length+1+v.length)):(h+v.lines>s&&b(),h+=v.lines,d+=v.length+1,g.push(v))}function b(){h!=0&&(u.push(g.length==1?g[0]:Oi.from(g,d)),d=-1,h=g.length=0)}for(let v of e)m(v);return b(),u.length==1?u[0]:new Oi(u,t)}}He.empty=new ft([""],0);function Q3(n){let e=-1;for(let t of n)e+=t.length+1;return e}function lf(n,e,t=0,i=1e9){for(let s=0,l=0,a=!0;l<n.length&&s<=i;l++){let u=n[l],h=s+u.length;h>=t&&(h>i&&(u=u.slice(0,i-s)),s<t&&(u=u.slice(t-s)),a?(e[e.length-1]+=u,a=!1):e.push(u)),s=h+1}return e}function tx(n,e,t){return lf(n,[""],e,t)}class Za{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof ft?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,s=this.nodes[i],l=this.offsets[i],a=l>>1,u=s instanceof ft?s.text.length:s.children.length;if(a==(t>0?u:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((l&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof ft){let h=s.text[a+(t<0?-1:0)];if(this.offsets[i]+=t,h.length>Math.max(0,e))return this.value=e==0?h:t>0?h.slice(e):h.slice(0,h.length-e),this;e-=h.length}else{let h=s.children[a+(t<0?-1:0)];e>h.length?(e-=h.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(h),this.offsets.push(t>0?1:(h instanceof ft?h.text.length:h.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class LC{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new Za(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*t,this.value=s.length<=i?s:t<0?s.slice(s.length-i):s.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class NC{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:s}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(He.prototype[Symbol.iterator]=function(){return this.iter()},Za.prototype[Symbol.iterator]=LC.prototype[Symbol.iterator]=NC.prototype[Symbol.iterator]=function(){return this});class Z3{constructor(e,t,i,s){this.from=e,this.to=t,this.number=i,this.text=s}get length(){return this.to-this.from}}function Co(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function Ct(n,e,t=!0,i=!0){return J3(n,e,t,i)}function eU(n){return n>=56320&&n<57344}function tU(n){return n>=55296&&n<56320}function fn(n,e){let t=n.charCodeAt(e);if(!tU(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return eU(i)?(t-55296<<10)+(i-56320)+65536:t}function sb(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function Di(n){return n<65536?1:2}const U0=/\r\n?|\n/;var tn=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(tn||(tn={}));class Bi{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,s=0;t<this.sections.length;){let l=this.sections[t++],a=this.sections[t++];a<0?(e(i,s,l),s+=l):s+=a,i+=l}}iterChangedRanges(e,t=!1){j0(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];s<0?e.push(i,s):e.push(s,i)}return new Bi(e)}composeDesc(e){return this.empty?e:e.empty?this:BC(this,e)}mapDesc(e,t=!1){return e.empty?this:z0(this,e,t)}mapPos(e,t=-1,i=tn.Simple){let s=0,l=0;for(let a=0;a<this.sections.length;){let u=this.sections[a++],h=this.sections[a++],d=s+u;if(h<0){if(d>e)return l+(e-s);l+=u}else{if(i!=tn.Simple&&d>=e&&(i==tn.TrackDel&&s<e&&d>e||i==tn.TrackBefore&&s<e||i==tn.TrackAfter&&d>e))return null;if(d>e||d==e&&t<0&&!u)return e==s||t<0?l:l+h;l+=h}s=d}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return l}touchesRange(e,t=e){for(let i=0,s=0;i<this.sections.length&&s<=t;){let l=this.sections[i++],a=this.sections[i++],u=s+l;if(a>=0&&s<=t&&u>=e)return s<e&&u>t?"cover":!0;s=u}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];e+=(e?" ":"")+i+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Bi(e)}static create(e){return new Bi(e)}}class At extends Bi{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return j0(this,(t,i,s,l,a)=>e=e.replace(s,s+(i-t),a),!1),e}mapDesc(e,t=!1){return z0(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let s=0,l=0;s<t.length;s+=2){let a=t[s],u=t[s+1];if(u>=0){t[s]=u,t[s+1]=a;let h=s>>1;for(;i.length<h;)i.push(He.empty);i.push(a?e.slice(l,l+a):He.empty)}l+=a}return new At(t,i)}compose(e){return this.empty?e:e.empty?this:BC(this,e,!0)}map(e,t=!1){return e.empty?this:z0(this,e,t,!0)}iterChanges(e,t=!1){j0(this,e,t)}get desc(){return Bi.create(this.sections)}filter(e){let t=[],i=[],s=[],l=new Cc(this);e:for(let a=0,u=0;;){let h=a==e.length?1e9:e[a++];for(;u<h||u==h&&l.len==0;){if(l.done)break e;let g=Math.min(l.len,h-u);Yt(s,g,-1);let m=l.ins==-1?-1:l.off==0?l.ins:0;Yt(t,g,m),m>0&&Js(i,t,l.text),l.forward(g),u+=g}let d=e[a++];for(;u<d;){if(l.done)break e;let g=Math.min(l.len,d-u);Yt(t,g,-1),Yt(s,g,l.ins==-1?-1:l.off==0?l.ins:0),l.forward(g),u+=g}}return{changes:new At(t,i),filtered:Bi.create(s)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],s=this.sections[t+1];s<0?e.push(i):s==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let s=[],l=[],a=0,u=null;function h(g=!1){if(!g&&!s.length)return;a<t&&Yt(s,t-a,-1);let m=new At(s,l);u=u?u.compose(m.map(u)):m,s=[],l=[],a=0}function d(g){if(Array.isArray(g))for(let m of g)d(m);else if(g instanceof At){if(g.length!=t)throw new RangeError(`Mismatched change set length (got ${g.length}, expected ${t})`);h(),u=u?u.compose(g.map(u)):g}else{let{from:m,to:b=m,insert:v}=g;if(m>b||m<0||b>t)throw new RangeError(`Invalid change range ${m} to ${b} (in doc of length ${t})`);let S=v?typeof v=="string"?He.of(v.split(i||U0)):v:He.empty,_=S.length;if(m==b&&_==0)return;m<a&&h(),m>a&&Yt(s,m-a,-1),Yt(s,b-m,_),Js(l,s,S),a=b}}return d(e),h(!u),u}static empty(e){return new At(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let s=0;s<e.length;s++){let l=e[s];if(typeof l=="number")t.push(l,-1);else{if(!Array.isArray(l)||typeof l[0]!="number"||l.some((a,u)=>u&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(l.length==1)t.push(l[0],0);else{for(;i.length<s;)i.push(He.empty);i[s]=He.of(l.slice(1)),t.push(l[0],i[s].length)}}}return new At(t,i)}static createSet(e,t){return new At(e,t)}}function Yt(n,e,t,i=!1){if(e==0&&t<=0)return;let s=n.length-2;s>=0&&t<=0&&t==n[s+1]?n[s]+=e:s>=0&&e==0&&n[s]==0?n[s+1]+=t:i?(n[s]+=e,n[s+1]+=t):n.push(e,t)}function Js(n,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<i;)n.push(He.empty);n.push(t)}}function j0(n,e,t){let i=n.inserted;for(let s=0,l=0,a=0;a<n.sections.length;){let u=n.sections[a++],h=n.sections[a++];if(h<0)s+=u,l+=u;else{let d=s,g=l,m=He.empty;for(;d+=u,g+=h,h&&i&&(m=m.append(i[a-2>>1])),!(t||a==n.sections.length||n.sections[a+1]<0);)u=n.sections[a++],h=n.sections[a++];e(s,d,l,g,m),s=d,l=g}}}function z0(n,e,t,i=!1){let s=[],l=i?[]:null,a=new Cc(n),u=new Cc(e);for(let h=-1;;){if(a.done&&u.len||u.done&&a.len)throw new Error("Mismatched change set lengths");if(a.ins==-1&&u.ins==-1){let d=Math.min(a.len,u.len);Yt(s,d,-1),a.forward(d),u.forward(d)}else if(u.ins>=0&&(a.ins<0||h==a.i||a.off==0&&(u.len<a.len||u.len==a.len&&!t))){let d=u.len;for(Yt(s,u.ins,-1);d;){let g=Math.min(a.len,d);a.ins>=0&&h<a.i&&a.len<=g&&(Yt(s,0,a.ins),l&&Js(l,s,a.text),h=a.i),a.forward(g),d-=g}u.next()}else if(a.ins>=0){let d=0,g=a.len;for(;g;)if(u.ins==-1){let m=Math.min(g,u.len);d+=m,g-=m,u.forward(m)}else if(u.ins==0&&u.len<g)g-=u.len,u.next();else break;Yt(s,d,h<a.i?a.ins:0),l&&h<a.i&&Js(l,s,a.text),h=a.i,a.forward(a.len-g)}else{if(a.done&&u.done)return l?At.createSet(s,l):Bi.create(s);throw new Error("Mismatched change set lengths")}}}function BC(n,e,t=!1){let i=[],s=t?[]:null,l=new Cc(n),a=new Cc(e);for(let u=!1;;){if(l.done&&a.done)return s?At.createSet(i,s):Bi.create(i);if(l.ins==0)Yt(i,l.len,0,u),l.next();else if(a.len==0&&!a.done)Yt(i,0,a.ins,u),s&&Js(s,i,a.text),a.next();else{if(l.done||a.done)throw new Error("Mismatched change set lengths");{let h=Math.min(l.len2,a.len),d=i.length;if(l.ins==-1){let g=a.ins==-1?-1:a.off?0:a.ins;Yt(i,h,g,u),s&&g&&Js(s,i,a.text)}else a.ins==-1?(Yt(i,l.off?0:l.len,h,u),s&&Js(s,i,l.textBit(h))):(Yt(i,l.off?0:l.len,a.off?0:a.ins,u),s&&!a.off&&Js(s,i,a.text));u=(l.ins>h||a.ins>=0&&a.len>h)&&(u||i.length>d),l.forward2(h),a.forward(h)}}}}class Cc{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?He.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?He.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class jr{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let i,s;return this.empty?i=s=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),i==this.from&&s==this.to?this:new jr(i,s,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return P.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return P.range(this.anchor,i)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return P.range(e.anchor,e.head)}static create(e,t,i){return new jr(e,t,i)}}class P{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:P.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new P([this.main],0)}addRange(e,t=!0){return P.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,P.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new P(e.ranges.map(t=>jr.fromJSON(t)),e.main)}static single(e,t=e){return new P([P.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,s=0;s<e.length;s++){let l=e[s];if(l.empty?l.from<=i:l.from<i)return P.normalized(e.slice(),t);i=l.to}return new P(e,t)}static cursor(e,t=0,i,s){return jr.create(e,e,(t==0?0:t<0?8:16)|(i==null?7:Math.min(6,i))|(s??16777215)<<6)}static range(e,t,i,s){let l=(i??16777215)<<6|(s==null?7:Math.min(6,s));return t<e?jr.create(t,e,48|l):jr.create(e,t,(t>e?8:0)|l)}static normalized(e,t=0){let i=e[t];e.sort((s,l)=>s.from-l.from),t=e.indexOf(i);for(let s=1;s<e.length;s++){let l=e[s],a=e[s-1];if(l.empty?l.from<=a.to:l.from<a.to){let u=a.from,h=Math.max(l.to,a.to);s<=t&&t--,e.splice(--s,2,l.anchor>l.head?P.range(h,u):P.range(u,h))}}return new P(e,t)}}function UC(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let rb=0;class X{constructor(e,t,i,s,l){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=s,this.id=rb++,this.default=e([]),this.extensions=typeof l=="function"?l(this):l}get reader(){return this}static define(e={}){return new X(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:lb),!!e.static,e.enables)}of(e){return new of([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new of(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new of(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function lb(n,e){return n==e||n.length==e.length&&n.every((t,i)=>t===e[i])}class of{constructor(e,t,i,s){this.dependencies=e,this.facet=t,this.type=i,this.value=s,this.id=rb++}dynamicSlot(e){var t;let i=this.value,s=this.facet.compareInput,l=this.id,a=e[l]>>1,u=this.type==2,h=!1,d=!1,g=[];for(let m of this.dependencies)m=="doc"?h=!0:m=="selection"?d=!0:(((t=e[m.id])!==null&&t!==void 0?t:1)&1)==0&&g.push(e[m.id]);return{create(m){return m.values[a]=i(m),1},update(m,b){if(h&&b.docChanged||d&&(b.docChanged||b.selection)||I0(m,g)){let v=i(m);if(u?!nx(v,m.values[a],s):!s(v,m.values[a]))return m.values[a]=v,1}return 0},reconfigure:(m,b)=>{let v,S=b.config.address[l];if(S!=null){let _=Mf(b,S);if(this.dependencies.every(k=>k instanceof X?b.facet(k)===m.facet(k):k instanceof Kt?b.field(k,!1)==m.field(k,!1):!0)||(u?nx(v=i(m),_,s):s(v=i(m),_)))return m.values[a]=_,0}else v=i(m);return m.values[a]=v,1}}}}function nx(n,e,t){if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(!t(n[i],e[i]))return!1;return!0}function I0(n,e){let t=!1;for(let i of e)ec(n,i)&1&&(t=!0);return t}function nU(n,e,t){let i=t.map(h=>n[h.id]),s=t.map(h=>h.type),l=i.filter(h=>!(h&1)),a=n[e.id]>>1;function u(h){let d=[];for(let g=0;g<i.length;g++){let m=Mf(h,i[g]);if(s[g]==2)for(let b of m)d.push(b);else d.push(m)}return e.combine(d)}return{create(h){for(let d of i)ec(h,d);return h.values[a]=u(h),1},update(h,d){if(!I0(h,l))return 0;let g=u(h);return e.compare(g,h.values[a])?0:(h.values[a]=g,1)},reconfigure(h,d){let g=I0(h,i),m=d.config.facets[e.id],b=d.facet(e);if(m&&!g&&lb(t,m))return h.values[a]=b,0;let v=u(h);return e.compare(v,b)?(h.values[a]=b,0):(h.values[a]=v,1)}}}const Rh=X.define({static:!0});class Kt{constructor(e,t,i,s,l){this.id=e,this.createF=t,this.updateF=i,this.compareF=s,this.spec=l,this.provides=void 0}static define(e){let t=new Kt(rb++,e.create,e.update,e.compare||((i,s)=>i===s),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Rh).find(i=>i.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,s)=>{let l=i.values[t],a=this.updateF(l,s);return this.compareF(l,a)?0:(i.values[t]=a,1)},reconfigure:(i,s)=>{let l=i.facet(Rh),a=s.facet(Rh),u;return(u=l.find(h=>h.field==this))&&u!=a.find(h=>h.field==this)?(i.values[t]=u.create(i),1):s.config.address[this.id]!=null?(i.values[t]=s.field(this),0):(i.values[t]=this.create(i),1)}}}init(e){return[this,Rh.of({field:this,create:e})]}get extension(){return this}}const Nr={lowest:4,low:3,default:2,high:1,highest:0};function za(n){return e=>new jC(e,n)}const nl={highest:za(Nr.highest),high:za(Nr.high),default:za(Nr.default),low:za(Nr.low),lowest:za(Nr.lowest)};class jC{constructor(e,t){this.inner=e,this.prec=t}}class yd{of(e){return new H0(this,e)}reconfigure(e){return yd.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class H0{constructor(e,t){this.compartment=e,this.inner=t}}class Df{constructor(e,t,i,s,l,a){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=s,this.staticValues=l,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let s=[],l=Object.create(null),a=new Map;for(let b of iU(e,t,a))b instanceof Kt?s.push(b):(l[b.facet.id]||(l[b.facet.id]=[])).push(b);let u=Object.create(null),h=[],d=[];for(let b of s)u[b.id]=d.length<<1,d.push(v=>b.slot(v));let g=i?.config.facets;for(let b in l){let v=l[b],S=v[0].facet,_=g&&g[b]||[];if(v.every(k=>k.type==0))if(u[S.id]=h.length<<1|1,lb(_,v))h.push(i.facet(S));else{let k=S.combine(v.map(A=>A.value));h.push(i&&S.compare(k,i.facet(S))?i.facet(S):k)}else{for(let k of v)k.type==0?(u[k.id]=h.length<<1|1,h.push(k.value)):(u[k.id]=d.length<<1,d.push(A=>k.dynamicSlot(A)));u[S.id]=d.length<<1,d.push(k=>nU(k,S,v))}}let m=d.map(b=>b(u));return new Df(e,a,m,u,h,l)}}function iU(n,e,t){let i=[[],[],[],[],[]],s=new Map;function l(a,u){let h=s.get(a);if(h!=null){if(h<=u)return;let d=i[h].indexOf(a);d>-1&&i[h].splice(d,1),a instanceof H0&&t.delete(a.compartment)}if(s.set(a,u),Array.isArray(a))for(let d of a)l(d,u);else if(a instanceof H0){if(t.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let d=e.get(a.compartment)||a.inner;t.set(a.compartment,d),l(d,u)}else if(a instanceof jC)l(a.inner,a.prec);else if(a instanceof Kt)i[u].push(a),a.provides&&l(a.provides,u);else if(a instanceof of)i[u].push(a),a.facet.extensions&&l(a.facet.extensions,Nr.default);else{let d=a.extension;if(!d)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);l(d,u)}}return l(n,Nr.default),i.reduce((a,u)=>a.concat(u))}function ec(n,e){if(e&1)return 2;let t=e>>1,i=n.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;n.status[t]=4;let s=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|s}function Mf(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const zC=X.define(),q0=X.define({combine:n=>n.some(e=>e),static:!0}),IC=X.define({combine:n=>n.length?n[0]:void 0,static:!0}),HC=X.define(),qC=X.define(),VC=X.define(),$C=X.define({combine:n=>n.length?n[0]:!1});class yi{constructor(e,t){this.type=e,this.value=t}static define(){return new sU}}class sU{of(e){return new yi(this,e)}}class rU{constructor(e){this.map=e}of(e){return new _e(this,e)}}class _e{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new _e(this.type,t)}is(e){return this.type==e}static define(e={}){return new rU(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let s of e){let l=s.map(t);l&&i.push(l)}return i}}_e.reconfigure=_e.define();_e.appendConfig=_e.define();class Tt{constructor(e,t,i,s,l,a){this.startState=e,this.changes=t,this.selection=i,this.effects=s,this.annotations=l,this.scrollIntoView=a,this._doc=null,this._state=null,i&&UC(i,t.newLength),l.some(u=>u.type==Tt.time)||(this.annotations=l.concat(Tt.time.of(Date.now())))}static create(e,t,i,s,l,a){return new Tt(e,t,i,s,l,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Tt.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Tt.time=yi.define();Tt.userEvent=yi.define();Tt.addToHistory=yi.define();Tt.remote=yi.define();function lU(n,e){let t=[];for(let i=0,s=0;;){let l,a;if(i<n.length&&(s==e.length||e[s]>=n[i]))l=n[i++],a=n[i++];else if(s<e.length)l=e[s++],a=e[s++];else return t;!t.length||t[t.length-1]<l?t.push(l,a):t[t.length-1]<a&&(t[t.length-1]=a)}}function PC(n,e,t){var i;let s,l,a;return t?(s=e.changes,l=At.empty(e.changes.length),a=n.changes.compose(e.changes)):(s=e.changes.map(n.changes),l=n.changes.mapDesc(e.changes,!0),a=n.changes.compose(s)),{changes:a,selection:e.selection?e.selection.map(l):(i=n.selection)===null||i===void 0?void 0:i.map(s),effects:_e.mapEffects(n.effects,s).concat(_e.mapEffects(e.effects,l)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function V0(n,e,t){let i=e.selection,s=ho(e.annotations);return e.userEvent&&(s=s.concat(Tt.userEvent.of(e.userEvent))),{changes:e.changes instanceof At?e.changes:At.of(e.changes||[],t,n.facet(IC)),selection:i&&(i instanceof P?i:P.single(i.anchor,i.head)),effects:ho(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function GC(n,e,t){let i=V0(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let l=1;l<e.length;l++){e[l].filter===!1&&(t=!1);let a=!!e[l].sequential;i=PC(i,V0(n,e[l],a?i.changes.newLength:n.doc.length),a)}let s=Tt.create(n,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return aU(t?oU(s):s)}function oU(n){let e=n.startState,t=!0;for(let s of e.facet(HC)){let l=s(n);if(l===!1){t=!1;break}Array.isArray(l)&&(t=t===!0?l:lU(t,l))}if(t!==!0){let s,l;if(t===!1)l=n.changes.invertedDesc,s=At.empty(e.doc.length);else{let a=n.changes.filter(t);s=a.changes,l=a.filtered.mapDesc(a.changes).invertedDesc}n=Tt.create(e,s,n.selection&&n.selection.map(l),_e.mapEffects(n.effects,l),n.annotations,n.scrollIntoView)}let i=e.facet(qC);for(let s=i.length-1;s>=0;s--){let l=i[s](n);l instanceof Tt?n=l:Array.isArray(l)&&l.length==1&&l[0]instanceof Tt?n=l[0]:n=GC(e,ho(l),!1)}return n}function aU(n){let e=n.startState,t=e.facet(VC),i=n;for(let s=t.length-1;s>=0;s--){let l=t[s](n);l&&Object.keys(l).length&&(i=PC(i,V0(e,l,n.changes.newLength),!0))}return i==n?n:Tt.create(e,n.changes,n.selection,i.effects,i.annotations,i.scrollIntoView)}const cU=[];function ho(n){return n==null?cU:Array.isArray(n)?n:[n]}var st=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})(st||(st={}));const uU=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let $0;try{$0=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function hU(n){if($0)return $0.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||uU.test(t)))return!0}return!1}function fU(n){return e=>{if(!/\S/.test(e))return st.Space;if(hU(e))return st.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return st.Word;return st.Other}}class je{constructor(e,t,i,s,l,a){this.config=e,this.doc=t,this.selection=i,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=l,a&&(a._state=this);for(let u=0;u<this.config.dynamicSlots.length;u++)ec(this,u<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return ec(this,i),Mf(this,i)}update(...e){return GC(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:s}=t;for(let u of e.effects)u.is(yd.reconfigure)?(t&&(s=new Map,t.compartments.forEach((h,d)=>s.set(d,h)),t=null),s.set(u.value.compartment,u.value.extension)):u.is(_e.reconfigure)?(t=null,i=u.value):u.is(_e.appendConfig)&&(t=null,i=ho(i).concat(u.value));let l;t?l=e.startState.values.slice():(t=Df.resolve(i,s,this),l=new je(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(h,d)=>d.reconfigure(h,this),null).values);let a=e.startState.facet(q0)?e.newSelection:e.newSelection.asSingle();new je(t,e.newDoc,a,l,(u,h)=>h.update(u,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:P.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),s=this.changes(i.changes),l=[i.range],a=ho(i.effects);for(let u=1;u<t.ranges.length;u++){let h=e(t.ranges[u]),d=this.changes(h.changes),g=d.map(s);for(let b=0;b<u;b++)l[b]=l[b].map(g);let m=s.mapDesc(d,!0);l.push(h.range.map(m)),s=s.compose(g),a=_e.mapEffects(a,g).concat(_e.mapEffects(ho(h.effects),m))}return{changes:s,selection:P.create(l,t.mainIndex),effects:a}}changes(e=[]){return e instanceof At?e:At.of(e,this.doc.length,this.facet(je.lineSeparator))}toText(e){return He.of(e.split(this.facet(je.lineSeparator)||U0))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(ec(this,t),Mf(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let s=e[i];s instanceof Kt&&this.config.address[s.id]!=null&&(t[i]=s.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(i){for(let l in i)if(Object.prototype.hasOwnProperty.call(e,l)){let a=i[l],u=e[l];s.push(a.init(h=>a.spec.fromJSON(u,h)))}}return je.create({doc:e.doc,selection:P.fromJSON(e.selection),extensions:t.extensions?s.concat([t.extensions]):s})}static create(e={}){let t=Df.resolve(e.extensions||[],new Map),i=e.doc instanceof He?e.doc:He.of((e.doc||"").split(t.staticFacet(je.lineSeparator)||U0)),s=e.selection?e.selection instanceof P?e.selection:P.single(e.selection.anchor,e.selection.head):P.single(0);return UC(s,i.length),t.staticFacet(q0)||(s=s.asSingle()),new je(t,i,s,t.dynamicSlots.map(()=>null),(l,a)=>a.create(l),null)}get tabSize(){return this.facet(je.tabSize)}get lineBreak(){return this.facet(je.lineSeparator)||`
`}get readOnly(){return this.facet($C)}phrase(e,...t){for(let i of this.facet(je.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,s)=>{if(s=="$")return"$";let l=+(s||1);return!l||l>t.length?i:t[l-1]})),e}languageDataAt(e,t,i=-1){let s=[];for(let l of this.facet(zC))for(let a of l(this,t,i))Object.prototype.hasOwnProperty.call(a,e)&&s.push(a[e]);return s}charCategorizer(e){let t=this.languageDataAt("wordChars",e);return fU(t.length?t[0]:"")}wordAt(e){let{text:t,from:i,length:s}=this.doc.lineAt(e),l=this.charCategorizer(e),a=e-i,u=e-i;for(;a>0;){let h=Ct(t,a,!1);if(l(t.slice(h,a))!=st.Word)break;a=h}for(;u<s;){let h=Ct(t,u);if(l(t.slice(u,h))!=st.Word)break;u=h}return a==u?null:P.range(a+i,u+i)}}je.allowMultipleSelections=q0;je.tabSize=X.define({combine:n=>n.length?n[0]:4});je.lineSeparator=IC;je.readOnly=$C;je.phrases=X.define({compare(n,e){let t=Object.keys(n),i=Object.keys(e);return t.length==i.length&&t.every(s=>n[s]==e[s])}});je.languageData=zC;je.changeFilter=HC;je.transactionFilter=qC;je.transactionExtender=VC;yd.reconfigure=_e.define();function qi(n,e,t={}){let i={};for(let s of n)for(let l of Object.keys(s)){let a=s[l],u=i[l];if(u===void 0)i[l]=a;else if(!(u===a||a===void 0))if(Object.hasOwnProperty.call(t,l))i[l]=t[l](u,a);else throw new Error("Config merge conflict for field "+l)}for(let s in e)i[s]===void 0&&(i[s]=e[s]);return i}class er{eq(e){return this==e}range(e,t=e){return P0.create(e,t,this)}}er.prototype.startSide=er.prototype.endSide=0;er.prototype.point=!1;er.prototype.mapMode=tn.TrackDel;function ob(n,e){return n==e||n.constructor==e.constructor&&n.eq(e)}let P0=class KC{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new KC(e,t,i)}};function G0(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class ab{constructor(e,t,i,s){this.from=e,this.to=t,this.value=i,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,s=0){let l=i?this.to:this.from;for(let a=s,u=l.length;;){if(a==u)return a;let h=a+u>>1,d=l[h]-e||(i?this.value[h].endSide:this.value[h].startSide)-t;if(h==a)return d>=0?a:u;d>=0?u=h:a=h+1}}between(e,t,i,s){for(let l=this.findIndex(t,-1e9,!0),a=this.findIndex(i,1e9,!1,l);l<a;l++)if(s(this.from[l]+e,this.to[l]+e,this.value[l])===!1)return!1}map(e,t){let i=[],s=[],l=[],a=-1,u=-1;for(let h=0;h<this.value.length;h++){let d=this.value[h],g=this.from[h]+e,m=this.to[h]+e,b,v;if(g==m){let S=t.mapPos(g,d.startSide,d.mapMode);if(S==null||(b=v=S,d.startSide!=d.endSide&&(v=t.mapPos(g,d.endSide),v<b)))continue}else if(b=t.mapPos(g,d.startSide),v=t.mapPos(m,d.endSide),b>v||b==v&&d.startSide>0&&d.endSide<=0)continue;(v-b||d.endSide-d.startSide)<0||(a<0&&(a=b),d.point&&(u=Math.max(u,v-b)),i.push(d),s.push(b-a),l.push(v-a))}return{mapped:i.length?new ab(s,l,i,u):null,pos:a}}}class Ee{constructor(e,t,i,s){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=s}static create(e,t,i,s){return new Ee(e,t,i,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:s=0,filterTo:l=this.length}=e,a=e.filter;if(t.length==0&&!a)return this;if(i&&(t=t.slice().sort(G0)),this.isEmpty)return t.length?Ee.of(t):this;let u=new WC(this,null,-1).goto(0),h=0,d=[],g=new fs;for(;u.value||h<t.length;)if(h<t.length&&(u.from-t[h].from||u.startSide-t[h].value.startSide)>=0){let m=t[h++];g.addInner(m.from,m.to,m.value)||d.push(m)}else u.rangeIndex==1&&u.chunkIndex<this.chunk.length&&(h==t.length||this.chunkEnd(u.chunkIndex)<t[h].from)&&(!a||s>this.chunkEnd(u.chunkIndex)||l<this.chunkPos[u.chunkIndex])&&g.addChunk(this.chunkPos[u.chunkIndex],this.chunk[u.chunkIndex])?u.nextChunk():((!a||s>u.to||l<u.from||a(u.from,u.to,u.value))&&(g.addInner(u.from,u.to,u.value)||d.push(P0.create(u.from,u.to,u.value))),u.next());return g.finishInner(this.nextLayer.isEmpty&&!d.length?Ee.empty:this.nextLayer.update({add:d,filter:a,filterFrom:s,filterTo:l}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],s=-1;for(let a=0;a<this.chunk.length;a++){let u=this.chunkPos[a],h=this.chunk[a],d=e.touchesRange(u,u+h.length);if(d===!1)s=Math.max(s,h.maxPoint),t.push(h),i.push(e.mapPos(u));else if(d===!0){let{mapped:g,pos:m}=h.map(u,e);g&&(s=Math.max(s,g.maxPoint),t.push(g),i.push(m))}}let l=this.nextLayer.map(e);return t.length==0?l:new Ee(i,t,l||Ee.empty,s)}between(e,t,i){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let l=this.chunkPos[s],a=this.chunk[s];if(t>=l&&e<=l+a.length&&a.between(l,e-l,t-l,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return Tc.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Tc.from(e).goto(t)}static compare(e,t,i,s,l=-1){let a=e.filter(m=>m.maxPoint>0||!m.isEmpty&&m.maxPoint>=l),u=t.filter(m=>m.maxPoint>0||!m.isEmpty&&m.maxPoint>=l),h=ix(a,u,i),d=new Ia(a,h,l),g=new Ia(u,h,l);i.iterGaps((m,b,v)=>sx(d,m,g,b,v,s)),i.empty&&i.length==0&&sx(d,0,g,0,0,s)}static eq(e,t,i=0,s){s==null&&(s=999999999);let l=e.filter(g=>!g.isEmpty&&t.indexOf(g)<0),a=t.filter(g=>!g.isEmpty&&e.indexOf(g)<0);if(l.length!=a.length)return!1;if(!l.length)return!0;let u=ix(l,a),h=new Ia(l,u,0).goto(i),d=new Ia(a,u,0).goto(i);for(;;){if(h.to!=d.to||!K0(h.active,d.active)||h.point&&(!d.point||!ob(h.point,d.point)))return!1;if(h.to>s)return!0;h.next(),d.next()}}static spans(e,t,i,s,l=-1){let a=new Ia(e,null,l).goto(t),u=t,h=a.openStart;for(;;){let d=Math.min(a.to,i);if(a.point){let g=a.activeForPoint(a.to),m=a.pointFrom<t?g.length+1:a.point.startSide<0?g.length:Math.min(g.length,h);s.point(u,d,a.point,g,m,a.pointRank),h=Math.min(a.openEnd(d),g.length)}else d>u&&(s.span(u,d,a.active,h),h=a.openEnd(d));if(a.to>i)return h+(a.point&&a.to>i?1:0);u=a.to,a.next()}}static of(e,t=!1){let i=new fs;for(let s of e instanceof P0?[e]:t?dU(e):e)i.add(s.from,s.to,s.value);return i.finish()}static join(e){if(!e.length)return Ee.empty;let t=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let s=e[i];s!=Ee.empty;s=s.nextLayer)t=new Ee(s.chunkPos,s.chunk,t,Math.max(s.maxPoint,t.maxPoint));return t}}Ee.empty=new Ee([],[],null,-1);function dU(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let i=n[t];if(G0(e,i)>0)return n.slice().sort(G0);e=i}return n}Ee.empty.nextLayer=Ee.empty;class fs{finishChunk(e){this.chunks.push(new ab(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new fs)).add(e,t,i)}addInner(e,t,i){let s=e-this.lastTo||i.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(Ee.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=Ee.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function ix(n,e,t){let i=new Map;for(let l of n)for(let a=0;a<l.chunk.length;a++)l.chunk[a].maxPoint<=0&&i.set(l.chunk[a],l.chunkPos[a]);let s=new Set;for(let l of e)for(let a=0;a<l.chunk.length;a++){let u=i.get(l.chunk[a]);u!=null&&(t?t.mapPos(u):u)==l.chunkPos[a]&&!t?.touchesRange(u,u+l.chunk[a].length)&&s.add(l.chunk[a])}return s}class WC{constructor(e,t,i,s=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Tc{constructor(e){this.heap=e}static from(e,t=null,i=-1){let s=[];for(let l=0;l<e.length;l++)for(let a=e[l];!a.isEmpty;a=a.nextLayer)a.maxPoint>=i&&s.push(new WC(a,t,i,l));return s.length==1?s[0]:new Tc(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)xm(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)xm(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),xm(this.heap,0)}}}function xm(n,e){for(let t=n[e];;){let i=(e<<1)+1;if(i>=n.length)break;let s=n[i];if(i+1<n.length&&s.compare(n[i+1])>=0&&(s=n[i+1],i++),t.compare(s)<0)break;n[i]=t,n[e]=s,e=i}}class Ia{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Tc.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Lh(this.active,e),Lh(this.activeTo,e),Lh(this.activeRank,e),this.minActive=rx(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:s,rank:l}=this.cursor;for(;t<this.activeRank.length&&(l-this.activeRank[t]||s-this.activeTo[t])>0;)t++;Nh(this.active,t,i),Nh(this.activeTo,t,s),Nh(this.activeRank,t,l),e&&Nh(e,t,this.cursor.from),this.minActive=rx(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),i&&Lh(i,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let l=this.cursor.value;if(!l.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=l,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=l.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let s=i.length-1;s>=0&&i[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function sx(n,e,t,i,s,l){n.goto(e),t.goto(i);let a=i+s,u=i,h=i-e,d=!!l.boundChange;for(let g=!1;;){let m=n.to+h-t.to,b=m||n.endSide-t.endSide,v=b<0?n.to+h:t.to,S=Math.min(v,a);if(n.point||t.point?(n.point&&t.point&&ob(n.point,t.point)&&K0(n.activeForPoint(n.to),t.activeForPoint(t.to))||l.comparePoint(u,S,n.point,t.point),g=!1):(g&&l.boundChange(u),S>u&&!K0(n.active,t.active)&&l.compareRange(u,S,n.active,t.active),d&&S<a&&(m||n.openEnd(v)!=t.openEnd(v))&&(g=!0)),v>a)break;u=v,b<=0&&n.next(),b>=0&&t.next()}}function K0(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!ob(n[t],e[t]))return!1;return!0}function Lh(n,e){for(let t=e,i=n.length-1;t<i;t++)n[t]=n[t+1];n.pop()}function Nh(n,e,t){for(let i=n.length-1;i>=e;i--)n[i+1]=n[i];n[e]=t}function rx(n,e){let t=-1,i=1e9;for(let s=0;s<e.length;s++)(e[s]-i||n[s].endSide-n[t].endSide)<0&&(t=s,i=e[s]);return t}function Io(n,e,t=n.length){let i=0;for(let s=0;s<t&&s<n.length;)n.charCodeAt(s)==9?(i+=e-i%e,s++):(i++,s=Ct(n,s));return i}function W0(n,e,t,i){for(let s=0,l=0;;){if(l>=e)return s;if(s==n.length)break;l+=n.charCodeAt(s)==9?t-l%t:1,s=Ct(n,s)}return i===!0?-1:n.length}const Y0="",lx=typeof Symbol>"u"?"__"+Y0:Symbol.for(Y0),F0=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),ox=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class tr{constructor(e,t){this.rules=[];let{finish:i}=t||{};function s(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function l(a,u,h,d){let g=[],m=/^@(\w+)\b/.exec(a[0]),b=m&&m[1]=="keyframes";if(m&&u==null)return h.push(a[0]+";");for(let v in u){let S=u[v];if(/&/.test(v))l(v.split(/,\s*/).map(_=>a.map(k=>_.replace(/&/,k))).reduce((_,k)=>_.concat(k)),S,h);else if(S&&typeof S=="object"){if(!m)throw new RangeError("The value of a property ("+v+") should be a primitive value.");l(s(v),S,g,b)}else S!=null&&g.push(v.replace(/_.*/,"").replace(/[A-Z]/g,_=>"-"+_.toLowerCase())+": "+S+";")}(g.length||b)&&h.push((i&&!m&&!d?a.map(i):a).join(", ")+" {"+g.join(" ")+"}")}for(let a in e)l(s(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=ox[lx]||1;return ox[lx]=e+1,Y0+e.toString(36)}static mount(e,t,i){let s=e[F0],l=i&&i.nonce;s?l&&s.setNonce(l):s=new gU(e,l),s.mount(Array.isArray(t)?t:[t],e)}}let ax=new Map;class gU{constructor(e,t){let i=e.ownerDocument||e,s=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&s.CSSStyleSheet){let l=ax.get(i);if(l)return e[F0]=l;this.sheet=new s.CSSStyleSheet,ax.set(i,this)}else this.styleTag=i.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[F0]=this}mount(e,t){let i=this.sheet,s=0,l=0;for(let a=0;a<e.length;a++){let u=e[a],h=this.modules.indexOf(u);if(h<l&&h>-1&&(this.modules.splice(h,1),l--,h=-1),h==-1){if(this.modules.splice(l++,0,u),i)for(let d=0;d<u.rules.length;d++)i.insertRule(u.rules[d],s++)}else{for(;l<h;)s+=this.modules[l++].rules.length;s+=u.rules.length,l++}}if(i)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let a="";for(let h=0;h<this.modules.length;h++)a+=this.modules[h].getRules()+`
`;this.styleTag.textContent=a;let u=t.head||t;this.styleTag.parentNode!=u&&u.insertBefore(this.styleTag,u.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var nr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ec={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},pU=typeof navigator<"u"&&/Mac/.test(navigator.platform),mU=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var $t=0;$t<10;$t++)nr[48+$t]=nr[96+$t]=String($t);for(var $t=1;$t<=24;$t++)nr[$t+111]="F"+$t;for(var $t=65;$t<=90;$t++)nr[$t]=String.fromCharCode($t+32),Ec[$t]=String.fromCharCode($t);for(var km in nr)Ec.hasOwnProperty(km)||(Ec[km]=nr[km]);function yU(n){var e=pU&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||mU&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Ec:nr)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function We(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=t[i];typeof s=="string"?n.setAttribute(i,s):s!=null&&(n[i]=s)}e++}for(;e<arguments.length;e++)YC(n,arguments[e]);return n}function YC(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)YC(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}let en=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},J0=typeof document<"u"?document:{documentElement:{style:{}}};const X0=/Edge\/(\d+)/.exec(en.userAgent),FC=/MSIE \d/.test(en.userAgent),Q0=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(en.userAgent),bd=!!(FC||Q0||X0),cx=!bd&&/gecko\/(\d+)/i.test(en.userAgent),Am=!bd&&/Chrome\/(\d+)/.exec(en.userAgent),bU="webkitFontSmoothing"in J0.documentElement.style,Z0=!bd&&/Apple Computer/.test(en.vendor),ux=Z0&&(/Mobile\/\w+/.test(en.userAgent)||en.maxTouchPoints>2);var Z={mac:ux||/Mac/.test(en.platform),windows:/Win/.test(en.platform),linux:/Linux|X11/.test(en.platform),ie:bd,ie_version:FC?J0.documentMode||6:Q0?+Q0[1]:X0?+X0[1]:0,gecko:cx,gecko_version:cx?+(/Firefox\/(\d+)/.exec(en.userAgent)||[0,0])[1]:0,chrome:!!Am,chrome_version:Am?+Am[1]:0,ios:ux,android:/Android\b/.test(en.userAgent),webkit_version:bU?+(/\bAppleWebKit\/(\d+)/.exec(en.userAgent)||[0,0])[1]:0,safari:Z0,safari_version:Z0?+(/\bVersion\/(\d+(\.\d+)?)/.exec(en.userAgent)||[0,0])[1]:0,tabSize:J0.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function cb(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const Rf=Object.create(null);function ub(n,e,t){if(n==e)return!0;n||(n=Rf),e||(e=Rf);let i=Object.keys(n),s=Object.keys(e);if(i.length-0!=s.length-0)return!1;for(let l of i)if(l!=t&&(s.indexOf(l)==-1||n[l]!==e[l]))return!1;return!0}function vU(n,e){for(let t=n.attributes.length-1;t>=0;t--){let i=n.attributes[t].name;e[i]==null&&n.removeAttribute(i)}for(let t in e){let i=e[t];t=="style"?n.style.cssText=i:n.getAttribute(t)!=i&&n.setAttribute(t,i)}}function hx(n,e,t){let i=!1;if(e)for(let s in e)t&&s in t||(i=!0,s=="style"?n.style.cssText="":n.removeAttribute(s));if(t)for(let s in t)e&&e[s]==t[s]||(i=!0,s=="style"?n.style.cssText=t[s]:n.setAttribute(s,t[s]));return i}function wU(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let i=n.attributes[t];e[i.name]=i.value}return e}class Vi{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Gt=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(Gt||(Gt={}));class ae extends er{constructor(e,t,i,s){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=s}get heightRelevant(){return!1}static mark(e){return new Fc(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return t+=i&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Fr(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,s;if(e.isBlockGap)i=-5e8,s=4e8;else{let{start:l,end:a}=JC(e,t);i=(l?t?-3e8:-1:5e8)-1,s=(a?t?2e8:1:-6e8)+1}return new Fr(e,i,s,t,e.widget||null,!0)}static line(e){return new Jc(e)}static set(e,t=!1){return Ee.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ae.none=Ee.empty;class Fc extends ae{constructor(e){let{start:t,end:i}=JC(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?cb(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||Rf}eq(e){return this==e||e instanceof Fc&&this.tagName==e.tagName&&ub(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Fc.prototype.point=!1;class Jc extends ae{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Jc&&this.spec.class==e.spec.class&&ub(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Jc.prototype.mapMode=tn.TrackBefore;Jc.prototype.point=!0;class Fr extends ae{constructor(e,t,i,s,l,a){super(t,i,l,e),this.block=s,this.isReplace=a,this.mapMode=s?t<=0?tn.TrackBefore:tn.TrackAfter:tn.TrackDel}get type(){return this.startSide!=this.endSide?Gt.WidgetRange:this.startSide<=0?Gt.WidgetBefore:Gt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Fr&&SU(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Fr.prototype.point=!0;function JC(n,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=n;return t==null&&(t=n.inclusive),i==null&&(i=n.inclusive),{start:t??e,end:i??e}}function SU(n,e){return n==e||!!(n&&e&&n.compare(e))}function fo(n,e,t,i=0){let s=t.length-1;s>=0&&t[s]+i>=n?t[s]=Math.max(t[s],e):t.push(n,e)}class Oc extends er{constructor(e,t){super(),this.tagName=e,this.attributes=t}eq(e){return e==this||e instanceof Oc&&this.tagName==e.tagName&&ub(this.attributes,e.attributes)}static create(e){return new Oc(e.tagName,e.attributes||Rf)}static set(e,t=!1){return Ee.of(e,t)}}Oc.prototype.startSide=Oc.prototype.endSide=-1;function To(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function ey(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function tc(n,e){if(!e.anchorNode)return!1;try{return ey(n,e.anchorNode)}catch{return!1}}function af(n){return n.nodeType==3?Dc(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function nc(n,e,t,i){return t?fx(n,e,t,i,-1)||fx(n,e,t,i,1):!1}function ir(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function Lf(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function fx(n,e,t,i,s){for(;;){if(n==t&&e==i)return!0;if(e==(s<0?0:ds(n))){if(n.nodeName=="DIV")return!1;let l=n.parentNode;if(!l||l.nodeType!=1)return!1;e=ir(n)+(s<0?0:1),n=l}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=s<0?ds(n):0}else return!1}}function ds(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Nf(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function _U(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function XC(n,e){let t=e.width/n.offsetWidth,i=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-n.offsetHeight)<1)&&(i=1),{scaleX:t,scaleY:i}}function xU(n,e,t,i,s,l,a,u){let h=n.ownerDocument,d=h.defaultView||window;for(let g=n,m=!1;g&&!m;)if(g.nodeType==1){let b,v=g==h.body,S=1,_=1;if(v)b=_U(d);else{if(/^(fixed|sticky)$/.test(getComputedStyle(g).position)&&(m=!0),g.scrollHeight<=g.clientHeight&&g.scrollWidth<=g.clientWidth){g=g.assignedSlot||g.parentNode;continue}let M=g.getBoundingClientRect();({scaleX:S,scaleY:_}=XC(g,M)),b={left:M.left,right:M.left+g.clientWidth*S,top:M.top,bottom:M.top+g.clientHeight*_}}let k=0,A=0;if(s=="nearest")e.top<b.top?(A=e.top-(b.top+a),t>0&&e.bottom>b.bottom+A&&(A=e.bottom-b.bottom+a)):e.bottom>b.bottom&&(A=e.bottom-b.bottom+a,t<0&&e.top-A<b.top&&(A=e.top-(b.top+a)));else{let M=e.bottom-e.top,O=b.bottom-b.top;A=(s=="center"&&M<=O?e.top+M/2-O/2:s=="start"||s=="center"&&t<0?e.top-a:e.bottom-O+a)-b.top}if(i=="nearest"?e.left<b.left?(k=e.left-(b.left+l),t>0&&e.right>b.right+k&&(k=e.right-b.right+l)):e.right>b.right&&(k=e.right-b.right+l,t<0&&e.left<b.left+k&&(k=e.left-(b.left+l))):k=(i=="center"?e.left+(e.right-e.left)/2-(b.right-b.left)/2:i=="start"==u?e.left-l:e.right-(b.right-b.left)+l)-b.left,k||A)if(v)d.scrollBy(k,A);else{let M=0,O=0;if(A){let z=g.scrollTop;g.scrollTop+=A/_,O=(g.scrollTop-z)*_}if(k){let z=g.scrollLeft;g.scrollLeft+=k/S,M=(g.scrollLeft-z)*S}e={left:e.left-M,top:e.top-O,right:e.right-M,bottom:e.bottom-O},M&&Math.abs(M-k)<1&&(i="nearest"),O&&Math.abs(O-A)<1&&(s="nearest")}if(v)break;(e.top<b.top||e.bottom>b.bottom||e.left<b.left||e.right>b.right)&&(e={left:Math.max(e.left,b.left),right:Math.min(e.right,b.right),top:Math.max(e.top,b.top),bottom:Math.min(e.bottom,b.bottom)}),g=g.assignedSlot||g.parentNode}else if(g.nodeType==11)g=g.host;else break}function kU(n){let e=n.ownerDocument,t,i;for(let s=n.parentNode;s&&!(s==e.body||t&&i);)if(s.nodeType==1)!i&&s.scrollHeight>s.clientHeight&&(i=s),!t&&s.scrollWidth>s.clientWidth&&(t=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:t,y:i}}class AU{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:i}=e;this.set(t,Math.min(e.anchorOffset,t?ds(t):0),i,Math.min(e.focusOffset,i?ds(i):0))}set(e,t,i,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=s}}let Mr=null;Z.safari&&Z.safari_version>=26&&(Mr=!1);function QC(n){if(n.setActive)return n.setActive();if(Mr)return n.focus(Mr);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(Mr==null?{get preventScroll(){return Mr={preventScroll:!0},!0}}:void 0),!Mr){Mr=!1;for(let t=0;t<e.length;){let i=e[t++],s=e[t++],l=e[t++];i.scrollTop!=s&&(i.scrollTop=s),i.scrollLeft!=l&&(i.scrollLeft=l)}}}let dx;function Dc(n,e,t=e){let i=dx||(dx=document.createRange());return i.setEnd(n,t),i.setStart(n,e),i}function go(n,e,t,i){let s={key:e,code:e,keyCode:t,which:t,cancelable:!0};i&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=i);let l=new KeyboardEvent("keydown",s);l.synthetic=!0,n.dispatchEvent(l);let a=new KeyboardEvent("keyup",s);return a.synthetic=!0,n.dispatchEvent(a),l.defaultPrevented||a.defaultPrevented}function CU(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function TU(n,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(i=Math.min(i,ds(t));;)if(i){if(t.nodeType!=1)return!1;let s=t.childNodes[i-1];s.contentEditable=="false"?i--:(t=s,i=ds(t))}else{if(t==n)return!0;i=ir(t),t=t.parentNode}}function ZC(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function eT(n,e){for(let t=n,i=e;;){if(t.nodeType==3&&i>0)return{node:t,offset:i};if(t.nodeType==1&&i>0){if(t.contentEditable=="false")return null;t=t.childNodes[i-1],i=ds(t)}else if(t.parentNode&&!Lf(t))i=ir(t),t=t.parentNode;else return null}}function tT(n,e){for(let t=n,i=e;;){if(t.nodeType==3&&i<t.nodeValue.length)return{node:t,offset:i};if(t.nodeType==1&&i<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[i],i=0}else if(t.parentNode&&!Lf(t))i=ir(t)+1,t=t.parentNode;else return null}}class di{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new di(e.parentNode,ir(e),t)}static after(e,t){return new di(e.parentNode,ir(e)+1,t)}}var Qe=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(Qe||(Qe={}));const Jr=Qe.LTR,hb=Qe.RTL;function nT(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const EU=nT("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),OU=nT("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),ty=Object.create(null),Ai=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);ty[e]=t,ty[t]=-e}function iT(n){return n<=247?EU[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?OU[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const DU=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class cs{get dir(){return this.level%2?hb:Jr}constructor(e,t,i){this.from=e,this.to=t,this.level=i}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,i,s){let l=-1;for(let a=0;a<e.length;a++){let u=e[a];if(u.from<=t&&u.to>=t){if(u.level==i)return a;(l<0||(s!=0?s<0?u.from<t:u.to>t:e[l].level>u.level))&&(l=a)}}if(l<0)throw new RangeError("Index out of range");return l}}function sT(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let i=n[t],s=e[t];if(i.from!=s.from||i.to!=s.to||i.direction!=s.direction||!sT(i.inner,s.inner))return!1}return!0}const Fe=[];function MU(n,e,t,i,s){for(let l=0;l<=i.length;l++){let a=l?i[l-1].to:e,u=l<i.length?i[l].from:t,h=l?256:s;for(let d=a,g=h,m=h;d<u;d++){let b=iT(n.charCodeAt(d));b==512?b=g:b==8&&m==4&&(b=16),Fe[d]=b==4?2:b,b&7&&(m=b),g=b}for(let d=a,g=h,m=h;d<u;d++){let b=Fe[d];if(b==128)d<u-1&&g==Fe[d+1]&&g&24?b=Fe[d]=g:Fe[d]=256;else if(b==64){let v=d+1;for(;v<u&&Fe[v]==64;)v++;let S=d&&g==8||v<t&&Fe[v]==8?m==1?1:8:256;for(let _=d;_<v;_++)Fe[_]=S;d=v-1}else b==8&&m==1&&(Fe[d]=1);g=b,b&7&&(m=b)}}}function RU(n,e,t,i,s){let l=s==1?2:1;for(let a=0,u=0,h=0;a<=i.length;a++){let d=a?i[a-1].to:e,g=a<i.length?i[a].from:t;for(let m=d,b,v,S;m<g;m++)if(v=ty[b=n.charCodeAt(m)])if(v<0){for(let _=u-3;_>=0;_-=3)if(Ai[_+1]==-v){let k=Ai[_+2],A=k&2?s:k&4?k&1?l:s:0;A&&(Fe[m]=Fe[Ai[_]]=A),u=_;break}}else{if(Ai.length==189)break;Ai[u++]=m,Ai[u++]=b,Ai[u++]=h}else if((S=Fe[m])==2||S==1){let _=S==s;h=_?0:1;for(let k=u-3;k>=0;k-=3){let A=Ai[k+2];if(A&2)break;if(_)Ai[k+2]|=2;else{if(A&4)break;Ai[k+2]|=4}}}}}function LU(n,e,t,i){for(let s=0,l=i;s<=t.length;s++){let a=s?t[s-1].to:n,u=s<t.length?t[s].from:e;for(let h=a;h<u;){let d=Fe[h];if(d==256){let g=h+1;for(;;)if(g==u){if(s==t.length)break;g=t[s++].to,u=s<t.length?t[s].from:e}else if(Fe[g]==256)g++;else break;let m=l==1,b=(g<e?Fe[g]:i)==1,v=m==b?m?1:2:i;for(let S=g,_=s,k=_?t[_-1].to:n;S>h;)S==k&&(S=t[--_].from,k=_?t[_-1].to:n),Fe[--S]=v;h=g}else l=d,h++}}}function ny(n,e,t,i,s,l,a){let u=i%2?2:1;if(i%2==s%2)for(let h=e,d=0;h<t;){let g=!0,m=!1;if(d==l.length||h<l[d].from){let _=Fe[h];_!=u&&(g=!1,m=_==16)}let b=!g&&u==1?[]:null,v=g?i:i+1,S=h;e:for(;;)if(d<l.length&&S==l[d].from){if(m)break e;let _=l[d];if(!g)for(let k=_.to,A=d+1;;){if(k==t)break e;if(A<l.length&&l[A].from==k)k=l[A++].to;else{if(Fe[k]==u)break e;break}}if(d++,b)b.push(_);else{_.from>h&&a.push(new cs(h,_.from,v));let k=_.direction==Jr!=!(v%2);iy(n,k?i+1:i,s,_.inner,_.from,_.to,a),h=_.to}S=_.to}else{if(S==t||(g?Fe[S]!=u:Fe[S]==u))break;S++}b?ny(n,h,S,i+1,s,b,a):h<S&&a.push(new cs(h,S,v)),h=S}else for(let h=t,d=l.length;h>e;){let g=!0,m=!1;if(!d||h>l[d-1].to){let _=Fe[h-1];_!=u&&(g=!1,m=_==16)}let b=!g&&u==1?[]:null,v=g?i:i+1,S=h;e:for(;;)if(d&&S==l[d-1].to){if(m)break e;let _=l[--d];if(!g)for(let k=_.from,A=d;;){if(k==e)break e;if(A&&l[A-1].to==k)k=l[--A].from;else{if(Fe[k-1]==u)break e;break}}if(b)b.push(_);else{_.to<h&&a.push(new cs(_.to,h,v));let k=_.direction==Jr!=!(v%2);iy(n,k?i+1:i,s,_.inner,_.from,_.to,a),h=_.from}S=_.from}else{if(S==e||(g?Fe[S-1]!=u:Fe[S-1]==u))break;S--}b?ny(n,S,h,i+1,s,b,a):S<h&&a.push(new cs(S,h,v)),h=S}}function iy(n,e,t,i,s,l,a){let u=e%2?2:1;MU(n,s,l,i,u),RU(n,s,l,i,u),LU(s,l,i,u),ny(n,s,l,e,t,i,a)}function NU(n,e,t){if(!n)return[new cs(0,0,e==hb?1:0)];if(e==Jr&&!t.length&&!DU.test(n))return rT(n.length);if(t.length)for(;n.length>Fe.length;)Fe[Fe.length]=256;let i=[],s=e==Jr?0:1;return iy(n,s,s,t,0,n.length,i),i}function rT(n){return[new cs(0,n,0)]}let lT="";function BU(n,e,t,i,s){var l;let a=i.head-n.from,u=cs.find(e,a,(l=i.bidiLevel)!==null&&l!==void 0?l:-1,i.assoc),h=e[u],d=h.side(s,t);if(a==d){let b=u+=s?1:-1;if(b<0||b>=e.length)return null;h=e[u=b],a=h.side(!s,t),d=h.side(s,t)}let g=Ct(n.text,a,h.forward(s,t));(g<h.from||g>h.to)&&(g=d),lT=n.text.slice(Math.min(a,g),Math.max(a,g));let m=u==(s?e.length-1:0)?null:e[u+(s?1:-1)];return m&&g==d&&m.level+(s?0:1)<h.level?P.cursor(m.side(!s,t)+n.from,m.forward(s,t)?1:-1,m.level):P.cursor(g+n.from,h.forward(s,t)?-1:1,h.level)}function UU(n,e,t){for(let i=e;i<t;i++){let s=iT(n.charCodeAt(i));if(s==1)return Jr;if(s==2||s==4)return hb}return Jr}const oT=X.define(),aT=X.define(),cT=X.define(),uT=X.define(),sy=X.define(),hT=X.define(),fT=X.define(),fb=X.define(),db=X.define(),dT=X.define({combine:n=>n.some(e=>e)}),gT=X.define({combine:n=>n.some(e=>e)}),pT=X.define();class po{constructor(e,t="nearest",i="nearest",s=5,l=5,a=!1){this.range=e,this.y=t,this.x=i,this.yMargin=s,this.xMargin=l,this.isSnapshot=a}map(e){return e.empty?this:new po(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new po(P.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Bh=_e.define({map:(n,e)=>n.map(e)}),mT=_e.define();function mn(n,e,t){let i=n.facet(uT);i.length?i[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const as=X.define({combine:n=>n.length?n[0]:!0});let jU=0;const no=X.define({combine(n){return n.filter((e,t)=>{for(let i=0;i<t;i++)if(n[i].plugin==e.plugin)return!1;return!0})}});class rt{constructor(e,t,i,s,l){this.id=e,this.create=t,this.domEventHandlers=i,this.domEventObservers=s,this.baseExtensions=l(this),this.extension=this.baseExtensions.concat(no.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(no.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:i,eventObservers:s,provide:l,decorations:a}=t||{};return new rt(jU++,e,i,s,u=>{let h=[];return a&&h.push(vd.of(d=>{let g=d.plugin(u);return g?a(g):ae.none})),l&&h.push(l(u)),h})}static fromClass(e,t){return rt.define((i,s)=>new e(i,s),t)}}class Cm{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(mn(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){mn(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){mn(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const yT=X.define(),gb=X.define(),vd=X.define(),bT=X.define(),pb=X.define(),Xc=X.define(),vT=X.define();function gx(n,e){let t=n.state.facet(vT);if(!t.length)return t;let i=t.map(l=>l instanceof Function?l(n):l),s=[];return Ee.spans(i,e.from,e.to,{point(){},span(l,a,u,h){let d=l-e.from,g=a-e.from,m=s;for(let b=u.length-1;b>=0;b--,h--){let v=u[b].spec.bidiIsolate,S;if(v==null&&(v=UU(e.text,d,g)),h>0&&m.length&&(S=m[m.length-1]).to==d&&S.direction==v)S.to=g,m=S.inner;else{let _={from:d,to:g,direction:v,inner:[]};m.push(_),m=_.inner}}}}),s}const wT=X.define();function mb(n){let e=0,t=0,i=0,s=0;for(let l of n.state.facet(wT)){let a=l(n);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(t=Math.max(t,a.right)),a.top!=null&&(i=Math.max(i,a.top)),a.bottom!=null&&(s=Math.max(s,a.bottom)))}return{left:e,right:t,top:i,bottom:s}}const Ga=X.define();class Qn{constructor(e,t,i,s){this.fromA=e,this.toA=t,this.fromB=i,this.toB=s}join(e){return new Qn(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>i.toA)){if(s.toA<i.fromA)break;i=i.join(s),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let s=0,l=0,a=0;;){let u=s<e.length?e[s].fromB:1e9,h=l<t.length?t[l]:1e9,d=Math.min(u,h);if(d==1e9)break;let g=d+a,m=d,b=g;for(;;)if(l<t.length&&t[l]<=m){let v=t[l+1];l+=2,m=Math.max(m,v);for(let S=s;S<e.length&&e[S].fromB<=m;S++)a=e[S].toA-e[S].toB;b=Math.max(b,v+a)}else if(s<e.length&&e[s].fromB<=m){let v=e[s++];m=Math.max(m,v.toB),b=Math.max(b,v.toA),a=v.toA-v.toB}else break;i.push(new Qn(g,b,d,m))}return i}}class Bf{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=At.empty(this.startState.doc.length);for(let l of i)this.changes=this.changes.compose(l.changes);let s=[];this.changes.iterChangedRanges((l,a,u,h)=>s.push(new Qn(l,a,u,h))),this.changedRanges=s}static create(e,t,i){return new Bf(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const zU=[];class St{constructor(e,t,i=0){this.dom=e,this.length=t,this.flags=i,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return zU}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let t=this.domAttrs;t&&vU(this.dom,t)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,t=this.posAtStart){let i=t;for(let s of this.children){if(s==e)return i;i+=s.length+s.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,t){return null}domPosFor(e,t){let i=ir(this.dom),s=this.length?e>0:t>0;return new di(this.parent.dom,i+(s?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof Sd)return e;return null}static get(e){return e.cmTile}}class wd extends St{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let t=this.dom,i=null,s,l=e?.node==t?e:null,a=0;for(let u of this.children){if(u.sync(e),a+=u.length+u.breakAfter,s=i?i.nextSibling:t.firstChild,l&&s!=u.dom&&(l.written=!0),u.dom.parentNode==t)for(;s&&s!=u.dom;)s=px(s);else t.insertBefore(u.dom,s);i=u.dom}for(s=i?i.nextSibling:t.firstChild,l&&s&&(l.written=!0);s;)s=px(s);this.length=a}}function px(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Sd extends wd{constructor(e,t){super(t),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let t=St.get(e);if(t&&this.owns(t))return t;e=e.parentNode}}blockTiles(e){for(let t=[],i=this,s=0,l=0;;)if(s==i.children.length){if(!t.length)return;i=i.parent,i.breakAfter&&l++,s=t.pop()}else{let a=i.children[s++];if(a instanceof Qs)t.push(s),i=a,s=0;else{let u=l+a.length,h=e(a,l);if(h!==void 0)return h;l=u+a.breakAfter}}}resolveBlock(e,t){let i,s=-1,l,a=-1;if(this.blockTiles((u,h)=>{let d=h+u.length;if(e>=h&&e<=d){if(u.isWidget()&&t>=-1&&t<=1){if(u.flags&32)return!0;u.flags&16&&(i=void 0)}(h<e||e==d&&(t<-1?u.length:u.covers(1)))&&(!i||!u.isWidget()&&i.isWidget())&&(i=u,s=e-h),(d>e||e==h&&(t>1?u.length:u.covers(-1)))&&(!l||!u.isWidget()&&l.isWidget())&&(l=u,a=e-h)}}),!i&&!l)throw new Error("No tile at position "+e);return i&&t<0||!l?{tile:i,offset:s}:{tile:l,offset:a}}}class Qs extends wd{constructor(e,t){super(e),this.wrapper=t}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,t){let i=new Qs(t||document.createElement(e.tagName),e);return t||(i.flags|=4),i}}class Eo extends wd{constructor(e,t){super(e),this.attrs=t}isLine(){return!0}static start(e,t,i){let s=new Eo(t||document.createElement("div"),e);return(!t||!i)&&(s.flags|=4),s}get domAttrs(){return this.attrs}resolveInline(e,t,i){let s=null,l=-1,a=null,u=-1;function h(g,m){for(let b=0,v=0;b<g.children.length&&v<=m;b++){let S=g.children[b],_=v+S.length;_>=m&&(S.isComposite()?h(S,m-v):(!a||a.isHidden&&(t>0||i&&HU(a,S)))&&(_>m||S.flags&32)?(a=S,u=m-v):(v<m||S.flags&16&&!S.isHidden)&&(s=S,l=m-v)),v=_}}h(this,e);let d=(t<0?s:a)||s||a;return d?{tile:d,offset:d==s?l:u}:null}coordsIn(e,t){let i=this.resolveInline(e,t,!0);return i?i.tile.coordsIn(Math.max(0,i.offset),t):IU(this)}domIn(e,t){let i=this.resolveInline(e,t);if(i){let{tile:s,offset:l}=i;if(this.dom.contains(s.dom))return s.isText()?new di(s.dom,Math.min(s.dom.nodeValue.length,l)):s.domPosFor(l,s.flags&16?1:s.flags&32?-1:t);let a=i.tile.parent,u=!1;for(let h of a.children){if(u)return new di(h.dom,0);h==i.tile&&(u=!0)}}return new di(this.dom,0)}}function IU(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=af(e);return t[t.length-1]||null}function HU(n,e){let t=n.coordsIn(0,1),i=e.coordsIn(0,1);return t&&i&&i.top<t.bottom}class pn extends wd{constructor(e,t){super(e),this.mark=t}get domAttrs(){return this.mark.attrs}static of(e,t){let i=new pn(t||document.createElement(e.tagName),e);return t||(i.flags|=4),i}}class zr extends St{constructor(e,t){super(e,t.length),this.text=t}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,t){let i=this.dom.nodeValue.length;e>i&&(e=i);let s=e,l=e,a=0;e==0&&t<0||e==i&&t>=0?Z.chrome||Z.gecko||(e?(s--,a=1):l<i&&(l++,a=-1)):t<0?s--:l<i&&l++;let u=Dc(this.dom,s,l).getClientRects();if(!u.length)return null;let h=u[(a?a<0:t>=0)?0:u.length-1];return Z.safari&&!a&&h.width==0&&(h=Array.prototype.find.call(u,d=>d.width)||h),a?Nf(h,a<0):h||null}static of(e,t){let i=new zr(t||document.createTextNode(e),e);return t||(i.flags|=2),i}}class Xr extends St{constructor(e,t,i,s){super(e,t,s),this.widget=i}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,t){return this.coordsInWidget(e,t,!1)}coordsInWidget(e,t,i){let s=this.widget.coordsAt(this.dom,e,t);if(s)return s;if(i)return Nf(this.dom.getBoundingClientRect(),this.length?e==0:t<=0);{let l=this.dom.getClientRects(),a=null;if(!l.length)return null;let u=this.flags&16?!0:this.flags&32?!1:e>0;for(let h=u?l.length-1:0;a=l[h],!(e>0?h==0:h==l.length-1||a.top<a.bottom);h+=u?-1:1);return Nf(a,!u)}}get overrideDOMText(){if(!this.length)return He.empty;let{root:e}=this;if(!e)return He.empty;let t=this.posAtStart;return e.view.state.doc.slice(t,t+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,t,i,s,l){return l||(l=e.toDOM(t),e.editable||(l.contentEditable="false")),new Xr(l,i,e,s)}}class Uf extends St{constructor(e){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),super(t,0,e)}get isHidden(){return!0}get overrideDOMText(){return He.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class qU{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,t,i){let{tile:s,index:l,beforeBreak:a,parents:u}=this;for(;e||t>0;)if(s.isComposite())if(a){if(!e)break;i&&i.break(),e--,a=!1}else if(l==s.children.length){if(!e&&!u.length)break;i&&i.leave(s),a=!!s.breakAfter,{tile:s,index:l}=u.pop(),l++}else{let h=s.children[l],d=h.breakAfter;(t>0?h.length<=e:h.length<e)&&(!i||i.skip(h,0,h.length)!==!1||!h.isComposite)?(a=!!d,l++,e-=h.length):(u.push({tile:s,index:l}),s=h,l=0,i&&h.isComposite()&&i.enter(h))}else if(l==s.length)a=!!s.breakAfter,{tile:s,index:l}=u.pop(),l++;else if(e){let h=Math.min(e,s.length-l);i&&i.skip(s,l,l+h),e-=h,l+=h}else break;return this.tile=s,this.index=l,this.beforeBreak=a,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class VU{constructor(e,t,i,s){this.from=e,this.to=t,this.wrapper=i,this.rank=s}}class $U{constructor(e,t,i){this.cache=e,this.root=t,this.blockWrappers=i,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,t,i,s){var l;this.flushBuffer();let a=this.ensureMarks(t,i),u=a.lastChild;if(u&&u.isText()&&!(u.flags&8)&&u.length+e.length<512){this.cache.reused.set(u,2);let h=a.children[a.children.length-1]=new zr(u.dom,u.text+e);h.parent=a}else a.append(s||zr.of(e,(l=this.cache.find(zr))===null||l===void 0?void 0:l.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,t){let i=this.curLine;i.dom!=t.line.dom&&(i.setDOM(this.cache.reused.has(t.line)?Tm(t.line.dom):t.line.dom),this.cache.reused.set(t.line,2));let s=i;for(let u=t.marks.length-1;u>=0;u--){let h=t.marks[u],d=s.lastChild;if(d instanceof pn&&d.mark.eq(h.mark))d.dom!=h.dom&&d.setDOM(Tm(h.dom)),s=d;else{if(this.cache.reused.get(h)){let m=St.get(h.dom);m&&m.setDOM(Tm(h.dom))}let g=pn.of(h.mark,h.dom);s.append(g),s=g}this.cache.reused.set(h,2)}let l=St.get(e.text);l&&this.cache.reused.set(l,2);let a=new zr(e.text,e.text.nodeValue);a.flags|=8,s.append(a)}addInlineWidget(e,t,i){let s=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);s||this.flushBuffer();let l=this.ensureMarks(t,i);!s&&!(e.flags&16)&&l.append(this.getBuffer(1)),l.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,t,i){this.flushBuffer(),this.ensureMarks(t,i).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let t=this.afterWidget||this.lastBlock;t.length+=e,this.pos+=e}addLineStart(e,t){var i;e||(e=ST);let s=Eo.start(e,t||((i=this.cache.find(Eo))===null||i===void 0?void 0:i.dom),!!t);this.getBlockPos().append(this.lastBlock=this.curLine=s)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,t){var i;let s=this.curLine;for(let l=e.length-1;l>=0;l--){let a=e[l],u;if(t>0&&(u=s.lastChild)&&u instanceof pn&&u.mark.eq(a))s=u,t--;else{let h=pn.of(a,(i=this.cache.find(pn,d=>d.mark.eq(a)))===null||i===void 0?void 0:i.dom);s.append(h),s=h,t=0}}return s}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!mx(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(Z.ios&&mx(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(Em,0,32)||new Xr(Em.toDOM(),0,Em,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let t=new VU(e.from,e.to,e.value,e.rank),i=this.wrappers.length;for(;i>0&&(this.wrappers[i-1].rank-t.rank||this.wrappers[i-1].to-t.to)<0;)i--;this.wrappers.splice(i,0,t)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let t=this.root;for(let i of this.wrappers){let s=t.lastChild;if(i.from<this.pos&&s instanceof Qs&&s.wrapper.eq(i.wrapper))t=s;else{let l=Qs.of(i.wrapper,(e=this.cache.find(Qs,a=>a.wrapper.eq(i.wrapper)))===null||e===void 0?void 0:e.dom);t.append(l),t=l}}return t}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let t=2|(e<0?16:32),i=this.cache.find(Uf,void 0,1);return i&&(i.flags=t),i||new Uf(t)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class PU{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:s,lineBreak:l,done:a}=this.cursor.next(this.skipCount);if(this.skipCount=0,a)throw new Error("Ran out of text content when drawing inline views");this.text=s;let u=this.textOff=Math.min(e,s.length);return l?null:s.slice(0,u)}let t=Math.min(this.text.length,this.textOff+e),i=this.text.slice(this.textOff,t);return this.textOff=t,i}}const jf=[Xr,Eo,zr,pn,Uf,Qs,Sd];for(let n=0;n<jf.length;n++)jf[n].bucket=n;class GU{constructor(e){this.view=e,this.buckets=jf.map(()=>[]),this.index=jf.map(()=>0),this.reused=new Map}add(e){let t=e.constructor.bucket,i=this.buckets[t];i.length<6?i.push(e):i[this.index[t]=(this.index[t]+1)%6]=e}find(e,t,i=2){let s=e.bucket,l=this.buckets[s],a=this.index[s];for(let u=l.length-1;u>=0;u--){let h=(u+a)%l.length,d=l[h];if((!t||t(d))&&!this.reused.has(d))return l.splice(h,1),h<a&&this.index[s]--,this.reused.set(d,i),d}return null}findWidget(e,t,i){let s=this.buckets[0];if(s.length)for(let l=0,a=0;;l++){if(l==s.length){if(a)return null;a=1,l=0}let u=s[l];if(!this.reused.has(u)&&(a==0?u.widget.compare(e):u.widget.constructor==e.constructor&&e.updateDOM(u.dom,this.view)))return s.splice(l,1),l<this.index[0]&&this.index[0]--,u.widget==e&&u.length==t&&(u.flags&497)==i?(this.reused.set(u,1),u):(this.reused.set(u,2),new Xr(u.dom,t,e,u.flags&-498|i))}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,t=2){if(!this.reused.has(e))return this.reused.set(e,t),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class KU{constructor(e,t,i,s,l){this.view=e,this.decorations=s,this.disallowBlockEffectsFor=l,this.openWidget=!1,this.openMarks=0,this.cache=new GU(e),this.text=new PU(e.state.doc),this.builder=new $U(this.cache,new Sd(e,e.contentDOM),Ee.iter(i)),this.cache.reused.set(t,2),this.old=new qU(t),this.reuseWalker={skip:(a,u,h)=>{if(this.cache.add(a),a.isComposite())return!1},enter:a=>this.cache.add(a),leave:()=>{},break:()=>{}}}run(e,t){let i=t&&this.getCompositionContext(t.text);for(let s=0,l=0,a=0;;){let u=a<e.length?e[a++]:null,h=u?u.fromA:this.old.root.length;if(h>s){let d=h-s;this.preserve(d,!a,!u),s=h,l+=d}if(!u)break;t&&u.fromA<=t.range.fromA&&u.toA>=t.range.toA?(this.forward(u.fromA,t.range.fromA,t.range.fromA<t.range.toA?1:-1),this.emit(l,t.range.fromB),this.cache.clear(),this.builder.addComposition(t,i),this.text.skip(t.range.toB-t.range.fromB),this.forward(t.range.fromA,u.toA),this.emit(t.range.toB,u.toB)):(this.forward(u.fromA,u.toA),this.emit(l,u.toB)),l=u.toB,s=u.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,t,i){let s=FU(this.old),l=this.openMarks;this.old.advance(e,i?1:-1,{skip:(a,u,h)=>{if(a.isWidget())if(this.openWidget)this.builder.continueWidget(h-u);else{let d=h>0||u<a.length?Xr.of(a.widget,this.view,h-u,a.flags&496,this.cache.maybeReuse(a)):this.cache.reuse(a);d.flags&256?(d.flags&=-2,this.builder.addBlockWidget(d)):(this.builder.ensureLine(null),this.builder.addInlineWidget(d,s,l),l=s.length)}else if(a.isText())this.builder.ensureLine(null),!u&&h==a.length?this.builder.addText(a.text,s,l,this.cache.reuse(a)):(this.cache.add(a),this.builder.addText(a.text.slice(u,h),s,l)),l=s.length;else if(a.isLine())a.flags&=-2,this.cache.reused.set(a,1),this.builder.addLine(a);else if(a instanceof Uf)this.cache.add(a);else if(a instanceof pn)this.builder.ensureLine(null),this.builder.addMark(a,s,l),this.cache.reused.set(a,1),l=s.length;else return!1;this.openWidget=!1},enter:a=>{a.isLine()?this.builder.addLineStart(a.attrs,this.cache.maybeReuse(a)):(this.cache.add(a),a instanceof pn&&s.unshift(a.mark)),this.openWidget=!1},leave:a=>{a.isLine()?s.length&&(s.length=l=0):a instanceof pn&&(s.shift(),l=Math.min(l,s.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,t){let i=null,s=this.builder,l=0,a=Ee.spans(this.decorations,e,t,{point:(u,h,d,g,m,b)=>{if(d instanceof Fr){if(this.disallowBlockEffectsFor[b]){if(d.block)throw new RangeError("Block decorations may not be specified via plugins");if(h>this.view.state.doc.lineAt(u).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(l=g.length,m>g.length)s.continueWidget(h-u);else{let v=d.widget||(d.block?Oo.block:Oo.inline),S=WU(d),_=this.cache.findWidget(v,h-u,S)||Xr.of(v,this.view,h-u,S);d.block?(d.startSide>0&&s.addLineStartIfNotCovered(i),s.addBlockWidget(_)):(s.ensureLine(i),s.addInlineWidget(_,g,m))}i=null}else i=YU(i,d);h>u&&this.text.skip(h-u)},span:(u,h,d,g)=>{for(let m=u;m<h;){let b=this.text.next(Math.min(512,h-m));b==null?(s.addLineStartIfNotCovered(i),s.addBreak(),m++):(s.ensureLine(i),s.addText(b,d,m==u?g:d.length),m+=b.length),i=null}}});s.addLineStartIfNotCovered(i),this.openWidget=a>l,this.openMarks=a}forward(e,t,i=1){t-e<=10?this.old.advance(t-e,i,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(t-e-10,-1),this.old.advance(5,i,this.reuseWalker))}getCompositionContext(e){let t=[],i=null;for(let s=e.parentNode;;s=s.parentNode){let l=St.get(s);if(s==this.view.contentDOM)break;l instanceof pn?t.push(l):l?.isLine()?i=l:s.nodeName=="DIV"&&!i&&s!=this.view.contentDOM?i=new Eo(s,ST):t.push(pn.of(new Fc({tagName:s.nodeName.toLowerCase(),attributes:wU(s)}),s))}return{line:i,marks:t}}}function mx(n,e){let t=i=>{for(let s of i.children)if((e?s.isText():s.length)||t(s))return!0;return!1};return t(n)}function WU(n){let e=n.isReplace?(n.startSide<0?64:0)|(n.endSide>0?128:0):n.startSide>0?32:16;return n.block&&(e|=256),e}const ST={class:"cm-line"};function YU(n,e){let t=e.spec.attributes,i=e.spec.class;return!t&&!i||(n||(n={class:"cm-line"}),t&&cb(t,n),i&&(n.class+=" "+i)),n}function FU(n){let e=[];for(let t=n.parents.length;t>1;t--){let i=t==n.parents.length?n.tile:n.parents[t].tile;i instanceof pn&&e.push(i.mark)}return e}function Tm(n){let e=St.get(n);return e&&e.setDOM(n.cloneNode()),n}class Oo extends Vi{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Oo.inline=new Oo("span");Oo.block=new Oo("div");const Em=new class extends Vi{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class yx{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=ae.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new Sd(e,e.contentDOM),this.updateInner([new Qn(0,0,0,e.state.doc.length)],null)}update(e){var t;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:g,toA:m})=>m<this.minWidthFrom||g>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?s=this.domChanged.newSel.head:!s8(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let l=s>-1?XU(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){let{from:g,to:m}=this.hasComposition;i=new Qn(g,m,e.changes.mapPos(g,-1),e.changes.mapPos(m,1)).addToSet(i.slice())}this.hasComposition=l?{from:l.range.fromB,to:l.range.toB}:null,(Z.ie||Z.chrome)&&!l&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,u=this.blockWrappers;this.updateDeco();let h=e8(a,this.decorations,e.changes);h.length&&(i=Qn.extendWithRanges(i,h));let d=n8(u,this.blockWrappers,e.changes);return d.length&&(i=Qn.extendWithRanges(i,d)),l&&!i.some(g=>g.fromA<=l.range.fromA&&g.toA>=l.range.toA)&&(i=l.range.addToSet(i.slice())),this.tile.flags&2&&i.length==0?!1:(this.updateInner(i,l),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0;let{observer:i}=this.view;i.ignore(()=>{if(t||e.length){let a=this.tile,u=new KU(this.view,a,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=u.run(e,t),ry(a,u.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let l=Z.chrome||Z.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(l),l&&(l.written||i.selectionRange.focusNode!=l.node||!this.tile.dom.contains(l.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let l of this.tile.children)l.isWidget()&&l.widget instanceof Om&&s.push(l.dom);i.updateGaps(s)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let i of t.effects)i.is(mT)&&(this.editContextFormatting=i.value)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:i}=this.tile,s=this.view.root.activeElement,l=s==i,a=!l&&!(this.view.state.facet(as)||i.tabIndex>-1)&&tc(i,this.view.observer.selectionRange)&&!(s&&i.contains(s));if(!(l||t||a))return;let u=this.forceSelection;this.forceSelection=!1;let h=this.view.state.selection.main,d,g;if(h.empty?g=d=this.inlineDOMNearPos(h.anchor,h.assoc||1):(g=this.inlineDOMNearPos(h.head,h.head==h.from?1:-1),d=this.inlineDOMNearPos(h.anchor,h.anchor==h.from?1:-1)),Z.gecko&&h.empty&&!this.hasComposition&&JU(d)){let b=document.createTextNode("");this.view.observer.ignore(()=>d.node.insertBefore(b,d.node.childNodes[d.offset]||null)),d=g=new di(b,0),u=!0}let m=this.view.observer.selectionRange;(u||!m.focusNode||(!nc(d.node,d.offset,m.anchorNode,m.anchorOffset)||!nc(g.node,g.offset,m.focusNode,m.focusOffset))&&!this.suppressWidgetCursorChange(m,h))&&(this.view.observer.ignore(()=>{Z.android&&Z.chrome&&i.contains(m.focusNode)&&i8(m.focusNode,i)&&(i.blur(),i.focus({preventScroll:!0}));let b=To(this.view.root);if(b)if(h.empty){if(Z.gecko){let v=QU(d.node,d.offset);if(v&&v!=3){let S=(v==1?eT:tT)(d.node,d.offset);S&&(d=new di(S.node,S.offset))}}b.collapse(d.node,d.offset),h.bidiLevel!=null&&b.caretBidiLevel!==void 0&&(b.caretBidiLevel=h.bidiLevel)}else if(b.extend){b.collapse(d.node,d.offset);try{b.extend(g.node,g.offset)}catch{}}else{let v=document.createRange();h.anchor>h.head&&([d,g]=[g,d]),v.setEnd(g.node,g.offset),v.setStart(d.node,d.offset),b.removeAllRanges(),b.addRange(v)}a&&this.view.root.activeElement==i&&(i.blur(),s&&s.focus())}),this.view.observer.setSelectionRange(d,g)),this.impreciseAnchor=d.precise?null:new di(m.anchorNode,m.anchorOffset),this.impreciseHead=g.precise?null:new di(m.focusNode,m.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&nc(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,i=To(e.root),{anchorNode:s,anchorOffset:l}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let a=this.lineAt(t.head,t.assoc);if(!a)return;let u=a.posAtStart;if(t.head==u||t.head==u+a.length)return;let h=this.coordsAt(t.head,-1),d=this.coordsAt(t.head,1);if(!h||!d||h.bottom>d.top)return;let g=this.domAtPos(t.head+t.assoc,t.assoc);i.collapse(g.node,g.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let m=e.observer.selectionRange;e.docView.posFromDOM(m.anchorNode,m.anchorOffset)!=t.from&&i.collapse(s,l)}posFromDOM(e,t){let i=this.tile.nearest(e);if(!i)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let s=i.posAtStart;if(i.isComposite()){let l;if(e==i.dom)l=i.dom.childNodes[t];else{let a=ds(e)==0?0:t==0?-1:1;for(;;){let u=e.parentNode;if(u==i.dom)break;a==0&&u.firstChild!=u.lastChild&&(e==u.firstChild?a=-1:a=1),e=u}a<0?l=e:l=e.nextSibling}if(l==i.dom.firstChild)return s;for(;l&&!St.get(l);)l=l.nextSibling;if(!l)return s+i.length;for(let a=0,u=s;;a++){let h=i.children[a];if(h.dom==l)return u;u+=h.length+h.breakAfter}}else return i.isText()?e==i.dom?s+t:s+(t?i.length:0):s}domAtPos(e,t){let{tile:i,offset:s}=this.tile.resolveBlock(e,t);return i.isWidget()?i.domPosFor(e,t):i.domIn(s,t)}inlineDOMNearPos(e,t){let i,s=-1,l=!1,a,u=-1,h=!1;return this.tile.blockTiles((d,g)=>{if(d.isWidget()){if(d.flags&32&&g>=e)return!0;d.flags&16&&(l=!0)}else{let m=g+d.length;if(g<=e&&(i=d,s=e-g,l=m<e),m>=e&&!a&&(a=d,u=e-g,h=g>e),g>e&&a)return!0}}),!i&&!a?this.domAtPos(e,t):(l&&a?i=null:h&&i&&(a=null),i&&t<0||!a?i.domIn(s,t):a.domIn(u,t))}coordsAt(e,t){let{tile:i,offset:s}=this.tile.resolveBlock(e,t);return i.isWidget()?i.widget instanceof Om?null:i.coordsInWidget(s,t,!0):i.coordsIn(s,t)}lineAt(e,t){let{tile:i}=this.tile.resolveBlock(e,t);return i.isLine()?i:null}coordsForChar(e){let{tile:t,offset:i}=this.tile.resolveBlock(e,1);if(!t.isLine())return null;function s(l,a){if(l.isComposite())for(let u of l.children){if(u.length>=a){let h=s(u,a);if(h)return h}if(a-=u.length,a<0)break}else if(l.isText()&&a<l.length){let u=Ct(l.text,a);if(u==a)return null;let h=Dc(l.dom,a,u).getClientRects();for(let d=0;d<h.length;d++){let g=h[d];if(d==h.length-1||g.top<g.bottom&&g.left<g.right)return g}}return null}return s(t,i)}measureVisibleLineHeights(e){let t=[],{from:i,to:s}=e,l=this.view.contentDOM.clientWidth,a=l>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,u=-1,h=this.view.textDirection==Qe.LTR,d=0,g=(m,b,v)=>{for(let S=0;S<m.children.length&&!(b>s);S++){let _=m.children[S],k=b+_.length,A=_.dom.getBoundingClientRect(),{height:M}=A;if(v&&!S&&(d+=A.top-v.top),_ instanceof Qs)k>i&&g(_,b,A);else if(b>=i&&(d>0&&t.push(-d),t.push(M+d),d=0,a)){let O=_.dom.lastChild,z=O?af(O):[];if(z.length){let q=z[z.length-1],V=h?q.right-A.left:A.right-q.left;V>u&&(u=V,this.minWidth=l,this.minWidthFrom=b,this.minWidthTo=k)}}v&&S==m.children.length-1&&(d+=v.bottom-A.bottom),b=k+_.breakAfter}};return g(this.tile,0,null),t}textDirectionAt(e){let{tile:t}=this.tile.resolveBlock(e,1);return getComputedStyle(t.dom).direction=="rtl"?Qe.RTL:Qe.LTR}measureTextSize(){let e=this.tile.blockTiles(a=>{if(a.isLine()&&a.children.length&&a.length<=20){let u=0,h;for(let d of a.children){if(!d.isText()||/[^ -~]/.test(d.text))return;let g=af(d.dom);if(g.length!=1)return;u+=g[0].width,h=g[0].height}if(u)return{lineHeight:a.dom.getBoundingClientRect().height,charWidth:u/a.length,textHeight:h}}});if(e)return e;let t=document.createElement("div"),i,s,l;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(t);let a=af(t.firstChild)[0];i=t.getBoundingClientRect().height,s=a&&a.width?a.width/27:7,l=a&&a.height?a.height:i,t.remove()}),{lineHeight:i,charWidth:s,textHeight:l}}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,s=0;;s++){let l=s==t.viewports.length?null:t.viewports[s],a=l?l.from-1:this.view.state.doc.length;if(a>i){let u=(t.lineBlockAt(a).bottom-t.lineBlockAt(i).top)/this.view.scaleY;e.push(ae.replace({widget:new Om(u),block:!0,inclusive:!0,isBlockGap:!0}).range(i,a))}if(!l)break;i=l.to+1}return ae.set(e)}updateDeco(){let e=1,t=this.view.state.facet(vd).map(l=>(this.dynamicDecorationMap[e++]=typeof l=="function")?l(this.view):l),i=!1,s=this.view.state.facet(pb).map((l,a)=>{let u=typeof l=="function";return u&&(i=!0),u?l(this.view):l});for(s.length&&(this.dynamicDecorationMap[e++]=i,t.push(Ee.join(s))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(bT).map(l=>typeof l=="function"?l(this.view):l)}scrollIntoView(e){if(e.isSnapshot){let d=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=d.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let d of this.view.state.facet(pT))try{if(d(this.view,e.range,e))return!0}catch(g){mn(this.view.state,g,"scroll handler")}let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!i)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,s.left),top:Math.min(i.top,s.top),right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)});let l=mb(this.view),a={left:i.left-l.left,top:i.top-l.top,right:i.right+l.right,bottom:i.bottom+l.bottom},{offsetWidth:u,offsetHeight:h}=this.view.scrollDOM;xU(this.view.scrollDOM,a,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,u),-u),Math.max(Math.min(e.yMargin,h),-h),this.view.textDirection==Qe.LTR)}lineHasWidget(e){let t=i=>i.isWidget()||i.children.some(t);return t(this.tile.resolveBlock(e,1).tile)}destroy(){ry(this.tile)}}function ry(n,e){let t=e?.get(n);if(t!=1){t==null&&n.destroy();for(let i of n.children)ry(i,e)}}function JU(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function _T(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let i=eT(t.focusNode,t.focusOffset),s=tT(t.focusNode,t.focusOffset),l=i||s;if(s&&i&&s.node!=i.node){let u=St.get(s.node);if(!u||u.isText()&&u.text!=s.node.nodeValue)l=s;else if(n.docView.lastCompositionAfterCursor){let h=St.get(i.node);!h||h.isText()&&h.text!=i.node.nodeValue||(l=s)}}if(n.docView.lastCompositionAfterCursor=l!=i,!l)return null;let a=e-l.offset;return{from:a,to:a+l.node.nodeValue.length,node:l.node}}function XU(n,e,t){let i=_T(n,t);if(!i)return null;let{node:s,from:l,to:a}=i,u=s.nodeValue;if(/[\n\r]/.test(u)||n.state.doc.sliceString(i.from,i.to)!=u)return null;let h=e.invertedDesc;return{range:new Qn(h.mapPos(l),h.mapPos(a),l,a),text:s}}function QU(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let ZU=class{constructor(){this.changes=[]}compareRange(e,t){fo(e,t,this.changes)}comparePoint(e,t){fo(e,t,this.changes)}boundChange(e){fo(e,e,this.changes)}};function e8(n,e,t){let i=new ZU;return Ee.compare(n,e,t,i),i.changes}class t8{constructor(){this.changes=[]}compareRange(e,t){fo(e,t,this.changes)}comparePoint(){}boundChange(e){fo(e,e,this.changes)}}function n8(n,e,t){let i=new t8;return Ee.compare(n,e,t,i),i.changes}function i8(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function s8(n,e){let t=!1;return e&&n.iterChangedRanges((i,s)=>{i<e.to&&s>e.from&&(t=!0)}),t}class Om extends Vi{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function r8(n,e,t=1){let i=n.charCategorizer(e),s=n.doc.lineAt(e),l=e-s.from;if(s.length==0)return P.cursor(e);l==0?t=1:l==s.length&&(t=-1);let a=l,u=l;t<0?a=Ct(s.text,l,!1):u=Ct(s.text,l);let h=i(s.text.slice(a,u));for(;a>0;){let d=Ct(s.text,a,!1);if(i(s.text.slice(d,a))!=h)break;a=d}for(;u<s.length;){let d=Ct(s.text,u);if(i(s.text.slice(u,d))!=h)break;u=d}return P.range(a+s.from,u+s.from)}function l8(n,e,t,i,s){let l=Math.round((i-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let u=n.viewState.heightOracle.textHeight,h=Math.floor((s-t.top-(n.defaultLineHeight-u)*.5)/u);l+=h*n.viewState.heightOracle.lineLength}let a=n.state.sliceDoc(t.from,t.to);return t.from+W0(a,l,n.state.tabSize)}function ly(n,e,t){let i=n.lineBlockAt(e);if(Array.isArray(i.type)){let s;for(let l of i.type){if(l.from>e)break;if(!(l.to<e)){if(l.from<e&&l.to>e)return l;(!s||l.type==Gt.Text&&(s.type!=l.type||(t<0?l.from<e:l.to>e)))&&(s=l)}}return s||i}return i}function o8(n,e,t,i){let s=ly(n,e.head,e.assoc||-1),l=!i||s.type!=Gt.Text||!(n.lineWrapping||s.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(l){let a=n.dom.getBoundingClientRect(),u=n.textDirectionAt(s.from),h=n.posAtCoords({x:t==(u==Qe.LTR)?a.right-1:a.left+1,y:(l.top+l.bottom)/2});if(h!=null)return P.cursor(h,t?-1:1)}return P.cursor(t?s.to:s.from,t?-1:1)}function bx(n,e,t,i){let s=n.state.doc.lineAt(e.head),l=n.bidiSpans(s),a=n.textDirectionAt(s.from);for(let u=e,h=null;;){let d=BU(s,l,a,u,t),g=lT;if(!d){if(s.number==(t?n.state.doc.lines:1))return u;g=`
`,s=n.state.doc.line(s.number+(t?1:-1)),l=n.bidiSpans(s),d=n.visualLineSide(s,!t)}if(h){if(!h(g))return u}else{if(!i)return d;h=i(g)}u=d}}function a8(n,e,t){let i=n.state.charCategorizer(e),s=i(t);return l=>{let a=i(l);return s==st.Space&&(s=a),s==a}}function c8(n,e,t,i){let s=e.head,l=t?1:-1;if(s==(t?n.state.doc.length:0))return P.cursor(s,e.assoc);let a=e.goalColumn,u,h=n.contentDOM.getBoundingClientRect(),d=n.coordsAtPos(s,e.assoc||-1),g=n.documentTop;if(d)a==null&&(a=d.left-h.left),u=l<0?d.top:d.bottom;else{let S=n.viewState.lineBlockAt(s);a==null&&(a=Math.min(h.right-h.left,n.defaultCharacterWidth*(s-S.from))),u=(l<0?S.top:S.bottom)+g}let m=h.left+a,b=i??n.viewState.heightOracle.textHeight>>1,v=oy(n,{x:m,y:u+b*l},!1,l);return P.cursor(v.pos,v.assoc,void 0,a)}function ic(n,e,t){for(;;){let i=0;for(let s of n)s.between(e-1,e+1,(l,a,u)=>{if(e>l&&e<a){let h=i||t||(e-l<a-e?-1:1);e=h<0?l:a,i=h}});if(!i)return e}}function xT(n,e){let t=null;for(let i=0;i<e.ranges.length;i++){let s=e.ranges[i],l=null;if(s.empty){let a=ic(n,s.from,0);a!=s.from&&(l=P.cursor(a,-1))}else{let a=ic(n,s.from,-1),u=ic(n,s.to,1);(a!=s.from||u!=s.to)&&(l=P.range(s.from==s.anchor?a:u,s.from==s.head?a:u))}l&&(t||(t=e.ranges.slice()),t[i]=l)}return t?P.create(t,e.mainIndex):e}function Dm(n,e,t){let i=ic(n.state.facet(Xc).map(s=>s(n)),t.from,e.head>t.from?-1:1);return i==t.from?t:P.cursor(i,i<t.from?1:-1)}class Mi{constructor(e,t){this.pos=e,this.assoc=t}}function oy(n,e,t,i){let s=n.contentDOM.getBoundingClientRect(),l=s.top+n.viewState.paddingTop,{x:a,y:u}=e,h=u-l,d;for(;;){if(h<0)return new Mi(0,1);if(h>n.viewState.docHeight)return new Mi(n.state.doc.length,-1);if(d=n.elementAtHeight(h),i==null)break;if(d.type==Gt.Text){if(i<0?d.to<n.viewport.from:d.from>n.viewport.to)break;let b=n.docView.coordsAt(i<0?d.from:d.to,i);if(b&&(i<0?b.top<=h+l:b.bottom>=h+l))break}let m=n.viewState.heightOracle.textHeight/2;h=i>0?d.bottom+m:d.top-m}if(n.viewport.from>=d.to||n.viewport.to<=d.from){if(t)return null;if(d.type==Gt.Text){let m=l8(n,s,d,a,u);return new Mi(m,m==d.from?1:-1)}}if(d.type!=Gt.Text)return h<(d.top+d.bottom)/2?new Mi(d.from,1):new Mi(d.to,-1);let g=n.docView.lineAt(d.from,2);return(!g||g.length!=d.length)&&(g=n.docView.lineAt(d.from,-2)),kT(n,g,d.from,a,u)}function kT(n,e,t,i,s){let l=-1,a=null,u=1e9,h=1e9,d=s,g=s,m=(b,v)=>{for(let S=0;S<b.length;S++){let _=b[S];if(_.top==_.bottom)continue;let k=_.left>i?_.left-i:_.right<i?i-_.right:0,A=_.top>s?_.top-s:_.bottom<s?s-_.bottom:0;_.top<=g&&_.bottom>=d&&(d=Math.min(_.top,d),g=Math.max(_.bottom,g),A=0),(l<0||(A-h||k-u)<0)&&(l>=0&&h&&u<k&&a.top<=g-2&&a.bottom>=d+2?h=0:(l=v,u=k,h=A,a=_))}};if(e.isText()){for(let v=0;v<e.length;){let S=Ct(e.text,v);if(m(Dc(e.dom,v,S).getClientRects(),v),!u&&!h)break;v=S}return i>(a.left+a.right)/2==(vx(n,l+t)==Qe.LTR)?new Mi(t+Ct(e.text,l),-1):new Mi(t+l,1)}else{if(!e.length)return new Mi(t,1);for(let _=0;_<e.children.length;_++){let k=e.children[_];if(k.flags&48)continue;let A=(k.dom.nodeType==1?k.dom:Dc(k.dom,0,k.length)).getClientRects();if(m(A,_),!u&&!h)break}let b=e.children[l],v=e.posBefore(b,t);return b.isComposite()||b.isText()?kT(n,b,v,Math.max(a.left,Math.min(a.right,i)),s):i>(a.left+a.right)/2==(vx(n,l+t)==Qe.LTR)?new Mi(v+b.length,-1):new Mi(v,1)}}function vx(n,e){let t=n.state.doc.lineAt(e);return n.bidiSpans(t)[cs.find(n.bidiSpans(t),e-t.from,-1,1)].dir}const Ka="";class u8{constructor(e,t){this.points=e,this.view=t,this.text="",this.lineSeparator=t.state.facet(je.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Ka}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let s=e;;){this.findPointBefore(i,s);let l=this.text.length;this.readNode(s);let a=St.get(s),u=s.nextSibling;if(u==t){a?.breakAfter&&!u&&i!=this.view.contentDOM&&this.lineBreak();break}let h=St.get(u);(a&&h?a.breakAfter:(a?a.breakAfter:Lf(s))||Lf(u)&&(s.nodeName!="BR"||a?.isWidget())&&this.text.length>l)&&!f8(u,t)&&this.lineBreak(),s=u}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let l=-1,a=1,u;if(this.lineSeparator?(l=t.indexOf(this.lineSeparator,i),a=this.lineSeparator.length):(u=s.exec(t))&&(l=u.index,a=u[0].length),this.append(t.slice(i,l<0?t.length:l)),l<0)break;if(this.lineBreak(),a>1)for(let h of this.points)h.node==e&&h.pos>this.text.length&&(h.pos-=a-1);i=l+a}}readNode(e){let t=St.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let s=i.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(h8(e,i.node,i.offset)?t:0))}}function h8(n,e,t){for(;;){if(!e||t<ds(e))return!1;if(e==n)return!0;t=ir(e)+1,e=e.parentNode}}function f8(n,e){let t;for(;!(n==e||!n);n=n.nextSibling){let i=St.get(n);if(!i?.isWidget())return!1;i&&(t||(t=[])).push(i)}if(t)for(let i of t){let s=i.overrideDOMText;if(s?.length)return!1}return!0}class wx{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class d8{constructor(e,t,i,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:l,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=AT(e.docView.tile,t,i,0))){let u=l||a?[]:p8(e),h=new u8(u,e);h.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=h.text,this.newSel=m8(u,this.bounds.from)}else{let u=e.observer.selectionRange,h=l&&l.node==u.focusNode&&l.offset==u.focusOffset||!ey(e.contentDOM,u.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(u.focusNode,u.focusOffset),d=a&&a.node==u.anchorNode&&a.offset==u.anchorOffset||!ey(e.contentDOM,u.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(u.anchorNode,u.anchorOffset),g=e.viewport;if((Z.ios||Z.chrome)&&e.state.selection.main.empty&&h!=d&&(g.from>0||g.to<e.state.doc.length)){let m=Math.min(h,d),b=Math.max(h,d),v=g.from-m,S=g.to-b;(v==0||v==1||m==0)&&(S==0||S==-1||b==e.state.doc.length)&&(h=0,d=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(P.range(d,h)):this.newSel=P.single(d,h)}}}function AT(n,e,t,i){if(n.isComposite()){let s=-1,l=-1,a=-1,u=-1;for(let h=0,d=i,g=i;h<n.children.length;h++){let m=n.children[h],b=d+m.length;if(d<e&&b>t)return AT(m,e,t,d);if(b>=e&&s==-1&&(s=h,l=d),d>t&&m.dom.parentNode==n.dom){a=h,u=g;break}g=b,d=b+m.breakAfter}return{from:l,to:u<0?i+n.length:u,startDOM:(s?n.children[s-1].dom.nextSibling:null)||n.dom.firstChild,endDOM:a<n.children.length&&a>=0?n.children[a].dom:null}}else return n.isText()?{from:i,to:i+n.length,startDOM:n.dom,endDOM:n.dom.nextSibling}:null}function CT(n,e){let t,{newSel:i}=e,s=n.state.selection.main,l=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:u}=e.bounds,h=s.from,d=null;(l===8||Z.android&&e.text.length<u-a)&&(h=s.to,d="end");let g=TT(n.state.doc.sliceString(a,u,Ka),e.text,h-a,d);g&&(Z.chrome&&l==13&&g.toB==g.from+2&&e.text.slice(g.from,g.toB)==Ka+Ka&&g.toB--,t={from:a+g.from,to:a+g.toA,insert:He.of(e.text.slice(g.from,g.toB).split(Ka))})}else i&&(!n.hasFocus&&n.state.facet(as)||zf(i,s))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!s.empty&&i&&i.main.empty?t={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,s.to)}:(Z.mac||Z.android)&&t&&t.from==t.to&&t.from==s.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=P.single(i.main.anchor-1,i.main.head-1)),t={from:t.from,to:t.to,insert:He.of([t.insert.toString().replace("."," ")])}):t&&t.from>=s.from&&t.to<=s.to&&(t.from!=s.from||t.to!=s.to)&&s.to-s.from-(t.to-t.from)<=4?t={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,s.to))}:n.state.doc.lineAt(s.from).to<s.to&&n.docView.lineHasWidget(s.to)&&n.inputState.insertingTextAt>Date.now()-50?t={from:s.from,to:s.to,insert:n.state.toText(n.inputState.insertingText)}:Z.chrome&&t&&t.from==t.to&&t.from==s.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(i&&(i=P.single(i.main.anchor-1,i.main.head-1)),t={from:s.from,to:s.to,insert:He.of([" "])}),t)return yb(n,t,i,l);if(i&&!zf(i,s)){let a=!1,u="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(a=!0),u=n.inputState.lastSelectionOrigin,u=="select.pointer"&&(i=xT(n.state.facet(Xc).map(h=>h(n)),i))),n.dispatch({selection:i,scrollIntoView:a,userEvent:u}),!0}else return!1}function yb(n,e,t,i=-1){if(Z.ios&&n.inputState.flushIOSKey(e))return!0;let s=n.state.selection.main;if(Z.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&n.state.sliceDoc(e.from,s.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&go(n.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>s.head)&&go(n.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&e.insert.length==0&&go(n.contentDOM,"Delete",46)))return!0;let l=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let a,u=()=>a||(a=g8(n,e,t));return n.state.facet(hT).some(h=>h(n,e.from,e.to,l,u))||n.dispatch(u()),!0}function g8(n,e,t){let i,s=n.state,l=s.selection.main,a=-1;if(e.from==e.to&&e.from<l.from||e.from>l.to){let h=e.from<l.from?-1:1,d=h<0?l.from:l.to,g=ic(s.facet(Xc).map(m=>m(n)),d,h);e.from==g&&(a=g)}if(a>-1)i={changes:e,selection:P.cursor(e.from+e.insert.length,-1)};else if(e.from>=l.from&&e.to<=l.to&&e.to-e.from>=(l.to-l.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let h=l.from<e.from?s.sliceDoc(l.from,e.from):"",d=l.to>e.to?s.sliceDoc(e.to,l.to):"";i=s.replaceSelection(n.state.toText(h+e.insert.sliceString(0,void 0,n.state.lineBreak)+d))}else{let h=s.changes(e),d=t&&t.main.to<=h.newLength?t.main:void 0;if(s.selection.ranges.length>1&&(n.inputState.composing>=0||n.inputState.compositionPendingChange)&&e.to<=l.to+10&&e.to>=l.to-10){let g=n.state.sliceDoc(e.from,e.to),m,b=t&&_T(n,t.main.head);if(b){let S=e.insert.length-(e.to-e.from);m={from:b.from,to:b.to-S}}else m=n.state.doc.lineAt(l.head);let v=l.to-e.to;i=s.changeByRange(S=>{if(S.from==l.from&&S.to==l.to)return{changes:h,range:d||S.map(h)};let _=S.to-v,k=_-g.length;if(n.state.sliceDoc(k,_)!=g||_>=m.from&&k<=m.to)return{range:S};let A=s.changes({from:k,to:_,insert:e.insert}),M=S.to-l.to;return{changes:A,range:d?P.range(Math.max(0,d.anchor+M),Math.max(0,d.head+M)):S.map(A)}})}else i={changes:h,selection:d&&s.selection.replaceRange(d)}}let u="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,u+=".compose",n.inputState.compositionFirstChange&&(u+=".start",n.inputState.compositionFirstChange=!1)),s.update(i,{userEvent:u,scrollIntoView:!0})}function TT(n,e,t,i){let s=Math.min(n.length,e.length),l=0;for(;l<s&&n.charCodeAt(l)==e.charCodeAt(l);)l++;if(l==s&&n.length==e.length)return null;let a=n.length,u=e.length;for(;a>0&&u>0&&n.charCodeAt(a-1)==e.charCodeAt(u-1);)a--,u--;if(i=="end"){let h=Math.max(0,l-Math.min(a,u));t-=a+h-l}if(a<l&&n.length<e.length){let h=t<=l&&t>=a?l-t:0;l-=h,u=l+(u-a),a=l}else if(u<l){let h=t<=l&&t>=u?l-t:0;l-=h,a=l+(a-u),u=l}return{from:l,toA:a,toB:u}}function p8(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:l}=n.observer.selectionRange;return t&&(e.push(new wx(t,i)),(s!=t||l!=i)&&e.push(new wx(s,l))),e}function m8(n,e){if(n.length==0)return null;let t=n[0].pos,i=n.length==2?n[1].pos:t;return t>-1&&i>-1?P.single(t+e,i+e):null}function zf(n,e){return e.head==n.main.head&&e.anchor==n.main.anchor}class y8{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Z.safari&&e.contentDOM.addEventListener("input",()=>null),Z.gecko&&R8(e.contentDOM.ownerDocument)}handleEvent(e){!A8(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let i=this.handlers[e];if(i){for(let s of i.observers)s(this.view,t);for(let s of i.handlers){if(t.defaultPrevented)break;if(s(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=b8(e),i=this.handlers,s=this.view.contentDOM;for(let l in t)if(l!="scroll"){let a=!t[l].handlers.length,u=i[l];u&&a!=!u.handlers.length&&(s.removeEventListener(l,this.handleEvent),u=null),u||s.addEventListener(l,this.handleEvent,{passive:a})}for(let l in i)l!="scroll"&&!t[l]&&s.removeEventListener(l,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&OT.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Z.android&&Z.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return Z.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=ET.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||v8.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,go(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:Z.safari&&!Z.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Sx(n,e){return(t,i)=>{try{return e.call(n,i,t)}catch(s){mn(t.state,s)}}}function b8(n){let e=Object.create(null);function t(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of n){let s=i.spec,l=s&&s.plugin.domEventHandlers,a=s&&s.plugin.domEventObservers;if(l)for(let u in l){let h=l[u];h&&t(u).handlers.push(Sx(i.value,h))}if(a)for(let u in a){let h=a[u];h&&t(u).observers.push(Sx(i.value,h))}}for(let i in mi)t(i).handlers.push(mi[i]);for(let i in ni)t(i).observers.push(ni[i]);return e}const ET=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],v8="dthko",OT=[16,17,18,20,91,92,224,225],Uh=6;function jh(n){return Math.max(0,n)*.7+8}function w8(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class S8{constructor(e,t,i,s){this.view=e,this.startEvent=t,this.style=i,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=kU(e.contentDOM),this.atoms=e.state.facet(Xc).map(a=>a(e));let l=e.contentDOM.ownerDocument;l.addEventListener("mousemove",this.move=this.move.bind(this)),l.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(je.allowMultipleSelections)&&_8(e,t),this.dragging=k8(e,t)&&RT(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&w8(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,i=0,s=0,l=0,a=this.view.win.innerWidth,u=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:l,bottom:u}=this.scrollParents.y.getBoundingClientRect());let h=mb(this.view);e.clientX-h.left<=s+Uh?t=-jh(s-e.clientX):e.clientX+h.right>=a-Uh&&(t=jh(e.clientX-a)),e.clientY-h.top<=l+Uh?i=-jh(l-e.clientY):e.clientY+h.bottom>=u-Uh&&(i=jh(e.clientY-u)),this.setScrollSpeed(t,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,i=xT(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function _8(n,e){let t=n.state.facet(oT);return t.length?t[0](e):Z.mac?e.metaKey:e.ctrlKey}function x8(n,e){let t=n.state.facet(aT);return t.length?t[0](e):Z.mac?!e.altKey:!e.ctrlKey}function k8(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let i=To(n.root);if(!i||i.rangeCount==0)return!0;let s=i.getRangeAt(0).getClientRects();for(let l=0;l<s.length;l++){let a=s[l];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function A8(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=St.get(t))&&i.isWidget()&&!i.isHidden&&i.widget.ignoreEvent(e))return!1;return!0}const mi=Object.create(null),ni=Object.create(null),DT=Z.ie&&Z.ie_version<15||Z.ios&&Z.webkit_version<604;function C8(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),MT(n,t.value)},50)}function _d(n,e,t){for(let i of n.facet(e))t=i(t,n);return t}function MT(n,e){e=_d(n.state,fb,e);let{state:t}=n,i,s=1,l=t.toText(e),a=l.lines==t.selection.ranges.length;if(ay!=null&&t.selection.ranges.every(h=>h.empty)&&ay==l.toString()){let h=-1;i=t.changeByRange(d=>{let g=t.doc.lineAt(d.from);if(g.from==h)return{range:d};h=g.from;let m=t.toText((a?l.line(s++).text:e)+t.lineBreak);return{changes:{from:g.from,insert:m},range:P.cursor(d.from+m.length)}})}else a?i=t.changeByRange(h=>{let d=l.line(s++);return{changes:{from:h.from,to:h.to,insert:d.text},range:P.cursor(h.from+d.length)}}):i=t.replaceSelection(l);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}ni.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};mi.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);ni.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};ni.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};mi.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let i of n.state.facet(cT))if(t=i(n,e),t)break;if(!t&&e.button==0&&(t=E8(n,e)),t){let i=!n.hasFocus;n.inputState.startMouseSelection(new S8(n,e,t,i)),i&&n.observer.ignore(()=>{QC(n.contentDOM);let l=n.root.activeElement;l&&!l.contains(n.contentDOM)&&l.blur()});let s=n.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}else n.inputState.setSelectionOrigin("select.pointer");return!1};function _x(n,e,t,i){if(i==1)return P.cursor(e,t);if(i==2)return r8(n.state,e,t);{let s=n.docView.lineAt(e,t),l=n.state.doc.lineAt(s?s.posAtEnd:e),a=s?s.posAtStart:l.from,u=s?s.posAtEnd:l.to;return u<n.state.doc.length&&u==l.to&&u++,P.range(a,u)}}const T8=Z.ie&&Z.ie_version<=11;let xx=null,kx=0,Ax=0;function RT(n){if(!T8)return n.detail;let e=xx,t=Ax;return xx=n,Ax=Date.now(),kx=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(kx+1)%3:1}function E8(n,e){let t=n.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),i=RT(e),s=n.state.selection;return{update(l){l.docChanged&&(t.pos=l.changes.mapPos(t.pos),s=s.map(l.changes))},get(l,a,u){let h=n.posAndSideAtCoords({x:l.clientX,y:l.clientY},!1),d,g=_x(n,h.pos,h.assoc,i);if(t.pos!=h.pos&&!a){let m=_x(n,t.pos,t.assoc,i),b=Math.min(m.from,g.from),v=Math.max(m.to,g.to);g=b<g.from?P.range(b,v):P.range(v,b)}return a?s.replaceRange(s.main.extend(g.from,g.to)):u&&i==1&&s.ranges.length>1&&(d=O8(s,h.pos))?d:u?s.addRange(g):P.create([g])}}}function O8(n,e){for(let t=0;t<n.ranges.length;t++){let{from:i,to:s}=n.ranges[t];if(i<=e&&s>=e)return P.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}mi.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let s=n.docView.tile.nearest(e.target);if(s&&s.isWidget()){let l=s.posAtStart,a=l+s.length;(l>=t.to||a<=t.from)&&(t=P.range(l,a))}}let{inputState:i}=n;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",_d(n.state,db,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};mi.dragend=n=>(n.inputState.draggedContent=null,!1);function Cx(n,e,t,i){if(t=_d(n.state,fb,t),!t)return;let s=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:l}=n.inputState,a=i&&l&&x8(n,e)?{from:l.from,to:l.to}:null,u={from:s,insert:t},h=n.state.changes(a?[a,u]:u);n.focus(),n.dispatch({changes:h,selection:{anchor:h.mapPos(s,-1),head:h.mapPos(s,1)},userEvent:a?"move.drop":"input.drop"}),n.inputState.draggedContent=null}mi.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let i=Array(t.length),s=0,l=()=>{++s==t.length&&Cx(n,e,i.filter(a=>a!=null).join(n.state.lineBreak),!1)};for(let a=0;a<t.length;a++){let u=new FileReader;u.onerror=l,u.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(u.result)||(i[a]=u.result),l()},u.readAsText(t[a])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return Cx(n,e,i,!0),!0}return!1};mi.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=DT?null:e.clipboardData;return t?(MT(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(C8(n),!1)};function D8(n,e){let t=n.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function M8(n){let e=[],t=[],i=!1;for(let s of n.selection.ranges)s.empty||(e.push(n.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:l}of n.selection.ranges){let a=n.doc.lineAt(l);a.number>s&&(e.push(a.text),t.push({from:a.from,to:Math.min(n.doc.length,a.to+1)})),s=a.number}i=!0}return{text:_d(n,db,e.join(n.lineBreak)),ranges:t,linewise:i}}let ay=null;mi.copy=mi.cut=(n,e)=>{let t=To(n.root);if(t&&!tc(n.contentDOM,t))return!1;let{text:i,ranges:s,linewise:l}=M8(n.state);if(!i&&!l)return!1;ay=l?i:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"});let a=DT?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",i),!0):(D8(n,i),!1)};const LT=yi.define();function NT(n,e){let t=[];for(let i of n.facet(fT)){let s=i(n,e);s&&t.push(s)}return t.length?n.update({effects:t,annotations:LT.of(!0)}):null}function BT(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=NT(n.state,e);t?n.dispatch(t):n.update([])}},10)}ni.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),BT(n)};ni.blur=n=>{n.observer.clearSelectionRange(),BT(n)};ni.compositionstart=ni.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};ni.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,Z.chrome&&Z.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};ni.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};mi.beforeinput=(n,e)=>{var t,i;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(n.inputState.insertingText=e.data,n.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&n.observer.editContext){let l=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),a=e.getTargetRanges();if(l&&a.length){let u=a[0],h=n.posAtDOM(u.startContainer,u.startOffset),d=n.posAtDOM(u.endContainer,u.endOffset);return yb(n,{from:h,to:d,insert:n.state.toText(l)},null),!0}}let s;if(Z.chrome&&Z.android&&(s=ET.find(l=>l.inputType==e.inputType))&&(n.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let l=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>l+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return Z.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),Z.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>ni.compositionend(n,e),20),!1};const Tx=new Set;function R8(n){Tx.has(n)||(Tx.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const Ex=["pre-wrap","normal","pre-line","break-spaces"];let Do=!1;function Ox(){Do=!1}class L8{constructor(e){this.lineWrapping=e,this.doc=He.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Ex.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let s=e[i];s<0?i++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,i,s,l,a){let u=Ex.indexOf(e)>-1,h=Math.abs(t-this.lineHeight)>.3||this.lineWrapping!=u||Math.abs(i-this.charWidth)>.1;if(this.lineWrapping=u,this.lineHeight=t,this.charWidth=i,this.textHeight=s,this.lineLength=l,h){this.heightSamples={};for(let d=0;d<a.length;d++){let g=a[d];g<0?d++:this.heightSamples[Math.floor(g*10)]=!0}}return h}}class N8{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class hi{constructor(e,t,i,s,l){this.from=e,this.length=t,this.top=i,this.height=s,this._content=l}get type(){return typeof this._content=="number"?Gt.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Fr?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new hi(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var et=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})(et||(et={}));const cf=.001;class nn{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>cf&&(Do=!0),this.height=e)}replace(e,t,i){return nn.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,s){let l=this,a=i.doc;for(let u=s.length-1;u>=0;u--){let{fromA:h,toA:d,fromB:g,toB:m}=s[u],b=l.lineAt(h,et.ByPosNoHeight,i.setDoc(t),0,0),v=b.to>=d?b:l.lineAt(d,et.ByPosNoHeight,i,0,0);for(m+=v.to-d,d=v.to;u>0&&b.from<=s[u-1].toA;)h=s[u-1].fromA,g=s[u-1].fromB,u--,h<b.from&&(b=l.lineAt(h,et.ByPosNoHeight,i,0,0));g+=b.from-h,h=b.from;let S=bb.build(i.setDoc(a),e,g,m);l=If(l,l.replace(h,d,S))}return l.updateHeight(i,0)}static empty(){return new Nn(0,0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,s=0,l=0;for(;;)if(t==i)if(s>l*2){let u=e[t-1];u.break?e.splice(--t,1,u.left,null,u.right):e.splice(--t,1,u.left,u.right),i+=1+u.break,s-=u.size}else if(l>s*2){let u=e[i];u.break?e.splice(i,1,u.left,null,u.right):e.splice(i,1,u.left,u.right),i+=2+u.break,l-=u.size}else break;else if(s<l){let u=e[t++];u&&(s+=u.size)}else{let u=e[--i];u&&(l+=u.size)}let a=0;return e[t-1]==null?(a=1,t--):e[t]==null&&(a=1,i++),new U8(nn.of(e.slice(0,t)),a,nn.of(e.slice(i)))}}function If(n,e){return n==e?n:(n.constructor!=e.constructor&&(Do=!0),e)}nn.prototype.size=1;const B8=ae.replace({});class UT extends nn{constructor(e,t,i){super(e,t),this.deco=i,this.spaceAbove=0}mainBlock(e,t){return new hi(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,t,i,s){return this.spaceAbove&&e<i+this.spaceAbove?new hi(s,0,i,this.spaceAbove,B8):this.mainBlock(i,s)}lineAt(e,t,i,s,l){let a=this.mainBlock(s,l);return this.spaceAbove?this.blockAt(0,i,s,l).join(a):a}forEachLine(e,t,i,s,l,a){e<=l+this.length&&t>=l&&a(this.lineAt(0,et.ByPos,i,s,l))}setMeasuredHeight(e){let t=e.heights[e.index++];t<0?(this.spaceAbove=-t,t=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(t)}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more&&this.setMeasuredHeight(s),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Nn extends UT{constructor(e,t,i){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=i}mainBlock(e,t){return new hi(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,t,i){let s=i[0];return i.length==1&&(s instanceof Nn||s instanceof Vt&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Vt?s=new Nn(s.length,this.height,this.spaceAbove):s.height=this.height,this.outdated||(s.outdated=!1),s):nn.of(i)}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more?this.setMeasuredHeight(s):(i||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Vt extends nn{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,s=e.doc.lineAt(t+this.length).number,l=s-i+1,a,u=0;if(e.lineWrapping){let h=Math.min(this.height,e.lineHeight*l);a=h/l,this.length>l+1&&(u=(this.height-h)/(this.length-l-1))}else a=this.height/l;return{firstLine:i,lastLine:s,perLine:a,perChar:u}}blockAt(e,t,i,s){let{firstLine:l,lastLine:a,perLine:u,perChar:h}=this.heightMetrics(t,s);if(t.lineWrapping){let d=s+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),g=t.doc.lineAt(d),m=u+g.length*h,b=Math.max(i,e-m/2);return new hi(g.from,g.length,b,m,0)}else{let d=Math.max(0,Math.min(a-l,Math.floor((e-i)/u))),{from:g,length:m}=t.doc.line(l+d);return new hi(g,m,i+u*d,u,0)}}lineAt(e,t,i,s,l){if(t==et.ByHeight)return this.blockAt(e,i,s,l);if(t==et.ByPosNoHeight){let{from:v,to:S}=i.doc.lineAt(e);return new hi(v,S-v,0,0,0)}let{firstLine:a,perLine:u,perChar:h}=this.heightMetrics(i,l),d=i.doc.lineAt(e),g=u+d.length*h,m=d.number-a,b=s+u*m+h*(d.from-l-m);return new hi(d.from,d.length,Math.max(s,Math.min(b,s+this.height-g)),g,0)}forEachLine(e,t,i,s,l,a){e=Math.max(e,l),t=Math.min(t,l+this.length);let{firstLine:u,perLine:h,perChar:d}=this.heightMetrics(i,l);for(let g=e,m=s;g<=t;){let b=i.doc.lineAt(g);if(g==e){let S=b.number-u;m+=h*S+d*(e-l-S)}let v=h+d*b.length;a(new hi(b.from,b.length,m,v,0)),m+=v,g=b.to+1}}replace(e,t,i){let s=this.length-t;if(s>0){let l=i[i.length-1];l instanceof Vt?i[i.length-1]=new Vt(l.length+s):i.push(null,new Vt(s-1))}if(e>0){let l=i[0];l instanceof Vt?i[0]=new Vt(e+l.length):i.unshift(new Vt(e-1),null)}return nn.of(i)}decomposeLeft(e,t){t.push(new Vt(e-1),null)}decomposeRight(e,t){t.push(null,new Vt(this.length-e-1))}updateHeight(e,t=0,i=!1,s){let l=t+this.length;if(s&&s.from<=t+this.length&&s.more){let a=[],u=Math.max(t,s.from),h=-1;for(s.from>t&&a.push(new Vt(s.from-t-1).updateHeight(e,t));u<=l&&s.more;){let g=e.doc.lineAt(u).length;a.length&&a.push(null);let m=s.heights[s.index++],b=0;m<0&&(b=-m,m=s.heights[s.index++]),h==-1?h=m:Math.abs(m-h)>=cf&&(h=-2);let v=new Nn(g,m,b);v.outdated=!1,a.push(v),u+=g+1}u<=l&&a.push(null,new Vt(l-u).updateHeight(e,u));let d=nn.of(a);return(h<0||Math.abs(d.height-this.height)>=cf||Math.abs(h-this.heightMetrics(e,t).perLine)>=cf)&&(Do=!0),If(this,d)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class U8 extends nn{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,s){let l=i+this.left.height;return e<l?this.left.blockAt(e,t,i,s):this.right.blockAt(e,t,l,s+this.left.length+this.break)}lineAt(e,t,i,s,l){let a=s+this.left.height,u=l+this.left.length+this.break,h=t==et.ByHeight?e<a:e<u,d=h?this.left.lineAt(e,t,i,s,l):this.right.lineAt(e,t,i,a,u);if(this.break||(h?d.to<u:d.from>u))return d;let g=t==et.ByPosNoHeight?et.ByPosNoHeight:et.ByPos;return h?d.join(this.right.lineAt(u,g,i,a,u)):this.left.lineAt(u,g,i,s,l).join(d)}forEachLine(e,t,i,s,l,a){let u=s+this.left.height,h=l+this.left.length+this.break;if(this.break)e<h&&this.left.forEachLine(e,t,i,s,l,a),t>=h&&this.right.forEachLine(e,t,i,u,h,a);else{let d=this.lineAt(h,et.ByPos,i,s,l);e<d.from&&this.left.forEachLine(e,d.from-1,i,s,l,a),d.to>=e&&d.from<=t&&a(d),t>d.to&&this.right.forEachLine(d.to+1,t,i,u,h,a)}}replace(e,t,i){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,i));let l=[];e>0&&this.decomposeLeft(e,l);let a=l.length;for(let u of i)l.push(u);if(e>0&&Dx(l,a-1),t<this.length){let u=l.length;this.decomposeRight(t,l),Dx(l,u)}return nn.of(l)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,s=i+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?nn.of(this.break?[e,null,t]:[e,t]):(this.left=If(this.left,e),this.right=If(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,s){let{left:l,right:a}=this,u=t+l.length+this.break,h=null;return s&&s.from<=t+l.length&&s.more?h=l=l.updateHeight(e,t,i,s):l.updateHeight(e,t,i),s&&s.from<=u+a.length&&s.more?h=a=a.updateHeight(e,u,i,s):a.updateHeight(e,u,i),h?this.balanced(l,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Dx(n,e){let t,i;n[e]==null&&(t=n[e-1])instanceof Vt&&(i=n[e+1])instanceof Vt&&n.splice(e-1,3,new Vt(t.length+1+i.length))}const j8=5;class bb{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Nn?s.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Nn(i-this.pos,-1,0)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let s=i.widget?i.widget.estimatedHeight:0,l=i.widget?i.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let a=t-e;i.block?this.addBlock(new UT(a,s,i)):(a||l||s>=j8)&&this.addLineDeco(s,l,a)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Nn(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,t){let i=new Vt(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Nn)return e;let t=new Nn(0,-1,0);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,i){let s=this.ensureLine();s.length+=i,s.collapsed+=i,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=t,this.writtenTo=this.pos=this.pos+i}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Nn)&&!this.isCovered?this.nodes.push(new Nn(0,-1,0)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let s of this.nodes)s instanceof Nn&&s.updateHeight(this.oracle,i),i+=s?s.length:1;return this.nodes}static build(e,t,i,s){let l=new bb(i,e);return Ee.spans(t,i,s,l,0),l.finish(i)}}function z8(n,e,t){let i=new I8;return Ee.compare(n,e,t,i,0),i.changes}class I8{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,s){(e<t||i&&i.heightRelevant||s&&s.heightRelevant)&&fo(e,t,this.changes,5)}}function H8(n,e){let t=n.getBoundingClientRect(),i=n.ownerDocument,s=i.defaultView||window,l=Math.max(0,t.left),a=Math.min(s.innerWidth,t.right),u=Math.max(0,t.top),h=Math.min(s.innerHeight,t.bottom);for(let d=n.parentNode;d&&d!=i.body;)if(d.nodeType==1){let g=d,m=window.getComputedStyle(g);if((g.scrollHeight>g.clientHeight||g.scrollWidth>g.clientWidth)&&m.overflow!="visible"){let b=g.getBoundingClientRect();l=Math.max(l,b.left),a=Math.min(a,b.right),u=Math.max(u,b.top),h=Math.min(d==n.parentNode?s.innerHeight:h,b.bottom)}d=m.position=="absolute"||m.position=="fixed"?g.offsetParent:g.parentNode}else if(d.nodeType==11)d=d.host;else break;return{left:l-t.left,right:Math.max(l,a)-t.left,top:u-(t.top+e),bottom:Math.max(u,h)-(t.top+e)}}function q8(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function V8(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Mm{constructor(e,t,i,s){this.from=e,this.to=t,this.size=i,this.displaySize=s}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let s=e[i],l=t[i];if(s.from!=l.from||s.to!=l.to||s.size!=l.size)return!1}return!0}draw(e,t){return ae.replace({widget:new $8(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class $8 extends Vi{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Mx{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Rx,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Qe.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(gb).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new L8(t),this.stateDeco=Lx(e),this.heightMap=nn.empty().applyChanges(this.stateDeco,He.empty,this.heightOracle.setDoc(e.doc),[new Qn(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ae.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let s=i?t.head:t.anchor;if(!e.some(({from:l,to:a})=>s>=l&&s<=a)){let{from:l,to:a}=this.lineBlockAt(s);e.push(new zh(l,a))}}return this.viewports=e.sort((i,s)=>i.from-s.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Rx:new vb(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Wa(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=Lx(this.state);let s=e.changedRanges,l=Qn.extendWithRanges(s,z8(i,this.stateDeco,e?e.changes:At.empty(this.state.doc.length))),a=this.heightMap.height,u=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Ox(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),l),(this.heightMap.height!=a||Do)&&(e.flags|=2),u?(this.scrollAnchorPos=e.changes.mapPos(u.from,-1),this.scrollAnchorHeight=u.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=a);let h=l.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<h.from||t.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,t));let d=h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,e.flags|=this.updateForViewport(),(d||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(gT)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),s=this.heightOracle,l=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?Qe.RTL:Qe.LTR;let a=this.heightOracle.mustRefreshForWrapping(l)||this.mustMeasureContent,u=t.getBoundingClientRect(),h=a||this.mustMeasureContent||this.contentDOMHeight!=u.height;this.contentDOMHeight=u.height,this.mustMeasureContent=!1;let d=0,g=0;if(u.width&&u.height){let{scaleX:z,scaleY:q}=XC(t,u);(z>.005&&Math.abs(this.scaleX-z)>.005||q>.005&&Math.abs(this.scaleY-q)>.005)&&(this.scaleX=z,this.scaleY=q,d|=16,a=h=!0)}let m=(parseInt(i.paddingTop)||0)*this.scaleY,b=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=m||this.paddingBottom!=b)&&(this.paddingTop=m,this.paddingBottom=b,d|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(h=!0),this.editorWidth=e.scrollDOM.clientWidth,d|=16);let v=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=v&&(this.scrollAnchorHeight=-1,this.scrollTop=v),this.scrolledToBottom=ZC(e.scrollDOM);let S=(this.printing?V8:H8)(t,this.paddingTop),_=S.top-this.pixelViewport.top,k=S.bottom-this.pixelViewport.bottom;this.pixelViewport=S;let A=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(A!=this.inView&&(this.inView=A,A&&(h=!0)),!this.inView&&!this.scrollTarget&&!q8(e.dom))return 0;let M=u.width;if((this.contentDOMWidth!=M||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=u.width,this.editorHeight=e.scrollDOM.clientHeight,d|=16),h){let z=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(z)&&(a=!0),a||s.lineWrapping&&Math.abs(M-this.contentDOMWidth)>s.charWidth){let{lineHeight:q,charWidth:V,textHeight:j}=e.docView.measureTextSize();a=q>0&&s.refresh(l,q,V,j,Math.max(5,M/V),z),a&&(e.docView.minWidth=0,d|=16)}_>0&&k>0?g=Math.max(_,k):_<0&&k<0&&(g=Math.min(_,k)),Ox();for(let q of this.viewports){let V=q.from==this.viewport.from?z:e.docView.measureVisibleLineHeights(q);this.heightMap=(a?nn.empty().applyChanges(this.stateDeco,He.empty,this.heightOracle,[new Qn(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,a,new N8(q.from,V))}Do&&(d|=2)}let O=!this.viewportIsAppropriate(this.viewport,g)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return O&&(d&2&&(d|=this.updateScaler()),this.viewport=this.getViewport(g,this.scrollTarget),d|=this.updateForViewport()),(d&2||O)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),d|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),d}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,l=this.heightOracle,{visibleTop:a,visibleBottom:u}=this,h=new zh(s.lineAt(a-i*1e3,et.ByHeight,l,0,0).from,s.lineAt(u+(1-i)*1e3,et.ByHeight,l,0,0).to);if(t){let{head:d}=t.range;if(d<h.from||d>h.to){let g=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),m=s.lineAt(d,et.ByPos,l,0,0),b;t.y=="center"?b=(m.top+m.bottom)/2-g/2:t.y=="start"||t.y=="nearest"&&d<h.from?b=m.top:b=m.bottom-g,h=new zh(s.lineAt(b-1e3/2,et.ByHeight,l,0,0).from,s.lineAt(b+g+1e3/2,et.ByHeight,l,0,0).to)}}return h}mapViewport(e,t){let i=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new zh(this.heightMap.lineAt(i,et.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,et.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,et.ByPos,this.heightOracle,0,0),{bottom:l}=this.heightMap.lineAt(t,et.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:u}=this;return(e==0||s<=a-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||l>=u+Math.max(10,Math.min(i,250)))&&s>a-2*1e3&&l<u+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let s of e)t.touchesRange(s.from,s.to)||i.push(new Mm(t.mapPos(s.from),t.mapPos(s.to),s.size,s.displaySize));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,s=i?1e4:2e3,l=s>>1,a=s<<1;if(this.defaultTextDirection!=Qe.LTR&&!i)return[];let u=[],h=(g,m,b,v)=>{if(m-g<l)return;let S=this.state.selection.main,_=[S.from];S.empty||_.push(S.to);for(let A of _)if(A>g&&A<m){h(g,A-10,b,v),h(A+10,m,b,v);return}let k=G8(e,A=>A.from>=b.from&&A.to<=b.to&&Math.abs(A.from-g)<l&&Math.abs(A.to-m)<l&&!_.some(M=>A.from<M&&A.to>M));if(!k){if(m<b.to&&t&&i&&t.visibleRanges.some(O=>O.from<=m&&O.to>=m)){let O=t.moveToLineBoundary(P.cursor(m),!1,!0).head;O>g&&(m=O)}let A=this.gapSize(b,g,m,v),M=i||A<2e6?A:2e6;k=new Mm(g,m,A,M)}u.push(k)},d=g=>{if(g.length<a||g.type!=Gt.Text)return;let m=P8(g.from,g.to,this.stateDeco);if(m.total<a)return;let b=this.scrollTarget?this.scrollTarget.range.head:null,v,S;if(i){let _=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,k,A;if(b!=null){let M=Hh(m,b),O=((this.visibleBottom-this.visibleTop)/2+_)/g.height;k=M-O,A=M+O}else k=(this.visibleTop-g.top-_)/g.height,A=(this.visibleBottom-g.top+_)/g.height;v=Ih(m,k),S=Ih(m,A)}else{let _=m.total*this.heightOracle.charWidth,k=s*this.heightOracle.charWidth,A=0;if(_>2e6)for(let V of e)V.from>=g.from&&V.from<g.to&&V.size!=V.displaySize&&V.from*this.heightOracle.charWidth+A<this.pixelViewport.left&&(A=V.size-V.displaySize);let M=this.pixelViewport.left+A,O=this.pixelViewport.right+A,z,q;if(b!=null){let V=Hh(m,b),j=((O-M)/2+k)/_;z=V-j,q=V+j}else z=(M-k)/_,q=(O+k)/_;v=Ih(m,z),S=Ih(m,q)}v>g.from&&h(g.from,v,g,m),S<g.to&&h(S,g.to,g,m)};for(let g of this.viewportLines)Array.isArray(g.type)?g.type.forEach(d):d(g);return u}gapSize(e,t,i,s){let l=Hh(s,i)-Hh(s,t);return this.heightOracle.lineWrapping?e.height*l:s.total*this.heightOracle.charWidth*l}updateLineGaps(e){Mm.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ae.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let i=[];Ee.spans(t,this.viewport.from,this.viewport.to,{span(l,a){i.push({from:l,to:a})},point(){}},20);let s=0;if(i.length!=this.visibleRanges.length)s=12;else for(let l=0;l<i.length&&!(s&8);l++){let a=this.visibleRanges[l],u=i[l];(a.from!=u.from||a.to!=u.to)&&(s|=4,e&&e.mapPos(a.from,-1)==u.from&&e.mapPos(a.to,1)==u.to||(s|=8))}return this.visibleRanges=i,s}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Wa(this.heightMap.lineAt(e,et.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Wa(this.heightMap.lineAt(this.scaler.fromDOM(e),et.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Wa(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class zh{constructor(e,t){this.from=e,this.to=t}}function P8(n,e,t){let i=[],s=n,l=0;return Ee.spans(t,n,e,{span(){},point(a,u){a>s&&(i.push({from:s,to:a}),l+=a-s),s=u}},20),s<e&&(i.push({from:s,to:e}),l+=e-s),{total:l,ranges:i}}function Ih({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(n*t);for(let s=0;;s++){let{from:l,to:a}=e[s],u=a-l;if(i<=u)return l+i;i-=u}}function Hh(n,e){let t=0;for(let{from:i,to:s}of n.ranges){if(e<=s){t+=e-i;break}t+=s-i}return t/n.total}function G8(n,e){for(let t of n)if(e(t))return t}const Rx={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};function Lx(n){let e=n.facet(vd).filter(i=>typeof i!="function"),t=n.facet(pb).filter(i=>typeof i!="function");return t.length&&e.push(Ee.join(t)),e}class vb{constructor(e,t,i){let s=0,l=0,a=0;this.viewports=i.map(({from:u,to:h})=>{let d=t.lineAt(u,et.ByPos,e,0,0).top,g=t.lineAt(h,et.ByPos,e,0,0).bottom;return s+=g-d,{from:u,to:h,top:d,bottom:g,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let u of this.viewports)u.domTop=a+(u.top-l)*this.scale,a=u.domBottom=u.domTop+(u.bottom-u.top),l=u.bottom}toDOM(e){for(let t=0,i=0,s=0;;t++){let l=t<this.viewports.length?this.viewports[t]:null;if(!l||e<l.top)return s+(e-i)*this.scale;if(e<=l.bottom)return l.domTop+(e-l.top);i=l.bottom,s=l.domBottom}}fromDOM(e){for(let t=0,i=0,s=0;;t++){let l=t<this.viewports.length?this.viewports[t]:null;if(!l||e<l.domTop)return i+(e-s)/this.scale;if(e<=l.domBottom)return l.top+(e-l.domTop);i=l.bottom,s=l.domBottom}}eq(e){return e instanceof vb?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,i)=>t.from==e.viewports[i].from&&t.to==e.viewports[i].to):!1}}function Wa(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),i=e.toDOM(n.bottom);return new hi(n.from,n.length,t,i-t,Array.isArray(n._content)?n._content.map(s=>Wa(s,e)):n._content)}const qh=X.define({combine:n=>n.join(" ")}),cy=X.define({combine:n=>n.indexOf(!0)>-1}),uy=tr.newName(),jT=tr.newName(),zT=tr.newName(),IT={"&light":"."+jT,"&dark":"."+zT};function hy(n,e,t){return new tr(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,s=>{if(s=="&")return n;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):n+" "+i}})}const K8=hy("."+uy,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},IT),W8={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Rm=Z.ie&&Z.ie_version<=11;class Y8{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new AU,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(Z.ie&&Z.ie_version<=11||Z.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&Z.android&&e.constructor.EDIT_CONTEXT!==!1&&!(Z.chrome&&Z.chrome_version<126)&&(this.editContext=new J8(e),e.state.facet(as)&&(e.contentDOM.editContext=this.editContext.editContext)),Rm&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,s=this.selectionRange;if(i.state.facet(as)?i.root.activeElement!=this.dom:!tc(this.dom,s))return;let l=s.anchorNode&&i.docView.tile.nearest(s.anchorNode);if(l&&l.isWidget()&&l.widget.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(Z.ie&&Z.ie_version<=11||Z.android&&Z.chrome)&&!i.state.selection.main.empty&&s.focusNode&&nc(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=To(e.root);if(!t)return!1;let i=Z.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&F8(this.view,t)||t;if(!i||this.selectionRange.eq(i))return!1;let s=tc(this.dom,i);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&TU(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,W8),Rm&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Rm&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let s=()=>{let l=this.delayedAndroidKey;l&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=l.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&l.force&&go(this.dom,l.key,l.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,i=-1,s=!1;for(let l of e){let a=this.readMutation(l);a&&(a.typeOver&&(s=!0),t==-1?{from:t,to:i}=a:(t=Math.min(a.from,t),i=Math.max(a.to,i)))}return{from:t,to:i,typeOver:s}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),s=this.selectionChanged&&tc(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let l=new d8(this.view,e,t,i);return this.view.docView.domChanged={newSel:l.newSel?l.newSel.main:null},l}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let i=this.view.state,s=CT(this.view,t);return this.view.state==i&&(t.domChanged||t.newSel&&!zf(this.view.state.selection,t.newSel.main))&&this.view.update([]),s}readMutation(e){let t=this.view.docView.tile.nearest(e.target);if(!t||t.isWidget())return null;if(t.markDirty(e.type=="attributes"),e.type=="childList"){let i=Nx(t,e.previousSibling||e.target.previousSibling,-1),s=Nx(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(as)!=e.state.facet(as)&&(e.view.contentDOM.editContext=e.state.facet(as)?this.editContext.editContext:null))}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Nx(n,e,t){for(;e;){let i=St.get(e);if(i&&i.parent==n)return i;let s=e.parentNode;e=s!=n.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function Bx(n,e){let t=e.startContainer,i=e.startOffset,s=e.endContainer,l=e.endOffset,a=n.docView.domAtPos(n.state.selection.main.anchor,1);return nc(a.node,a.offset,s,l)&&([t,i,s,l]=[s,l,t,i]),{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:l}}function F8(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return Bx(n,s)}let t=null;function i(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",i,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",i,!0),t?Bx(n,t):null}class J8{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let s=e.state.selection.main,{anchor:l,head:a}=s,u=this.toEditorPos(i.updateRangeStart),h=this.toEditorPos(i.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:u,drifted:!1});let d=h-u>i.text.length;u==this.from&&l<this.from?u=l:h==this.to&&l>this.to&&(h=l);let g=TT(e.state.sliceDoc(u,h),i.text,(d?s.from:s.to)-u,d?"end":null);if(!g){let b=P.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));zf(b,s)||e.dispatch({selection:b,userEvent:"select"});return}let m={from:g.from+u,to:g.toA+u,insert:He.of(i.text.slice(g.from,g.toB).split(`
`))};if((Z.mac||Z.android)&&m.from==a-1&&/^\. ?$/.test(i.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(m={from:u,to:h,insert:He.of([i.text.replace("."," ")])}),this.pendingContextChange=m,!e.state.readOnly){let b=this.to-this.from+(m.to-m.from+m.insert.length);yb(e,m,P.single(this.toEditorPos(i.selectionStart,b),this.toEditorPos(i.selectionEnd,b)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),m.from<m.to&&!m.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,i.updateRangeStart-1),Math.min(t.text.length,i.updateRangeStart+1)))&&this.handlers.compositionend(i)},this.handlers.characterboundsupdate=i=>{let s=[],l=null;for(let a=this.toEditorPos(i.rangeStart),u=this.toEditorPos(i.rangeEnd);a<u;a++){let h=e.coordsForChar(a);l=h&&new DOMRect(h.left,h.top,h.right-h.left,h.bottom-h.top)||l||new DOMRect,s.push(l)}t.updateCharacterBounds(i.rangeStart,s)},this.handlers.textformatupdate=i=>{let s=[];for(let l of i.getTextFormats()){let a=l.underlineStyle,u=l.underlineThickness;if(!/none/i.test(a)&&!/none/i.test(u)){let h=this.toEditorPos(l.rangeStart),d=this.toEditorPos(l.rangeEnd);if(h<d){let g=`text-decoration: underline ${/^[a-z]/.test(a)?a+" ":a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${/thin/i.test(u)?1:2}px`;s.push(ae.mark({attributes:{style:g}}).range(h,d))}}}e.dispatch({effects:mT.of(ae.set(s))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(e.state)}};for(let i in this.handlers)t.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let s=To(i.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,i=!1,s=this.pendingContextChange;return e.changes.iterChanges((l,a,u,h,d)=>{if(i)return;let g=d.length-(a-l);if(s&&a>=s.to)if(s.from==l&&s.to==a&&s.insert.eq(d)){s=this.pendingContextChange=null,t+=g,this.to+=g;return}else s=null,this.revertPending(e.state);if(l+=t,a+=t,a<=this.from)this.from+=g,this.to+=g;else if(l<this.to){if(l<this.from||a>this.to||this.to-this.from+d.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(l),this.toContextPos(a),d.toString()),this.to+=g}t+=g}),s&&!i&&this.revertPending(e.state),!i}update(e){let t=this.pendingContextChange,i=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(i.from,i.to)&&e.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),s=this.toContextPos(t.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(i,s)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let i=this.composing;return i&&i.drifted?i.editorBase+(e-i.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class J{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(s=>s.forEach(l=>i(l,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=e.root||CU(e.parent)||document,this.viewState=new Mx(e.state||je.create(e)),e.scrollTo&&e.scrollTo.is(Bh)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(no).map(s=>new Cm(s));for(let s of this.plugins)s.update(this);this.observer=new Y8(this),this.inputState=new y8(this),this.inputState.ensureHandlers(this.plugins),this.docView=new yx(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...e){let t=e.length==1&&e[0]instanceof Tt?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,s,l=this.state;for(let b of e){if(b.startState!=l)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");l=b.state}if(this.destroyed){this.viewState.state=l;return}let a=this.hasFocus,u=0,h=null;e.some(b=>b.annotation(LT))?(this.inputState.notifiedFocused=a,u=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,h=NT(l,a),h||(u=1));let d=this.observer.delayedAndroidKey,g=null;if(d?(this.observer.clearDelayedAndroidKey(),g=this.observer.readChange(),(g&&!this.state.doc.eq(l.doc)||!this.state.selection.eq(l.selection))&&(g=null)):this.observer.clear(),l.facet(je.phrases)!=this.state.facet(je.phrases))return this.setState(l);s=Bf.create(this,l,e),s.flags|=u;let m=this.viewState.scrollTarget;try{this.updateState=2;for(let b of e){if(m&&(m=m.map(b.changes)),b.scrollIntoView){let{main:v}=b.state.selection;m=new po(v.empty?v:P.cursor(v.head,v.head>v.anchor?-1:1))}for(let v of b.effects)v.is(Bh)&&(m=v.value.clip(this.state))}this.viewState.update(s,m),this.bidiCache=Hf.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(Ga)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(b=>b.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(qh)!=s.state.facet(qh)&&(this.viewState.mustMeasureContent=!0),(t||i||m||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!s.empty)for(let b of this.state.facet(sy))try{b(s)}catch(v){mn(this.state,v,"update listener")}(h||g)&&Promise.resolve().then(()=>{h&&this.state==h.startState&&this.dispatch(h),g&&!CT(this,g)&&d.force&&go(this.contentDOM,d.key,d.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Mx(e),this.plugins=e.facet(no).map(i=>new Cm(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new yx(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(no),i=e.state.facet(no);if(t!=i){let s=[];for(let l of i){let a=t.indexOf(l);if(a<0)s.push(new Cm(l));else{let u=this.plugins[a];u.mustUpdate=e,s.push(u)}}for(let l of this.plugins)l.mustUpdate!=e&&l.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);t!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(i){mn(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,i=this.scrollDOM,s=i.scrollTop*this.scaleY,{scrollAnchorPos:l,scrollAnchorHeight:a}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let u=0;;u++){if(a<0)if(ZC(i))l=-1,a=this.viewState.heightMap.height;else{let v=this.viewState.scrollAnchorAt(s);l=v.from,a=v.top}this.updateState=1;let h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(u>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let d=[];h&4||([this.measureRequests,d]=[d,this.measureRequests]);let g=d.map(v=>{try{return v.read(this)}catch(S){return mn(this.state,S),Ux}}),m=Bf.create(this,this.state,[]),b=!1;m.flags|=h,t?t.flags|=h:t=m,this.updateState=2,m.empty||(this.updatePlugins(m),this.inputState.update(m),this.updateAttrs(),b=this.docView.update(m),b&&this.docViewUpdate());for(let v=0;v<d.length;v++)if(g[v]!=Ux)try{let S=d[v];S.write&&S.write(g[v],this)}catch(S){mn(this.state,S)}if(b&&this.docView.updateSelection(!0),!m.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let S=(l<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(l).top)-a;if(S>1||S<-1){s=s+S,i.scrollTop=s/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let u of this.state.facet(sy))u(t)}get themeClasses(){return uy+" "+(this.state.facet(cy)?zT:jT)+" "+this.state.facet(qh)}updateAttrs(){let e=jx(this,yT,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(as)?"true":"false",class:"cm-content",style:`${Z.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),jx(this,gb,t);let i=this.observer.ignore(()=>{let s=hx(this.contentDOM,this.contentAttrs,t),l=hx(this.dom,this.editorAttrs,e);return s||l});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let s of i.effects)if(s.is(J.announce)){t&&(this.announceDOM.textContent=""),t=!1;let l=this.announceDOM.appendChild(document.createElement("div"));l.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Ga);let e=this.state.facet(J.cspNonce);tr.mount(this.root,this.styleModules.concat(K8).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return Dm(this,e,bx(this,e,t,i))}moveByGroup(e,t){return Dm(this,e,bx(this,e,t,i=>a8(this,e.head,i)))}visualLineSide(e,t){let i=this.bidiSpans(e),s=this.textDirectionAt(e.from),l=i[t?i.length-1:0];return P.cursor(l.side(t,s)+e.from,l.forward(!t,s)?1:-1)}moveToLineBoundary(e,t,i=!0){return o8(this,e,t,i)}moveVertically(e,t,i){return Dm(this,e,c8(this,e,t,i))}domAtPos(e,t=1){return this.docView.domAtPos(e,t)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){this.readMeasured();let i=oy(this,e,t);return i&&i.pos}posAndSideAtCoords(e,t=!0){return this.readMeasured(),oy(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(e),l=this.bidiSpans(s),a=l[cs.find(l,e-s.from,-1,t)];return Nf(i,a.dir==Qe.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(dT)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>X8)return rT(e.length);let t=this.textDirectionAt(e.from),i;for(let l of this.bidiCache)if(l.from==e.from&&l.dir==t&&(l.fresh||sT(l.isolates,i=gx(this,e))))return l.order;i||(i=gx(this,e));let s=NU(e.text,t,i);return this.bidiCache.push(new Hf(e.from,e.to,t,i,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Z.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{QC(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Bh.of(new po(typeof e=="number"?P.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return Bh.of(new po(P.cursor(i.from),"start","start",i.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return rt.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return rt.define(()=>({}),{eventObservers:e})}static theme(e,t){let i=tr.newName(),s=[qh.of(i),Ga.of(hy(`.${i}`,e))];return t&&t.dark&&s.push(cy.of(!0)),s}static baseTheme(e){return nl.lowest(Ga.of(hy("."+uy,e,IT)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),s=i&&St.get(i)||St.get(e);return((t=s?.root)===null||t===void 0?void 0:t.view)||null}}J.styleModule=Ga;J.inputHandler=hT;J.clipboardInputFilter=fb;J.clipboardOutputFilter=db;J.scrollHandler=pT;J.focusChangeEffect=fT;J.perLineTextDirection=dT;J.exceptionSink=uT;J.updateListener=sy;J.editable=as;J.mouseSelectionStyle=cT;J.dragMovesSelection=aT;J.clickAddsSelectionRange=oT;J.decorations=vd;J.blockWrappers=bT;J.outerDecorations=pb;J.atomicRanges=Xc;J.bidiIsolatedRanges=vT;J.scrollMargins=wT;J.darkTheme=cy;J.cspNonce=X.define({combine:n=>n.length?n[0]:""});J.contentAttributes=gb;J.editorAttributes=yT;J.lineWrapping=J.contentAttributes.of({class:"cm-lineWrapping"});J.announce=_e.define();const X8=4096,Ux={};class Hf{constructor(e,t,i,s,l,a){this.from=e,this.to=t,this.dir=i,this.isolates=s,this.fresh=l,this.order=a}static update(e,t){if(t.empty&&!e.some(l=>l.fresh))return e;let i=[],s=e.length?e[e.length-1].dir:Qe.LTR;for(let l=Math.max(0,e.length-10);l<e.length;l++){let a=e[l];a.dir==s&&!t.touchesRange(a.from,a.to)&&i.push(new Hf(t.mapPos(a.from,1),t.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return i}}function jx(n,e,t){for(let i=n.state.facet(e),s=i.length-1;s>=0;s--){let l=i[s],a=typeof l=="function"?l(n):l;a&&cb(a,t)}return t}const Q8=Z.mac?"mac":Z.windows?"win":Z.linux?"linux":"key";function Z8(n,e){const t=n.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let s,l,a,u;for(let h=0;h<t.length-1;++h){const d=t[h];if(/^(cmd|meta|m)$/i.test(d))u=!0;else if(/^a(lt)?$/i.test(d))s=!0;else if(/^(c|ctrl|control)$/i.test(d))l=!0;else if(/^s(hift)?$/i.test(d))a=!0;else if(/^mod$/i.test(d))e=="mac"?u=!0:l=!0;else throw new Error("Unrecognized modifier name: "+d)}return s&&(i="Alt-"+i),l&&(i="Ctrl-"+i),u&&(i="Meta-"+i),a&&(i="Shift-"+i),i}function Vh(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const e4=nl.default(J.domEventHandlers({keydown(n,e){return qT(HT(e.state),n,e,"editor")}})),wb=X.define({enables:e4}),zx=new WeakMap;function HT(n){let e=n.facet(wb),t=zx.get(e);return t||zx.set(e,t=i4(e.reduce((i,s)=>i.concat(s),[]))),t}function t4(n,e,t){return qT(HT(n.state),e,n,t)}let Ys=null;const n4=4e3;function i4(n,e=Q8){let t=Object.create(null),i=Object.create(null),s=(a,u)=>{let h=i[a];if(h==null)i[a]=u;else if(h!=u)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},l=(a,u,h,d,g)=>{var m,b;let v=t[a]||(t[a]=Object.create(null)),S=u.split(/ (?!$)/).map(A=>Z8(A,e));for(let A=1;A<S.length;A++){let M=S.slice(0,A).join(" ");s(M,!0),v[M]||(v[M]={preventDefault:!0,stopPropagation:!1,run:[O=>{let z=Ys={view:O,prefix:M,scope:a};return setTimeout(()=>{Ys==z&&(Ys=null)},n4),!0}]})}let _=S.join(" ");s(_,!1);let k=v[_]||(v[_]={preventDefault:!1,stopPropagation:!1,run:((b=(m=v._any)===null||m===void 0?void 0:m.run)===null||b===void 0?void 0:b.slice())||[]});h&&k.run.push(h),d&&(k.preventDefault=!0),g&&(k.stopPropagation=!0)};for(let a of n){let u=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let d of u){let g=t[d]||(t[d]=Object.create(null));g._any||(g._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:m}=a;for(let b in g)g[b].run.push(v=>m(v,fy))}let h=a[e]||a.key;if(h)for(let d of u)l(d,h,a.run,a.preventDefault,a.stopPropagation),a.shift&&l(d,"Shift-"+h,a.shift,a.preventDefault,a.stopPropagation)}return t}let fy=null;function qT(n,e,t,i){fy=e;let s=yU(e),l=fn(s,0),a=Di(l)==s.length&&s!=" ",u="",h=!1,d=!1,g=!1;Ys&&Ys.view==t&&Ys.scope==i&&(u=Ys.prefix+" ",OT.indexOf(e.keyCode)<0&&(d=!0,Ys=null));let m=new Set,b=k=>{if(k){for(let A of k.run)if(!m.has(A)&&(m.add(A),A(t)))return k.stopPropagation&&(g=!0),!0;k.preventDefault&&(k.stopPropagation&&(g=!0),d=!0)}return!1},v=n[i],S,_;return v&&(b(v[u+Vh(s,e,!a)])?h=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Z.windows&&e.ctrlKey&&e.altKey)&&!(Z.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(S=nr[e.keyCode])&&S!=s?(b(v[u+Vh(S,e,!0)])||e.shiftKey&&(_=Ec[e.keyCode])!=s&&_!=S&&b(v[u+Vh(_,e,!1)]))&&(h=!0):a&&e.shiftKey&&b(v[u+Vh(s,e,!0)])&&(h=!0),!h&&b(v._any)&&(h=!0)),d&&(h=!0),h&&g&&e.stopPropagation(),fy=null,h}class Qc{constructor(e,t,i,s,l){this.className=e,this.left=t,this.top=i,this.width=s,this.height=l}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,i){if(i.empty){let s=e.coordsAtPos(i.head,i.assoc||1);if(!s)return[];let l=VT(e);return[new Qc(t,s.left-l.left,s.top-l.top,null,s.bottom-s.top)]}else return s4(e,t,i)}}function VT(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Qe.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function Ix(n,e,t,i){let s=n.coordsAtPos(e,t*2);if(!s)return i;let l=n.dom.getBoundingClientRect(),a=(s.top+s.bottom)/2,u=n.posAtCoords({x:l.left+1,y:a}),h=n.posAtCoords({x:l.right-1,y:a});return u==null||h==null?i:{from:Math.max(i.from,Math.min(u,h)),to:Math.min(i.to,Math.max(u,h))}}function s4(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let i=Math.max(t.from,n.viewport.from),s=Math.min(t.to,n.viewport.to),l=n.textDirection==Qe.LTR,a=n.contentDOM,u=a.getBoundingClientRect(),h=VT(n),d=a.querySelector(".cm-line"),g=d&&window.getComputedStyle(d),m=u.left+(g?parseInt(g.paddingLeft)+Math.min(0,parseInt(g.textIndent)):0),b=u.right-(g?parseInt(g.paddingRight):0),v=ly(n,i,1),S=ly(n,s,-1),_=v.type==Gt.Text?v:null,k=S.type==Gt.Text?S:null;if(_&&(n.lineWrapping||v.widgetLineBreaks)&&(_=Ix(n,i,1,_)),k&&(n.lineWrapping||S.widgetLineBreaks)&&(k=Ix(n,s,-1,k)),_&&k&&_.from==k.from&&_.to==k.to)return M(O(t.from,t.to,_));{let q=_?O(t.from,null,_):z(v,!1),V=k?O(null,t.to,k):z(S,!0),j=[];return(_||v).to<(k||S).from-(_&&k?1:0)||v.widgetLineBreaks>1&&q.bottom+n.defaultLineHeight/2<V.top?j.push(A(m,q.bottom,b,V.top)):q.bottom<V.top&&n.elementAtHeight((q.bottom+V.top)/2).type==Gt.Text&&(q.bottom=V.top=(q.bottom+V.top)/2),M(q).concat(j).concat(M(V))}function A(q,V,j,ee){return new Qc(e,q-h.left,V-h.top,Math.max(0,j-q),ee-V)}function M({top:q,bottom:V,horizontal:j}){let ee=[];for(let se=0;se<j.length;se+=2)ee.push(A(j[se],q,j[se+1],V));return ee}function O(q,V,j){let ee=1e9,se=-1e9,Me=[];function he(fe,ye,B,K,re){let me=n.coordsAtPos(fe,fe==j.to?-2:2),Ae=n.coordsAtPos(B,B==j.from?2:-2);!me||!Ae||(ee=Math.min(me.top,Ae.top,ee),se=Math.max(me.bottom,Ae.bottom,se),re==Qe.LTR?Me.push(l&&ye?m:me.left,l&&K?b:Ae.right):Me.push(!l&&K?m:Ae.left,!l&&ye?b:me.right))}let te=q??j.from,oe=V??j.to;for(let fe of n.visibleRanges)if(fe.to>te&&fe.from<oe)for(let ye=Math.max(fe.from,te),B=Math.min(fe.to,oe);;){let K=n.state.doc.lineAt(ye);for(let re of n.bidiSpans(K)){let me=re.from+K.from,Ae=re.to+K.from;if(me>=B)break;Ae>ye&&he(Math.max(me,ye),q==null&&me<=te,Math.min(Ae,B),V==null&&Ae>=oe,re.dir)}if(ye=K.to+1,ye>=B)break}return Me.length==0&&he(te,q==null,oe,V==null,n.textDirection),{top:ee,bottom:se,horizontal:Me}}function z(q,V){let j=u.top+(V?q.top:q.bottom);return{top:j,bottom:j,horizontal:[]}}}function r4(n,e){return n.constructor==e.constructor&&n.eq(e)}class l4{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(uf)!=e.state.facet(uf)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,i=e.facet(uf);for(;t<i.length&&i[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,i)=>!r4(t,this.drawn[i]))){let t=this.dom.firstChild,i=0;for(let s of e)s.update&&t&&s.constructor&&this.drawn[i].constructor&&s.update(t,this.drawn[i])?(t=t.nextSibling,i++):this.dom.insertBefore(s.draw(),t);for(;t;){let s=t.nextSibling;t.remove(),t=s}this.drawn=e,Z.safari&&Z.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const uf=X.define();function $T(n){return[rt.define(e=>new l4(e,n)),uf.of(n)]}const Mc=X.define({combine(n){return qi(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function o4(n={}){return[Mc.of(n),a4,c4,u4,gT.of(!0)]}function PT(n){return n.startState.facet(Mc)!=n.state.facet(Mc)}const a4=$T({above:!0,markers(n){let{state:e}=n,t=e.facet(Mc),i=[];for(let s of e.selection.ranges){let l=s==e.selection.main;if(s.empty||t.drawRangeCursor){let a=l?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",u=s.empty?s:P.cursor(s.head,s.head>s.anchor?-1:1);for(let h of Qc.forRange(n,a,u))i.push(h)}}return i},update(n,e){n.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=PT(n);return t&&Hx(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){Hx(e.state,n)},class:"cm-cursorLayer"});function Hx(n,e){e.style.animationDuration=n.facet(Mc).cursorBlinkRate+"ms"}const c4=$T({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:Qc.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||PT(n)},class:"cm-selectionLayer"}),u4=nl.highest(J.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),GT=_e.define({map(n,e){return n==null?null:e.mapPos(n)}}),Ya=Kt.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,i)=>i.is(GT)?i.value:t,n)}}),h4=rt.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(Ya);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(Ya)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(Ya),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let i=n.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-i.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(Ya)!=n&&this.view.dispatch({effects:GT.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function f4(){return[Ya,h4]}function qx(n,e,t,i,s){e.lastIndex=0;for(let l=n.iterRange(t,i),a=t,u;!l.next().done;a+=l.value.length)if(!l.lineBreak)for(;u=e.exec(l.value);)s(a+u.index,u)}function d4(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let i=[];for(let{from:s,to:l}of t)s=Math.max(n.state.doc.lineAt(s).from,s-e),l=Math.min(n.state.doc.lineAt(l).to,l+e),i.length&&i[i.length-1].to>=s?i[i.length-1].to=l:i.push({from:s,to:l});return i}class g4{constructor(e){const{regexp:t,decoration:i,decorate:s,boundary:l,maxLength:a=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,s)this.addMatch=(u,h,d,g)=>s(g,d,d+u[0].length,u,h);else if(typeof i=="function")this.addMatch=(u,h,d,g)=>{let m=i(u,h,d);m&&g(d,d+u[0].length,m)};else if(i)this.addMatch=(u,h,d,g)=>g(d,d+u[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=l,this.maxLength=a}createDeco(e){let t=new fs,i=t.add.bind(t);for(let{from:s,to:l}of d4(e,this.maxLength))qx(e.state.doc,this.regexp,s,l,(a,u)=>this.addMatch(u,e,a,i));return t.finish()}updateDeco(e,t){let i=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((l,a,u,h)=>{h>=e.view.viewport.from&&u<=e.view.viewport.to&&(i=Math.min(u,i),s=Math.max(h,s))}),e.viewportMoved||s-i>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,t.map(e.changes),i,s):t}updateRange(e,t,i,s){for(let l of e.visibleRanges){let a=Math.max(l.from,i),u=Math.min(l.to,s);if(u>=a){let h=e.state.doc.lineAt(a),d=h.to<u?e.state.doc.lineAt(u):h,g=Math.max(l.from,h.from),m=Math.min(l.to,d.to);if(this.boundary){for(;a>h.from;a--)if(this.boundary.test(h.text[a-1-h.from])){g=a;break}for(;u<d.to;u++)if(this.boundary.test(d.text[u-d.from])){m=u;break}}let b=[],v,S=(_,k,A)=>b.push(A.range(_,k));if(h==d)for(this.regexp.lastIndex=g-h.from;(v=this.regexp.exec(h.text))&&v.index<m-h.from;)this.addMatch(v,e,v.index+h.from,S);else qx(e.state.doc,this.regexp,g,m,(_,k)=>this.addMatch(k,e,_,S));t=t.update({filterFrom:g,filterTo:m,filter:(_,k)=>_<g||k>m,add:b})}}return t}}const dy=/x/.unicode!=null?"gu":"g",p4=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,dy),m4={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Lm=null;function y4(){var n;if(Lm==null&&typeof document<"u"&&document.body){let e=document.body.style;Lm=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return Lm||!1}const hf=X.define({combine(n){let e=qi(n,{render:null,specialChars:p4,addSpecialChars:null});return(e.replaceTabs=!y4())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,dy)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,dy)),e}});function b4(n={}){return[hf.of(n),v4()]}let Vx=null;function v4(){return Vx||(Vx=rt.fromClass(class{constructor(n){this.view=n,this.decorations=ae.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(hf)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new g4({regexp:n.specialChars,decoration:(e,t,i)=>{let{doc:s}=t.state,l=fn(e[0],0);if(l==9){let a=s.lineAt(i),u=t.state.tabSize,h=Io(a.text,u,i-a.from);return ae.replace({widget:new x4((u-h%u)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[l]||(this.decorationCache[l]=ae.replace({widget:new _4(n,l)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(hf);n.startState.facet(hf)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const w4="";function S4(n){return n>=32?w4:n==10?"":String.fromCharCode(9216+n)}class _4 extends Vi{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=S4(this.code),i=e.state.phrase("Control character")+" "+(m4[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,i,t);if(s)return s;let l=document.createElement("span");return l.textContent=t,l.title=i,l.setAttribute("aria-label",i),l.className="cm-specialChar",l}ignoreEvent(){return!1}}class x4 extends Vi{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function k4(){return C4}const A4=ae.line({class:"cm-activeLine"}),C4=rt.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let i of n.state.selection.ranges){let s=n.lineBlockAt(i.head);s.from>e&&(t.push(A4.range(s.from)),e=s.from)}return ae.set(t)}},{decorations:n=>n.decorations}),gy=2e3;function T4(n,e,t){let i=Math.min(e.line,t.line),s=Math.max(e.line,t.line),l=[];if(e.off>gy||t.off>gy||e.col<0||t.col<0){let a=Math.min(e.off,t.off),u=Math.max(e.off,t.off);for(let h=i;h<=s;h++){let d=n.doc.line(h);d.length<=u&&l.push(P.range(d.from+a,d.to+u))}}else{let a=Math.min(e.col,t.col),u=Math.max(e.col,t.col);for(let h=i;h<=s;h++){let d=n.doc.line(h),g=W0(d.text,a,n.tabSize,!0);if(g<0)l.push(P.cursor(d.to));else{let m=W0(d.text,u,n.tabSize);l.push(P.range(d.from+g,d.from+m))}}}return l}function E4(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function $x(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),i=n.state.doc.lineAt(t),s=t-i.from,l=s>gy?-1:s==i.length?E4(n,e.clientX):Io(i.text,n.state.tabSize,t-i.from);return{line:i.number,col:l,off:s}}function O4(n,e){let t=$x(n,e),i=n.state.selection;return t?{update(s){if(s.docChanged){let l=s.changes.mapPos(s.startState.doc.line(t.line).from),a=s.state.doc.lineAt(l);t={line:a.number,col:t.col,off:Math.min(t.off,a.length)},i=i.map(s.changes)}},get(s,l,a){let u=$x(n,s);if(!u)return i;let h=T4(n.state,t,u);return h.length?a?P.create(h.concat(i.ranges)):P.create(h):i}}:null}function D4(n){let e=(t=>t.altKey&&t.button==0);return J.mouseSelectionStyle.of((t,i)=>e(i)?O4(t,i):null)}const M4={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},R4={style:"cursor: crosshair"};function L4(n={}){let[e,t]=M4[n.key||"Alt"],i=rt.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventObservers:{keydown(s){this.set(s.keyCode==e||t(s))},keyup(s){(s.keyCode==e||!t(s))&&this.set(!1)},mousemove(s){this.set(t(s))}}});return[i,J.contentAttributes.of(s=>{var l;return!((l=s.plugin(i))===null||l===void 0)&&l.isDown?R4:null})]}const $h="-10000px";class KT{constructor(e,t,i,s){this.facet=t,this.createTooltipView=i,this.removeTooltipView=s,this.input=e.state.facet(t),this.tooltips=this.input.filter(a=>a);let l=null;this.tooltipViews=this.tooltips.map(a=>l=i(a,l))}update(e,t){var i;let s=e.state.facet(this.facet),l=s.filter(h=>h);if(s===this.input){for(let h of this.tooltipViews)h.update&&h.update(e);return!1}let a=[],u=t?[]:null;for(let h=0;h<l.length;h++){let d=l[h],g=-1;if(d){for(let m=0;m<this.tooltips.length;m++){let b=this.tooltips[m];b&&b.create==d.create&&(g=m)}if(g<0)a[h]=this.createTooltipView(d,h?a[h-1]:null),u&&(u[h]=!!d.above);else{let m=a[h]=this.tooltipViews[g];u&&(u[h]=t[g]),m.update&&m.update(e)}}}for(let h of this.tooltipViews)a.indexOf(h)<0&&(this.removeTooltipView(h),(i=h.destroy)===null||i===void 0||i.call(h));return t&&(u.forEach((h,d)=>t[d]=h),t.length=u.length),this.input=s,this.tooltips=l,this.tooltipViews=a,!0}}function N4(n){let e=n.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const Nm=X.define({combine:n=>{var e,t,i;return{position:Z.ios?"absolute":((e=n.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(s=>s.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=n.find(s=>s.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||N4}}}),Px=new WeakMap,Sb=rt.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(Nm);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new KT(n,_b,(t,i)=>this.createTooltip(t,i),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,i=n.state.facet(Nm);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),i=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",t.dom.appendChild(s)}return t.dom.style.position=this.position,t.dom.style.top=$h,t.dom.style.left="0px",this.container.insertBefore(t.dom,i),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(n=i.destroy)===null||n===void 0||n.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:l}=this.manager.tooltipViews[0];if(Z.safari){let a=l.getBoundingClientRect();t=Math.abs(a.top+1e4)>1||Math.abs(a.left)>1}else t=!!l.offsetParent&&l.offsetParent!=this.container.ownerDocument.body}if(t||this.position=="absolute")if(this.parent){let l=this.parent.getBoundingClientRect();l.width&&l.height&&(n=l.width/this.parent.offsetWidth,e=l.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:e}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),s=mb(this.view);return{visible:{left:i.left+s.left,top:i.top+s.top,right:i.right-s.right,bottom:i.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((l,a)=>{let u=this.manager.tooltipViews[a];return u.getCoords?u.getCoords(l.pos):this.view.coordsAtPos(l.pos)}),size:this.manager.tooltipViews.map(({dom:l})=>l.getBoundingClientRect()),space:this.view.state.facet(Nm).tooltipSpace(this.view),scaleX:n,scaleY:e,makeAbsolute:t}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let u of this.manager.tooltipViews)u.dom.style.position="absolute"}let{visible:t,space:i,scaleX:s,scaleY:l}=n,a=[];for(let u=0;u<this.manager.tooltips.length;u++){let h=this.manager.tooltips[u],d=this.manager.tooltipViews[u],{dom:g}=d,m=n.pos[u],b=n.size[u];if(!m||h.clip!==!1&&(m.bottom<=Math.max(t.top,i.top)||m.top>=Math.min(t.bottom,i.bottom)||m.right<Math.max(t.left,i.left)-.1||m.left>Math.min(t.right,i.right)+.1)){g.style.top=$h;continue}let v=h.arrow?d.dom.querySelector(".cm-tooltip-arrow"):null,S=v?7:0,_=b.right-b.left,k=(e=Px.get(d))!==null&&e!==void 0?e:b.bottom-b.top,A=d.offset||U4,M=this.view.textDirection==Qe.LTR,O=b.width>i.right-i.left?M?i.left:i.right-b.width:M?Math.max(i.left,Math.min(m.left-(v?14:0)+A.x,i.right-_)):Math.min(Math.max(i.left,m.left-_+(v?14:0)-A.x),i.right-_),z=this.above[u];!h.strictSide&&(z?m.top-k-S-A.y<i.top:m.bottom+k+S+A.y>i.bottom)&&z==i.bottom-m.bottom>m.top-i.top&&(z=this.above[u]=!z);let q=(z?m.top-i.top:i.bottom-m.bottom)-S;if(q<k&&d.resize!==!1){if(q<this.view.defaultLineHeight){g.style.top=$h;continue}Px.set(d,k),g.style.height=(k=q)/l+"px"}else g.style.height&&(g.style.height="");let V=z?m.top-k-S-A.y:m.bottom+S+A.y,j=O+_;if(d.overlap!==!0)for(let ee of a)ee.left<j&&ee.right>O&&ee.top<V+k&&ee.bottom>V&&(V=z?ee.top-k-2-S:ee.bottom+S+2);if(this.position=="absolute"?(g.style.top=(V-n.parent.top)/l+"px",Gx(g,(O-n.parent.left)/s)):(g.style.top=V/l+"px",Gx(g,O/s)),v){let ee=m.left+(M?A.x:-A.x)-(O+14-7);v.style.left=ee/s+"px"}d.overlap!==!0&&a.push({left:O,top:V,right:j,bottom:V+k}),g.classList.toggle("cm-tooltip-above",z),g.classList.toggle("cm-tooltip-below",!z),d.positioned&&d.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=$h}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Gx(n,e){let t=parseInt(n.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(n.style.left=e+"px")}const B4=J.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),U4={x:0,y:0},_b=X.define({enables:[Sb,B4]}),qf=X.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class xd{static create(e){return new xd(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new KT(e,qf,(t,i)=>this.createHostedView(t,i),t=>t.dom.remove())}createHostedView(e,t){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let i of this.manager.tooltipViews){let s=i[e];if(s!==void 0){if(t===void 0)t=s;else if(t!==s)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const j4=_b.compute([qf],n=>{let e=n.facet(qf);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var i;return(i=t.end)!==null&&i!==void 0?i:t.pos})),create:xd.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class z4{constructor(e,t,i,s,l){this.view=e,this.source=t,this.field=i,this.setHover=s,this.hoverTime=l,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,i=e.docView.tile.nearest(t.target);if(!i)return;let s,l=1;if(i.isWidget())s=i.posAtStart;else{if(s=e.posAtCoords(t),s==null)return;let u=e.coordsAtPos(s);if(!u||t.y<u.top||t.y>u.bottom||t.x<u.left-e.defaultCharacterWidth||t.x>u.right+e.defaultCharacterWidth)return;let h=e.bidiSpans(e.state.doc.lineAt(s)).find(g=>g.from<=s&&g.to>=s),d=h&&h.dir==Qe.RTL?-1:1;l=t.x<u.left?-d:d}let a=this.source(e,s,l);if(a?.then){let u=this.pending={pos:s};a.then(h=>{this.pending==u&&(this.pending=null,h&&!(Array.isArray(h)&&!h.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(h)?h:[h])}))},h=>mn(e.state,h,"hover tooltip"))}else a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}get tooltip(){let e=this.view.plugin(Sb),t=e?e.manager.tooltips.findIndex(i=>i.create==xd.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:s,tooltip:l}=this;if(s.length&&l&&!I4(l.dom,e)||this.pending){let{pos:a}=s[0]||this.pending,u=(i=(t=s[0])===null||t===void 0?void 0:t.end)!==null&&i!==void 0?i:a;(a==u?this.view.posAtCoords(this.lastMove)!=a:!H4(this.view,a,u,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=i=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),clearTimeout(this.restartTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Ph=4;function I4(n,e){let{left:t,right:i,top:s,bottom:l}=n.getBoundingClientRect(),a;if(a=n.querySelector(".cm-tooltip-arrow")){let u=a.getBoundingClientRect();s=Math.min(u.top,s),l=Math.max(u.bottom,l)}return e.clientX>=t-Ph&&e.clientX<=i+Ph&&e.clientY>=s-Ph&&e.clientY<=l+Ph}function H4(n,e,t,i,s,l){let a=n.scrollDOM.getBoundingClientRect(),u=n.documentTop+n.documentPadding.top+n.contentHeight;if(a.left>i||a.right<i||a.top>s||Math.min(a.bottom,u)<s)return!1;let h=n.posAtCoords({x:i,y:s},!1);return h>=e&&h<=t}function q4(n,e={}){let t=_e.define(),i=Kt.define({create(){return[]},update(s,l){if(s.length&&(e.hideOnChange&&(l.docChanged||l.selection)?s=[]:e.hideOn&&(s=s.filter(a=>!e.hideOn(l,a))),l.docChanged)){let a=[];for(let u of s){let h=l.changes.mapPos(u.pos,-1,tn.TrackDel);if(h!=null){let d=Object.assign(Object.create(null),u);d.pos=h,d.end!=null&&(d.end=l.changes.mapPos(d.end)),a.push(d)}}s=a}for(let a of l.effects)a.is(t)&&(s=a.value),a.is(V4)&&(s=[]);return s},provide:s=>qf.from(s)});return{active:i,extension:[i,rt.define(s=>new z4(s,n,i,t,e.hoverTime||300)),j4]}}function WT(n,e){let t=n.plugin(Sb);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}const V4=_e.define(),Kx=X.define({combine(n){let e,t;for(let i of n)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function xb(n,e){let t=n.plugin(YT),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const YT=rt.fromClass(class{constructor(n){this.input=n.state.facet(Rc),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(Kx);this.top=new Gh(n,!0,e.topContainer),this.bottom=new Gh(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(Kx);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Gh(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Gh(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Rc);if(t!=this.input){let i=t.filter(h=>h),s=[],l=[],a=[],u=[];for(let h of i){let d=this.specs.indexOf(h),g;d<0?(g=h(n.view),u.push(g)):(g=this.panels[d],g.update&&g.update(n)),s.push(g),(g.top?l:a).push(g)}this.specs=i,this.panels=s,this.top.sync(l),this.bottom.sync(a);for(let h of u)h.dom.classList.add("cm-panel"),h.mount&&h.mount()}else for(let i of this.panels)i.update&&i.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>J.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Gh{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Wx(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Wx(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Wx(n){let e=n.nextSibling;return n.remove(),e}const Rc=X.define({enables:YT});function $4(n,e){let t,i=new Promise(a=>t=a),s=a=>P4(a,e,t);n.state.field(Bm,!1)?n.dispatch({effects:FT.of(s)}):n.dispatch({effects:_e.appendConfig.of(Bm.init(()=>[s]))});let l=JT.of(s);return{close:l,result:i.then(a=>((n.win.queueMicrotask||(h=>n.win.setTimeout(h,10)))(()=>{n.state.field(Bm).indexOf(s)>-1&&n.dispatch({effects:l})}),a))}}const Bm=Kt.define({create(){return[]},update(n,e){for(let t of e.effects)t.is(FT)?n=[t.value].concat(n):t.is(JT)&&(n=n.filter(i=>i!=t.value));return n},provide:n=>Rc.computeN([n],e=>e.field(n))}),FT=_e.define(),JT=_e.define();function P4(n,e,t){let i=e.content?e.content(n,()=>a(null)):null;if(!i){if(i=We("form"),e.input){let u=We("input",e.input);/^(text|password|number|email|tel|url)$/.test(u.type)&&u.classList.add("cm-textfield"),u.name||(u.name="input"),i.appendChild(We("label",(e.label||"")+": ",u))}else i.appendChild(document.createTextNode(e.label||""));i.appendChild(document.createTextNode(" ")),i.appendChild(We("button",{class:"cm-button",type:"submit"},e.submitLabel||"OK"))}let s=i.nodeName=="FORM"?[i]:i.querySelectorAll("form");for(let u=0;u<s.length;u++){let h=s[u];h.addEventListener("keydown",d=>{d.keyCode==27?(d.preventDefault(),a(null)):d.keyCode==13&&(d.preventDefault(),a(h))}),h.addEventListener("submit",d=>{d.preventDefault(),a(h)})}let l=We("div",i,We("button",{onclick:()=>a(null),"aria-label":n.state.phrase("close"),class:"cm-dialog-close",type:"button"},[""]));e.class&&(l.className=e.class),l.classList.add("cm-dialog");function a(u){l.contains(l.ownerDocument.activeElement)&&n.focus(),t(u)}return{dom:l,top:e.top,mount:()=>{if(e.focus){let u;typeof e.focus=="string"?u=i.querySelector(e.focus):u=i.querySelector("input")||i.querySelector("button"),u&&"select"in u?u.select():u&&"focus"in u&&u.focus()}}}}class gs extends er{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}gs.prototype.elementClass="";gs.prototype.toDOM=void 0;gs.prototype.mapMode=tn.TrackBefore;gs.prototype.startSide=gs.prototype.endSide=-1;gs.prototype.point=!0;const ff=X.define(),G4=X.define(),K4={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Ee.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},sc=X.define();function W4(n){return[XT(),sc.of({...K4,...n})]}const Yx=X.define({combine:n=>n.some(e=>e)});function XT(n){return[Y4]}const Y4=rt.fromClass(class{constructor(n){this.view=n,this.domAfter=null,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(sc).map(e=>new Jx(n,e)),this.fixed=!n.state.facet(Yx);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}if(n.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(Yx)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let t=Ee.iter(this.view.state.facet(ff),this.view.viewport.from),i=[],s=this.gutters.map(l=>new F4(l,this.view.viewport,-this.view.documentPadding.top));for(let l of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(l.type)){let a=!0;for(let u of l.type)if(u.type==Gt.Text&&a){py(t,i,u.from);for(let h of s)h.line(this.view,u,i);a=!1}else if(u.widget)for(let h of s)h.widget(this.view,u)}else if(l.type==Gt.Text){py(t,i,l.from);for(let a of s)a.line(this.view,l,i)}else if(l.widget)for(let a of s)a.widget(this.view,l);for(let l of s)l.finish();n&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(n){let e=n.startState.facet(sc),t=n.state.facet(sc),i=n.docChanged||n.heightChanged||n.viewportChanged||!Ee.eq(n.startState.facet(ff),n.state.facet(ff),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let s of this.gutters)s.update(n)&&(i=!0);else{i=!0;let s=[];for(let l of t){let a=e.indexOf(l);a<0?s.push(new Jx(this.view,l)):(this.gutters[a].update(n),s.push(this.gutters[a]))}for(let l of this.gutters)l.dom.remove(),s.indexOf(l)<0&&l.destroy();for(let l of s)l.config.side=="after"?this.getDOMAfter().appendChild(l.dom):this.dom.appendChild(l.dom);this.gutters=s}return i}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:n=>J.scrollMargins.of(e=>{let t=e.plugin(n);if(!t||t.gutters.length==0||!t.fixed)return null;let i=t.dom.offsetWidth*e.scaleX,s=t.domAfter?t.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==Qe.LTR?{left:i,right:s}:{right:i,left:s}})});function Fx(n){return Array.isArray(n)?n:[n]}function py(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class F4{constructor(e,t,i){this.gutter=e,this.height=i,this.i=0,this.cursor=Ee.iter(e.markers,t.from)}addElement(e,t,i){let{gutter:s}=this,l=(t.top-this.height)/e.scaleY,a=t.height/e.scaleY;if(this.i==s.elements.length){let u=new QT(e,a,l,i);s.elements.push(u),s.dom.appendChild(u.dom)}else s.elements[this.i].update(e,a,l,i);this.height=t.bottom,this.i++}line(e,t,i){let s=[];py(this.cursor,s,t.from),i.length&&(s=s.concat(i));let l=this.gutter.config.lineMarker(e,t,s);l&&s.unshift(l);let a=this.gutter;s.length==0&&!a.config.renderEmptyElements||this.addElement(e,t,s)}widget(e,t){let i=this.gutter.config.widgetMarker(e,t.widget,t),s=i?[i]:null;for(let l of e.state.facet(G4)){let a=l(e,t.widget,t);a&&(s||(s=[])).push(a)}s&&this.addElement(e,t,s)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Jx{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,s=>{let l=s.target,a;if(l!=this.dom&&this.dom.contains(l)){for(;l.parentNode!=this.dom;)l=l.parentNode;let h=l.getBoundingClientRect();a=(h.top+h.bottom)/2}else a=s.clientY;let u=e.lineBlockAtHeight(a-e.documentTop);t.domEventHandlers[i](e,u,s)&&s.preventDefault()});this.markers=Fx(t.markers(e)),t.initialSpacer&&(this.spacer=new QT(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Fx(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let i=e.view.viewport;return!Ee.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class QT{constructor(e,t,i,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,s)}update(e,t,i,s){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),J4(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,t){let i="cm-gutterElement",s=this.dom.firstChild;for(let l=0,a=0;;){let u=a,h=l<t.length?t[l++]:null,d=!1;if(h){let g=h.elementClass;g&&(i+=" "+g);for(let m=a;m<this.markers.length;m++)if(this.markers[m].compare(h)){u=m,d=!0;break}}else u=this.markers.length;for(;a<u;){let g=this.markers[a++];if(g.toDOM){g.destroy(s);let m=s.nextSibling;s.remove(),s=m}}if(!h)break;h.toDOM&&(d?s=s.nextSibling:this.dom.insertBefore(h.toDOM(e),s)),d&&a++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function J4(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const X4=X.define(),Q4=X.define(),io=X.define({combine(n){return qi(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let s in t){let l=i[s],a=t[s];i[s]=l?(u,h,d)=>l(u,h,d)||a(u,h,d):a}return i}})}});class Um extends gs{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function jm(n,e){return n.state.facet(io).formatNumber(e,n.state)}const Z4=sc.compute([io],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(X4)},lineMarker(e,t,i){return i.some(s=>s.toDOM)?null:new Um(jm(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,i)=>{for(let s of e.state.facet(Q4)){let l=s(e,t,i);if(l)return l}return null},lineMarkerChange:e=>e.startState.facet(io)!=e.state.facet(io),initialSpacer(e){return new Um(jm(e,Xx(e.state.doc.lines)))},updateSpacer(e,t){let i=jm(t.view,Xx(t.view.state.doc.lines));return i==e.number?e:new Um(i)},domEventHandlers:n.facet(io).domEventHandlers,side:"before"}));function ej(n={}){return[io.of(n),XT(),Z4]}function Xx(n){let e=9;for(;e<n;)e=e*10+9;return e}const tj=new class extends gs{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},nj=ff.compute(["selection"],n=>{let e=[],t=-1;for(let i of n.selection.ranges){let s=n.doc.lineAt(i.head).from;s>t&&(t=s,e.push(tj.range(s)))}return Ee.of(e)});function ij(){return nj}const sj=1024;let rj=0;class zm{constructor(e,t){this.from=e,this.to=t}}class Be{constructor(e={}){this.id=rj++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=ii.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}Be.closedBy=new Be({deserialize:n=>n.split(" ")});Be.openedBy=new Be({deserialize:n=>n.split(" ")});Be.group=new Be({deserialize:n=>n.split(" ")});Be.isolate=new Be({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});Be.contextHash=new Be({perNode:!0});Be.lookAhead=new Be({perNode:!0});Be.mounted=new Be({perNode:!0});class rc{constructor(e,t,i,s=!1){this.tree=e,this.overlay=t,this.parser=i,this.bracketed=s}static get(e){return e&&e.props&&e.props[Be.mounted.id]}}const lj=Object.create(null);class ii{constructor(e,t,i,s=0){this.name=e,this.props=t,this.id=i,this.flags=s}static define(e){let t=e.props&&e.props.length?Object.create(null):lj,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new ii(e.name||"",t,e.id,i);if(e.props){for(let l of e.props)if(Array.isArray(l)||(l=l(s)),l){if(l[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[l[0].id]=l[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Be.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let s of i.split(" "))t[s]=e[i];return i=>{for(let s=i.prop(Be.group),l=-1;l<(s?s.length:0);l++){let a=t[l<0?i.name:s[l]];if(a)return a}}}}ii.none=new ii("",Object.create(null),0,8);const Kh=new WeakMap,Qx=new WeakMap;var dt;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays",n[n.EnterBracketed=16]="EnterBracketed"})(dt||(dt={}));class Pt{constructor(e,t,i,s,l){if(this.type=e,this.children=t,this.positions=i,this.length=s,this.props=null,l&&l.length){this.props=Object.create(null);for(let[a,u]of l)this.props[typeof a=="number"?a:a.id]=u}}toString(){let e=rc.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let s=i.toString();s&&(t&&(t+=","),t+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new yy(this.topNode,e)}cursorAt(e,t=0,i=0){let s=Kh.get(this)||this.topNode,l=new yy(s);return l.moveTo(e,t),Kh.set(this,l._tree),l}get topNode(){return new ti(this,0,0,null)}resolve(e,t=0){let i=Lc(Kh.get(this)||this.topNode,e,t,!1);return Kh.set(this,i),i}resolveInner(e,t=0){let i=Lc(Qx.get(this)||this.topNode,e,t,!0);return Qx.set(this,i),i}resolveStack(e,t=0){return cj(this,e,t)}iterate(e){let{enter:t,leave:i,from:s=0,to:l=this.length}=e,a=e.mode||0,u=(a&dt.IncludeAnonymous)>0;for(let h=this.cursor(a|dt.IncludeAnonymous);;){let d=!1;if(h.from<=l&&h.to>=s&&(!u&&h.type.isAnonymous||t(h)!==!1)){if(h.firstChild())continue;d=!0}for(;d&&i&&(u||!h.type.isAnonymous)&&i(h),!h.nextSibling();){if(!h.parent())return;d=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Cb(ii.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,s)=>new Pt(this.type,t,i,s,this.propValues),e.makeTree||((t,i,s)=>new Pt(ii.none,t,i,s)))}static build(e){return uj(e)}}Pt.empty=new Pt(ii.none,[],[],0);class kb{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new kb(this.buffer,this.index)}}class sr{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return ii.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],s=this.set.types[t],l=s.name;if(/\W/.test(l)&&!s.isError&&(l=JSON.stringify(l)),e+=4,i==e)return l;let a=[];for(;e<i;)a.push(this.childString(e)),e=this.buffer[e+3];return l+"("+a.join(",")+")"}findChild(e,t,i,s,l){let{buffer:a}=this,u=-1;for(let h=e;h!=t&&!(ZT(l,s,a[h+1],a[h+2])&&(u=h,i>0));h=a[h+3]);return u}slice(e,t,i){let s=this.buffer,l=new Uint16Array(t-e),a=0;for(let u=e,h=0;u<t;){l[h++]=s[u++],l[h++]=s[u++]-i;let d=l[h++]=s[u++]-i;l[h++]=s[u++]-e,a=Math.max(a,d)}return new sr(l,a,this.set)}}function ZT(n,e,t,i){switch(n){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function Lc(n,e,t,i){for(var s;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let a=!i&&n instanceof ti&&n.index<0?null:n.parent;if(!a)return n;n=a}let l=i?0:dt.IgnoreOverlays;if(i)for(let a=n,u=a.parent;u;a=u,u=a.parent)a instanceof ti&&a.index<0&&((s=u.enter(e,t,l))===null||s===void 0?void 0:s.from)!=a.from&&(n=u);for(;;){let a=n.enter(e,t,l);if(!a)return n;n=a}}class eE{cursor(e=0){return new yy(this,e)}getChild(e,t=null,i=null){let s=Zx(this,e,t,i);return s.length?s[0]:null}getChildren(e,t=null,i=null){return Zx(this,e,t,i)}resolve(e,t=0){return Lc(this,e,t,!1)}resolveInner(e,t=0){return Lc(this,e,t,!0)}matchContext(e){return my(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),i=this;for(;t;){let s=t.lastChild;if(!s||s.to!=t.to)break;s.type.isError&&s.from==s.to?(i=t,t=s.prevSibling):t=s}return i}get node(){return this}get next(){return this.parent}}class ti extends eE{constructor(e,t,i,s){super(),this._tree=e,this.from=t,this.index=i,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,s,l=0){for(let a=this;;){for(let{children:u,positions:h}=a._tree,d=t>0?u.length:-1;e!=d;e+=t){let g=u[e],m=h[e]+a.from,b;if(!(!(l&dt.EnterBracketed&&g instanceof Pt&&(b=rc.get(g))&&!b.overlay&&b.bracketed&&i>=m&&i<=m+g.length)&&!ZT(s,i,m,m+g.length))){if(g instanceof sr){if(l&dt.ExcludeBuffers)continue;let v=g.findChild(0,g.buffer.length,t,i-m,s);if(v>-1)return new Xs(new oj(a,g,e,m),null,v)}else if(l&dt.IncludeAnonymous||!g.type.isAnonymous||Ab(g)){let v;if(!(l&dt.IgnoreMounts)&&(v=rc.get(g))&&!v.overlay)return new ti(v.tree,m,e,a);let S=new ti(g,m,e,a);return l&dt.IncludeAnonymous||!S.type.isAnonymous?S:S.nextChild(t<0?g.children.length-1:0,t,i,s,l)}}}if(l&dt.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,t,i=0){let s;if(!(i&dt.IgnoreOverlays)&&(s=rc.get(this._tree))&&s.overlay){let l=e-this.from,a=i&dt.EnterBracketed&&s.bracketed;for(let{from:u,to:h}of s.overlay)if((t>0||a?u<=l:u<l)&&(t<0||a?h>=l:h>l))return new ti(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Zx(n,e,t,i){let s=n.cursor(),l=[];if(!s.firstChild())return l;if(t!=null){for(let a=!1;!a;)if(a=s.type.is(t),!s.nextSibling())return l}for(;;){if(i!=null&&s.type.is(i))return l;if(s.type.is(e)&&l.push(s.node),!s.nextSibling())return i==null?l:[]}}function my(n,e,t=e.length-1){for(let i=n;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class oj{constructor(e,t,i,s){this.parent=e,this.buffer=t,this.index=i,this.start=s}}class Xs extends eE{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,i){super(),this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,t,i){let{buffer:s}=this.context,l=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.context.start,i);return l<0?null:new Xs(this.context,this,l)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,t,i=0){if(i&dt.ExcludeBuffers)return null;let{buffer:s}=this.context,l=s.findChild(this.index+4,s.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return l<0?null:new Xs(this.context,this,l)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Xs(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Xs(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,s=this.index+4,l=i.buffer[this.index+3];if(l>s){let a=i.buffer[this.index+1];e.push(i.slice(s,l,a)),t.push(0)}return new Pt(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function tE(n){if(!n.length)return null;let e=0,t=n[0];for(let l=1;l<n.length;l++){let a=n[l];(a.from>t.from||a.to<t.to)&&(t=a,e=l)}let i=t instanceof ti&&t.index<0?null:t.parent,s=n.slice();return i?s[e]=i:s.splice(e,1),new aj(s,t)}class aj{constructor(e,t){this.heads=e,this.node=t}get next(){return tE(this.heads)}}function cj(n,e,t){let i=n.resolveInner(e,t),s=null;for(let l=i instanceof ti?i:i.context.parent;l;l=l.parent)if(l.index<0){let a=l.parent;(s||(s=[i])).push(a.resolve(e,t)),l=a}else{let a=rc.get(l.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let u=new ti(a.tree,a.overlay[0].from+l.from,-1,l);(s||(s=[i])).push(Lc(u,e,t,!1))}}return s?tE(s):i}class yy{get name(){return this.type.name}constructor(e,t=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=t&~dt.EnterBracketed,e instanceof ti)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:s}=this.buffer;return this.type=t||s.set.types[s.buffer[e]],this.from=i+s.buffer[e+1],this.to=i+s.buffer[e+2],!0}yield(e){return e?e instanceof ti?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:s}=this.buffer,l=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.buffer.start,i);return l<0?!1:(this.stack.push(this.index),this.yieldBuf(l))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&dt.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&dt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&dt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let s=i<0?0:this.stack[i]+4;if(this.index!=s)return this.yieldBuf(t.findChild(s,this.index,-1,0,4))}else{let s=t.buffer[this.index+3];if(s<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(s)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let l=0;l<this.index;l++)if(s.buffer.buffer[l+3]<this.index)return!1;({index:t,parent:i}=s)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let l=t+e,a=e<0?-1:i._tree.children.length;l!=a;l+=e){let u=i._tree.children[l];if(this.mode&dt.IncludeAnonymous||u instanceof sr||!u.type.isAnonymous||Ab(u))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let s=this.index,l=this.stack.length;l>=0;){for(let a=e;a;a=a._parent)if(a.index==s){if(s==this.index)return a;t=a,i=l+1;break e}s=this.stack[--l]}for(let s=i;s<this.stack.length;s++)t=new Xs(this.buffer,t,this.stack[s]);return this.bufferNode=new Xs(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&t&&t(this),s=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,s=!0}}}matchContext(e){if(!this.buffer)return my(this.node.parent,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let s=e.length-1,l=this.stack.length-1;s>=0;l--){if(l<0)return my(this._tree,e,s);let a=i[t.buffer[this.stack[l]]];if(!a.isAnonymous){if(e[s]&&e[s]!=a.name)return!1;s--}}return!0}}function Ab(n){return n.children.some(e=>e instanceof sr||!e.type.isAnonymous||Ab(e))}function uj(n){var e;let{buffer:t,nodeSet:i,maxBufferLength:s=sj,reused:l=[],minRepeatType:a=i.types.length}=n,u=Array.isArray(t)?new kb(t,t.length):t,h=i.types,d=0,g=0;function m(q,V,j,ee,se,Me){let{id:he,start:te,end:oe,size:fe}=u,ye=g,B=d;if(fe<0)if(u.next(),fe==-1){let T=l[he];j.push(T),ee.push(te-q);return}else if(fe==-3){d=he;return}else if(fe==-4){g=he;return}else throw new RangeError(`Unrecognized record size: ${fe}`);let K=h[he],re,me,Ae=te-q;if(oe-te<=s&&(me=k(u.pos-V,se))){let T=new Uint16Array(me.size-me.skip),H=u.pos-me.size,W=T.length;for(;u.pos>H;)W=A(me.start,T,W);re=new sr(T,oe-me.start,i),Ae=me.start-q}else{let T=u.pos-fe;u.next();let H=[],W=[],Q=he>=a?he:-1,ge=0,ve=oe;for(;u.pos>T;)Q>=0&&u.id==Q&&u.size>=0?(u.end<=ve-s&&(S(H,W,te,ge,u.end,ve,Q,ye,B),ge=H.length,ve=u.end),u.next()):Me>2500?b(te,T,H,W):m(te,T,H,W,Q,Me+1);if(Q>=0&&ge>0&&ge<H.length&&S(H,W,te,ge,te,ve,Q,ye,B),H.reverse(),W.reverse(),Q>-1&&ge>0){let Ue=v(K,B);re=Cb(K,H,W,0,H.length,0,oe-te,Ue,Ue)}else re=_(K,H,W,oe-te,ye-oe,B)}j.push(re),ee.push(Ae)}function b(q,V,j,ee){let se=[],Me=0,he=-1;for(;u.pos>V;){let{id:te,start:oe,end:fe,size:ye}=u;if(ye>4)u.next();else{if(he>-1&&oe<he)break;he<0&&(he=fe-s),se.push(te,oe,fe),Me++,u.next()}}if(Me){let te=new Uint16Array(Me*4),oe=se[se.length-2];for(let fe=se.length-3,ye=0;fe>=0;fe-=3)te[ye++]=se[fe],te[ye++]=se[fe+1]-oe,te[ye++]=se[fe+2]-oe,te[ye++]=ye;j.push(new sr(te,se[2]-oe,i)),ee.push(oe-q)}}function v(q,V){return(j,ee,se)=>{let Me=0,he=j.length-1,te,oe;if(he>=0&&(te=j[he])instanceof Pt){if(!he&&te.type==q&&te.length==se)return te;(oe=te.prop(Be.lookAhead))&&(Me=ee[he]+te.length+oe)}return _(q,j,ee,se,Me,V)}}function S(q,V,j,ee,se,Me,he,te,oe){let fe=[],ye=[];for(;q.length>ee;)fe.push(q.pop()),ye.push(V.pop()+j-se);q.push(_(i.types[he],fe,ye,Me-se,te-Me,oe)),V.push(se-j)}function _(q,V,j,ee,se,Me,he){if(Me){let te=[Be.contextHash,Me];he=he?[te].concat(he):[te]}if(se>25){let te=[Be.lookAhead,se];he=he?[te].concat(he):[te]}return new Pt(q,V,j,ee,he)}function k(q,V){let j=u.fork(),ee=0,se=0,Me=0,he=j.end-s,te={size:0,start:0,skip:0};e:for(let oe=j.pos-q;j.pos>oe;){let fe=j.size;if(j.id==V&&fe>=0){te.size=ee,te.start=se,te.skip=Me,Me+=4,ee+=4,j.next();continue}let ye=j.pos-fe;if(fe<0||ye<oe||j.start<he)break;let B=j.id>=a?4:0,K=j.start;for(j.next();j.pos>ye;){if(j.size<0)if(j.size==-3||j.size==-4)B+=4;else break e;else j.id>=a&&(B+=4);j.next()}se=K,ee+=fe,Me+=B}return(V<0||ee==q)&&(te.size=ee,te.start=se,te.skip=Me),te.size>4?te:void 0}function A(q,V,j){let{id:ee,start:se,end:Me,size:he}=u;if(u.next(),he>=0&&ee<a){let te=j;if(he>4){let oe=u.pos-(he-4);for(;u.pos>oe;)j=A(q,V,j)}V[--j]=te,V[--j]=Me-q,V[--j]=se-q,V[--j]=ee}else he==-3?d=ee:he==-4&&(g=ee);return j}let M=[],O=[];for(;u.pos>0;)m(n.start||0,n.bufferStart||0,M,O,-1,0);let z=(e=n.length)!==null&&e!==void 0?e:M.length?O[0]+M[0].length:0;return new Pt(h[n.topID],M.reverse(),O.reverse(),z)}const ek=new WeakMap;function df(n,e){if(!n.isAnonymous||e instanceof sr||e.type!=n)return 1;let t=ek.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=n||!(i instanceof Pt)){t=1;break}t+=df(n,i)}ek.set(e,t)}return t}function Cb(n,e,t,i,s,l,a,u,h){let d=0;for(let S=i;S<s;S++)d+=df(n,e[S]);let g=Math.ceil(d*1.5/8),m=[],b=[];function v(S,_,k,A,M){for(let O=k;O<A;){let z=O,q=_[O],V=df(n,S[O]);for(O++;O<A;O++){let j=df(n,S[O]);if(V+j>=g)break;V+=j}if(O==z+1){if(V>g){let j=S[z];v(j.children,j.positions,0,j.children.length,_[z]+M);continue}m.push(S[z])}else{let j=_[O-1]+S[O-1].length-q;m.push(Cb(n,S,_,z,O,q,j,null,h))}b.push(q+M-l)}}return v(e,t,i,s,0),(u||h)(m,b,a)}class $r{constructor(e,t,i,s,l=!1,a=!1){this.from=e,this.to=t,this.tree=i,this.offset=s,this.open=(l?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let s=[new $r(0,e.length,e,0,!1,i)];for(let l of t)l.to>e.length&&s.push(l);return s}static applyChanges(e,t,i=128){if(!t.length)return e;let s=[],l=1,a=e.length?e[0]:null;for(let u=0,h=0,d=0;;u++){let g=u<t.length?t[u]:null,m=g?g.fromA:1e9;if(m-h>=i)for(;a&&a.from<m;){let b=a;if(h>=b.from||m<=b.to||d){let v=Math.max(b.from,h)-d,S=Math.min(b.to,m)-d;b=v>=S?null:new $r(v,S,b.tree,b.offset+d,u>0,!!g)}if(b&&s.push(b),a.to>m)break;a=l<e.length?e[l++]:null}if(!g)break;h=g.toA,d=g.toA-g.toB}return s}}class hj{startParse(e,t,i){return typeof e=="string"&&(e=new fj(e)),i=i?i.length?i.map(s=>new zm(s.from,s.to)):[new zm(0,0)]:[new zm(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let s=this.startParse(e,t,i);for(;;){let l=s.advance();if(l)return l}}}class fj{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Be({perNode:!0});let dj=0;class Fn{constructor(e,t,i,s){this.name=e,this.set=t,this.base=i,this.modified=s,this.id=dj++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let i=typeof e=="string"?e:"?";if(e instanceof Fn&&(t=e),t?.base)throw new Error("Can not derive from a modified tag");let s=new Fn(i,[],null,[]);if(s.set.push(s),t)for(let l of t.set)s.set.push(l);return s}static defineModifier(e){let t=new Vf(e);return i=>i.modified.indexOf(t)>-1?i:Vf.get(i.base||i,i.modified.concat(t).sort((s,l)=>s.id-l.id))}}let gj=0;class Vf{constructor(e){this.name=e,this.instances=[],this.id=gj++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(u=>u.base==e&&pj(t,u.modified));if(i)return i;let s=[],l=new Fn(e.name,s,e,t);for(let u of t)u.instances.push(l);let a=mj(t);for(let u of e.set)if(!u.modified.length)for(let h of a)s.push(Vf.get(u,h));return l}}function pj(n,e){return n.length==e.length&&n.every((t,i)=>t==e[i])}function mj(n){let e=[[]];for(let t=0;t<n.length;t++)for(let i=0,s=e.length;i<s;i++)e.push(e[i].concat(n[t]));return e.sort((t,i)=>i.length-t.length)}function yj(n){let e=Object.create(null);for(let t in n){let i=n[t];Array.isArray(i)||(i=[i]);for(let s of t.split(" "))if(s){let l=[],a=2,u=s;for(let m=0;;){if(u=="..."&&m>0&&m+3==s.length){a=1;break}let b=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(u);if(!b)throw new RangeError("Invalid path: "+s);if(l.push(b[0]=="*"?"":b[0][0]=='"'?JSON.parse(b[0]):b[0]),m+=b[0].length,m==s.length)break;let v=s[m++];if(m==s.length&&v=="!"){a=0;break}if(v!="/")throw new RangeError("Invalid path: "+s);u=s.slice(m)}let h=l.length-1,d=l[h];if(!d)throw new RangeError("Invalid path: "+s);let g=new Nc(i,a,h>0?l.slice(0,h):null);e[d]=g.sort(e[d])}}return nE.add(e)}const nE=new Be({combine(n,e){let t,i,s;for(;n||e;){if(!n||e&&n.depth>=e.depth?(s=e,e=e.next):(s=n,n=n.next),t&&t.mode==s.mode&&!s.context&&!t.context)continue;let l=new Nc(s.tags,s.mode,s.context);t?t.next=l:i=l,t=l}return i}});class Nc{constructor(e,t,i,s){this.tags=e,this.mode=t,this.context=i,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Nc.empty=new Nc([],2,null);function iE(n,e){let t=Object.create(null);for(let l of n)if(!Array.isArray(l.tag))t[l.tag.id]=l.class;else for(let a of l.tag)t[a.id]=l.class;let{scope:i,all:s=null}=e||{};return{style:l=>{let a=s;for(let u of l)for(let h of u.set){let d=t[h.id];if(d){a=a?a+" "+d:d;break}}return a},scope:i}}function bj(n,e){let t=null;for(let i of n){let s=i.style(e);s&&(t=t?t+" "+s:s)}return t}function vj(n,e,t,i=0,s=n.length){let l=new wj(i,Array.isArray(e)?e:[e],t);l.highlightRange(n.cursor(),i,s,"",l.highlighters),l.flush(s)}class wj{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,s,l){let{type:a,from:u,to:h}=e;if(u>=i||h<=t)return;a.isTop&&(l=this.highlighters.filter(v=>!v.scope||v.scope(a)));let d=s,g=Sj(e)||Nc.empty,m=bj(l,g.tags);if(m&&(d&&(d+=" "),d+=m,g.mode==1&&(s+=(s?" ":"")+m)),this.startSpan(Math.max(t,u),d),g.opaque)return;let b=e.tree&&e.tree.prop(Be.mounted);if(b&&b.overlay){let v=e.node.enter(b.overlay[0].from+u,1),S=this.highlighters.filter(k=>!k.scope||k.scope(b.tree.type)),_=e.firstChild();for(let k=0,A=u;;k++){let M=k<b.overlay.length?b.overlay[k]:null,O=M?M.from+u:h,z=Math.max(t,A),q=Math.min(i,O);if(z<q&&_)for(;e.from<q&&(this.highlightRange(e,z,q,s,l),this.startSpan(Math.min(q,e.to),d),!(e.to>=O||!e.nextSibling())););if(!M||O>i)break;A=M.to+u,A>t&&(this.highlightRange(v.cursor(),Math.max(t,M.from+u),Math.min(i,A),"",S),this.startSpan(Math.min(i,A),d))}_&&e.parent()}else if(e.firstChild()){b&&(s="");do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,s,l),this.startSpan(Math.min(i,e.to),d)}while(e.nextSibling());e.parent()}}}function Sj(n){let e=n.type.prop(nE);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const Y=Fn.define,Wh=Y(),Ps=Y(),tk=Y(Ps),nk=Y(Ps),Gs=Y(),Yh=Y(Gs),Im=Y(Gs),Ei=Y(),Or=Y(Ei),Ci=Y(),Ti=Y(),by=Y(),Ha=Y(by),Fh=Y(),F={comment:Wh,lineComment:Y(Wh),blockComment:Y(Wh),docComment:Y(Wh),name:Ps,variableName:Y(Ps),typeName:tk,tagName:Y(tk),propertyName:nk,attributeName:Y(nk),className:Y(Ps),labelName:Y(Ps),namespace:Y(Ps),macroName:Y(Ps),literal:Gs,string:Yh,docString:Y(Yh),character:Y(Yh),attributeValue:Y(Yh),number:Im,integer:Y(Im),float:Y(Im),bool:Y(Gs),regexp:Y(Gs),escape:Y(Gs),color:Y(Gs),url:Y(Gs),keyword:Ci,self:Y(Ci),null:Y(Ci),atom:Y(Ci),unit:Y(Ci),modifier:Y(Ci),operatorKeyword:Y(Ci),controlKeyword:Y(Ci),definitionKeyword:Y(Ci),moduleKeyword:Y(Ci),operator:Ti,derefOperator:Y(Ti),arithmeticOperator:Y(Ti),logicOperator:Y(Ti),bitwiseOperator:Y(Ti),compareOperator:Y(Ti),updateOperator:Y(Ti),definitionOperator:Y(Ti),typeOperator:Y(Ti),controlOperator:Y(Ti),punctuation:by,separator:Y(by),bracket:Ha,angleBracket:Y(Ha),squareBracket:Y(Ha),paren:Y(Ha),brace:Y(Ha),content:Ei,heading:Or,heading1:Y(Or),heading2:Y(Or),heading3:Y(Or),heading4:Y(Or),heading5:Y(Or),heading6:Y(Or),contentSeparator:Y(Ei),list:Y(Ei),quote:Y(Ei),emphasis:Y(Ei),strong:Y(Ei),link:Y(Ei),monospace:Y(Ei),strikethrough:Y(Ei),inserted:Y(),deleted:Y(),changed:Y(),invalid:Y(),meta:Fh,documentMeta:Y(Fh),annotation:Y(Fh),processingInstruction:Y(Fh),definition:Fn.defineModifier("definition"),constant:Fn.defineModifier("constant"),function:Fn.defineModifier("function"),standard:Fn.defineModifier("standard"),local:Fn.defineModifier("local"),special:Fn.defineModifier("special")};for(let n in F){let e=F[n];e instanceof Fn&&(e.name=n)}iE([{tag:F.link,class:"tok-link"},{tag:F.heading,class:"tok-heading"},{tag:F.emphasis,class:"tok-emphasis"},{tag:F.strong,class:"tok-strong"},{tag:F.keyword,class:"tok-keyword"},{tag:F.atom,class:"tok-atom"},{tag:F.bool,class:"tok-bool"},{tag:F.url,class:"tok-url"},{tag:F.labelName,class:"tok-labelName"},{tag:F.inserted,class:"tok-inserted"},{tag:F.deleted,class:"tok-deleted"},{tag:F.literal,class:"tok-literal"},{tag:F.string,class:"tok-string"},{tag:F.number,class:"tok-number"},{tag:[F.regexp,F.escape,F.special(F.string)],class:"tok-string2"},{tag:F.variableName,class:"tok-variableName"},{tag:F.local(F.variableName),class:"tok-variableName tok-local"},{tag:F.definition(F.variableName),class:"tok-variableName tok-definition"},{tag:F.special(F.variableName),class:"tok-variableName2"},{tag:F.definition(F.propertyName),class:"tok-propertyName tok-definition"},{tag:F.typeName,class:"tok-typeName"},{tag:F.namespace,class:"tok-namespace"},{tag:F.className,class:"tok-className"},{tag:F.macroName,class:"tok-macroName"},{tag:F.propertyName,class:"tok-propertyName"},{tag:F.operator,class:"tok-operator"},{tag:F.comment,class:"tok-comment"},{tag:F.meta,class:"tok-meta"},{tag:F.invalid,class:"tok-invalid"},{tag:F.punctuation,class:"tok-punctuation"}]);var Hm;const Fa=new Be,_j=new Be;class Ri{constructor(e,t,i=[],s=""){this.data=e,this.name=s,je.prototype.hasOwnProperty("tree")||Object.defineProperty(je.prototype,"tree",{get(){return Jt(this)}}),this.parser=t,this.extension=[rr.of(this),je.languageData.of((l,a,u)=>{let h=ik(l,a,u),d=h.type.prop(Fa);if(!d)return[];let g=l.facet(d),m=h.type.prop(_j);if(m){let b=h.resolve(a-h.from,u);for(let v of m)if(v.test(b,l)){let S=l.facet(v.facet);return v.type=="replace"?S:S.concat(g)}}return g})].concat(i)}isActiveAt(e,t,i=-1){return ik(e,t,i).type.prop(Fa)==this.data}findRegions(e){let t=e.facet(rr);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],s=(l,a)=>{if(l.prop(Fa)==this.data){i.push({from:a,to:a+l.length});return}let u=l.prop(Be.mounted);if(u){if(u.tree.prop(Fa)==this.data){if(u.overlay)for(let h of u.overlay)i.push({from:h.from+a,to:h.to+a});else i.push({from:a,to:a+l.length});return}else if(u.overlay){let h=i.length;if(s(u.tree,u.overlay[0].from+a),i.length>h)return}}for(let h=0;h<l.children.length;h++){let d=l.children[h];d instanceof Pt&&s(d,l.positions[h]+a)}};return s(Jt(e),0),i}get allowsNesting(){return!0}}Ri.setState=_e.define();function ik(n,e,t){let i=n.facet(rr),s=Jt(n).topNode;if(!i||i.allowsNesting)for(let l=s;l;l=l.enter(e,t,dt.ExcludeBuffers|dt.EnterBracketed))l.type.isTop&&(s=l);return s}function Jt(n){let e=n.field(Ri.state,!1);return e?e.tree:Pt.empty}class xj{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let qa=null;class $f{constructor(e,t,i=[],s,l,a,u,h){this.parser=e,this.state=t,this.fragments=i,this.tree=s,this.treeLen=l,this.viewport=a,this.skipped=u,this.scheduleOn=h,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new $f(e,t,[],Pt.empty,0,i,[],null)}startParse(){return this.parser.startParse(new xj(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=Pt.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped($r.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped($r.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=qa;qa=this;try{return e()}finally{qa=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=sk(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:s,treeLen:l,viewport:a,skipped:u}=this;if(this.takeTree(),!e.empty){let h=[];if(e.iterChangedRanges((d,g,m,b)=>h.push({fromA:d,toA:g,fromB:m,toB:b})),i=$r.applyChanges(i,h),s=Pt.empty,l=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){u=[];for(let d of this.skipped){let g=e.mapPos(d.from,1),m=e.mapPos(d.to,-1);g<m&&u.push({from:g,to:m})}}}return new $f(this.parser,t,i,s,l,a,u,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:s,to:l}=this.skipped[i];s<e.to&&l>e.from&&(this.fragments=sk(this.fragments,s,l),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends hj{createParse(t,i,s){let l=s[0].from,a=s[s.length-1].to;return{parsedPos:l,advance(){let h=qa;if(h){for(let d of s)h.tempSkipped.push(d);e&&(h.scheduleOn=h.scheduleOn?Promise.all([h.scheduleOn,e]):e)}return this.parsedPos=a,new Pt(ii.none,[],[],a-l)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return qa}}function sk(n,e,t){return $r.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Mo{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new Mo(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=$f.create(e.facet(rr).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new Mo(i)}}Ri.state=Kt.define({create:Mo.init,update(n,e){for(let t of e.effects)if(t.is(Ri.setState))return t.value;return e.startState.facet(rr)!=e.state.facet(rr)?Mo.init(e.state):n.apply(e)}});let sE=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(sE=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const qm=typeof navigator<"u"&&(!((Hm=navigator.scheduling)===null||Hm===void 0)&&Hm.isInputPending)?()=>navigator.scheduling.isInputPending():null,kj=rt.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Ri.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Ri.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=sE(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:s}}=this.view,l=i.field(Ri.state);if(l.tree==l.context.tree&&l.context.isDone(s+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!qm?Math.max(25,e.timeRemaining()-5):1e9),u=l.context.treeLen<s&&i.doc.length>s+1e3,h=l.context.work(()=>qm&&qm()||Date.now()>a,s+(u?0:1e5));this.chunkBudget-=Date.now()-t,(h||this.chunkBudget<=0)&&(l.context.takeTree(),this.view.dispatch({effects:Ri.setState.of(new Mo(l.context))})),this.chunkBudget>0&&!(h&&!u)&&this.scheduleWork(),this.checkAsyncSchedule(l.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>mn(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),rr=X.define({combine(n){return n.length?n[0]:null},enables:n=>[Ri.state,kj,J.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]}),Aj=X.define(),Tb=X.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function Pf(n){let e=n.facet(Tb);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function Bc(n,e){let t="",i=n.tabSize,s=n.facet(Tb)[0];if(s=="	"){for(;e>=i;)t+="	",e-=i;s=" "}for(let l=0;l<e;l++)t+=s;return t}function Eb(n,e){n instanceof je&&(n=new kd(n));for(let i of n.state.facet(Aj)){let s=i(n,e);if(s!==void 0)return s}let t=Jt(n.state);return t.length>=e?Tj(n,t,e):null}class kd{constructor(e,t={}){this.state=e,this.options=t,this.unit=Pf(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:l}=this.options;return s!=null&&s>=i.from&&s<=i.to?l&&s==e?{text:"",from:e}:(t<0?s<e:s<=e)?{text:i.text.slice(s-i.from),from:s}:{text:i.text.slice(0,s-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:s}=this.lineAt(e,t);return i.slice(e-s,Math.min(i.length,e+100-s))}column(e,t=1){let{text:i,from:s}=this.lineAt(e,t),l=this.countColumn(i,e-s),a=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return a>-1&&(l+=a-this.countColumn(i,i.search(/\S|$/))),l}countColumn(e,t=e.length){return Io(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:s}=this.lineAt(e,t),l=this.options.overrideIndentation;if(l){let a=l(s);if(a>-1)return a}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Cj=new Be;function Tj(n,e,t){let i=e.resolveStack(t),s=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(s!=i.node){let l=[];for(let a=s;a&&!(a.from<i.node.from||a.to>i.node.to||a.from==i.node.from&&a.type==i.node.type);a=a.parent)l.push(a);for(let a=l.length-1;a>=0;a--)i={node:l[a],next:i}}return rE(i,n,t)}function rE(n,e,t){for(let i=n;i;i=i.next){let s=Oj(i.node);if(s)return s(Ob.create(e,t,i))}return 0}function Ej(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function Oj(n){let e=n.type.prop(Cj);if(e)return e;let t=n.firstChild,i;if(t&&(i=t.type.prop(Be.closedBy))){let s=n.lastChild,l=s&&i.indexOf(s.name)>-1;return a=>Lj(a,!0,1,void 0,l&&!Ej(a)?s.from:void 0)}return n.parent==null?Dj:null}function Dj(){return 0}class Ob extends kd{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.context=i}get node(){return this.context.node}static create(e,t,i){return new Ob(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(t.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(Mj(i,e))break;t=this.state.doc.lineAt(i.from)}return this.lineIndent(t.from)}continue(){return rE(this.context.next,this.base,this.pos)}}function Mj(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function Rj(n){let e=n.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let s=n.options.simulateBreak,l=n.state.doc.lineAt(t.from),a=s==null||s<=l.from?l.to:Math.min(l.to,s);for(let u=t.to;;){let h=e.childAfter(u);if(!h||h==i)return null;if(!h.type.isSkipped){if(h.from>=a)return null;let d=/^ */.exec(l.text.slice(t.to-l.from))[0].length;return{from:t.from,to:t.to+d}}u=h.to}}function Lj(n,e,t,i,s){let l=n.textAfter,a=l.match(/^\s*/)[0].length,u=i&&l.slice(a,a+i.length)==i||s==n.pos+a,h=Rj(n);return h?u?n.column(h.from):n.column(h.to):n.baseIndent+(u?0:n.unit*t)}const Nj=200;function Bj(){return je.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:i}=n.newSelection.main,s=t.lineAt(i);if(i>s.from+Nj)return n;let l=t.sliceString(s.from,i);if(!e.some(d=>d.test(l)))return n;let{state:a}=n,u=-1,h=[];for(let{head:d}of a.selection.ranges){let g=a.doc.lineAt(d);if(g.from==u)continue;u=g.from;let m=Eb(a,g.from);if(m==null)continue;let b=/^\s*/.exec(g.text)[0],v=Bc(a,m);b!=v&&h.push({from:g.from,to:g.from+b.length,insert:v})}return h.length?[n,{changes:h,sequential:!0}]:n})}const Uj=X.define(),jj=new Be;function zj(n,e,t){let i=Jt(n);if(i.length<t)return null;let s=i.resolveStack(t,1),l=null;for(let a=s;a;a=a.next){let u=a.node;if(u.to<=t||u.from>t)continue;if(l&&u.from<e)break;let h=u.type.prop(jj);if(h&&(u.to<i.length-50||i.length==n.doc.length||!Ij(u))){let d=h(u,n);d&&d.from<=t&&d.from>=e&&d.to>t&&(l=d)}}return l}function Ij(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function Gf(n,e,t){for(let i of n.facet(Uj)){let s=i(n,e,t);if(s)return s}return zj(n,e,t)}function lE(n,e){let t=e.mapPos(n.from,1),i=e.mapPos(n.to,-1);return t>=i?void 0:{from:t,to:i}}const Ad=_e.define({map:lE}),Zc=_e.define({map:lE});function oE(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(i=>i.from<=t&&i.to>=t)||e.push(n.lineBlockAt(t));return e}const Qr=Kt.define({create(){return ae.none},update(n,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((t,i)=>n=rk(n,t,i)),n=n.map(e.changes);for(let t of e.effects)if(t.is(Ad)&&!Hj(n,t.value.from,t.value.to)){let{preparePlaceholder:i}=e.state.facet(uE),s=i?ae.replace({widget:new Wj(i(e.state,t.value))}):lk;n=n.update({add:[s.range(t.value.from,t.value.to)]})}else t.is(Zc)&&(n=n.update({filter:(i,s)=>t.value.from!=i||t.value.to!=s,filterFrom:t.value.from,filterTo:t.value.to}));return e.selection&&(n=rk(n,e.selection.main.head)),n},provide:n=>J.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(i,s)=>{t.push(i,s)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let i=n[t++],s=n[t++];if(typeof i!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");e.push(lk.range(i,s))}return ae.set(e,!0)}});function rk(n,e,t=e){let i=!1;return n.between(e,t,(s,l)=>{s<t&&l>e&&(i=!0)}),i?n.update({filterFrom:e,filterTo:t,filter:(s,l)=>s>=t||l<=e}):n}function Kf(n,e,t){var i;let s=null;return(i=n.field(Qr,!1))===null||i===void 0||i.between(e,t,(l,a)=>{(!s||s.from>l)&&(s={from:l,to:a})}),s}function Hj(n,e,t){let i=!1;return n.between(e,e,(s,l)=>{s==e&&l==t&&(i=!0)}),i}function aE(n,e){return n.field(Qr,!1)?e:e.concat(_e.appendConfig.of(hE()))}const qj=n=>{for(let e of oE(n)){let t=Gf(n.state,e.from,e.to);if(t)return n.dispatch({effects:aE(n.state,[Ad.of(t),cE(n,t)])}),!0}return!1},Vj=n=>{if(!n.state.field(Qr,!1))return!1;let e=[];for(let t of oE(n)){let i=Kf(n.state,t.from,t.to);i&&e.push(Zc.of(i),cE(n,i,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function cE(n,e,t=!0){let i=n.state.doc.lineAt(e.from).number,s=n.state.doc.lineAt(e.to).number;return J.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${i} ${n.state.phrase("to")} ${s}.`)}const $j=n=>{let{state:e}=n,t=[];for(let i=0;i<e.doc.length;){let s=n.lineBlockAt(i),l=Gf(e,s.from,s.to);l&&t.push(Ad.of(l)),i=(l?n.lineBlockAt(l.to):s).to+1}return t.length&&n.dispatch({effects:aE(n.state,t)}),!!t.length},Pj=n=>{let e=n.state.field(Qr,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(i,s)=>{t.push(Zc.of({from:i,to:s}))}),n.dispatch({effects:t}),!0},Gj=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:qj},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Vj},{key:"Ctrl-Alt-[",run:$j},{key:"Ctrl-Alt-]",run:Pj}],Kj={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},uE=X.define({combine(n){return qi(n,Kj)}});function hE(n){return[Qr,Jj]}function fE(n,e){let{state:t}=n,i=t.facet(uE),s=a=>{let u=n.lineBlockAt(n.posAtDOM(a.target)),h=Kf(n.state,u.from,u.to);h&&n.dispatch({effects:Zc.of(h)}),a.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(n,s,e);let l=document.createElement("span");return l.textContent=i.placeholderText,l.setAttribute("aria-label",t.phrase("folded code")),l.title=t.phrase("unfold"),l.className="cm-foldPlaceholder",l.onclick=s,l}const lk=ae.replace({widget:new class extends Vi{toDOM(n){return fE(n,null)}}});class Wj extends Vi{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return fE(e,this.value)}}const Yj={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Vm extends gs{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function Fj(n={}){let e={...Yj,...n},t=new Vm(e,!0),i=new Vm(e,!1),s=rt.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(rr)!=a.state.facet(rr)||a.startState.field(Qr,!1)!=a.state.field(Qr,!1)||Jt(a.startState)!=Jt(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let u=new fs;for(let h of a.viewportLineBlocks){let d=Kf(a.state,h.from,h.to)?i:Gf(a.state,h.from,h.to)?t:null;d&&u.add(h.from,h.from,d)}return u.finish()}}),{domEventHandlers:l}=e;return[s,W4({class:"cm-foldGutter",markers(a){var u;return((u=a.plugin(s))===null||u===void 0?void 0:u.markers)||Ee.empty},initialSpacer(){return new Vm(e,!1)},domEventHandlers:{...l,click:(a,u,h)=>{if(l.click&&l.click(a,u,h))return!0;let d=Kf(a.state,u.from,u.to);if(d)return a.dispatch({effects:Zc.of(d)}),!0;let g=Gf(a.state,u.from,u.to);return g?(a.dispatch({effects:Ad.of(g)}),!0):!1}}}),hE()]}const Jj=J.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Cd{constructor(e,t){this.specs=e;let i;function s(u){let h=tr.newName();return(i||(i=Object.create(null)))["."+h]=u,h}const l=typeof t.all=="string"?t.all:t.all?s(t.all):void 0,a=t.scope;this.scope=a instanceof Ri?u=>u.prop(Fa)==a.data:a?u=>u==a:void 0,this.style=iE(e.map(u=>({tag:u.tag,class:u.class||s(Object.assign({},u,{tag:null}))})),{all:l}).style,this.module=i?new tr(i):null,this.themeType=t.themeType}static define(e,t){return new Cd(e,t||{})}}const vy=X.define(),dE=X.define({combine(n){return n.length?[n[0]]:null}});function $m(n){let e=n.facet(vy);return e.length?e:n.facet(dE)}function Xj(n,e){let t=[Zj],i;return n instanceof Cd&&(n.module&&t.push(J.styleModule.of(n.module)),i=n.themeType),e?.fallback?t.push(dE.of(n)):i?t.push(vy.computeN([J.darkTheme],s=>s.facet(J.darkTheme)==(i=="dark")?[n]:[])):t.push(vy.of(n)),t}class Qj{constructor(e){this.markCache=Object.create(null),this.tree=Jt(e.state),this.decorations=this.buildDeco(e,$m(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Jt(e.state),i=$m(e.state),s=i!=$m(e.startState),{viewport:l}=e.view,a=e.changes.mapPos(this.decoratedTo,1);t.length<l.to&&!s&&t.type==this.tree.type&&a>=l.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(t!=this.tree||e.viewportChanged||s)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=l.to)}buildDeco(e,t){if(!t||!this.tree.length)return ae.none;let i=new fs;for(let{from:s,to:l}of e.visibleRanges)vj(this.tree,t,(a,u,h)=>{i.add(a,u,this.markCache[h]||(this.markCache[h]=ae.mark({class:h})))},s,l);return i.finish()}}const Zj=nl.high(rt.fromClass(Qj,{decorations:n=>n.decorations})),ez=Cd.define([{tag:F.meta,color:"#404740"},{tag:F.link,textDecoration:"underline"},{tag:F.heading,textDecoration:"underline",fontWeight:"bold"},{tag:F.emphasis,fontStyle:"italic"},{tag:F.strong,fontWeight:"bold"},{tag:F.strikethrough,textDecoration:"line-through"},{tag:F.keyword,color:"#708"},{tag:[F.atom,F.bool,F.url,F.contentSeparator,F.labelName],color:"#219"},{tag:[F.literal,F.inserted],color:"#164"},{tag:[F.string,F.deleted],color:"#a11"},{tag:[F.regexp,F.escape,F.special(F.string)],color:"#e40"},{tag:F.definition(F.variableName),color:"#00f"},{tag:F.local(F.variableName),color:"#30a"},{tag:[F.typeName,F.namespace],color:"#085"},{tag:F.className,color:"#167"},{tag:[F.special(F.variableName),F.macroName],color:"#256"},{tag:F.definition(F.propertyName),color:"#00c"},{tag:F.comment,color:"#940"},{tag:F.invalid,color:"#f00"}]),tz=J.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),gE=1e4,pE="()[]{}",mE=X.define({combine(n){return qi(n,{afterCursor:!0,brackets:pE,maxScanDistance:gE,renderMatch:sz})}}),nz=ae.mark({class:"cm-matchingBracket"}),iz=ae.mark({class:"cm-nonmatchingBracket"});function sz(n){let e=[],t=n.matched?nz:iz;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const rz=Kt.define({create(){return ae.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],i=e.state.facet(mE);for(let s of e.state.selection.ranges){if(!s.empty)continue;let l=Li(e.state,s.head,-1,i)||s.head>0&&Li(e.state,s.head-1,1,i)||i.afterCursor&&(Li(e.state,s.head,1,i)||s.head<e.state.doc.length&&Li(e.state,s.head+1,-1,i));l&&(t=t.concat(i.renderMatch(l,e.state)))}return ae.set(t,!0)},provide:n=>J.decorations.from(n)}),lz=[rz,tz];function oz(n={}){return[mE.of(n),lz]}const az=new Be;function wy(n,e,t){let i=n.prop(e<0?Be.openedBy:Be.closedBy);if(i)return i;if(n.name.length==1){let s=t.indexOf(n.name);if(s>-1&&s%2==(e<0?1:0))return[t[s+e]]}return null}function Sy(n){let e=n.type.prop(az);return e?e(n.node):n}function Li(n,e,t,i={}){let s=i.maxScanDistance||gE,l=i.brackets||pE,a=Jt(n),u=a.resolveInner(e,t);for(let h=u;h;h=h.parent){let d=wy(h.type,t,l);if(d&&h.from<h.to){let g=Sy(h);if(g&&(t>0?e>=g.from&&e<g.to:e>g.from&&e<=g.to))return cz(n,e,t,h,g,d,l)}}return uz(n,e,t,a,u.type,s,l)}function cz(n,e,t,i,s,l,a){let u=i.parent,h={from:s.from,to:s.to},d=0,g=u?.cursor();if(g&&(t<0?g.childBefore(i.from):g.childAfter(i.to)))do if(t<0?g.to<=i.from:g.from>=i.to){if(d==0&&l.indexOf(g.type.name)>-1&&g.from<g.to){let m=Sy(g);return{start:h,end:m?{from:m.from,to:m.to}:void 0,matched:!0}}else if(wy(g.type,t,a))d++;else if(wy(g.type,-t,a)){if(d==0){let m=Sy(g);return{start:h,end:m&&m.from<m.to?{from:m.from,to:m.to}:void 0,matched:!1}}d--}}while(t<0?g.prevSibling():g.nextSibling());return{start:h,matched:!1}}function uz(n,e,t,i,s,l,a){let u=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),h=a.indexOf(u);if(h<0||h%2==0!=t>0)return null;let d={from:t<0?e-1:e,to:t>0?e+1:e},g=n.doc.iterRange(e,t>0?n.doc.length:0),m=0;for(let b=0;!g.next().done&&b<=l;){let v=g.value;t<0&&(b+=v.length);let S=e+b*t;for(let _=t>0?0:v.length-1,k=t>0?v.length:-1;_!=k;_+=t){let A=a.indexOf(v[_]);if(!(A<0||i.resolveInner(S+_,1).type!=s))if(A%2==0==t>0)m++;else{if(m==1)return{start:d,end:{from:S+_,to:S+_+1},matched:A>>1==h>>1};m--}}t>0&&(b+=v.length)}return g.done?{start:d,matched:!1}:null}const hz=Object.create(null),ok=[ii.none],ak=[],ck=Object.create(null),fz=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])fz[n]=dz(hz,e);function Pm(n,e){ak.indexOf(n)>-1||(ak.push(n),console.warn(e))}function dz(n,e){let t=[];for(let u of e.split(" ")){let h=[];for(let d of u.split(".")){let g=n[d]||F[d];g?typeof g=="function"?h.length?h=h.map(g):Pm(d,`Modifier ${d} used at start of tag`):h.length?Pm(d,`Tag ${d} used as modifier`):h=Array.isArray(g)?g:[g]:Pm(d,`Unknown highlighting tag ${d}`)}for(let d of h)t.push(d)}if(!t.length)return 0;let i=e.replace(/ /g,"_"),s=i+" "+t.map(u=>u.id),l=ck[s];if(l)return l.id;let a=ck[s]=ii.define({id:ok.length,name:i,props:[yj({[i]:t})]});return ok.push(a),a.id}Qe.RTL,Qe.LTR;const gz=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),i=Mb(n.state,t.from);return i.line?pz(n):i.block?yz(n):!1};function Db(n,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let s=n(e,t);return s?(i(t.update(s)),!0):!1}}const pz=Db(wz,0),mz=Db(yE,0),yz=Db((n,e)=>yE(n,e,vz(e)),0);function Mb(n,e){let t=n.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const Va=50;function bz(n,{open:e,close:t},i,s){let l=n.sliceDoc(i-Va,i),a=n.sliceDoc(s,s+Va),u=/\s*$/.exec(l)[0].length,h=/^\s*/.exec(a)[0].length,d=l.length-u;if(l.slice(d-e.length,d)==e&&a.slice(h,h+t.length)==t)return{open:{pos:i-u,margin:u&&1},close:{pos:s+h,margin:h&&1}};let g,m;s-i<=2*Va?g=m=n.sliceDoc(i,s):(g=n.sliceDoc(i,i+Va),m=n.sliceDoc(s-Va,s));let b=/^\s*/.exec(g)[0].length,v=/\s*$/.exec(m)[0].length,S=m.length-v-t.length;return g.slice(b,b+e.length)==e&&m.slice(S,S+t.length)==t?{open:{pos:i+b+e.length,margin:/\s/.test(g.charAt(b+e.length))?1:0},close:{pos:s-v-t.length,margin:/\s/.test(m.charAt(S-1))?1:0}}:null}function vz(n){let e=[];for(let t of n.selection.ranges){let i=n.doc.lineAt(t.from),s=t.to<=i.to?i:n.doc.lineAt(t.to);s.from>i.from&&s.from==t.to&&(s=t.to==i.to+1?i:n.doc.lineAt(t.to-1));let l=e.length-1;l>=0&&e[l].to>i.from?e[l].to=s.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:s.to})}return e}function yE(n,e,t=e.selection.ranges){let i=t.map(l=>Mb(e,l.from).block);if(!i.every(l=>l))return null;let s=t.map((l,a)=>bz(e,i[a],l.from,l.to));if(n!=2&&!s.every(l=>l))return{changes:e.changes(t.map((l,a)=>s[a]?[]:[{from:l.from,insert:i[a].open+" "},{from:l.to,insert:" "+i[a].close}]))};if(n!=1&&s.some(l=>l)){let l=[];for(let a=0,u;a<s.length;a++)if(u=s[a]){let h=i[a],{open:d,close:g}=u;l.push({from:d.pos-h.open.length,to:d.pos+d.margin},{from:g.pos-g.margin,to:g.pos+h.close.length})}return{changes:l}}return null}function wz(n,e,t=e.selection.ranges){let i=[],s=-1;for(let{from:l,to:a}of t){let u=i.length,h=1e9,d=Mb(e,l).line;if(d){for(let g=l;g<=a;){let m=e.doc.lineAt(g);if(m.from>s&&(l==a||a>m.from)){s=m.from;let b=/^\s*/.exec(m.text)[0].length,v=b==m.length,S=m.text.slice(b,b+d.length)==d?b:-1;b<m.text.length&&b<h&&(h=b),i.push({line:m,comment:S,token:d,indent:b,empty:v,single:!1})}g=m.to+1}if(h<1e9)for(let g=u;g<i.length;g++)i[g].indent<i[g].line.text.length&&(i[g].indent=h);i.length==u+1&&(i[u].single=!0)}}if(n!=2&&i.some(l=>l.comment<0&&(!l.empty||l.single))){let l=[];for(let{line:u,token:h,indent:d,empty:g,single:m}of i)(m||!g)&&l.push({from:u.from+d,insert:h+" "});let a=e.changes(l);return{changes:a,selection:e.selection.map(a,1)}}else if(n!=1&&i.some(l=>l.comment>=0)){let l=[];for(let{line:a,comment:u,token:h}of i)if(u>=0){let d=a.from+u,g=d+h.length;a.text[g-a.from]==" "&&g++,l.push({from:d,to:g})}return{changes:l}}return null}const _y=yi.define(),Sz=yi.define(),_z=X.define(),bE=X.define({combine(n){return qi(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(i,s)=>e(i,s)||t(i,s)})}}),vE=Kt.define({create(){return Ni.empty},update(n,e){let t=e.state.facet(bE),i=e.annotation(_y);if(i){let h=yn.fromTransaction(e,i.selection),d=i.side,g=d==0?n.undone:n.done;return h?g=Wf(g,g.length,t.minDepth,h):g=_E(g,e.startState.selection),new Ni(d==0?i.rest:g,d==0?g:i.rest)}let s=e.annotation(Sz);if((s=="full"||s=="before")&&(n=n.isolate()),e.annotation(Tt.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let l=yn.fromTransaction(e),a=e.annotation(Tt.time),u=e.annotation(Tt.userEvent);return l?n=n.addChanges(l,a,u,t,e):e.selection&&(n=n.addSelection(e.startState.selection,a,u,t.newGroupDelay)),(s=="full"||s=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Ni(n.done.map(yn.fromJSON),n.undone.map(yn.fromJSON))}});function xz(n={}){return[vE,bE.of(n),J.domEventHandlers({beforeinput(e,t){let i=e.inputType=="historyUndo"?wE:e.inputType=="historyRedo"?xy:null;return i?(e.preventDefault(),i(t)):!1}})]}function Td(n,e){return function({state:t,dispatch:i}){if(!e&&t.readOnly)return!1;let s=t.field(vE,!1);if(!s)return!1;let l=s.pop(n,t,e);return l?(i(l),!0):!1}}const wE=Td(0,!1),xy=Td(1,!1),kz=Td(0,!0),Az=Td(1,!0);class yn{constructor(e,t,i,s,l){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=s,this.selectionsAfter=l}setSelAfter(e){return new yn(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(e){return new yn(e.changes&&At.fromJSON(e.changes),[],e.mapped&&Bi.fromJSON(e.mapped),e.startSelection&&P.fromJSON(e.startSelection),e.selectionsAfter.map(P.fromJSON))}static fromTransaction(e,t){let i=Zn;for(let s of e.startState.facet(_z)){let l=s(e);l.length&&(i=i.concat(l))}return!i.length&&e.changes.empty?null:new yn(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,Zn)}static selection(e){return new yn(void 0,Zn,void 0,void 0,e)}}function Wf(n,e,t,i){let s=e+1>t+20?e-t-1:0,l=n.slice(s,e);return l.push(i),l}function Cz(n,e){let t=[],i=!1;return n.iterChangedRanges((s,l)=>t.push(s,l)),e.iterChangedRanges((s,l,a,u)=>{for(let h=0;h<t.length;){let d=t[h++],g=t[h++];u>=d&&a<=g&&(i=!0)}}),i}function Tz(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,i)=>t.empty!=e.ranges[i].empty).length===0}function SE(n,e){return n.length?e.length?n.concat(e):n:e}const Zn=[],Ez=200;function _E(n,e){if(n.length){let t=n[n.length-1],i=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-Ez));return i.length&&i[i.length-1].eq(e)?n:(i.push(e),Wf(n,n.length-1,1e9,t.setSelAfter(i)))}else return[yn.selection([e])]}function Oz(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Gm(n,e){if(!n.length)return n;let t=n.length,i=Zn;for(;t;){let s=Dz(n[t-1],e,i);if(s.changes&&!s.changes.empty||s.effects.length){let l=n.slice(0,t);return l[t-1]=s,l}else e=s.mapped,t--,i=s.selectionsAfter}return i.length?[yn.selection(i)]:Zn}function Dz(n,e,t){let i=SE(n.selectionsAfter.length?n.selectionsAfter.map(u=>u.map(e)):Zn,t);if(!n.changes)return yn.selection(i);let s=n.changes.map(e),l=e.mapDesc(n.changes,!0),a=n.mapped?n.mapped.composeDesc(l):l;return new yn(s,_e.mapEffects(n.effects,e),a,n.startSelection.map(l),i)}const Mz=/^(input\.type|delete)($|\.)/;class Ni{constructor(e,t,i=0,s=void 0){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=s}isolate(){return this.prevTime?new Ni(this.done,this.undone):this}addChanges(e,t,i,s,l){let a=this.done,u=a[a.length-1];return u&&u.changes&&!u.changes.empty&&e.changes&&(!i||Mz.test(i))&&(!u.selectionsAfter.length&&t-this.prevTime<s.newGroupDelay&&s.joinToEvent(l,Cz(u.changes,e.changes))||i=="input.type.compose")?a=Wf(a,a.length-1,s.minDepth,new yn(e.changes.compose(u.changes),SE(_e.mapEffects(e.effects,u.changes),u.effects),u.mapped,u.startSelection,Zn)):a=Wf(a,a.length,s.minDepth,e),new Ni(a,Zn,t,i)}addSelection(e,t,i,s){let l=this.done.length?this.done[this.done.length-1].selectionsAfter:Zn;return l.length>0&&t-this.prevTime<s&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&Tz(l[l.length-1],e)?this:new Ni(_E(this.done,e),this.undone,t,i)}addMapping(e){return new Ni(Gm(this.done,e),Gm(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let s=e==0?this.done:this.undone;if(s.length==0)return null;let l=s[s.length-1],a=l.selectionsAfter[0]||t.selection;if(i&&l.selectionsAfter.length)return t.update({selection:l.selectionsAfter[l.selectionsAfter.length-1],annotations:_y.of({side:e,rest:Oz(s),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(l.changes){let u=s.length==1?Zn:s.slice(0,s.length-1);return l.mapped&&(u=Gm(u,l.mapped)),t.update({changes:l.changes,selection:l.startSelection,effects:l.effects,annotations:_y.of({side:e,rest:u,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Ni.empty=new Ni(Zn,Zn);const Rz=[{key:"Mod-z",run:wE,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:xy,preventDefault:!0},{linux:"Ctrl-Shift-z",run:xy,preventDefault:!0},{key:"Mod-u",run:kz,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Az,preventDefault:!0}];function Ho(n,e){return P.create(n.ranges.map(e),n.mainIndex)}function bi(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function vi({state:n,dispatch:e},t){let i=Ho(n.selection,t);return i.eq(n.selection,!0)?!1:(e(bi(n,i)),!0)}function Ed(n,e){return P.cursor(e?n.to:n.from)}function xE(n,e){return vi(n,t=>t.empty?n.moveByChar(t,e):Ed(t,e))}function Xt(n){return n.textDirectionAt(n.state.selection.main.head)==Qe.LTR}const kE=n=>xE(n,!Xt(n)),AE=n=>xE(n,Xt(n));function CE(n,e){return vi(n,t=>t.empty?n.moveByGroup(t,e):Ed(t,e))}const Lz=n=>CE(n,!Xt(n)),Nz=n=>CE(n,Xt(n));function Bz(n,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function Od(n,e,t){let i=Jt(n).resolveInner(e.head),s=t?Be.closedBy:Be.openedBy;for(let h=e.head;;){let d=t?i.childAfter(h):i.childBefore(h);if(!d)break;Bz(n,d,s)?i=d:h=t?d.to:d.from}let l=i.type.prop(s),a,u;return l&&(a=t?Li(n,i.from,1):Li(n,i.to,-1))&&a.matched?u=t?a.end.to:a.end.from:u=t?i.to:i.from,P.cursor(u,t?-1:1)}const Uz=n=>vi(n,e=>Od(n.state,e,!Xt(n))),jz=n=>vi(n,e=>Od(n.state,e,Xt(n)));function TE(n,e){return vi(n,t=>{if(!t.empty)return Ed(t,e);let i=n.moveVertically(t,e);return i.head!=t.head?i:n.moveToLineBoundary(t,e)})}const EE=n=>TE(n,!1),OE=n=>TE(n,!0);function DE(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,i=0,s;if(e){for(let l of n.state.facet(J.scrollMargins)){let a=l(n);a?.top&&(t=Math.max(a?.top,t)),a?.bottom&&(i=Math.max(a?.bottom,i))}s=n.scrollDOM.clientHeight-t-i}else s=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:i,selfScroll:e,height:Math.max(n.defaultLineHeight,s-5)}}function ME(n,e){let t=DE(n),{state:i}=n,s=Ho(i.selection,a=>a.empty?n.moveVertically(a,e,t.height):Ed(a,e));if(s.eq(i.selection))return!1;let l;if(t.selfScroll){let a=n.coordsAtPos(i.selection.main.head),u=n.scrollDOM.getBoundingClientRect(),h=u.top+t.marginTop,d=u.bottom-t.marginBottom;a&&a.top>h&&a.bottom<d&&(l=J.scrollIntoView(s.main.head,{y:"start",yMargin:a.top-h}))}return n.dispatch(bi(i,s),{effects:l}),!0}const uk=n=>ME(n,!1),ky=n=>ME(n,!0);function or(n,e,t){let i=n.lineBlockAt(e.head),s=n.moveToLineBoundary(e,t);if(s.head==e.head&&s.head!=(t?i.to:i.from)&&(s=n.moveToLineBoundary(e,t,!1)),!t&&s.head==i.from&&i.length){let l=/^\s*/.exec(n.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;l&&e.head!=i.from+l&&(s=P.cursor(i.from+l))}return s}const zz=n=>vi(n,e=>or(n,e,!0)),Iz=n=>vi(n,e=>or(n,e,!1)),Hz=n=>vi(n,e=>or(n,e,!Xt(n))),qz=n=>vi(n,e=>or(n,e,Xt(n))),Vz=n=>vi(n,e=>P.cursor(n.lineBlockAt(e.head).from,1)),$z=n=>vi(n,e=>P.cursor(n.lineBlockAt(e.head).to,-1));function Pz(n,e,t){let i=!1,s=Ho(n.selection,l=>{let a=Li(n,l.head,-1)||Li(n,l.head,1)||l.head>0&&Li(n,l.head-1,1)||l.head<n.doc.length&&Li(n,l.head+1,-1);if(!a||!a.end)return l;i=!0;let u=a.start.from==l.head?a.end.to:a.end.from;return P.cursor(u)});return i?(e(bi(n,s)),!0):!1}const Gz=({state:n,dispatch:e})=>Pz(n,e);function si(n,e){let t=Ho(n.state.selection,i=>{let s=e(i);return P.range(i.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(bi(n.state,t)),!0)}function RE(n,e){return si(n,t=>n.moveByChar(t,e))}const LE=n=>RE(n,!Xt(n)),NE=n=>RE(n,Xt(n));function BE(n,e){return si(n,t=>n.moveByGroup(t,e))}const Kz=n=>BE(n,!Xt(n)),Wz=n=>BE(n,Xt(n)),Yz=n=>si(n,e=>Od(n.state,e,!Xt(n))),Fz=n=>si(n,e=>Od(n.state,e,Xt(n)));function UE(n,e){return si(n,t=>n.moveVertically(t,e))}const jE=n=>UE(n,!1),zE=n=>UE(n,!0);function IE(n,e){return si(n,t=>n.moveVertically(t,e,DE(n).height))}const hk=n=>IE(n,!1),fk=n=>IE(n,!0),Jz=n=>si(n,e=>or(n,e,!0)),Xz=n=>si(n,e=>or(n,e,!1)),Qz=n=>si(n,e=>or(n,e,!Xt(n))),Zz=n=>si(n,e=>or(n,e,Xt(n))),e6=n=>si(n,e=>P.cursor(n.lineBlockAt(e.head).from)),t6=n=>si(n,e=>P.cursor(n.lineBlockAt(e.head).to)),dk=({state:n,dispatch:e})=>(e(bi(n,{anchor:0})),!0),gk=({state:n,dispatch:e})=>(e(bi(n,{anchor:n.doc.length})),!0),pk=({state:n,dispatch:e})=>(e(bi(n,{anchor:n.selection.main.anchor,head:0})),!0),mk=({state:n,dispatch:e})=>(e(bi(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),n6=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),i6=({state:n,dispatch:e})=>{let t=Dd(n).map(({from:i,to:s})=>P.range(i,Math.min(s+1,n.doc.length)));return e(n.update({selection:P.create(t),userEvent:"select"})),!0},s6=({state:n,dispatch:e})=>{let t=Ho(n.selection,i=>{let s=Jt(n),l=s.resolveStack(i.from,1);if(i.empty){let a=s.resolveStack(i.from,-1);a.node.from>=l.node.from&&a.node.to<=l.node.to&&(l=a)}for(let a=l;a;a=a.next){let{node:u}=a;if((u.from<i.from&&u.to>=i.to||u.to>i.to&&u.from<=i.from)&&a.next)return P.range(u.to,u.from)}return i});return t.eq(n.selection)?!1:(e(bi(n,t)),!0)};function HE(n,e){let{state:t}=n,i=t.selection,s=t.selection.ranges.slice();for(let l of t.selection.ranges){let a=t.doc.lineAt(l.head);if(e?a.to<n.state.doc.length:a.from>0)for(let u=l;;){let h=n.moveVertically(u,e);if(h.head<a.from||h.head>a.to){s.some(d=>d.head==h.head)||s.push(h);break}else{if(h.head==u.head)break;u=h}}}return s.length==i.ranges.length?!1:(n.dispatch(bi(t,P.create(s,s.length-1))),!0)}const r6=n=>HE(n,!1),l6=n=>HE(n,!0),o6=({state:n,dispatch:e})=>{let t=n.selection,i=null;return t.ranges.length>1?i=P.create([t.main]):t.main.empty||(i=P.create([P.cursor(t.main.head)])),i?(e(bi(n,i)),!0):!1};function eu(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:i}=n,s=i.changeByRange(l=>{let{from:a,to:u}=l;if(a==u){let h=e(l);h<a?(t="delete.backward",h=Jh(n,h,!1)):h>a&&(t="delete.forward",h=Jh(n,h,!0)),a=Math.min(a,h),u=Math.max(u,h)}else a=Jh(n,a,!1),u=Jh(n,u,!0);return a==u?{range:l}:{changes:{from:a,to:u},range:P.cursor(a,a<l.head?-1:1)}});return s.changes.empty?!1:(n.dispatch(i.update(s,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?J.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function Jh(n,e,t){if(n instanceof J)for(let i of n.state.facet(J.atomicRanges).map(s=>s(n)))i.between(e,e,(s,l)=>{s<e&&l>e&&(e=t?l:s)});return e}const qE=(n,e,t)=>eu(n,i=>{let s=i.from,{state:l}=n,a=l.doc.lineAt(s),u,h;if(t&&!e&&s>a.from&&s<a.from+200&&!/[^ \t]/.test(u=a.text.slice(0,s-a.from))){if(u[u.length-1]=="	")return s-1;let d=Io(u,l.tabSize),g=d%Pf(l)||Pf(l);for(let m=0;m<g&&u[u.length-1-m]==" ";m++)s--;h=s}else h=Ct(a.text,s-a.from,e,e)+a.from,h==s&&a.number!=(e?l.doc.lines:1)?h+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(h-a.from,s-a.from))&&(h=Ct(a.text,h-a.from,!1,!1)+a.from);return h}),Ay=n=>qE(n,!1,!0),VE=n=>qE(n,!0,!1),$E=(n,e)=>eu(n,t=>{let i=t.head,{state:s}=n,l=s.doc.lineAt(i),a=s.charCategorizer(i);for(let u=null;;){if(i==(e?l.to:l.from)){i==t.head&&l.number!=(e?s.doc.lines:1)&&(i+=e?1:-1);break}let h=Ct(l.text,i-l.from,e)+l.from,d=l.text.slice(Math.min(i,h)-l.from,Math.max(i,h)-l.from),g=a(d);if(u!=null&&g!=u)break;(d!=" "||i!=t.head)&&(u=g),i=h}return i}),PE=n=>$E(n,!1),a6=n=>$E(n,!0),c6=n=>eu(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),u6=n=>eu(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),h6=n=>eu(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),f6=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:He.of(["",""])},range:P.cursor(i.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},d6=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>{if(!i.empty||i.from==0||i.from==n.doc.length)return{range:i};let s=i.from,l=n.doc.lineAt(s),a=s==l.from?s-1:Ct(l.text,s-l.from,!1)+l.from,u=s==l.to?s+1:Ct(l.text,s-l.from,!0)+l.from;return{changes:{from:a,to:u,insert:n.doc.slice(s,u).append(n.doc.slice(a,s))},range:P.cursor(u)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Dd(n){let e=[],t=-1;for(let i of n.selection.ranges){let s=n.doc.lineAt(i.from),l=n.doc.lineAt(i.to);if(!i.empty&&i.to==l.from&&(l=n.doc.lineAt(i.to-1)),t>=s.number){let a=e[e.length-1];a.to=l.to,a.ranges.push(i)}else e.push({from:s.from,to:l.to,ranges:[i]});t=l.number+1}return e}function GE(n,e,t){if(n.readOnly)return!1;let i=[],s=[];for(let l of Dd(n)){if(t?l.to==n.doc.length:l.from==0)continue;let a=n.doc.lineAt(t?l.to+1:l.from-1),u=a.length+1;if(t){i.push({from:l.to,to:a.to},{from:l.from,insert:a.text+n.lineBreak});for(let h of l.ranges)s.push(P.range(Math.min(n.doc.length,h.anchor+u),Math.min(n.doc.length,h.head+u)))}else{i.push({from:a.from,to:l.from},{from:l.to,insert:n.lineBreak+a.text});for(let h of l.ranges)s.push(P.range(h.anchor-u,h.head-u))}}return i.length?(e(n.update({changes:i,scrollIntoView:!0,selection:P.create(s,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const g6=({state:n,dispatch:e})=>GE(n,e,!1),p6=({state:n,dispatch:e})=>GE(n,e,!0);function KE(n,e,t){if(n.readOnly)return!1;let i=[];for(let l of Dd(n))t?i.push({from:l.from,insert:n.doc.slice(l.from,l.to)+n.lineBreak}):i.push({from:l.to,insert:n.lineBreak+n.doc.slice(l.from,l.to)});let s=n.changes(i);return e(n.update({changes:s,selection:n.selection.map(s,t?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const m6=({state:n,dispatch:e})=>KE(n,e,!1),y6=({state:n,dispatch:e})=>KE(n,e,!0),b6=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(Dd(e).map(({from:s,to:l})=>(s>0?s--:l<e.doc.length&&l++,{from:s,to:l}))),i=Ho(e.selection,s=>{let l;if(n.lineWrapping){let a=n.lineBlockAt(s.head),u=n.coordsAtPos(s.head,s.assoc||1);u&&(l=a.bottom+n.documentTop-u.bottom+n.defaultLineHeight/2)}return n.moveVertically(s,!0,l)}).map(t);return n.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function v6(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Jt(n).resolveInner(e),i=t.childBefore(e),s=t.childAfter(e),l;return i&&s&&i.to<=e&&s.from>=e&&(l=i.type.prop(Be.closedBy))&&l.indexOf(s.name)>-1&&n.doc.lineAt(i.to).from==n.doc.lineAt(s.from).from&&!/\S/.test(n.sliceDoc(i.to,s.from))?{from:i.to,to:s.from}:null}const yk=WE(!1),w6=WE(!0);function WE(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(s=>{let{from:l,to:a}=s,u=e.doc.lineAt(l),h=!n&&l==a&&v6(e,l);n&&(l=a=(a<=u.to?u:e.doc.lineAt(a)).to);let d=new kd(e,{simulateBreak:l,simulateDoubleBreak:!!h}),g=Eb(d,l);for(g==null&&(g=Io(/^\s*/.exec(e.doc.lineAt(l).text)[0],e.tabSize));a<u.to&&/\s/.test(u.text[a-u.from]);)a++;h?{from:l,to:a}=h:l>u.from&&l<u.from+100&&!/\S/.test(u.text.slice(0,l))&&(l=u.from);let m=["",Bc(e,g)];return h&&m.push(Bc(e,d.lineIndent(u.from,-1))),{changes:{from:l,to:a,insert:He.of(m)},range:P.cursor(l+1+m[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function Rb(n,e){let t=-1;return n.changeByRange(i=>{let s=[];for(let a=i.from;a<=i.to;){let u=n.doc.lineAt(a);u.number>t&&(i.empty||i.to>u.from)&&(e(u,s,i),t=u.number),a=u.to+1}let l=n.changes(s);return{changes:s,range:P.range(l.mapPos(i.anchor,1),l.mapPos(i.head,1))}})}const S6=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),i=new kd(n,{overrideIndentation:l=>{let a=t[l];return a??-1}}),s=Rb(n,(l,a,u)=>{let h=Eb(i,l.from);if(h==null)return;/\S/.test(l.text)||(h=0);let d=/^\s*/.exec(l.text)[0],g=Bc(n,h);(d!=g||u.from<l.from+d.length)&&(t[l.from]=h,a.push({from:l.from,to:l.from+d.length,insert:g}))});return s.changes.empty||e(n.update(s,{userEvent:"indent"})),!0},_6=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Rb(n,(t,i)=>{i.push({from:t.from,insert:n.facet(Tb)})}),{userEvent:"input.indent"})),!0),x6=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Rb(n,(t,i)=>{let s=/^\s*/.exec(t.text)[0];if(!s)return;let l=Io(s,n.tabSize),a=0,u=Bc(n,Math.max(0,l-Pf(n)));for(;a<s.length&&a<u.length&&s.charCodeAt(a)==u.charCodeAt(a);)a++;i.push({from:t.from+a,to:t.from+s.length,insert:u.slice(a)})}),{userEvent:"delete.dedent"})),!0),k6=n=>(n.setTabFocusMode(),!0),A6=[{key:"Ctrl-b",run:kE,shift:LE,preventDefault:!0},{key:"Ctrl-f",run:AE,shift:NE},{key:"Ctrl-p",run:EE,shift:jE},{key:"Ctrl-n",run:OE,shift:zE},{key:"Ctrl-a",run:Vz,shift:e6},{key:"Ctrl-e",run:$z,shift:t6},{key:"Ctrl-d",run:VE},{key:"Ctrl-h",run:Ay},{key:"Ctrl-k",run:c6},{key:"Ctrl-Alt-h",run:PE},{key:"Ctrl-o",run:f6},{key:"Ctrl-t",run:d6},{key:"Ctrl-v",run:ky}],C6=[{key:"ArrowLeft",run:kE,shift:LE,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Lz,shift:Kz,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Hz,shift:Qz,preventDefault:!0},{key:"ArrowRight",run:AE,shift:NE,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Nz,shift:Wz,preventDefault:!0},{mac:"Cmd-ArrowRight",run:qz,shift:Zz,preventDefault:!0},{key:"ArrowUp",run:EE,shift:jE,preventDefault:!0},{mac:"Cmd-ArrowUp",run:dk,shift:pk},{mac:"Ctrl-ArrowUp",run:uk,shift:hk},{key:"ArrowDown",run:OE,shift:zE,preventDefault:!0},{mac:"Cmd-ArrowDown",run:gk,shift:mk},{mac:"Ctrl-ArrowDown",run:ky,shift:fk},{key:"PageUp",run:uk,shift:hk},{key:"PageDown",run:ky,shift:fk},{key:"Home",run:Iz,shift:Xz,preventDefault:!0},{key:"Mod-Home",run:dk,shift:pk},{key:"End",run:zz,shift:Jz,preventDefault:!0},{key:"Mod-End",run:gk,shift:mk},{key:"Enter",run:yk,shift:yk},{key:"Mod-a",run:n6},{key:"Backspace",run:Ay,shift:Ay,preventDefault:!0},{key:"Delete",run:VE,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:PE,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:a6,preventDefault:!0},{mac:"Mod-Backspace",run:u6,preventDefault:!0},{mac:"Mod-Delete",run:h6,preventDefault:!0}].concat(A6.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),T6=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Uz,shift:Yz},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:jz,shift:Fz},{key:"Alt-ArrowUp",run:g6},{key:"Shift-Alt-ArrowUp",run:m6},{key:"Alt-ArrowDown",run:p6},{key:"Shift-Alt-ArrowDown",run:y6},{key:"Mod-Alt-ArrowUp",run:r6},{key:"Mod-Alt-ArrowDown",run:l6},{key:"Escape",run:o6},{key:"Mod-Enter",run:w6},{key:"Alt-l",mac:"Ctrl-l",run:i6},{key:"Mod-i",run:s6,preventDefault:!0},{key:"Mod-[",run:x6},{key:"Mod-]",run:_6},{key:"Mod-Alt-\\",run:S6},{key:"Shift-Mod-k",run:b6},{key:"Shift-Mod-\\",run:Gz},{key:"Mod-/",run:gz},{key:"Alt-A",run:mz},{key:"Ctrl-m",mac:"Shift-Alt-m",run:k6}].concat(C6),bk=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class Ro{constructor(e,t,i=0,s=e.length,l,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,s),this.bufferStart=i,this.normalize=l?u=>l(bk(u)):bk,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return fn(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=sb(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Di(e);let s=this.normalize(t);if(s.length)for(let l=0,a=i;;l++){let u=s.charCodeAt(l),h=this.match(u,a,this.bufferPos+this.bufferStart);if(l==s.length-1){if(h)return this.value=h,this;break}a==i&&l<t.length&&t.charCodeAt(l)==u&&a++}}}match(e,t,i){let s=null;for(let l=0;l<this.matches.length;l+=2){let a=this.matches[l],u=!1;this.query.charCodeAt(a)==e&&(a==this.query.length-1?s={from:this.matches[l+1],to:i}:(this.matches[l]++,u=!0)),u||(this.matches.splice(l,2),l-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?s={from:t,to:i}:this.matches.push(1,t)),s&&this.test&&!this.test(s.from,s.to,this.buffer,this.bufferStart)&&(s=null),s}}typeof Symbol<"u"&&(Ro.prototype[Symbol.iterator]=function(){return this});const YE={from:-1,to:-1,match:/.*/.exec("")},Lb="gm"+(/x/.unicode==null?"":"u");class FE{constructor(e,t,i,s=0,l=e.length){if(this.text=e,this.to=l,this.curLine="",this.done=!1,this.value=YE,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new JE(e,t,i,s,l);this.re=new RegExp(t,Lb+(i?.ignoreCase?"i":"")),this.test=i?.test,this.iter=e.iter();let a=e.lineAt(s);this.curLineStart=a.from,this.matchPos=Yf(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,s=i+t[0].length;if(this.matchPos=Yf(this.text,s+(i==s?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<s||i>this.value.to)&&(!this.test||this.test(i,s,t)))return this.value={from:i,to:s,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Km=new WeakMap;class mo{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let s=Km.get(e);if(!s||s.from>=i||s.to<=t){let u=new mo(t,e.sliceString(t,i));return Km.set(e,u),u}if(s.from==t&&s.to==i)return s;let{text:l,from:a}=s;return a>t&&(l=e.sliceString(t,a)+l,a=t),s.to<i&&(l+=e.sliceString(s.to,i)),Km.set(e,new mo(a,l)),new mo(t,l.slice(t-a,i-a))}}class JE{constructor(e,t,i,s,l){this.text=e,this.to=l,this.done=!1,this.value=YE,this.matchPos=Yf(e,s),this.re=new RegExp(t,Lb+(i?.ignoreCase?"i":"")),this.test=i?.test,this.flat=mo.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let i=this.flat.from+t.index,s=i+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,s,t)))return this.value={from:i,to:s,match:t},this.matchPos=Yf(this.text,s+(i==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=mo.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(FE.prototype[Symbol.iterator]=JE.prototype[Symbol.iterator]=function(){return this});function E6(n){try{return new RegExp(n,Lb),!0}catch{return!1}}function Yf(n,e){if(e>=n.length)return e;let t=n.lineAt(e),i;for(;e<t.to&&(i=t.text.charCodeAt(e-t.from))>=56320&&i<57344;)e++;return e}const O6=n=>{let{state:e}=n,t=String(e.doc.lineAt(n.state.selection.main.head).number),{close:i,result:s}=$4(n,{label:e.phrase("Go to line"),input:{type:"text",name:"line",value:t},focus:!0,submitLabel:e.phrase("go")});return s.then(l=>{let a=l&&/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(l.elements.line.value);if(!a){n.dispatch({effects:i});return}let u=e.doc.lineAt(e.selection.main.head),[,h,d,g,m]=a,b=g?+g.slice(1):0,v=d?+d:u.number;if(d&&m){let k=v/100;h&&(k=k*(h=="-"?-1:1)+u.number/e.doc.lines),v=Math.round(e.doc.lines*k)}else d&&h&&(v=v*(h=="-"?-1:1)+u.number);let S=e.doc.line(Math.max(1,Math.min(e.doc.lines,v))),_=P.cursor(S.from+Math.max(0,Math.min(b,S.length)));n.dispatch({effects:[i,J.scrollIntoView(_.from,{y:"center"})],selection:_})}),!0},D6={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},M6=X.define({combine(n){return qi(n,D6,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function R6(n){return[j6,U6]}const L6=ae.mark({class:"cm-selectionMatch"}),N6=ae.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function vk(n,e,t,i){return(t==0||n(e.sliceDoc(t-1,t))!=st.Word)&&(i==e.doc.length||n(e.sliceDoc(i,i+1))!=st.Word)}function B6(n,e,t,i){return n(e.sliceDoc(t,t+1))==st.Word&&n(e.sliceDoc(i-1,i))==st.Word}const U6=rt.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(M6),{state:t}=n,i=t.selection;if(i.ranges.length>1)return ae.none;let s=i.main,l,a=null;if(s.empty){if(!e.highlightWordAroundCursor)return ae.none;let h=t.wordAt(s.head);if(!h)return ae.none;a=t.charCategorizer(s.head),l=t.sliceDoc(h.from,h.to)}else{let h=s.to-s.from;if(h<e.minSelectionLength||h>200)return ae.none;if(e.wholeWords){if(l=t.sliceDoc(s.from,s.to),a=t.charCategorizer(s.head),!(vk(a,t,s.from,s.to)&&B6(a,t,s.from,s.to)))return ae.none}else if(l=t.sliceDoc(s.from,s.to),!l)return ae.none}let u=[];for(let h of n.visibleRanges){let d=new Ro(t.doc,l,h.from,h.to);for(;!d.next().done;){let{from:g,to:m}=d.value;if((!a||vk(a,t,g,m))&&(s.empty&&g<=s.from&&m>=s.to?u.push(N6.range(g,m)):(g>=s.to||m<=s.from)&&u.push(L6.range(g,m)),u.length>e.maxMatches))return ae.none}}return ae.set(u)}},{decorations:n=>n.decorations}),j6=J.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),z6=({state:n,dispatch:e})=>{let{selection:t}=n,i=P.create(t.ranges.map(s=>n.wordAt(s.head)||P.cursor(s.head)),t.mainIndex);return i.eq(t)?!1:(e(n.update({selection:i})),!0)};function I6(n,e){let{main:t,ranges:i}=n.selection,s=n.wordAt(t.head),l=s&&s.from==t.from&&s.to==t.to;for(let a=!1,u=new Ro(n.doc,e,i[i.length-1].to);;)if(u.next(),u.done){if(a)return null;u=new Ro(n.doc,e,0,Math.max(0,i[i.length-1].from-1)),a=!0}else{if(a&&i.some(h=>h.from==u.value.from))continue;if(l){let h=n.wordAt(u.value.from);if(!h||h.from!=u.value.from||h.to!=u.value.to)continue}return u.value}}const H6=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(l=>l.from===l.to))return z6({state:n,dispatch:e});let i=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(l=>n.sliceDoc(l.from,l.to)!=i))return!1;let s=I6(n,i);return s?(e(n.update({selection:n.selection.addRange(P.range(s.from,s.to),!1),effects:J.scrollIntoView(s.to)})),!0):!1},qo=X.define({combine(n){return qi(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new eI(e),scrollToMatch:e=>J.scrollIntoView(e)})}});class XE{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||E6(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord,this.test=e.test}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord&&this.test==e.test}create(){return this.regexp?new K6(this):new $6(this)}getCursor(e,t=0,i){let s=e.doc?e:je.create({doc:e});return i==null&&(i=s.doc.length),this.regexp?Zl(this,s,t,i):Ql(this,s,t,i)}}class QE{constructor(e){this.spec=e}}function q6(n,e,t){return(i,s,l,a)=>{if(t&&!t(i,s,l,a))return!1;let u=i>=a&&s<=a+l.length?l.slice(i-a,s-a):e.doc.sliceString(i,s);return n(u,e,i,s)}}function Ql(n,e,t,i){let s;return n.wholeWord&&(s=V6(e.doc,e.charCategorizer(e.selection.main.head))),n.test&&(s=q6(n.test,e,s)),new Ro(e.doc,n.unquoted,t,i,n.caseSensitive?void 0:l=>l.toLowerCase(),s)}function V6(n,e){return(t,i,s,l)=>((l>t||l+s.length<i)&&(l=Math.max(0,t-2),s=n.sliceString(l,Math.min(n.length,i+2))),(e(Ff(s,t-l))!=st.Word||e(Jf(s,t-l))!=st.Word)&&(e(Jf(s,i-l))!=st.Word||e(Ff(s,i-l))!=st.Word))}class $6 extends QE{constructor(e){super(e)}nextMatch(e,t,i){let s=Ql(this.spec,e,i,e.doc.length).nextOverlapping();if(s.done){let l=Math.min(e.doc.length,t+this.spec.unquoted.length);s=Ql(this.spec,e,0,l).nextOverlapping()}return s.done||s.value.from==t&&s.value.to==i?null:s.value}prevMatchInRange(e,t,i){for(let s=i;;){let l=Math.max(t,s-1e4-this.spec.unquoted.length),a=Ql(this.spec,e,l,s),u=null;for(;!a.nextOverlapping().done;)u=a.value;if(u)return u;if(l==t)return null;s-=1e4}}prevMatch(e,t,i){let s=this.prevMatchInRange(e,0,t);return s||(s=this.prevMatchInRange(e,Math.max(0,i-this.spec.unquoted.length),e.doc.length)),s&&(s.from!=t||s.to!=i)?s:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let i=Ql(this.spec,e,0,e.doc.length),s=[];for(;!i.next().done;){if(s.length>=t)return null;s.push(i.value)}return s}highlight(e,t,i,s){let l=Ql(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!l.next().done;)s(l.value.from,l.value.to)}}function P6(n,e,t){return(i,s,l)=>(!t||t(i,s,l))&&n(l[0],e,i,s)}function Zl(n,e,t,i){let s;return n.wholeWord&&(s=G6(e.charCategorizer(e.selection.main.head))),n.test&&(s=P6(n.test,e,s)),new FE(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:s},t,i)}function Ff(n,e){return n.slice(Ct(n,e,!1),e)}function Jf(n,e){return n.slice(e,Ct(n,e))}function G6(n){return(e,t,i)=>!i[0].length||(n(Ff(i.input,i.index))!=st.Word||n(Jf(i.input,i.index))!=st.Word)&&(n(Jf(i.input,i.index+i[0].length))!=st.Word||n(Ff(i.input,i.index+i[0].length))!=st.Word)}class K6 extends QE{nextMatch(e,t,i){let s=Zl(this.spec,e,i,e.doc.length).next();return s.done&&(s=Zl(this.spec,e,0,t).next()),s.done?null:s.value}prevMatchInRange(e,t,i){for(let s=1;;s++){let l=Math.max(t,i-s*1e4),a=Zl(this.spec,e,l,i),u=null;for(;!a.next().done;)u=a.value;if(u&&(l==t||u.from>l+10))return u;if(l==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,i)=>{if(i=="&")return e.match[0];if(i=="$")return"$";for(let s=i.length;s>0;s--){let l=+i.slice(0,s);if(l>0&&l<e.match.length)return e.match[l]+i.slice(s)}return t})}matchAll(e,t){let i=Zl(this.spec,e,0,e.doc.length),s=[];for(;!i.next().done;){if(s.length>=t)return null;s.push(i.value)}return s}highlight(e,t,i,s){let l=Zl(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.doc.length));for(;!l.next().done;)s(l.value.from,l.value.to)}}const Uc=_e.define(),Nb=_e.define(),Zs=Kt.define({create(n){return new Wm(Cy(n).create(),null)},update(n,e){for(let t of e.effects)t.is(Uc)?n=new Wm(t.value.create(),n.panel):t.is(Nb)&&(n=new Wm(n.query,t.value?Bb:null));return n},provide:n=>Rc.from(n,e=>e.panel)});class Wm{constructor(e,t){this.query=e,this.panel=t}}const W6=ae.mark({class:"cm-searchMatch"}),Y6=ae.mark({class:"cm-searchMatch cm-searchMatch-selected"}),F6=rt.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(Zs))}update(n){let e=n.state.field(Zs);(e!=n.startState.field(Zs)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return ae.none;let{view:t}=this,i=new fs;for(let s=0,l=t.visibleRanges,a=l.length;s<a;s++){let{from:u,to:h}=l[s];for(;s<a-1&&h>l[s+1].from-500;)h=l[++s].to;n.highlight(t.state,u,h,(d,g)=>{let m=t.state.selection.ranges.some(b=>b.from==d&&b.to==g);i.add(d,g,m?Y6:W6)})}return i.finish()}},{decorations:n=>n.decorations});function tu(n){return e=>{let t=e.state.field(Zs,!1);return t&&t.query.spec.valid?n(e,t):tO(e)}}const Xf=tu((n,{query:e})=>{let{to:t}=n.state.selection.main,i=e.nextMatch(n.state,t,t);if(!i)return!1;let s=P.single(i.from,i.to),l=n.state.facet(qo);return n.dispatch({selection:s,effects:[Ub(n,i),l.scrollToMatch(s.main,n)],userEvent:"select.search"}),eO(n),!0}),Qf=tu((n,{query:e})=>{let{state:t}=n,{from:i}=t.selection.main,s=e.prevMatch(t,i,i);if(!s)return!1;let l=P.single(s.from,s.to),a=n.state.facet(qo);return n.dispatch({selection:l,effects:[Ub(n,s),a.scrollToMatch(l.main,n)],userEvent:"select.search"}),eO(n),!0}),J6=tu((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:P.create(t.map(i=>P.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),X6=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:s}=t.main,l=[],a=0;for(let u=new Ro(n.doc,n.sliceDoc(i,s));!u.next().done;){if(l.length>1e3)return!1;u.value.from==i&&(a=l.length),l.push(P.range(u.value.from,u.value.to))}return e(n.update({selection:P.create(l,a),userEvent:"select.search.matches"})),!0},wk=tu((n,{query:e})=>{let{state:t}=n,{from:i,to:s}=t.selection.main;if(t.readOnly)return!1;let l=e.nextMatch(t,i,i);if(!l)return!1;let a=l,u=[],h,d,g=[];a.from==i&&a.to==s&&(d=t.toText(e.getReplacement(a)),u.push({from:a.from,to:a.to,insert:d}),a=e.nextMatch(t,a.from,a.to),g.push(J.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(i).number)+".")));let m=n.state.changes(u);return a&&(h=P.single(a.from,a.to).map(m),g.push(Ub(n,a)),g.push(t.facet(qo).scrollToMatch(h.main,n))),n.dispatch({changes:m,selection:h,effects:g,userEvent:"input.replace"}),!0}),Q6=tu((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(s=>{let{from:l,to:a}=s;return{from:l,to:a,insert:e.getReplacement(s)}});if(!t.length)return!1;let i=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:J.announce.of(i),userEvent:"input.replace.all"}),!0});function Bb(n){return n.state.facet(qo).createPanel(n)}function Cy(n,e){var t,i,s,l,a;let u=n.selection.main,h=u.empty||u.to>u.from+100?"":n.sliceDoc(u.from,u.to);if(e&&!h)return e;let d=n.facet(qo);return new XE({search:((t=e?.literal)!==null&&t!==void 0?t:d.literal)?h:h.replace(/\n/g,"\\n"),caseSensitive:(i=e?.caseSensitive)!==null&&i!==void 0?i:d.caseSensitive,literal:(s=e?.literal)!==null&&s!==void 0?s:d.literal,regexp:(l=e?.regexp)!==null&&l!==void 0?l:d.regexp,wholeWord:(a=e?.wholeWord)!==null&&a!==void 0?a:d.wholeWord})}function ZE(n){let e=xb(n,Bb);return e&&e.dom.querySelector("[main-field]")}function eO(n){let e=ZE(n);e&&e==n.root.activeElement&&e.select()}const tO=n=>{let e=n.state.field(Zs,!1);if(e&&e.panel){let t=ZE(n);if(t&&t!=n.root.activeElement){let i=Cy(n.state,e.query.spec);i.valid&&n.dispatch({effects:Uc.of(i)}),t.focus(),t.select()}}else n.dispatch({effects:[Nb.of(!0),e?Uc.of(Cy(n.state,e.query.spec)):_e.appendConfig.of(nI)]});return!0},nO=n=>{let e=n.state.field(Zs,!1);if(!e||!e.panel)return!1;let t=xb(n,Bb);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:Nb.of(!1)}),!0},Z6=[{key:"Mod-f",run:tO,scope:"editor search-panel"},{key:"F3",run:Xf,shift:Qf,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Xf,shift:Qf,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:nO,scope:"editor search-panel"},{key:"Mod-Shift-l",run:X6},{key:"Mod-Alt-g",run:O6},{key:"Mod-d",run:H6,preventDefault:!0}];class eI{constructor(e){this.view=e;let t=this.query=e.state.field(Zs).query.spec;this.commit=this.commit.bind(this),this.searchField=We("input",{value:t.search,placeholder:On(e,"Find"),"aria-label":On(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=We("input",{value:t.replace,placeholder:On(e,"Replace"),"aria-label":On(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=We("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=We("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=We("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function i(s,l,a){return We("button",{class:"cm-button",name:s,onclick:l,type:"button"},a)}this.dom=We("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,i("next",()=>Xf(e),[On(e,"next")]),i("prev",()=>Qf(e),[On(e,"previous")]),i("select",()=>J6(e),[On(e,"all")]),We("label",null,[this.caseField,On(e,"match case")]),We("label",null,[this.reField,On(e,"regexp")]),We("label",null,[this.wordField,On(e,"by word")]),...e.state.readOnly?[]:[We("br"),this.replaceField,i("replace",()=>wk(e),[On(e,"replace")]),i("replaceAll",()=>Q6(e),[On(e,"replace all")])],We("button",{name:"close",onclick:()=>nO(e),"aria-label":On(e,"close"),type:"button"},[""])])}commit(){let e=new XE({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Uc.of(e)}))}keydown(e){t4(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Qf:Xf)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),wk(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(Uc)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(qo).top}}function On(n,e){return n.state.phrase(e)}const Xh=30,Qh=/[\s\.,:;?!]/;function Ub(n,{from:e,to:t}){let i=n.state.doc.lineAt(e),s=n.state.doc.lineAt(t).to,l=Math.max(i.from,e-Xh),a=Math.min(s,t+Xh),u=n.state.sliceDoc(l,a);if(l!=i.from){for(let h=0;h<Xh;h++)if(!Qh.test(u[h+1])&&Qh.test(u[h])){u=u.slice(h);break}}if(a!=s){for(let h=u.length-1;h>u.length-Xh;h--)if(!Qh.test(u[h-1])&&Qh.test(u[h])){u=u.slice(0,h);break}}return J.announce.of(`${n.state.phrase("current match")}. ${u} ${n.state.phrase("on line")} ${i.number}.`)}const tI=J.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),nI=[Zs,nl.low(F6),tI];class iO{constructor(e,t,i,s){this.state=e,this.pos=t,this.explicit=i,this.view=s,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=Jt(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),s=t.text.slice(i-t.from,this.pos-t.from),l=s.search(sO(e,!1));return l<0?null:{from:i+l,to:this.pos,text:s.slice(l)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function Sk(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function iI(n){let e=Object.create(null),t=Object.create(null);for(let{label:s}of n){e[s[0]]=!0;for(let l=1;l<s.length;l++)t[s[l]]=!0}let i=Sk(e)+Sk(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function sI(n){let e=n.map(s=>typeof s=="string"?{label:s}:s),[t,i]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:iI(e);return s=>{let l=s.matchBefore(i);return l||s.explicit?{from:l?l.from:s.pos,options:e,validFor:t}:null}}class _k{constructor(e,t,i,s){this.completion=e,this.source=t,this.match=i,this.score=s}}function Pr(n){return n.selection.main.from}function sO(n,e){var t;let{source:i}=n,s=e&&i[0]!="^",l=i[i.length-1]!="$";return!s&&!l?n:new RegExp(`${s?"^":""}(?:${i})${l?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const rO=yi.define();function rI(n,e,t,i){let{main:s}=n.selection,l=t-s.from,a=i-s.from;return{...n.changeByRange(u=>{if(u!=s&&t!=i&&n.sliceDoc(u.from+l,u.from+a)!=n.sliceDoc(t,i))return{range:u};let h=n.toText(e);return{changes:{from:u.from+l,to:i==s.from?u.to:u.from+a,insert:h},range:P.cursor(u.from+l+h.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const xk=new WeakMap;function lI(n){if(!Array.isArray(n))return n;let e=xk.get(n);return e||xk.set(n,e=sI(n)),e}const Zf=_e.define(),jc=_e.define();class oI{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let i=fn(e,t),s=Di(i);this.chars.push(i);let l=e.slice(t,t+s),a=l.toUpperCase();this.folded.push(fn(a==l?l.toLowerCase():a,0)),t+=s}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:s,precise:l,byWord:a}=this;if(t.length==1){let M=fn(e,0),O=Di(M),z=O==e.length?0:-100;if(M!=t[0])if(M==i[0])z+=-200;else return null;return this.ret(z,[0,O])}let u=e.indexOf(this.pattern);if(u==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let h=t.length,d=0;if(u<0){for(let M=0,O=Math.min(e.length,200);M<O&&d<h;){let z=fn(e,M);(z==t[d]||z==i[d])&&(s[d++]=M),M+=Di(z)}if(d<h)return null}let g=0,m=0,b=!1,v=0,S=-1,_=-1,k=/[a-z]/.test(e),A=!0;for(let M=0,O=Math.min(e.length,200),z=0;M<O&&m<h;){let q=fn(e,M);u<0&&(g<h&&q==t[g]&&(l[g++]=M),v<h&&(q==t[v]||q==i[v]?(v==0&&(S=M),_=M+1,v++):v=0));let V,j=q<255?q>=48&&q<=57||q>=97&&q<=122?2:q>=65&&q<=90?1:0:(V=sb(q))!=V.toLowerCase()?1:V!=V.toUpperCase()?2:0;(!M||j==1&&k||z==0&&j!=0)&&(t[m]==q||i[m]==q&&(b=!0)?a[m++]=M:a.length&&(A=!1)),z=j,M+=Di(q)}return m==h&&a[0]==0&&A?this.result(-100+(b?-200:0),a,e):v==h&&S==0?this.ret(-200-e.length+(_==e.length?0:-100),[0,_]):u>-1?this.ret(-700-e.length,[u,u+this.pattern.length]):v==h?this.ret(-900-e.length,[S,_]):m==h?this.result(-100+(b?-200:0)+-700+(A?0:-1100),a,e):t.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,t,i){let s=[],l=0;for(let a of t){let u=a+(this.astral?Di(fn(i,a)):1);l&&s[l-1]==a?s[l-1]=u:(s[l++]=a,s[l++]=u)}return this.ret(e-i.length,s)}}class aI{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),i=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,t.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const Rt=X.define({combine(n){return qi(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:cI,filterStrict:!1,compareCompletions:(e,t)=>(e.sortText||e.label).localeCompare(t.sortText||t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>i=>kk(e(i),t(i)),optionClass:(e,t)=>i=>kk(e(i),t(i)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function kk(n,e){return n?e?n+" "+e:n:e}function cI(n,e,t,i,s,l){let a=n.textDirection==Qe.RTL,u=a,h=!1,d="top",g,m,b=e.left-s.left,v=s.right-e.right,S=i.right-i.left,_=i.bottom-i.top;if(u&&b<Math.min(S,v)?u=!1:!u&&v<Math.min(S,b)&&(u=!0),S<=(u?b:v))g=Math.max(s.top,Math.min(t.top,s.bottom-_))-e.top,m=Math.min(400,u?b:v);else{h=!0,m=Math.min(400,(a?e.right:s.right-e.left)-30);let M=s.bottom-e.bottom;M>=_||M>e.top?g=t.bottom-e.top:(d="bottom",g=e.bottom-t.top)}let k=(e.bottom-e.top)/l.offsetHeight,A=(e.right-e.left)/l.offsetWidth;return{style:`${d}: ${g/k}px; max-width: ${m/A}px`,class:"cm-completionInfo-"+(h?a?"left-narrow":"right-narrow":u?"left":"right")}}function uI(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,s,l){let a=document.createElement("span");a.className="cm-completionLabel";let u=t.displayLabel||t.label,h=0;for(let d=0;d<l.length;){let g=l[d++],m=l[d++];g>h&&a.appendChild(document.createTextNode(u.slice(h,g)));let b=a.appendChild(document.createElement("span"));b.appendChild(document.createTextNode(u.slice(g,m))),b.className="cm-completionMatchedText",h=m}return h<u.length&&a.appendChild(document.createTextNode(u.slice(h))),a},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function Ym(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let s=Math.floor(e/t);return{from:s*t,to:(s+1)*t}}let i=Math.floor((n-e)/t);return{from:n-(i+1)*t,to:n-i*t}}class hI{constructor(e,t,i){this.view=e,this.stateField=t,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:h=>this.placeInfo(h),key:this},this.space=null,this.currentClass="";let s=e.state.field(t),{options:l,selected:a}=s.open,u=e.state.facet(Rt);this.optionContent=uI(u),this.optionClass=u.optionClass,this.tooltipClass=u.tooltipClass,this.range=Ym(l.length,a,u.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",h=>{let{options:d}=e.state.field(t).open;for(let g=h.target,m;g&&g!=this.dom;g=g.parentNode)if(g.nodeName=="LI"&&(m=/-(\d+)$/.exec(g.id))&&+m[1]<d.length){this.applyCompletion(e,d[+m[1]]),h.preventDefault();return}}),this.dom.addEventListener("focusout",h=>{let d=e.state.field(this.stateField,!1);d&&d.tooltip&&e.state.facet(Rt).closeOnBlur&&h.relatedTarget!=e.contentDOM&&e.dispatch({effects:jc.of(null)})}),this.showOptions(l,s.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let i=e.state.field(this.stateField),s=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=s){let{options:l,selected:a,disabled:u}=i.open;(!s.open||s.open.options!=l)&&(this.range=Ym(l.length,a,e.state.facet(Rt).maxRenderedOptions),this.showOptions(l,i.id)),this.updateSel(),u!=((t=s.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!u)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of t.split(" "))i&&this.dom.classList.add(i);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;(t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Ym(t.options.length,t.selected,this.view.state.facet(Rt).maxRenderedOptions),this.showOptions(t.options,e.id));let i=this.updateSelectedOption(t.selected);if(i){this.destroyInfo();let{completion:s}=t.options[t.selected],{info:l}=s;if(!l)return;let a=typeof l=="string"?document.createTextNode(l):l(s);if(!a)return;"then"in a?a.then(u=>{u&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(u,s)}).catch(u=>mn(this.view.state,u,"completion info")):(this.addInfoPane(a,s),i.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",i.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:s,destroy:l}=e;i.appendChild(s),this.infoDestroy=l||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,s=this.range.from;i;i=i.nextSibling,s++)i.nodeName!="LI"||!i.id?s--:s==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&(i.removeAttribute("aria-selected"),i.removeAttribute("aria-describedby"));return t&&dI(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),l=this.space;if(!l){let a=this.dom.ownerDocument.documentElement;l={left:0,top:0,right:a.clientWidth,bottom:a.clientHeight}}return s.top>Math.min(l.bottom,t.bottom)-10||s.bottom<Math.max(l.top,t.top)+10?null:this.view.state.facet(Rt).positionInfo(this.view,t,s,i,l,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,i){const s=document.createElement("ul");s.id=t,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions")),s.addEventListener("mousedown",a=>{a.target==s&&a.preventDefault()});let l=null;for(let a=i.from;a<i.to;a++){let{completion:u,match:h}=e[a],{section:d}=u;if(d){let b=typeof d=="string"?d:d.name;if(b!=l&&(a>i.from||i.from==0))if(l=b,typeof d!="string"&&d.header)s.appendChild(d.header(d));else{let v=s.appendChild(document.createElement("completion-section"));v.textContent=b}}const g=s.appendChild(document.createElement("li"));g.id=t+"-"+a,g.setAttribute("role","option");let m=this.optionClass(u);m&&(g.className=m);for(let b of this.optionContent){let v=b(u,this.view.state,this.view,h);v&&g.appendChild(v)}}return i.from&&s.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function fI(n,e){return t=>new hI(t,n,e)}function dI(n,e){let t=n.getBoundingClientRect(),i=e.getBoundingClientRect(),s=t.height/n.offsetHeight;i.top<t.top?n.scrollTop-=(t.top-i.top)/s:i.bottom>t.bottom&&(n.scrollTop+=(i.bottom-t.bottom)/s)}function Ak(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function gI(n,e){let t=[],i=null,s=null,l=g=>{t.push(g);let{section:m}=g.completion;if(m){i||(i=[]);let b=typeof m=="string"?m:m.name;i.some(v=>v.name==b)||i.push(typeof m=="string"?{name:b}:m)}},a=e.facet(Rt);for(let g of n)if(g.hasResult()){let m=g.result.getMatch;if(g.result.filter===!1)for(let b of g.result.options)l(new _k(b,g.source,m?m(b):[],1e9-t.length));else{let b=e.sliceDoc(g.from,g.to),v,S=a.filterStrict?new aI(b):new oI(b);for(let _ of g.result.options)if(v=S.match(_.label)){let k=_.displayLabel?m?m(_,v.matched):[]:v.matched,A=v.score+(_.boost||0);if(l(new _k(_,g.source,k,A)),typeof _.section=="object"&&_.section.rank==="dynamic"){let{name:M}=_.section;s||(s=Object.create(null)),s[M]=Math.max(A,s[M]||-1e9)}}}}if(i){let g=Object.create(null),m=0,b=(v,S)=>(v.rank==="dynamic"&&S.rank==="dynamic"?s[S.name]-s[v.name]:0)||(typeof v.rank=="number"?v.rank:1e9)-(typeof S.rank=="number"?S.rank:1e9)||(v.name<S.name?-1:1);for(let v of i.sort(b))m-=1e5,g[v.name]=m;for(let v of t){let{section:S}=v.completion;S&&(v.score+=g[typeof S=="string"?S:S.name])}}let u=[],h=null,d=a.compareCompletions;for(let g of t.sort((m,b)=>b.score-m.score||d(m.completion,b.completion))){let m=g.completion;!h||h.label!=m.label||h.detail!=m.detail||h.type!=null&&m.type!=null&&h.type!=m.type||h.apply!=m.apply||h.boost!=m.boost?u.push(g):Ak(g.completion)>Ak(h)&&(u[u.length-1]=g),h=g.completion}return u}class so{constructor(e,t,i,s,l,a){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=s,this.selected=l,this.disabled=a}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new so(this.options,Ck(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,i,s,l,a){if(s&&!a&&e.some(d=>d.isPending))return s.setDisabled();let u=gI(e,t);if(!u.length)return s&&e.some(d=>d.isPending)?s.setDisabled():null;let h=t.facet(Rt).selectOnOpen?0:-1;if(s&&s.selected!=h&&s.selected!=-1){let d=s.options[s.selected].completion;for(let g=0;g<u.length;g++)if(u[g].completion==d){h=g;break}}return new so(u,Ck(i,h),{pos:e.reduce((d,g)=>g.hasResult()?Math.min(d,g.from):d,1e8),create:wI,above:l.aboveCursor},s?s.timestamp:Date.now(),h,!1)}map(e){return new so(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new so(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class ed{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new ed(bI,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(Rt),l=(i.override||t.languageDataAt("autocomplete",Pr(t)).map(lI)).map(h=>(this.active.find(g=>g.source==h)||new ei(h,this.active.some(g=>g.state!=0)?1:0)).update(e,i));l.length==this.active.length&&l.every((h,d)=>h==this.active[d])&&(l=this.active);let a=this.open,u=e.effects.some(h=>h.is(jb));a&&e.docChanged&&(a=a.map(e.changes)),e.selection||l.some(h=>h.hasResult()&&e.changes.touchesRange(h.from,h.to))||!pI(l,this.active)||u?a=so.build(l,t,this.id,a,i,u):a&&a.disabled&&!l.some(h=>h.isPending)&&(a=null),!a&&l.every(h=>!h.isPending)&&l.some(h=>h.hasResult())&&(l=l.map(h=>h.hasResult()?new ei(h.source,0):h));for(let h of e.effects)h.is(oO)&&(a=a&&a.setSelected(h.value,this.id));return l==this.active&&a==this.open?this:new ed(l,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?mI:yI}}function pI(n,e){if(n==e)return!0;for(let t=0,i=0;;){for(;t<n.length&&!n[t].hasResult();)t++;for(;i<e.length&&!e[i].hasResult();)i++;let s=t==n.length,l=i==e.length;if(s||l)return s==l;if(n[t++].result!=e[i++].result)return!1}}const mI={"aria-autocomplete":"list"},yI={};function Ck(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const bI=[];function lO(n,e){if(n.isUserEvent("input.complete")){let i=n.annotation(rO);if(i&&e.activateOnCompletion(i))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class ei{constructor(e,t,i=!1){this.source=e,this.state=t,this.explicit=i}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let i=lO(e,t),s=this;(i&8||i&16&&this.touches(e))&&(s=new ei(s.source,0)),i&4&&s.state==0&&(s=new ei(this.source,1)),s=s.updateFor(e,i);for(let l of e.effects)if(l.is(Zf))s=new ei(s.source,1,l.value);else if(l.is(jc))s=new ei(s.source,0);else if(l.is(jb))for(let a of l.value)a.source==s.source&&(s=a);return s}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Pr(e.state))}}class yo extends ei{constructor(e,t,i,s,l,a){super(e,3,t),this.limit=i,this.result=s,this.from=l,this.to=a}hasResult(){return!0}updateFor(e,t){var i;if(!(t&3))return this.map(e.changes);let s=this.result;s.map&&!e.changes.empty&&(s=s.map(s,e.changes));let l=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),u=Pr(e.state);if(u>a||!s||t&2&&(Pr(e.startState)==this.from||u<this.limit))return new ei(this.source,t&4?1:0);let h=e.changes.mapPos(this.limit);return vI(s.validFor,e.state,l,a)?new yo(this.source,this.explicit,h,s,l,a):s.update&&(s=s.update(s,l,a,new iO(e.state,u,!1)))?new yo(this.source,this.explicit,h,s,s.from,(i=s.to)!==null&&i!==void 0?i:Pr(e.state)):new ei(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new yo(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new ei(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function vI(n,e,t,i){if(!n)return!1;let s=e.sliceDoc(t,i);return typeof n=="function"?n(s,t,i,e):sO(n,!0).test(s)}const jb=_e.define({map(n,e){return n.map(t=>t.map(e))}}),oO=_e.define(),dn=Kt.define({create(){return ed.start()},update(n,e){return n.update(e)},provide:n=>[_b.from(n,e=>e.tooltip),J.contentAttributes.from(n,e=>e.attrs)]});function zb(n,e){const t=e.completion.apply||e.completion.label;let i=n.state.field(dn).active.find(s=>s.source==e.source);return i instanceof yo?(typeof t=="string"?n.dispatch({...rI(n.state,t,i.from,i.to),annotations:rO.of(e.completion)}):t(n,e.completion,i.from,i.to),!0):!1}const wI=fI(dn,zb);function Zh(n,e="option"){return t=>{let i=t.state.field(dn,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<t.state.facet(Rt).interactionDelay)return!1;let s=1,l;e=="page"&&(l=WT(t,i.open.tooltip))&&(s=Math.max(2,Math.floor(l.dom.offsetHeight/l.dom.querySelector("li").offsetHeight)-1));let{length:a}=i.open.options,u=i.open.selected>-1?i.open.selected+s*(n?1:-1):n?0:a-1;return u<0?u=e=="page"?0:a-1:u>=a&&(u=e=="page"?a-1:0),t.dispatch({effects:oO.of(u)}),!0}}const SI=n=>{let e=n.state.field(dn,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(Rt).interactionDelay?!1:zb(n,e.open.options[e.open.selected])},Fm=n=>n.state.field(dn,!1)?(n.dispatch({effects:Zf.of(!0)}),!0):!1,_I=n=>{let e=n.state.field(dn,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:jc.of(null)}),!0)};class xI{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const kI=50,AI=1e3,CI=rt.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(dn).active)e.isPending&&this.startQuery(e)}update(n){let e=n.state.field(dn),t=n.state.facet(Rt);if(!n.selectionSet&&!n.docChanged&&n.startState.field(dn)==e)return;let i=n.transactions.some(l=>{let a=lO(l,t);return a&8||(l.selection||l.docChanged)&&!(a&3)});for(let l=0;l<this.running.length;l++){let a=this.running[l];if(i||a.context.abortOnDocChange&&n.docChanged||a.updates.length+n.transactions.length>kI&&Date.now()-a.time>AI){for(let u of a.context.abortListeners)try{u()}catch(h){mn(this.view.state,h)}a.context.abortListeners=null,this.running.splice(l--,1)}else a.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(l=>l.effects.some(a=>a.is(Zf)))&&(this.pendingStart=!0);let s=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(l=>l.isPending&&!this.running.some(a=>a.active.source==l.source))?setTimeout(()=>this.startUpdate(),s):-1,this.composing!=0)for(let l of n.transactions)l.isUserEvent("input.type")?this.composing=2:this.composing==2&&l.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(dn);for(let t of e.active)t.isPending&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Rt).updateSyncTime))}startQuery(n){let{state:e}=this.view,t=Pr(e),i=new iO(e,t,n.explicit,this.view),s=new xI(n,i);this.running.push(s),Promise.resolve(n.source(i)).then(l=>{s.context.aborted||(s.done=l||null,this.scheduleAccept())},l=>{this.view.dispatch({effects:jc.of(null)}),mn(this.view.state,l)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Rt).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Rt),i=this.view.state.field(dn);for(let s=0;s<this.running.length;s++){let l=this.running[s];if(l.done===void 0)continue;if(this.running.splice(s--,1),l.done){let u=Pr(l.updates.length?l.updates[0].startState:this.view.state),h=Math.min(u,l.done.from+(l.active.explicit?0:1)),d=new yo(l.active.source,l.active.explicit,h,l.done,l.done.from,(n=l.done.to)!==null&&n!==void 0?n:u);for(let g of l.updates)d=d.update(g,t);if(d.hasResult()){e.push(d);continue}}let a=i.active.find(u=>u.source==l.active.source);if(a&&a.isPending)if(l.done==null){let u=new ei(l.active.source,0);for(let h of l.updates)u=u.update(h,t);u.isPending||e.push(u)}else this.startQuery(a)}(e.length||i.open&&i.open.disabled)&&this.view.dispatch({effects:jb.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(dn,!1);if(e&&e.tooltip&&this.view.state.facet(Rt).closeOnBlur){let t=e.open&&WT(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:jc.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Zf.of(!1)}),20),this.composing=0}}}),TI=typeof navigator=="object"&&/Win/.test(navigator.platform),EI=nl.highest(J.domEventHandlers({keydown(n,e){let t=e.state.field(dn,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!(TI&&n.altKey)||n.metaKey)return!1;let i=t.open.options[t.open.selected],s=t.active.find(a=>a.source==i.source),l=i.completion.commitCharacters||s.result.commitCharacters;return l&&l.indexOf(n.key)>-1&&zb(e,i),!1}})),OI=J.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),zc={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Ir=_e.define({map(n,e){let t=e.mapPos(n,-1,tn.TrackAfter);return t??void 0}}),Ib=new class extends er{};Ib.startSide=1;Ib.endSide=-1;const aO=Kt.define({create(){return Ee.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:i=>i>=t.from&&i<=t.to})}for(let t of e.effects)t.is(Ir)&&(n=n.update({add:[Ib.range(t.value,t.value+1)]}));return n}});function DI(){return[RI,aO]}const Jm="()[]{}<>";function cO(n){for(let e=0;e<Jm.length;e+=2)if(Jm.charCodeAt(e)==n)return Jm.charAt(e+1);return sb(n<128?n:n+1)}function uO(n,e){return n.languageDataAt("closeBrackets",e)[0]||zc}const MI=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),RI=J.inputHandler.of((n,e,t,i)=>{if((MI?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let s=n.state.selection.main;if(i.length>2||i.length==2&&Di(fn(i,0))==1||e!=s.from||t!=s.to)return!1;let l=BI(n.state,i);return l?(n.dispatch(l),!0):!1}),LI=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let i=uO(n,n.selection.main.head).brackets||zc.brackets,s=null,l=n.changeByRange(a=>{if(a.empty){let u=UI(n.doc,a.head);for(let h of i)if(h==u&&Md(n.doc,a.head)==cO(fn(h,0)))return{changes:{from:a.head-h.length,to:a.head+h.length},range:P.cursor(a.head-h.length)}}return{range:s=a}});return s||e(n.update(l,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},NI=[{key:"Backspace",run:LI}];function BI(n,e){let t=uO(n,n.selection.main.head),i=t.brackets||zc.brackets;for(let s of i){let l=cO(fn(s,0));if(e==s)return l==s?II(n,s,i.indexOf(s+s+s)>-1,t):jI(n,s,l,t.before||zc.before);if(e==l&&hO(n,n.selection.main.from))return zI(n,s,l)}return null}function hO(n,e){let t=!1;return n.field(aO).between(0,n.doc.length,i=>{i==e&&(t=!0)}),t}function Md(n,e){let t=n.sliceString(e,e+2);return t.slice(0,Di(fn(t,0)))}function UI(n,e){let t=n.sliceString(e-2,e);return Di(fn(t,0))==t.length?t:t.slice(1)}function jI(n,e,t,i){let s=null,l=n.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:t,from:a.to}],effects:Ir.of(a.to+e.length),range:P.range(a.anchor+e.length,a.head+e.length)};let u=Md(n.doc,a.head);return!u||/\s/.test(u)||i.indexOf(u)>-1?{changes:{insert:e+t,from:a.head},effects:Ir.of(a.head+e.length),range:P.cursor(a.head+e.length)}:{range:s=a}});return s?null:n.update(l,{scrollIntoView:!0,userEvent:"input.type"})}function zI(n,e,t){let i=null,s=n.changeByRange(l=>l.empty&&Md(n.doc,l.head)==t?{changes:{from:l.head,to:l.head+t.length,insert:t},range:P.cursor(l.head+t.length)}:i={range:l});return i?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function II(n,e,t,i){let s=i.stringPrefixes||zc.stringPrefixes,l=null,a=n.changeByRange(u=>{if(!u.empty)return{changes:[{insert:e,from:u.from},{insert:e,from:u.to}],effects:Ir.of(u.to+e.length),range:P.range(u.anchor+e.length,u.head+e.length)};let h=u.head,d=Md(n.doc,h),g;if(d==e){if(Tk(n,h))return{changes:{insert:e+e,from:h},effects:Ir.of(h+e.length),range:P.cursor(h+e.length)};if(hO(n,h)){let b=t&&n.sliceDoc(h,h+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:h,to:h+b.length,insert:b},range:P.cursor(h+b.length)}}}else{if(t&&n.sliceDoc(h-2*e.length,h)==e+e&&(g=Ek(n,h-2*e.length,s))>-1&&Tk(n,g))return{changes:{insert:e+e+e+e,from:h},effects:Ir.of(h+e.length),range:P.cursor(h+e.length)};if(n.charCategorizer(h)(d)!=st.Word&&Ek(n,h,s)>-1&&!HI(n,h,e,s))return{changes:{insert:e+e,from:h},effects:Ir.of(h+e.length),range:P.cursor(h+e.length)}}return{range:l=u}});return l?null:n.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function Tk(n,e){let t=Jt(n).resolveInner(e+1);return t.parent&&t.from==e}function HI(n,e,t,i){let s=Jt(n).resolveInner(e,-1),l=i.reduce((a,u)=>Math.max(a,u.length),0);for(let a=0;a<5;a++){let u=n.sliceDoc(s.from,Math.min(s.to,s.from+t.length+l)),h=u.indexOf(t);if(!h||h>-1&&i.indexOf(u.slice(0,h))>-1){let g=s.firstChild;for(;g&&g.from==s.from&&g.to-g.from>t.length+h;){if(n.sliceDoc(g.to-t.length,g.to)==t)return!1;g=g.firstChild}return!0}let d=s.to==e&&s.parent;if(!d)break;s=d}return!1}function Ek(n,e,t){let i=n.charCategorizer(e);if(i(n.sliceDoc(e-1,e))!=st.Word)return e;for(let s of t){let l=e-s.length;if(n.sliceDoc(l,e)==s&&i(n.sliceDoc(l-1,l))!=st.Word)return l}return-1}function qI(n={}){return[EI,dn,Rt.of(n),CI,VI,OI]}const fO=[{key:"Ctrl-Space",run:Fm},{mac:"Alt-`",run:Fm},{mac:"Alt-i",run:Fm},{key:"Escape",run:_I},{key:"ArrowDown",run:Zh(!0)},{key:"ArrowUp",run:Zh(!1)},{key:"PageDown",run:Zh(!0,"page")},{key:"PageUp",run:Zh(!1,"page")},{key:"Enter",run:SI}],VI=nl.highest(wb.computeN([Rt],n=>n.facet(Rt).defaultKeymap?[fO]:[]));class Ok{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class Br{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let s=i.facet(Ic).markerFilter;s&&(e=s(e,i));let l=e.slice().sort((v,S)=>v.from-S.from||v.to-S.to),a=new fs,u=[],h=0,d=i.doc.iter(),g=0,m=i.doc.length;for(let v=0;;){let S=v==l.length?null:l[v];if(!S&&!u.length)break;let _,k;if(u.length)_=h,k=u.reduce((O,z)=>Math.min(O,z.to),S&&S.from>_?S.from:1e8);else{if(_=S.from,_>m)break;k=S.to,u.push(S),v++}for(;v<l.length;){let O=l[v];if(O.from==_&&(O.to>O.from||O.to==_))u.push(O),v++,k=Math.min(O.to,k);else{k=Math.min(O.from,k);break}}k=Math.min(k,m);let A=!1;if(u.some(O=>O.from==_&&(O.to==k||k==m))&&(A=_==k,!A&&k-_<10)){let O=_-(g+d.value.length);O>0&&(d.next(O),g=_);for(let z=_;;){if(z>=k){A=!0;break}if(!d.lineBreak&&g+d.value.length>z)break;z=g+d.value.length,g+=d.value.length,d.next()}}let M=t5(u);if(A)a.add(_,_,ae.widget({widget:new XI(M),diagnostics:u.slice()}));else{let O=u.reduce((z,q)=>q.markClass?z+" "+q.markClass:z,"");a.add(_,k,ae.mark({class:"cm-lintRange cm-lintRange-"+M+O,diagnostics:u.slice(),inclusiveEnd:u.some(z=>z.to>k)}))}if(h=k,h==m)break;for(let O=0;O<u.length;O++)u[O].to<=h&&u.splice(O--,1)}let b=a.finish();return new Br(b,t,Lo(b))}}function Lo(n,e=null,t=0){let i=null;return n.between(t,1e9,(s,l,{spec:a})=>{if(!(e&&a.diagnostics.indexOf(e)<0))if(!i)i=new Ok(s,l,e||a.diagnostics[0]);else{if(a.diagnostics.indexOf(i.diagnostic)<0)return!1;i=new Ok(i.from,l,i.diagnostic)}}),i}function $I(n,e){let t=e.pos,i=e.end||t,s=n.state.facet(Ic).hideOn(n,t,i);if(s!=null)return s;let l=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(a=>a.is(dO))||n.changes.touchesRange(l.from,Math.max(l.to,i)))}function PI(n,e){return n.field(Un,!1)?e:e.concat(_e.appendConfig.of(n5))}const dO=_e.define(),Hb=_e.define(),gO=_e.define(),Un=Kt.define({create(){return new Br(ae.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),i=null,s=n.panel;if(n.selected){let l=e.changes.mapPos(n.selected.from,1);i=Lo(t,n.selected.diagnostic,l)||Lo(t,null,l)}!t.size&&s&&e.state.facet(Ic).autoPanel&&(s=null),n=new Br(t,s,i)}for(let t of e.effects)if(t.is(dO)){let i=e.state.facet(Ic).autoPanel?t.value.length?Hc.open:null:n.panel;n=Br.init(t.value,i,e.state)}else t.is(Hb)?n=new Br(n.diagnostics,t.value?Hc.open:null,n.selected):t.is(gO)&&(n=new Br(n.diagnostics,n.panel,t.value));return n},provide:n=>[Rc.from(n,e=>e.panel),J.decorations.from(n,e=>e.diagnostics)]}),GI=ae.mark({class:"cm-lintRange cm-lintRange-active"});function KI(n,e,t){let{diagnostics:i}=n.state.field(Un),s,l=-1,a=-1;i.between(e-(t<0?1:0),e+(t>0?1:0),(h,d,{spec:g})=>{if(e>=h&&e<=d&&(h==d||(e>h||t>0)&&(e<d||t<0)))return s=g.diagnostics,l=h,a=d,!1});let u=n.state.facet(Ic).tooltipFilter;return s&&u&&(s=u(s,n.state)),s?{pos:l,end:a,above:n.state.doc.lineAt(l).to<a,create(){return{dom:WI(n,s)}}}:null}function WI(n,e){return We("ul",{class:"cm-tooltip-lint"},e.map(t=>mO(n,t,!1)))}const YI=n=>{let e=n.state.field(Un,!1);(!e||!e.panel)&&n.dispatch({effects:PI(n.state,[Hb.of(!0)])});let t=xb(n,Hc.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},Dk=n=>{let e=n.state.field(Un,!1);return!e||!e.panel?!1:(n.dispatch({effects:Hb.of(!1)}),!0)},FI=n=>{let e=n.state.field(Un,!1);if(!e)return!1;let t=n.state.selection.main,i=e.diagnostics.iter(t.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==t.from&&i.to==t.to)?!1:(n.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},JI=[{key:"Mod-Shift-m",run:YI,preventDefault:!0},{key:"F8",run:FI}],Ic=X.define({combine(n){return{sources:n.map(e=>e.source).filter(e=>e!=null),...qi(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:Mk,tooltipFilter:Mk,needsRefresh:(e,t)=>e?t?i=>e(i)||t(i):e:t,hideOn:(e,t)=>e?t?(i,s,l)=>e(i,s,l)||t(i,s,l):e:t,autoPanel:(e,t)=>e||t})}}});function Mk(n,e){return n?e?(t,i)=>e(n(t,i),i):n:e}function pO(n){let e=[];if(n)e:for(let{name:t}of n){for(let i=0;i<t.length;i++){let s=t[i];if(/[a-zA-Z]/.test(s)&&!e.some(l=>l.toLowerCase()==s.toLowerCase())){e.push(s);continue e}}e.push("")}return e}function mO(n,e,t){var i;let s=t?pO(e.actions):[];return We("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},We("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((l,a)=>{let u=!1,h=v=>{if(v.preventDefault(),u)return;u=!0;let S=Lo(n.state.field(Un).diagnostics,e);S&&l.apply(n,S.from,S.to)},{name:d}=l,g=s[a]?d.indexOf(s[a]):-1,m=g<0?d:[d.slice(0,g),We("u",d.slice(g,g+1)),d.slice(g+1)],b=l.markClass?" "+l.markClass:"";return We("button",{type:"button",class:"cm-diagnosticAction"+b,onclick:h,onmousedown:h,"aria-label":` Action: ${d}${g<0?"":` (access key "${s[a]})"`}.`},m)}),e.source&&We("div",{class:"cm-diagnosticSource"},e.source))}class XI extends Vi{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return We("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class Rk{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=mO(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Hc{constructor(e){this.view=e,this.items=[];let t=s=>{if(!(s.ctrlKey||s.altKey||s.metaKey)){if(s.keyCode==27)Dk(this.view),this.view.focus();else if(s.keyCode==38||s.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(s.keyCode==40||s.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(s.keyCode==36)this.moveSelection(0);else if(s.keyCode==35)this.moveSelection(this.items.length-1);else if(s.keyCode==13)this.view.focus();else if(s.keyCode>=65&&s.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:l}=this.items[this.selectedIndex],a=pO(l.actions);for(let u=0;u<a.length;u++)if(a[u].toUpperCase().charCodeAt(0)==s.keyCode){let h=Lo(this.view.state.field(Un).diagnostics,l);h&&l.actions[u].apply(e,h.from,h.to)}}else return;s.preventDefault()}},i=s=>{for(let l=0;l<this.items.length;l++)this.items[l].dom.contains(s.target)&&this.moveSelection(l)};this.list=We("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i}),this.dom=We("div",{class:"cm-panel-lint"},this.list,We("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Dk(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(Un).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Un),i=0,s=!1,l=null,a=new Set;for(e.between(0,this.view.state.doc.length,(u,h,{spec:d})=>{for(let g of d.diagnostics){if(a.has(g))continue;a.add(g);let m=-1,b;for(let v=i;v<this.items.length;v++)if(this.items[v].diagnostic==g){m=v;break}m<0?(b=new Rk(this.view,g),this.items.splice(i,0,b),s=!0):(b=this.items[m],m>i&&(this.items.splice(i,m-i),s=!0)),t&&b.diagnostic==t.diagnostic?b.dom.hasAttribute("aria-selected")||(b.dom.setAttribute("aria-selected","true"),l=b):b.dom.hasAttribute("aria-selected")&&b.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();this.items.length==0&&(this.items.push(new Rk(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),l?(this.list.setAttribute("aria-activedescendant",l.id),this.view.requestMeasure({key:this,read:()=>({sel:l.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:u,panel:h})=>{let d=h.height/this.list.offsetHeight;u.top<h.top?this.list.scrollTop-=(h.top-u.top)/d:u.bottom>h.bottom&&(this.list.scrollTop+=(u.bottom-h.bottom)/d)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let e=this.list.firstChild;function t(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Un),i=Lo(t.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:gO.of(i)})}static open(e){return new Hc(e)}}function QI(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function ef(n){return QI(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const ZI=J.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:ef("#d11")},".cm-lintRange-warning":{backgroundImage:ef("orange")},".cm-lintRange-info":{backgroundImage:ef("#999")},".cm-lintRange-hint":{backgroundImage:ef("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function e5(n){return n=="error"?4:n=="warning"?3:n=="info"?2:1}function t5(n){let e="hint",t=1;for(let i of n){let s=e5(i.severity);s>t&&(t=s,e=i.severity)}return e}const n5=[Un,J.decorations.compute([Un],n=>{let{selected:e,panel:t}=n.field(Un);return!e||!t||e.from==e.to?ae.none:ae.set([GI.range(e.from,e.to)])}),q4(KI,{hideOn:$I}),ZI],i5=[ej(),ij(),b4(),xz(),Fj(),o4(),f4(),je.allowMultipleSelections.of(!0),Bj(),Xj(ez,{fallback:!0}),oz(),DI(),qI(),D4(),L4(),k4(),R6(),wb.of([...NI,...T6,...Z6,...Rz,...Gj,...fO,...JI])];class qb{constructor(e,t){this.yanchor=e,this.yhead=t}toJSON(){return{yanchor:H_(this.yanchor),yhead:H_(this.yhead)}}static fromJSON(e){return new qb(_c(e.yanchor),_c(e.yhead))}}class s5{constructor(e,t){this.ytext=e,this.awareness=t,this.undoManager=new oC(e)}toYPos(e,t=0){return O0(this.ytext,e,t)}fromYPos(e){const t=D0(_c(e),this.ytext.doc);if(t==null||t.type!==this.ytext)throw new Error("[y-codemirror] The position you want to retrieve was created by a different document");return{pos:t.index,assoc:t.assoc}}toYRange(e){const t=e.assoc,i=this.toYPos(e.anchor,t),s=this.toYPos(e.head,t);return new qb(i,s)}fromYRange(e){const t=this.fromYPos(e.yanchor),i=this.fromYPos(e.yhead);return t.pos===i.pos?P.cursor(i.pos,i.assoc):P.range(t.pos,i.pos)}}const Rd=X.define({combine(n){return n[n.length-1]}}),Ty=yi.define();class r5{constructor(e){this.view=e,this.conf=e.state.facet(Rd),this._observer=(t,i)=>{if(i.origin!==this.conf){const s=t.delta,l=[];let a=0;for(let u=0;u<s.length;u++){const h=s[u];h.insert!=null?l.push({from:a,to:a,insert:h.insert}):h.delete!=null?(l.push({from:a,to:a+h.delete,insert:""}),a+=h.delete):a+=h.retain}e.dispatch({changes:l,annotations:[Ty.of(this.conf)]})}},this._ytext=this.conf.ytext,this._ytext.observe(this._observer)}update(e){if(!e.docChanged||e.transactions.length>0&&e.transactions[0].annotation(Ty)===this.conf)return;const t=this.conf.ytext;t.doc.transact(()=>{let i=0;e.changes.iterChanges((s,l,a,u,h)=>{const d=h.sliceString(0,h.length,`
`);s!==l&&t.delete(s+i,l-s),d.length>0&&t.insert(s+i,d),i+=d.length-(l-s)})},this.conf)}destroy(){this._ytext.unobserve(this._observer)}}const l5=rt.fromClass(r5),o5=J.baseTheme({".cm-ySelection":{},".cm-yLineSelection":{padding:0,margin:"0px 2px 0px 4px"},".cm-ySelectionCaret":{position:"relative",borderLeft:"1px solid black",borderRight:"1px solid black",marginLeft:"-1px",marginRight:"-1px",boxSizing:"border-box",display:"inline"},".cm-ySelectionCaretDot":{borderRadius:"50%",position:"absolute",width:".4em",height:".4em",top:"-.2em",left:"-.2em",backgroundColor:"inherit",transition:"transform .3s ease-in-out",boxSizing:"border-box"},".cm-ySelectionCaret:hover > .cm-ySelectionCaretDot":{transformOrigin:"bottom center",transform:"scale(0)"},".cm-ySelectionInfo":{position:"absolute",top:"-1.05em",left:"-1px",fontSize:".75em",fontFamily:"serif",fontStyle:"normal",fontWeight:"normal",lineHeight:"normal",userSelect:"none",color:"white",paddingLeft:"2px",paddingRight:"2px",zIndex:101,transition:"opacity .3s ease-in-out",backgroundColor:"inherit",opacity:0,transitionDelay:"0s",whiteSpace:"nowrap"},".cm-ySelectionCaret:hover > .cm-ySelectionInfo":{opacity:1,transitionDelay:"0s"}}),a5=yi.define();class c5 extends Vi{constructor(e,t){super(),this.color=e,this.name=t}toDOM(){return bm("span",[Ln("class","cm-ySelectionCaret"),Ln("style",`background-color: ${this.color}; border-color: ${this.color}`)],[Eh(""),bm("div",[Ln("class","cm-ySelectionCaretDot")]),Eh(""),bm("div",[Ln("class","cm-ySelectionInfo")],[Eh(this.name)]),Eh("")])}eq(e){return e.color===this.color}compare(e){return e.color===this.color}updateDOM(){return!1}get estimatedHeight(){return-1}ignoreEvent(){return!0}}class u5{constructor(e){this.conf=e.state.facet(Rd),this._listener=({added:t,updated:i,removed:s},l,a)=>{t.concat(i).concat(s).findIndex(h=>h!==this.conf.awareness.doc.clientID)>=0&&e.dispatch({annotations:[a5.of([])]})},this._awareness=this.conf.awareness,this._awareness.on("change",this._listener),this.decorations=Ee.of([])}destroy(){this._awareness.off("change",this._listener)}update(e){const t=this.conf.ytext,i=t.doc,s=this.conf.awareness,l=[],a=this.conf.awareness.getLocalState();if(a!=null){const u=e.view.hasFocus&&e.view.dom.ownerDocument.hasFocus(),h=u?e.state.selection.main:null,d=a.cursor==null?null:_c(a.cursor.anchor),g=a.cursor==null?null:_c(a.cursor.head);if(h!=null){const m=O0(t,h.anchor),b=O0(t,h.head);(a.cursor==null||!q_(d,m)||!q_(g,b))&&s.setLocalStateField("cursor",{anchor:m,head:b})}else a.cursor!=null&&u&&s.setLocalStateField("cursor",null)}s.getStates().forEach((u,h)=>{if(h===s.doc.clientID)return;const d=u.cursor;if(d==null||d.anchor==null||d.head==null)return;const g=D0(d.anchor,i),m=D0(d.head,i);if(g==null||m==null||g.type!==t||m.type!==t)return;const{color:b="#30bced",name:v="Anonymous"}=u.user||{},S=u.user&&u.user.colorLight||b+"33",_=Ly(g.index,m.index),k=lr(g.index,m.index),A=e.view.state.doc.lineAt(_),M=e.view.state.doc.lineAt(k);if(A.number===M.number)l.push({from:_,to:k,value:ae.mark({attributes:{style:`background-color: ${S}`},class:"cm-ySelection"})});else{l.push({from:_,to:A.from+A.length,value:ae.mark({attributes:{style:`background-color: ${S}`},class:"cm-ySelection"})}),l.push({from:M.from,to:k,value:ae.mark({attributes:{style:`background-color: ${S}`},class:"cm-ySelection"})});for(let O=A.number+1;O<M.number;O++){const z=e.view.state.doc.line(O).from;l.push({from:z,to:z,value:ae.line({attributes:{style:`background-color: ${S}`,class:"cm-yLineSelection"}})})}}l.push({from:m.index,to:m.index,value:ae.widget({side:m.index-g.index>0?-1:1,block:!1,widget:new c5(b,v)})})}),this.decorations=ae.set(l,!0)}}const h5=rt.fromClass(u5,{decorations:n=>n.decorations}),f5=()=>{let n=!0;return(e,t)=>{if(n){n=!1;try{e()}finally{n=!0}}else t!==void 0&&t()}};class d5{constructor(e){this.undoManager=e}addTrackedOrigin(e){this.undoManager.addTrackedOrigin(e)}removeTrackedOrigin(e){this.undoManager.removeTrackedOrigin(e)}undo(){return this.undoManager.undo()!=null}redo(){return this.undoManager.redo()!=null}}const Ld=X.define({combine(n){return n[n.length-1]}});class g5{constructor(e){this.view=e,this.conf=e.state.facet(Ld),this._undoManager=this.conf.undoManager,this.syncConf=e.state.facet(Rd),this._beforeChangeSelection=null,this._mux=f5(),this._onStackItemAdded=({stackItem:t,changedParentTypes:i})=>{i.has(this.syncConf.ytext)&&this._beforeChangeSelection&&!t.meta.has(this)&&t.meta.set(this,this._beforeChangeSelection)},this._onStackItemPopped=({stackItem:t})=>{const i=t.meta.get(this);if(i){const s=this.syncConf.fromYRange(i);e.dispatch(e.state.update({selection:s,effects:[J.scrollIntoView(s)]})),this._storeSelection()}},this._storeSelection=()=>{this._beforeChangeSelection=this.syncConf.toYRange(this.view.state.selection.main)},this._undoManager.on("stack-item-added",this._onStackItemAdded),this._undoManager.on("stack-item-popped",this._onStackItemPopped),this._undoManager.addTrackedOrigin(this.syncConf)}update(e){e.selectionSet&&(e.transactions.length===0||e.transactions[0].annotation(Ty)!==this.syncConf)&&this._storeSelection()}destroy(){this._undoManager.off("stack-item-added",this._onStackItemAdded),this._undoManager.off("stack-item-popped",this._onStackItemPopped),this._undoManager.removeTrackedOrigin(this.syncConf)}}const p5=rt.fromClass(g5),m5=({state:n,dispatch:e})=>n.facet(Ld).undo()||!0,y5=({state:n,dispatch:e})=>n.facet(Ld).redo()||!0,b5=(n,e,{undoManager:t=new oC(n)}={})=>{const i=new s5(n,e),s=[Rd.of(i),l5];return e&&s.push(o5,h5),t!==!1&&s.push(Ld.of(new d5(t)),p5,J.domEventHandlers({beforeinput(l,a){return l.inputType==="historyUndo"?m5(a):l.inputType==="historyRedo"?y5(a):!1}})),s},Xm=3e4;class v5 extends NL{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const t=yc();this.getLocalState()!==null&&Xm/2<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const i=[];this.meta.forEach((s,l)=>{l!==this.clientID&&Xm<=t-s.lastUpdated&&this.states.has(l)&&i.push(l)}),i.length>0&&w5(this,i,"timeout")},pi(Xm/10)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,i=this.meta.get(t),s=i===void 0?0:i.clock+1,l=this.states.get(t);e===null?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:s,lastUpdated:yc()});const a=[],u=[],h=[],d=[];e===null?d.push(t):l==null?e!=null&&a.push(t):(u.push(t),lo(l,e)||h.push(t)),(a.length>0||h.length>0||d.length>0)&&this.emit("change",[{added:a,updated:h,removed:d},"local"]),this.emit("update",[{added:a,updated:u,removed:d},"local"])}setLocalStateField(e,t){const i=this.getLocalState();i!==null&&this.setLocalState({...i,[e]:t})}getStates(){return this.states}}const w5=(n,e,t)=>{const i=[];for(let s=0;s<e.length;s++){const l=e[s];if(n.states.has(l)){if(n.states.delete(l),l===n.clientID){const a=n.meta.get(l);n.meta.set(l,{clock:a.clock+1,lastUpdated:yc()})}i.push(l)}}i.length>0&&(n.emit("change",[{added:[],updated:[],removed:i},t]),n.emit("update",[{added:[],updated:[],removed:i},t]))},S5=(n,e,t=n.states)=>{const i=e.length,s=$c();Ce(s,i);for(let l=0;l<i;l++){const a=e[l],u=t.get(a)||null,h=n.meta.get(a).clock;Ce(s,a),Ce(s,h),qr(s,JSON.stringify(u))}return fi(s)},_5=(n,e,t)=>{const i=Zr(e),s=yc(),l=[],a=[],u=[],h=[],d=ke(i);for(let g=0;g<d;g++){const m=ke(i);let b=ke(i);const v=JSON.parse(Vr(i)),S=n.meta.get(m),_=n.states.get(m),k=S===void 0?0:S.clock;(k<b||k===b&&v===null&&n.states.has(m))&&(v===null?m===n.clientID&&n.getLocalState()!=null?b++:n.states.delete(m):n.states.set(m,v),n.meta.set(m,{clock:b,lastUpdated:s}),S===void 0&&v!==null?l.push(m):S!==void 0&&v===null?h.push(m):v!==null&&(lo(v,_)||u.push(m),a.push(m)))}(l.length>0||u.length>0||h.length>0)&&n.emit("change",[{added:l,updated:u,removed:h},t]),(l.length>0||a.length>0||h.length>0)&&n.emit("update",[{added:l,updated:a,removed:h},t])};class x5{doc;channel;awareness;_isConnected=!1;_resyncInterval=null;constructor(e,t,i){this.doc=e,this.awareness=new v5(e),this.channel=t.channel(i),this.channel.on("broadcast",{event:"awareness-update"},({payload:s})=>{_5(this.awareness,new Uint8Array(s),"remote")}).on("broadcast",{event:"sync-step-1"},({payload:s})=>{const l=new Uint8Array(s),a=XA(e,l);a.length>0&&this.broadcast("sync-step-2",a)}).on("broadcast",{event:"sync-step-2"},({payload:s})=>{const l=new Uint8Array(s);JA(e,l,"remote")}).subscribe(s=>{s==="SUBSCRIBED"?(this._isConnected=!0,this.initSync()):this._isConnected=!1}),e.on("update",(s,l)=>{l!=="remote"&&l!=="db-load"&&this._isConnected&&this.broadcast("sync-step-2",s)}),this.awareness.on("update",({added:s,updated:l,removed:a})=>{if(!this._isConnected)return;const u=s.concat(l).concat(a),h=S5(this.awareness,u);this.broadcast("awareness-update",h)}),this._resyncInterval=setInterval(()=>{this._isConnected&&this.awareness.getStates().size>0&&this.initSync()},3e4)}initSync(){const e=PB(this.doc);this.broadcast("sync-step-1",e)}broadcast(e,t){this._isConnected&&this.channel.send({type:"broadcast",event:e,payload:Array.from(t)})}destroy(){this._resyncInterval&&clearInterval(this._resyncInterval),this.channel.unsubscribe(),this.awareness.destroy()}}var Qm,Lk;function yO(){if(Lk)return Qm;Lk=1;function n(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Qm=n,Qm}var Zm,Nk;function k5(){if(Nk)return Zm;Nk=1;var n=typeof wh=="object"&&wh&&wh.Object===Object&&wh;return Zm=n,Zm}var e0,Bk;function bO(){if(Bk)return e0;Bk=1;var n=k5(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=n||e||Function("return this")();return e0=t,e0}var t0,Uk;function A5(){if(Uk)return t0;Uk=1;var n=bO(),e=function(){return n.Date.now()};return t0=e,t0}var n0,jk;function C5(){if(jk)return n0;jk=1;var n=/\s/;function e(t){for(var i=t.length;i--&&n.test(t.charAt(i)););return i}return n0=e,n0}var i0,zk;function T5(){if(zk)return i0;zk=1;var n=C5(),e=/^\s+/;function t(i){return i&&i.slice(0,n(i)+1).replace(e,"")}return i0=t,i0}var s0,Ik;function vO(){if(Ik)return s0;Ik=1;var n=bO(),e=n.Symbol;return s0=e,s0}var r0,Hk;function E5(){if(Hk)return r0;Hk=1;var n=vO(),e=Object.prototype,t=e.hasOwnProperty,i=e.toString,s=n?n.toStringTag:void 0;function l(a){var u=t.call(a,s),h=a[s];try{a[s]=void 0;var d=!0}catch{}var g=i.call(a);return d&&(u?a[s]=h:delete a[s]),g}return r0=l,r0}var l0,qk;function O5(){if(qk)return l0;qk=1;var n=Object.prototype,e=n.toString;function t(i){return e.call(i)}return l0=t,l0}var o0,Vk;function D5(){if(Vk)return o0;Vk=1;var n=vO(),e=E5(),t=O5(),i="[object Null]",s="[object Undefined]",l=n?n.toStringTag:void 0;function a(u){return u==null?u===void 0?s:i:l&&l in Object(u)?e(u):t(u)}return o0=a,o0}var a0,$k;function M5(){if($k)return a0;$k=1;function n(e){return e!=null&&typeof e=="object"}return a0=n,a0}var c0,Pk;function R5(){if(Pk)return c0;Pk=1;var n=D5(),e=M5(),t="[object Symbol]";function i(s){return typeof s=="symbol"||e(s)&&n(s)==t}return c0=i,c0}var u0,Gk;function L5(){if(Gk)return u0;Gk=1;var n=T5(),e=yO(),t=R5(),i=NaN,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,a=/^0o[0-7]+$/i,u=parseInt;function h(d){if(typeof d=="number")return d;if(t(d))return i;if(e(d)){var g=typeof d.valueOf=="function"?d.valueOf():d;d=e(g)?g+"":g}if(typeof d!="string")return d===0?d:+d;d=n(d);var m=l.test(d);return m||a.test(d)?u(d.slice(2),m?2:8):s.test(d)?i:+d}return u0=h,u0}var h0,Kk;function N5(){if(Kk)return h0;Kk=1;var n=yO(),e=A5(),t=L5(),i="Expected a function",s=Math.max,l=Math.min;function a(u,h,d){var g,m,b,v,S,_,k=0,A=!1,M=!1,O=!0;if(typeof u!="function")throw new TypeError(i);h=t(h)||0,n(d)&&(A=!!d.leading,M="maxWait"in d,b=M?s(t(d.maxWait)||0,h):b,O="trailing"in d?!!d.trailing:O);function z(oe){var fe=g,ye=m;return g=m=void 0,k=oe,v=u.apply(ye,fe),v}function q(oe){return k=oe,S=setTimeout(ee,h),A?z(oe):v}function V(oe){var fe=oe-_,ye=oe-k,B=h-fe;return M?l(B,b-ye):B}function j(oe){var fe=oe-_,ye=oe-k;return _===void 0||fe>=h||fe<0||M&&ye>=b}function ee(){var oe=e();if(j(oe))return se(oe);S=setTimeout(ee,V(oe))}function se(oe){return S=void 0,O&&g?z(oe):(g=m=void 0,v)}function Me(){S!==void 0&&clearTimeout(S),k=0,g=_=m=S=void 0}function he(){return S===void 0?v:se(e())}function te(){var oe=e(),fe=j(oe);if(g=arguments,m=this,_=oe,fe){if(S===void 0)return q(_);if(M)return clearTimeout(S),S=setTimeout(ee,h),z(_)}return S===void 0&&(S=setTimeout(ee,h)),v}return te.cancel=Me,te.flush=he,te}return h0=a,h0}var B5=N5();const U5=$D(B5),j5=(n,e)=>{const[t,i]=gt.useState("idle"),s=gt.useRef(!1),l=h=>{const d=h.startsWith("\\x")?h.slice(2):h;if(!/^[0-9a-fA-F]*$/.test(d))return new Uint8Array([]);const g=d.match(/.{1,2}/g);return g?new Uint8Array(g.map(m=>parseInt(m,16))):new Uint8Array([])},a=gt.useCallback(async h=>{i("loading"),s.current=!1;try{const{data:d,error:g}=await n.from("documents").select("content").eq("id",h).maybeSingle();if(g)throw g;if(d?.content){const m=typeof d.content=="string"?d.content:"",b=l(m);b.length>0&&JA(e,b,"db-load")}s.current=!0,i("saved")}catch(d){console.error("Failed to load document:",d),i("error")}},[n,e]),u=gt.useCallback(U5(async h=>{if(s.current){i("saving");try{const d=XA(e),g=Array.from(d).map(b=>b.toString(16).padStart(2,"0")).join(""),{error:m}=await n.from("documents").update({content:`\\x${g}`,updated_at:new Date().toISOString()}).eq("id",h);if(m)throw m;i("saved")}catch(d){console.error("Failed to save document:",d),i("error")}}},2e3),[n,e]);return{status:t,loadDocument:a,saveDocument:u}},Wk=["#30bced","#6eeb83","#ffbc42","#ecd444","#ee6352"],z5=J.theme({"&":{height:"100vh",backgroundColor:"transparent",color:"#e0e0e0"},".cm-scroller":{overflow:"auto",fontFamily:"'Courier Prime', 'Courier', monospace"},".cm-content":{caretColor:"white",margin:"0 auto",maxWidth:"60ch",paddingLeft:"2.5ch",paddingRight:"2.5ch",paddingTop:"50vh",paddingBottom:"50vh"},".cm-cursor":{borderLeftColor:"white",borderLeftWidth:"2px"},".cm-gutters":{display:"none"},".cm-activeLine":{backgroundColor:"transparent"},".cm-activeLineGutter":{backgroundColor:"transparent"}}),I5=({documentId:n,supabase:e})=>{const t=gt.useRef(null),[i]=gt.useState(()=>new el),{status:s,loadDocument:l,saveDocument:a}=j5(e,i);return gt.useEffect(()=>{const u=new x5(i,e,n),h=i.getText("codemirror");u.awareness.setLocalStateField("user",{name:"Writer "+Math.floor(Math.random()*100),color:Wk[Math.floor(Math.random()*Wk.length)]});const d=je.create({doc:h.toString(),extensions:[i5,z5,b5(h,u.awareness),J.lineWrapping,J.scrollMargins.of(m=>{const v=m.dom.clientHeight/2;return{top:v-10,bottom:v-10}}),J.updateListener.of(m=>{m.docChanged&&a(n)})]}),g=new J({state:d,parent:t.current});return l(n),()=>{g.destroy(),u.destroy()}},[n,e,i,a,l]),Te.jsxs(Te.Fragment,{children:[Te.jsx("div",{ref:t,style:{width:"100%",height:"100vh",outline:"none"}}),Te.jsxs("div",{style:{position:"fixed",bottom:20,right:20,color:"#666",fontFamily:"sans-serif",fontSize:"12px",pointerEvents:"none"},children:[s==="loading"&&"Loading...",s==="saving"&&"Saving...",s==="saved"&&"Saved",s==="error"&&"Sync Error"]})]})},H5=({supabase:n})=>{const[e,t]=gt.useState(!1),[i,s]=gt.useState(""),[l,a]=gt.useState(""),[u,h]=gt.useState(!0),[d,g]=gt.useState(""),m=async b=>{b.preventDefault(),t(!0),g("");try{if(u){const{error:v}=await n.auth.signInWithPassword({email:i,password:l});if(v)throw v}else{const{error:v}=await n.auth.signUp({email:i,password:l});if(v)throw v;g("Check your email for the login link!")}}catch(v){g(v.message)}finally{t(!1)}};return Te.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",color:"#e0e0e0",fontFamily:"sans-serif"},children:[Te.jsx("h1",{style:{fontFamily:"Courier Prime, monospace"},children:"Screenplay Editor"}),Te.jsxs("form",{onSubmit:m,style:{display:"flex",flexDirection:"column",gap:"1rem",width:"300px"},children:[Te.jsx("input",{type:"email",placeholder:"Email",value:i,onChange:b=>s(b.target.value),style:{padding:"10px",background:"#333",border:"none",color:"white"}}),Te.jsx("input",{type:"password",placeholder:"Password",value:l,onChange:b=>a(b.target.value),style:{padding:"10px",background:"#333",border:"none",color:"white"}}),Te.jsx("button",{type:"submit",disabled:e,style:{padding:"10px",cursor:"pointer",background:"#30bced",border:"none",color:"black",fontWeight:"bold"},children:e?"Processing...":u?"Log In":"Sign Up"})]}),Te.jsx("p",{style:{marginTop:"1rem",cursor:"pointer",textDecoration:"underline",fontSize:"0.9rem"},onClick:()=>h(!u),children:u?"Need an account? Sign Up":"Have an account? Log In"}),d&&Te.jsx("p",{style:{color:"#ffbc42",marginTop:"1rem"},children:d})]})},q5=({supabase:n,userId:e,onOpenDocument:t,onClose:i})=>{const[s,l]=gt.useState([]),[a,u]=gt.useState(!0),[h,d]=gt.useState("");gt.useEffect(()=>{g()},[]);const g=async()=>{const{data:v}=await n.from("documents").select("id, title, updated_at").order("updated_at",{ascending:!1});v&&l(v),u(!1)},m=async()=>{if(!h.trim())return;const{data:v,error:S}=await n.from("documents").insert({title:h,owner_id:e,content:""}).select().single();v?t(v.id):S&&console.error(S)},b=async(v,S)=>{S.stopPropagation(),confirm("Are you sure you want to delete this screenplay?")&&(await n.from("documents").delete().eq("id",v),g())};return Te.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",zIndex:100,display:"flex",justifyContent:"center",alignItems:"center"},children:Te.jsxs("div",{style:{background:"#1a1a1a",border:"1px solid #444",padding:"2rem",width:"500px",maxHeight:"80vh",overflowY:"auto",borderRadius:"8px"},children:[Te.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2rem"},children:[Te.jsx("h2",{style:{margin:0},children:"My Screenplays"}),Te.jsx("button",{onClick:i,style:{background:"none",border:"none",color:"#666",cursor:"pointer"},children:"Close"})]}),Te.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"2rem"},children:[Te.jsx("input",{value:h,onChange:v=>d(v.target.value),placeholder:"New Screenplay Title...",style:{flex:1,padding:"8px",background:"#333",border:"none",color:"white"}}),Te.jsx("button",{onClick:m,style:{padding:"8px 16px",background:"#30bced",border:"none",cursor:"pointer"},children:"Create"})]}),a?Te.jsx("p",{children:"Loading..."}):Te.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[s.map(v=>Te.jsxs("div",{onClick:()=>t(v.id),style:{padding:"15px",background:"#222",border:"1px solid #333",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseEnter:S=>S.currentTarget.style.borderColor="#555",onMouseLeave:S=>S.currentTarget.style.borderColor="#333",children:[Te.jsxs("div",{children:[Te.jsx("div",{style:{fontWeight:"bold"},children:v.title}),Te.jsx("div",{style:{fontSize:"0.8rem",color:"#666"},children:new Date(v.updated_at).toLocaleDateString()})]}),Te.jsx("button",{onClick:S=>b(v.id,S),style:{color:"#ee6352",background:"none",border:"none",cursor:"pointer",fontSize:"1.2rem"},children:""})]},v.id)),s.length===0&&Te.jsx("p",{style:{color:"#666"},children:"No scripts found."})]})]})})},$a=EL("https://kktvjaujpqejxiqvopwa.supabase.co","sb_publishable_mE97Q9kBgo-eulQGtx3HHw_ur0aFNh4",{realtime:{params:{eventsPerSecond:10}}});function V5(){const[n,e]=gt.useState(null),[t,i]=gt.useState(null),[s,l]=gt.useState(!1);gt.useEffect(()=>{$a.auth.getSession().then(({data:{session:h}})=>{e(h),h&&l(!0)});const{data:{subscription:u}}=$a.auth.onAuthStateChange((h,d)=>{e(d),d?t||l(!0):(i(null),l(!1))});return()=>u.unsubscribe()},[t]);const a=()=>Te.jsx("div",{style:{position:"fixed",top:20,left:20,zIndex:50,display:"flex",gap:"10px"},children:Te.jsx("button",{onClick:()=>l(!0),style:{background:"#333",color:"white",border:"none",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",opacity:.7},children:" Files"})});return n?Te.jsxs("div",{className:"App",children:[Te.jsx(a,{}),t?Te.jsx(I5,{documentId:t,supabase:$a},t):Te.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:"No document open"}),s&&Te.jsx(q5,{supabase:$a,userId:n.user.id,onOpenDocument:u=>{i(u),l(!1)},onClose:()=>{t&&l(!1)}})]}):Te.jsx(H5,{supabase:$a})}ZD.createRoot(document.getElementById("root")).render(Te.jsx(gt.StrictMode,{children:Te.jsx(V5,{})}));
