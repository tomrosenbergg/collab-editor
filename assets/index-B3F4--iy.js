(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();var Ch=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function RR(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hm={exports:{}},Va={};var ok;function MR(){if(ok)return Va;ok=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,l){var a=null;if(l!==void 0&&(a=""+l),s.key!==void 0&&(a=""+s.key),"key"in s){l={};for(var c in s)c!=="key"&&(l[c]=s[c])}else l=s;return s=l.ref,{$$typeof:n,type:i,key:a,ref:s!==void 0?s:null,props:l}}return Va.Fragment=e,Va.jsx=t,Va.jsxs=t,Va}var ak;function NR(){return ak||(ak=1,hm.exports=MR()),hm.exports}var H=NR(),fm={exports:{}},we={};var ck;function LR(){if(ck)return we;ck=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),b=Symbol.iterator;function v(T){return T===null||typeof T!="object"?null:(T=b&&T[b]||T["@@iterator"],typeof T=="function"?T:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,_={};function O(T,V,Y){this.props=T,this.context=V,this.refs=_,this.updater=Y||w}O.prototype.isReactComponent={},O.prototype.setState=function(T,V){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,V,"setState")},O.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function R(){}R.prototype=O.prototype;function C(T,V,Y){this.props=T,this.context=V,this.refs=_,this.updater=Y||w}var U=C.prototype=new R;U.constructor=C,k(U,O.prototype),U.isPureReactComponent=!0;var B=Array.isArray;function z(){}var D={H:null,A:null,T:null,S:null},W=Object.prototype.hasOwnProperty;function ne(T,V,Y){var ie=Y.ref;return{$$typeof:n,type:T,key:V,ref:ie!==void 0?ie:null,props:Y}}function Ce(T,V){return ne(T.type,V,T.props)}function de(T){return typeof T=="object"&&T!==null&&T.$$typeof===n}function J(T){var V={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(Y){return V[Y]})}var oe=/\/+/g;function Q(T,V){return typeof T=="object"&&T!==null&&T.key!=null?J(""+T.key):V.toString(36)}function ue(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(z,z):(T.status="pending",T.then(function(V){T.status==="pending"&&(T.status="fulfilled",T.value=V)},function(V){T.status==="pending"&&(T.status="rejected",T.reason=V)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function I(T,V,Y,ie,ye){var Se=typeof T;(Se==="undefined"||Se==="boolean")&&(T=null);var ze=!1;if(T===null)ze=!0;else switch(Se){case"bigint":case"string":case"number":ze=!0;break;case"object":switch(T.$$typeof){case n:case e:ze=!0;break;case p:return ze=T._init,I(ze(T._payload),V,Y,ie,ye)}}if(ze)return ye=ye(T),ze=ie===""?"."+Q(T,0):ie,B(ye)?(Y="",ze!=null&&(Y=ze.replace(oe,"$&/")+"/"),I(ye,V,Y,"",function(Xo){return Xo})):ye!=null&&(de(ye)&&(ye=Ce(ye,Y+(ye.key==null||T&&T.key===ye.key?"":(""+ye.key).replace(oe,"$&/")+"/")+ze)),V.push(ye)),1;ze=0;var Jt=ie===""?".":ie+":";if(B(T))for(var ht=0;ht<T.length;ht++)ie=T[ht],Se=Jt+Q(ie,ht),ze+=I(ie,V,Y,Se,ye);else if(ht=v(T),typeof ht=="function")for(T=ht.call(T),ht=0;!(ie=T.next()).done;)ie=ie.value,Se=Jt+Q(ie,ht++),ze+=I(ie,V,Y,Se,ye);else if(Se==="object"){if(typeof T.then=="function")return I(ue(T),V,Y,ie,ye);throw V=String(T),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return ze}function F(T,V,Y){if(T==null)return T;var ie=[],ye=0;return I(T,ie,"","",function(Se){return V.call(Y,Se,ye++)}),ie}function ae(T){if(T._status===-1){var V=T._result;V=V(),V.then(function(Y){(T._status===0||T._status===-1)&&(T._status=1,T._result=Y)},function(Y){(T._status===0||T._status===-1)&&(T._status=2,T._result=Y)}),T._status===-1&&(T._status=0,T._result=V)}if(T._status===1)return T._result.default;throw T._result}var ve=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)},Te={map:F,forEach:function(T,V,Y){F(T,function(){V.apply(this,arguments)},Y)},count:function(T){var V=0;return F(T,function(){V++}),V},toArray:function(T){return F(T,function(V){return V})||[]},only:function(T){if(!de(T))throw Error("React.Children.only expected to receive a single React element child.");return T}};return we.Activity=m,we.Children=Te,we.Component=O,we.Fragment=t,we.Profiler=s,we.PureComponent=C,we.StrictMode=i,we.Suspense=h,we.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,we.__COMPILER_RUNTIME={__proto__:null,c:function(T){return D.H.useMemoCache(T)}},we.cache=function(T){return function(){return T.apply(null,arguments)}},we.cacheSignal=function(){return null},we.cloneElement=function(T,V,Y){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var ie=k({},T.props),ye=T.key;if(V!=null)for(Se in V.key!==void 0&&(ye=""+V.key),V)!W.call(V,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&V.ref===void 0||(ie[Se]=V[Se]);var Se=arguments.length-2;if(Se===1)ie.children=Y;else if(1<Se){for(var ze=Array(Se),Jt=0;Jt<Se;Jt++)ze[Jt]=arguments[Jt+2];ie.children=ze}return ne(T.type,ye,ie)},we.createContext=function(T){return T={$$typeof:a,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:l,_context:T},T},we.createElement=function(T,V,Y){var ie,ye={},Se=null;if(V!=null)for(ie in V.key!==void 0&&(Se=""+V.key),V)W.call(V,ie)&&ie!=="key"&&ie!=="__self"&&ie!=="__source"&&(ye[ie]=V[ie]);var ze=arguments.length-2;if(ze===1)ye.children=Y;else if(1<ze){for(var Jt=Array(ze),ht=0;ht<ze;ht++)Jt[ht]=arguments[ht+2];ye.children=Jt}if(T&&T.defaultProps)for(ie in ze=T.defaultProps,ze)ye[ie]===void 0&&(ye[ie]=ze[ie]);return ne(T,Se,ye)},we.createRef=function(){return{current:null}},we.forwardRef=function(T){return{$$typeof:c,render:T}},we.isValidElement=de,we.lazy=function(T){return{$$typeof:p,_payload:{_status:-1,_result:T},_init:ae}},we.memo=function(T,V){return{$$typeof:d,type:T,compare:V===void 0?null:V}},we.startTransition=function(T){var V=D.T,Y={};D.T=Y;try{var ie=T(),ye=D.S;ye!==null&&ye(Y,ie),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"&&ie.then(z,ve)}catch(Se){ve(Se)}finally{V!==null&&Y.types!==null&&(V.types=Y.types),D.T=V}},we.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},we.use=function(T){return D.H.use(T)},we.useActionState=function(T,V,Y){return D.H.useActionState(T,V,Y)},we.useCallback=function(T,V){return D.H.useCallback(T,V)},we.useContext=function(T){return D.H.useContext(T)},we.useDebugValue=function(){},we.useDeferredValue=function(T,V){return D.H.useDeferredValue(T,V)},we.useEffect=function(T,V){return D.H.useEffect(T,V)},we.useEffectEvent=function(T){return D.H.useEffectEvent(T)},we.useId=function(){return D.H.useId()},we.useImperativeHandle=function(T,V,Y){return D.H.useImperativeHandle(T,V,Y)},we.useInsertionEffect=function(T,V){return D.H.useInsertionEffect(T,V)},we.useLayoutEffect=function(T,V){return D.H.useLayoutEffect(T,V)},we.useMemo=function(T,V){return D.H.useMemo(T,V)},we.useOptimistic=function(T,V){return D.H.useOptimistic(T,V)},we.useReducer=function(T,V,Y){return D.H.useReducer(T,V,Y)},we.useRef=function(T){return D.H.useRef(T)},we.useState=function(T){return D.H.useState(T)},we.useSyncExternalStore=function(T,V,Y){return D.H.useSyncExternalStore(T,V,Y)},we.useTransition=function(){return D.H.useTransition()},we.version="19.2.4",we}var uk;function Gy(){return uk||(uk=1,fm.exports=LR()),fm.exports}var pe=Gy(),dm={exports:{}},$a={},pm={exports:{}},gm={};var hk;function BR(){return hk||(hk=1,(function(n){function e(I,F){var ae=I.length;I.push(F);e:for(;0<ae;){var ve=ae-1>>>1,Te=I[ve];if(0<s(Te,F))I[ve]=F,I[ae]=Te,ae=ve;else break e}}function t(I){return I.length===0?null:I[0]}function i(I){if(I.length===0)return null;var F=I[0],ae=I.pop();if(ae!==F){I[0]=ae;e:for(var ve=0,Te=I.length,T=Te>>>1;ve<T;){var V=2*(ve+1)-1,Y=I[V],ie=V+1,ye=I[ie];if(0>s(Y,ae))ie<Te&&0>s(ye,Y)?(I[ve]=ye,I[ie]=ae,ve=ie):(I[ve]=Y,I[V]=ae,ve=V);else if(ie<Te&&0>s(ye,ae))I[ve]=ye,I[ie]=ae,ve=ie;else break e}}return F}function s(I,F){var ae=I.sortIndex-F.sortIndex;return ae!==0?ae:I.id-F.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var a=Date,c=a.now();n.unstable_now=function(){return a.now()-c}}var h=[],d=[],p=1,m=null,b=3,v=!1,w=!1,k=!1,_=!1,O=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function U(I){for(var F=t(d);F!==null;){if(F.callback===null)i(d);else if(F.startTime<=I)i(d),F.sortIndex=F.expirationTime,e(h,F);else break;F=t(d)}}function B(I){if(k=!1,U(I),!w)if(t(h)!==null)w=!0,z||(z=!0,J());else{var F=t(d);F!==null&&ue(B,F.startTime-I)}}var z=!1,D=-1,W=5,ne=-1;function Ce(){return _?!0:!(n.unstable_now()-ne<W)}function de(){if(_=!1,z){var I=n.unstable_now();ne=I;var F=!0;try{e:{w=!1,k&&(k=!1,R(D),D=-1),v=!0;var ae=b;try{t:{for(U(I),m=t(h);m!==null&&!(m.expirationTime>I&&Ce());){var ve=m.callback;if(typeof ve=="function"){m.callback=null,b=m.priorityLevel;var Te=ve(m.expirationTime<=I);if(I=n.unstable_now(),typeof Te=="function"){m.callback=Te,U(I),F=!0;break t}m===t(h)&&i(h),U(I)}else i(h);m=t(h)}if(m!==null)F=!0;else{var T=t(d);T!==null&&ue(B,T.startTime-I),F=!1}}break e}finally{m=null,b=ae,v=!1}F=void 0}}finally{F?J():z=!1}}}var J;if(typeof C=="function")J=function(){C(de)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,Q=oe.port2;oe.port1.onmessage=de,J=function(){Q.postMessage(null)}}else J=function(){O(de,0)};function ue(I,F){D=O(function(){I(n.unstable_now())},F)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(I){I.callback=null},n.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<I?Math.floor(1e3/I):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(I){switch(b){case 1:case 2:case 3:var F=3;break;default:F=b}var ae=b;b=F;try{return I()}finally{b=ae}},n.unstable_requestPaint=function(){_=!0},n.unstable_runWithPriority=function(I,F){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var ae=b;b=I;try{return F()}finally{b=ae}},n.unstable_scheduleCallback=function(I,F,ae){var ve=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?ve+ae:ve):ae=ve,I){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=ae+Te,I={id:p++,callback:F,priorityLevel:I,startTime:ae,expirationTime:Te,sortIndex:-1},ae>ve?(I.sortIndex=ae,e(d,I),t(h)===null&&I===t(d)&&(k?(R(D),D=-1):k=!0,ue(B,ae-ve))):(I.sortIndex=Te,e(h,I),w||v||(w=!0,z||(z=!0,J()))),I},n.unstable_shouldYield=Ce,n.unstable_wrapCallback=function(I){var F=b;return function(){var ae=b;b=F;try{return I.apply(this,arguments)}finally{b=ae}}}})(gm)),gm}var fk;function jR(){return fk||(fk=1,pm.exports=BR()),pm.exports}var mm={exports:{}},Ft={};var dk;function UR(){if(dk)return Ft;dk=1;var n=Gy();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(h,d,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:m==null?null:""+m,children:h,containerInfo:d,implementation:p}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ft.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ft.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return l(h,d,null,p)},Ft.flushSync=function(h){var d=a.T,p=i.p;try{if(a.T=null,i.p=2,h)return h()}finally{a.T=d,i.p=p,i.d.f()}},Ft.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(h,d))},Ft.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},Ft.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,m=c(p,d.crossOrigin),b=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?i.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:m,integrity:b,fetchPriority:v}):p==="script"&&i.d.X(h,{crossOrigin:m,integrity:b,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ft.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=c(d.as,d.crossOrigin);i.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(h)},Ft.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,m=c(p,d.crossOrigin);i.d.L(h,p,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ft.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=c(d.as,d.crossOrigin);i.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(h)},Ft.requestFormReset=function(h){i.d.r(h)},Ft.unstable_batchedUpdates=function(h,d){return h(d)},Ft.useFormState=function(h,d,p){return a.H.useFormState(h,d,p)},Ft.useFormStatus=function(){return a.H.useHostTransitionStatus()},Ft.version="19.2.4",Ft}var pk;function zR(){if(pk)return mm.exports;pk=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),mm.exports=UR(),mm.exports}var gk;function IR(){if(gk)return $a;gk=1;var n=jR(),e=Gy(),t=zR();function i(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function a(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function c(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function h(r){if(l(r)!==r)throw Error(i(188))}function d(r){var o=r.alternate;if(!o){if(o=l(r),o===null)throw Error(i(188));return o!==r?null:r}for(var u=r,f=o;;){var g=u.return;if(g===null)break;var y=g.alternate;if(y===null){if(f=g.return,f!==null){u=f;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===u)return h(g),r;if(y===f)return h(g),o;y=y.sibling}throw Error(i(188))}if(u.return!==f.return)u=g,f=y;else{for(var S=!1,x=g.child;x;){if(x===u){S=!0,u=g,f=y;break}if(x===f){S=!0,f=g,u=y;break}x=x.sibling}if(!S){for(x=y.child;x;){if(x===u){S=!0,u=y,f=g;break}if(x===f){S=!0,f=y,u=g;break}x=x.sibling}if(!S)throw Error(i(189))}}if(u.alternate!==f)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?r:o}function p(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=p(r),o!==null)return o;r=r.sibling}return null}var m=Object.assign,b=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),C=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),ne=Symbol.for("react.activity"),Ce=Symbol.for("react.memo_cache_sentinel"),de=Symbol.iterator;function J(r){return r===null||typeof r!="object"?null:(r=de&&r[de]||r["@@iterator"],typeof r=="function"?r:null)}var oe=Symbol.for("react.client.reference");function Q(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===oe?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case k:return"Fragment";case O:return"Profiler";case _:return"StrictMode";case B:return"Suspense";case z:return"SuspenseList";case ne:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case C:return r.displayName||"Context";case R:return(r._context.displayName||"Context")+".Consumer";case U:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case D:return o=r.displayName||null,o!==null?o:Q(r.type)||"Memo";case W:o=r._payload,r=r._init;try{return Q(r(o))}catch{}}return null}var ue=Array.isArray,I=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},ve=[],Te=-1;function T(r){return{current:r}}function V(r){0>Te||(r.current=ve[Te],ve[Te]=null,Te--)}function Y(r,o){Te++,ve[Te]=r.current,r.current=o}var ie=T(null),ye=T(null),Se=T(null),ze=T(null);function Jt(r,o){switch(Y(Se,o),Y(ye,r),Y(ie,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?D1(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=D1(o),r=R1(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}V(ie),Y(ie,r)}function ht(){V(ie),V(ye),V(Se)}function Xo(r){r.memoizedState!==null&&Y(ze,r);var o=ie.current,u=R1(o,r.type);o!==u&&(Y(ye,r),Y(ie,u))}function cu(r){ye.current===r&&(V(ie),V(ye)),ze.current===r&&(V(ze),Ia._currentValue=ae)}var Wd,lv;function dr(r){if(Wd===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);Wd=o&&o[1]||"",lv=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wd+r+lv}var Fd=!1;function Yd(r,o){if(!r||Fd)return"";Fd=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var K=function(){throw Error()};if(Object.defineProperty(K.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(K,[])}catch(P){var j=P}Reflect.construct(r,[],K)}else{try{K.call()}catch(P){j=P}r.call(K.prototype)}}else{try{throw Error()}catch(P){j=P}(K=r())&&typeof K.catch=="function"&&K.catch(function(){})}}catch(P){if(P&&j&&typeof P.stack=="string")return[P.stack,j.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=f.DetermineComponentFrameRoot(),S=y[0],x=y[1];if(S&&x){var A=S.split(`
`),L=x.split(`
`);for(g=f=0;f<A.length&&!A[f].includes("DetermineComponentFrameRoot");)f++;for(;g<L.length&&!L[g].includes("DetermineComponentFrameRoot");)g++;if(f===A.length||g===L.length)for(f=A.length-1,g=L.length-1;1<=f&&0<=g&&A[f]!==L[g];)g--;for(;1<=f&&0<=g;f--,g--)if(A[f]!==L[g]){if(f!==1||g!==1)do if(f--,g--,0>g||A[f]!==L[g]){var q=`
`+A[f].replace(" at new "," at ");return r.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",r.displayName)),q}while(1<=f&&0<=g);break}}}finally{Fd=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?dr(u):""}function a2(r,o){switch(r.tag){case 26:case 27:case 5:return dr(r.type);case 16:return dr("Lazy");case 13:return r.child!==o&&o!==null?dr("Suspense Fallback"):dr("Suspense");case 19:return dr("SuspenseList");case 0:case 15:return Yd(r.type,!1);case 11:return Yd(r.type.render,!1);case 1:return Yd(r.type,!0);case 31:return dr("Activity");default:return""}}function ov(r){try{var o="",u=null;do o+=a2(r,u),u=r,r=r.return;while(r);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Xd=Object.prototype.hasOwnProperty,Qd=n.unstable_scheduleCallback,Jd=n.unstable_cancelCallback,c2=n.unstable_shouldYield,u2=n.unstable_requestPaint,wn=n.unstable_now,h2=n.unstable_getCurrentPriorityLevel,av=n.unstable_ImmediatePriority,cv=n.unstable_UserBlockingPriority,uu=n.unstable_NormalPriority,f2=n.unstable_LowPriority,uv=n.unstable_IdlePriority,d2=n.log,p2=n.unstable_setDisableYieldValue,Qo=null,Sn=null;function xs(r){if(typeof d2=="function"&&p2(r),Sn&&typeof Sn.setStrictMode=="function")try{Sn.setStrictMode(Qo,r)}catch{}}var kn=Math.clz32?Math.clz32:y2,g2=Math.log,m2=Math.LN2;function y2(r){return r>>>=0,r===0?32:31-(g2(r)/m2|0)|0}var hu=256,fu=262144,du=4194304;function pr(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function pu(r,o,u){var f=r.pendingLanes;if(f===0)return 0;var g=0,y=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var x=f&134217727;return x!==0?(f=x&~y,f!==0?g=pr(f):(S&=x,S!==0?g=pr(S):u||(u=x&~r,u!==0&&(g=pr(u))))):(x=f&~y,x!==0?g=pr(x):S!==0?g=pr(S):u||(u=f&~r,u!==0&&(g=pr(u)))),g===0?0:o!==0&&o!==g&&(o&y)===0&&(y=g&-g,u=o&-o,y>=u||y===32&&(u&4194048)!==0)?o:g}function Jo(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function b2(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hv(){var r=du;return du<<=1,(du&62914560)===0&&(du=4194304),r}function Zd(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function Zo(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function v2(r,o,u,f,g,y){var S=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var x=r.entanglements,A=r.expirationTimes,L=r.hiddenUpdates;for(u=S&~u;0<u;){var q=31-kn(u),K=1<<q;x[q]=0,A[q]=-1;var j=L[q];if(j!==null)for(L[q]=null,q=0;q<j.length;q++){var P=j[q];P!==null&&(P.lane&=-536870913)}u&=~K}f!==0&&fv(r,f,0),y!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=y&~(S&~o))}function fv(r,o,u){r.pendingLanes|=o,r.suspendedLanes&=~o;var f=31-kn(o);r.entangledLanes|=o,r.entanglements[f]=r.entanglements[f]|1073741824|u&261930}function dv(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var f=31-kn(u),g=1<<f;g&o|r[f]&o&&(r[f]|=o),u&=~g}}function pv(r,o){var u=o&-o;return u=(u&42)!==0?1:ep(u),(u&(r.suspendedLanes|o))!==0?0:u}function ep(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function tp(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function gv(){var r=F.p;return r!==0?r:(r=window.event,r===void 0?32:ek(r.type))}function mv(r,o){var u=F.p;try{return F.p=r,o()}finally{F.p=u}}var _s=Math.random().toString(36).slice(2),jt="__reactFiber$"+_s,rn="__reactProps$"+_s,al="__reactContainer$"+_s,np="__reactEvents$"+_s,w2="__reactListeners$"+_s,S2="__reactHandles$"+_s,yv="__reactResources$"+_s,ea="__reactMarker$"+_s;function ip(r){delete r[jt],delete r[rn],delete r[np],delete r[w2],delete r[S2]}function cl(r){var o=r[jt];if(o)return o;for(var u=r.parentNode;u;){if(o=u[al]||u[jt]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=z1(r);r!==null;){if(u=r[jt])return u;r=z1(r)}return o}r=u,u=r.parentNode}return null}function ul(r){if(r=r[jt]||r[al]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function ta(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(i(33))}function hl(r){var o=r[yv];return o||(o=r[yv]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Dt(r){r[ea]=!0}var bv=new Set,vv={};function gr(r,o){fl(r,o),fl(r+"Capture",o)}function fl(r,o){for(vv[r]=o,r=0;r<o.length;r++)bv.add(o[r])}var k2=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wv={},Sv={};function x2(r){return Xd.call(Sv,r)?!0:Xd.call(wv,r)?!1:k2.test(r)?Sv[r]=!0:(wv[r]=!0,!1)}function gu(r,o,u){if(x2(o))if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+u)}}function mu(r,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+u)}}function Fi(r,o,u,f){if(f===null)r.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(o,u,""+f)}}function qn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function kv(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function _2(r,o,u){var f=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var g=f.get,y=f.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return g.call(this)},set:function(S){u=""+S,y.call(this,S)}}),Object.defineProperty(r,o,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(S){u=""+S},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function sp(r){if(!r._valueTracker){var o=kv(r)?"checked":"value";r._valueTracker=_2(r,o,""+r[o])}}function xv(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return r&&(f=kv(r)?r.checked?"true":"false":r.value),r=f,r!==u?(o.setValue(r),!0):!1}function yu(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var O2=/[\n"\\]/g;function Vn(r){return r.replace(O2,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function rp(r,o,u,f,g,y,S,x){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),o!=null?S==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+qn(o)):r.value!==""+qn(o)&&(r.value=""+qn(o)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),o!=null?lp(r,S,qn(o)):u!=null?lp(r,S,qn(u)):f!=null&&r.removeAttribute("value"),g==null&&y!=null&&(r.defaultChecked=!!y),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?r.name=""+qn(x):r.removeAttribute("name")}function _v(r,o,u,f,g,y,S,x){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),o!=null||u!=null){if(!(y!=="submit"&&y!=="reset"||o!=null)){sp(r);return}u=u!=null?""+qn(u):"",o=o!=null?""+qn(o):u,x||o===r.value||(r.value=o),r.defaultValue=o}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=x?r.checked:!!f,r.defaultChecked=!!f,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S),sp(r)}function lp(r,o,u){o==="number"&&yu(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function dl(r,o,u,f){if(r=r.options,o){o={};for(var g=0;g<u.length;g++)o["$"+u[g]]=!0;for(u=0;u<r.length;u++)g=o.hasOwnProperty("$"+r[u].value),r[u].selected!==g&&(r[u].selected=g),g&&f&&(r[u].defaultSelected=!0)}else{for(u=""+qn(u),o=null,g=0;g<r.length;g++){if(r[g].value===u){r[g].selected=!0,f&&(r[g].defaultSelected=!0);return}o!==null||r[g].disabled||(o=r[g])}o!==null&&(o.selected=!0)}}function Ov(r,o,u){if(o!=null&&(o=""+qn(o),o!==r.value&&(r.value=o),u==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=u!=null?""+qn(u):""}function Av(r,o,u,f){if(o==null){if(f!=null){if(u!=null)throw Error(i(92));if(ue(f)){if(1<f.length)throw Error(i(93));f=f[0]}u=f}u==null&&(u=""),o=u}u=qn(o),r.defaultValue=u,f=r.textContent,f===u&&f!==""&&f!==null&&(r.value=f),sp(r)}function pl(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var A2=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Cv(r,o,u){var f=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":f?r.setProperty(o,u):typeof u!="number"||u===0||A2.has(o)?o==="float"?r.cssFloat=u:r[o]=(""+u).trim():r[o]=u+"px"}function Tv(r,o,u){if(o!=null&&typeof o!="object")throw Error(i(62));if(r=r.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var g in o)f=o[g],o.hasOwnProperty(g)&&u[g]!==f&&Cv(r,g,f)}else for(var y in o)o.hasOwnProperty(y)&&Cv(r,y,o[y])}function op(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var C2=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),T2=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bu(r){return T2.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Yi(){}var ap=null;function cp(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var gl=null,ml=null;function Ev(r){var o=ul(r);if(o&&(r=o.stateNode)){var u=r[rn]||null;e:switch(r=o.stateNode,o.type){case"input":if(rp(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Vn(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==r&&f.form===r.form){var g=f[rn]||null;if(!g)throw Error(i(90));rp(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<u.length;o++)f=u[o],f.form===r.form&&xv(f)}break e;case"textarea":Ov(r,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&dl(r,!!u.multiple,o,!1)}}}var up=!1;function Dv(r,o,u){if(up)return r(o,u);up=!0;try{var f=r(o);return f}finally{if(up=!1,(gl!==null||ml!==null)&&(rh(),gl&&(o=gl,r=ml,ml=gl=null,Ev(o),r)))for(o=0;o<r.length;o++)Ev(r[o])}}function na(r,o){var u=r.stateNode;if(u===null)return null;var f=u[rn]||null;if(f===null)return null;u=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(i(231,o,typeof u));return u}var Xi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hp=!1;if(Xi)try{var ia={};Object.defineProperty(ia,"passive",{get:function(){hp=!0}}),window.addEventListener("test",ia,ia),window.removeEventListener("test",ia,ia)}catch{hp=!1}var Os=null,fp=null,vu=null;function Rv(){if(vu)return vu;var r,o=fp,u=o.length,f,g="value"in Os?Os.value:Os.textContent,y=g.length;for(r=0;r<u&&o[r]===g[r];r++);var S=u-r;for(f=1;f<=S&&o[u-f]===g[y-f];f++);return vu=g.slice(r,1<f?1-f:void 0)}function wu(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Su(){return!0}function Mv(){return!1}function ln(r){function o(u,f,g,y,S){this._reactName=u,this._targetInst=g,this.type=f,this.nativeEvent=y,this.target=S,this.currentTarget=null;for(var x in r)r.hasOwnProperty(x)&&(u=r[x],this[x]=u?u(y):y[x]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Su:Mv,this.isPropagationStopped=Mv,this}return m(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Su)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Su)},persist:function(){},isPersistent:Su}),o}var mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ku=ln(mr),sa=m({},mr,{view:0,detail:0}),E2=ln(sa),dp,pp,ra,xu=m({},sa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mp,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ra&&(ra&&r.type==="mousemove"?(dp=r.screenX-ra.screenX,pp=r.screenY-ra.screenY):pp=dp=0,ra=r),dp)},movementY:function(r){return"movementY"in r?r.movementY:pp}}),Nv=ln(xu),D2=m({},xu,{dataTransfer:0}),R2=ln(D2),M2=m({},sa,{relatedTarget:0}),gp=ln(M2),N2=m({},mr,{animationName:0,elapsedTime:0,pseudoElement:0}),L2=ln(N2),B2=m({},mr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),j2=ln(B2),U2=m({},mr,{data:0}),Lv=ln(U2),z2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},I2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},P2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H2(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=P2[r])?!!o[r]:!1}function mp(){return H2}var q2=m({},sa,{key:function(r){if(r.key){var o=z2[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=wu(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?I2[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mp,charCode:function(r){return r.type==="keypress"?wu(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?wu(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),V2=ln(q2),$2=m({},xu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bv=ln($2),G2=m({},sa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mp}),K2=ln(G2),W2=m({},mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),F2=ln(W2),Y2=m({},xu,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),X2=ln(Y2),Q2=m({},mr,{newState:0,oldState:0}),J2=ln(Q2),Z2=[9,13,27,32],yp=Xi&&"CompositionEvent"in window,la=null;Xi&&"documentMode"in document&&(la=document.documentMode);var eD=Xi&&"TextEvent"in window&&!la,jv=Xi&&(!yp||la&&8<la&&11>=la),Uv=" ",zv=!1;function Iv(r,o){switch(r){case"keyup":return Z2.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pv(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var yl=!1;function tD(r,o){switch(r){case"compositionend":return Pv(o);case"keypress":return o.which!==32?null:(zv=!0,Uv);case"textInput":return r=o.data,r===Uv&&zv?null:r;default:return null}}function nD(r,o){if(yl)return r==="compositionend"||!yp&&Iv(r,o)?(r=Rv(),vu=fp=Os=null,yl=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return jv&&o.locale!=="ko"?null:o.data;default:return null}}var iD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hv(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!iD[r.type]:o==="textarea"}function qv(r,o,u,f){gl?ml?ml.push(f):ml=[f]:gl=f,o=fh(o,"onChange"),0<o.length&&(u=new ku("onChange","change",null,u,f),r.push({event:u,listeners:o}))}var oa=null,aa=null;function sD(r){_1(r,0)}function _u(r){var o=ta(r);if(xv(o))return r}function Vv(r,o){if(r==="change")return o}var $v=!1;if(Xi){var bp;if(Xi){var vp="oninput"in document;if(!vp){var Gv=document.createElement("div");Gv.setAttribute("oninput","return;"),vp=typeof Gv.oninput=="function"}bp=vp}else bp=!1;$v=bp&&(!document.documentMode||9<document.documentMode)}function Kv(){oa&&(oa.detachEvent("onpropertychange",Wv),aa=oa=null)}function Wv(r){if(r.propertyName==="value"&&_u(aa)){var o=[];qv(o,aa,r,cp(r)),Dv(sD,o)}}function rD(r,o,u){r==="focusin"?(Kv(),oa=o,aa=u,oa.attachEvent("onpropertychange",Wv)):r==="focusout"&&Kv()}function lD(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return _u(aa)}function oD(r,o){if(r==="click")return _u(o)}function aD(r,o){if(r==="input"||r==="change")return _u(o)}function cD(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var xn=typeof Object.is=="function"?Object.is:cD;function ca(r,o){if(xn(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var g=u[f];if(!Xd.call(o,g)||!xn(r[g],o[g]))return!1}return!0}function Fv(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Yv(r,o){var u=Fv(r);r=0;for(var f;u;){if(u.nodeType===3){if(f=r+u.textContent.length,r<=o&&f>=o)return{node:u,offset:o-r};r=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Fv(u)}}function Xv(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?Xv(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Qv(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=yu(r.document);o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=yu(r.document)}return o}function wp(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var uD=Xi&&"documentMode"in document&&11>=document.documentMode,bl=null,Sp=null,ua=null,kp=!1;function Jv(r,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;kp||bl==null||bl!==yu(f)||(f=bl,"selectionStart"in f&&wp(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ua&&ca(ua,f)||(ua=f,f=fh(Sp,"onSelect"),0<f.length&&(o=new ku("onSelect","select",null,o,u),r.push({event:o,listeners:f}),o.target=bl)))}function yr(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var vl={animationend:yr("Animation","AnimationEnd"),animationiteration:yr("Animation","AnimationIteration"),animationstart:yr("Animation","AnimationStart"),transitionrun:yr("Transition","TransitionRun"),transitionstart:yr("Transition","TransitionStart"),transitioncancel:yr("Transition","TransitionCancel"),transitionend:yr("Transition","TransitionEnd")},xp={},Zv={};Xi&&(Zv=document.createElement("div").style,"AnimationEvent"in window||(delete vl.animationend.animation,delete vl.animationiteration.animation,delete vl.animationstart.animation),"TransitionEvent"in window||delete vl.transitionend.transition);function br(r){if(xp[r])return xp[r];if(!vl[r])return r;var o=vl[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in Zv)return xp[r]=o[u];return r}var ew=br("animationend"),tw=br("animationiteration"),nw=br("animationstart"),hD=br("transitionrun"),fD=br("transitionstart"),dD=br("transitioncancel"),iw=br("transitionend"),sw=new Map,_p="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");_p.push("scrollEnd");function oi(r,o){sw.set(r,o),gr(o,[r])}var Ou=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},$n=[],wl=0,Op=0;function Au(){for(var r=wl,o=Op=wl=0;o<r;){var u=$n[o];$n[o++]=null;var f=$n[o];$n[o++]=null;var g=$n[o];$n[o++]=null;var y=$n[o];if($n[o++]=null,f!==null&&g!==null){var S=f.pending;S===null?g.next=g:(g.next=S.next,S.next=g),f.pending=g}y!==0&&rw(u,g,y)}}function Cu(r,o,u,f){$n[wl++]=r,$n[wl++]=o,$n[wl++]=u,$n[wl++]=f,Op|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function Ap(r,o,u,f){return Cu(r,o,u,f),Tu(r)}function vr(r,o){return Cu(r,null,null,o),Tu(r)}function rw(r,o,u){r.lanes|=u;var f=r.alternate;f!==null&&(f.lanes|=u);for(var g=!1,y=r.return;y!==null;)y.childLanes|=u,f=y.alternate,f!==null&&(f.childLanes|=u),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(g=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,g&&o!==null&&(g=31-kn(u),r=y.hiddenUpdates,f=r[g],f===null?r[g]=[o]:f.push(o),o.lane=u|536870912),y):null}function Tu(r){if(50<Ma)throw Ma=0,Bg=null,Error(i(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var Sl={};function pD(r,o,u,f){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _n(r,o,u,f){return new pD(r,o,u,f)}function Cp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Qi(r,o){var u=r.alternate;return u===null?(u=_n(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function lw(r,o){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,o=u.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function Eu(r,o,u,f,g,y){var S=0;if(f=r,typeof r=="function")Cp(r)&&(S=1);else if(typeof r=="string")S=vR(r,u,ie.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case ne:return r=_n(31,u,o,g),r.elementType=ne,r.lanes=y,r;case k:return wr(u.children,g,y,o);case _:S=8,g|=24;break;case O:return r=_n(12,u,o,g|2),r.elementType=O,r.lanes=y,r;case B:return r=_n(13,u,o,g),r.elementType=B,r.lanes=y,r;case z:return r=_n(19,u,o,g),r.elementType=z,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case C:S=10;break e;case R:S=9;break e;case U:S=11;break e;case D:S=14;break e;case W:S=16,f=null;break e}S=29,u=Error(i(130,r===null?"null":typeof r,"")),f=null}return o=_n(S,u,o,g),o.elementType=r,o.type=f,o.lanes=y,o}function wr(r,o,u,f){return r=_n(7,r,f,o),r.lanes=u,r}function Tp(r,o,u){return r=_n(6,r,null,o),r.lanes=u,r}function ow(r){var o=_n(18,null,null,0);return o.stateNode=r,o}function Ep(r,o,u){return o=_n(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var aw=new WeakMap;function Gn(r,o){if(typeof r=="object"&&r!==null){var u=aw.get(r);return u!==void 0?u:(o={value:r,source:o,stack:ov(o)},aw.set(r,o),o)}return{value:r,source:o,stack:ov(o)}}var kl=[],xl=0,Du=null,ha=0,Kn=[],Wn=0,As=null,_i=1,Oi="";function Ji(r,o){kl[xl++]=ha,kl[xl++]=Du,Du=r,ha=o}function cw(r,o,u){Kn[Wn++]=_i,Kn[Wn++]=Oi,Kn[Wn++]=As,As=r;var f=_i;r=Oi;var g=32-kn(f)-1;f&=~(1<<g),u+=1;var y=32-kn(o)+g;if(30<y){var S=g-g%5;y=(f&(1<<S)-1).toString(32),f>>=S,g-=S,_i=1<<32-kn(o)+g|u<<g|f,Oi=y+r}else _i=1<<y|u<<g|f,Oi=r}function Dp(r){r.return!==null&&(Ji(r,1),cw(r,1,0))}function Rp(r){for(;r===Du;)Du=kl[--xl],kl[xl]=null,ha=kl[--xl],kl[xl]=null;for(;r===As;)As=Kn[--Wn],Kn[Wn]=null,Oi=Kn[--Wn],Kn[Wn]=null,_i=Kn[--Wn],Kn[Wn]=null}function uw(r,o){Kn[Wn++]=_i,Kn[Wn++]=Oi,Kn[Wn++]=As,_i=o.id,Oi=o.overflow,As=r}var Ut=null,nt=null,je=!1,Cs=null,Fn=!1,Mp=Error(i(519));function Ts(r){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw fa(Gn(o,r)),Mp}function hw(r){var o=r.stateNode,u=r.type,f=r.memoizedProps;switch(o[jt]=r,o[rn]=f,u){case"dialog":Ne("cancel",o),Ne("close",o);break;case"iframe":case"object":case"embed":Ne("load",o);break;case"video":case"audio":for(u=0;u<La.length;u++)Ne(La[u],o);break;case"source":Ne("error",o);break;case"img":case"image":case"link":Ne("error",o),Ne("load",o);break;case"details":Ne("toggle",o);break;case"input":Ne("invalid",o),_v(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ne("invalid",o);break;case"textarea":Ne("invalid",o),Av(o,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||f.suppressHydrationWarning===!0||T1(o.textContent,u)?(f.popover!=null&&(Ne("beforetoggle",o),Ne("toggle",o)),f.onScroll!=null&&Ne("scroll",o),f.onScrollEnd!=null&&Ne("scrollend",o),f.onClick!=null&&(o.onclick=Yi),o=!0):o=!1,o||Ts(r,!0)}function fw(r){for(Ut=r.return;Ut;)switch(Ut.tag){case 5:case 31:case 13:Fn=!1;return;case 27:case 3:Fn=!0;return;default:Ut=Ut.return}}function _l(r){if(r!==Ut)return!1;if(!je)return fw(r),je=!0,!1;var o=r.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||Xg(r.type,r.memoizedProps)),u=!u),u&&nt&&Ts(r),fw(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));nt=U1(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));nt=U1(r)}else o===27?(o=nt,qs(r.type)?(r=tm,tm=null,nt=r):nt=o):nt=Ut?Xn(r.stateNode.nextSibling):null;return!0}function Sr(){nt=Ut=null,je=!1}function Np(){var r=Cs;return r!==null&&(un===null?un=r:un.push.apply(un,r),Cs=null),r}function fa(r){Cs===null?Cs=[r]:Cs.push(r)}var Lp=T(null),kr=null,Zi=null;function Es(r,o,u){Y(Lp,o._currentValue),o._currentValue=u}function es(r){r._currentValue=Lp.current,V(Lp)}function Bp(r,o,u){for(;r!==null;){var f=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),r===u)break;r=r.return}}function jp(r,o,u,f){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var y=g.dependencies;if(y!==null){var S=g.child;y=y.firstContext;e:for(;y!==null;){var x=y;y=g;for(var A=0;A<o.length;A++)if(x.context===o[A]){y.lanes|=u,x=y.alternate,x!==null&&(x.lanes|=u),Bp(y.return,u,r),f||(S=null);break e}y=x.next}}else if(g.tag===18){if(S=g.return,S===null)throw Error(i(341));S.lanes|=u,y=S.alternate,y!==null&&(y.lanes|=u),Bp(S,u,r),S=null}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===r){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}}function Ol(r,o,u,f){r=null;for(var g=o,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var S=g.alternate;if(S===null)throw Error(i(387));if(S=S.memoizedProps,S!==null){var x=g.type;xn(g.pendingProps.value,S.value)||(r!==null?r.push(x):r=[x])}}else if(g===ze.current){if(S=g.alternate,S===null)throw Error(i(387));S.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(Ia):r=[Ia])}g=g.return}r!==null&&jp(o,r,u,f),o.flags|=262144}function Ru(r){for(r=r.firstContext;r!==null;){if(!xn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function xr(r){kr=r,Zi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function zt(r){return dw(kr,r)}function Mu(r,o){return kr===null&&xr(r),dw(r,o)}function dw(r,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Zi===null){if(r===null)throw Error(i(308));Zi=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else Zi=Zi.next=o;return u}var gD=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(u,f){r.push(f)}};this.abort=function(){o.aborted=!0,r.forEach(function(u){return u()})}},mD=n.unstable_scheduleCallback,yD=n.unstable_NormalPriority,yt={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Up(){return{controller:new gD,data:new Map,refCount:0}}function da(r){r.refCount--,r.refCount===0&&mD(yD,function(){r.controller.abort()})}var pa=null,zp=0,Al=0,Cl=null;function bD(r,o){if(pa===null){var u=pa=[];zp=0,Al=Hg(),Cl={status:"pending",value:void 0,then:function(f){u.push(f)}}}return zp++,o.then(pw,pw),o}function pw(){if(--zp===0&&pa!==null){Cl!==null&&(Cl.status="fulfilled");var r=pa;pa=null,Al=0,Cl=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function vD(r,o){var u=[],f={status:"pending",value:null,reason:null,then:function(g){u.push(g)}};return r.then(function(){f.status="fulfilled",f.value=o;for(var g=0;g<u.length;g++)(0,u[g])(o)},function(g){for(f.status="rejected",f.reason=g,g=0;g<u.length;g++)(0,u[g])(void 0)}),f}var gw=I.S;I.S=function(r,o){JS=wn(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&bD(r,o),gw!==null&&gw(r,o)};var _r=T(null);function Ip(){var r=_r.current;return r!==null?r:Ye.pooledCache}function Nu(r,o){o===null?Y(_r,_r.current):Y(_r,o.pool)}function mw(){var r=Ip();return r===null?null:{parent:yt._currentValue,pool:r}}var Tl=Error(i(460)),Pp=Error(i(474)),Lu=Error(i(542)),Bu={then:function(){}};function yw(r){return r=r.status,r==="fulfilled"||r==="rejected"}function bw(r,o,u){switch(u=r[u],u===void 0?r.push(o):u!==o&&(o.then(Yi,Yi),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,ww(r),r;default:if(typeof o.status=="string")o.then(Yi,Yi);else{if(r=Ye,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=o,r.status="pending",r.then(function(f){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=f}},function(f){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,ww(r),r}throw Ar=o,Tl}}function Or(r){try{var o=r._init;return o(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Ar=u,Tl):u}}var Ar=null;function vw(){if(Ar===null)throw Error(i(459));var r=Ar;return Ar=null,r}function ww(r){if(r===Tl||r===Lu)throw Error(i(483))}var El=null,ga=0;function ju(r){var o=ga;return ga+=1,El===null&&(El=[]),bw(El,r,o)}function ma(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Uu(r,o){throw o.$$typeof===b?Error(i(525)):(r=Object.prototype.toString.call(o),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function Sw(r){function o(M,E){if(r){var N=M.deletions;N===null?(M.deletions=[E],M.flags|=16):N.push(E)}}function u(M,E){if(!r)return null;for(;E!==null;)o(M,E),E=E.sibling;return null}function f(M){for(var E=new Map;M!==null;)M.key!==null?E.set(M.key,M):E.set(M.index,M),M=M.sibling;return E}function g(M,E){return M=Qi(M,E),M.index=0,M.sibling=null,M}function y(M,E,N){return M.index=N,r?(N=M.alternate,N!==null?(N=N.index,N<E?(M.flags|=67108866,E):N):(M.flags|=67108866,E)):(M.flags|=1048576,E)}function S(M){return r&&M.alternate===null&&(M.flags|=67108866),M}function x(M,E,N,$){return E===null||E.tag!==6?(E=Tp(N,M.mode,$),E.return=M,E):(E=g(E,N),E.return=M,E)}function A(M,E,N,$){var fe=N.type;return fe===k?q(M,E,N.props.children,$,N.key):E!==null&&(E.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===W&&Or(fe)===E.type)?(E=g(E,N.props),ma(E,N),E.return=M,E):(E=Eu(N.type,N.key,N.props,null,M.mode,$),ma(E,N),E.return=M,E)}function L(M,E,N,$){return E===null||E.tag!==4||E.stateNode.containerInfo!==N.containerInfo||E.stateNode.implementation!==N.implementation?(E=Ep(N,M.mode,$),E.return=M,E):(E=g(E,N.children||[]),E.return=M,E)}function q(M,E,N,$,fe){return E===null||E.tag!==7?(E=wr(N,M.mode,$,fe),E.return=M,E):(E=g(E,N),E.return=M,E)}function K(M,E,N){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return E=Tp(""+E,M.mode,N),E.return=M,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case v:return N=Eu(E.type,E.key,E.props,null,M.mode,N),ma(N,E),N.return=M,N;case w:return E=Ep(E,M.mode,N),E.return=M,E;case W:return E=Or(E),K(M,E,N)}if(ue(E)||J(E))return E=wr(E,M.mode,N,null),E.return=M,E;if(typeof E.then=="function")return K(M,ju(E),N);if(E.$$typeof===C)return K(M,Mu(M,E),N);Uu(M,E)}return null}function j(M,E,N,$){var fe=E!==null?E.key:null;if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return fe!==null?null:x(M,E,""+N,$);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case v:return N.key===fe?A(M,E,N,$):null;case w:return N.key===fe?L(M,E,N,$):null;case W:return N=Or(N),j(M,E,N,$)}if(ue(N)||J(N))return fe!==null?null:q(M,E,N,$,null);if(typeof N.then=="function")return j(M,E,ju(N),$);if(N.$$typeof===C)return j(M,E,Mu(M,N),$);Uu(M,N)}return null}function P(M,E,N,$,fe){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return M=M.get(N)||null,x(E,M,""+$,fe);if(typeof $=="object"&&$!==null){switch($.$$typeof){case v:return M=M.get($.key===null?N:$.key)||null,A(E,M,$,fe);case w:return M=M.get($.key===null?N:$.key)||null,L(E,M,$,fe);case W:return $=Or($),P(M,E,N,$,fe)}if(ue($)||J($))return M=M.get(N)||null,q(E,M,$,fe,null);if(typeof $.then=="function")return P(M,E,N,ju($),fe);if($.$$typeof===C)return P(M,E,N,Mu(E,$),fe);Uu(E,$)}return null}function re(M,E,N,$){for(var fe=null,Ie=null,le=E,Oe=E=0,Be=null;le!==null&&Oe<N.length;Oe++){le.index>Oe?(Be=le,le=null):Be=le.sibling;var Pe=j(M,le,N[Oe],$);if(Pe===null){le===null&&(le=Be);break}r&&le&&Pe.alternate===null&&o(M,le),E=y(Pe,E,Oe),Ie===null?fe=Pe:Ie.sibling=Pe,Ie=Pe,le=Be}if(Oe===N.length)return u(M,le),je&&Ji(M,Oe),fe;if(le===null){for(;Oe<N.length;Oe++)le=K(M,N[Oe],$),le!==null&&(E=y(le,E,Oe),Ie===null?fe=le:Ie.sibling=le,Ie=le);return je&&Ji(M,Oe),fe}for(le=f(le);Oe<N.length;Oe++)Be=P(le,M,Oe,N[Oe],$),Be!==null&&(r&&Be.alternate!==null&&le.delete(Be.key===null?Oe:Be.key),E=y(Be,E,Oe),Ie===null?fe=Be:Ie.sibling=Be,Ie=Be);return r&&le.forEach(function(Ws){return o(M,Ws)}),je&&Ji(M,Oe),fe}function ge(M,E,N,$){if(N==null)throw Error(i(151));for(var fe=null,Ie=null,le=E,Oe=E=0,Be=null,Pe=N.next();le!==null&&!Pe.done;Oe++,Pe=N.next()){le.index>Oe?(Be=le,le=null):Be=le.sibling;var Ws=j(M,le,Pe.value,$);if(Ws===null){le===null&&(le=Be);break}r&&le&&Ws.alternate===null&&o(M,le),E=y(Ws,E,Oe),Ie===null?fe=Ws:Ie.sibling=Ws,Ie=Ws,le=Be}if(Pe.done)return u(M,le),je&&Ji(M,Oe),fe;if(le===null){for(;!Pe.done;Oe++,Pe=N.next())Pe=K(M,Pe.value,$),Pe!==null&&(E=y(Pe,E,Oe),Ie===null?fe=Pe:Ie.sibling=Pe,Ie=Pe);return je&&Ji(M,Oe),fe}for(le=f(le);!Pe.done;Oe++,Pe=N.next())Pe=P(le,M,Oe,Pe.value,$),Pe!==null&&(r&&Pe.alternate!==null&&le.delete(Pe.key===null?Oe:Pe.key),E=y(Pe,E,Oe),Ie===null?fe=Pe:Ie.sibling=Pe,Ie=Pe);return r&&le.forEach(function(DR){return o(M,DR)}),je&&Ji(M,Oe),fe}function We(M,E,N,$){if(typeof N=="object"&&N!==null&&N.type===k&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case v:e:{for(var fe=N.key;E!==null;){if(E.key===fe){if(fe=N.type,fe===k){if(E.tag===7){u(M,E.sibling),$=g(E,N.props.children),$.return=M,M=$;break e}}else if(E.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===W&&Or(fe)===E.type){u(M,E.sibling),$=g(E,N.props),ma($,N),$.return=M,M=$;break e}u(M,E);break}else o(M,E);E=E.sibling}N.type===k?($=wr(N.props.children,M.mode,$,N.key),$.return=M,M=$):($=Eu(N.type,N.key,N.props,null,M.mode,$),ma($,N),$.return=M,M=$)}return S(M);case w:e:{for(fe=N.key;E!==null;){if(E.key===fe)if(E.tag===4&&E.stateNode.containerInfo===N.containerInfo&&E.stateNode.implementation===N.implementation){u(M,E.sibling),$=g(E,N.children||[]),$.return=M,M=$;break e}else{u(M,E);break}else o(M,E);E=E.sibling}$=Ep(N,M.mode,$),$.return=M,M=$}return S(M);case W:return N=Or(N),We(M,E,N,$)}if(ue(N))return re(M,E,N,$);if(J(N)){if(fe=J(N),typeof fe!="function")throw Error(i(150));return N=fe.call(N),ge(M,E,N,$)}if(typeof N.then=="function")return We(M,E,ju(N),$);if(N.$$typeof===C)return We(M,E,Mu(M,N),$);Uu(M,N)}return typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint"?(N=""+N,E!==null&&E.tag===6?(u(M,E.sibling),$=g(E,N),$.return=M,M=$):(u(M,E),$=Tp(N,M.mode,$),$.return=M,M=$),S(M)):u(M,E)}return function(M,E,N,$){try{ga=0;var fe=We(M,E,N,$);return El=null,fe}catch(le){if(le===Tl||le===Lu)throw le;var Ie=_n(29,le,null,M.mode);return Ie.lanes=$,Ie.return=M,Ie}}}var Cr=Sw(!0),kw=Sw(!1),Ds=!1;function Hp(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qp(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Rs(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ms(r,o,u){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(qe&2)!==0){var g=f.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),f.pending=o,o=Tu(r),rw(r,null,u),o}return Cu(r,f,o,u),Tu(r)}function ya(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,dv(r,u)}}function Vp(r,o){var u=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var g=null,y=null;if(u=u.firstBaseUpdate,u!==null){do{var S={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};y===null?g=y=S:y=y.next=S,u=u.next}while(u!==null);y===null?g=y=o:y=y.next=o}else g=y=o;u={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:f.shared,callbacks:f.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}var $p=!1;function ba(){if($p){var r=Cl;if(r!==null)throw r}}function va(r,o,u,f){$p=!1;var g=r.updateQueue;Ds=!1;var y=g.firstBaseUpdate,S=g.lastBaseUpdate,x=g.shared.pending;if(x!==null){g.shared.pending=null;var A=x,L=A.next;A.next=null,S===null?y=L:S.next=L,S=A;var q=r.alternate;q!==null&&(q=q.updateQueue,x=q.lastBaseUpdate,x!==S&&(x===null?q.firstBaseUpdate=L:x.next=L,q.lastBaseUpdate=A))}if(y!==null){var K=g.baseState;S=0,q=L=A=null,x=y;do{var j=x.lane&-536870913,P=j!==x.lane;if(P?(Le&j)===j:(f&j)===j){j!==0&&j===Al&&($p=!0),q!==null&&(q=q.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var re=r,ge=x;j=o;var We=u;switch(ge.tag){case 1:if(re=ge.payload,typeof re=="function"){K=re.call(We,K,j);break e}K=re;break e;case 3:re.flags=re.flags&-65537|128;case 0:if(re=ge.payload,j=typeof re=="function"?re.call(We,K,j):re,j==null)break e;K=m({},K,j);break e;case 2:Ds=!0}}j=x.callback,j!==null&&(r.flags|=64,P&&(r.flags|=8192),P=g.callbacks,P===null?g.callbacks=[j]:P.push(j))}else P={lane:j,tag:x.tag,payload:x.payload,callback:x.callback,next:null},q===null?(L=q=P,A=K):q=q.next=P,S|=j;if(x=x.next,x===null){if(x=g.shared.pending,x===null)break;P=x,x=P.next,P.next=null,g.lastBaseUpdate=P,g.shared.pending=null}}while(!0);q===null&&(A=K),g.baseState=A,g.firstBaseUpdate=L,g.lastBaseUpdate=q,y===null&&(g.shared.lanes=0),Us|=S,r.lanes=S,r.memoizedState=K}}function xw(r,o){if(typeof r!="function")throw Error(i(191,r));r.call(o)}function _w(r,o){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)xw(u[r],o)}var Dl=T(null),zu=T(0);function Ow(r,o){r=cs,Y(zu,r),Y(Dl,o),cs=r|o.baseLanes}function Gp(){Y(zu,cs),Y(Dl,Dl.current)}function Kp(){cs=zu.current,V(Dl),V(zu)}var On=T(null),Yn=null;function Ns(r){var o=r.alternate;Y(ft,ft.current&1),Y(On,r),Yn===null&&(o===null||Dl.current!==null||o.memoizedState!==null)&&(Yn=r)}function Wp(r){Y(ft,ft.current),Y(On,r),Yn===null&&(Yn=r)}function Aw(r){r.tag===22?(Y(ft,ft.current),Y(On,r),Yn===null&&(Yn=r)):Ls()}function Ls(){Y(ft,ft.current),Y(On,On.current)}function An(r){V(On),Yn===r&&(Yn=null),V(ft)}var ft=T(0);function Iu(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||Zg(u)||em(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var ts=0,ke=null,Ge=null,bt=null,Pu=!1,Rl=!1,Tr=!1,Hu=0,wa=0,Ml=null,wD=0;function ot(){throw Error(i(321))}function Fp(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!xn(r[u],o[u]))return!1;return!0}function Yp(r,o,u,f,g,y){return ts=y,ke=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,I.H=r===null||r.memoizedState===null?cS:ug,Tr=!1,y=u(f,g),Tr=!1,Rl&&(y=Tw(o,u,f,g)),Cw(r),y}function Cw(r){I.H=xa;var o=Ge!==null&&Ge.next!==null;if(ts=0,bt=Ge=ke=null,Pu=!1,wa=0,Ml=null,o)throw Error(i(300));r===null||vt||(r=r.dependencies,r!==null&&Ru(r)&&(vt=!0))}function Tw(r,o,u,f){ke=r;var g=0;do{if(Rl&&(Ml=null),wa=0,Rl=!1,25<=g)throw Error(i(301));if(g+=1,bt=Ge=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}I.H=uS,y=o(u,f)}while(Rl);return y}function SD(){var r=I.H,o=r.useState()[0];return o=typeof o.then=="function"?Sa(o):o,r=r.useState()[0],(Ge!==null?Ge.memoizedState:null)!==r&&(ke.flags|=1024),o}function Xp(){var r=Hu!==0;return Hu=0,r}function Qp(r,o,u){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~u}function Jp(r){if(Pu){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Pu=!1}ts=0,bt=Ge=ke=null,Rl=!1,wa=Hu=0,Ml=null}function Zt(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?ke.memoizedState=bt=r:bt=bt.next=r,bt}function dt(){if(Ge===null){var r=ke.alternate;r=r!==null?r.memoizedState:null}else r=Ge.next;var o=bt===null?ke.memoizedState:bt.next;if(o!==null)bt=o,Ge=r;else{if(r===null)throw ke.alternate===null?Error(i(467)):Error(i(310));Ge=r,r={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},bt===null?ke.memoizedState=bt=r:bt=bt.next=r}return bt}function qu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Sa(r){var o=wa;return wa+=1,Ml===null&&(Ml=[]),r=bw(Ml,r,o),o=ke,(bt===null?o.memoizedState:bt.next)===null&&(o=o.alternate,I.H=o===null||o.memoizedState===null?cS:ug),r}function Vu(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Sa(r);if(r.$$typeof===C)return zt(r)}throw Error(i(438,String(r)))}function Zp(r){var o=null,u=ke.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var f=ke.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=qu(),ke.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(r),f=0;f<r;f++)u[f]=Ce;return o.index++,u}function ns(r,o){return typeof o=="function"?o(r):o}function $u(r){var o=dt();return eg(o,Ge,r)}function eg(r,o,u){var f=r.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=u;var g=r.baseQueue,y=f.pending;if(y!==null){if(g!==null){var S=g.next;g.next=y.next,y.next=S}o.baseQueue=g=y,f.pending=null}if(y=r.baseState,g===null)r.memoizedState=y;else{o=g.next;var x=S=null,A=null,L=o,q=!1;do{var K=L.lane&-536870913;if(K!==L.lane?(Le&K)===K:(ts&K)===K){var j=L.revertLane;if(j===0)A!==null&&(A=A.next={lane:0,revertLane:0,gesture:null,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),K===Al&&(q=!0);else if((ts&j)===j){L=L.next,j===Al&&(q=!0);continue}else K={lane:0,revertLane:L.revertLane,gesture:null,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},A===null?(x=A=K,S=y):A=A.next=K,ke.lanes|=j,Us|=j;K=L.action,Tr&&u(y,K),y=L.hasEagerState?L.eagerState:u(y,K)}else j={lane:K,revertLane:L.revertLane,gesture:L.gesture,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null},A===null?(x=A=j,S=y):A=A.next=j,ke.lanes|=K,Us|=K;L=L.next}while(L!==null&&L!==o);if(A===null?S=y:A.next=x,!xn(y,r.memoizedState)&&(vt=!0,q&&(u=Cl,u!==null)))throw u;r.memoizedState=y,r.baseState=S,r.baseQueue=A,f.lastRenderedState=y}return g===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function tg(r){var o=dt(),u=o.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=r;var f=u.dispatch,g=u.pending,y=o.memoizedState;if(g!==null){u.pending=null;var S=g=g.next;do y=r(y,S.action),S=S.next;while(S!==g);xn(y,o.memoizedState)||(vt=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),u.lastRenderedState=y}return[y,f]}function Ew(r,o,u){var f=ke,g=dt(),y=je;if(y){if(u===void 0)throw Error(i(407));u=u()}else u=o();var S=!xn((Ge||g).memoizedState,u);if(S&&(g.memoizedState=u,vt=!0),g=g.queue,sg(Mw.bind(null,f,g,r),[r]),g.getSnapshot!==o||S||bt!==null&&bt.memoizedState.tag&1){if(f.flags|=2048,Nl(9,{destroy:void 0},Rw.bind(null,f,g,u,o),null),Ye===null)throw Error(i(349));y||(ts&127)!==0||Dw(f,o,u)}return u}function Dw(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=ke.updateQueue,o===null?(o=qu(),ke.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function Rw(r,o,u,f){o.value=u,o.getSnapshot=f,Nw(o)&&Lw(r)}function Mw(r,o,u){return u(function(){Nw(o)&&Lw(r)})}function Nw(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!xn(r,u)}catch{return!0}}function Lw(r){var o=vr(r,2);o!==null&&hn(o,r,2)}function ng(r){var o=Zt();if(typeof r=="function"){var u=r;if(r=u(),Tr){xs(!0);try{u()}finally{xs(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:r},o}function Bw(r,o,u,f){return r.baseState=u,eg(r,Ge,typeof f=="function"?f:ns)}function kD(r,o,u,f,g){if(Wu(r))throw Error(i(485));if(r=o.action,r!==null){var y={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){y.listeners.push(S)}};I.T!==null?u(!0):y.isTransition=!1,f(y),u=o.pending,u===null?(y.next=o.pending=y,jw(o,y)):(y.next=u.next,o.pending=u.next=y)}}function jw(r,o){var u=o.action,f=o.payload,g=r.state;if(o.isTransition){var y=I.T,S={};I.T=S;try{var x=u(g,f),A=I.S;A!==null&&A(S,x),Uw(r,o,x)}catch(L){ig(r,o,L)}finally{y!==null&&S.types!==null&&(y.types=S.types),I.T=y}}else try{y=u(g,f),Uw(r,o,y)}catch(L){ig(r,o,L)}}function Uw(r,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){zw(r,o,f)},function(f){return ig(r,o,f)}):zw(r,o,u)}function zw(r,o,u){o.status="fulfilled",o.value=u,Iw(o),r.state=u,o=r.pending,o!==null&&(u=o.next,u===o?r.pending=null:(u=u.next,o.next=u,jw(r,u)))}function ig(r,o,u){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=u,Iw(o),o=o.next;while(o!==f)}r.action=null}function Iw(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function Pw(r,o){return o}function Hw(r,o){if(je){var u=Ye.formState;if(u!==null){e:{var f=ke;if(je){if(nt){t:{for(var g=nt,y=Fn;g.nodeType!==8;){if(!y){g=null;break t}if(g=Xn(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){nt=Xn(g.nextSibling),f=g.data==="F!";break e}}Ts(f)}f=!1}f&&(o=u[0])}}return u=Zt(),u.memoizedState=u.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pw,lastRenderedState:o},u.queue=f,u=lS.bind(null,ke,f),f.dispatch=u,f=ng(!1),y=cg.bind(null,ke,!1,f.queue),f=Zt(),g={state:o,dispatch:null,action:r,pending:null},f.queue=g,u=kD.bind(null,ke,g,y,u),g.dispatch=u,f.memoizedState=r,[o,u,!1]}function qw(r){var o=dt();return Vw(o,Ge,r)}function Vw(r,o,u){if(o=eg(r,o,Pw)[0],r=$u(ns)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=Sa(o)}catch(S){throw S===Tl?Lu:S}else f=o;o=dt();var g=o.queue,y=g.dispatch;return u!==o.memoizedState&&(ke.flags|=2048,Nl(9,{destroy:void 0},xD.bind(null,g,u),null)),[f,y,r]}function xD(r,o){r.action=o}function $w(r){var o=dt(),u=Ge;if(u!==null)return Vw(o,u,r);dt(),o=o.memoizedState,u=dt();var f=u.queue.dispatch;return u.memoizedState=r,[o,f,!1]}function Nl(r,o,u,f){return r={tag:r,create:u,deps:f,inst:o,next:null},o=ke.updateQueue,o===null&&(o=qu(),ke.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=r.next=r:(f=u.next,u.next=r,r.next=f,o.lastEffect=r),r}function Gw(){return dt().memoizedState}function Gu(r,o,u,f){var g=Zt();ke.flags|=r,g.memoizedState=Nl(1|o,{destroy:void 0},u,f===void 0?null:f)}function Ku(r,o,u,f){var g=dt();f=f===void 0?null:f;var y=g.memoizedState.inst;Ge!==null&&f!==null&&Fp(f,Ge.memoizedState.deps)?g.memoizedState=Nl(o,y,u,f):(ke.flags|=r,g.memoizedState=Nl(1|o,y,u,f))}function Kw(r,o){Gu(8390656,8,r,o)}function sg(r,o){Ku(2048,8,r,o)}function _D(r){ke.flags|=4;var o=ke.updateQueue;if(o===null)o=qu(),ke.updateQueue=o,o.events=[r];else{var u=o.events;u===null?o.events=[r]:u.push(r)}}function Ww(r){var o=dt().memoizedState;return _D({ref:o,nextImpl:r}),function(){if((qe&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function Fw(r,o){return Ku(4,2,r,o)}function Yw(r,o){return Ku(4,4,r,o)}function Xw(r,o){if(typeof o=="function"){r=r();var u=o(r);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Qw(r,o,u){u=u!=null?u.concat([r]):null,Ku(4,4,Xw.bind(null,o,r),u)}function rg(){}function Jw(r,o){var u=dt();o=o===void 0?null:o;var f=u.memoizedState;return o!==null&&Fp(o,f[1])?f[0]:(u.memoizedState=[r,o],r)}function Zw(r,o){var u=dt();o=o===void 0?null:o;var f=u.memoizedState;if(o!==null&&Fp(o,f[1]))return f[0];if(f=r(),Tr){xs(!0);try{r()}finally{xs(!1)}}return u.memoizedState=[f,o],f}function lg(r,o,u){return u===void 0||(ts&1073741824)!==0&&(Le&261930)===0?r.memoizedState=o:(r.memoizedState=u,r=e1(),ke.lanes|=r,Us|=r,u)}function eS(r,o,u,f){return xn(u,o)?u:Dl.current!==null?(r=lg(r,u,f),xn(r,o)||(vt=!0),r):(ts&42)===0||(ts&1073741824)!==0&&(Le&261930)===0?(vt=!0,r.memoizedState=u):(r=e1(),ke.lanes|=r,Us|=r,o)}function tS(r,o,u,f,g){var y=F.p;F.p=y!==0&&8>y?y:8;var S=I.T,x={};I.T=x,cg(r,!1,o,u);try{var A=g(),L=I.S;if(L!==null&&L(x,A),A!==null&&typeof A=="object"&&typeof A.then=="function"){var q=vD(A,f);ka(r,o,q,En(r))}else ka(r,o,f,En(r))}catch(K){ka(r,o,{then:function(){},status:"rejected",reason:K},En())}finally{F.p=y,S!==null&&x.types!==null&&(S.types=x.types),I.T=S}}function OD(){}function og(r,o,u,f){if(r.tag!==5)throw Error(i(476));var g=nS(r).queue;tS(r,g,o,ae,u===null?OD:function(){return iS(r),u(f)})}function nS(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:ae},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:u},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function iS(r){var o=nS(r);o.next===null&&(o=r.alternate.memoizedState),ka(r,o.next.queue,{},En())}function ag(){return zt(Ia)}function sS(){return dt().memoizedState}function rS(){return dt().memoizedState}function AD(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var u=En();r=Rs(u);var f=Ms(o,r,u);f!==null&&(hn(f,o,u),ya(f,o,u)),o={cache:Up()},r.payload=o;return}o=o.return}}function CD(r,o,u){var f=En();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Wu(r)?oS(o,u):(u=Ap(r,o,u,f),u!==null&&(hn(u,r,f),aS(u,o,f)))}function lS(r,o,u){var f=En();ka(r,o,u,f)}function ka(r,o,u,f){var g={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Wu(r))oS(o,g);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var S=o.lastRenderedState,x=y(S,u);if(g.hasEagerState=!0,g.eagerState=x,xn(x,S))return Cu(r,o,g,0),Ye===null&&Au(),!1}catch{}if(u=Ap(r,o,g,f),u!==null)return hn(u,r,f),aS(u,o,f),!0}return!1}function cg(r,o,u,f){if(f={lane:2,revertLane:Hg(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Wu(r)){if(o)throw Error(i(479))}else o=Ap(r,u,f,2),o!==null&&hn(o,r,2)}function Wu(r){var o=r.alternate;return r===ke||o!==null&&o===ke}function oS(r,o){Rl=Pu=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function aS(r,o,u){if((u&4194048)!==0){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,dv(r,u)}}var xa={readContext:zt,use:Vu,useCallback:ot,useContext:ot,useEffect:ot,useImperativeHandle:ot,useLayoutEffect:ot,useInsertionEffect:ot,useMemo:ot,useReducer:ot,useRef:ot,useState:ot,useDebugValue:ot,useDeferredValue:ot,useTransition:ot,useSyncExternalStore:ot,useId:ot,useHostTransitionStatus:ot,useFormState:ot,useActionState:ot,useOptimistic:ot,useMemoCache:ot,useCacheRefresh:ot};xa.useEffectEvent=ot;var cS={readContext:zt,use:Vu,useCallback:function(r,o){return Zt().memoizedState=[r,o===void 0?null:o],r},useContext:zt,useEffect:Kw,useImperativeHandle:function(r,o,u){u=u!=null?u.concat([r]):null,Gu(4194308,4,Xw.bind(null,o,r),u)},useLayoutEffect:function(r,o){return Gu(4194308,4,r,o)},useInsertionEffect:function(r,o){Gu(4,2,r,o)},useMemo:function(r,o){var u=Zt();o=o===void 0?null:o;var f=r();if(Tr){xs(!0);try{r()}finally{xs(!1)}}return u.memoizedState=[f,o],f},useReducer:function(r,o,u){var f=Zt();if(u!==void 0){var g=u(o);if(Tr){xs(!0);try{u(o)}finally{xs(!1)}}}else g=o;return f.memoizedState=f.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},f.queue=r,r=r.dispatch=CD.bind(null,ke,r),[f.memoizedState,r]},useRef:function(r){var o=Zt();return r={current:r},o.memoizedState=r},useState:function(r){r=ng(r);var o=r.queue,u=lS.bind(null,ke,o);return o.dispatch=u,[r.memoizedState,u]},useDebugValue:rg,useDeferredValue:function(r,o){var u=Zt();return lg(u,r,o)},useTransition:function(){var r=ng(!1);return r=tS.bind(null,ke,r.queue,!0,!1),Zt().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,u){var f=ke,g=Zt();if(je){if(u===void 0)throw Error(i(407));u=u()}else{if(u=o(),Ye===null)throw Error(i(349));(Le&127)!==0||Dw(f,o,u)}g.memoizedState=u;var y={value:u,getSnapshot:o};return g.queue=y,Kw(Mw.bind(null,f,y,r),[r]),f.flags|=2048,Nl(9,{destroy:void 0},Rw.bind(null,f,y,u,o),null),u},useId:function(){var r=Zt(),o=Ye.identifierPrefix;if(je){var u=Oi,f=_i;u=(f&~(1<<32-kn(f)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Hu++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=wD++,o="_"+o+"r_"+u.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:ag,useFormState:Hw,useActionState:Hw,useOptimistic:function(r){var o=Zt();o.memoizedState=o.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=cg.bind(null,ke,!0,u),u.dispatch=o,[r,o]},useMemoCache:Zp,useCacheRefresh:function(){return Zt().memoizedState=AD.bind(null,ke)},useEffectEvent:function(r){var o=Zt(),u={impl:r};return o.memoizedState=u,function(){if((qe&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}},ug={readContext:zt,use:Vu,useCallback:Jw,useContext:zt,useEffect:sg,useImperativeHandle:Qw,useInsertionEffect:Fw,useLayoutEffect:Yw,useMemo:Zw,useReducer:$u,useRef:Gw,useState:function(){return $u(ns)},useDebugValue:rg,useDeferredValue:function(r,o){var u=dt();return eS(u,Ge.memoizedState,r,o)},useTransition:function(){var r=$u(ns)[0],o=dt().memoizedState;return[typeof r=="boolean"?r:Sa(r),o]},useSyncExternalStore:Ew,useId:sS,useHostTransitionStatus:ag,useFormState:qw,useActionState:qw,useOptimistic:function(r,o){var u=dt();return Bw(u,Ge,r,o)},useMemoCache:Zp,useCacheRefresh:rS};ug.useEffectEvent=Ww;var uS={readContext:zt,use:Vu,useCallback:Jw,useContext:zt,useEffect:sg,useImperativeHandle:Qw,useInsertionEffect:Fw,useLayoutEffect:Yw,useMemo:Zw,useReducer:tg,useRef:Gw,useState:function(){return tg(ns)},useDebugValue:rg,useDeferredValue:function(r,o){var u=dt();return Ge===null?lg(u,r,o):eS(u,Ge.memoizedState,r,o)},useTransition:function(){var r=tg(ns)[0],o=dt().memoizedState;return[typeof r=="boolean"?r:Sa(r),o]},useSyncExternalStore:Ew,useId:sS,useHostTransitionStatus:ag,useFormState:$w,useActionState:$w,useOptimistic:function(r,o){var u=dt();return Ge!==null?Bw(u,Ge,r,o):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:Zp,useCacheRefresh:rS};uS.useEffectEvent=Ww;function hg(r,o,u,f){o=r.memoizedState,u=u(f,o),u=u==null?o:m({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var fg={enqueueSetState:function(r,o,u){r=r._reactInternals;var f=En(),g=Rs(f);g.payload=o,u!=null&&(g.callback=u),o=Ms(r,g,f),o!==null&&(hn(o,r,f),ya(o,r,f))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var f=En(),g=Rs(f);g.tag=1,g.payload=o,u!=null&&(g.callback=u),o=Ms(r,g,f),o!==null&&(hn(o,r,f),ya(o,r,f))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=En(),f=Rs(u);f.tag=2,o!=null&&(f.callback=o),o=Ms(r,f,u),o!==null&&(hn(o,r,u),ya(o,r,u))}};function hS(r,o,u,f,g,y,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,y,S):o.prototype&&o.prototype.isPureReactComponent?!ca(u,f)||!ca(g,y):!0}function fS(r,o,u,f){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==r&&fg.enqueueReplaceState(o,o.state,null)}function Er(r,o){var u=o;if("ref"in o){u={};for(var f in o)f!=="ref"&&(u[f]=o[f])}if(r=r.defaultProps){u===o&&(u=m({},u));for(var g in r)u[g]===void 0&&(u[g]=r[g])}return u}function dS(r){Ou(r)}function pS(r){console.error(r)}function gS(r){Ou(r)}function Fu(r,o){try{var u=r.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function mS(r,o,u){try{var f=r.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function dg(r,o,u){return u=Rs(u),u.tag=3,u.payload={element:null},u.callback=function(){Fu(r,o)},u}function yS(r){return r=Rs(r),r.tag=3,r}function bS(r,o,u,f){var g=u.type.getDerivedStateFromError;if(typeof g=="function"){var y=f.value;r.payload=function(){return g(y)},r.callback=function(){mS(o,u,f)}}var S=u.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){mS(o,u,f),typeof g!="function"&&(zs===null?zs=new Set([this]):zs.add(this));var x=f.stack;this.componentDidCatch(f.value,{componentStack:x!==null?x:""})})}function TD(r,o,u,f,g){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=u.alternate,o!==null&&Ol(o,u,g,!0),u=On.current,u!==null){switch(u.tag){case 31:case 13:return Yn===null?lh():u.alternate===null&&at===0&&(at=3),u.flags&=-257,u.flags|=65536,u.lanes=g,f===Bu?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([f]):o.add(f),zg(r,f,g)),!1;case 22:return u.flags|=65536,f===Bu?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([f]):u.add(f)),zg(r,f,g)),!1}throw Error(i(435,u.tag))}return zg(r,f,g),lh(),!1}if(je)return o=On.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,f!==Mp&&(r=Error(i(422),{cause:f}),fa(Gn(r,u)))):(f!==Mp&&(o=Error(i(423),{cause:f}),fa(Gn(o,u))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,f=Gn(f,u),g=dg(r.stateNode,f,g),Vp(r,g),at!==4&&(at=2)),!1;var y=Error(i(520),{cause:f});if(y=Gn(y,u),Ra===null?Ra=[y]:Ra.push(y),at!==4&&(at=2),o===null)return!0;f=Gn(f,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,r=g&-g,u.lanes|=r,r=dg(u.stateNode,f,r),Vp(u,r),!1;case 1:if(o=u.type,y=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(zs===null||!zs.has(y))))return u.flags|=65536,g&=-g,u.lanes|=g,g=yS(g),bS(g,r,u,f),Vp(u,g),!1}u=u.return}while(u!==null);return!1}var pg=Error(i(461)),vt=!1;function It(r,o,u,f){o.child=r===null?kw(o,null,u,f):Cr(o,r.child,u,f)}function vS(r,o,u,f,g){u=u.render;var y=o.ref;if("ref"in f){var S={};for(var x in f)x!=="ref"&&(S[x]=f[x])}else S=f;return xr(o),f=Yp(r,o,u,S,y,g),x=Xp(),r!==null&&!vt?(Qp(r,o,g),is(r,o,g)):(je&&x&&Dp(o),o.flags|=1,It(r,o,f,g),o.child)}function wS(r,o,u,f,g){if(r===null){var y=u.type;return typeof y=="function"&&!Cp(y)&&y.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=y,SS(r,o,y,f,g)):(r=Eu(u.type,null,f,o,o.mode,g),r.ref=o.ref,r.return=o,o.child=r)}if(y=r.child,!kg(r,g)){var S=y.memoizedProps;if(u=u.compare,u=u!==null?u:ca,u(S,f)&&r.ref===o.ref)return is(r,o,g)}return o.flags|=1,r=Qi(y,f),r.ref=o.ref,r.return=o,o.child=r}function SS(r,o,u,f,g){if(r!==null){var y=r.memoizedProps;if(ca(y,f)&&r.ref===o.ref)if(vt=!1,o.pendingProps=f=y,kg(r,g))(r.flags&131072)!==0&&(vt=!0);else return o.lanes=r.lanes,is(r,o,g)}return gg(r,o,u,f,g)}function kS(r,o,u,f){var g=f.children,y=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((o.flags&128)!==0){if(y=y!==null?y.baseLanes|u:u,r!==null){for(f=o.child=r.child,g=0;f!==null;)g=g|f.lanes|f.childLanes,f=f.sibling;f=g&~y}else f=0,o.child=null;return xS(r,o,y,u,f)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Nu(o,y!==null?y.cachePool:null),y!==null?Ow(o,y):Gp(),Aw(o);else return f=o.lanes=536870912,xS(r,o,y!==null?y.baseLanes|u:u,u,f)}else y!==null?(Nu(o,y.cachePool),Ow(o,y),Ls(),o.memoizedState=null):(r!==null&&Nu(o,null),Gp(),Ls());return It(r,o,g,u),o.child}function _a(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function xS(r,o,u,f,g){var y=Ip();return y=y===null?null:{parent:yt._currentValue,pool:y},o.memoizedState={baseLanes:u,cachePool:y},r!==null&&Nu(o,null),Gp(),Aw(o),r!==null&&Ol(r,o,f,!0),o.childLanes=g,null}function Yu(r,o){return o=Qu({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function _S(r,o,u){return Cr(o,r.child,null,u),r=Yu(o,o.pendingProps),r.flags|=2,An(o),o.memoizedState=null,r}function ED(r,o,u){var f=o.pendingProps,g=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(je){if(f.mode==="hidden")return r=Yu(o,f),o.lanes=536870912,_a(null,r);if(Wp(o),(r=nt)?(r=j1(r,Fn),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:As!==null?{id:_i,overflow:Oi}:null,retryLane:536870912,hydrationErrors:null},u=ow(r),u.return=o,o.child=u,Ut=o,nt=null)):r=null,r===null)throw Ts(o);return o.lanes=536870912,null}return Yu(o,f)}var y=r.memoizedState;if(y!==null){var S=y.dehydrated;if(Wp(o),g)if(o.flags&256)o.flags&=-257,o=_S(r,o,u);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(i(558));else if(vt||Ol(r,o,u,!1),g=(u&r.childLanes)!==0,vt||g){if(f=Ye,f!==null&&(S=pv(f,u),S!==0&&S!==y.retryLane))throw y.retryLane=S,vr(r,S),hn(f,r,S),pg;lh(),o=_S(r,o,u)}else r=y.treeContext,nt=Xn(S.nextSibling),Ut=o,je=!0,Cs=null,Fn=!1,r!==null&&uw(o,r),o=Yu(o,f),o.flags|=4096;return o}return r=Qi(r.child,{mode:f.mode,children:f.children}),r.ref=o.ref,o.child=r,r.return=o,r}function Xu(r,o){var u=o.ref;if(u===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(r===null||r.ref!==u)&&(o.flags|=4194816)}}function gg(r,o,u,f,g){return xr(o),u=Yp(r,o,u,f,void 0,g),f=Xp(),r!==null&&!vt?(Qp(r,o,g),is(r,o,g)):(je&&f&&Dp(o),o.flags|=1,It(r,o,u,g),o.child)}function OS(r,o,u,f,g,y){return xr(o),o.updateQueue=null,u=Tw(o,f,u,g),Cw(r),f=Xp(),r!==null&&!vt?(Qp(r,o,y),is(r,o,y)):(je&&f&&Dp(o),o.flags|=1,It(r,o,u,y),o.child)}function AS(r,o,u,f,g){if(xr(o),o.stateNode===null){var y=Sl,S=u.contextType;typeof S=="object"&&S!==null&&(y=zt(S)),y=new u(f,y),o.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=fg,o.stateNode=y,y._reactInternals=o,y=o.stateNode,y.props=f,y.state=o.memoizedState,y.refs={},Hp(o),S=u.contextType,y.context=typeof S=="object"&&S!==null?zt(S):Sl,y.state=o.memoizedState,S=u.getDerivedStateFromProps,typeof S=="function"&&(hg(o,u,S,f),y.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(S=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),S!==y.state&&fg.enqueueReplaceState(y,y.state,null),va(o,f,y,g),ba(),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(r===null){y=o.stateNode;var x=o.memoizedProps,A=Er(u,x);y.props=A;var L=y.context,q=u.contextType;S=Sl,typeof q=="object"&&q!==null&&(S=zt(q));var K=u.getDerivedStateFromProps;q=typeof K=="function"||typeof y.getSnapshotBeforeUpdate=="function",x=o.pendingProps!==x,q||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(x||L!==S)&&fS(o,y,f,S),Ds=!1;var j=o.memoizedState;y.state=j,va(o,f,y,g),ba(),L=o.memoizedState,x||j!==L||Ds?(typeof K=="function"&&(hg(o,u,K,f),L=o.memoizedState),(A=Ds||hS(o,u,A,f,j,L,S))?(q||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(o.flags|=4194308)):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=L),y.props=f,y.state=L,y.context=S,f=A):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{y=o.stateNode,qp(r,o),S=o.memoizedProps,q=Er(u,S),y.props=q,K=o.pendingProps,j=y.context,L=u.contextType,A=Sl,typeof L=="object"&&L!==null&&(A=zt(L)),x=u.getDerivedStateFromProps,(L=typeof x=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S!==K||j!==A)&&fS(o,y,f,A),Ds=!1,j=o.memoizedState,y.state=j,va(o,f,y,g),ba();var P=o.memoizedState;S!==K||j!==P||Ds||r!==null&&r.dependencies!==null&&Ru(r.dependencies)?(typeof x=="function"&&(hg(o,u,x,f),P=o.memoizedState),(q=Ds||hS(o,u,q,f,j,P,A)||r!==null&&r.dependencies!==null&&Ru(r.dependencies))?(L||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(f,P,A),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(f,P,A)),typeof y.componentDidUpdate=="function"&&(o.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof y.componentDidUpdate!="function"||S===r.memoizedProps&&j===r.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&j===r.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=P),y.props=f,y.state=P,y.context=A,f=q):(typeof y.componentDidUpdate!="function"||S===r.memoizedProps&&j===r.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&j===r.memoizedState||(o.flags|=1024),f=!1)}return y=f,Xu(r,o),f=(o.flags&128)!==0,y||f?(y=o.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:y.render(),o.flags|=1,r!==null&&f?(o.child=Cr(o,r.child,null,g),o.child=Cr(o,null,u,g)):It(r,o,u,g),o.memoizedState=y.state,r=o.child):r=is(r,o,g),r}function CS(r,o,u,f){return Sr(),o.flags|=256,It(r,o,u,f),o.child}var mg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function yg(r){return{baseLanes:r,cachePool:mw()}}function bg(r,o,u){return r=r!==null?r.childLanes&~u:0,o&&(r|=Tn),r}function TS(r,o,u){var f=o.pendingProps,g=!1,y=(o.flags&128)!==0,S;if((S=y)||(S=r!==null&&r.memoizedState===null?!1:(ft.current&2)!==0),S&&(g=!0,o.flags&=-129),S=(o.flags&32)!==0,o.flags&=-33,r===null){if(je){if(g?Ns(o):Ls(),(r=nt)?(r=j1(r,Fn),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:As!==null?{id:_i,overflow:Oi}:null,retryLane:536870912,hydrationErrors:null},u=ow(r),u.return=o,o.child=u,Ut=o,nt=null)):r=null,r===null)throw Ts(o);return em(r)?o.lanes=32:o.lanes=536870912,null}var x=f.children;return f=f.fallback,g?(Ls(),g=o.mode,x=Qu({mode:"hidden",children:x},g),f=wr(f,g,u,null),x.return=o,f.return=o,x.sibling=f,o.child=x,f=o.child,f.memoizedState=yg(u),f.childLanes=bg(r,S,u),o.memoizedState=mg,_a(null,f)):(Ns(o),vg(o,x))}var A=r.memoizedState;if(A!==null&&(x=A.dehydrated,x!==null)){if(y)o.flags&256?(Ns(o),o.flags&=-257,o=wg(r,o,u)):o.memoizedState!==null?(Ls(),o.child=r.child,o.flags|=128,o=null):(Ls(),x=f.fallback,g=o.mode,f=Qu({mode:"visible",children:f.children},g),x=wr(x,g,u,null),x.flags|=2,f.return=o,x.return=o,f.sibling=x,o.child=f,Cr(o,r.child,null,u),f=o.child,f.memoizedState=yg(u),f.childLanes=bg(r,S,u),o.memoizedState=mg,o=_a(null,f));else if(Ns(o),em(x)){if(S=x.nextSibling&&x.nextSibling.dataset,S)var L=S.dgst;S=L,f=Error(i(419)),f.stack="",f.digest=S,fa({value:f,source:null,stack:null}),o=wg(r,o,u)}else if(vt||Ol(r,o,u,!1),S=(u&r.childLanes)!==0,vt||S){if(S=Ye,S!==null&&(f=pv(S,u),f!==0&&f!==A.retryLane))throw A.retryLane=f,vr(r,f),hn(S,r,f),pg;Zg(x)||lh(),o=wg(r,o,u)}else Zg(x)?(o.flags|=192,o.child=r.child,o=null):(r=A.treeContext,nt=Xn(x.nextSibling),Ut=o,je=!0,Cs=null,Fn=!1,r!==null&&uw(o,r),o=vg(o,f.children),o.flags|=4096);return o}return g?(Ls(),x=f.fallback,g=o.mode,A=r.child,L=A.sibling,f=Qi(A,{mode:"hidden",children:f.children}),f.subtreeFlags=A.subtreeFlags&65011712,L!==null?x=Qi(L,x):(x=wr(x,g,u,null),x.flags|=2),x.return=o,f.return=o,f.sibling=x,o.child=f,_a(null,f),f=o.child,x=r.child.memoizedState,x===null?x=yg(u):(g=x.cachePool,g!==null?(A=yt._currentValue,g=g.parent!==A?{parent:A,pool:A}:g):g=mw(),x={baseLanes:x.baseLanes|u,cachePool:g}),f.memoizedState=x,f.childLanes=bg(r,S,u),o.memoizedState=mg,_a(r.child,f)):(Ns(o),u=r.child,r=u.sibling,u=Qi(u,{mode:"visible",children:f.children}),u.return=o,u.sibling=null,r!==null&&(S=o.deletions,S===null?(o.deletions=[r],o.flags|=16):S.push(r)),o.child=u,o.memoizedState=null,u)}function vg(r,o){return o=Qu({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function Qu(r,o){return r=_n(22,r,null,o),r.lanes=0,r}function wg(r,o,u){return Cr(o,r.child,null,u),r=vg(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function ES(r,o,u){r.lanes|=o;var f=r.alternate;f!==null&&(f.lanes|=o),Bp(r.return,o,u)}function Sg(r,o,u,f,g,y){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:g,treeForkCount:y}:(S.isBackwards=o,S.rendering=null,S.renderingStartTime=0,S.last=f,S.tail=u,S.tailMode=g,S.treeForkCount=y)}function DS(r,o,u){var f=o.pendingProps,g=f.revealOrder,y=f.tail;f=f.children;var S=ft.current,x=(S&2)!==0;if(x?(S=S&1|2,o.flags|=128):S&=1,Y(ft,S),It(r,o,f,u),f=je?ha:0,!x&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&ES(r,u,o);else if(r.tag===19)ES(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(g){case"forwards":for(u=o.child,g=null;u!==null;)r=u.alternate,r!==null&&Iu(r)===null&&(g=u),u=u.sibling;u=g,u===null?(g=o.child,o.child=null):(g=u.sibling,u.sibling=null),Sg(o,!1,g,u,y,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,g=o.child,o.child=null;g!==null;){if(r=g.alternate,r!==null&&Iu(r)===null){o.child=g;break}r=g.sibling,g.sibling=u,u=g,g=r}Sg(o,!0,u,null,y,f);break;case"together":Sg(o,!1,null,null,void 0,f);break;default:o.memoizedState=null}return o.child}function is(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),Us|=o.lanes,(u&o.childLanes)===0)if(r!==null){if(Ol(r,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(i(153));if(o.child!==null){for(r=o.child,u=Qi(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=Qi(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function kg(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&Ru(r)))}function DD(r,o,u){switch(o.tag){case 3:Jt(o,o.stateNode.containerInfo),Es(o,yt,r.memoizedState.cache),Sr();break;case 27:case 5:Xo(o);break;case 4:Jt(o,o.stateNode.containerInfo);break;case 10:Es(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Wp(o),null;break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(Ns(o),o.flags|=128,null):(u&o.child.childLanes)!==0?TS(r,o,u):(Ns(o),r=is(r,o,u),r!==null?r.sibling:null);Ns(o);break;case 19:var g=(r.flags&128)!==0;if(f=(u&o.childLanes)!==0,f||(Ol(r,o,u,!1),f=(u&o.childLanes)!==0),g){if(f)return DS(r,o,u);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Y(ft,ft.current),f)break;return null;case 22:return o.lanes=0,kS(r,o,u,o.pendingProps);case 24:Es(o,yt,r.memoizedState.cache)}return is(r,o,u)}function RS(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps)vt=!0;else{if(!kg(r,u)&&(o.flags&128)===0)return vt=!1,DD(r,o,u);vt=(r.flags&131072)!==0}else vt=!1,je&&(o.flags&1048576)!==0&&cw(o,ha,o.index);switch(o.lanes=0,o.tag){case 16:e:{var f=o.pendingProps;if(r=Or(o.elementType),o.type=r,typeof r=="function")Cp(r)?(f=Er(r,f),o.tag=1,o=AS(null,o,r,f,u)):(o.tag=0,o=gg(null,o,r,f,u));else{if(r!=null){var g=r.$$typeof;if(g===U){o.tag=11,o=vS(null,o,r,f,u);break e}else if(g===D){o.tag=14,o=wS(null,o,r,f,u);break e}}throw o=Q(r)||r,Error(i(306,o,""))}}return o;case 0:return gg(r,o,o.type,o.pendingProps,u);case 1:return f=o.type,g=Er(f,o.pendingProps),AS(r,o,f,g,u);case 3:e:{if(Jt(o,o.stateNode.containerInfo),r===null)throw Error(i(387));f=o.pendingProps;var y=o.memoizedState;g=y.element,qp(r,o),va(o,f,null,u);var S=o.memoizedState;if(f=S.cache,Es(o,yt,f),f!==y.cache&&jp(o,[yt],u,!0),ba(),f=S.element,y.isDehydrated)if(y={element:f,isDehydrated:!1,cache:S.cache},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){o=CS(r,o,f,u);break e}else if(f!==g){g=Gn(Error(i(424)),o),fa(g),o=CS(r,o,f,u);break e}else for(r=o.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,nt=Xn(r.firstChild),Ut=o,je=!0,Cs=null,Fn=!0,u=kw(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Sr(),f===g){o=is(r,o,u);break e}It(r,o,f,u)}o=o.child}return o;case 26:return Xu(r,o),r===null?(u=q1(o.type,null,o.pendingProps,null))?o.memoizedState=u:je||(u=o.type,r=o.pendingProps,f=dh(Se.current).createElement(u),f[jt]=o,f[rn]=r,Pt(f,u,r),Dt(f),o.stateNode=f):o.memoizedState=q1(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Xo(o),r===null&&je&&(f=o.stateNode=I1(o.type,o.pendingProps,Se.current),Ut=o,Fn=!0,g=nt,qs(o.type)?(tm=g,nt=Xn(f.firstChild)):nt=g),It(r,o,o.pendingProps.children,u),Xu(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&je&&((g=f=nt)&&(f=lR(f,o.type,o.pendingProps,Fn),f!==null?(o.stateNode=f,Ut=o,nt=Xn(f.firstChild),Fn=!1,g=!0):g=!1),g||Ts(o)),Xo(o),g=o.type,y=o.pendingProps,S=r!==null?r.memoizedProps:null,f=y.children,Xg(g,y)?f=null:S!==null&&Xg(g,S)&&(o.flags|=32),o.memoizedState!==null&&(g=Yp(r,o,SD,null,null,u),Ia._currentValue=g),Xu(r,o),It(r,o,f,u),o.child;case 6:return r===null&&je&&((r=u=nt)&&(u=oR(u,o.pendingProps,Fn),u!==null?(o.stateNode=u,Ut=o,nt=null,r=!0):r=!1),r||Ts(o)),null;case 13:return TS(r,o,u);case 4:return Jt(o,o.stateNode.containerInfo),f=o.pendingProps,r===null?o.child=Cr(o,null,f,u):It(r,o,f,u),o.child;case 11:return vS(r,o,o.type,o.pendingProps,u);case 7:return It(r,o,o.pendingProps,u),o.child;case 8:return It(r,o,o.pendingProps.children,u),o.child;case 12:return It(r,o,o.pendingProps.children,u),o.child;case 10:return f=o.pendingProps,Es(o,o.type,f.value),It(r,o,f.children,u),o.child;case 9:return g=o.type._context,f=o.pendingProps.children,xr(o),g=zt(g),f=f(g),o.flags|=1,It(r,o,f,u),o.child;case 14:return wS(r,o,o.type,o.pendingProps,u);case 15:return SS(r,o,o.type,o.pendingProps,u);case 19:return DS(r,o,u);case 31:return ED(r,o,u);case 22:return kS(r,o,u,o.pendingProps);case 24:return xr(o),f=zt(yt),r===null?(g=Ip(),g===null&&(g=Ye,y=Up(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=u),g=y),o.memoizedState={parent:f,cache:g},Hp(o),Es(o,yt,g)):((r.lanes&u)!==0&&(qp(r,o),va(o,null,null,u),ba()),g=r.memoizedState,y=o.memoizedState,g.parent!==f?(g={parent:f,cache:f},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),Es(o,yt,f)):(f=y.cache,Es(o,yt,f),f!==g.cache&&jp(o,[yt],u,!0))),It(r,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function ss(r){r.flags|=4}function xg(r,o,u,f,g){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(g&335544128)===g)if(r.stateNode.complete)r.flags|=8192;else if(s1())r.flags|=8192;else throw Ar=Bu,Pp}else r.flags&=-16777217}function MS(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!W1(o))if(s1())r.flags|=8192;else throw Ar=Bu,Pp}function Ju(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?hv():536870912,r.lanes|=o,Ul|=o)}function Oa(r,o){if(!je)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function it(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,f=0;if(o)for(var g=r.child;g!==null;)u|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)u|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=f,r.childLanes=u,o}function RD(r,o,u){var f=o.pendingProps;switch(Rp(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return it(o),null;case 1:return it(o),null;case 3:return u=o.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),es(yt),ht(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(_l(o)?ss(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Np())),it(o),null;case 26:var g=o.type,y=o.memoizedState;return r===null?(ss(o),y!==null?(it(o),MS(o,y)):(it(o),xg(o,g,null,f,u))):y?y!==r.memoizedState?(ss(o),it(o),MS(o,y)):(it(o),o.flags&=-16777217):(r=r.memoizedProps,r!==f&&ss(o),it(o),xg(o,g,r,f,u)),null;case 27:if(cu(o),u=Se.current,g=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&ss(o);else{if(!f){if(o.stateNode===null)throw Error(i(166));return it(o),null}r=ie.current,_l(o)?hw(o):(r=I1(g,f,u),o.stateNode=r,ss(o))}return it(o),null;case 5:if(cu(o),g=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&ss(o);else{if(!f){if(o.stateNode===null)throw Error(i(166));return it(o),null}if(y=ie.current,_l(o))hw(o);else{var S=dh(Se.current);switch(y){case 1:y=S.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=S.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=S.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof f.is=="string"?S.createElement("select",{is:f.is}):S.createElement("select"),f.multiple?y.multiple=!0:f.size&&(y.size=f.size);break;default:y=typeof f.is=="string"?S.createElement(g,{is:f.is}):S.createElement(g)}}y[jt]=o,y[rn]=f;e:for(S=o.child;S!==null;){if(S.tag===5||S.tag===6)y.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===o)break e;for(;S.sibling===null;){if(S.return===null||S.return===o)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}o.stateNode=y;e:switch(Pt(y,g,f),g){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&ss(o)}}return it(o),xg(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,u),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==f&&ss(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(i(166));if(r=Se.current,_l(o)){if(r=o.stateNode,u=o.memoizedProps,f=null,g=Ut,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}r[jt]=o,r=!!(r.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||T1(r.nodeValue,u)),r||Ts(o,!0)}else r=dh(r).createTextNode(f),r[jt]=o,o.stateNode=r}return it(o),null;case 31:if(u=o.memoizedState,r===null||r.memoizedState!==null){if(f=_l(o),u!==null){if(r===null){if(!f)throw Error(i(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[jt]=o}else Sr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;it(o),r=!1}else u=Np(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return o.flags&256?(An(o),o):(An(o),null);if((o.flags&128)!==0)throw Error(i(558))}return it(o),null;case 13:if(f=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=_l(o),f!==null&&f.dehydrated!==null){if(r===null){if(!g)throw Error(i(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[jt]=o}else Sr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;it(o),g=!1}else g=Np(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(An(o),o):(An(o),null)}return An(o),(o.flags&128)!==0?(o.lanes=u,o):(u=f!==null,r=r!==null&&r.memoizedState!==null,u&&(f=o.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool),y=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==g&&(f.flags|=2048)),u!==r&&u&&(o.child.flags|=8192),Ju(o,o.updateQueue),it(o),null);case 4:return ht(),r===null&&Gg(o.stateNode.containerInfo),it(o),null;case 10:return es(o.type),it(o),null;case 19:if(V(ft),f=o.memoizedState,f===null)return it(o),null;if(g=(o.flags&128)!==0,y=f.rendering,y===null)if(g)Oa(f,!1);else{if(at!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(y=Iu(r),y!==null){for(o.flags|=128,Oa(f,!1),r=y.updateQueue,o.updateQueue=r,Ju(o,r),o.subtreeFlags=0,r=u,u=o.child;u!==null;)lw(u,r),u=u.sibling;return Y(ft,ft.current&1|2),je&&Ji(o,f.treeForkCount),o.child}r=r.sibling}f.tail!==null&&wn()>ih&&(o.flags|=128,g=!0,Oa(f,!1),o.lanes=4194304)}else{if(!g)if(r=Iu(y),r!==null){if(o.flags|=128,g=!0,r=r.updateQueue,o.updateQueue=r,Ju(o,r),Oa(f,!0),f.tail===null&&f.tailMode==="hidden"&&!y.alternate&&!je)return it(o),null}else 2*wn()-f.renderingStartTime>ih&&u!==536870912&&(o.flags|=128,g=!0,Oa(f,!1),o.lanes=4194304);f.isBackwards?(y.sibling=o.child,o.child=y):(r=f.last,r!==null?r.sibling=y:o.child=y,f.last=y)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=wn(),r.sibling=null,u=ft.current,Y(ft,g?u&1|2:u&1),je&&Ji(o,f.treeForkCount),r):(it(o),null);case 22:case 23:return An(o),Kp(),f=o.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(u&536870912)!==0&&(o.flags&128)===0&&(it(o),o.subtreeFlags&6&&(o.flags|=8192)):it(o),u=o.updateQueue,u!==null&&Ju(o,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048),r!==null&&V(_r),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),es(yt),it(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function MD(r,o){switch(Rp(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return es(yt),ht(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return cu(o),null;case 31:if(o.memoizedState!==null){if(An(o),o.alternate===null)throw Error(i(340));Sr()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(An(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(i(340));Sr()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return V(ft),null;case 4:return ht(),null;case 10:return es(o.type),null;case 22:case 23:return An(o),Kp(),r!==null&&V(_r),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return es(yt),null;case 25:return null;default:return null}}function NS(r,o){switch(Rp(o),o.tag){case 3:es(yt),ht();break;case 26:case 27:case 5:cu(o);break;case 4:ht();break;case 31:o.memoizedState!==null&&An(o);break;case 13:An(o);break;case 19:V(ft);break;case 10:es(o.type);break;case 22:case 23:An(o),Kp(),r!==null&&V(_r);break;case 24:es(yt)}}function Aa(r,o){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var g=f.next;u=g;do{if((u.tag&r)===r){f=void 0;var y=u.create,S=u.inst;f=y(),S.destroy=f}u=u.next}while(u!==g)}}catch(x){$e(o,o.return,x)}}function Bs(r,o,u){try{var f=o.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var y=g.next;f=y;do{if((f.tag&r)===r){var S=f.inst,x=S.destroy;if(x!==void 0){S.destroy=void 0,g=o;var A=u,L=x;try{L()}catch(q){$e(g,A,q)}}}f=f.next}while(f!==y)}}catch(q){$e(o,o.return,q)}}function LS(r){var o=r.updateQueue;if(o!==null){var u=r.stateNode;try{_w(o,u)}catch(f){$e(r,r.return,f)}}}function BS(r,o,u){u.props=Er(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(f){$e(r,o,f)}}function Ca(r,o){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof u=="function"?r.refCleanup=u(f):u.current=f}}catch(g){$e(r,o,g)}}function Ai(r,o){var u=r.ref,f=r.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(g){$e(r,o,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(g){$e(r,o,g)}else u.current=null}function jS(r){var o=r.type,u=r.memoizedProps,f=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(g){$e(r,r.return,g)}}function _g(r,o,u){try{var f=r.stateNode;eR(f,r.type,u,o),f[rn]=o}catch(g){$e(r,r.return,g)}}function US(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&qs(r.type)||r.tag===4}function Og(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||US(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&qs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Ag(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(r),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Yi));else if(f!==4&&(f===27&&qs(r.type)&&(u=r.stateNode,o=null),r=r.child,r!==null))for(Ag(r,o,u),r=r.sibling;r!==null;)Ag(r,o,u),r=r.sibling}function Zu(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(f!==4&&(f===27&&qs(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(Zu(r,o,u),r=r.sibling;r!==null;)Zu(r,o,u),r=r.sibling}function zS(r){var o=r.stateNode,u=r.memoizedProps;try{for(var f=r.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);Pt(o,f,u),o[jt]=r,o[rn]=u}catch(y){$e(r,r.return,y)}}var rs=!1,wt=!1,Cg=!1,IS=typeof WeakSet=="function"?WeakSet:Set,Rt=null;function ND(r,o){if(r=r.containerInfo,Fg=wh,r=Qv(r),wp(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var g=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{u.nodeType,y.nodeType}catch{u=null;break e}var S=0,x=-1,A=-1,L=0,q=0,K=r,j=null;t:for(;;){for(var P;K!==u||g!==0&&K.nodeType!==3||(x=S+g),K!==y||f!==0&&K.nodeType!==3||(A=S+f),K.nodeType===3&&(S+=K.nodeValue.length),(P=K.firstChild)!==null;)j=K,K=P;for(;;){if(K===r)break t;if(j===u&&++L===g&&(x=S),j===y&&++q===f&&(A=S),(P=K.nextSibling)!==null)break;K=j,j=K.parentNode}K=P}u=x===-1||A===-1?null:{start:x,end:A}}else u=null}u=u||{start:0,end:0}}else u=null;for(Yg={focusedElem:r,selectionRange:u},wh=!1,Rt=o;Rt!==null;)if(o=Rt,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Rt=r;else for(;Rt!==null;){switch(o=Rt,y=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)g=r[u],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,u=o,g=y.memoizedProps,y=y.memoizedState,f=u.stateNode;try{var re=Er(u.type,g);r=f.getSnapshotBeforeUpdate(re,y),f.__reactInternalSnapshotBeforeUpdate=r}catch(ge){$e(u,u.return,ge)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,u=r.nodeType,u===9)Jg(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Jg(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=o.sibling,r!==null){r.return=o.return,Rt=r;break}Rt=o.return}}function PS(r,o,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:os(r,u),f&4&&Aa(5,u);break;case 1:if(os(r,u),f&4)if(r=u.stateNode,o===null)try{r.componentDidMount()}catch(S){$e(u,u.return,S)}else{var g=Er(u.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(g,o,r.__reactInternalSnapshotBeforeUpdate)}catch(S){$e(u,u.return,S)}}f&64&&LS(u),f&512&&Ca(u,u.return);break;case 3:if(os(r,u),f&64&&(r=u.updateQueue,r!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{_w(r,o)}catch(S){$e(u,u.return,S)}}break;case 27:o===null&&f&4&&zS(u);case 26:case 5:os(r,u),o===null&&f&4&&jS(u),f&512&&Ca(u,u.return);break;case 12:os(r,u);break;case 31:os(r,u),f&4&&VS(r,u);break;case 13:os(r,u),f&4&&$S(r,u),f&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=qD.bind(null,u),aR(r,u))));break;case 22:if(f=u.memoizedState!==null||rs,!f){o=o!==null&&o.memoizedState!==null||wt,g=rs;var y=wt;rs=f,(wt=o)&&!y?as(r,u,(u.subtreeFlags&8772)!==0):os(r,u),rs=g,wt=y}break;case 30:break;default:os(r,u)}}function HS(r){var o=r.alternate;o!==null&&(r.alternate=null,HS(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&ip(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var st=null,on=!1;function ls(r,o,u){for(u=u.child;u!==null;)qS(r,o,u),u=u.sibling}function qS(r,o,u){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(Qo,u)}catch{}switch(u.tag){case 26:wt||Ai(u,o),ls(r,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:wt||Ai(u,o);var f=st,g=on;qs(u.type)&&(st=u.stateNode,on=!1),ls(r,o,u),ja(u.stateNode),st=f,on=g;break;case 5:wt||Ai(u,o);case 6:if(f=st,g=on,st=null,ls(r,o,u),st=f,on=g,st!==null)if(on)try{(st.nodeType===9?st.body:st.nodeName==="HTML"?st.ownerDocument.body:st).removeChild(u.stateNode)}catch(y){$e(u,o,y)}else try{st.removeChild(u.stateNode)}catch(y){$e(u,o,y)}break;case 18:st!==null&&(on?(r=st,L1(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),Gl(r)):L1(st,u.stateNode));break;case 4:f=st,g=on,st=u.stateNode.containerInfo,on=!0,ls(r,o,u),st=f,on=g;break;case 0:case 11:case 14:case 15:Bs(2,u,o),wt||Bs(4,u,o),ls(r,o,u);break;case 1:wt||(Ai(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"&&BS(u,o,f)),ls(r,o,u);break;case 21:ls(r,o,u);break;case 22:wt=(f=wt)||u.memoizedState!==null,ls(r,o,u),wt=f;break;default:ls(r,o,u)}}function VS(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Gl(r)}catch(u){$e(o,o.return,u)}}}function $S(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Gl(r)}catch(u){$e(o,o.return,u)}}function LD(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new IS),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new IS),o;default:throw Error(i(435,r.tag))}}function eh(r,o){var u=LD(r);o.forEach(function(f){if(!u.has(f)){u.add(f);var g=VD.bind(null,r,f);f.then(g,g)}})}function an(r,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var g=u[f],y=r,S=o,x=S;e:for(;x!==null;){switch(x.tag){case 27:if(qs(x.type)){st=x.stateNode,on=!1;break e}break;case 5:st=x.stateNode,on=!1;break e;case 3:case 4:st=x.stateNode.containerInfo,on=!0;break e}x=x.return}if(st===null)throw Error(i(160));qS(y,S,g),st=null,on=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)GS(o,r),o=o.sibling}var ai=null;function GS(r,o){var u=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:an(o,r),cn(r),f&4&&(Bs(3,r,r.return),Aa(3,r),Bs(5,r,r.return));break;case 1:an(o,r),cn(r),f&512&&(wt||u===null||Ai(u,u.return)),f&64&&rs&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var g=ai;if(an(o,r),cn(r),f&512&&(wt||u===null||Ai(u,u.return)),f&4){var y=u!==null?u.memoizedState:null;if(f=r.memoizedState,u===null)if(f===null)if(r.stateNode===null){e:{f=r.type,u=r.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":y=g.getElementsByTagName("title")[0],(!y||y[ea]||y[jt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(f),g.head.insertBefore(y,g.querySelector("head > title"))),Pt(y,f,u),y[jt]=r,Dt(y),f=y;break e;case"link":var S=G1("link","href",g).get(f+(u.href||""));if(S){for(var x=0;x<S.length;x++)if(y=S[x],y.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&y.getAttribute("rel")===(u.rel==null?null:u.rel)&&y.getAttribute("title")===(u.title==null?null:u.title)&&y.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){S.splice(x,1);break t}}y=g.createElement(f),Pt(y,f,u),g.head.appendChild(y);break;case"meta":if(S=G1("meta","content",g).get(f+(u.content||""))){for(x=0;x<S.length;x++)if(y=S[x],y.getAttribute("content")===(u.content==null?null:""+u.content)&&y.getAttribute("name")===(u.name==null?null:u.name)&&y.getAttribute("property")===(u.property==null?null:u.property)&&y.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&y.getAttribute("charset")===(u.charSet==null?null:u.charSet)){S.splice(x,1);break t}}y=g.createElement(f),Pt(y,f,u),g.head.appendChild(y);break;default:throw Error(i(468,f))}y[jt]=r,Dt(y),f=y}r.stateNode=f}else K1(g,r.type,r.stateNode);else r.stateNode=$1(g,f,r.memoizedProps);else y!==f?(y===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):y.count--,f===null?K1(g,r.type,r.stateNode):$1(g,f,r.memoizedProps)):f===null&&r.stateNode!==null&&_g(r,r.memoizedProps,u.memoizedProps)}break;case 27:an(o,r),cn(r),f&512&&(wt||u===null||Ai(u,u.return)),u!==null&&f&4&&_g(r,r.memoizedProps,u.memoizedProps);break;case 5:if(an(o,r),cn(r),f&512&&(wt||u===null||Ai(u,u.return)),r.flags&32){g=r.stateNode;try{pl(g,"")}catch(re){$e(r,r.return,re)}}f&4&&r.stateNode!=null&&(g=r.memoizedProps,_g(r,g,u!==null?u.memoizedProps:g)),f&1024&&(Cg=!0);break;case 6:if(an(o,r),cn(r),f&4){if(r.stateNode===null)throw Error(i(162));f=r.memoizedProps,u=r.stateNode;try{u.nodeValue=f}catch(re){$e(r,r.return,re)}}break;case 3:if(mh=null,g=ai,ai=ph(o.containerInfo),an(o,r),ai=g,cn(r),f&4&&u!==null&&u.memoizedState.isDehydrated)try{Gl(o.containerInfo)}catch(re){$e(r,r.return,re)}Cg&&(Cg=!1,KS(r));break;case 4:f=ai,ai=ph(r.stateNode.containerInfo),an(o,r),cn(r),ai=f;break;case 12:an(o,r),cn(r);break;case 31:an(o,r),cn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,eh(r,f)));break;case 13:an(o,r),cn(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(nh=wn()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,eh(r,f)));break;case 22:g=r.memoizedState!==null;var A=u!==null&&u.memoizedState!==null,L=rs,q=wt;if(rs=L||g,wt=q||A,an(o,r),wt=q,rs=L,cn(r),f&8192)e:for(o=r.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(u===null||A||rs||wt||Dr(r)),u=null,o=r;;){if(o.tag===5||o.tag===26){if(u===null){A=u=o;try{if(y=A.stateNode,g)S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{x=A.stateNode;var K=A.memoizedProps.style,j=K!=null&&K.hasOwnProperty("display")?K.display:null;x.style.display=j==null||typeof j=="boolean"?"":(""+j).trim()}}catch(re){$e(A,A.return,re)}}}else if(o.tag===6){if(u===null){A=o;try{A.stateNode.nodeValue=g?"":A.memoizedProps}catch(re){$e(A,A.return,re)}}}else if(o.tag===18){if(u===null){A=o;try{var P=A.stateNode;g?B1(P,!0):B1(A.stateNode,!1)}catch(re){$e(A,A.return,re)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=r.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,eh(r,u))));break;case 19:an(o,r),cn(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,eh(r,f)));break;case 30:break;case 21:break;default:an(o,r),cn(r)}}function cn(r){var o=r.flags;if(o&2){try{for(var u,f=r.return;f!==null;){if(US(f)){u=f;break}f=f.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var g=u.stateNode,y=Og(r);Zu(r,y,g);break;case 5:var S=u.stateNode;u.flags&32&&(pl(S,""),u.flags&=-33);var x=Og(r);Zu(r,x,S);break;case 3:case 4:var A=u.stateNode.containerInfo,L=Og(r);Ag(r,L,A);break;default:throw Error(i(161))}}catch(q){$e(r,r.return,q)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function KS(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;KS(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function os(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)PS(r,o.alternate,o),o=o.sibling}function Dr(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:Bs(4,o,o.return),Dr(o);break;case 1:Ai(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&BS(o,o.return,u),Dr(o);break;case 27:ja(o.stateNode);case 26:case 5:Ai(o,o.return),Dr(o);break;case 22:o.memoizedState===null&&Dr(o);break;case 30:Dr(o);break;default:Dr(o)}r=r.sibling}}function as(r,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,g=r,y=o,S=y.flags;switch(y.tag){case 0:case 11:case 15:as(g,y,u),Aa(4,y);break;case 1:if(as(g,y,u),f=y,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(L){$e(f,f.return,L)}if(f=y,g=f.updateQueue,g!==null){var x=f.stateNode;try{var A=g.shared.hiddenCallbacks;if(A!==null)for(g.shared.hiddenCallbacks=null,g=0;g<A.length;g++)xw(A[g],x)}catch(L){$e(f,f.return,L)}}u&&S&64&&LS(y),Ca(y,y.return);break;case 27:zS(y);case 26:case 5:as(g,y,u),u&&f===null&&S&4&&jS(y),Ca(y,y.return);break;case 12:as(g,y,u);break;case 31:as(g,y,u),u&&S&4&&VS(g,y);break;case 13:as(g,y,u),u&&S&4&&$S(g,y);break;case 22:y.memoizedState===null&&as(g,y,u),Ca(y,y.return);break;case 30:break;default:as(g,y,u)}o=o.sibling}}function Tg(r,o){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&da(u))}function Eg(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&da(r))}function ci(r,o,u,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)WS(r,o,u,f),o=o.sibling}function WS(r,o,u,f){var g=o.flags;switch(o.tag){case 0:case 11:case 15:ci(r,o,u,f),g&2048&&Aa(9,o);break;case 1:ci(r,o,u,f);break;case 3:ci(r,o,u,f),g&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&da(r)));break;case 12:if(g&2048){ci(r,o,u,f),r=o.stateNode;try{var y=o.memoizedProps,S=y.id,x=y.onPostCommit;typeof x=="function"&&x(S,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(A){$e(o,o.return,A)}}else ci(r,o,u,f);break;case 31:ci(r,o,u,f);break;case 13:ci(r,o,u,f);break;case 23:break;case 22:y=o.stateNode,S=o.alternate,o.memoizedState!==null?y._visibility&2?ci(r,o,u,f):Ta(r,o):y._visibility&2?ci(r,o,u,f):(y._visibility|=2,Ll(r,o,u,f,(o.subtreeFlags&10256)!==0||!1)),g&2048&&Tg(S,o);break;case 24:ci(r,o,u,f),g&2048&&Eg(o.alternate,o);break;default:ci(r,o,u,f)}}function Ll(r,o,u,f,g){for(g=g&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var y=r,S=o,x=u,A=f,L=S.flags;switch(S.tag){case 0:case 11:case 15:Ll(y,S,x,A,g),Aa(8,S);break;case 23:break;case 22:var q=S.stateNode;S.memoizedState!==null?q._visibility&2?Ll(y,S,x,A,g):Ta(y,S):(q._visibility|=2,Ll(y,S,x,A,g)),g&&L&2048&&Tg(S.alternate,S);break;case 24:Ll(y,S,x,A,g),g&&L&2048&&Eg(S.alternate,S);break;default:Ll(y,S,x,A,g)}o=o.sibling}}function Ta(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=r,f=o,g=f.flags;switch(f.tag){case 22:Ta(u,f),g&2048&&Tg(f.alternate,f);break;case 24:Ta(u,f),g&2048&&Eg(f.alternate,f);break;default:Ta(u,f)}o=o.sibling}}var Ea=8192;function Bl(r,o,u){if(r.subtreeFlags&Ea)for(r=r.child;r!==null;)FS(r,o,u),r=r.sibling}function FS(r,o,u){switch(r.tag){case 26:Bl(r,o,u),r.flags&Ea&&r.memoizedState!==null&&wR(u,ai,r.memoizedState,r.memoizedProps);break;case 5:Bl(r,o,u);break;case 3:case 4:var f=ai;ai=ph(r.stateNode.containerInfo),Bl(r,o,u),ai=f;break;case 22:r.memoizedState===null&&(f=r.alternate,f!==null&&f.memoizedState!==null?(f=Ea,Ea=16777216,Bl(r,o,u),Ea=f):Bl(r,o,u));break;default:Bl(r,o,u)}}function YS(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Da(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];Rt=f,QS(f,r)}YS(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)XS(r),r=r.sibling}function XS(r){switch(r.tag){case 0:case 11:case 15:Da(r),r.flags&2048&&Bs(9,r,r.return);break;case 3:Da(r);break;case 12:Da(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,th(r)):Da(r);break;default:Da(r)}}function th(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];Rt=f,QS(f,r)}YS(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:Bs(8,o,o.return),th(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,th(o));break;default:th(o)}r=r.sibling}}function QS(r,o){for(;Rt!==null;){var u=Rt;switch(u.tag){case 0:case 11:case 15:Bs(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:da(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,Rt=f;else e:for(u=r;Rt!==null;){f=Rt;var g=f.sibling,y=f.return;if(HS(f),f===u){Rt=null;break e}if(g!==null){g.return=y,Rt=g;break e}Rt=y}}}var BD={getCacheForType:function(r){var o=zt(yt),u=o.data.get(r);return u===void 0&&(u=r(),o.data.set(r,u)),u},cacheSignal:function(){return zt(yt).controller.signal}},jD=typeof WeakMap=="function"?WeakMap:Map,qe=0,Ye=null,Me=null,Le=0,Ve=0,Cn=null,js=!1,jl=!1,Dg=!1,cs=0,at=0,Us=0,Rr=0,Rg=0,Tn=0,Ul=0,Ra=null,un=null,Mg=!1,nh=0,JS=0,ih=1/0,sh=null,zs=null,_t=0,Is=null,zl=null,us=0,Ng=0,Lg=null,ZS=null,Ma=0,Bg=null;function En(){return(qe&2)!==0&&Le!==0?Le&-Le:I.T!==null?Hg():gv()}function e1(){if(Tn===0)if((Le&536870912)===0||je){var r=fu;fu<<=1,(fu&3932160)===0&&(fu=262144),Tn=r}else Tn=536870912;return r=On.current,r!==null&&(r.flags|=32),Tn}function hn(r,o,u){(r===Ye&&(Ve===2||Ve===9)||r.cancelPendingCommit!==null)&&(Il(r,0),Ps(r,Le,Tn,!1)),Zo(r,u),((qe&2)===0||r!==Ye)&&(r===Ye&&((qe&2)===0&&(Rr|=u),at===4&&Ps(r,Le,Tn,!1)),Ci(r))}function t1(r,o,u){if((qe&6)!==0)throw Error(i(327));var f=!u&&(o&127)===0&&(o&r.expiredLanes)===0||Jo(r,o),g=f?ID(r,o):Ug(r,o,!0),y=f;do{if(g===0){jl&&!f&&Ps(r,o,0,!1);break}else{if(u=r.current.alternate,y&&!UD(u)){g=Ug(r,o,!1),y=!1;continue}if(g===2){if(y=o,r.errorRecoveryDisabledLanes&y)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){o=S;e:{var x=r;g=Ra;var A=x.current.memoizedState.isDehydrated;if(A&&(Il(x,S).flags|=256),S=Ug(x,S,!1),S!==2){if(Dg&&!A){x.errorRecoveryDisabledLanes|=y,Rr|=y,g=4;break e}y=un,un=g,y!==null&&(un===null?un=y:un.push.apply(un,y))}g=S}if(y=!1,g!==2)continue}}if(g===1){Il(r,0),Ps(r,o,0,!0);break}e:{switch(f=r,y=g,y){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:Ps(f,o,Tn,!js);break e;case 2:un=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(g=nh+300-wn(),10<g)){if(Ps(f,o,Tn,!js),pu(f,0,!0)!==0)break e;us=o,f.timeoutHandle=M1(n1.bind(null,f,u,un,sh,Mg,o,Tn,Rr,Ul,js,y,"Throttled",-0,0),g);break e}n1(f,u,un,sh,Mg,o,Tn,Rr,Ul,js,y,null,-0,0)}}break}while(!0);Ci(r)}function n1(r,o,u,f,g,y,S,x,A,L,q,K,j,P){if(r.timeoutHandle=-1,K=o.subtreeFlags,K&8192||(K&16785408)===16785408){K={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Yi},FS(o,y,K);var re=(y&62914560)===y?nh-wn():(y&4194048)===y?JS-wn():0;if(re=SR(K,re),re!==null){us=y,r.cancelPendingCommit=re(u1.bind(null,r,o,y,u,f,g,S,x,A,q,K,null,j,P)),Ps(r,y,S,!L);return}}u1(r,o,y,u,f,g,S,x,A)}function UD(r){for(var o=r;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var g=u[f],y=g.getSnapshot;g=g.value;try{if(!xn(y(),g))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ps(r,o,u,f){o&=~Rg,o&=~Rr,r.suspendedLanes|=o,r.pingedLanes&=~o,f&&(r.warmLanes|=o),f=r.expirationTimes;for(var g=o;0<g;){var y=31-kn(g),S=1<<y;f[y]=-1,g&=~S}u!==0&&fv(r,u,o)}function rh(){return(qe&6)===0?(Na(0),!1):!0}function jg(){if(Me!==null){if(Ve===0)var r=Me.return;else r=Me,Zi=kr=null,Jp(r),El=null,ga=0,r=Me;for(;r!==null;)NS(r.alternate,r),r=r.return;Me=null}}function Il(r,o){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,iR(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),us=0,jg(),Ye=r,Me=u=Qi(r.current,null),Le=o,Ve=0,Cn=null,js=!1,jl=Jo(r,o),Dg=!1,Ul=Tn=Rg=Rr=Us=at=0,un=Ra=null,Mg=!1,(o&8)!==0&&(o|=o&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=o;0<f;){var g=31-kn(f),y=1<<g;o|=r[g],f&=~y}return cs=o,Au(),u}function i1(r,o){ke=null,I.H=xa,o===Tl||o===Lu?(o=vw(),Ve=3):o===Pp?(o=vw(),Ve=4):Ve=o===pg?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Cn=o,Me===null&&(at=1,Fu(r,Gn(o,r.current)))}function s1(){var r=On.current;return r===null?!0:(Le&4194048)===Le?Yn===null:(Le&62914560)===Le||(Le&536870912)!==0?r===Yn:!1}function r1(){var r=I.H;return I.H=xa,r===null?xa:r}function l1(){var r=I.A;return I.A=BD,r}function lh(){at=4,js||(Le&4194048)!==Le&&On.current!==null||(jl=!0),(Us&134217727)===0&&(Rr&134217727)===0||Ye===null||Ps(Ye,Le,Tn,!1)}function Ug(r,o,u){var f=qe;qe|=2;var g=r1(),y=l1();(Ye!==r||Le!==o)&&(sh=null,Il(r,o)),o=!1;var S=at;e:do try{if(Ve!==0&&Me!==null){var x=Me,A=Cn;switch(Ve){case 8:jg(),S=6;break e;case 3:case 2:case 9:case 6:On.current===null&&(o=!0);var L=Ve;if(Ve=0,Cn=null,Pl(r,x,A,L),u&&jl){S=0;break e}break;default:L=Ve,Ve=0,Cn=null,Pl(r,x,A,L)}}zD(),S=at;break}catch(q){i1(r,q)}while(!0);return o&&r.shellSuspendCounter++,Zi=kr=null,qe=f,I.H=g,I.A=y,Me===null&&(Ye=null,Le=0,Au()),S}function zD(){for(;Me!==null;)o1(Me)}function ID(r,o){var u=qe;qe|=2;var f=r1(),g=l1();Ye!==r||Le!==o?(sh=null,ih=wn()+500,Il(r,o)):jl=Jo(r,o);e:do try{if(Ve!==0&&Me!==null){o=Me;var y=Cn;t:switch(Ve){case 1:Ve=0,Cn=null,Pl(r,o,y,1);break;case 2:case 9:if(yw(y)){Ve=0,Cn=null,a1(o);break}o=function(){Ve!==2&&Ve!==9||Ye!==r||(Ve=7),Ci(r)},y.then(o,o);break e;case 3:Ve=7;break e;case 4:Ve=5;break e;case 7:yw(y)?(Ve=0,Cn=null,a1(o)):(Ve=0,Cn=null,Pl(r,o,y,7));break;case 5:var S=null;switch(Me.tag){case 26:S=Me.memoizedState;case 5:case 27:var x=Me;if(S?W1(S):x.stateNode.complete){Ve=0,Cn=null;var A=x.sibling;if(A!==null)Me=A;else{var L=x.return;L!==null?(Me=L,oh(L)):Me=null}break t}}Ve=0,Cn=null,Pl(r,o,y,5);break;case 6:Ve=0,Cn=null,Pl(r,o,y,6);break;case 8:jg(),at=6;break e;default:throw Error(i(462))}}PD();break}catch(q){i1(r,q)}while(!0);return Zi=kr=null,I.H=f,I.A=g,qe=u,Me!==null?0:(Ye=null,Le=0,Au(),at)}function PD(){for(;Me!==null&&!c2();)o1(Me)}function o1(r){var o=RS(r.alternate,r,cs);r.memoizedProps=r.pendingProps,o===null?oh(r):Me=o}function a1(r){var o=r,u=o.alternate;switch(o.tag){case 15:case 0:o=OS(u,o,o.pendingProps,o.type,void 0,Le);break;case 11:o=OS(u,o,o.pendingProps,o.type.render,o.ref,Le);break;case 5:Jp(o);default:NS(u,o),o=Me=lw(o,cs),o=RS(u,o,cs)}r.memoizedProps=r.pendingProps,o===null?oh(r):Me=o}function Pl(r,o,u,f){Zi=kr=null,Jp(o),El=null,ga=0;var g=o.return;try{if(TD(r,g,o,u,Le)){at=1,Fu(r,Gn(u,r.current)),Me=null;return}}catch(y){if(g!==null)throw Me=g,y;at=1,Fu(r,Gn(u,r.current)),Me=null;return}o.flags&32768?(je||f===1?r=!0:jl||(Le&536870912)!==0?r=!1:(js=r=!0,(f===2||f===9||f===3||f===6)&&(f=On.current,f!==null&&f.tag===13&&(f.flags|=16384))),c1(o,r)):oh(o)}function oh(r){var o=r;do{if((o.flags&32768)!==0){c1(o,js);return}r=o.return;var u=RD(o.alternate,o,cs);if(u!==null){Me=u;return}if(o=o.sibling,o!==null){Me=o;return}Me=o=r}while(o!==null);at===0&&(at=5)}function c1(r,o){do{var u=MD(r.alternate,r);if(u!==null){u.flags&=32767,Me=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(r=r.sibling,r!==null)){Me=r;return}Me=r=u}while(r!==null);at=6,Me=null}function u1(r,o,u,f,g,y,S,x,A){r.cancelPendingCommit=null;do ah();while(_t!==0);if((qe&6)!==0)throw Error(i(327));if(o!==null){if(o===r.current)throw Error(i(177));if(y=o.lanes|o.childLanes,y|=Op,v2(r,u,y,S,x,A),r===Ye&&(Me=Ye=null,Le=0),zl=o,Is=r,us=u,Ng=y,Lg=g,ZS=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,$D(uu,function(){return g1(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=I.T,I.T=null,g=F.p,F.p=2,S=qe,qe|=4;try{ND(r,o,u)}finally{qe=S,F.p=g,I.T=f}}_t=1,h1(),f1(),d1()}}function h1(){if(_t===1){_t=0;var r=Is,o=zl,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=I.T,I.T=null;var f=F.p;F.p=2;var g=qe;qe|=4;try{GS(o,r);var y=Yg,S=Qv(r.containerInfo),x=y.focusedElem,A=y.selectionRange;if(S!==x&&x&&x.ownerDocument&&Xv(x.ownerDocument.documentElement,x)){if(A!==null&&wp(x)){var L=A.start,q=A.end;if(q===void 0&&(q=L),"selectionStart"in x)x.selectionStart=L,x.selectionEnd=Math.min(q,x.value.length);else{var K=x.ownerDocument||document,j=K&&K.defaultView||window;if(j.getSelection){var P=j.getSelection(),re=x.textContent.length,ge=Math.min(A.start,re),We=A.end===void 0?ge:Math.min(A.end,re);!P.extend&&ge>We&&(S=We,We=ge,ge=S);var M=Yv(x,ge),E=Yv(x,We);if(M&&E&&(P.rangeCount!==1||P.anchorNode!==M.node||P.anchorOffset!==M.offset||P.focusNode!==E.node||P.focusOffset!==E.offset)){var N=K.createRange();N.setStart(M.node,M.offset),P.removeAllRanges(),ge>We?(P.addRange(N),P.extend(E.node,E.offset)):(N.setEnd(E.node,E.offset),P.addRange(N))}}}}for(K=[],P=x;P=P.parentNode;)P.nodeType===1&&K.push({element:P,left:P.scrollLeft,top:P.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<K.length;x++){var $=K[x];$.element.scrollLeft=$.left,$.element.scrollTop=$.top}}wh=!!Fg,Yg=Fg=null}finally{qe=g,F.p=f,I.T=u}}r.current=o,_t=2}}function f1(){if(_t===2){_t=0;var r=Is,o=zl,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=I.T,I.T=null;var f=F.p;F.p=2;var g=qe;qe|=4;try{PS(r,o.alternate,o)}finally{qe=g,F.p=f,I.T=u}}_t=3}}function d1(){if(_t===4||_t===3){_t=0,u2();var r=Is,o=zl,u=us,f=ZS;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?_t=5:(_t=0,zl=Is=null,p1(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(zs=null),tp(u),o=o.stateNode,Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(Qo,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=I.T,g=F.p,F.p=2,I.T=null;try{for(var y=r.onRecoverableError,S=0;S<f.length;S++){var x=f[S];y(x.value,{componentStack:x.stack})}}finally{I.T=o,F.p=g}}(us&3)!==0&&ah(),Ci(r),g=r.pendingLanes,(u&261930)!==0&&(g&42)!==0?r===Bg?Ma++:(Ma=0,Bg=r):Ma=0,Na(0)}}function p1(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,da(o)))}function ah(){return h1(),f1(),d1(),g1()}function g1(){if(_t!==5)return!1;var r=Is,o=Ng;Ng=0;var u=tp(us),f=I.T,g=F.p;try{F.p=32>u?32:u,I.T=null,u=Lg,Lg=null;var y=Is,S=us;if(_t=0,zl=Is=null,us=0,(qe&6)!==0)throw Error(i(331));var x=qe;if(qe|=4,XS(y.current),WS(y,y.current,S,u),qe=x,Na(0,!1),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(Qo,y)}catch{}return!0}finally{F.p=g,I.T=f,p1(r,o)}}function m1(r,o,u){o=Gn(u,o),o=dg(r.stateNode,o,2),r=Ms(r,o,2),r!==null&&(Zo(r,2),Ci(r))}function $e(r,o,u){if(r.tag===3)m1(r,r,u);else for(;o!==null;){if(o.tag===3){m1(o,r,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(zs===null||!zs.has(f))){r=Gn(u,r),u=yS(2),f=Ms(o,u,2),f!==null&&(bS(u,f,o,r),Zo(f,2),Ci(f));break}}o=o.return}}function zg(r,o,u){var f=r.pingCache;if(f===null){f=r.pingCache=new jD;var g=new Set;f.set(o,g)}else g=f.get(o),g===void 0&&(g=new Set,f.set(o,g));g.has(u)||(Dg=!0,g.add(u),r=HD.bind(null,r,o,u),o.then(r,r))}function HD(r,o,u){var f=r.pingCache;f!==null&&f.delete(o),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,Ye===r&&(Le&u)===u&&(at===4||at===3&&(Le&62914560)===Le&&300>wn()-nh?(qe&2)===0&&Il(r,0):Rg|=u,Ul===Le&&(Ul=0)),Ci(r)}function y1(r,o){o===0&&(o=hv()),r=vr(r,o),r!==null&&(Zo(r,o),Ci(r))}function qD(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),y1(r,u)}function VD(r,o){var u=0;switch(r.tag){case 31:case 13:var f=r.stateNode,g=r.memoizedState;g!==null&&(u=g.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(i(314))}f!==null&&f.delete(o),y1(r,u)}function $D(r,o){return Qd(r,o)}var ch=null,Hl=null,Ig=!1,uh=!1,Pg=!1,Hs=0;function Ci(r){r!==Hl&&r.next===null&&(Hl===null?ch=Hl=r:Hl=Hl.next=r),uh=!0,Ig||(Ig=!0,KD())}function Na(r,o){if(!Pg&&uh){Pg=!0;do for(var u=!1,f=ch;f!==null;){if(r!==0){var g=f.pendingLanes;if(g===0)var y=0;else{var S=f.suspendedLanes,x=f.pingedLanes;y=(1<<31-kn(42|r)+1)-1,y&=g&~(S&~x),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(u=!0,S1(f,y))}else y=Le,y=pu(f,f===Ye?y:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(y&3)===0||Jo(f,y)||(u=!0,S1(f,y));f=f.next}while(u);Pg=!1}}function GD(){b1()}function b1(){uh=Ig=!1;var r=0;Hs!==0&&nR()&&(r=Hs);for(var o=wn(),u=null,f=ch;f!==null;){var g=f.next,y=v1(f,o);y===0?(f.next=null,u===null?ch=g:u.next=g,g===null&&(Hl=u)):(u=f,(r!==0||(y&3)!==0)&&(uh=!0)),f=g}_t!==0&&_t!==5||Na(r),Hs!==0&&(Hs=0)}function v1(r,o){for(var u=r.suspendedLanes,f=r.pingedLanes,g=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var S=31-kn(y),x=1<<S,A=g[S];A===-1?((x&u)===0||(x&f)!==0)&&(g[S]=b2(x,o)):A<=o&&(r.expiredLanes|=x),y&=~x}if(o=Ye,u=Le,u=pu(r,r===o?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,u===0||r===o&&(Ve===2||Ve===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&Jd(f),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||Jo(r,u)){if(o=u&-u,o===r.callbackPriority)return o;switch(f!==null&&Jd(f),tp(u)){case 2:case 8:u=cv;break;case 32:u=uu;break;case 268435456:u=uv;break;default:u=uu}return f=w1.bind(null,r),u=Qd(u,f),r.callbackPriority=o,r.callbackNode=u,o}return f!==null&&f!==null&&Jd(f),r.callbackPriority=2,r.callbackNode=null,2}function w1(r,o){if(_t!==0&&_t!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(ah()&&r.callbackNode!==u)return null;var f=Le;return f=pu(r,r===Ye?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(t1(r,f,o),v1(r,wn()),r.callbackNode!=null&&r.callbackNode===u?w1.bind(null,r):null)}function S1(r,o){if(ah())return null;t1(r,o,!0)}function KD(){sR(function(){(qe&6)!==0?Qd(av,GD):b1()})}function Hg(){if(Hs===0){var r=Al;r===0&&(r=hu,hu<<=1,(hu&261888)===0&&(hu=256)),Hs=r}return Hs}function k1(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:bu(""+r)}function x1(r,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,r.id&&u.setAttribute("form",r.id),o.parentNode.insertBefore(u,o),r=new FormData(r),u.parentNode.removeChild(u),r}function WD(r,o,u,f,g){if(o==="submit"&&u&&u.stateNode===g){var y=k1((g[rn]||null).action),S=f.submitter;S&&(o=(o=S[rn]||null)?k1(o.formAction):S.getAttribute("formAction"),o!==null&&(y=o,S=null));var x=new ku("action","action",null,f,g);r.push({event:x,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Hs!==0){var A=S?x1(g,S):new FormData(g);og(u,{pending:!0,data:A,method:g.method,action:y},null,A)}}else typeof y=="function"&&(x.preventDefault(),A=S?x1(g,S):new FormData(g),og(u,{pending:!0,data:A,method:g.method,action:y},y,A))},currentTarget:g}]})}}for(var qg=0;qg<_p.length;qg++){var Vg=_p[qg],FD=Vg.toLowerCase(),YD=Vg[0].toUpperCase()+Vg.slice(1);oi(FD,"on"+YD)}oi(ew,"onAnimationEnd"),oi(tw,"onAnimationIteration"),oi(nw,"onAnimationStart"),oi("dblclick","onDoubleClick"),oi("focusin","onFocus"),oi("focusout","onBlur"),oi(hD,"onTransitionRun"),oi(fD,"onTransitionStart"),oi(dD,"onTransitionCancel"),oi(iw,"onTransitionEnd"),fl("onMouseEnter",["mouseout","mouseover"]),fl("onMouseLeave",["mouseout","mouseover"]),fl("onPointerEnter",["pointerout","pointerover"]),fl("onPointerLeave",["pointerout","pointerover"]),gr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),gr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),gr("onBeforeInput",["compositionend","keypress","textInput","paste"]),gr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),gr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),gr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var La="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(La));function _1(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var f=r[u],g=f.event;f=f.listeners;e:{var y=void 0;if(o)for(var S=f.length-1;0<=S;S--){var x=f[S],A=x.instance,L=x.currentTarget;if(x=x.listener,A!==y&&g.isPropagationStopped())break e;y=x,g.currentTarget=L;try{y(g)}catch(q){Ou(q)}g.currentTarget=null,y=A}else for(S=0;S<f.length;S++){if(x=f[S],A=x.instance,L=x.currentTarget,x=x.listener,A!==y&&g.isPropagationStopped())break e;y=x,g.currentTarget=L;try{y(g)}catch(q){Ou(q)}g.currentTarget=null,y=A}}}}function Ne(r,o){var u=o[np];u===void 0&&(u=o[np]=new Set);var f=r+"__bubble";u.has(f)||(O1(o,r,2,!1),u.add(f))}function $g(r,o,u){var f=0;o&&(f|=4),O1(u,r,f,o)}var hh="_reactListening"+Math.random().toString(36).slice(2);function Gg(r){if(!r[hh]){r[hh]=!0,bv.forEach(function(u){u!=="selectionchange"&&(XD.has(u)||$g(u,!1,r),$g(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[hh]||(o[hh]=!0,$g("selectionchange",!1,o))}}function O1(r,o,u,f){switch(ek(o)){case 2:var g=_R;break;case 8:g=OR;break;default:g=lm}u=g.bind(null,o,u,r),g=void 0,!hp||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),f?g!==void 0?r.addEventListener(o,u,{capture:!0,passive:g}):r.addEventListener(o,u,!0):g!==void 0?r.addEventListener(o,u,{passive:g}):r.addEventListener(o,u,!1)}function Kg(r,o,u,f,g){var y=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var x=f.stateNode.containerInfo;if(x===g)break;if(S===4)for(S=f.return;S!==null;){var A=S.tag;if((A===3||A===4)&&S.stateNode.containerInfo===g)return;S=S.return}for(;x!==null;){if(S=cl(x),S===null)return;if(A=S.tag,A===5||A===6||A===26||A===27){f=y=S;continue e}x=x.parentNode}}f=f.return}Dv(function(){var L=y,q=cp(u),K=[];e:{var j=sw.get(r);if(j!==void 0){var P=ku,re=r;switch(r){case"keypress":if(wu(u)===0)break e;case"keydown":case"keyup":P=V2;break;case"focusin":re="focus",P=gp;break;case"focusout":re="blur",P=gp;break;case"beforeblur":case"afterblur":P=gp;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":P=Nv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":P=R2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":P=K2;break;case ew:case tw:case nw:P=L2;break;case iw:P=F2;break;case"scroll":case"scrollend":P=E2;break;case"wheel":P=X2;break;case"copy":case"cut":case"paste":P=j2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":P=Bv;break;case"toggle":case"beforetoggle":P=J2}var ge=(o&4)!==0,We=!ge&&(r==="scroll"||r==="scrollend"),M=ge?j!==null?j+"Capture":null:j;ge=[];for(var E=L,N;E!==null;){var $=E;if(N=$.stateNode,$=$.tag,$!==5&&$!==26&&$!==27||N===null||M===null||($=na(E,M),$!=null&&ge.push(Ba(E,$,N))),We)break;E=E.return}0<ge.length&&(j=new P(j,re,null,u,q),K.push({event:j,listeners:ge}))}}if((o&7)===0){e:{if(j=r==="mouseover"||r==="pointerover",P=r==="mouseout"||r==="pointerout",j&&u!==ap&&(re=u.relatedTarget||u.fromElement)&&(cl(re)||re[al]))break e;if((P||j)&&(j=q.window===q?q:(j=q.ownerDocument)?j.defaultView||j.parentWindow:window,P?(re=u.relatedTarget||u.toElement,P=L,re=re?cl(re):null,re!==null&&(We=l(re),ge=re.tag,re!==We||ge!==5&&ge!==27&&ge!==6)&&(re=null)):(P=null,re=L),P!==re)){if(ge=Nv,$="onMouseLeave",M="onMouseEnter",E="mouse",(r==="pointerout"||r==="pointerover")&&(ge=Bv,$="onPointerLeave",M="onPointerEnter",E="pointer"),We=P==null?j:ta(P),N=re==null?j:ta(re),j=new ge($,E+"leave",P,u,q),j.target=We,j.relatedTarget=N,$=null,cl(q)===L&&(ge=new ge(M,E+"enter",re,u,q),ge.target=N,ge.relatedTarget=We,$=ge),We=$,P&&re)t:{for(ge=QD,M=P,E=re,N=0,$=M;$;$=ge($))N++;$=0;for(var fe=E;fe;fe=ge(fe))$++;for(;0<N-$;)M=ge(M),N--;for(;0<$-N;)E=ge(E),$--;for(;N--;){if(M===E||E!==null&&M===E.alternate){ge=M;break t}M=ge(M),E=ge(E)}ge=null}else ge=null;P!==null&&A1(K,j,P,ge,!1),re!==null&&We!==null&&A1(K,We,re,ge,!0)}}e:{if(j=L?ta(L):window,P=j.nodeName&&j.nodeName.toLowerCase(),P==="select"||P==="input"&&j.type==="file")var Ie=Vv;else if(Hv(j))if($v)Ie=aD;else{Ie=lD;var le=rD}else P=j.nodeName,!P||P.toLowerCase()!=="input"||j.type!=="checkbox"&&j.type!=="radio"?L&&op(L.elementType)&&(Ie=Vv):Ie=oD;if(Ie&&(Ie=Ie(r,L))){qv(K,Ie,u,q);break e}le&&le(r,j,L),r==="focusout"&&L&&j.type==="number"&&L.memoizedProps.value!=null&&lp(j,"number",j.value)}switch(le=L?ta(L):window,r){case"focusin":(Hv(le)||le.contentEditable==="true")&&(bl=le,Sp=L,ua=null);break;case"focusout":ua=Sp=bl=null;break;case"mousedown":kp=!0;break;case"contextmenu":case"mouseup":case"dragend":kp=!1,Jv(K,u,q);break;case"selectionchange":if(uD)break;case"keydown":case"keyup":Jv(K,u,q)}var Oe;if(yp)e:{switch(r){case"compositionstart":var Be="onCompositionStart";break e;case"compositionend":Be="onCompositionEnd";break e;case"compositionupdate":Be="onCompositionUpdate";break e}Be=void 0}else yl?Iv(r,u)&&(Be="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Be="onCompositionStart");Be&&(jv&&u.locale!=="ko"&&(yl||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&yl&&(Oe=Rv()):(Os=q,fp="value"in Os?Os.value:Os.textContent,yl=!0)),le=fh(L,Be),0<le.length&&(Be=new Lv(Be,r,null,u,q),K.push({event:Be,listeners:le}),Oe?Be.data=Oe:(Oe=Pv(u),Oe!==null&&(Be.data=Oe)))),(Oe=eD?tD(r,u):nD(r,u))&&(Be=fh(L,"onBeforeInput"),0<Be.length&&(le=new Lv("onBeforeInput","beforeinput",null,u,q),K.push({event:le,listeners:Be}),le.data=Oe)),WD(K,r,L,u,q)}_1(K,o)})}function Ba(r,o,u){return{instance:r,listener:o,currentTarget:u}}function fh(r,o){for(var u=o+"Capture",f=[];r!==null;){var g=r,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=na(r,u),g!=null&&f.unshift(Ba(r,g,y)),g=na(r,o),g!=null&&f.push(Ba(r,g,y))),r.tag===3)return f;r=r.return}return[]}function QD(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function A1(r,o,u,f,g){for(var y=o._reactName,S=[];u!==null&&u!==f;){var x=u,A=x.alternate,L=x.stateNode;if(x=x.tag,A!==null&&A===f)break;x!==5&&x!==26&&x!==27||L===null||(A=L,g?(L=na(u,y),L!=null&&S.unshift(Ba(u,L,A))):g||(L=na(u,y),L!=null&&S.push(Ba(u,L,A)))),u=u.return}S.length!==0&&r.push({event:o,listeners:S})}var JD=/\r\n?/g,ZD=/\u0000|\uFFFD/g;function C1(r){return(typeof r=="string"?r:""+r).replace(JD,`
`).replace(ZD,"")}function T1(r,o){return o=C1(o),C1(r)===o}function Ke(r,o,u,f,g,y){switch(u){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||pl(r,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&pl(r,""+f);break;case"className":mu(r,"class",f);break;case"tabIndex":mu(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":mu(r,u,f);break;case"style":Tv(r,f,y);break;case"data":if(o!=="object"){mu(r,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||u!=="href")){r.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=bu(""+f),r.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(u==="formAction"?(o!=="input"&&Ke(r,o,"name",g.name,g,null),Ke(r,o,"formEncType",g.formEncType,g,null),Ke(r,o,"formMethod",g.formMethod,g,null),Ke(r,o,"formTarget",g.formTarget,g,null)):(Ke(r,o,"encType",g.encType,g,null),Ke(r,o,"method",g.method,g,null),Ke(r,o,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=bu(""+f),r.setAttribute(u,f);break;case"onClick":f!=null&&(r.onclick=Yi);break;case"onScroll":f!=null&&Ne("scroll",r);break;case"onScrollEnd":f!=null&&Ne("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(u=f.__html,u!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=u}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}u=bu(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""+f):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":f===!0?r.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,f):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(u,f):r.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(u):r.setAttribute(u,f);break;case"popover":Ne("beforetoggle",r),Ne("toggle",r),gu(r,"popover",f);break;case"xlinkActuate":Fi(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Fi(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Fi(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Fi(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Fi(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Fi(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Fi(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Fi(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Fi(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":gu(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=C2.get(u)||u,gu(r,u,f))}}function Wg(r,o,u,f,g,y){switch(u){case"style":Tv(r,f,y);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(u=f.__html,u!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=u}}break;case"children":typeof f=="string"?pl(r,f):(typeof f=="number"||typeof f=="bigint")&&pl(r,""+f);break;case"onScroll":f!=null&&Ne("scroll",r);break;case"onScrollEnd":f!=null&&Ne("scrollend",r);break;case"onClick":f!=null&&(r.onclick=Yi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!vv.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(g=u.endsWith("Capture"),o=u.slice(2,g?u.length-7:void 0),y=r[rn]||null,y=y!=null?y[u]:null,typeof y=="function"&&r.removeEventListener(o,y,g),typeof f=="function")){typeof y!="function"&&y!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(o,f,g);break e}u in r?r[u]=f:f===!0?r.setAttribute(u,""):gu(r,u,f)}}}function Pt(r,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ne("error",r),Ne("load",r);var f=!1,g=!1,y;for(y in u)if(u.hasOwnProperty(y)){var S=u[y];if(S!=null)switch(y){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Ke(r,o,y,S,u,null)}}g&&Ke(r,o,"srcSet",u.srcSet,u,null),f&&Ke(r,o,"src",u.src,u,null);return;case"input":Ne("invalid",r);var x=y=S=g=null,A=null,L=null;for(f in u)if(u.hasOwnProperty(f)){var q=u[f];if(q!=null)switch(f){case"name":g=q;break;case"type":S=q;break;case"checked":A=q;break;case"defaultChecked":L=q;break;case"value":y=q;break;case"defaultValue":x=q;break;case"children":case"dangerouslySetInnerHTML":if(q!=null)throw Error(i(137,o));break;default:Ke(r,o,f,q,u,null)}}_v(r,y,x,A,L,S,g,!1);return;case"select":Ne("invalid",r),f=S=y=null;for(g in u)if(u.hasOwnProperty(g)&&(x=u[g],x!=null))switch(g){case"value":y=x;break;case"defaultValue":S=x;break;case"multiple":f=x;default:Ke(r,o,g,x,u,null)}o=y,u=S,r.multiple=!!f,o!=null?dl(r,!!f,o,!1):u!=null&&dl(r,!!f,u,!0);return;case"textarea":Ne("invalid",r),y=g=f=null;for(S in u)if(u.hasOwnProperty(S)&&(x=u[S],x!=null))switch(S){case"value":f=x;break;case"defaultValue":g=x;break;case"children":y=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(i(91));break;default:Ke(r,o,S,x,u,null)}Av(r,f,g,y);return;case"option":for(A in u)u.hasOwnProperty(A)&&(f=u[A],f!=null)&&(A==="selected"?r.selected=f&&typeof f!="function"&&typeof f!="symbol":Ke(r,o,A,f,u,null));return;case"dialog":Ne("beforetoggle",r),Ne("toggle",r),Ne("cancel",r),Ne("close",r);break;case"iframe":case"object":Ne("load",r);break;case"video":case"audio":for(f=0;f<La.length;f++)Ne(La[f],r);break;case"image":Ne("error",r),Ne("load",r);break;case"details":Ne("toggle",r);break;case"embed":case"source":case"link":Ne("error",r),Ne("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(L in u)if(u.hasOwnProperty(L)&&(f=u[L],f!=null))switch(L){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Ke(r,o,L,f,u,null)}return;default:if(op(o)){for(q in u)u.hasOwnProperty(q)&&(f=u[q],f!==void 0&&Wg(r,o,q,f,u,void 0));return}}for(x in u)u.hasOwnProperty(x)&&(f=u[x],f!=null&&Ke(r,o,x,f,u,null))}function eR(r,o,u,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,S=null,x=null,A=null,L=null,q=null;for(P in u){var K=u[P];if(u.hasOwnProperty(P)&&K!=null)switch(P){case"checked":break;case"value":break;case"defaultValue":A=K;default:f.hasOwnProperty(P)||Ke(r,o,P,null,f,K)}}for(var j in f){var P=f[j];if(K=u[j],f.hasOwnProperty(j)&&(P!=null||K!=null))switch(j){case"type":y=P;break;case"name":g=P;break;case"checked":L=P;break;case"defaultChecked":q=P;break;case"value":S=P;break;case"defaultValue":x=P;break;case"children":case"dangerouslySetInnerHTML":if(P!=null)throw Error(i(137,o));break;default:P!==K&&Ke(r,o,j,P,f,K)}}rp(r,S,x,A,L,q,y,g);return;case"select":P=S=x=j=null;for(y in u)if(A=u[y],u.hasOwnProperty(y)&&A!=null)switch(y){case"value":break;case"multiple":P=A;default:f.hasOwnProperty(y)||Ke(r,o,y,null,f,A)}for(g in f)if(y=f[g],A=u[g],f.hasOwnProperty(g)&&(y!=null||A!=null))switch(g){case"value":j=y;break;case"defaultValue":x=y;break;case"multiple":S=y;default:y!==A&&Ke(r,o,g,y,f,A)}o=x,u=S,f=P,j!=null?dl(r,!!u,j,!1):!!f!=!!u&&(o!=null?dl(r,!!u,o,!0):dl(r,!!u,u?[]:"",!1));return;case"textarea":P=j=null;for(x in u)if(g=u[x],u.hasOwnProperty(x)&&g!=null&&!f.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:Ke(r,o,x,null,f,g)}for(S in f)if(g=f[S],y=u[S],f.hasOwnProperty(S)&&(g!=null||y!=null))switch(S){case"value":j=g;break;case"defaultValue":P=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==y&&Ke(r,o,S,g,f,y)}Ov(r,j,P);return;case"option":for(var re in u)j=u[re],u.hasOwnProperty(re)&&j!=null&&!f.hasOwnProperty(re)&&(re==="selected"?r.selected=!1:Ke(r,o,re,null,f,j));for(A in f)j=f[A],P=u[A],f.hasOwnProperty(A)&&j!==P&&(j!=null||P!=null)&&(A==="selected"?r.selected=j&&typeof j!="function"&&typeof j!="symbol":Ke(r,o,A,j,f,P));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ge in u)j=u[ge],u.hasOwnProperty(ge)&&j!=null&&!f.hasOwnProperty(ge)&&Ke(r,o,ge,null,f,j);for(L in f)if(j=f[L],P=u[L],f.hasOwnProperty(L)&&j!==P&&(j!=null||P!=null))switch(L){case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(i(137,o));break;default:Ke(r,o,L,j,f,P)}return;default:if(op(o)){for(var We in u)j=u[We],u.hasOwnProperty(We)&&j!==void 0&&!f.hasOwnProperty(We)&&Wg(r,o,We,void 0,f,j);for(q in f)j=f[q],P=u[q],!f.hasOwnProperty(q)||j===P||j===void 0&&P===void 0||Wg(r,o,q,j,f,P);return}}for(var M in u)j=u[M],u.hasOwnProperty(M)&&j!=null&&!f.hasOwnProperty(M)&&Ke(r,o,M,null,f,j);for(K in f)j=f[K],P=u[K],!f.hasOwnProperty(K)||j===P||j==null&&P==null||Ke(r,o,K,j,f,P)}function E1(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tR(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var g=u[f],y=g.transferSize,S=g.initiatorType,x=g.duration;if(y&&x&&E1(S)){for(S=0,x=g.responseEnd,f+=1;f<u.length;f++){var A=u[f],L=A.startTime;if(L>x)break;var q=A.transferSize,K=A.initiatorType;q&&E1(K)&&(A=A.responseEnd,S+=q*(A<x?1:(x-L)/(A-L)))}if(--f,o+=8*(y+S)/(g.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Fg=null,Yg=null;function dh(r){return r.nodeType===9?r:r.ownerDocument}function D1(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function R1(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function Xg(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Qg=null;function nR(){var r=window.event;return r&&r.type==="popstate"?r===Qg?!1:(Qg=r,!0):(Qg=null,!1)}var M1=typeof setTimeout=="function"?setTimeout:void 0,iR=typeof clearTimeout=="function"?clearTimeout:void 0,N1=typeof Promise=="function"?Promise:void 0,sR=typeof queueMicrotask=="function"?queueMicrotask:typeof N1<"u"?function(r){return N1.resolve(null).then(r).catch(rR)}:M1;function rR(r){setTimeout(function(){throw r})}function qs(r){return r==="head"}function L1(r,o){var u=o,f=0;do{var g=u.nextSibling;if(r.removeChild(u),g&&g.nodeType===8)if(u=g.data,u==="/$"||u==="/&"){if(f===0){r.removeChild(g),Gl(o);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")ja(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,ja(u);for(var y=u.firstChild;y;){var S=y.nextSibling,x=y.nodeName;y[ea]||x==="SCRIPT"||x==="STYLE"||x==="LINK"&&y.rel.toLowerCase()==="stylesheet"||u.removeChild(y),y=S}}else u==="body"&&ja(r.ownerDocument.body);u=g}while(u);Gl(o)}function B1(r,o){var u=r;r=0;do{var f=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=f}while(u)}function Jg(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Jg(u),ip(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function lR(r,o,u,f){for(;r.nodeType===1;){var g=u;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[ea])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=Xn(r.nextSibling),r===null)break}return null}function oR(r,o,u){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Xn(r.nextSibling),r===null))return null;return r}function j1(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Xn(r.nextSibling),r===null))return null;return r}function Zg(r){return r.data==="$?"||r.data==="$~"}function em(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function aR(r,o){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||u.readyState!=="loading")o();else{var f=function(){o(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function Xn(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var tm=null;function U1(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(o===0)return Xn(r.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}r=r.nextSibling}return null}function z1(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return r;o--}else u!=="/$"&&u!=="/&"||o++}r=r.previousSibling}return null}function I1(r,o,u){switch(o=dh(u),r){case"html":if(r=o.documentElement,!r)throw Error(i(452));return r;case"head":if(r=o.head,!r)throw Error(i(453));return r;case"body":if(r=o.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function ja(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);ip(r)}var Qn=new Map,P1=new Set;function ph(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var hs=F.d;F.d={f:cR,r:uR,D:hR,C:fR,L:dR,m:pR,X:mR,S:gR,M:yR};function cR(){var r=hs.f(),o=rh();return r||o}function uR(r){var o=ul(r);o!==null&&o.tag===5&&o.type==="form"?iS(o):hs.r(r)}var ql=typeof document>"u"?null:document;function H1(r,o,u){var f=ql;if(f&&typeof o=="string"&&o){var g=Vn(o);g='link[rel="'+r+'"][href="'+g+'"]',typeof u=="string"&&(g+='[crossorigin="'+u+'"]'),P1.has(g)||(P1.add(g),r={rel:r,crossOrigin:u,href:o},f.querySelector(g)===null&&(o=f.createElement("link"),Pt(o,"link",r),Dt(o),f.head.appendChild(o)))}}function hR(r){hs.D(r),H1("dns-prefetch",r,null)}function fR(r,o){hs.C(r,o),H1("preconnect",r,o)}function dR(r,o,u){hs.L(r,o,u);var f=ql;if(f&&r&&o){var g='link[rel="preload"][as="'+Vn(o)+'"]';o==="image"&&u&&u.imageSrcSet?(g+='[imagesrcset="'+Vn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(g+='[imagesizes="'+Vn(u.imageSizes)+'"]')):g+='[href="'+Vn(r)+'"]';var y=g;switch(o){case"style":y=Vl(r);break;case"script":y=$l(r)}Qn.has(y)||(r=m({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:r,as:o},u),Qn.set(y,r),f.querySelector(g)!==null||o==="style"&&f.querySelector(Ua(y))||o==="script"&&f.querySelector(za(y))||(o=f.createElement("link"),Pt(o,"link",r),Dt(o),f.head.appendChild(o)))}}function pR(r,o){hs.m(r,o);var u=ql;if(u&&r){var f=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+Vn(f)+'"][href="'+Vn(r)+'"]',y=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=$l(r)}if(!Qn.has(y)&&(r=m({rel:"modulepreload",href:r},o),Qn.set(y,r),u.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(za(y)))return}f=u.createElement("link"),Pt(f,"link",r),Dt(f),u.head.appendChild(f)}}}function gR(r,o,u){hs.S(r,o,u);var f=ql;if(f&&r){var g=hl(f).hoistableStyles,y=Vl(r);o=o||"default";var S=g.get(y);if(!S){var x={loading:0,preload:null};if(S=f.querySelector(Ua(y)))x.loading=5;else{r=m({rel:"stylesheet",href:r,"data-precedence":o},u),(u=Qn.get(y))&&nm(r,u);var A=S=f.createElement("link");Dt(A),Pt(A,"link",r),A._p=new Promise(function(L,q){A.onload=L,A.onerror=q}),A.addEventListener("load",function(){x.loading|=1}),A.addEventListener("error",function(){x.loading|=2}),x.loading|=4,gh(S,o,f)}S={type:"stylesheet",instance:S,count:1,state:x},g.set(y,S)}}}function mR(r,o){hs.X(r,o);var u=ql;if(u&&r){var f=hl(u).hoistableScripts,g=$l(r),y=f.get(g);y||(y=u.querySelector(za(g)),y||(r=m({src:r,async:!0},o),(o=Qn.get(g))&&im(r,o),y=u.createElement("script"),Dt(y),Pt(y,"link",r),u.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(g,y))}}function yR(r,o){hs.M(r,o);var u=ql;if(u&&r){var f=hl(u).hoistableScripts,g=$l(r),y=f.get(g);y||(y=u.querySelector(za(g)),y||(r=m({src:r,async:!0,type:"module"},o),(o=Qn.get(g))&&im(r,o),y=u.createElement("script"),Dt(y),Pt(y,"link",r),u.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(g,y))}}function q1(r,o,u,f){var g=(g=Se.current)?ph(g):null;if(!g)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Vl(u.href),u=hl(g).hoistableStyles,f=u.get(o),f||(f={type:"style",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=Vl(u.href);var y=hl(g).hoistableStyles,S=y.get(r);if(S||(g=g.ownerDocument||g,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,S),(y=g.querySelector(Ua(r)))&&!y._p&&(S.instance=y,S.state.loading=5),Qn.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Qn.set(r,u),y||bR(g,r,u,S.state))),o&&f===null)throw Error(i(528,""));return S}if(o&&f!==null)throw Error(i(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=$l(u),u=hl(g).hoistableScripts,f=u.get(o),f||(f={type:"script",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Vl(r){return'href="'+Vn(r)+'"'}function Ua(r){return'link[rel="stylesheet"]['+r+"]"}function V1(r){return m({},r,{"data-precedence":r.precedence,precedence:null})}function bR(r,o,u,f){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=r.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),Pt(o,"link",u),Dt(o),r.head.appendChild(o))}function $l(r){return'[src="'+Vn(r)+'"]'}function za(r){return"script[async]"+r}function $1(r,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var f=r.querySelector('style[data-href~="'+Vn(u.href)+'"]');if(f)return o.instance=f,Dt(f),f;var g=m({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),Dt(f),Pt(f,"style",g),gh(f,u.precedence,r),o.instance=f;case"stylesheet":g=Vl(u.href);var y=r.querySelector(Ua(g));if(y)return o.state.loading|=4,o.instance=y,Dt(y),y;f=V1(u),(g=Qn.get(g))&&nm(f,g),y=(r.ownerDocument||r).createElement("link"),Dt(y);var S=y;return S._p=new Promise(function(x,A){S.onload=x,S.onerror=A}),Pt(y,"link",f),o.state.loading|=4,gh(y,u.precedence,r),o.instance=y;case"script":return y=$l(u.src),(g=r.querySelector(za(y)))?(o.instance=g,Dt(g),g):(f=u,(g=Qn.get(y))&&(f=m({},u),im(f,g)),r=r.ownerDocument||r,g=r.createElement("script"),Dt(g),Pt(g,"link",f),r.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,gh(f,u.precedence,r));return o.instance}function gh(r,o,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,y=g,S=0;S<f.length;S++){var x=f[S];if(x.dataset.precedence===o)y=x;else if(y!==g)break}y?y.parentNode.insertBefore(r,y.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(r,o.firstChild))}function nm(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function im(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var mh=null;function G1(r,o,u){if(mh===null){var f=new Map,g=mh=new Map;g.set(u,f)}else g=mh,f=g.get(u),f||(f=new Map,g.set(u,f));if(f.has(r))return f;for(f.set(r,null),u=u.getElementsByTagName(r),g=0;g<u.length;g++){var y=u[g];if(!(y[ea]||y[jt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var S=y.getAttribute(o)||"";S=r+S;var x=f.get(S);x?x.push(y):f.set(S,[y])}}return f}function K1(r,o,u){r=r.ownerDocument||r,r.head.insertBefore(u,o==="title"?r.querySelector("head > title"):null)}function vR(r,o,u){if(u===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(r=o.disabled,typeof o.precedence=="string"&&r==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function W1(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function wR(r,o,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var g=Vl(f.href),y=o.querySelector(Ua(g));if(y){o=y._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=yh.bind(r),o.then(r,r)),u.state.loading|=4,u.instance=y,Dt(y);return}y=o.ownerDocument||o,f=V1(f),(g=Qn.get(g))&&nm(f,g),y=y.createElement("link"),Dt(y);var S=y;S._p=new Promise(function(x,A){S.onload=x,S.onerror=A}),Pt(y,"link",f),u.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=yh.bind(r),o.addEventListener("load",u),o.addEventListener("error",u))}}var sm=0;function SR(r,o){return r.stylesheets&&r.count===0&&vh(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var f=setTimeout(function(){if(r.stylesheets&&vh(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+o);0<r.imgBytes&&sm===0&&(sm=62500*tR());var g=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&vh(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>sm?50:800)+o);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(f),clearTimeout(g)}}:null}function yh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)vh(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var bh=null;function vh(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,bh=new Map,o.forEach(kR,r),bh=null,yh.call(r))}function kR(r,o){if(!(o.state.loading&4)){var u=bh.get(r);if(u)var f=u.get(null);else{u=new Map,bh.set(r,u);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var S=g[y];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(u.set(S.dataset.precedence,S),f=S)}f&&u.set(null,f)}g=o.instance,S=g.getAttribute("data-precedence"),y=u.get(S)||f,y===f&&u.set(null,g),u.set(S,g),this.count++,f=yh.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),y?y.parentNode.insertBefore(g,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),o.state.loading|=4}}var Ia={$$typeof:C,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function xR(r,o,u,f,g,y,S,x,A){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Zd(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zd(0),this.hiddenUpdates=Zd(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=A,this.incompleteTransitions=new Map}function F1(r,o,u,f,g,y,S,x,A,L,q,K){return r=new xR(r,o,u,S,A,L,q,K,x),o=1,y===!0&&(o|=24),y=_n(3,null,null,o),r.current=y,y.stateNode=r,o=Up(),o.refCount++,r.pooledCache=o,o.refCount++,y.memoizedState={element:f,isDehydrated:u,cache:o},Hp(y),r}function Y1(r){return r?(r=Sl,r):Sl}function X1(r,o,u,f,g,y){g=Y1(g),f.context===null?f.context=g:f.pendingContext=g,f=Rs(o),f.payload={element:u},y=y===void 0?null:y,y!==null&&(f.callback=y),u=Ms(r,f,o),u!==null&&(hn(u,r,o),ya(u,r,o))}function Q1(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function rm(r,o){Q1(r,o),(r=r.alternate)&&Q1(r,o)}function J1(r){if(r.tag===13||r.tag===31){var o=vr(r,67108864);o!==null&&hn(o,r,67108864),rm(r,67108864)}}function Z1(r){if(r.tag===13||r.tag===31){var o=En();o=ep(o);var u=vr(r,o);u!==null&&hn(u,r,o),rm(r,o)}}var wh=!0;function _R(r,o,u,f){var g=I.T;I.T=null;var y=F.p;try{F.p=2,lm(r,o,u,f)}finally{F.p=y,I.T=g}}function OR(r,o,u,f){var g=I.T;I.T=null;var y=F.p;try{F.p=8,lm(r,o,u,f)}finally{F.p=y,I.T=g}}function lm(r,o,u,f){if(wh){var g=om(f);if(g===null)Kg(r,o,f,Sh,u),tk(r,f);else if(CR(g,r,o,u,f))f.stopPropagation();else if(tk(r,f),o&4&&-1<AR.indexOf(r)){for(;g!==null;){var y=ul(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var S=pr(y.pendingLanes);if(S!==0){var x=y;for(x.pendingLanes|=2,x.entangledLanes|=2;S;){var A=1<<31-kn(S);x.entanglements[1]|=A,S&=~A}Ci(y),(qe&6)===0&&(ih=wn()+500,Na(0))}}break;case 31:case 13:x=vr(y,2),x!==null&&hn(x,y,2),rh(),rm(y,2)}if(y=om(f),y===null&&Kg(r,o,f,Sh,u),y===g)break;g=y}g!==null&&f.stopPropagation()}else Kg(r,o,f,null,u)}}function om(r){return r=cp(r),am(r)}var Sh=null;function am(r){if(Sh=null,r=cl(r),r!==null){var o=l(r);if(o===null)r=null;else{var u=o.tag;if(u===13){if(r=a(o),r!==null)return r;r=null}else if(u===31){if(r=c(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Sh=r,null}function ek(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(h2()){case av:return 2;case cv:return 8;case uu:case f2:return 32;case uv:return 268435456;default:return 32}default:return 32}}var cm=!1,Vs=null,$s=null,Gs=null,Pa=new Map,Ha=new Map,Ks=[],AR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function tk(r,o){switch(r){case"focusin":case"focusout":Vs=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":Gs=null;break;case"pointerover":case"pointerout":Pa.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ha.delete(o.pointerId)}}function qa(r,o,u,f,g,y){return r===null||r.nativeEvent!==y?(r={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:y,targetContainers:[g]},o!==null&&(o=ul(o),o!==null&&J1(o)),r):(r.eventSystemFlags|=f,o=r.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),r)}function CR(r,o,u,f,g){switch(o){case"focusin":return Vs=qa(Vs,r,o,u,f,g),!0;case"dragenter":return $s=qa($s,r,o,u,f,g),!0;case"mouseover":return Gs=qa(Gs,r,o,u,f,g),!0;case"pointerover":var y=g.pointerId;return Pa.set(y,qa(Pa.get(y)||null,r,o,u,f,g)),!0;case"gotpointercapture":return y=g.pointerId,Ha.set(y,qa(Ha.get(y)||null,r,o,u,f,g)),!0}return!1}function nk(r){var o=cl(r.target);if(o!==null){var u=l(o);if(u!==null){if(o=u.tag,o===13){if(o=a(u),o!==null){r.blockedOn=o,mv(r.priority,function(){Z1(u)});return}}else if(o===31){if(o=c(u),o!==null){r.blockedOn=o,mv(r.priority,function(){Z1(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function kh(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=om(r.nativeEvent);if(u===null){u=r.nativeEvent;var f=new u.constructor(u.type,u);ap=f,u.target.dispatchEvent(f),ap=null}else return o=ul(u),o!==null&&J1(o),r.blockedOn=u,!1;o.shift()}return!0}function ik(r,o,u){kh(r)&&u.delete(o)}function TR(){cm=!1,Vs!==null&&kh(Vs)&&(Vs=null),$s!==null&&kh($s)&&($s=null),Gs!==null&&kh(Gs)&&(Gs=null),Pa.forEach(ik),Ha.forEach(ik)}function xh(r,o){r.blockedOn===o&&(r.blockedOn=null,cm||(cm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,TR)))}var _h=null;function sk(r){_h!==r&&(_h=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){_h===r&&(_h=null);for(var o=0;o<r.length;o+=3){var u=r[o],f=r[o+1],g=r[o+2];if(typeof f!="function"){if(am(f||u)===null)continue;break}var y=ul(u);y!==null&&(r.splice(o,3),o-=3,og(y,{pending:!0,data:g,method:u.method,action:f},f,g))}}))}function Gl(r){function o(A){return xh(A,r)}Vs!==null&&xh(Vs,r),$s!==null&&xh($s,r),Gs!==null&&xh(Gs,r),Pa.forEach(o),Ha.forEach(o);for(var u=0;u<Ks.length;u++){var f=Ks[u];f.blockedOn===r&&(f.blockedOn=null)}for(;0<Ks.length&&(u=Ks[0],u.blockedOn===null);)nk(u),u.blockedOn===null&&Ks.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var g=u[f],y=u[f+1],S=g[rn]||null;if(typeof y=="function")S||sk(u);else if(S){var x=null;if(y&&y.hasAttribute("formAction")){if(g=y,S=y[rn]||null)x=S.formAction;else if(am(g)!==null)continue}else x=S.action;typeof x=="function"?u[f+1]=x:(u.splice(f,3),f-=3),sk(u)}}}function rk(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(S){return g=S})},focusReset:"manual",scroll:"manual"})}function o(){g!==null&&(g(),g=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,g=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),g!==null&&(g(),g=null)}}}function um(r){this._internalRoot=r}Oh.prototype.render=um.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(i(409));var u=o.current,f=En();X1(u,f,r,o,null,null)},Oh.prototype.unmount=um.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;X1(r.current,2,null,r,null,null),rh(),o[al]=null}};function Oh(r){this._internalRoot=r}Oh.prototype.unstable_scheduleHydration=function(r){if(r){var o=gv();r={blockedOn:null,target:r,priority:o};for(var u=0;u<Ks.length&&o!==0&&o<Ks[u].priority;u++);Ks.splice(u,0,r),u===0&&nk(r)}};var lk=e.version;if(lk!=="19.2.4")throw Error(i(527,lk,"19.2.4"));F.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=d(o),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var ER={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ah.isDisabled&&Ah.supportsFiber)try{Qo=Ah.inject(ER),Sn=Ah}catch{}}return $a.createRoot=function(r,o){if(!s(r))throw Error(i(299));var u=!1,f="",g=dS,y=pS,S=gS;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(y=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError)),o=F1(r,1,!1,null,null,u,f,null,g,y,S,rk),r[al]=o.current,Gg(r),new um(o)},$a.hydrateRoot=function(r,o,u){if(!s(r))throw Error(i(299));var f=!1,g="",y=dS,S=pS,x=gS,A=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(g=u.identifierPrefix),u.onUncaughtError!==void 0&&(y=u.onUncaughtError),u.onCaughtError!==void 0&&(S=u.onCaughtError),u.onRecoverableError!==void 0&&(x=u.onRecoverableError),u.formState!==void 0&&(A=u.formState)),o=F1(r,1,!0,o,u??null,f,g,A,y,S,x,rk),o.context=Y1(null),u=o.current,f=En(),f=ep(f),g=Rs(f),g.callback=null,Ms(u,g,f),u=f,o.current.lanes=u,Zo(o,u),Ci(o),r[al]=o.current,Gg(r),new Oh(o)},$a.version="19.2.4",$a}var mk;function PR(){if(mk)return dm.exports;mk=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),dm.exports=IR(),dm.exports}var HR=PR();function pd(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function qR(n,e,t,i){function s(l){return l instanceof t?l:new t(function(a){a(l)})}return new(t||(t=Promise))(function(l,a){function c(p){try{d(i.next(p))}catch(m){a(m)}}function h(p){try{d(i.throw(p))}catch(m){a(m)}}function d(p){p.done?l(p.value):s(p.value).then(c,h)}d((i=i.apply(n,e||[])).next())})}const VR=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class Ky extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class $R extends Ky{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class yk extends Ky{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class bk extends Ky{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var C0;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(C0||(C0={}));class GR{constructor(e,{headers:t={},customFetch:i,region:s=C0.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=VR(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return qR(this,arguments,void 0,function*(t,i={}){var s;let l,a;try{const{headers:c,method:h,body:d,signal:p,timeout:m}=i;let b={},{region:v}=i;v||(v=this.region);const w=new URL(`${this.url}/${t}`);v&&v!=="any"&&(b["x-region"]=v,w.searchParams.set("forceFunctionRegion",v));let k;d&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(b["Content-Type"]="application/octet-stream",k=d):typeof d=="string"?(b["Content-Type"]="text/plain",k=d):typeof FormData<"u"&&d instanceof FormData?k=d:(b["Content-Type"]="application/json",k=JSON.stringify(d)):d&&typeof d!="string"&&!(typeof Blob<"u"&&d instanceof Blob)&&!(d instanceof ArrayBuffer)&&!(typeof FormData<"u"&&d instanceof FormData)?k=JSON.stringify(d):k=d;let _=p;m&&(a=new AbortController,l=setTimeout(()=>a.abort(),m),p?(_=a.signal,p.addEventListener("abort",()=>a.abort())):_=a.signal);const O=yield this.fetch(w.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},b),this.headers),c),body:k,signal:_}).catch(B=>{throw new $R(B)}),R=O.headers.get("x-relay-error");if(R&&R==="true")throw new yk(O);if(!O.ok)throw new bk(O);let C=((s=O.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),U;return C==="application/json"?U=yield O.json():C==="application/octet-stream"||C==="application/pdf"?U=yield O.blob():C==="text/event-stream"?U=O:C==="multipart/form-data"?U=yield O.formData():U=yield O.text(),{data:U,error:null,response:O}}catch(c){return{data:null,error:c,response:c instanceof bk||c instanceof yk?c.context:void 0}}finally{l&&clearTimeout(l)}})}}var KR=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},WR=class{constructor(n){var e,t,i;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(e=n.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=n.signal,this.isMaybeSingle=(t=n.isMaybeSingle)!==null&&t!==void 0?t:!1,this.urlLengthLimit=(i=n.urlLengthLimit)!==null&&i!==void 0?i:8e3,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,e){return this.headers=new Headers(this.headers),this.headers.set(n,e),this}then(n,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let s=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let a=null,c=null,h=null,d=l.status,p=l.statusText;if(l.ok){var m,b;if(t.method!=="HEAD"){var v;const O=await l.text();O===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((v=t.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?c=O:c=JSON.parse(O))}const k=(m=t.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),_=(b=l.headers.get("content-range"))===null||b===void 0?void 0:b.split("/");k&&_&&_.length>1&&(h=parseInt(_[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(c)&&(c.length>1?(a={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,p="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var w;const k=await l.text();try{a=JSON.parse(k),Array.isArray(a)&&l.status===404&&(c=[],a=null,d=200,p="OK")}catch{l.status===404&&k===""?(d=204,p="No Content"):a={message:k}}if(a&&t.isMaybeSingle&&(!(a==null||(w=a.details)===null||w===void 0)&&w.includes("0 rows"))&&(a=null,d=200,p="OK"),a&&t.shouldThrowOnError)throw new KR(a)}return{error:a,data:c,count:h,status:d,statusText:p}});return this.shouldThrowOnError||(s=s.catch(l=>{var a;let c="",h="",d="";const p=l?.cause;if(p){var m,b,v,w;const O=(m=p?.message)!==null&&m!==void 0?m:"",R=(b=p?.code)!==null&&b!==void 0?b:"";c=`${(v=l?.name)!==null&&v!==void 0?v:"FetchError"}: ${l?.message}`,c+=`

Caused by: ${(w=p?.name)!==null&&w!==void 0?w:"Error"}: ${O}`,R&&(c+=` (${R})`),p?.stack&&(c+=`
${p.stack}`)}else{var k;c=(k=l?.stack)!==null&&k!==void 0?k:""}const _=this.url.toString().length;return l?.name==="AbortError"||l?.code==="ABORT_ERR"?(d="",h="Request was aborted (timeout or manual cancellation)",_>this.urlLengthLimit&&(h+=`. Note: Your request URL is ${_} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(p?.name==="HeadersOverflowError"||p?.code==="UND_ERR_HEADERS_OVERFLOW")&&(d="",h="HTTP headers exceeded server limits (typically 16KB)",_>this.urlLengthLimit&&(h+=`. Your request URL is ${_} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(a=l?.name)!==null&&a!==void 0?a:"FetchError"}: ${l?.message}`,details:c,hint:h,code:d},data:null,count:null,status:0,statusText:""}})),s.then(n,e)}returns(){return this}overrideTypes(){return this}},FR=class extends WR{select(n){let e=!1;const t=(n??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:e=!0,nullsFirst:t,foreignTable:i,referencedTable:s=i}={}){const l=s?`${s}.order`:"order",a=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${a?`${a},`:""}${n}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:e,referencedTable:t=e}={}){const i=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(i,`${n}`),this}range(n,e,{foreignTable:t,referencedTable:i=t}={}){const s=typeof i>"u"?"offset":`${i}.offset`,l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${n}`),this.url.searchParams.set(l,`${e-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:e=!1,settings:t=!1,buffers:i=!1,wal:s=!1,format:l="text"}={}){var a;const c=[n?"analyze":null,e?"verbose":null,t?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${h}"; options=${c};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const vk=new RegExp("[,()]");var eo=class extends FR{eq(n,e){return this.url.searchParams.append(n,`eq.${e}`),this}neq(n,e){return this.url.searchParams.append(n,`neq.${e}`),this}gt(n,e){return this.url.searchParams.append(n,`gt.${e}`),this}gte(n,e){return this.url.searchParams.append(n,`gte.${e}`),this}lt(n,e){return this.url.searchParams.append(n,`lt.${e}`),this}lte(n,e){return this.url.searchParams.append(n,`lte.${e}`),this}like(n,e){return this.url.searchParams.append(n,`like.${e}`),this}likeAllOf(n,e){return this.url.searchParams.append(n,`like(all).{${e.join(",")}}`),this}likeAnyOf(n,e){return this.url.searchParams.append(n,`like(any).{${e.join(",")}}`),this}ilike(n,e){return this.url.searchParams.append(n,`ilike.${e}`),this}ilikeAllOf(n,e){return this.url.searchParams.append(n,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(n,e){return this.url.searchParams.append(n,`ilike(any).{${e.join(",")}}`),this}regexMatch(n,e){return this.url.searchParams.append(n,`match.${e}`),this}regexIMatch(n,e){return this.url.searchParams.append(n,`imatch.${e}`),this}is(n,e){return this.url.searchParams.append(n,`is.${e}`),this}isDistinct(n,e){return this.url.searchParams.append(n,`isdistinct.${e}`),this}in(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&vk.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`in.(${t})`),this}notIn(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&vk.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`not.in.(${t})`),this}contains(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cs.{${e.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(e)}`),this}containedBy(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cd.{${e.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(e)}`),this}rangeGt(n,e){return this.url.searchParams.append(n,`sr.${e}`),this}rangeGte(n,e){return this.url.searchParams.append(n,`nxl.${e}`),this}rangeLt(n,e){return this.url.searchParams.append(n,`sl.${e}`),this}rangeLte(n,e){return this.url.searchParams.append(n,`nxr.${e}`),this}rangeAdjacent(n,e){return this.url.searchParams.append(n,`adj.${e}`),this}overlaps(n,e){return typeof e=="string"?this.url.searchParams.append(n,`ov.${e}`):this.url.searchParams.append(n,`ov.{${e.join(",")}}`),this}textSearch(n,e,{config:t,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const l=t===void 0?"":`(${t})`;return this.url.searchParams.append(n,`${s}fts${l}.${e}`),this}match(n){return Object.entries(n).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(n,e,t){return this.url.searchParams.append(n,`not.${e}.${t}`),this}or(n,{foreignTable:e,referencedTable:t=e}={}){const i=t?`${t}.or`:"or";return this.url.searchParams.append(i,`(${n})`),this}filter(n,e,t){return this.url.searchParams.append(n,`${e}.${t}`),this}},YR=class{constructor(n,{headers:e={},schema:t,fetch:i,urlLengthLimit:s=8e3}){this.url=n,this.headers=new Headers(e),this.schema=t,this.fetch=i,this.urlLengthLimit=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,e){const{head:t=!1,count:i}=e??{},s=t?"HEAD":"GET";let l=!1;const a=(n??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join(""),{url:c,headers:h}=this.cloneRequestState();return c.searchParams.set("select",a),i&&h.append("Prefer",`count=${i}`),new eo({method:s,url:c,headers:h,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(n,{count:e,defaultToNull:t=!0}={}){var i;const s="POST",{url:l,headers:a}=this.cloneRequestState();if(e&&a.append("Prefer",`count=${e}`),t||a.append("Prefer","missing=default"),Array.isArray(n)){const c=n.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(c.length>0){const h=[...new Set(c)].map(d=>`"${d}"`);l.searchParams.set("columns",h.join(","))}}return new eo({method:s,url:l,headers:a,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(n,{onConflict:e,ignoreDuplicates:t=!1,count:i,defaultToNull:s=!0}={}){var l;const a="POST",{url:c,headers:h}=this.cloneRequestState();if(h.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&c.searchParams.set("on_conflict",e),i&&h.append("Prefer",`count=${i}`),s||h.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((p,m)=>p.concat(Object.keys(m)),[]);if(d.length>0){const p=[...new Set(d)].map(m=>`"${m}"`);c.searchParams.set("columns",p.join(","))}}return new eo({method:a,url:c,headers:h,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch,urlLengthLimit:this.urlLengthLimit})}update(n,{count:e}={}){var t;const i="PATCH",{url:s,headers:l}=this.cloneRequestState();return e&&l.append("Prefer",`count=${e}`),new eo({method:i,url:s,headers:l,schema:this.schema,body:n,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:n}={}){var e;const t="DELETE",{url:i,headers:s}=this.cloneRequestState();return n&&s.append("Prefer",`count=${n}`),new eo({method:t,url:i,headers:s,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function dc(n){"@babel/helpers - typeof";return dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dc(n)}function XR(n,e){if(dc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(dc(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function QR(n){var e=XR(n,"string");return dc(e)=="symbol"?e:e+""}function JR(n,e,t){return(e=QR(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wk(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function Th(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wk(Object(t),!0).forEach(function(i){JR(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):wk(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var ZR=class RO{constructor(e,{headers:t={},schema:i,fetch:s,timeout:l,urlLengthLimit:a=8e3}={}){this.url=e,this.headers=new Headers(t),this.schemaName=i,this.urlLengthLimit=a;const c=s??globalThis.fetch;l!==void 0&&l>0?this.fetch=(h,d)=>{const p=new AbortController,m=setTimeout(()=>p.abort(),l),b=d?.signal;if(b){if(b.aborted)return clearTimeout(m),c(h,d);const v=()=>{clearTimeout(m),p.abort()};return b.addEventListener("abort",v,{once:!0}),c(h,Th(Th({},d),{},{signal:p.signal})).finally(()=>{clearTimeout(m),b.removeEventListener("abort",v)})}return c(h,Th(Th({},d),{},{signal:p.signal})).finally(()=>clearTimeout(m))}:this.fetch=c}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new YR(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new RO(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,t={},{head:i=!1,get:s=!1,count:l}={}){var a;let c;const h=new URL(`${this.url}/rpc/${e}`);let d;const p=v=>v!==null&&typeof v=="object"&&(!Array.isArray(v)||v.some(p)),m=i&&Object.values(t).some(p);m?(c="POST",d=t):i||s?(c=i?"HEAD":"GET",Object.entries(t).filter(([v,w])=>w!==void 0).map(([v,w])=>[v,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([v,w])=>{h.searchParams.append(v,w)})):(c="POST",d=t);const b=new Headers(this.headers);return m?b.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&b.set("Prefer",`count=${l}`),new eo({method:c,url:h,headers:b,schema:this.schemaName,body:d,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}};class eM{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const i=t.versions;if(i&&i.node){const s=i.node,l=parseInt(s.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const tM="2.95.2",nM=`realtime-js/${tM}`,iM="1.0.0",MO="2.0.0",Sk=MO,T0=1e4,sM=1e3,rM=100;var Fs;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Fs||(Fs={}));var Ot;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Ot||(Ot={}));var di;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(di||(di={}));var E0;(function(n){n.websocket="websocket"})(E0||(E0={}));var Ur;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ur||(Ur={}));class lM{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,i;const s=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,i;const s=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:{},a=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,t,i){var s,l;const a=e.topic,c=(s=e.ref)!==null&&s!==void 0?s:"",h=(l=e.join_ref)!==null&&l!==void 0?l:"",d=e.payload.event,p=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},m=Object.keys(p).length===0?"":JSON.stringify(p);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const b=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+c.length+a.length+d.length+m.length,v=new ArrayBuffer(this.HEADER_LENGTH+b);let w=new DataView(v),k=0;w.setUint8(k++,this.KINDS.userBroadcastPush),w.setUint8(k++,h.length),w.setUint8(k++,c.length),w.setUint8(k++,a.length),w.setUint8(k++,d.length),w.setUint8(k++,m.length),w.setUint8(k++,t),Array.from(h,O=>w.setUint8(k++,O.charCodeAt(0))),Array.from(c,O=>w.setUint8(k++,O.charCodeAt(0))),Array.from(a,O=>w.setUint8(k++,O.charCodeAt(0))),Array.from(d,O=>w.setUint8(k++,O.charCodeAt(0))),Array.from(m,O=>w.setUint8(k++,O.charCodeAt(0)));var _=new Uint8Array(v.byteLength+i.byteLength);return _.set(new Uint8Array(v),0),_.set(new Uint8Array(i),v.byteLength),_.buffer}decode(e,t){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return t(i)}if(typeof e=="string"){const i=JSON.parse(e),[s,l,a,c,h]=i;return t({join_ref:s,ref:l,topic:a,event:c,payload:h})}return t({})}_binaryDecode(e){const t=new DataView(e),i=t.getUint8(0),s=new TextDecoder;if(i===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,s)}_decodeUserBroadcast(e,t,i){const s=t.getUint8(1),l=t.getUint8(2),a=t.getUint8(3),c=t.getUint8(4);let h=this.HEADER_LENGTH+4;const d=i.decode(e.slice(h,h+s));h=h+s;const p=i.decode(e.slice(h,h+l));h=h+l;const m=i.decode(e.slice(h,h+a));h=h+a;const b=e.slice(h,e.byteLength),v=c===this.JSON_ENCODING?JSON.parse(i.decode(b)):b,w={type:this.BROADCAST_EVENT,event:p,payload:v};return a>0&&(w.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>t.includes(i)))}}class NO{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var et;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(et||(et={}));const kk=(n,e,t={})=>{var i;const s=(i=t.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((l,a)=>(l[a]=oM(a,n,e,s),l),{}):{}},oM=(n,e,t,i)=>{const s=e.find(c=>c.name===n),l=s?.type,a=t[n];return l&&!i.includes(l)?LO(l,a):D0(a)},LO=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return hM(e,t)}switch(n){case et.bool:return aM(e);case et.float4:case et.float8:case et.int2:case et.int4:case et.int8:case et.numeric:case et.oid:return cM(e);case et.json:case et.jsonb:return uM(e);case et.timestamp:return fM(e);case et.abstime:case et.date:case et.daterange:case et.int4range:case et.int8range:case et.money:case et.reltime:case et.text:case et.time:case et.timestamptz:case et.timetz:case et.tsrange:case et.tstzrange:return D0(e);default:return D0(e)}},D0=n=>n,aM=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},cM=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},uM=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},hM=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let l;const a=n.slice(1,t);try{l=JSON.parse("["+a+"]")}catch{l=a?a.split(","):[]}return l.map(c=>LO(e,c))}return n},fM=n=>typeof n=="string"?n.replace(" ","T"):n,BO=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class ym{constructor(e,t,i={},s=T0){this.channel=e,this.event=t,this.payload=i,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var xk;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(xk||(xk={}));class ic{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},s=>{const{onJoin:l,onLeave:a,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ic.syncState(this.state,s,l,a),this.pendingDiffs.forEach(h=>{this.state=ic.syncDiff(this.state,h,l,a)}),this.pendingDiffs=[],c()}),this.channel._on(i.diff,{},s=>{const{onJoin:l,onLeave:a,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ic.syncDiff(this.state,s,l,a),c())}),this.onJoin((s,l,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:a})}),this.onLeave((s,l,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,s){const l=this.cloneDeep(e),a=this.transformState(t),c={},h={};return this.map(l,(d,p)=>{a[d]||(h[d]=p)}),this.map(a,(d,p)=>{const m=l[d];if(m){const b=p.map(_=>_.presence_ref),v=m.map(_=>_.presence_ref),w=p.filter(_=>v.indexOf(_.presence_ref)<0),k=m.filter(_=>b.indexOf(_.presence_ref)<0);w.length>0&&(c[d]=w),k.length>0&&(h[d]=k)}else c[d]=p}),this.syncDiff(l,{joins:c,leaves:h},i,s)}static syncDiff(e,t,i,s){const{joins:l,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),s||(s=()=>{}),this.map(l,(c,h)=>{var d;const p=(d=e[c])!==null&&d!==void 0?d:[];if(e[c]=this.cloneDeep(h),p.length>0){const m=e[c].map(v=>v.presence_ref),b=p.filter(v=>m.indexOf(v.presence_ref)<0);e[c].unshift(...b)}i(c,p,h)}),this.map(a,(c,h)=>{let d=e[c];if(!d)return;const p=h.map(m=>m.presence_ref);d=d.filter(m=>p.indexOf(m.presence_ref)<0),e[c]=d,s(c,d,h),d.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const s=e[i];return"metas"in s?t[i]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[i]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var _k;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(_k||(_k={}));var sc;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(sc||(sc={}));var fs;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(fs||(fs={}));class lo{constructor(e,t={config:{}},i){var s,l;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=Ot.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ym(this,di.join,this.params,this.timeout),this.rejoinTimer=new NO(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ot.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ot.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this._on(di.reply,{},(a,c)=>{this._trigger(this._replyEventName(c),a)}),this.presence=new ic(this),this.broadcastEndpointURL=BO(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,s,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Ot.closed){const{config:{broadcast:a,presence:c,private:h}}=this.params,d=(s=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(v=>v.filter))!==null&&s!==void 0?s:[],p=!!this.bindings[sc.PRESENCE]&&this.bindings[sc.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,m={},b={broadcast:a,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(fs.CHANNEL_ERROR,v)),this._onClose(()=>e?.(fs.CLOSED)),this.updateJoinPayload(Object.assign({config:b},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){e?.(fs.SUBSCRIBED);return}else{const k=this.bindings.postgres_changes,_=(w=k?.length)!==null&&w!==void 0?w:0,O=[];for(let R=0;R<_;R++){const C=k[R],{filter:{event:U,schema:B,table:z,filter:D}}=C,W=v&&v[R];if(W&&W.event===U&&lo.isFilterValueEqual(W.schema,B)&&lo.isFilterValueEqual(W.table,z)&&lo.isFilterValueEqual(W.filter,D))O.push(Object.assign(Object.assign({},C),{id:W.id}));else{this.unsubscribe(),this.state=Ot.errored,e?.(fs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=O,e&&e(fs.SUBSCRIBED);return}}).receive("error",v=>{this.state=Ot.errored,e?.(fs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(fs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===Ot.joined&&e===sc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,i)}async httpSend(e,t,i={}){var s;if(t==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=i.timeout)!==null&&s!==void 0?s:this.timeout);if(c.status===202)return{success:!0};let h=c.statusText;try{const d=await c.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(e,t={}){var i,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:a}=e,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var a,c,h;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(c=(a=this.params)===null||a===void 0?void 0:a.config)===null||c===void 0?void 0:c.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),d.receive("ok",()=>l("ok")),d.receive("error",()=>l("error")),d.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ot.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(di.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(s=>{i=new ym(this,di.leave,{},e),i.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ot.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const s=new AbortController,l=setTimeout(()=>s.abort(),i),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(l),a}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new ym(this,e,t,i);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>rM){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var s,l;const a=e.toLocaleLowerCase(),{close:c,error:h,leave:d,join:p}=di;if(i&&[c,h,d,p].indexOf(a)>=0&&i!==this._joinRef())return;let b=this._onMessage(a,t,i);if(t&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var w,k,_;return((w=v.filter)===null||w===void 0?void 0:w.event)==="*"||((_=(k=v.filter)===null||k===void 0?void 0:k.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===a}).map(v=>v.callback(b,i)):(l=this.bindings[a])===null||l===void 0||l.filter(v=>{var w,k,_,O,R,C;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in v){const U=v.id,B=(w=v.filter)===null||w===void 0?void 0:w.event;return U&&((k=t.ids)===null||k===void 0?void 0:k.includes(U))&&(B==="*"||B?.toLocaleLowerCase()===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const U=(R=(O=v?.filter)===null||O===void 0?void 0:O.event)===null||R===void 0?void 0:R.toLocaleLowerCase();return U==="*"||U===((C=t?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===a}).map(v=>{if(typeof b=="object"&&"ids"in b){const w=b.data,{schema:k,table:_,commit_timestamp:O,type:R,errors:C}=w;b=Object.assign(Object.assign({},{schema:k,table:_,commit_timestamp:O,eventType:R,new:{},old:{},errors:C}),this._getPayloadRecords(w))}v.callback(b,i)})}_isClosed(){return this.state===Ot.closed}_isJoined(){return this.state===Ot.joined}_isJoining(){return this.state===Ot.joining}_isLeaving(){return this.state===Ot.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const s=e.toLocaleLowerCase(),l={type:s,filter:t,callback:i};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&lo.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(di.close,{},e)}_onError(e){this._on(di.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ot.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=kk(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=kk(e.columns,e.old_record)),t}}const bm=()=>{},Eh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},dM=[1e3,2e3,5e3,1e4],pM=1e4,gM=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class mM{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=T0,this.transport=null,this.heartbeatIntervalMs=Eh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=bm,this.ref=0,this.reconnectTimer=null,this.vsn=Sk,this.logger=bm,this.conn=null,this.sendBuffer=[],this.serializer=new lM,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...l)=>s(...l):(...l)=>fetch(...l),!(!((i=t?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${E0.websocket}`,this.httpEndpoint=BO(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=eM.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Fs.connecting:return Ur.Connecting;case Fs.open:return Ur.Open;case Fs.closing:return Ur.Closing;default:return Ur.Closed}}isConnected(){return this.connectionState()===Ur.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,s=this.getChannels().find(l=>l.topic===i);if(s)return s;{const l=new lo(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:i,payload:s,ref:l}=e,a=()=>{this.encode(e,c=>{var h;(h=this.conn)===null||h===void 0||h.send(c)})};this.log("push",`${t} ${i} (${l})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(sM,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Eh.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const d=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",d)}catch(p){this.log("error","error in heartbeat callback",p)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:i,event:s,payload:l,ref:a}=t,c=a?`(${a})`:"",h=l.status||"";this.log("receive",`${h} ${i} ${s} ${c}`.trim(),l),this.channels.filter(d=>d._isMember(i)).forEach(d=>d._trigger(s,l,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Fs.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Fs.open||this.conn.readyState===Fs.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(di.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${i}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([gM],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,i=!1;if(e)t=e,i=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),t=this.accessTokenValue}else t=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const l={access_token:t,version:nM};t&&s.updateJoinPayload(l),s.joinedOnce&&s._isJoined()&&s._push(di.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new NO(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Eh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,s,l,a,c,h,d,p,m,b,v;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e?.timeout)!==null&&i!==void 0?i:T0,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:Eh.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(a=e?.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:bm,this.vsn=(h=e?.vsn)!==null&&h!==void 0?h:Sk,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(w=>dM[w-1]||pM),this.vsn){case iM:this.encode=(p=e?.encode)!==null&&p!==void 0?p:((w,k)=>k(JSON.stringify(w))),this.decode=(m=e?.decode)!==null&&m!==void 0?m:((w,k)=>k(JSON.parse(w)));break;case MO:this.encode=(b=e?.encode)!==null&&b!==void 0?b:this.serializer.encode.bind(this.serializer),this.decode=(v=e?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var pc=class extends Error{constructor(n,e){super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function yM(n,e,t){const i=new URL(e,n);if(t)for(const[s,l]of Object.entries(t))l!==void 0&&i.searchParams.set(s,l);return i.toString()}async function bM(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function vM(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:i,query:s,body:l,headers:a}){const c=yM(n.baseUrl,i,s),h=await bM(n.auth),d=await e(c,{method:t,headers:{...l?{"Content-Type":"application/json"}:{},...h,...a},body:l?JSON.stringify(l):void 0}),p=await d.text(),m=(d.headers.get("content-type")||"").includes("application/json"),b=m&&p?JSON.parse(p):p;if(!d.ok){const v=m?b:void 0,w=v?.error;throw new pc(w?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:w?.type,icebergCode:w?.code,details:v})}return{status:d.status,headers:d.headers,data:b}}}}function Dh(n){return n.join("")}var wM=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:Dh(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Dh(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Dh(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Dh(n.namespace)}`}),!0}catch(e){if(e instanceof pc&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof pc&&t.status===409)return;throw t}}};function Kl(n){return n.join("")}var SM=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Kl(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Kl(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Kl(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Kl(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Kl(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Kl(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof pc&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof pc&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},kM=class{constructor(n){let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=vM({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=n.accessDelegation?.join(","),this.namespaceOps=new wM(this.client,e),this.tableOps=new SM(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}},gd=class extends Error{constructor(n,e="storage",t,i){super(n),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=t,this.statusCode=i}};function md(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var Rh=class extends gd{constructor(n,e,t,i="storage"){super(n,i,e,t),this.name=i==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},jO=class extends gd{constructor(n,e,t="storage"){super(n,t),this.name=t==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const xM=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),_M=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},R0=n=>{if(Array.isArray(n))return n.map(t=>R0(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const s=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[s]=R0(i)}),e},OM=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function gc(n){"@babel/helpers - typeof";return gc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gc(n)}function AM(n,e){if(gc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(gc(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function CM(n){var e=AM(n,"string");return gc(e)=="symbol"?e:e+""}function TM(n,e,t){return(e=CM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ok(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function be(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ok(Object(t),!0).forEach(function(i){TM(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ok(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Ak=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},EM=async(n,e,t,i)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!t?.noResolveJson){const s=n,l=s.status||500;if(typeof s.json=="function")s.json().then(a=>{const c=a?.statusCode||a?.code||l+"";e(new Rh(Ak(a),l,c,i))}).catch(()=>{if(i==="vectors"){const a=l+"";e(new Rh(s.statusText||`HTTP ${l} error`,l,a,i))}else{const a=l+"";e(new Rh(s.statusText||`HTTP ${l} error`,l,a,i))}});else{const a=l+"";e(new Rh(s.statusText||`HTTP ${l} error`,l,a,i))}}else e(new jO(Ak(n),n,i))},DM=(n,e,t,i)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||n==="HEAD"||!i?be(be({},s),t):(_M(i)?(s.headers=be({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(i)):s.body=i,e?.duplex&&(s.duplex=e.duplex),be(be({},s),t))};async function Ga(n,e,t,i,s,l,a){return new Promise((c,h)=>{n(t,DM(e,i,s,l)).then(d=>{if(!d.ok)throw d;if(i?.noResolveJson)return d;if(a==="vectors"){const p=d.headers.get("content-type");if(d.headers.get("content-length")==="0"||d.status===204)return{};if(!p||!p.includes("application/json"))return{}}return d.json()}).then(d=>c(d)).catch(d=>EM(d,h,i,a))})}function UO(n="storage"){return{get:async(e,t,i,s)=>Ga(e,"GET",t,i,s,void 0,n),post:async(e,t,i,s,l)=>Ga(e,"POST",t,s,l,i,n),put:async(e,t,i,s,l)=>Ga(e,"PUT",t,s,l,i,n),head:async(e,t,i,s)=>Ga(e,"HEAD",t,be(be({},i),{},{noResolveJson:!0}),s,void 0,n),remove:async(e,t,i,s,l)=>Ga(e,"DELETE",t,s,l,i,n)}}const RM=UO("storage"),{get:mc,post:fi,put:M0,head:MM,remove:Wy}=RM,zn=UO("vectors");var qo=class{constructor(n,e={},t,i="storage"){this.shouldThrowOnError=!1,this.url=n,this.headers=e,this.fetch=xM(t),this.namespace=i}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(n){var e=this;try{return{data:await n(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(md(t))return{data:null,error:t};throw t}}},NM=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e}then(n,e){return this.execute().then(n,e)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(md(e))return{data:null,error:e};throw e}}};let zO;zO=Symbol.toStringTag;var LM=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e,this[zO]="BlobDownloadBuilder",this.promise=null}asStream(){return new NM(this.downloadFn,this.shouldThrowOnError)}then(n,e){return this.getPromise().then(n,e)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(md(e))return{data:null,error:e};throw e}}};const BM={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ck={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var jM=class extends qo{constructor(n,e={},t,i){super(n,e,i,"storage"),this.bucketId=t}async uploadOrUpdate(n,e,t,i){var s=this;return s.handleOperation(async()=>{let l;const a=be(be({},Ck),i);let c=be(be({},s.headers),n==="POST"&&{"x-upsert":String(a.upsert)});const h=a.metadata;typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",a.cacheControl),h&&l.append("metadata",s.encodeMetadata(h)),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.has("cacheControl")||l.append("cacheControl",a.cacheControl),h&&!l.has("metadata")&&l.append("metadata",s.encodeMetadata(h))):(l=t,c["cache-control"]=`max-age=${a.cacheControl}`,c["content-type"]=a.contentType,h&&(c["x-metadata"]=s.toBase64(s.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!a.duplex&&(a.duplex="half")),i?.headers&&(c=be(be({},c),i.headers));const d=s._removeEmptyFolders(e),p=s._getFinalPath(d),m=await(n=="PUT"?M0:fi)(s.fetch,`${s.url}/object/${p}`,l,be({headers:c},a?.duplex?{duplex:a.duplex}:{}));return{path:d,id:m.Id,fullPath:m.Key}})}async upload(n,e,t){return this.uploadOrUpdate("POST",n,e,t)}async uploadToSignedUrl(n,e,t,i){var s=this;const l=s._removeEmptyFolders(n),a=s._getFinalPath(l),c=new URL(s.url+`/object/upload/sign/${a}`);return c.searchParams.set("token",e),s.handleOperation(async()=>{let h;const d=be({upsert:Ck.upsert},i),p=be(be({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&t instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",t)):typeof FormData<"u"&&t instanceof FormData?(h=t,h.append("cacheControl",d.cacheControl)):(h=t,p["cache-control"]=`max-age=${d.cacheControl}`,p["content-type"]=d.contentType),{path:l,fullPath:(await M0(s.fetch,c.toString(),h,{headers:p})).Key}})}async createSignedUploadUrl(n,e){var t=this;return t.handleOperation(async()=>{let i=t._getFinalPath(n);const s=be({},t.headers);e?.upsert&&(s["x-upsert"]="true");const l=await fi(t.fetch,`${t.url}/object/upload/sign/${i}`,{},{headers:s}),a=new URL(t.url+l.url),c=a.searchParams.get("token");if(!c)throw new gd("No token returned by API");return{signedUrl:a.toString(),path:n,token:c}})}async update(n,e,t){return this.uploadOrUpdate("PUT",n,e,t)}async move(n,e,t){var i=this;return i.handleOperation(async()=>await fi(i.fetch,`${i.url}/object/move`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:i.headers}))}async copy(n,e,t){var i=this;return i.handleOperation(async()=>({path:(await fi(i.fetch,`${i.url}/object/copy`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:i.headers})).Key}))}async createSignedUrl(n,e,t){var i=this;return i.handleOperation(async()=>{let s=i._getFinalPath(n),l=await fi(i.fetch,`${i.url}/object/sign/${s}`,be({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:i.headers});const a=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{signedUrl:encodeURI(`${i.url}${l.signedURL}${a}`)}})}async createSignedUrls(n,e,t){var i=this;return i.handleOperation(async()=>{const s=await fi(i.fetch,`${i.url}/object/sign/${i.bucketId}`,{expiresIn:e,paths:n},{headers:i.headers}),l=t?.download?`&download=${t.download===!0?"":t.download}`:"";return s.map(a=>be(be({},a),{},{signedUrl:a.signedURL?encodeURI(`${i.url}${a.signedURL}${l}`):null}))})}download(n,e){const t=typeof e?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(e?.transform||{}),s=i?`?${i}`:"",l=this._getFinalPath(n),a=()=>mc(this.fetch,`${this.url}/${t}/${l}${s}`,{headers:this.headers,noResolveJson:!0});return new LM(a,this.shouldThrowOnError)}async info(n){var e=this;const t=e._getFinalPath(n);return e.handleOperation(async()=>R0(await mc(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})))}async exists(n){var e=this;const t=e._getFinalPath(n);try{return await MM(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(md(i)&&i instanceof jO){const s=i.originalError;if([400,404].includes(s?.status))return{data:!1,error:i}}throw i}}getPublicUrl(n,e){const t=this._getFinalPath(n),i=[],s=e?.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&i.push(s);const l=typeof e?.transform<"u"?"render/image":"object",a=this.transformOptsToQueryString(e?.transform||{});a!==""&&i.push(a);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${c}`)}}}async remove(n){var e=this;return e.handleOperation(async()=>await Wy(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:n},{headers:e.headers}))}async list(n,e,t){var i=this;return i.handleOperation(async()=>{const s=be(be(be({},BM),e),{},{prefix:n||""});return await fi(i.fetch,`${i.url}/object/list/${i.bucketId}`,s,{headers:i.headers},t)})}async listV2(n,e){var t=this;return t.handleOperation(async()=>{const i=be({},n);return await fi(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,i,{headers:t.headers},e)})}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}};const UM="2.95.2",Fc={"X-Client-Info":`storage-js/${UM}`};var zM=class extends qo{constructor(n,e={},t,i){const s=new URL(n);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."));const l=s.href.replace(/\/$/,""),a=be(be({},Fc),e);super(l,a,t,"storage")}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=e.listBucketOptionsToQueryString(n);return await mc(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers})})}async getBucket(n){var e=this;return e.handleOperation(async()=>await mc(e.fetch,`${e.url}/bucket/${n}`,{headers:e.headers}))}async createBucket(n,e={public:!1}){var t=this;return t.handleOperation(async()=>await fi(t.fetch,`${t.url}/bucket`,{id:n,name:n,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async updateBucket(n,e){var t=this;return t.handleOperation(async()=>await M0(t.fetch,`${t.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async emptyBucket(n){var e=this;return e.handleOperation(async()=>await fi(e.fetch,`${e.url}/bucket/${n}/empty`,{},{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await Wy(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(n){const e={};return n&&("limit"in n&&(e.limit=String(n.limit)),"offset"in n&&(e.offset=String(n.offset)),n.search&&(e.search=n.search),n.sortColumn&&(e.sortColumn=n.sortColumn),n.sortOrder&&(e.sortOrder=n.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},IM=class extends qo{constructor(n,e={},t){const i=n.replace(/\/$/,""),s=be(be({},Fc),e);super(i,s,t,"storage")}async createBucket(n){var e=this;return e.handleOperation(async()=>await fi(e.fetch,`${e.url}/bucket`,{name:n},{headers:e.headers}))}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=new URLSearchParams;n?.limit!==void 0&&t.set("limit",n.limit.toString()),n?.offset!==void 0&&t.set("offset",n.offset.toString()),n?.sortColumn&&t.set("sortColumn",n.sortColumn),n?.sortOrder&&t.set("sortOrder",n.sortOrder),n?.search&&t.set("search",n.search);const i=t.toString(),s=i?`${e.url}/bucket?${i}`:`${e.url}/bucket`;return await mc(e.fetch,s,{headers:e.headers})})}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await Wy(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}from(n){var e=this;if(!OM(n))throw new gd("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new kM({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(t,{get(s,l){const a=s[l];return typeof a!="function"?a:async(...c)=>{try{return{data:await a.apply(s,c),error:null}}catch(h){if(i)throw h;return{data:null,error:h}}}}})}},PM=class extends qo{constructor(n,e={},t){const i=n.replace(/\/$/,""),s=be(be({},Fc),{},{"Content-Type":"application/json"},e);super(i,s,t,"vectors")}async createIndex(n){var e=this;return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/CreateIndex`,n,{headers:e.headers})||{})}async getIndex(n,e){var t=this;return t.handleOperation(async()=>await zn.post(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers}))}async listIndexes(n){var e=this;return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/ListIndexes`,n,{headers:e.headers}))}async deleteIndex(n,e){var t=this;return t.handleOperation(async()=>await zn.post(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers})||{})}},HM=class extends qo{constructor(n,e={},t){const i=n.replace(/\/$/,""),s=be(be({},Fc),{},{"Content-Type":"application/json"},e);super(i,s,t,"vectors")}async putVectors(n){var e=this;if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/PutVectors`,n,{headers:e.headers})||{})}async getVectors(n){var e=this;return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/GetVectors`,n,{headers:e.headers}))}async listVectors(n){var e=this;if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/ListVectors`,n,{headers:e.headers}))}async queryVectors(n){var e=this;return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/QueryVectors`,n,{headers:e.headers}))}async deleteVectors(n){var e=this;if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/DeleteVectors`,n,{headers:e.headers})||{})}},qM=class extends qo{constructor(n,e={},t){const i=n.replace(/\/$/,""),s=be(be({},Fc),{},{"Content-Type":"application/json"},e);super(i,s,t,"vectors")}async createBucket(n){var e=this;return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}async getBucket(n){var e=this;return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:n},{headers:e.headers}))}async listBuckets(n={}){var e=this;return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/ListVectorBuckets`,n,{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await zn.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}},VM=class extends qM{constructor(n,e={}){super(n,e.headers||{},e.fetch)}from(n){return new $M(this.url,this.headers,n,this.fetch)}async createBucket(n){var e=()=>super.createBucket,t=this;return e().call(t,n)}async getBucket(n){var e=()=>super.getBucket,t=this;return e().call(t,n)}async listBuckets(n={}){var e=()=>super.listBuckets,t=this;return e().call(t,n)}async deleteBucket(n){var e=()=>super.deleteBucket,t=this;return e().call(t,n)}},$M=class extends PM{constructor(n,e,t,i){super(n,e,i),this.vectorBucketName=t}async createIndex(n){var e=()=>super.createIndex,t=this;return e().call(t,be(be({},n),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(n={}){var e=()=>super.listIndexes,t=this;return e().call(t,be(be({},n),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(n){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,n)}async deleteIndex(n){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,n)}index(n){return new GM(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},GM=class extends HM{constructor(n,e,t,i,s){super(n,e,s),this.vectorBucketName=t,this.indexName=i}async putVectors(n){var e=()=>super.putVectors,t=this;return e().call(t,be(be({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(n){var e=()=>super.getVectors,t=this;return e().call(t,be(be({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(n={}){var e=()=>super.listVectors,t=this;return e().call(t,be(be({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(n){var e=()=>super.queryVectors,t=this;return e().call(t,be(be({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(n){var e=()=>super.deleteVectors,t=this;return e().call(t,be(be({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},KM=class extends zM{constructor(n,e={},t,i){super(n,e,t,i)}from(n){return new jM(this.url,this.headers,n,this.fetch)}get vectors(){return new VM(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new IM(this.url+"/iceberg",this.headers,this.fetch)}};const IO="2.95.2",to=30*1e3,N0=3,vm=N0*to,WM="http://localhost:9999",FM="supabase.auth.token",YM={"X-Client-Info":`gotrue-js/${IO}`},L0="X-Supabase-Api-Version",PO={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},XM=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,QM=600*1e3;class yc extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function ce(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class JM extends yc{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function ZM(n){return ce(n)&&n.name==="AuthApiError"}class zr extends yc{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ws extends yc{constructor(e,t,i,s){super(e,i,s),this.name=t,this.status=i}}class Nn extends ws{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function wm(n){return ce(n)&&n.name==="AuthSessionMissingError"}class Wl extends ws{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Mh extends ws{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Nh extends ws{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function eN(n){return ce(n)&&n.name==="AuthImplicitGrantRedirectError"}class Tk extends ws{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class tN extends ws{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class B0 extends ws{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Sm(n){return ce(n)&&n.name==="AuthRetryableFetchError"}class Ek extends ws{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class j0 extends ws{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const xf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Dk=` 	
\r=`.split(""),nN=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Dk.length;e+=1)n[Dk[e].charCodeAt(0)]=-2;for(let e=0;e<xf.length;e+=1)n[xf[e].charCodeAt(0)]=e;return n})();function Rk(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(xf[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(xf[i]),e.queuedBits-=6}}function HO(n,e,t){const i=nN[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Mk(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},i={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=a=>{rN(a,i,t)};for(let a=0;a<n.length;a+=1)HO(n.charCodeAt(a),s,l);return e.join("")}function iN(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function sN(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const s=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}iN(i,e)}}function rN(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function fo(n){const e=[],t={queue:0,queuedBits:0},i=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)HO(n.charCodeAt(s),t,i);return new Uint8Array(e)}function lN(n){const e=[];return sN(n,t=>e.push(t)),new Uint8Array(e)}function Hr(n){const e=[],t={queue:0,queuedBits:0},i=s=>{e.push(s)};return n.forEach(s=>Rk(s,t,i)),Rk(null,t,i),e.join("")}function oN(n){return Math.round(Date.now()/1e3)+n}function aN(){return Symbol("auth-callback")}const qt=()=>typeof window<"u"&&typeof document<"u",Mr={tested:!1,writable:!1},qO=()=>{if(!qt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Mr.tested)return Mr.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Mr.tested=!0,Mr.writable=!0}catch{Mr.tested=!0,Mr.writable=!1}return Mr.writable};function cN(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,l)=>{e[l]=s})}catch{}return t.searchParams.forEach((i,s)=>{e[s]=i}),e}const VO=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),uN=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",no=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Nr=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ht=async(n,e)=>{await n.removeItem(e)};class yd{constructor(){this.promise=new yd.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}yd.promiseConstructor=Promise;function Lh(n){const e=n.split(".");if(e.length!==3)throw new j0("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!XM.test(e[i]))throw new j0("JWT not in base64url format");return{header:JSON.parse(Mk(e[0])),payload:JSON.parse(Mk(e[1])),signature:fo(e[2]),raw:{header:e[0],payload:e[1]}}}async function hN(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function fN(n,e){return new Promise((i,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const a=await n(l);if(!e(l,null,a)){i(a);return}}catch(a){if(!e(l,a)){s(a);return}}})()})}function dN(n){return("0"+n.toString(16)).substr(-2)}function pN(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let s="";for(let l=0;l<56;l++)s+=t.charAt(Math.floor(Math.random()*i));return s}return crypto.getRandomValues(e),Array.from(e,dN).join("")}async function gN(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(i);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function mN(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await gN(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Fl(n,e,t=!1){const i=pN();let s=i;t&&(s+="/PASSWORD_RECOVERY"),await no(n,`${e}-code-verifier`,s);const l=await mN(i);return[l,i===l?"plain":"s256"]}const yN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function bN(n){const e=n.headers.get(L0);if(!e||!e.match(yN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function vN(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function wN(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const SN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Yl(n){if(!SN.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function km(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function kN(n,e){return new Proxy(n,{get:(t,i,s)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const l=i.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,i,s)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,i,s)}})}function Nk(n){return JSON.parse(JSON.stringify(n))}const Br=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),xN=[502,503,504];async function Lk(n){var e;if(!uN(n))throw new B0(Br(n),0);if(xN.includes(n.status))throw new B0(Br(n),n.status);let t;try{t=await n.json()}catch(l){throw new zr(Br(l),l)}let i;const s=bN(n);if(s&&s.getTime()>=PO["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new Ek(Br(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Nn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,a)=>l&&typeof a=="string",!0))throw new Ek(Br(t),n.status,t.weak_password.reasons);throw new JM(Br(t),n.status||500,i)}const _N=(n,e,t,i)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(i),Object.assign(Object.assign({},s),t))};async function me(n,e,t,i){var s;const l=Object.assign({},i?.headers);l[L0]||(l[L0]=PO["2024-01-01"].name),i?.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const a=(s=i?.query)!==null&&s!==void 0?s:{};i?.redirectTo&&(a.redirect_to=i.redirectTo);const c=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",h=await ON(n,e,t+c,{headers:l,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(h):{data:Object.assign({},h),error:null}}async function ON(n,e,t,i,s,l){const a=_N(e,i,s,l);let c;try{c=await n(t,Object.assign({},a))}catch(h){throw console.error(h),new B0(Br(h),0)}if(c.ok||await Lk(c),i?.noResolveJson)return c;try{return await c.json()}catch(h){await Lk(h)}}function hi(n){var e;let t=null;TN(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=oN(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function Bk(n){const e=hi(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Qs(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function AN(n){return{data:n,error:null}}function CN(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:s,verification_type:l}=n,a=pd(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:i,redirect_to:s,verification_type:l},h=Object.assign({},a);return{data:{properties:c,user:h},error:null}}function jk(n){return n}function TN(n){return n.access_token&&n.refresh_token&&n.expires_in}const xm=["global","local","others"];class EN{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=VO(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=xm[0]){if(xm.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${xm.join(", ")}`);try{return await me(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(ce(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Qs})}catch(i){if(ce(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=pd(e,["options"]),s=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(s.new_email=i?.newEmail,delete s.newEmail),await me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:CN,redirectTo:t?.redirectTo})}catch(t){if(ce(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Qs})}catch(t){if(ce(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,s,l,a,c,h;try{const d={nextPage:null,lastPage:0,total:0},p=await me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:jk});if(p.error)throw p.error;const m=await p.json(),b=(a=p.headers.get("x-total-count"))!==null&&a!==void 0?a:0,v=(h=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(w=>{const k=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(w.split(";")[1].split("=")[1]);d[`${_}Page`]=k}),d.total=parseInt(b)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(ce(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Yl(e);try{return await me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Qs})}catch(t){if(ce(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Yl(e);try{return await me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Qs})}catch(i){if(ce(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){Yl(e);try{return await me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Qs})}catch(i){if(ce(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){Yl(e.userId);try{const{data:t,error:i}=await me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:i}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Yl(e.userId),Yl(e.id);try{return{data:await me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,i,s,l,a,c,h;try{const d={nextPage:null,lastPage:0,total:0},p=await me(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:jk});if(p.error)throw p.error;const m=await p.json(),b=(a=p.headers.get("x-total-count"))!==null&&a!==void 0?a:0,v=(h=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(w=>{const k=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(w.split(";")[1].split("=")[1]);d[`${_}Page`]=k}),d.total=parseInt(b)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(ce(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await me(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await me(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await me(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(ce(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await me(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await me(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}}function Uk(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Xl={debug:!!(globalThis&&qO()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class $O extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class DN extends $O{}async function RN(n,e,t){Xl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),Xl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async s=>{if(s){Xl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Xl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Xl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new DN(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Xl.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function MN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function GO(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function NN(n){return parseInt(n,16)}function LN(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function BN(n){var e;const{chainId:t,domain:i,expirationTime:s,issuedAt:l=new Date,nonce:a,notBefore:c,requestId:h,resources:d,scheme:p,uri:m,version:b}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(b!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${b}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const v=GO(n.address),w=p?`${p}://${i}`:i,k=n.statement?`${n.statement}
`:"",_=`${w} wants you to sign in with your Ethereum account:
${v}

${k}`;let O=`URI: ${m}
Version: ${b}
Chain ID: ${t}${a?`
Nonce: ${a}`:""}
Issued At: ${l.toISOString()}`;if(s&&(O+=`
Expiration Time: ${s.toISOString()}`),c&&(O+=`
Not Before: ${c.toISOString()}`),h&&(O+=`
Request ID: ${h}`),d){let R=`
Resources:`;for(const C of d){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);R+=`
- ${C}`}O+=R}return`${_}
${O}`}class St extends Error{constructor({message:e,code:t,cause:i,name:s}){var l;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(l=s??(i instanceof Error?i.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=t}}class _f extends St{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function jN({error:n,options:e}){var t,i,s;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new St({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=l.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new St({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new St({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new St({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new St({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new St({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return l.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new St({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new St({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const a=window.location.hostname;if(KO(a)){if(l.rp.id!==a)return new St({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new St({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new St({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new St({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new St({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function UN({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new St({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new St({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(KO(i)){if(t.rpId!==i)return new St({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new St({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new St({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new St({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class zN{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const IN=new zN;function PN(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:i}=n,s=pd(n,["challenge","user","excludeCredentials"]),l=fo(e).buffer,a=Object.assign(Object.assign({},t),{id:fo(t.id).buffer}),c=Object.assign(Object.assign({},s),{challenge:l,user:a});if(i&&i.length>0){c.excludeCredentials=new Array(i.length);for(let h=0;h<i.length;h++){const d=i[h];c.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:fo(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return c}function HN(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,i=pd(n,["challenge","allowCredentials"]),s=fo(e).buffer,l=Object.assign(Object.assign({},i),{challenge:s});if(t&&t.length>0){l.allowCredentials=new Array(t.length);for(let a=0;a<t.length;a++){const c=t[a];l.allowCredentials[a]=Object.assign(Object.assign({},c),{id:fo(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return l}function qN(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Hr(new Uint8Array(n.response.attestationObject)),clientDataJSON:Hr(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function VN(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,i=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Hr(new Uint8Array(s.authenticatorData)),clientDataJSON:Hr(new Uint8Array(s.clientDataJSON)),signature:Hr(new Uint8Array(s.signature)),userHandle:s.userHandle?Hr(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function KO(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function zk(){var n,e;return!!(qt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function $N(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new _f("Browser returned unexpected credential type",e)}:{data:null,error:new _f("Empty credential response",e)}}catch(e){return{data:null,error:jN({error:e,options:n})}}}async function GN(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new _f("Browser returned unexpected credential type",e)}:{data:null,error:new _f("Empty credential response",e)}}catch(e){return{data:null,error:UN({error:e,options:n})}}}const KN={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},WN={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Of(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),i={};for(const s of n)if(s)for(const l in s){const a=s[l];if(a!==void 0)if(Array.isArray(a))i[l]=a;else if(t(a))i[l]=a;else if(e(a)){const c=i[l];e(c)?i[l]=Of(c,a):i[l]=Of(a)}else i[l]=a}return i}function FN(n,e){return Of(KN,n,e||{})}function YN(n,e){return Of(WN,n,e||{})}class XN{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:s},l){var a;try{const{data:c,error:h}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:h};const d=s??IN.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:p}=c.webauthn.credential_options.publicKey;if(!p.name){const m=i;if(m)p.name=`${p.id}:${m}`;else{const v=(await this.client.getUser()).data.user,w=((a=v?.user_metadata)===null||a===void 0?void 0:a.name)||v?.email||v?.id||"User";p.name=`${p.id}:${w}`}}p.displayName||(p.displayName=p.name)}switch(c.webauthn.type){case"create":{const p=FN(c.webauthn.credential_options.publicKey,l?.create),{data:m,error:b}=await $N({publicKey:p,signal:d});return m?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:m}},error:null}:{data:null,error:b}}case"request":{const p=YN(c.webauthn.credential_options.publicKey,l?.request),{data:m,error:b}=await GN(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:p,signal:d}));return m?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:m}},error:null}:{data:null,error:b}}}}catch(c){return ce(c)?{data:null,error:c}:{data:null,error:new zr("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!t)return{data:null,error:new yc("rpId is required for WebAuthn authentication")};try{if(!zk())return{data:null,error:new zr("Browser does not support WebAuthn",null)};const{data:a,error:c}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:s},{request:l});if(!a)return{data:null,error:c};const{webauthn:h}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:h.type,rpId:t,rpOrigins:i,credential_response:h.credential_response}})}catch(a){return ce(a)?{data:null,error:a}:{data:null,error:new zr("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!t)return{data:null,error:new yc("rpId is required for WebAuthn registration")};try{if(!zk())return{data:null,error:new zr("Browser does not support WebAuthn",null)};const{data:a,error:c}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(p=>{var m;return(m=p.data)===null||m===void 0?void 0:m.all.find(b=>b.factor_type==="webauthn"&&b.friendly_name===e&&b.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:c};const{data:h,error:d}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:s},{create:l});return h?this._verify({factorId:a.id,challengeId:h.challengeId,webauthn:{rpId:t,rpOrigins:i,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(a){return ce(a)?{data:null,error:a}:{data:null,error:new zr("Unexpected error in register",a)}}}}MN();const QN={url:WM,storageKey:FM,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:YM,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Ik(n,e,t){return await t()}const Ql={};class bc{get jwks(){var e,t;return(t=(e=Ql[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Ql[this.storageKey]=Object.assign(Object.assign({},Ql[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Ql[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ql[this.storageKey]=Object.assign(Object.assign({},Ql[this.storageKey]),{cachedAt:e})}constructor(e){var t,i,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},QN),e);if(this.storageKey=l.storageKey,this.instanceID=(t=bc.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,bc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&qt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new EN({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=VO(l.fetch),this.lock=l.lock||Ik,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&qt()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=RN:this.lock=Ik,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new XN(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:qO()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Uk(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=Uk(this.memoryStorage)),qt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a);try{await this._notifyAllSubscribers(a.data.event,a.data.session,!1)}catch(c){this._debug("#broadcastChannel","error",c)}})}this.initialize().catch(a=>{this._debug("#initialize()","error",a)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${IO}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},i="none";if(qt()&&(t=cN(window.location.href),this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce")),qt()&&this.detectSessionInUrl&&i!=="none"){const{data:s,error:l}=await this._getSessionFromURL(t,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),eN(l)){const h=(e=l.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:a,redirectType:c}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",c),await this._saveSession(a),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ce(t)?this._returnResult({error:t}):this._returnResult({error:new zr("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,s;try{const l=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:hi}),{data:a,error:c}=l;if(c||!a)return this._returnResult({data:{user:null,session:null},error:c});const h=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(ce(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var t,i,s;try{let l;if("email"in e){const{email:p,password:m,options:b}=e;let v=null,w=null;this.flowType==="pkce"&&([v,w]=await Fl(this.storage,this.storageKey)),l=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b?.emailRedirectTo,body:{email:p,password:m,data:(t=b?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:b?.captchaToken},code_challenge:v,code_challenge_method:w},xform:hi})}else if("phone"in e){const{phone:p,password:m,options:b}=e;l=await me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:m,data:(i=b?.data)!==null&&i!==void 0?i:{},channel:(s=b?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:hi})}else throw new Mh("You must provide either an email or phone number and a password");const{data:a,error:c}=l;if(c||!a)return await Ht(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const h=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:a,options:c}=e;t=await me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:a,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Bk})}else if("phone"in e){const{phone:l,password:a,options:c}=e;t=await me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:a,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Bk})}else throw new Mh("You must provide either an email or phone number and a password");const{data:i,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!i||!i.session||!i.user){const l=new Wl;return this._returnResult({data:{user:null,session:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:s})}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,i,s,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,s,l,a,c,h,d,p,m,b;let v,w;if("message"in e)v=e.message,w=e.signature;else{const{chain:k,wallet:_,statement:O,options:R}=e;let C;if(qt())if(typeof _=="object")C=_;else{const ne=window;if("ethereum"in ne&&typeof ne.ethereum=="object"&&"request"in ne.ethereum&&typeof ne.ethereum.request=="function")C=ne.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!R?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=_}const U=new URL((t=R?.url)!==null&&t!==void 0?t:window.location.href),B=await C.request({method:"eth_requestAccounts"}).then(ne=>ne).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!B||B.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const z=GO(B[0]);let D=(i=R?.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!D){const ne=await C.request({method:"eth_chainId"});D=NN(ne)}const W={domain:U.host,address:z,statement:O,uri:U.href,version:"1",chainId:D,nonce:(s=R?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(a=(l=R?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(c=R?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(h=R?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=R?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(p=R?.signInWithEthereum)===null||p===void 0?void 0:p.resources};v=BN(W),w=await C.request({method:"personal_sign",params:[LN(v),z]})}try{const{data:k,error:_}=await me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:w},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(b=e.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:hi});if(_)throw _;if(!k||!k.session||!k.user){const O=new Wl;return this._returnResult({data:{user:null,session:null},error:O})}return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),this._returnResult({data:Object.assign({},k),error:_})}catch(k){if(ce(k))return this._returnResult({data:{user:null,session:null},error:k});throw k}}async signInWithSolana(e){var t,i,s,l,a,c,h,d,p,m,b,v;let w,k;if("message"in e)w=e.message,k=e.signature;else{const{chain:_,wallet:O,statement:R,options:C}=e;let U;if(qt())if(typeof O=="object")U=O;else{const z=window;if("solana"in z&&typeof z.solana=="object"&&("signIn"in z.solana&&typeof z.solana.signIn=="function"||"signMessage"in z.solana&&typeof z.solana.signMessage=="function"))U=z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");U=O}const B=new URL((t=C?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in U&&U.signIn){const z=await U.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:B.host,uri:B.href}),R?{statement:R}:null));let D;if(Array.isArray(z)&&z[0]&&typeof z[0]=="object")D=z[0];else if(z&&typeof z=="object"&&"signedMessage"in z&&"signature"in z)D=z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)w=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),k=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in U)||typeof U.signMessage!="function"||!("publicKey"in U)||typeof U!="object"||!U.publicKey||!("toBase58"in U.publicKey)||typeof U.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${B.host} wants you to sign in with your Solana account:`,U.publicKey.toBase58(),...R?["",R,""]:[""],"Version: 1",`URI: ${B.href}`,`Issued At: ${(s=(i=C?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=C?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((a=C?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((c=C?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((h=C?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((d=C?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((m=(p=C?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||m===void 0)&&m.length?["Resources",...C.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const z=await U.signMessage(new TextEncoder().encode(w),"utf8");if(!z||!(z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=z}}try{const{data:_,error:O}=await me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Hr(k)},!((b=e.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:hi});if(O)throw O;if(!_||!_.session||!_.user){const R=new Wl;return this._returnResult({data:{user:null,session:null},error:R})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:O})}catch(_){if(ce(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(e){const t=await Nr(this.storage,`${this.storageKey}-code-verifier`),[i,s]=(t??"").split("/");try{if(!i&&this.flowType==="pkce")throw new tN;const{data:l,error:a}=await me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:hi});if(await Ht(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!l||!l.session||!l.user){const c=new Wl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:a})}catch(l){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:t,provider:i,token:s,access_token:l,nonce:a}=e,c=await me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:s,access_token:l,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:hi}),{data:h,error:d}=c;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!h||!h.session||!h.user){const p=new Wl;return this._returnResult({data:{user:null,session:null},error:p})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:d})}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,i,s,l,a;try{if("email"in e){const{email:c,options:h}=e;let d=null,p=null;this.flowType==="pkce"&&([d,p]=await Fl(this.storage,this.storageKey));const{error:m}=await me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=h?.data)!==null&&t!==void 0?t:{},create_user:(i=h?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:p},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:c,options:h}=e,{data:d,error:p}=await me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(s=h?.data)!==null&&s!==void 0?s:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(a=h?.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:p})}throw new Mh("You must provide either an email or phone number.")}catch(c){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var t,i;try{let s,l;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:a,error:c}=await me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:hi});if(c)throw c;if(!a)throw new Error("An error occurred on token verification.");const h=a.session,d=a.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(s){if(ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,i,s,l,a;try{let c=null,h=null;this.flowType==="pkce"&&([c,h]=await Fl(this.storage,this.storageKey));const d=await me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:h}),headers:this.headers,xform:AN});return!((l=d.data)===null||l===void 0)&&l.url&&qt()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(c){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new Nn;const{error:s}=await me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(ce(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:s,options:l}=e,{error:a}=await me(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:i,type:s,options:l}=e,{data:a,error:c}=await me(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a?.message_id},error:c})}throw new Mh("You must provide either an email or phone number and a type")}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Nr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<vm:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const a=await Nr(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=km()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=kN(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Qs}):await this._useSession(async t=>{var i,s,l;const{data:a,error:c}=t;if(c)throw c;return!(!((i=a.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Nn}:await me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:Qs})})}catch(t){if(ce(t))return wm(t)&&(await this._removeSession(),await Ht(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:s,error:l}=i;if(l)throw l;if(!s.session)throw new Nn;const a=s.session;let c=null,h=null;this.flowType==="pkce"&&e.email!=null&&([c,h]=await Fl(this.storage,this.storageKey));const{data:d,error:p}=await me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:h}),jwt:a.access_token,xform:Qs});if(p)throw p;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(i){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Nn;const t=Date.now()/1e3;let i=t,s=!0,l=null;const{payload:a}=Lh(e.access_token);if(a.exp&&(i=a.exp,s=i<=t),s){const{data:c,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!c)return{data:{user:null,session:null},error:null};l=c}else{const{data:c,error:h}=await this._getUser(e.access_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});l={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(t){if(ce(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:a,error:c}=t;if(c)throw c;e=(i=a.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new Nn;const{data:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!qt())throw new Nh("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Nh(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Tk("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Nh("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Tk("No code detected.");const{data:R,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const U=new URL(window.location.href);return U.searchParams.delete("code"),window.history.replaceState(window.history.state,"",U.toString()),{data:{session:R.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:s,access_token:l,refresh_token:a,expires_in:c,expires_at:h,token_type:d}=e;if(!l||!c||!a||!d)throw new Nh("No session defined in URL");const p=Math.round(Date.now()/1e3),m=parseInt(c);let b=p+m;h&&(b=parseInt(h));const v=b-p;v*1e3<=to&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${m}s`);const w=b-m;p-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,b,p):p-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,b,p);const{data:k,error:_}=await this._getUser(l);if(_)throw _;const O={provider_token:i,provider_refresh_token:s,access_token:l,expires_in:m,expires_at:b,refresh_token:a,token_type:d,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:O,redirectType:e.type},error:null})}catch(i){if(ce(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Nr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:s,error:l}=t;if(l&&!wm(l))return this._returnResult({error:l});const a=(i=s.session)===null||i===void 0?void 0:i.access_token;if(a){const{error:c}=await this.admin.signOut(a,e);if(c&&!(ZM(c)&&(c.status===404||c.status===401||c.status===403)||wm(c)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await Ht(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=aN(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,s;try{const{data:{session:l},error:a}=t;if(a)throw a;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let i=null,s=null;this.flowType==="pkce"&&([i,s]=await Fl(this.storage,this.storageKey,!0));try{return await me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:i,error:s}=await this._useSession(async l=>{var a,c,h,d,p;const{data:m,error:b}=l;if(b)throw b;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await me(this.fetch,"GET",v,{headers:this.headers,jwt:(p=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&p!==void 0?p:void 0})});if(s)throw s;return qt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i?.url),this._returnResult({data:{provider:e.provider,url:i?.url},error:null})}catch(i){if(ce(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{const{error:s,data:{session:l}}=t;if(s)throw s;const{options:a,provider:c,token:h,access_token:d,nonce:p}=e,m=await me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=l?.access_token)!==null&&i!==void 0?i:void 0,body:{provider:c,id_token:h,access_token:d,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:hi}),{data:b,error:v}=m;return v?this._returnResult({data:{user:null,session:null},error:v}):!b||!b.session||!b.user?this._returnResult({data:{user:null,session:null},error:new Wl}):(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("USER_UPDATED",b.session)),this._returnResult({data:b,error:v}))}catch(s){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,s;const{data:l,error:a}=t;if(a)throw a;return await me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await fN(async s=>(s>0&&await hN(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:hi})),(s,l)=>{const a=200*Math.pow(2,s);return l&&Sm(l)&&Date.now()+a-i<to})}catch(i){if(this._debug(t,"error",i),ce(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),qt()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const s=await Nr(this.storage,this.storageKey);if(s&&this.userStorage){let a=await Nr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await no(this.userStorage,this.storageKey+"-user",a)),s.user=(e=a?.user)!==null&&e!==void 0?e:km()}else if(s&&!s.user&&!s.user){const a=await Nr(this.storage,this.storageKey+"-user");a&&a?.user?(s.user=a.user,await Ht(this.storage,this.storageKey+"-user"),await no(this.storage,this.storageKey,s)):s.user=km()}if(this._debug(i,"session from storage",s),!this._isValidSession(s)){this._debug(i,"session is not valid"),s!==null&&await this._removeSession();return}const l=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<vm;if(this._debug(i,`session has${l?"":" not"} expired with margin of ${vm}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),Sm(a)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:c}=await this._getUser(s.access_token);!c&&a?.user?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(i,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(i,"error",s),console.error(s);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new Nn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new yd;const{data:l,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!l.session)throw new Nn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const c={data:l.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(l){if(this._debug(s,"error",l),ce(l)){const a={data:null,error:l};return Sm(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,i=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],a=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(h){l.push(h)}});if(await Promise.all(a),l.length>0){for(let c=0;c<l.length;c+=1)console.error(l[c]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ht(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await no(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const l=Nk(s);await no(this.storage,this.storageKey,l)}else{const s=Nk(t);await no(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ht(this.storage,this.storageKey),await Ht(this.storage,this.storageKey+"-code-verifier"),await Ht(this.storage,this.storageKey+"-user"),this.userStorage&&await Ht(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&qt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),to);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((i.expires_at*1e3-e)/to);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${to}ms, refresh threshold is ${N0} ticks`),s<=N0&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof $O)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const s=[`provider=${encodeURIComponent(t)}`];if(i?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&s.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,a]=await Fl(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(c.toString())}if(i?.queryParams){const l=new URLSearchParams(i.queryParams);s.push(l.toString())}return i?.skipBrowserRedirect&&s.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:s,error:l}=t;return l?this._returnResult({data:null,error:l}):await me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,s;const{data:l,error:a}=t;if(a)return this._returnResult({data:null,error:a});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:d}=await me(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(i=l?.session)===null||i===void 0?void 0:i.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&h.type==="totp"&&(!((s=h?.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:s,error:l}=t;if(l)return this._returnResult({data:null,error:l});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?qN(e.webauthn.credential_response):VN(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:h}=await me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:h}))})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:s,error:l}=t;if(l)return this._returnResult({data:null,error:l});const a=await me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token});if(a.error)return a;const{data:c}=a;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:PN(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:HN(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};const s={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(l),l.status==="verified"&&s[l.factor_type].push(l);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,i,s,l;if(e)try{const{payload:v}=Lh(e);let w=null;v.aal&&(w=v.aal);let k=w;const{data:{user:_},error:O}=await this.getUser(e);if(O)return this._returnResult({data:null,error:O});((i=(t=_?.factors)===null||t===void 0?void 0:t.filter(U=>U.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(k="aal2");const C=v.amr||[];return{data:{currentLevel:w,nextLevel:k,currentAuthenticationMethods:C},error:null}}catch(v){if(ce(v))return this._returnResult({data:null,error:v});throw v}const{data:{session:a},error:c}=await this.getSession();if(c)return this._returnResult({data:null,error:c});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=Lh(a.access_token);let d=null;h.aal&&(d=h.aal);let p=d;((l=(s=a.user.factors)===null||s===void 0?void 0:s.filter(v=>v.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(p="aal2");const b=h.amr||[];return{data:{currentLevel:d,nextLevel:p,currentAuthenticationMethods:b},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:i},error:s}=t;return s?this._returnResult({data:null,error:s}):i?await me(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Nn})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:s},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new Nn});const a=await me(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return a.data&&a.data.redirect_url&&qt()&&!t?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:s},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new Nn});const a=await me(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return a.data&&a.data.redirect_url&&qt()&&!t?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;return i?this._returnResult({data:null,error:i}):t?await me(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Nn})})}catch(e){if(ce(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:i},error:s}=t;return s?this._returnResult({data:null,error:s}):i?(await me(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Nn})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(c=>c.kid===e);if(i)return i;const s=Date.now();if(i=this.jwks.keys.find(c=>c.kid===e),i&&this.jwks_cached_at+QM>s)return i;const{data:l,error:a}=await me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,i=l.keys.find(c=>c.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:v,error:w}=await this.getSession();if(w||!v.session)return this._returnResult({data:null,error:w});i=v.session.access_token}const{header:s,payload:l,signature:a,raw:{header:c,payload:h}}=Lh(i);t?.allowExpired||vN(l.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:v}=await this.getUser(i);if(v)throw v;return{data:{claims:l,header:s,signature:a},error:null}}const p=wN(s.alg),m=await crypto.subtle.importKey("jwk",d,p,!0,["verify"]);if(!await crypto.subtle.verify(p,m,a,lN(`${c}.${h}`)))throw new j0("Invalid JWT signature");return{data:{claims:l,header:s,signature:a},error:null}}catch(i){if(ce(i))return this._returnResult({data:null,error:i});throw i}}}bc.nextInstanceID={};const JN=bc,ZN="2.95.2";let Ja="";typeof Deno<"u"?Ja="deno":typeof document<"u"?Ja="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ja="react-native":Ja="node";const eL={"X-Client-Info":`supabase-js-${Ja}/${ZN}`},tL={headers:eL},nL={schema:"public"},iL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},sL={};function vc(n){"@babel/helpers - typeof";return vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vc(n)}function rL(n,e){if(vc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(vc(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function lL(n){var e=rL(n,"string");return vc(e)=="symbol"?e:e+""}function oL(n,e,t){return(e=lL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Pk(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function ct(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Pk(Object(t),!0).forEach(function(i){oL(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Pk(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const aL=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),cL=()=>Headers,uL=(n,e,t)=>{const i=aL(t),s=cL();return async(l,a)=>{var c;const h=(c=await e())!==null&&c!==void 0?c:n;let d=new s(a?.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),i(l,ct(ct({},a),{},{headers:d}))}};function hL(n){return n.endsWith("/")?n:n+"/"}function fL(n,e){var t,i;const{db:s,auth:l,realtime:a,global:c}=n,{db:h,auth:d,realtime:p,global:m}=e,b={db:ct(ct({},h),s),auth:ct(ct({},d),l),realtime:ct(ct({},p),a),storage:{},global:ct(ct(ct({},m),c),{},{headers:ct(ct({},(t=m?.headers)!==null&&t!==void 0?t:{}),(i=c?.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return n.accessToken?b.accessToken=n.accessToken:delete b.accessToken,b}function dL(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(hL(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var pL=class extends JN{constructor(n){super(n)}},gL=class{constructor(n,e,t){var i,s;this.supabaseUrl=n,this.supabaseKey=e;const l=dL(n);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const a=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:nL,realtime:sL,auth:ct(ct({},iL),{},{storageKey:a}),global:tL},h=fL(t??{},c);if(this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=h.auth)!==null&&d!==void 0?d:{},this.headers,h.global.fetch)}this.fetch=uL(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(ct({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new ZR(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch,timeout:h.db.timeout,urlLengthLimit:h.db.urlLengthLimit}),this.storage=new KM(this.storageUrl.href,this.headers,this.fetch,t?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new GR(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,e,t)}channel(n,e={config:{}}){return this.realtime.channel(n,e)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,e,t;if(n.accessToken)return await n.accessToken();const{data:i}=await n.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:s,storageKey:l,flowType:a,lock:c,debug:h,throwOnError:d},p,m){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new pL({url:this.authUrl.href,headers:ct(ct({},b),p),storageKey:l,autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:s,flowType:a,lock:c,debug:h,throwOnError:d,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new mM(this.realtimeUrl.href,ct(ct({},n),{},{params:ct(ct({},{apikey:this.supabaseKey}),n?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,e)=>{this._handleTokenChanged(n,"CLIENT",e?.access_token)})}_handleTokenChanged(n,e,t){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const mL=(n,e,t)=>new gL(n,e,t);function yL(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const e=n.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}yL()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const bn=()=>new Map,U0=n=>{const e=bn();return n.forEach((t,i)=>{e.set(i,t)}),e},Ss=(n,e,t)=>{let i=n.get(e);return i===void 0&&n.set(e,i=t()),i},bL=(n,e)=>{const t=[];for(const[i,s]of n)t.push(e(s,i));return t},vL=(n,e)=>{for(const[t,i]of n)if(e(i,t))return!0;return!1},Xr=()=>new Set,_m=n=>n[n.length-1],wL=(n,e)=>{for(let t=0;t<e.length;t++)n.push(e[t])},ys=Array.from,Fy=(n,e)=>{for(let t=0;t<n.length;t++)if(!e(n[t],t,n))return!1;return!0},Yy=(n,e)=>{for(let t=0;t<n.length;t++)if(e(n[t],t,n))return!0;return!1},SL=(n,e)=>{const t=new Array(n);for(let i=0;i<n;i++)t[i]=e(i,t);return t},Ao=Array.isArray;class WO{constructor(){this._observers=bn()}on(e,t){return Ss(this._observers,e,Xr).add(t),t}once(e,t){const i=(...s)=>{this.off(e,i),t(...s)};this.on(e,i)}off(e,t){const i=this._observers.get(e);i!==void 0&&(i.delete(t),i.size===0&&this._observers.delete(e))}emit(e,t){return ys((this._observers.get(e)||bn()).values()).forEach(i=>i(...t))}destroy(){this._observers=bn()}}class kL{constructor(){this._observers=bn()}on(e,t){Ss(this._observers,e,Xr).add(t)}once(e,t){const i=(...s)=>{this.off(e,i),t(...s)};this.on(e,i)}off(e,t){const i=this._observers.get(e);i!==void 0&&(i.delete(t),i.size===0&&this._observers.delete(e))}emit(e,t){return ys((this._observers.get(e)||bn()).values()).forEach(i=>i(...t))}destroy(){this._observers=bn()}}const vi=Math.floor,uf=Math.abs,Xy=(n,e)=>n<e?n:e,hr=(n,e)=>n>e?n:e,FO=n=>n!==0?n<0:1/n<0,Hk=1,qk=2,Om=4,Am=8,wc=32,ms=64,Pn=128,bd=31,z0=63,Gr=127,xL=2147483647,Af=Number.MAX_SAFE_INTEGER,Vk=Number.MIN_SAFE_INTEGER,_L=Number.isInteger||(n=>typeof n=="number"&&isFinite(n)&&vi(n)===n),OL=String.fromCharCode,AL=n=>n.toLowerCase(),CL=/^\s*/g,TL=n=>n.replace(CL,""),EL=/([A-Z])/g,$k=(n,e)=>TL(n.replace(EL,t=>`${e}${AL(t)}`)),DL=n=>{const e=unescape(encodeURIComponent(n)),t=e.length,i=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=e.codePointAt(s);return i},Sc=typeof TextEncoder<"u"?new TextEncoder:null,RL=n=>Sc.encode(n),ML=Sc?RL:DL;let rc=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});rc&&rc.decode(new Uint8Array).length===1&&(rc=null);const NL=(n,e)=>SL(e,()=>n).join("");class Yc{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Xc=()=>new Yc,LL=n=>{let e=n.cpos;for(let t=0;t<n.bufs.length;t++)e+=n.bufs[t].length;return e},gi=n=>{const e=new Uint8Array(LL(n));let t=0;for(let i=0;i<n.bufs.length;i++){const s=n.bufs[i];e.set(s,t),t+=s.length}return e.set(new Uint8Array(n.cbuf.buffer,0,n.cpos),t),e},BL=(n,e)=>{const t=n.cbuf.length;t-n.cpos<e&&(n.bufs.push(new Uint8Array(n.cbuf.buffer,0,n.cpos)),n.cbuf=new Uint8Array(hr(t,e)*2),n.cpos=0)},Mt=(n,e)=>{const t=n.cbuf.length;n.cpos===t&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(t*2),n.cpos=0),n.cbuf[n.cpos++]=e},I0=Mt,Ee=(n,e)=>{for(;e>Gr;)Mt(n,Pn|Gr&e),e=vi(e/128);Mt(n,Gr&e)},Qy=(n,e)=>{const t=FO(e);for(t&&(e=-e),Mt(n,(e>z0?Pn:0)|(t?ms:0)|z0&e),e=vi(e/64);e>0;)Mt(n,(e>Gr?Pn:0)|Gr&e),e=vi(e/128)},P0=new Uint8Array(3e4),jL=P0.length/3,UL=(n,e)=>{if(e.length<jL){const t=Sc.encodeInto(e,P0).written||0;Ee(n,t);for(let i=0;i<t;i++)Mt(n,P0[i])}else Ln(n,ML(e))},zL=(n,e)=>{const t=unescape(encodeURIComponent(e)),i=t.length;Ee(n,i);for(let s=0;s<i;s++)Mt(n,t.codePointAt(s))},Kr=Sc&&Sc.encodeInto?UL:zL,vd=(n,e)=>{const t=n.cbuf.length,i=n.cpos,s=Xy(t-i,e.length),l=e.length-s;n.cbuf.set(e.subarray(0,s),i),n.cpos+=s,l>0&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(hr(t*2,l)),n.cbuf.set(e.subarray(s)),n.cpos=l)},Ln=(n,e)=>{Ee(n,e.byteLength),vd(n,e)},Jy=(n,e)=>{BL(n,e);const t=new DataView(n.cbuf.buffer,n.cpos,e);return n.cpos+=e,t},IL=(n,e)=>Jy(n,4).setFloat32(0,e,!1),PL=(n,e)=>Jy(n,8).setFloat64(0,e,!1),HL=(n,e)=>Jy(n,8).setBigInt64(0,e,!1),Gk=new DataView(new ArrayBuffer(4)),qL=n=>(Gk.setFloat32(0,n),Gk.getFloat32(0)===n),kc=(n,e)=>{switch(typeof e){case"string":Mt(n,119),Kr(n,e);break;case"number":_L(e)&&uf(e)<=xL?(Mt(n,125),Qy(n,e)):qL(e)?(Mt(n,124),IL(n,e)):(Mt(n,123),PL(n,e));break;case"bigint":Mt(n,122),HL(n,e);break;case"object":if(e===null)Mt(n,126);else if(Ao(e)){Mt(n,117),Ee(n,e.length);for(let t=0;t<e.length;t++)kc(n,e[t])}else if(e instanceof Uint8Array)Mt(n,116),Ln(n,e);else{Mt(n,118);const t=Object.keys(e);Ee(n,t.length);for(let i=0;i<t.length;i++){const s=t[i];Kr(n,s),kc(n,e[s])}}break;case"boolean":Mt(n,e?120:121);break;default:Mt(n,127)}};class Kk extends Yc{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Ee(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const Wk=n=>{n.count>0&&(Qy(n.encoder,n.count===1?n.s:-n.s),n.count>1&&Ee(n.encoder,n.count-2))};class hf{constructor(){this.encoder=new Yc,this.s=0,this.count=0}write(e){this.s===e?this.count++:(Wk(this),this.count=1,this.s=e)}toUint8Array(){return Wk(this),gi(this.encoder)}}const Fk=n=>{if(n.count>0){const e=n.diff*2+(n.count===1?0:1);Qy(n.encoder,e),n.count>1&&Ee(n.encoder,n.count-2)}};class Cm{constructor(){this.encoder=new Yc,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(Fk(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return Fk(this),gi(this.encoder)}}class VL{constructor(){this.sarr=[],this.s="",this.lensE=new hf}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new Yc;return this.sarr.push(this.s),this.s="",Kr(e,this.sarr.join("")),vd(e,this.lensE.toUint8Array()),gi(e)}}const Ii=n=>new Error(n),bi=()=>{throw Ii("Method unimplemented")},Hn=()=>{throw Ii("Unexpected case")},YO=Ii("Unexpected end of array"),XO=Ii("Integer out of Range");class wd{constructor(e){this.arr=e,this.pos=0}}const sl=n=>new wd(n),$L=n=>n.pos!==n.arr.length,GL=(n,e)=>{const t=new Uint8Array(n.arr.buffer,n.pos+n.arr.byteOffset,e);return n.pos+=e,t},Bn=n=>GL(n,Ae(n)),Co=n=>n.arr[n.pos++],Ae=n=>{let e=0,t=1;const i=n.arr.length;for(;n.pos<i;){const s=n.arr[n.pos++];if(e=e+(s&Gr)*t,t*=128,s<Pn)return e;if(e>Af)throw XO}throw YO},Zy=n=>{let e=n.arr[n.pos++],t=e&z0,i=64;const s=(e&ms)>0?-1:1;if((e&Pn)===0)return s*t;const l=n.arr.length;for(;n.pos<l;){if(e=n.arr[n.pos++],t=t+(e&Gr)*i,i*=128,e<Pn)return s*t;if(t>Af)throw XO}throw YO},KL=n=>{let e=Ae(n);if(e===0)return"";{let t=String.fromCodePoint(Co(n));if(--e<100)for(;e--;)t+=String.fromCodePoint(Co(n));else for(;e>0;){const i=e<1e4?e:1e4,s=n.arr.subarray(n.pos,n.pos+i);n.pos+=i,t+=String.fromCodePoint.apply(null,s),e-=i}return decodeURIComponent(escape(t))}},WL=n=>rc.decode(Bn(n)),Wr=rc?WL:KL,eb=(n,e)=>{const t=new DataView(n.arr.buffer,n.arr.byteOffset+n.pos,e);return n.pos+=e,t},FL=n=>eb(n,4).getFloat32(0,!1),YL=n=>eb(n,8).getFloat64(0,!1),XL=n=>eb(n,8).getBigInt64(0,!1),QL=[n=>{},n=>null,Zy,FL,YL,XL,n=>!1,n=>!0,Wr,n=>{const e=Ae(n),t={};for(let i=0;i<e;i++){const s=Wr(n);t[s]=xc(n)}return t},n=>{const e=Ae(n),t=[];for(let i=0;i<e;i++)t.push(xc(n));return t},Bn],xc=n=>QL[127-Co(n)](n);class Yk extends wd{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),$L(this)?this.count=Ae(this)+1:this.count=-1),this.count--,this.s}}class ff extends wd{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=Zy(this);const e=FO(this.s);this.count=1,e&&(this.s=-this.s,this.count=Ae(this)+2)}return this.count--,this.s}}class Tm extends wd{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=Zy(this),t=e&1;this.diff=vi(e/2),this.count=1,t&&(this.count=Ae(this)+2)}return this.s+=this.diff,this.count--,this.s}}class JL{constructor(e){this.decoder=new ff(e),this.str=Wr(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const ZL=crypto.getRandomValues.bind(crypto),QO=()=>ZL(new Uint32Array(1))[0],eB="10000000-1000-4000-8000"+-1e11,tB=()=>eB.replace(/[018]/g,n=>(n^QO()&15>>n/4).toString(16)),_c=Date.now,Xk=n=>new Promise(n);Promise.all.bind(Promise);const Qk=n=>n===void 0?null:n;class nB{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let JO=new nB,iB=!0;try{typeof localStorage<"u"&&localStorage&&(JO=localStorage,iB=!1)}catch{}const sB=JO,Oc=Symbol("Equality"),ZO=(n,e)=>n===e||!!n?.[Oc]?.(e)||!1,rB=n=>typeof n=="object",lB=Object.assign,oB=Object.keys,aB=(n,e)=>{for(const t in n)e(n[t],t)},Cf=n=>oB(n).length,cB=n=>{for(const e in n)return!1;return!0},Qc=(n,e)=>{for(const t in n)if(!e(n[t],t))return!1;return!0},tb=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),uB=(n,e)=>n===e||Cf(n)===Cf(e)&&Qc(n,(t,i)=>(t!==void 0||tb(e,i))&&ZO(e[i],t)),hB=Object.freeze,eA=n=>{for(const e in n){const t=n[e];(typeof t=="object"||typeof t=="function")&&eA(n[e])}return hB(n)},nb=(n,e,t=0)=>{try{for(;t<n.length;t++)n[t](...e)}finally{t<n.length&&nb(n,e,t+1)}},fB=n=>n,po=(n,e)=>{if(n===e)return!0;if(n==null||e==null||n.constructor!==e.constructor&&(n.constructor||Object)!==(e.constructor||Object))return!1;if(n[Oc]!=null)return n[Oc](e);switch(n.constructor){case ArrayBuffer:n=new Uint8Array(n),e=new Uint8Array(e);case Uint8Array:{if(n.byteLength!==e.byteLength)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;break}case Set:{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;break}case Map:{if(n.size!==e.size)return!1;for(const t of n.keys())if(!e.has(t)||!po(n.get(t),e.get(t)))return!1;break}case void 0:case Object:if(Cf(n)!==Cf(e))return!1;for(const t in n)if(!tb(n,t)||!po(n[t],e[t]))return!1;break;case Array:if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!po(n[t],e[t]))return!1;break;default:return!1}return!0},dB=(n,e)=>e.includes(n);var tA={};const Ac=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let Ti;const pB=()=>{if(Ti===void 0)if(Ac){Ti=bn();const n=process.argv;let e=null;for(let t=0;t<n.length;t++){const i=n[t];i[0]==="-"?(e!==null&&Ti.set(e,""),e=i):e!==null&&(Ti.set(e,i),e=null)}e!==null&&Ti.set(e,"")}else typeof location=="object"?(Ti=bn(),(location.search||"?").slice(1).split("&").forEach(n=>{if(n.length!==0){const[e,t]=n.split("=");Ti.set(`--${$k(e,"-")}`,t),Ti.set(`-${$k(e,"-")}`,t)}})):Ti=bn();return Ti},H0=n=>pB().has(n),Tf=n=>Qk(Ac?tA[n.toUpperCase().replaceAll("-","_")]:sB.getItem(n)),nA=n=>H0("--"+n)||Tf(n)!==null,gB=nA("production"),mB=Ac&&dB(tA.FORCE_COLOR,["true","1","2"]),yB=mB||!H0("--no-colors")&&!nA("no-color")&&(!Ac||process.stdout.isTTY)&&(!Ac||H0("--color")||Tf("COLORTERM")!==null||(Tf("TERM")||"").includes("color")),bB=n=>new Uint8Array(n),vB=n=>{const e=bB(n.byteLength);return e.set(n),e};class wB{constructor(e,t){this.left=e,this.right=t}}const jn=(n,e)=>new wB(n,e),SB=(n,e)=>n.forEach(t=>e(t.left,t.right)),Jk=n=>n.next()>=.5,Em=(n,e,t)=>vi(n.next()*(t+1-e)+e),iA=(n,e,t)=>vi(n.next()*(t+1-e)+e),ib=(n,e,t)=>iA(n,e,t),kB=n=>OL(ib(n,97,122)),xB=(n,e=0,t=20)=>{const i=ib(n,e,t);let s="";for(let l=0;l<i;l++)s+=kB(n);return s},Dm=(n,e)=>e[ib(n,0,e.length-1)],_B=Symbol("0schema");class OB{constructor(){this._rerrs=[]}extend(e,t,i,s=null){this._rerrs.push({path:e,expected:t,has:i,message:s})}toString(){const e=[];for(let t=this._rerrs.length-1;t>0;t--){const i=this._rerrs[t];e.push(NL(" ",(this._rerrs.length-t)*2)+`${i.path!=null?`[${i.path}] `:""}${i.has} doesn't match ${i.expected}. ${i.message}`)}return e.join(`
`)}}const q0=(n,e)=>n===e?!0:n==null||e==null||n.constructor!==e.constructor?!1:n[Oc]?ZO(n,e):Ao(n)?Fy(n,t=>Yy(e,i=>q0(t,i))):rB(n)?Qc(n,(t,i)=>q0(t,e[i])):!1;class sn{static _dilutes=!1;extends(e){let[t,i]=[this.shape,e.shape];return this.constructor._dilutes&&([i,t]=[t,i]),q0(t,i)}equals(e){return this.constructor===e.constructor&&po(this.shape,e.shape)}[_B](){return!0}[Oc](e){return this.equals(e)}validate(e){return this.check(e)}check(e,t){bi()}get nullable(){return Vo(this,Od)}get optional(){return new lA(this)}cast(e){return Zk(e,this),e}expect(e){return Zk(e,this),e}}class sb extends sn{constructor(e,t){super(),this.shape=e,this._c=t}check(e,t=void 0){const i=e?.constructor===this.shape&&(this._c==null||this._c(e));return!i&&t?.extend(null,this.shape.name,e?.constructor.name,e?.constructor!==this.shape?"Constructor match failed":"Check failed"),i}}const xt=(n,e=null)=>new sb(n,e);xt(sb);class rb extends sn{constructor(e){super(),this.shape=e}check(e,t){const i=this.shape(e);return!i&&t?.extend(null,"custom prop",e?.constructor.name,"failed to check custom prop"),i}}const Bt=n=>new rb(n);xt(rb);class Sd extends sn{constructor(e){super(),this.shape=e}check(e,t){const i=this.shape.some(s=>s===e);return!i&&t?.extend(null,this.shape.join(" | "),e.toString()),i}}const kd=(...n)=>new Sd(n),sA=xt(Sd),AB=RegExp.escape||(n=>n.replace(/[().|&,$^[\]]/g,e=>"\\"+e)),rA=n=>{if(To.check(n))return[AB(n)];if(sA.check(n))return n.shape.map(e=>e+"");if(gA.check(n))return["[+-]?\\d+.?\\d*"];if(mA.check(n))return[".*"];if(Ef.check(n))return n.shape.map(rA).flat(1);Hn()};class CB extends sn{constructor(e){super(),this.shape=e,this._r=new RegExp("^"+e.map(rA).map(t=>`(${t.join("|")})`).join("")+"$")}check(e,t){const i=this._r.exec(e)!=null;return!i&&t?.extend(null,this._r.toString(),e.toString(),"String doesn't match string template."),i}}xt(CB);const TB=Symbol("optional");class lA extends sn{constructor(e){super(),this.shape=e}check(e,t){const i=e===void 0||this.shape.check(e);return!i&&t?.extend(null,"undefined (optional)","()"),i}get[TB](){return!0}}const EB=xt(lA);class DB extends sn{check(e,t){return t?.extend(null,"never",typeof e),!1}}xt(DB);class xd extends sn{constructor(e,t=!1){super(),this.shape=e,this._isPartial=t}static _dilutes=!0;get partial(){return new xd(this.shape,!0)}check(e,t){return e==null?(t?.extend(null,"object","null"),!1):Qc(this.shape,(i,s)=>{const l=this._isPartial&&!tb(e,s)||i.check(e[s],t);return!l&&t?.extend(s.toString(),i.toString(),typeof e[s],"Object property does not match"),l})}}const RB=n=>new xd(n),MB=xt(xd),NB=Bt(n=>n!=null&&(n.constructor===Object||n.constructor==null));class oA extends sn{constructor(e,t){super(),this.shape={keys:e,values:t}}check(e,t){return e!=null&&Qc(e,(i,s)=>{const l=this.shape.keys.check(s,t);return!l&&t?.extend(s+"","Record",typeof e,l?"Key doesn't match schema":"Value doesn't match value"),l&&this.shape.values.check(i,t)})}}const aA=(n,e)=>new oA(n,e),LB=xt(oA);class cA extends sn{constructor(e){super(),this.shape=e}check(e,t){return e!=null&&Qc(this.shape,(i,s)=>{const l=i.check(e[s],t);return!l&&t?.extend(s.toString(),"Tuple",typeof i),l})}}const BB=(...n)=>new cA(n);xt(cA);class uA extends sn{constructor(e){super(),this.shape=e.length===1?e[0]:new lb(e)}check(e,t){const i=Ao(e)&&Fy(e,s=>this.shape.check(s));return!i&&t?.extend(null,"Array",""),i}}const hA=(...n)=>new uA(n),jB=xt(uA),UB=Bt(n=>Ao(n));class fA extends sn{constructor(e,t){super(),this.shape=e,this._c=t}check(e,t){const i=e instanceof this.shape&&(this._c==null||this._c(e));return!i&&t?.extend(null,this.shape.name,e?.constructor.name),i}}const zB=(n,e=null)=>new fA(n,e);xt(fA);const IB=zB(sn);class PB extends sn{constructor(e){super(),this.len=e.length-1,this.args=BB(...e.slice(-1)),this.res=e[this.len]}check(e,t){const i=e.constructor===Function&&e.length<=this.len;return!i&&t?.extend(null,"function",typeof e),i}}const HB=xt(PB),qB=Bt(n=>typeof n=="function");class VB extends sn{constructor(e){super(),this.shape=e}check(e,t){const i=Fy(this.shape,s=>s.check(e,t));return!i&&t?.extend(null,"Intersectinon",typeof e),i}}xt(VB,n=>n.shape.length>0);class lb extends sn{static _dilutes=!0;constructor(e){super(),this.shape=e}check(e,t){const i=Yy(this.shape,s=>s.check(e,t));return t?.extend(null,"Union",typeof e),i}}const Vo=(...n)=>n.findIndex(e=>Ef.check(e))>=0?Vo(...n.map(e=>Cc(e)).map(e=>Ef.check(e)?e.shape:[e]).flat(1)):n.length===1?n[0]:new lb(n),Ef=xt(lb),dA=()=>!0,Df=Bt(dA),$B=xt(rb,n=>n.shape===dA),ob=Bt(n=>typeof n=="bigint"),GB=Bt(n=>n===ob),pA=Bt(n=>typeof n=="symbol");Bt(n=>n===pA);const go=Bt(n=>typeof n=="number"),gA=Bt(n=>n===go),To=Bt(n=>typeof n=="string"),mA=Bt(n=>n===To),_d=Bt(n=>typeof n=="boolean"),KB=Bt(n=>n===_d),yA=kd(void 0);xt(Sd,n=>n.shape.length===1&&n.shape[0]===void 0);kd(void 0);const Od=kd(null),WB=xt(Sd,n=>n.shape.length===1&&n.shape[0]===null);xt(Uint8Array);xt(sb,n=>n.shape===Uint8Array);const FB=Vo(go,To,Od,yA,ob,_d,pA);(()=>{const n=hA(Df),e=aA(To,Df),t=Vo(go,To,Od,_d,n,e);return n.shape=t,e.shape.values=t,t})();const Cc=n=>{if(IB.check(n))return n;if(NB.check(n)){const e={};for(const t in n)e[t]=Cc(n[t]);return RB(e)}else{if(UB.check(n))return Vo(...n.map(Cc));if(FB.check(n))return kd(n);if(qB.check(n))return xt(n)}Hn()},Zk=gB?()=>{}:(n,e)=>{const t=new OB;if(!e.check(n,t))throw Ii(`Expected value to be of type ${e.constructor.name}.
${t.toString()}`)};class YB{constructor(e){this.patterns=[],this.$state=e}if(e,t){return this.patterns.push({if:Cc(e),h:t}),this}else(e){return this.if(Df,e)}done(){return(e,t)=>{for(let i=0;i<this.patterns.length;i++){const s=this.patterns[i];if(s.if.check(e))return s.h(e,t)}throw Ii("Unhandled pattern")}}}const XB=n=>new YB(n),bA=XB(Df).if(gA,(n,e)=>Em(e,Vk,Af)).if(mA,(n,e)=>xB(e)).if(KB,(n,e)=>Jk(e)).if(GB,(n,e)=>BigInt(Em(e,Vk,Af))).if(Ef,(n,e)=>Jl(e,Dm(e,n.shape))).if(MB,(n,e)=>{const t={};for(const i in n.shape){let s=n.shape[i];if(EB.check(s)){if(Jk(e))continue;s=s.shape}t[i]=bA(s,e)}return t}).if(jB,(n,e)=>{const t=[],i=iA(e,0,42);for(let s=0;s<i;s++)t.push(Jl(e,n.shape));return t}).if(sA,(n,e)=>Dm(e,n.shape)).if(WB,(n,e)=>null).if(HB,(n,e)=>{const t=Jl(e,n.res);return()=>t}).if($B,(n,e)=>Jl(e,Dm(e,[go,To,Od,yA,ob,_d,hA(go),aA(Vo("a","b","c"),go)]))).if(LB,(n,e)=>{const t={},i=Em(e,0,3);for(let s=0;s<i;s++){const l=Jl(e,n.shape.keys),a=Jl(e,n.shape.values);t[l]=a}return t}).done(),Jl=(n,e)=>bA(Cc(e),n),Vi=typeof document<"u"?document:{},QB=n=>Vi.createElement(n),JB=()=>Vi.createDocumentFragment();Bt(n=>n.nodeType===o3);const ZB=n=>Vi.createTextNode(n);typeof DOMParser<"u"&&new DOMParser;const e3=(n,e)=>(SB(e,(t,i)=>{i===!1?n.removeAttribute(t):i===!0?n.setAttribute(t,""):n.setAttribute(t,i)}),n),t3=n=>{const e=JB();for(let t=0;t<n.length;t++)vA(e,n[t]);return e},n3=(n,e)=>(vA(n,t3(e)),n),Rm=(n,e=[],t=[])=>n3(e3(QB(n),e),t);Bt(n=>n.nodeType===s3);const Bh=ZB;Bt(n=>n.nodeType===r3);const i3=n=>bL(n,(e,t)=>`${t}:${e};`).join(""),vA=(n,e)=>n.appendChild(e),s3=Vi.ELEMENT_NODE,r3=Vi.TEXT_NODE;Vi.CDATA_SECTION_NODE;Vi.COMMENT_NODE;const l3=Vi.DOCUMENT_NODE;Vi.DOCUMENT_TYPE_NODE;const o3=Vi.DOCUMENT_FRAGMENT_NODE;Bt(n=>n.nodeType===l3);const ks=Symbol,wA=ks(),SA=ks(),a3=ks(),c3=ks(),u3=ks(),kA=ks(),h3=ks(),ab=ks(),f3=ks(),d3=n=>{n.length===1&&n[0]?.constructor===Function&&(n=n[0]());const e=[],t=[];let i=0;for(;i<n.length;i++){const s=n[i];if(s===void 0)break;if(s.constructor===String||s.constructor===Number)e.push(s);else if(s.constructor===Object)break}for(i>0&&t.push(e.join(""));i<n.length;i++){const s=n[i];s instanceof Symbol||t.push(s)}return t},p3={[wA]:jn("font-weight","bold"),[SA]:jn("font-weight","normal"),[a3]:jn("color","blue"),[u3]:jn("color","green"),[c3]:jn("color","grey"),[kA]:jn("color","red"),[h3]:jn("color","purple"),[ab]:jn("color","orange"),[f3]:jn("color","black")},g3=n=>{n.length===1&&n[0]?.constructor===Function&&(n=n[0]());const e=[],t=[],i=bn();let s=[],l=0;for(;l<n.length;l++){const a=n[l],c=p3[a];if(c!==void 0)i.set(c.left,c.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const h=i3(i);l>0||h.length>0?(e.push("%c"+a),t.push(h)):e.push(a)}else break}}for(l>0&&(s=t,s.unshift(e.join("")));l<n.length;l++){const a=n[l];a instanceof Symbol||s.push(a)}return s},xA=yB?g3:d3,m3=(...n)=>{console.log(...xA(n)),OA.forEach(e=>e.print(n))},_A=(...n)=>{console.warn(...xA(n)),n.unshift(ab),OA.forEach(e=>e.print(n))},OA=Xr(),AA=n=>({[Symbol.iterator](){return this},next:n}),y3=(n,e)=>AA(()=>{let t;do t=n.next();while(!t.done&&!e(t.value));return t}),Mm=(n,e)=>AA(()=>{const{done:t,value:i}=n.next();return{done:t,value:t?void 0:e(i)}});class cb{constructor(e,t){this.clock=e,this.len=t}}class $o{constructor(){this.clients=new Map}}const Eo=(n,e,t)=>e.clients.forEach((i,s)=>{const l=n.doc.store.clients.get(s);if(l!=null){const a=l[l.length-1],c=a.id.clock+a.length;for(let h=0,d=i[h];h<i.length&&d.clock<c;d=i[++h])HA(n,l,d.clock,d.len,t)}}),b3=(n,e)=>{let t=0,i=n.length-1;for(;t<=i;){const s=vi((t+i)/2),l=n[s],a=l.clock;if(a<=e){if(e<a+l.len)return s;t=s+1}else i=s-1}return null},Jc=(n,e)=>{const t=n.clients.get(e.client);return t!==void 0&&b3(t,e.clock)!==null},ub=n=>{n.clients.forEach(e=>{e.sort((s,l)=>s.clock-l.clock);let t,i;for(t=1,i=1;t<e.length;t++){const s=e[i-1],l=e[t];s.clock+s.len>=l.clock?s.len=hr(s.len,l.clock+l.len-s.clock):(i<t&&(e[i]=l),i++)}e.length=i})},V0=n=>{const e=new $o;for(let t=0;t<n.length;t++)n[t].clients.forEach((i,s)=>{if(!e.clients.has(s)){const l=i.slice();for(let a=t+1;a<n.length;a++)wL(l,n[a].clients.get(s)||[]);e.clients.set(s,l)}});return ub(e),e},Tc=(n,e,t,i)=>{Ss(n.clients,e,()=>[]).push(new cb(t,i))},v3=()=>new $o,w3=n=>{const e=v3();return n.clients.forEach((t,i)=>{const s=[];for(let l=0;l<t.length;l++){const a=t[l];if(a.deleted){const c=a.id.clock;let h=a.length;if(l+1<t.length)for(let d=t[l+1];l+1<t.length&&d.deleted;d=t[++l+1])h+=d.length;s.push(new cb(c,h))}}s.length>0&&e.clients.set(i,s)}),e},Go=(n,e)=>{Ee(n.restEncoder,e.clients.size),ys(e.clients.entries()).sort((t,i)=>i[0]-t[0]).forEach(([t,i])=>{n.resetDsCurVal(),Ee(n.restEncoder,t);const s=i.length;Ee(n.restEncoder,s);for(let l=0;l<s;l++){const a=i[l];n.writeDsClock(a.clock),n.writeDsLen(a.len)}})},hb=n=>{const e=new $o,t=Ae(n.restDecoder);for(let i=0;i<t;i++){n.resetDsCurVal();const s=Ae(n.restDecoder),l=Ae(n.restDecoder);if(l>0){const a=Ss(e.clients,s,()=>[]);for(let c=0;c<l;c++)a.push(new cb(n.readDsClock(),n.readDsLen()))}}return e},ex=(n,e,t)=>{const i=new $o,s=Ae(n.restDecoder);for(let l=0;l<s;l++){n.resetDsCurVal();const a=Ae(n.restDecoder),c=Ae(n.restDecoder),h=t.clients.get(a)||[],d=gt(t,a);for(let p=0;p<c;p++){const m=n.readDsClock(),b=m+n.readDsLen();if(m<d){d<b&&Tc(i,a,d,b-d);let v=Pi(h,m),w=h[v];for(!w.deleted&&w.id.clock<m&&(h.splice(v+1,0,zf(e,w,m-w.id.clock)),v++);v<h.length&&(w=h[v++],w.id.clock<b);)w.deleted||(b<w.id.clock+w.length&&h.splice(v,0,zf(e,w,b-w.id.clock)),w.delete(e))}else Tc(i,a,m,b-m)}}if(i.clients.size>0){const l=new Qr;return Ee(l.restEncoder,0),Go(l,i),l.toUint8Array()}return null},CA=QO;class rl extends WO{constructor({guid:e=tB(),collectionid:t=null,gc:i=!0,gcFilter:s=()=>!0,meta:l=null,autoLoad:a=!1,shouldLoad:c=!0}={}){super(),this.gc=i,this.gcFilter=s,this.clientID=CA(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new IA,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=c,this.autoLoad=a,this.meta=l,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=Xk(d=>{this.on("load",()=>{this.isLoaded=!0,d(this)})});const h=()=>Xk(d=>{const p=m=>{(m===void 0||m===!0)&&(this.off("sync",p),d())};this.on("sync",p)});this.on("sync",d=>{d===!1&&this.isSynced&&(this.whenSynced=h()),this.isSynced=d===void 0||d===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=h()}load(){const e=this._item;e!==null&&!this.shouldLoad&&Qe(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(ys(this.subdocs).map(e=>e.guid))}transact(e,t=null){return Qe(this,e,t)}get(e,t=Lt){const i=Ss(this.share,e,()=>{const l=new t;return l._integrate(this,null),l}),s=i.constructor;if(t!==Lt&&s!==t)if(s===Lt){const l=new t;l._map=i._map,i._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=l}),l._start=i._start;for(let a=l._start;a!==null;a=a.right)a.parent=l;return l._length=i._length,this.share.set(e,l),l._integrate(this,null),l}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return i}getArray(e=""){return this.get(e,bo)}getText(e=""){return this.get(e,Mo)}getMap(e=""){return this.get(e,Ro)}getXmlElement(e=""){return this.get(e,No)}getXmlFragment(e=""){return this.get(e,Jr)}toJSON(){const e={};return this.share.forEach((t,i)=>{e[i]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,ys(this.subdocs).forEach(t=>t.destroy());const e=this._item;if(e!==null){this._item=null;const t=e.content;t.doc=new rl({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,Qe(e.parent.doc,i=>{const s=t.doc;e.deleted||i.subdocsAdded.add(s),i.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class TA{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Ae(this.restDecoder)}readDsLen(){return Ae(this.restDecoder)}}class EA extends TA{readLeftID(){return xe(Ae(this.restDecoder),Ae(this.restDecoder))}readRightID(){return xe(Ae(this.restDecoder),Ae(this.restDecoder))}readClient(){return Ae(this.restDecoder)}readInfo(){return Co(this.restDecoder)}readString(){return Wr(this.restDecoder)}readParentInfo(){return Ae(this.restDecoder)===1}readTypeRef(){return Ae(this.restDecoder)}readLen(){return Ae(this.restDecoder)}readAny(){return xc(this.restDecoder)}readBuf(){return vB(Bn(this.restDecoder))}readJSON(){return JSON.parse(Wr(this.restDecoder))}readKey(){return Wr(this.restDecoder)}}class S3{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Ae(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Ae(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class Do extends S3{constructor(e){super(e),this.keys=[],Ae(e),this.keyClockDecoder=new Tm(Bn(e)),this.clientDecoder=new ff(Bn(e)),this.leftClockDecoder=new Tm(Bn(e)),this.rightClockDecoder=new Tm(Bn(e)),this.infoDecoder=new Yk(Bn(e),Co),this.stringDecoder=new JL(Bn(e)),this.parentInfoDecoder=new Yk(Bn(e),Co),this.typeRefDecoder=new ff(Bn(e)),this.lenDecoder=new ff(Bn(e))}readLeftID(){return new mo(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new mo(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return xc(this.restDecoder)}readBuf(){return Bn(this.restDecoder)}readJSON(){return xc(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class DA{constructor(){this.restEncoder=Xc()}toUint8Array(){return gi(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Ee(this.restEncoder,e)}writeDsLen(e){Ee(this.restEncoder,e)}}class Zc extends DA{writeLeftID(e){Ee(this.restEncoder,e.client),Ee(this.restEncoder,e.clock)}writeRightID(e){Ee(this.restEncoder,e.client),Ee(this.restEncoder,e.clock)}writeClient(e){Ee(this.restEncoder,e)}writeInfo(e){I0(this.restEncoder,e)}writeString(e){Kr(this.restEncoder,e)}writeParentInfo(e){Ee(this.restEncoder,e?1:0)}writeTypeRef(e){Ee(this.restEncoder,e)}writeLen(e){Ee(this.restEncoder,e)}writeAny(e){kc(this.restEncoder,e)}writeBuf(e){Ln(this.restEncoder,e)}writeJSON(e){Kr(this.restEncoder,JSON.stringify(e))}writeKey(e){Kr(this.restEncoder,e)}}class RA{constructor(){this.restEncoder=Xc(),this.dsCurrVal=0}toUint8Array(){return gi(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,Ee(this.restEncoder,t)}writeDsLen(e){e===0&&Hn(),Ee(this.restEncoder,e-1),this.dsCurrVal+=e}}class Qr extends RA{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Cm,this.clientEncoder=new hf,this.leftClockEncoder=new Cm,this.rightClockEncoder=new Cm,this.infoEncoder=new Kk(I0),this.stringEncoder=new VL,this.parentInfoEncoder=new Kk(I0),this.typeRefEncoder=new hf,this.lenEncoder=new hf}toUint8Array(){const e=Xc();return Ee(e,0),Ln(e,this.keyClockEncoder.toUint8Array()),Ln(e,this.clientEncoder.toUint8Array()),Ln(e,this.leftClockEncoder.toUint8Array()),Ln(e,this.rightClockEncoder.toUint8Array()),Ln(e,gi(this.infoEncoder)),Ln(e,this.stringEncoder.toUint8Array()),Ln(e,gi(this.parentInfoEncoder)),Ln(e,this.typeRefEncoder.toUint8Array()),Ln(e,this.lenEncoder.toUint8Array()),vd(e,gi(this.restEncoder)),gi(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){kc(this.restEncoder,e)}writeBuf(e){Ln(this.restEncoder,e)}writeJSON(e){kc(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const k3=(n,e,t,i)=>{i=hr(i,e[0].id.clock);const s=Pi(e,i);Ee(n.restEncoder,e.length-s),n.writeClient(t),Ee(n.restEncoder,i);const l=e[s];l.write(n,i-l.id.clock);for(let a=s+1;a<e.length;a++)e[a].write(n,0)},fb=(n,e,t)=>{const i=new Map;t.forEach((s,l)=>{gt(e,l)>s&&i.set(l,s)}),Ad(e).forEach((s,l)=>{t.has(l)||i.set(l,0)}),Ee(n.restEncoder,i.size),ys(i.entries()).sort((s,l)=>l[0]-s[0]).forEach(([s,l])=>{k3(n,e.clients.get(s),s,l)})},x3=(n,e)=>{const t=bn(),i=Ae(n.restDecoder);for(let s=0;s<i;s++){const l=Ae(n.restDecoder),a=new Array(l),c=n.readClient();let h=Ae(n.restDecoder);t.set(c,{i:0,refs:a});for(let d=0;d<l;d++){const p=n.readInfo();switch(bd&p){case 0:{const m=n.readLen();a[d]=new Zn(xe(c,h),m),h+=m;break}case 10:{const m=Ae(n.restDecoder);a[d]=new ei(xe(c,h),m),h+=m;break}default:{const m=(p&(ms|Pn))===0,b=new Je(xe(c,h),null,(p&Pn)===Pn?n.readLeftID():null,null,(p&ms)===ms?n.readRightID():null,m?n.readParentInfo()?e.get(n.readString()):n.readLeftID():null,m&&(p&wc)===wc?n.readString():null,cC(n,p));a[d]=b,h+=b.length}}}}return t},_3=(n,e,t)=>{const i=[];let s=ys(t.keys()).sort((v,w)=>v-w);if(s.length===0)return null;const l=()=>{if(s.length===0)return null;let v=t.get(s[s.length-1]);for(;v.refs.length===v.i;)if(s.pop(),s.length>0)v=t.get(s[s.length-1]);else return null;return v};let a=l();if(a===null)return null;const c=new IA,h=new Map,d=(v,w)=>{const k=h.get(v);(k==null||k>w)&&h.set(v,w)};let p=a.refs[a.i++];const m=new Map,b=()=>{for(const v of i){const w=v.id.client,k=t.get(w);k?(k.i--,c.clients.set(w,k.refs.slice(k.i)),t.delete(w),k.i=0,k.refs=[]):c.clients.set(w,[v]),s=s.filter(_=>_!==w)}i.length=0};for(;;){if(p.constructor!==ei){const w=Ss(m,p.id.client,()=>gt(e,p.id.client))-p.id.clock;if(w<0)i.push(p),d(p.id.client,p.id.clock-1),b();else{const k=p.getMissing(n,e);if(k!==null){i.push(p);const _=t.get(k)||{refs:[],i:0};if(_.refs.length===_.i)d(k,gt(e,k)),b();else{p=_.refs[_.i++];continue}}else(w===0||w<p.length)&&(p.integrate(n,w),m.set(p.id.client,p.id.clock+p.length))}}if(i.length>0)p=i.pop();else if(a!==null&&a.i<a.refs.length)p=a.refs[a.i++];else{if(a=l(),a===null)break;p=a.refs[a.i++]}}if(c.clients.size>0){const v=new Qr;return fb(v,c,new Map),Ee(v.restEncoder,0),{missing:h,update:v.toUint8Array()}}return null},O3=(n,e)=>fb(n,e.doc.store,e.beforeState),A3=(n,e,t,i=new Do(n))=>Qe(e,s=>{s.local=!1;let l=!1;const a=s.doc,c=a.store,h=x3(i,a),d=_3(s,c,h),p=c.pendingStructs;if(p){for(const[b,v]of p.missing)if(v<gt(c,b)){l=!0;break}if(d){for(const[b,v]of d.missing){const w=p.missing.get(b);(w==null||w>v)&&p.missing.set(b,v)}p.update=Mf([p.update,d.update])}}else c.pendingStructs=d;const m=ex(i,s,c);if(c.pendingDs){const b=new Do(sl(c.pendingDs));Ae(b.restDecoder);const v=ex(b,s,c);m&&v?c.pendingDs=Mf([m,v]):c.pendingDs=m||v}else c.pendingDs=m;if(l){const b=c.pendingStructs.update;c.pendingStructs=null,MA(s.doc,b)}},t,!1),MA=(n,e,t,i=Do)=>{const s=sl(e);A3(s,n,t,new i(s))},$0=(n,e,t)=>MA(n,e,t,EA),C3=(n,e,t=new Map)=>{fb(n,e.store,t),Go(n,w3(e.store))},T3=(n,e=new Uint8Array([0]),t=new Qr)=>{const i=LA(e);C3(t,n,i);const s=[t.toUint8Array()];if(n.store.pendingDs&&s.push(n.store.pendingDs),n.store.pendingStructs&&s.push(G3(n.store.pendingStructs.update,e)),s.length>1){if(t.constructor===Zc)return $A(s.map((l,a)=>a===0?l:W3(l)));if(t.constructor===Qr)return Mf(s)}return s[0]},NA=(n,e)=>T3(n,e,new Zc),E3=n=>{const e=new Map,t=Ae(n.restDecoder);for(let i=0;i<t;i++){const s=Ae(n.restDecoder),l=Ae(n.restDecoder);e.set(s,l)}return e},LA=n=>E3(new TA(sl(n))),BA=(n,e)=>(Ee(n.restEncoder,e.size),ys(e.entries()).sort((t,i)=>i[0]-t[0]).forEach(([t,i])=>{Ee(n.restEncoder,t),Ee(n.restEncoder,i)}),n),D3=(n,e)=>BA(n,Ad(e.store)),R3=(n,e=new RA)=>(n instanceof Map?BA(e,n):D3(e,n),e.toUint8Array()),M3=n=>R3(n,new DA);class N3{constructor(){this.l=[]}}const tx=()=>new N3,nx=(n,e)=>n.l.push(e),ix=(n,e)=>{const t=n.l,i=t.length;n.l=t.filter(s=>e!==s),i===n.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},jA=(n,e,t)=>nb(n.l,[e,t]);class mo{constructor(e,t){this.client=e,this.clock=t}}const oo=(n,e)=>n===e||n!==null&&e!==null&&n.client===e.client&&n.clock===e.clock,xe=(n,e)=>new mo(n,e),UA=n=>{for(const[e,t]of n.doc.share.entries())if(t===n)return e;throw Hn()},Rf=(n,e)=>{for(;e!==null;){if(e.parent===n)return!0;e=e.parent._item}return!1};class zA{constructor(e,t,i,s=0){this.type=e,this.tname=t,this.item=i,this.assoc=s}}const sx=n=>{const e={};return n.type&&(e.type=n.type),n.tname&&(e.tname=n.tname),n.item&&(e.item=n.item),n.assoc!=null&&(e.assoc=n.assoc),e},Ec=n=>new zA(n.type==null?null:xe(n.type.client,n.type.clock),n.tname??null,n.item==null?null:xe(n.item.client,n.item.clock),n.assoc==null?0:n.assoc);class L3{constructor(e,t,i=0){this.type=e,this.index=t,this.assoc=i}}const B3=(n,e,t=0)=>new L3(n,e,t),jh=(n,e,t)=>{let i=null,s=null;return n._item===null?s=UA(n):i=xe(n._item.id.client,n._item.id.clock),new zA(i,s,e,t)},G0=(n,e,t=0)=>{let i=n._start;if(t<0){if(e===0)return jh(n,null,t);e--}for(;i!==null;){if(!i.deleted&&i.countable){if(i.length>e)return jh(n,xe(i.id.client,i.id.clock+e),t);e-=i.length}if(i.right===null&&t<0)return jh(n,i.lastId,t);i=i.right}return jh(n,null,t)},j3=(n,e)=>{const t=yo(n,e),i=e.clock-t.id.clock;return{item:t,diff:i}},K0=(n,e,t=!0)=>{const i=e.store,s=n.item,l=n.type,a=n.tname,c=n.assoc;let h=null,d=0;if(s!==null){if(gt(i,s.client)<=s.clock)return null;const p=t?X0(i,s):j3(i,s),m=p.item;if(!(m instanceof Je))return null;if(h=m.parent,h._item===null||!h._item.deleted){d=m.deleted||!m.countable?0:p.diff+(c>=0?0:1);let b=m.left;for(;b!==null;)!b.deleted&&b.countable&&(d+=b.length),b=b.left}}else{if(a!==null)h=e.get(a);else if(l!==null){if(gt(i,l.client)<=l.clock)return null;const{item:p}=t?X0(i,l):{item:yo(i,l)};if(p instanceof Je&&p.content instanceof $i)h=p.content.type;else return null}else throw Hn();c>=0?d=h._length:d=0}return B3(h,d,n.assoc)},rx=(n,e)=>n===e||n!==null&&e!==null&&n.tname===e.tname&&oo(n.item,e.item)&&oo(n.type,e.type)&&n.assoc===e.assoc,io=(n,e)=>e===void 0?!n.deleted:e.sv.has(n.id.client)&&(e.sv.get(n.id.client)||0)>n.id.clock&&!Jc(e.ds,n.id),W0=(n,e)=>{const t=Ss(n.meta,W0,Xr),i=n.doc.store;t.has(e)||(e.sv.forEach((s,l)=>{s<gt(i,l)&&pn(n,xe(l,s))}),Eo(n,e.ds,s=>{}),t.add(e))};class IA{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Ad=n=>{const e=new Map;return n.clients.forEach((t,i)=>{const s=t[t.length-1];e.set(i,s.id.clock+s.length)}),e},gt=(n,e)=>{const t=n.clients.get(e);if(t===void 0)return 0;const i=t[t.length-1];return i.id.clock+i.length},PA=(n,e)=>{let t=n.clients.get(e.id.client);if(t===void 0)t=[],n.clients.set(e.id.client,t);else{const i=t[t.length-1];if(i.id.clock+i.length!==e.id.clock)throw Hn()}t.push(e)},Pi=(n,e)=>{let t=0,i=n.length-1,s=n[i],l=s.id.clock;if(l===e)return i;let a=vi(e/(l+s.length-1)*i);for(;t<=i;){if(s=n[a],l=s.id.clock,l<=e){if(e<l+s.length)return a;t=a+1}else i=a-1;a=vi((t+i)/2)}throw Hn()},U3=(n,e)=>{const t=n.clients.get(e.client);return t[Pi(t,e.clock)]},yo=U3,F0=(n,e,t)=>{const i=Pi(e,t),s=e[i];return s.id.clock<t&&s instanceof Je?(e.splice(i+1,0,zf(n,s,t-s.id.clock)),i+1):i},pn=(n,e)=>{const t=n.doc.store.clients.get(e.client);return t[F0(n,t,e.clock)]},lx=(n,e,t)=>{const i=e.clients.get(t.client),s=Pi(i,t.clock),l=i[s];return t.clock!==l.id.clock+l.length-1&&l.constructor!==Zn&&i.splice(s+1,0,zf(n,l,t.clock-l.id.clock+1)),l},z3=(n,e,t)=>{const i=n.clients.get(e.id.client);i[Pi(i,e.id.clock)]=t},HA=(n,e,t,i,s)=>{if(i===0)return;const l=t+i;let a=F0(n,e,t),c;do c=e[a++],l<c.id.clock+c.length&&F0(n,e,l),s(c);while(a<e.length&&e[a].id.clock<l)};let I3=class{constructor(e,t,i){this.doc=e,this.deleteSet=new $o,this.beforeState=Ad(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}};const ox=(n,e)=>e.deleteSet.clients.size===0&&!vL(e.afterState,(t,i)=>e.beforeState.get(i)!==t)?!1:(ub(e.deleteSet),O3(n,e),Go(n,e.deleteSet),!0),ax=(n,e,t)=>{const i=e._item;(i===null||i.id.clock<(n.beforeState.get(i.id.client)||0)&&!i.deleted)&&Ss(n.changed,e,Xr).add(t)},df=(n,e)=>{let t=n[e],i=n[e-1],s=e;for(;s>0;t=i,i=n[--s-1]){if(i.deleted===t.deleted&&i.constructor===t.constructor&&i.mergeWith(t)){t instanceof Je&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,i);continue}break}const l=e-s;return l&&n.splice(e+1-l,l),l},P3=(n,e,t)=>{for(const[i,s]of n.clients.entries()){const l=e.clients.get(i);for(let a=s.length-1;a>=0;a--){const c=s[a],h=c.clock+c.len;for(let d=Pi(l,c.clock),p=l[d];d<l.length&&p.id.clock<h;p=l[++d]){const m=l[d];if(c.clock+c.len<=m.id.clock)break;m instanceof Je&&m.deleted&&!m.keep&&t(m)&&m.gc(e,!1)}}}},H3=(n,e)=>{n.clients.forEach((t,i)=>{const s=e.clients.get(i);for(let l=t.length-1;l>=0;l--){const a=t[l],c=Xy(s.length-1,1+Pi(s,a.clock+a.len-1));for(let h=c,d=s[h];h>0&&d.id.clock>=a.clock;d=s[h])h-=1+df(s,h)}})},qA=(n,e)=>{if(e<n.length){const t=n[e],i=t.doc,s=i.store,l=t.deleteSet,a=t._mergeStructs;try{ub(l),t.afterState=Ad(t.doc.store),i.emit("beforeObserverCalls",[t,i]);const c=[];t.changed.forEach((h,d)=>c.push(()=>{(d._item===null||!d._item.deleted)&&d._callObserver(t,h)})),c.push(()=>{t.changedParentTypes.forEach((h,d)=>{d._dEH.l.length>0&&(d._item===null||!d._item.deleted)&&(h=h.filter(p=>p.target._item===null||!p.target._item.deleted),h.forEach(p=>{p.currentTarget=d,p._path=null}),h.sort((p,m)=>p.path.length-m.path.length),c.push(()=>{jA(d._dEH,h,t)}))}),c.push(()=>i.emit("afterTransaction",[t,i])),c.push(()=>{t._needFormattingCleanup&&oj(t)})}),nb(c,[])}finally{i.gc&&P3(l,s,i.gcFilter),H3(l,s),t.afterState.forEach((p,m)=>{const b=t.beforeState.get(m)||0;if(b!==p){const v=s.clients.get(m),w=hr(Pi(v,b),1);for(let k=v.length-1;k>=w;)k-=1+df(v,k)}});for(let p=a.length-1;p>=0;p--){const{client:m,clock:b}=a[p].id,v=s.clients.get(m),w=Pi(v,b);w+1<v.length&&df(v,w+1)>1||w>0&&df(v,w)}if(!t.local&&t.afterState.get(i.clientID)!==t.beforeState.get(i.clientID)&&(m3(ab,wA,"[yjs] ",SA,kA,"Changed the client-id because another client seems to be using it."),i.clientID=CA()),i.emit("afterTransactionCleanup",[t,i]),i._observers.has("update")){const p=new Zc;ox(p,t)&&i.emit("update",[p.toUint8Array(),t.origin,i,t])}if(i._observers.has("updateV2")){const p=new Qr;ox(p,t)&&i.emit("updateV2",[p.toUint8Array(),t.origin,i,t])}const{subdocsAdded:c,subdocsLoaded:h,subdocsRemoved:d}=t;(c.size>0||d.size>0||h.size>0)&&(c.forEach(p=>{p.clientID=i.clientID,p.collectionid==null&&(p.collectionid=i.collectionid),i.subdocs.add(p)}),d.forEach(p=>i.subdocs.delete(p)),i.emit("subdocs",[{loaded:h,added:c,removed:d},i,t]),d.forEach(p=>p.destroy())),n.length<=e+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,n])):qA(n,e+1)}}},Qe=(n,e,t=null,i=!0)=>{const s=n._transactionCleanups;let l=!1,a=null;n._transaction===null&&(l=!0,n._transaction=new I3(n,t,i),s.push(n._transaction),s.length===1&&n.emit("beforeAllTransactions",[n]),n.emit("beforeTransaction",[n._transaction,n]));try{a=e(n._transaction)}finally{if(l){const c=n._transaction===s[0];n._transaction=null,c&&qA(s,0)}}return a};class q3{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}const cx=(n,e,t)=>{Eo(n,t.deletions,i=>{i instanceof Je&&e.scope.some(s=>s===n.doc||Rf(s,i))&&wb(i,!1)})},ux=(n,e,t)=>{let i=null;const s=n.doc,l=n.scope;Qe(s,c=>{for(;e.length>0&&n.currStackItem===null;){const h=s.store,d=e.pop(),p=new Set,m=[];let b=!1;Eo(c,d.insertions,v=>{if(v instanceof Je){if(v.redone!==null){let{item:w,diff:k}=X0(h,v.id);k>0&&(w=pn(c,xe(w.id.client,w.id.clock+k))),v=w}!v.deleted&&l.some(w=>w===c.doc||Rf(w,v))&&m.push(v)}}),Eo(c,d.deletions,v=>{v instanceof Je&&l.some(w=>w===c.doc||Rf(w,v))&&!Jc(d.insertions,v.id)&&p.add(v)}),p.forEach(v=>{b=aC(c,v,p,d.insertions,n.ignoreRemoteMapChanges,n)!==null||b});for(let v=m.length-1;v>=0;v--){const w=m[v];n.deleteFilter(w)&&(w.delete(c),b=!0)}n.currStackItem=b?d:null}c.changed.forEach((h,d)=>{h.has(null)&&d._searchMarker&&(d._searchMarker.length=0)}),i=c},n);const a=n.currStackItem;if(a!=null){const c=i.changedParentTypes;n.emit("stack-item-popped",[{stackItem:a,type:t,changedParentTypes:c,origin:n},n]),n.currStackItem=null}return a};class VA extends WO{constructor(e,{captureTimeout:t=500,captureTransaction:i=h=>!0,deleteFilter:s=()=>!0,trackedOrigins:l=new Set([null]),ignoreRemoteMapChanges:a=!1,doc:c=Ao(e)?e[0].doc:e instanceof rl?e:e.doc}={}){super(),this.scope=[],this.doc=c,this.addToScope(e),this.deleteFilter=s,l.add(this),this.trackedOrigins=l,this.captureTransaction=i,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=a,this.captureTimeout=t,this.afterTransactionHandler=h=>{if(!this.captureTransaction(h)||!this.scope.some(_=>h.changedParentTypes.has(_)||_===this.doc)||!this.trackedOrigins.has(h.origin)&&(!h.origin||!this.trackedOrigins.has(h.origin.constructor)))return;const d=this.undoing,p=this.redoing,m=d?this.redoStack:this.undoStack;d?this.stopCapturing():p||this.clear(!1,!0);const b=new $o;h.afterState.forEach((_,O)=>{const R=h.beforeState.get(O)||0,C=_-R;C>0&&Tc(b,O,R,C)});const v=_c();let w=!1;if(this.lastChange>0&&v-this.lastChange<this.captureTimeout&&m.length>0&&!d&&!p){const _=m[m.length-1];_.deletions=V0([_.deletions,h.deleteSet]),_.insertions=V0([_.insertions,b])}else m.push(new q3(h.deleteSet,b)),w=!0;!d&&!p&&(this.lastChange=v),Eo(h,h.deleteSet,_=>{_ instanceof Je&&this.scope.some(O=>O===h.doc||Rf(O,_))&&wb(_,!0)});const k=[{stackItem:m[m.length-1],origin:h.origin,type:d?"redo":"undo",changedParentTypes:h.changedParentTypes},this];w?this.emit("stack-item-added",k):this.emit("stack-item-updated",k)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){const t=new Set(this.scope);e=Ao(e)?e:[e],e.forEach(i=>{t.has(i)||(t.add(i),(i instanceof Lt?i.doc!==this.doc:i!==this.doc)&&_A("[yjs#509] Not same Y.Doc"),this.scope.push(i))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,t=!0){(e&&this.canUndo()||t&&this.canRedo())&&this.doc.transact(i=>{e&&(this.undoStack.forEach(s=>cx(i,this,s)),this.undoStack=[]),t&&(this.redoStack.forEach(s=>cx(i,this,s)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:t}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=ux(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=ux(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*V3(n){const e=Ae(n.restDecoder);for(let t=0;t<e;t++){const i=Ae(n.restDecoder),s=n.readClient();let l=Ae(n.restDecoder);for(let a=0;a<i;a++){const c=n.readInfo();if(c===10){const h=Ae(n.restDecoder);yield new ei(xe(s,l),h),l+=h}else if((bd&c)!==0){const h=(c&(ms|Pn))===0,d=new Je(xe(s,l),null,(c&Pn)===Pn?n.readLeftID():null,null,(c&ms)===ms?n.readRightID():null,h?n.readParentInfo()?n.readString():n.readLeftID():null,h&&(c&wc)===wc?n.readString():null,cC(n,c));yield d,l+=d.length}else{const h=n.readLen();yield new Zn(xe(s,l),h),l+=h}}}}class db{constructor(e,t){this.gen=V3(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===ei);return this.curr}}class pb{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const $A=n=>Mf(n,EA,Zc),$3=(n,e)=>{if(n.constructor===Zn){const{client:t,clock:i}=n.id;return new Zn(xe(t,i+e),n.length-e)}else if(n.constructor===ei){const{client:t,clock:i}=n.id;return new ei(xe(t,i+e),n.length-e)}else{const t=n,{client:i,clock:s}=t.id;return new Je(xe(i,s+e),null,xe(i,s+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},Mf=(n,e=Do,t=Qr)=>{if(n.length===1)return n[0];const i=n.map(p=>new e(sl(p)));let s=i.map(p=>new db(p,!0)),l=null;const a=new t,c=new pb(a);for(;s=s.filter(b=>b.curr!==null),s.sort((b,v)=>{if(b.curr.id.client===v.curr.id.client){const w=b.curr.id.clock-v.curr.id.clock;return w===0?b.curr.constructor===v.curr.constructor?0:b.curr.constructor===ei?1:-1:w}else return v.curr.id.client-b.curr.id.client}),s.length!==0;){const p=s[0],m=p.curr.id.client;if(l!==null){let b=p.curr,v=!1;for(;b!==null&&b.id.clock+b.length<=l.struct.id.clock+l.struct.length&&b.id.client>=l.struct.id.client;)b=p.next(),v=!0;if(b===null||b.id.client!==m||v&&b.id.clock>l.struct.id.clock+l.struct.length)continue;if(m!==l.struct.id.client)Js(c,l.struct,l.offset),l={struct:b,offset:0},p.next();else if(l.struct.id.clock+l.struct.length<b.id.clock)if(l.struct.constructor===ei)l.struct.length=b.id.clock+b.length-l.struct.id.clock;else{Js(c,l.struct,l.offset);const w=b.id.clock-l.struct.id.clock-l.struct.length;l={struct:new ei(xe(m,l.struct.id.clock+l.struct.length),w),offset:0}}else{const w=l.struct.id.clock+l.struct.length-b.id.clock;w>0&&(l.struct.constructor===ei?l.struct.length-=w:b=$3(b,w)),l.struct.mergeWith(b)||(Js(c,l.struct,l.offset),l={struct:b,offset:0},p.next())}}else l={struct:p.curr,offset:0},p.next();for(let b=p.curr;b!==null&&b.id.client===m&&b.id.clock===l.struct.id.clock+l.struct.length&&b.constructor!==ei;b=p.next())Js(c,l.struct,l.offset),l={struct:b,offset:0}}l!==null&&(Js(c,l.struct,l.offset),l=null),gb(c);const h=i.map(p=>hb(p)),d=V0(h);return Go(a,d),a.toUint8Array()},G3=(n,e,t=Do,i=Qr)=>{const s=LA(e),l=new i,a=new pb(l),c=new t(sl(n)),h=new db(c,!1);for(;h.curr;){const p=h.curr,m=p.id.client,b=s.get(m)||0;if(h.curr.constructor===ei){h.next();continue}if(p.id.clock+p.length>b)for(Js(a,p,hr(b-p.id.clock,0)),h.next();h.curr&&h.curr.id.client===m;)Js(a,h.curr,0),h.next();else for(;h.curr&&h.curr.id.client===m&&h.curr.id.clock+h.curr.length<=b;)h.next()}gb(a);const d=hb(c);return Go(l,d),l.toUint8Array()},GA=n=>{n.written>0&&(n.clientStructs.push({written:n.written,restEncoder:gi(n.encoder.restEncoder)}),n.encoder.restEncoder=Xc(),n.written=0)},Js=(n,e,t)=>{n.written>0&&n.currClient!==e.id.client&&GA(n),n.written===0&&(n.currClient=e.id.client,n.encoder.writeClient(e.id.client),Ee(n.encoder.restEncoder,e.id.clock+t)),e.write(n.encoder,t),n.written++},gb=n=>{GA(n);const e=n.encoder.restEncoder;Ee(e,n.clientStructs.length);for(let t=0;t<n.clientStructs.length;t++){const i=n.clientStructs[t];Ee(e,i.written),vd(e,i.restEncoder)}},K3=(n,e,t,i)=>{const s=new t(sl(n)),l=new db(s,!1),a=new i,c=new pb(a);for(let d=l.curr;d!==null;d=l.next())Js(c,e(d),0);gb(c);const h=hb(s);return Go(a,h),a.toUint8Array()},W3=n=>K3(n,fB,Do,Zc),hx="You must not compute changes after the event-handler fired.";class Cd{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=F3(this.currentTarget,this.target))}deletes(e){return Jc(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ii(hx);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(s=>{if(s!==null){const l=t._map.get(s);let a,c;if(this.adds(l)){let h=l.left;for(;h!==null&&this.adds(h);)h=h.left;if(this.deletes(l))if(h!==null&&this.deletes(h))a="delete",c=_m(h.content.getContent());else return;else h!==null&&this.deletes(h)?(a="update",c=_m(h.content.getContent())):(a="add",c=void 0)}else if(this.deletes(l))a="delete",c=_m(l.content.getContent());else return;e.set(s,{action:a,oldValue:c})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ii(hx);const t=this.target,i=Xr(),s=Xr(),l=[];if(e={added:i,deleted:s,delta:l,keys:this.keys},this.transaction.changed.get(t).has(null)){let c=null;const h=()=>{c&&l.push(c)};for(let d=t._start;d!==null;d=d.right)d.deleted?this.deletes(d)&&!this.adds(d)&&((c===null||c.delete===void 0)&&(h(),c={delete:0}),c.delete+=d.length,s.add(d)):this.adds(d)?((c===null||c.insert===void 0)&&(h(),c={insert:[]}),c.insert=c.insert.concat(d.content.getContent()),i.add(d)):((c===null||c.retain===void 0)&&(h(),c={retain:0}),c.retain+=d.length);c!==null&&c.retain===void 0&&h()}this._changes=e}return e}}const F3=(n,e)=>{const t=[];for(;e._item!==null&&e!==n;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let i=0,s=e._item.parent._start;for(;s!==e._item&&s!==null;)!s.deleted&&s.countable&&(i+=s.length),s=s.right;t.unshift(i)}e=e._item.parent}return t},Xt=()=>{_A("Invalid access: Add Yjs type to a document before reading data.")},KA=80;let mb=0;class Y3{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=mb++}}const X3=n=>{n.timestamp=mb++},WA=(n,e,t)=>{n.p.marker=!1,n.p=e,e.marker=!0,n.index=t,n.timestamp=mb++},Q3=(n,e,t)=>{if(n.length>=KA){const i=n.reduce((s,l)=>s.timestamp<l.timestamp?s:l);return WA(i,e,t),i}else{const i=new Y3(e,t);return n.push(i),i}},Td=(n,e)=>{if(n._start===null||e===0||n._searchMarker===null)return null;const t=n._searchMarker.length===0?null:n._searchMarker.reduce((l,a)=>uf(e-l.index)<uf(e-a.index)?l:a);let i=n._start,s=0;for(t!==null&&(i=t.p,s=t.index,X3(t));i.right!==null&&s<e;){if(!i.deleted&&i.countable){if(e<s+i.length)break;s+=i.length}i=i.right}for(;i.left!==null&&s>e;)i=i.left,!i.deleted&&i.countable&&(s-=i.length);for(;i.left!==null&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)i=i.left,!i.deleted&&i.countable&&(s-=i.length);return t!==null&&uf(t.index-s)<i.parent.length/KA?(WA(t,i,s),t):Q3(n._searchMarker,i,s)},Dc=(n,e,t)=>{for(let i=n.length-1;i>=0;i--){const s=n[i];if(t>0){let l=s.p;for(l.marker=!1;l&&(l.deleted||!l.countable);)l=l.left,l&&!l.deleted&&l.countable&&(s.index-=l.length);if(l===null||l.marker===!0){n.splice(i,1);continue}s.p=l,l.marker=!0}(e<s.index||t>0&&e===s.index)&&(s.index=hr(e,s.index+t))}},Ed=(n,e,t)=>{const i=n,s=e.changedParentTypes;for(;Ss(s,n,()=>[]).push(t),n._item!==null;)n=n._item.parent;jA(i._eH,t,e)};class Lt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=tx(),this._dEH=tx(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw bi()}clone(){throw bi()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){nx(this._eH,e)}observeDeep(e){nx(this._dEH,e)}unobserve(e){ix(this._eH,e)}unobserveDeep(e){ix(this._dEH,e)}toJSON(){}}const FA=(n,e,t)=>{n.doc??Xt(),e<0&&(e=n._length+e),t<0&&(t=n._length+t);let i=t-e;const s=[];let l=n._start;for(;l!==null&&i>0;){if(l.countable&&!l.deleted){const a=l.content.getContent();if(a.length<=e)e-=a.length;else{for(let c=e;c<a.length&&i>0;c++)s.push(a[c]),i--;e=0}}l=l.right}return s},YA=n=>{n.doc??Xt();const e=[];let t=n._start;for(;t!==null;){if(t.countable&&!t.deleted){const i=t.content.getContent();for(let s=0;s<i.length;s++)e.push(i[s])}t=t.right}return e},Rc=(n,e)=>{let t=0,i=n._start;for(n.doc??Xt();i!==null;){if(i.countable&&!i.deleted){const s=i.content.getContent();for(let l=0;l<s.length;l++)e(s[l],t++,n)}i=i.right}},XA=(n,e)=>{const t=[];return Rc(n,(i,s)=>{t.push(e(i,s,n))}),t},J3=n=>{let e=n._start,t=null,i=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),i=0,e=e.right}const s=t[i++];return t.length<=i&&(t=null),{done:!1,value:s}}}},QA=(n,e)=>{n.doc??Xt();const t=Td(n,e);let i=n._start;for(t!==null&&(i=t.p,e-=t.index);i!==null;i=i.right)if(!i.deleted&&i.countable){if(e<i.length)return i.content.getContent()[e];e-=i.length}},Nf=(n,e,t,i)=>{let s=t;const l=n.doc,a=l.clientID,c=l.store,h=t===null?e._start:t.right;let d=[];const p=()=>{d.length>0&&(s=new Je(xe(a,gt(c,a)),s,s&&s.lastId,h,h&&h.id,e,null,new Zr(d)),s.integrate(n,0),d=[])};i.forEach(m=>{if(m===null)d.push(m);else switch(m.constructor){case Number:case Object:case Boolean:case Array:case String:d.push(m);break;default:switch(p(),m.constructor){case Uint8Array:case ArrayBuffer:s=new Je(xe(a,gt(c,a)),s,s&&s.lastId,h,h&&h.id,e,null,new eu(new Uint8Array(m))),s.integrate(n,0);break;case rl:s=new Je(xe(a,gt(c,a)),s,s&&s.lastId,h,h&&h.id,e,null,new tu(m)),s.integrate(n,0);break;default:if(m instanceof Lt)s=new Je(xe(a,gt(c,a)),s,s&&s.lastId,h,h&&h.id,e,null,new $i(m)),s.integrate(n,0);else throw new Error("Unexpected content type in insert operation")}}}),p()},JA=()=>Ii("Length exceeded!"),ZA=(n,e,t,i)=>{if(t>e._length)throw JA();if(t===0)return e._searchMarker&&Dc(e._searchMarker,t,i.length),Nf(n,e,null,i);const s=t,l=Td(e,t);let a=e._start;for(l!==null&&(a=l.p,t-=l.index,t===0&&(a=a.prev,t+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(t<=a.length){t<a.length&&pn(n,xe(a.id.client,a.id.clock+t));break}t-=a.length}return e._searchMarker&&Dc(e._searchMarker,s,i.length),Nf(n,e,a,i)},Z3=(n,e,t)=>{let s=(e._searchMarker||[]).reduce((l,a)=>a.index>l.index?a:l,{index:0,p:e._start}).p;if(s)for(;s.right;)s=s.right;return Nf(n,e,s,t)},eC=(n,e,t,i)=>{if(i===0)return;const s=t,l=i,a=Td(e,t);let c=e._start;for(a!==null&&(c=a.p,t-=a.index);c!==null&&t>0;c=c.right)!c.deleted&&c.countable&&(t<c.length&&pn(n,xe(c.id.client,c.id.clock+t)),t-=c.length);for(;i>0&&c!==null;)c.deleted||(i<c.length&&pn(n,xe(c.id.client,c.id.clock+i)),c.delete(n),i-=c.length),c=c.right;if(i>0)throw JA();e._searchMarker&&Dc(e._searchMarker,s,-l+i)},Lf=(n,e,t)=>{const i=e._map.get(t);i!==void 0&&i.delete(n)},yb=(n,e,t,i)=>{const s=e._map.get(t)||null,l=n.doc,a=l.clientID;let c;if(i==null)c=new Zr([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:c=new Zr([i]);break;case Uint8Array:c=new eu(i);break;case rl:c=new tu(i);break;default:if(i instanceof Lt)c=new $i(i);else throw new Error("Unexpected content type")}new Je(xe(a,gt(l.store,a)),s,s&&s.lastId,null,null,e,t,c).integrate(n,0)},bb=(n,e)=>{n.doc??Xt();const t=n._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},tC=n=>{const e={};return n.doc??Xt(),n._map.forEach((t,i)=>{t.deleted||(e[i]=t.content.getContent()[t.length-1])}),e},nC=(n,e)=>{n.doc??Xt();const t=n._map.get(e);return t!==void 0&&!t.deleted},ej=(n,e)=>{const t={};return n._map.forEach((i,s)=>{let l=i;for(;l!==null&&(!e.sv.has(l.id.client)||l.id.clock>=(e.sv.get(l.id.client)||0));)l=l.left;l!==null&&io(l,e)&&(t[s]=l.content.getContent()[l.length-1])}),t},Uh=n=>(n.doc??Xt(),y3(n._map.entries(),e=>!e[1].deleted));class tj extends Cd{}class bo extends Lt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new bo;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new bo}clone(){const e=new bo;return e.insert(0,this.toArray().map(t=>t instanceof Lt?t.clone():t)),e}get length(){return this.doc??Xt(),this._length}_callObserver(e,t){super._callObserver(e,t),Ed(this,e,new tj(this,e))}insert(e,t){this.doc!==null?Qe(this.doc,i=>{ZA(i,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?Qe(this.doc,t=>{Z3(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?Qe(this.doc,i=>{eC(i,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return QA(this,e)}toArray(){return YA(this)}slice(e=0,t=this.length){return FA(this,e,t)}toJSON(){return this.map(e=>e instanceof Lt?e.toJSON():e)}map(e){return XA(this,e)}forEach(e){Rc(this,e)}[Symbol.iterator](){return J3(this)}_write(e){e.writeTypeRef(Aj)}}const nj=n=>new bo;class ij extends Cd{constructor(e,t,i){super(e,t),this.keysChanged=i}}class Ro extends Lt{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((i,s)=>{this.set(s,i)}),this._prelimContent=null}_copy(){return new Ro}clone(){const e=new Ro;return this.forEach((t,i)=>{e.set(i,t instanceof Lt?t.clone():t)}),e}_callObserver(e,t){Ed(this,e,new ij(this,e,t))}toJSON(){this.doc??Xt();const e={};return this._map.forEach((t,i)=>{if(!t.deleted){const s=t.content.getContent()[t.length-1];e[i]=s instanceof Lt?s.toJSON():s}}),e}get size(){return[...Uh(this)].length}keys(){return Mm(Uh(this),e=>e[0])}values(){return Mm(Uh(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return Mm(Uh(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??Xt(),this._map.forEach((t,i)=>{t.deleted||e(t.content.getContent()[t.length-1],i,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Qe(this.doc,t=>{Lf(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?Qe(this.doc,i=>{yb(i,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return bb(this,e)}has(e){return nC(this,e)}clear(){this.doc!==null?Qe(this.doc,e=>{this.forEach(function(t,i,s){Lf(e,s,i)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(Cj)}}const sj=n=>new Ro,er=(n,e)=>n===e||typeof n=="object"&&typeof e=="object"&&n&&e&&uB(n,e);class Y0{constructor(e,t,i,s){this.left=e,this.right=t,this.index=i,this.currentAttributes=s}forward(){this.right===null&&Hn(),this.right.content.constructor===Et?this.right.deleted||Ko(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}const fx=(n,e,t)=>{for(;e.right!==null&&t>0;)e.right.content.constructor===Et?e.right.deleted||Ko(e.currentAttributes,e.right.content):e.right.deleted||(t<e.right.length&&pn(n,xe(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length),e.left=e.right,e.right=e.right.right;return e},zh=(n,e,t,i)=>{const s=new Map,l=i?Td(e,t):null;if(l){const a=new Y0(l.p.left,l.p,l.index,s);return fx(n,a,t-l.index)}else{const a=new Y0(null,e._start,0,s);return fx(n,a,t)}},iC=(n,e,t,i)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===Et&&er(i.get(t.right.content.key),t.right.content.value));)t.right.deleted||i.delete(t.right.content.key),t.forward();const s=n.doc,l=s.clientID;i.forEach((a,c)=>{const h=t.left,d=t.right,p=new Je(xe(l,gt(s.store,l)),h,h&&h.lastId,d,d&&d.id,e,null,new Et(c,a));p.integrate(n,0),t.right=p,t.forward()})},Ko=(n,e)=>{const{key:t,value:i}=e;i===null?n.delete(t):n.set(t,i)},sC=(n,e)=>{for(;n.right!==null;){if(!(n.right.deleted||n.right.content.constructor===Et&&er(e[n.right.content.key]??null,n.right.content.value)))break;n.forward()}},rC=(n,e,t,i)=>{const s=n.doc,l=s.clientID,a=new Map;for(const c in i){const h=i[c],d=t.currentAttributes.get(c)??null;if(!er(d,h)){a.set(c,d);const{left:p,right:m}=t;t.right=new Je(xe(l,gt(s.store,l)),p,p&&p.lastId,m,m&&m.id,e,null,new Et(c,h)),t.right.integrate(n,0),t.forward()}}return a},Nm=(n,e,t,i,s)=>{t.currentAttributes.forEach((b,v)=>{s[v]===void 0&&(s[v]=null)});const l=n.doc,a=l.clientID;sC(t,s);const c=rC(n,e,t,s),h=i.constructor===String?new Hi(i):i instanceof Lt?new $i(i):new ll(i);let{left:d,right:p,index:m}=t;e._searchMarker&&Dc(e._searchMarker,t.index,h.getLength()),p=new Je(xe(a,gt(l.store,a)),d,d&&d.lastId,p,p&&p.id,e,null,h),p.integrate(n,0),t.right=p,t.index=m,t.forward(),iC(n,e,t,c)},dx=(n,e,t,i,s)=>{const l=n.doc,a=l.clientID;sC(t,s);const c=rC(n,e,t,s);e:for(;t.right!==null&&(i>0||c.size>0&&(t.right.deleted||t.right.content.constructor===Et));){if(!t.right.deleted)switch(t.right.content.constructor){case Et:{const{key:h,value:d}=t.right.content,p=s[h];if(p!==void 0){if(er(p,d))c.delete(h);else{if(i===0)break e;c.set(h,d)}t.right.delete(n)}else t.currentAttributes.set(h,d);break}default:i<t.right.length&&pn(n,xe(t.right.id.client,t.right.id.clock+i)),i-=t.right.length;break}t.forward()}if(i>0){let h="";for(;i>0;i--)h+=`
`;t.right=new Je(xe(a,gt(l.store,a)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new Hi(h)),t.right.integrate(n,0),t.forward()}iC(n,e,t,c)},lC=(n,e,t,i,s)=>{let l=e;const a=bn();for(;l&&(!l.countable||l.deleted);){if(!l.deleted&&l.content.constructor===Et){const d=l.content;a.set(d.key,d)}l=l.right}let c=0,h=!1;for(;e!==l;){if(t===e&&(h=!0),!e.deleted){const d=e.content;if(d.constructor===Et){const{key:p,value:m}=d,b=i.get(p)??null;(a.get(p)!==d||b===m)&&(e.delete(n),c++,!h&&(s.get(p)??null)===m&&b!==m&&(b===null?s.delete(p):s.set(p,b))),!h&&!e.deleted&&Ko(s,d)}}e=e.right}return c},rj=(n,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Et){const i=e.content.key;t.has(i)?e.delete(n):t.add(i)}e=e.left}},lj=n=>{let e=0;return Qe(n.doc,t=>{let i=n._start,s=n._start,l=bn();const a=U0(l);for(;s;)s.deleted===!1&&(s.content.constructor===Et?Ko(a,s.content):(e+=lC(t,i,s,l,a),l=U0(a),i=s)),s=s.right}),e},oj=n=>{const e=new Set,t=n.doc;for(const[i,s]of n.afterState.entries()){const l=n.beforeState.get(i)||0;s!==l&&HA(n,t.store.clients.get(i),l,s,a=>{!a.deleted&&a.content.constructor===Et&&a.constructor!==Zn&&e.add(a.parent)})}Qe(t,i=>{Eo(n,n.deleteSet,s=>{if(s instanceof Zn||!s.parent._hasFormatting||e.has(s.parent))return;const l=s.parent;s.content.constructor===Et?e.add(l):rj(i,s)});for(const s of e)lj(s)})},px=(n,e,t)=>{const i=t,s=U0(e.currentAttributes),l=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case $i:case ll:case Hi:t<e.right.length&&pn(n,xe(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(n);break}e.forward()}l&&lC(n,l,e.right,s,e.currentAttributes);const a=(e.left||e.right).parent;return a._searchMarker&&Dc(a._searchMarker,e.index,-i+t),e};class aj extends Cd{constructor(e,t,i){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,i.forEach(s=>{s===null?this.childListChanged=!0:this.keysChanged.add(s)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,t=[];Qe(e,i=>{const s=new Map,l=new Map;let a=this.target._start,c=null;const h={};let d="",p=0,m=0;const b=()=>{if(c!==null){let v=null;switch(c){case"delete":m>0&&(v={delete:m}),m=0;break;case"insert":(typeof d=="object"||d.length>0)&&(v={insert:d},s.size>0&&(v.attributes={},s.forEach((w,k)=>{w!==null&&(v.attributes[k]=w)}))),d="";break;case"retain":p>0&&(v={retain:p},cB(h)||(v.attributes=lB({},h))),p=0;break}v&&t.push(v),c=null}};for(;a!==null;){switch(a.content.constructor){case $i:case ll:this.adds(a)?this.deletes(a)||(b(),c="insert",d=a.content.getContent()[0],b()):this.deletes(a)?(c!=="delete"&&(b(),c="delete"),m+=1):a.deleted||(c!=="retain"&&(b(),c="retain"),p+=1);break;case Hi:this.adds(a)?this.deletes(a)||(c!=="insert"&&(b(),c="insert"),d+=a.content.str):this.deletes(a)?(c!=="delete"&&(b(),c="delete"),m+=a.length):a.deleted||(c!=="retain"&&(b(),c="retain"),p+=a.length);break;case Et:{const{key:v,value:w}=a.content;if(this.adds(a)){if(!this.deletes(a)){const k=s.get(v)??null;er(k,w)?w!==null&&a.delete(i):(c==="retain"&&b(),er(w,l.get(v)??null)?delete h[v]:h[v]=w)}}else if(this.deletes(a)){l.set(v,w);const k=s.get(v)??null;er(k,w)||(c==="retain"&&b(),h[v]=k)}else if(!a.deleted){l.set(v,w);const k=h[v];k!==void 0&&(er(k,w)?k!==null&&a.delete(i):(c==="retain"&&b(),w===null?delete h[v]:h[v]=w))}a.deleted||(c==="insert"&&b(),Ko(s,a.content));break}}a=a.right}for(b();t.length>0;){const v=t[t.length-1];if(v.retain!==void 0&&v.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}}class Mo extends Lt{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Xt(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(i=>i())}catch(i){console.error(i)}this._pending=null}_copy(){return new Mo}clone(){const e=new Mo;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const i=new aj(this,e,t);Ed(this,e,i),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??Xt();let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===Hi&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?Qe(this.doc,i=>{const s=new Y0(null,this._start,0,new Map);for(let l=0;l<e.length;l++){const a=e[l];if(a.insert!==void 0){const c=!t&&typeof a.insert=="string"&&l===e.length-1&&s.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof c!="string"||c.length>0)&&Nm(i,this,s,c,a.attributes||{})}else a.retain!==void 0?dx(i,this,s,a.retain,a.attributes||{}):a.delete!==void 0&&px(i,s,a.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,i){this.doc??Xt();const s=[],l=new Map,a=this.doc;let c="",h=this._start;function d(){if(c.length>0){const m={};let b=!1;l.forEach((w,k)=>{b=!0,m[k]=w});const v={insert:c};b&&(v.attributes=m),s.push(v),c=""}}const p=()=>{for(;h!==null;){if(io(h,e)||t!==void 0&&io(h,t))switch(h.content.constructor){case Hi:{const m=l.get("ychange");e!==void 0&&!io(h,e)?(m===void 0||m.user!==h.id.client||m.type!=="removed")&&(d(),l.set("ychange",i?i("removed",h.id):{type:"removed"})):t!==void 0&&!io(h,t)?(m===void 0||m.user!==h.id.client||m.type!=="added")&&(d(),l.set("ychange",i?i("added",h.id):{type:"added"})):m!==void 0&&(d(),l.delete("ychange")),c+=h.content.str;break}case $i:case ll:{d();const m={insert:h.content.getContent()[0]};if(l.size>0){const b={};m.attributes=b,l.forEach((v,w)=>{b[w]=v})}s.push(m);break}case Et:io(h,e)&&(d(),Ko(l,h.content));break}h=h.right}d()};return e||t?Qe(a,m=>{e&&W0(m,e),t&&W0(m,t),p()},"cleanup"):p(),s}insert(e,t,i){if(t.length<=0)return;const s=this.doc;s!==null?Qe(s,l=>{const a=zh(l,this,e,!i);i||(i={},a.currentAttributes.forEach((c,h)=>{i[h]=c})),Nm(l,this,a,t,i)}):this._pending.push(()=>this.insert(e,t,i))}insertEmbed(e,t,i){const s=this.doc;s!==null?Qe(s,l=>{const a=zh(l,this,e,!i);Nm(l,this,a,t,i||{})}):this._pending.push(()=>this.insertEmbed(e,t,i||{}))}delete(e,t){if(t===0)return;const i=this.doc;i!==null?Qe(i,s=>{px(s,zh(s,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,i){if(t===0)return;const s=this.doc;s!==null?Qe(s,l=>{const a=zh(l,this,e,!1);a.right!==null&&dx(l,this,a,t,i)}):this._pending.push(()=>this.format(e,t,i))}removeAttribute(e){this.doc!==null?Qe(this.doc,t=>{Lf(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?Qe(this.doc,i=>{yb(i,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return bb(this,e)}getAttributes(){return tC(this)}_write(e){e.writeTypeRef(Tj)}}const cj=n=>new Mo;class Lm{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??Xt()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===No||t.constructor===Jr)&&t._start!==null)e=t._start;else for(;e!==null;){const i=e.next;if(i!==null){e=i;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Jr extends Lt{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Jr}clone(){const e=new Jr;return e.insert(0,this.toArray().map(t=>t instanceof Lt?t.clone():t)),e}get length(){return this.doc??Xt(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new Lm(this,e)}querySelector(e){e=e.toUpperCase();const i=new Lm(this,s=>s.nodeName&&s.nodeName.toUpperCase()===e).next();return i.done?null:i.value}querySelectorAll(e){return e=e.toUpperCase(),ys(new Lm(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){Ed(this,e,new fj(this,t,e))}toString(){return XA(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},i){const s=e.createDocumentFragment();return i!==void 0&&i._createAssociation(s,this),Rc(this,l=>{s.insertBefore(l.toDOM(e,t,i),null)}),s}insert(e,t){this.doc!==null?Qe(this.doc,i=>{ZA(i,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)Qe(this.doc,i=>{const s=e&&e instanceof Lt?e._item:e;Nf(i,this,s,t)});else{const i=this._prelimContent,s=e===null?0:i.findIndex(l=>l===e)+1;if(s===0&&e!==null)throw Ii("Reference item not found");i.splice(s,0,...t)}}delete(e,t=1){this.doc!==null?Qe(this.doc,i=>{eC(i,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return YA(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return QA(this,e)}slice(e=0,t=this.length){return FA(this,e,t)}forEach(e){Rc(this,e)}_write(e){e.writeTypeRef(Dj)}}const uj=n=>new Jr;class No extends Jr{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((i,s)=>{this.setAttribute(s,i)}),this._prelimAttrs=null}_copy(){return new No(this.nodeName)}clone(){const e=new No(this.nodeName),t=this.getAttributes();return aB(t,(i,s)=>{e.setAttribute(s,i)}),e.insert(0,this.toArray().map(i=>i instanceof Lt?i.clone():i)),e}toString(){const e=this.getAttributes(),t=[],i=[];for(const c in e)i.push(c);i.sort();const s=i.length;for(let c=0;c<s;c++){const h=i[c];t.push(h+'="'+e[h]+'"')}const l=this.nodeName.toLocaleLowerCase(),a=t.length>0?" "+t.join(" "):"";return`<${l}${a}>${super.toString()}</${l}>`}removeAttribute(e){this.doc!==null?Qe(this.doc,t=>{Lf(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?Qe(this.doc,i=>{yb(i,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return bb(this,e)}hasAttribute(e){return nC(this,e)}getAttributes(e){return e?ej(this,e):tC(this)}toDOM(e=document,t={},i){const s=e.createElement(this.nodeName),l=this.getAttributes();for(const a in l){const c=l[a];typeof c=="string"&&s.setAttribute(a,c)}return Rc(this,a=>{s.appendChild(a.toDOM(e,t,i))}),i!==void 0&&i._createAssociation(s,this),s}_write(e){e.writeTypeRef(Ej),e.writeKey(this.nodeName)}}const hj=n=>new No(n.readKey());class fj extends Cd{constructor(e,t,i){super(e,i),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(s=>{s===null?this.childListChanged=!0:this.attributesChanged.add(s)})}}class Bf extends Ro{constructor(e){super(),this.hookName=e}_copy(){return new Bf(this.hookName)}clone(){const e=new Bf(this.hookName);return this.forEach((t,i)=>{e.set(i,t)}),e}toDOM(e=document,t={},i){const s=t[this.hookName];let l;return s!==void 0?l=s.createDom(this):l=document.createElement(this.hookName),l.setAttribute("data-yjs-hook",this.hookName),i!==void 0&&i._createAssociation(l,this),l}_write(e){e.writeTypeRef(Rj),e.writeKey(this.hookName)}}const dj=n=>new Bf(n.readKey());class jf extends Mo{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new jf}clone(){const e=new jf;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,i){const s=e.createTextNode(this.toString());return i!==void 0&&i._createAssociation(s,this),s}toString(){return this.toDelta().map(e=>{const t=[];for(const s in e.attributes){const l=[];for(const a in e.attributes[s])l.push({key:a,value:e.attributes[s][a]});l.sort((a,c)=>a.key<c.key?-1:1),t.push({nodeName:s,attrs:l})}t.sort((s,l)=>s.nodeName<l.nodeName?-1:1);let i="";for(let s=0;s<t.length;s++){const l=t[s];i+=`<${l.nodeName}`;for(let a=0;a<l.attrs.length;a++){const c=l.attrs[a];i+=` ${c.key}="${c.value}"`}i+=">"}i+=e.insert;for(let s=t.length-1;s>=0;s--)i+=`</${t[s].nodeName}>`;return i}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(Mj)}}const pj=n=>new jf;class vb{constructor(e,t){this.id=e,this.length=t}get deleted(){throw bi()}mergeWith(e){return!1}write(e,t,i){throw bi()}integrate(e,t){throw bi()}}const gj=0;class Zn extends vb{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),PA(e.doc.store,this)}write(e,t){e.writeInfo(gj),e.writeLen(this.length-t)}getMissing(e,t){return null}}class eu{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new eu(this.content)}splice(e){throw bi()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}const mj=n=>new eu(n.readBuf());class Mc{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Mc(this.len)}splice(e){const t=new Mc(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){Tc(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const yj=n=>new Mc(n.readLen()),oC=(n,e)=>new rl({guid:n,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class tu{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new tu(oC(this.doc.guid,this.opts))}splice(e){throw bi()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const bj=n=>new tu(oC(n.readString(),n.readAny()));class ll{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new ll(this.embed)}splice(e){throw bi()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}const vj=n=>new ll(n.readJSON());class Et{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Et(this.key,this.value)}splice(e){throw bi()}mergeWith(e){return!1}integrate(e,t){const i=t.parent;i._searchMarker=null,i._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const wj=n=>new Et(n.readKey(),n.readJSON());class Uf{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Uf(this.arr)}splice(e){const t=new Uf(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const i=this.arr.length;e.writeLen(i-t);for(let s=t;s<i;s++){const l=this.arr[s];e.writeString(l===void 0?"undefined":JSON.stringify(l))}}getRef(){return 2}}const Sj=n=>{const e=n.readLen(),t=[];for(let i=0;i<e;i++){const s=n.readString();s==="undefined"?t.push(void 0):t.push(JSON.parse(s))}return new Uf(t)},kj=Tf("node_env")==="development";class Zr{constructor(e){this.arr=e,kj&&eA(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Zr(this.arr)}splice(e){const t=new Zr(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const i=this.arr.length;e.writeLen(i-t);for(let s=t;s<i;s++){const l=this.arr[s];e.writeAny(l)}}getRef(){return 8}}const xj=n=>{const e=n.readLen(),t=[];for(let i=0;i<e;i++)t.push(n.readAny());return new Zr(t)};class Hi{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Hi(this.str)}splice(e){const t=new Hi(this.str.slice(e));this.str=this.str.slice(0,e);const i=this.str.charCodeAt(e-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}}const _j=n=>new Hi(n.readString()),Oj=[nj,sj,cj,hj,uj,dj,pj],Aj=0,Cj=1,Tj=2,Ej=3,Dj=4,Rj=5,Mj=6;class $i{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new $i(this.type._copy())}splice(e){throw bi()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(i=>{i.deleted?i.id.clock<(e.beforeState.get(i.id.client)||0)&&e._mergeStructs.push(i):i.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(i=>{for(;i!==null;)i.gc(e,!0),i=i.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const Nj=n=>new $i(Oj[n.readTypeRef()](n)),X0=(n,e)=>{let t=e,i=0,s;do i>0&&(t=xe(t.client,t.clock+i)),s=yo(n,t),i=t.clock-s.id.clock,t=s.redone;while(t!==null&&s instanceof Je);return{item:s,diff:i}},wb=(n,e)=>{for(;n!==null&&n.keep!==e;)n.keep=e,n=n.parent._item},zf=(n,e,t)=>{const{client:i,clock:s}=e.id,l=new Je(xe(i,s+t),e,xe(i,s+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&l.markDeleted(),e.keep&&(l.keep=!0),e.redone!==null&&(l.redone=xe(e.redone.client,e.redone.clock+t)),e.right=l,l.right!==null&&(l.right.left=l),n._mergeStructs.push(l),l.parentSub!==null&&l.right===null&&l.parent._map.set(l.parentSub,l),e.length=t,l},gx=(n,e)=>Yy(n,t=>Jc(t.deletions,e)),aC=(n,e,t,i,s,l)=>{const a=n.doc,c=a.store,h=a.clientID,d=e.redone;if(d!==null)return pn(n,d);let p=e.parent._item,m=null,b;if(p!==null&&p.deleted===!0){if(p.redone===null&&(!t.has(p)||aC(n,p,t,i,s,l)===null))return null;for(;p.redone!==null;)p=pn(n,p.redone)}const v=p===null?e.parent:p.content.type;if(e.parentSub===null){for(m=e.left,b=e;m!==null;){let O=m;for(;O!==null&&O.parent._item!==p;)O=O.redone===null?null:pn(n,O.redone);if(O!==null&&O.parent._item===p){m=O;break}m=m.left}for(;b!==null;){let O=b;for(;O!==null&&O.parent._item!==p;)O=O.redone===null?null:pn(n,O.redone);if(O!==null&&O.parent._item===p){b=O;break}b=b.right}}else if(b=null,e.right&&!s){for(m=e;m!==null&&m.right!==null&&(m.right.redone||Jc(i,m.right.id)||gx(l.undoStack,m.right.id)||gx(l.redoStack,m.right.id));)for(m=m.right;m.redone;)m=pn(n,m.redone);if(m&&m.right!==null)return null}else m=v._map.get(e.parentSub)||null;const w=gt(c,h),k=xe(h,w),_=new Je(k,m,m&&m.lastId,b,b&&b.id,v,e.parentSub,e.content.copy());return e.redone=k,wb(_,!0),_.integrate(n,0),_};class Je extends vb{constructor(e,t,i,s,l,a,c,h){super(e,h.getLength()),this.origin=i,this.left=t,this.right=s,this.rightOrigin=l,this.parent=a,this.parentSub=c,this.redone=null,this.content=h,this.info=this.content.isCountable()?qk:0}set marker(e){(this.info&Am)>0!==e&&(this.info^=Am)}get marker(){return(this.info&Am)>0}get keep(){return(this.info&Hk)>0}set keep(e){this.keep!==e&&(this.info^=Hk)}get countable(){return(this.info&qk)>0}get deleted(){return(this.info&Om)>0}set deleted(e){this.deleted!==e&&(this.info^=Om)}markDeleted(){this.info|=Om}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=gt(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=gt(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===mo&&this.id.client!==this.parent.client&&this.parent.clock>=gt(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=lx(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=pn(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Zn||this.right&&this.right.constructor===Zn)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Je?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===Je&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===mo){const i=yo(t,this.parent);i.constructor===Zn?this.parent=null:this.parent=i.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=lx(e,e.doc.store,xe(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let i=this.left,s;if(i!==null)s=i.right;else if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start;const l=new Set,a=new Set;for(;s!==null&&s!==this.right;){if(a.add(s),l.add(s),oo(this.origin,s.origin)){if(s.id.client<this.id.client)i=s,l.clear();else if(oo(this.rightOrigin,s.rightOrigin))break}else if(s.origin!==null&&a.has(yo(e.doc.store,s.origin)))l.has(yo(e.doc.store,s.origin))||(i=s,l.clear());else break;s=s.right}this.left=i}if(this.left!==null){const i=this.left.right;this.right=i,this.left.right=this}else{let i;if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start,this.parent._start=this;this.right=i}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),PA(e.doc.store,this),this.content.integrate(e,this),ax(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new Zn(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:xe(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&oo(e.origin,this.lastId)&&this.right===e&&oo(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(i=>{i.p===e&&(i.p=this,!this.deleted&&this.countable&&(i.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),Tc(e.deleteSet,this.id.client,this.id.clock,this.length),ax(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw Hn();this.content.gc(e),t?z3(e,this,new Zn(this.id,this.length)):this.content=new Mc(this.length)}write(e,t){const i=t>0?xe(this.id.client,this.id.clock+t-1):this.origin,s=this.rightOrigin,l=this.parentSub,a=this.content.getRef()&bd|(i===null?0:Pn)|(s===null?0:ms)|(l===null?0:wc);if(e.writeInfo(a),i!==null&&e.writeLeftID(i),s!==null&&e.writeRightID(s),i===null&&s===null){const c=this.parent;if(c._item!==void 0){const h=c._item;if(h===null){const d=UA(c);e.writeParentInfo(!0),e.writeString(d)}else e.writeParentInfo(!1),e.writeLeftID(h.id)}else c.constructor===String?(e.writeParentInfo(!0),e.writeString(c)):c.constructor===mo?(e.writeParentInfo(!1),e.writeLeftID(c)):Hn();l!==null&&e.writeString(l)}this.content.write(e,t)}}const cC=(n,e)=>Lj[e&bd](n),Lj=[()=>{Hn()},yj,Sj,mj,_j,vj,wj,Nj,xj,bj,()=>{Hn()}],Bj=10;class ei extends vb{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){Hn()}write(e,t){e.writeInfo(Bj),Ee(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const uC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},hC="__ $YJS$ __";uC[hC]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");uC[hC]=!0;var Bm,mx;function fC(){if(mx)return Bm;mx=1;function n(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Bm=n,Bm}var jm,yx;function jj(){if(yx)return jm;yx=1;var n=typeof Ch=="object"&&Ch&&Ch.Object===Object&&Ch;return jm=n,jm}var Um,bx;function dC(){if(bx)return Um;bx=1;var n=jj(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=n||e||Function("return this")();return Um=t,Um}var zm,vx;function Uj(){if(vx)return zm;vx=1;var n=dC(),e=function(){return n.Date.now()};return zm=e,zm}var Im,wx;function zj(){if(wx)return Im;wx=1;var n=/\s/;function e(t){for(var i=t.length;i--&&n.test(t.charAt(i)););return i}return Im=e,Im}var Pm,Sx;function Ij(){if(Sx)return Pm;Sx=1;var n=zj(),e=/^\s+/;function t(i){return i&&i.slice(0,n(i)+1).replace(e,"")}return Pm=t,Pm}var Hm,kx;function pC(){if(kx)return Hm;kx=1;var n=dC(),e=n.Symbol;return Hm=e,Hm}var qm,xx;function Pj(){if(xx)return qm;xx=1;var n=pC(),e=Object.prototype,t=e.hasOwnProperty,i=e.toString,s=n?n.toStringTag:void 0;function l(a){var c=t.call(a,s),h=a[s];try{a[s]=void 0;var d=!0}catch{}var p=i.call(a);return d&&(c?a[s]=h:delete a[s]),p}return qm=l,qm}var Vm,_x;function Hj(){if(_x)return Vm;_x=1;var n=Object.prototype,e=n.toString;function t(i){return e.call(i)}return Vm=t,Vm}var $m,Ox;function qj(){if(Ox)return $m;Ox=1;var n=pC(),e=Pj(),t=Hj(),i="[object Null]",s="[object Undefined]",l=n?n.toStringTag:void 0;function a(c){return c==null?c===void 0?s:i:l&&l in Object(c)?e(c):t(c)}return $m=a,$m}var Gm,Ax;function Vj(){if(Ax)return Gm;Ax=1;function n(e){return e!=null&&typeof e=="object"}return Gm=n,Gm}var Km,Cx;function $j(){if(Cx)return Km;Cx=1;var n=qj(),e=Vj(),t="[object Symbol]";function i(s){return typeof s=="symbol"||e(s)&&n(s)==t}return Km=i,Km}var Wm,Tx;function Gj(){if(Tx)return Wm;Tx=1;var n=Ij(),e=fC(),t=$j(),i=NaN,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt;function h(d){if(typeof d=="number")return d;if(t(d))return i;if(e(d)){var p=typeof d.valueOf=="function"?d.valueOf():d;d=e(p)?p+"":p}if(typeof d!="string")return d===0?d:+d;d=n(d);var m=l.test(d);return m||a.test(d)?c(d.slice(2),m?2:8):s.test(d)?i:+d}return Wm=h,Wm}var Fm,Ex;function Kj(){if(Ex)return Fm;Ex=1;var n=fC(),e=Uj(),t=Gj(),i="Expected a function",s=Math.max,l=Math.min;function a(c,h,d){var p,m,b,v,w,k,_=0,O=!1,R=!1,C=!0;if(typeof c!="function")throw new TypeError(i);h=t(h)||0,n(d)&&(O=!!d.leading,R="maxWait"in d,b=R?s(t(d.maxWait)||0,h):b,C="trailing"in d?!!d.trailing:C);function U(oe){var Q=p,ue=m;return p=m=void 0,_=oe,v=c.apply(ue,Q),v}function B(oe){return _=oe,w=setTimeout(W,h),O?U(oe):v}function z(oe){var Q=oe-k,ue=oe-_,I=h-Q;return R?l(I,b-ue):I}function D(oe){var Q=oe-k,ue=oe-_;return k===void 0||Q>=h||Q<0||R&&ue>=b}function W(){var oe=e();if(D(oe))return ne(oe);w=setTimeout(W,z(oe))}function ne(oe){return w=void 0,C&&p?U(oe):(p=m=void 0,v)}function Ce(){w!==void 0&&clearTimeout(w),_=0,p=k=m=w=void 0}function de(){return w===void 0?v:ne(e())}function J(){var oe=e(),Q=D(oe);if(p=arguments,m=this,k=oe,Q){if(w===void 0)return B(k);if(R)return clearTimeout(w),w=setTimeout(W,h),U(k)}return w===void 0&&(w=setTimeout(W,h)),v}return J.cancel=Ce,J.flush=de,J}return Fm=a,Fm}var Wj=Kj();const Fj=RR(Wj),Q0={info:(n,e)=>{console.info(n,e??{})},warn:(n,e)=>{console.warn(n,e??{})},error:(n,e)=>{console.error(n,e??{})}},Yj=(n,e)=>{const[t,i]=pe.useState("idle"),s=pe.useRef(!1),l=pe.useRef([]),a=pe.useRef(0),c=m=>{const b=m.startsWith("\\x")?m.slice(2):m;if(!/^[0-9a-fA-F]*$/.test(b))return new Uint8Array([]);const v=b.match(/.{1,2}/g);return v?new Uint8Array(v.map(w=>parseInt(w,16))):new Uint8Array([])},h=pe.useCallback(async m=>{i("loading"),s.current=!1;try{const{data:b,error:v}=await n.from("documents").select("content, snapshot_at").eq("id",m).maybeSingle();if(v)throw v;if(b?.content){const R=typeof b.content=="string"?b.content:"",C=c(R);C.length>0&&$0(e,C,"db-load")}const w=b?.snapshot_at??null;let k=n.from("document_updates").select("update, created_at").eq("document_id",m).order("created_at",{ascending:!0});w&&(k=k.gt("created_at",w));const{data:_,error:O}=await k;if(O)throw O;if(_)for(const R of _){const C=typeof R.update=="string"?R.update:"",U=c(C);U.length>0&&$0(e,U,"db-load")}s.current=!0,i("saved")}catch(b){Q0.error("Failed to load document",{error:b}),i("error")}},[n,e]),d=pe.useMemo(()=>Fj(async m=>{if(s.current&&l.current.length!==0){i("saving");try{const b=$A(l.current);l.current=[];const v=Array.from(b).map(k=>k.toString(16).padStart(2,"0")).join(""),{error:w}=await n.rpc("append_document_update",{p_document_id:m,p_update_hex:v});if(w)throw w;if(a.current+=1,a.current>=50){const k=NA(e),_=Array.from(k).map(R=>R.toString(16).padStart(2,"0")).join(""),{error:O}=await n.rpc("compact_document_updates",{p_document_id:m,p_content_hex:_});O||(a.current=0)}i("saved")}catch(b){Q0.error("Failed to append document update",{error:b}),i("error")}}},500),[n,e]),p=pe.useCallback((m,b)=>{l.current.push(b),d(m)},[d]);return{status:t,loadDocument:h,saveUpdate:p,cancelSave:d.cancel}},Xj=n=>new Promise(e=>setTimeout(e,n)),Gi=async(n,e={})=>{const t=e.retries??2,i=e.baseDelayMs??200;let s=0;for(;;)try{return await n()}catch(l){if(s>=t)throw l;const a=i*Math.pow(2,s);await Xj(a),s+=1}},Qj=async n=>{const{data:e,error:t}=await Gi(()=>n.from("documents").select("id, title, updated_at, owner_id, is_public").order("updated_at",{ascending:!1}));if(t)throw t;return e??[]},Jj=async(n,e,t)=>{const{data:i,error:s}=await Gi(()=>n.from("documents").insert({title:e,owner_id:t,content:"",is_public:!1}).select().single());if(s)throw s;return i},Zj=async(n,e)=>{const{error:t}=await Gi(()=>n.from("documents").delete().eq("id",e));if(t)throw t},eU=async(n,e,t)=>{const{error:i}=await Gi(()=>n.from("documents").update({title:t}).eq("id",e));if(i)throw i},tU=async(n,e)=>{const{data:t,error:i}=await Gi(()=>n.from("documents").select("owner_id, is_public, public_permission").eq("id",e).maybeSingle());if(i)throw i;return t},nU=async(n,e)=>{const{data:t,error:i}=await Gi(()=>n.from("document_permissions").select("*").eq("document_id",e));if(i)throw i;return t??[]},iU=async(n,e,t)=>{const{data:i,error:s}=await Gi(()=>n.from("document_permissions").select("permission_level").eq("document_id",e).eq("user_email",t).single());return s?null:i},Dx=async(n,e,t)=>{const{error:i}=await Gi(()=>n.from("documents").update({is_public:t}).eq("id",e));if(i)throw i},sU=async(n,e,t,i)=>{const{error:s}=await Gi(()=>n.from("document_permissions").update({permission_level:i}).eq("document_id",e).eq("user_email",t));if(s)throw s},rU=async(n,e,t)=>{const{error:i}=await Gi(()=>n.from("document_permissions").delete().eq("document_id",e).eq("user_email",t));if(i)throw i},lU=(n,e,t)=>{const[i,s]=pe.useState({permissionLoaded:!1,isReadOnly:!1,accessDenied:!1,isOwner:!1,requiresAuth:!1});return pe.useEffect(()=>{let l=!1;return(async()=>{s(c=>({...c,permissionLoaded:!1}));try{const c=await tU(n,e);if(!c){t?l||s({permissionLoaded:!0,isReadOnly:!0,accessDenied:!0,isOwner:!1,requiresAuth:!1}):l||s({permissionLoaded:!0,isReadOnly:!1,accessDenied:!1,isOwner:!1,requiresAuth:!0});return}const h=(await n.auth.getUser()).data.user?.id;if(c.owner_id===h){l||s({permissionLoaded:!0,isReadOnly:!1,accessDenied:!1,isOwner:!0,requiresAuth:!1});return}if(c.is_public&&c.public_permission==="editor"){l||s({permissionLoaded:!0,isReadOnly:!1,accessDenied:!1,isOwner:!1,requiresAuth:!1});return}if(!t){l||s({permissionLoaded:!0,isReadOnly:!0,accessDenied:!1,isOwner:!1,requiresAuth:!1});return}const d=await iU(n,e,t);l||s({permissionLoaded:!0,isReadOnly:d?.permission_level!=="editor",accessDenied:!1,isOwner:!1,requiresAuth:!1})}catch(c){Q0.error("Failed to check document access",{documentId:e,error:c}),l||s({permissionLoaded:!0,isReadOnly:!0,accessDenied:!0,isOwner:!1,requiresAuth:!1})}})(),()=>{l=!0}},[n,e,t]),i};let J0=[],gC=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?gC:J0).push(t=t+n[e])})();function oU(n){if(n<768)return!1;for(let e=0,t=J0.length;;){let i=e+t>>1;if(n<J0[i])t=i;else if(n>=gC[i])e=i+1;else return!0;if(e==t)return!1}}function Rx(n){return n>=127462&&n<=127487}const Mx=8205;function aU(n,e,t=!0,i=!0){return(t?mC:cU)(n,e,i)}function mC(n,e,t){if(e==n.length)return e;e&&yC(n.charCodeAt(e))&&bC(n.charCodeAt(e-1))&&e--;let i=Ym(n,e);for(e+=Nx(i);e<n.length;){let s=Ym(n,e);if(i==Mx||s==Mx||t&&oU(s))e+=Nx(s),i=s;else if(Rx(s)){let l=0,a=e-2;for(;a>=0&&Rx(Ym(n,a));)l++,a-=2;if(l%2==0)break;e+=2}else break}return e}function cU(n,e,t){for(;e>0;){let i=mC(n,e-2,t);if(i<e)return i;e--}return 0}function Ym(n,e){let t=n.charCodeAt(e);if(!bC(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return yC(i)?(t-55296<<10)+(i-56320)+65536:t}function yC(n){return n>=56320&&n<57344}function bC(n){return n>=55296&&n<56320}function Nx(n){return n<65536?1:2}class He{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){[e,t]=Lo(this,e,t);let s=[];return this.decompose(0,e,s,2),i.length&&i.decompose(0,i.length,s,3),this.decompose(t,this.length,s,1),Ni.from(s,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Lo(this,e,t);let i=[];return this.decompose(e,t,i,0),Ni.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),s=new lc(this),l=new lc(e);for(let a=t,c=t;;){if(s.next(a),l.next(a),a=0,s.lineBreak!=l.lineBreak||s.done!=l.done||s.value!=l.value)return!1;if(c+=s.value.length,s.done||c>=i)return!0}}iter(e=1){return new lc(this,e)}iterRange(e,t=this.length){return new vC(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let s=this.line(e).from;i=this.iterRange(s,Math.max(s,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new wC(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?He.empty:e.length<=32?new pt(e):Ni.from(pt.split(e,[]))}}class pt extends He{constructor(e,t=uU(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,s){for(let l=0;;l++){let a=this.text[l],c=s+a.length;if((t?i:c)>=e)return new hU(s,c,i,a);s=c+1,i++}}decompose(e,t,i,s){let l=e<=0&&t>=this.length?this:new pt(Lx(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(s&1){let a=i.pop(),c=pf(l.text,a.text.slice(),0,l.length);if(c.length<=32)i.push(new pt(c,a.length+l.length));else{let h=c.length>>1;i.push(new pt(c.slice(0,h)),new pt(c.slice(h)))}}else i.push(l)}replace(e,t,i){if(!(i instanceof pt))return super.replace(e,t,i);[e,t]=Lo(this,e,t);let s=pf(this.text,pf(i.text,Lx(this.text,0,e)),t),l=this.length+i.length-(t-e);return s.length<=32?new pt(s,l):Ni.from(pt.split(s,[]),l)}sliceString(e,t=this.length,i=`
`){[e,t]=Lo(this,e,t);let s="";for(let l=0,a=0;l<=t&&a<this.text.length;a++){let c=this.text[a],h=l+c.length;l>e&&a&&(s+=i),e<h&&t>l&&(s+=c.slice(Math.max(0,e-l),t-l)),l=h+1}return s}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],s=-1;for(let l of e)i.push(l),s+=l.length+1,i.length==32&&(t.push(new pt(i,s)),i=[],s=-1);return s>-1&&t.push(new pt(i,s)),t}}class Ni extends He{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,s){for(let l=0;;l++){let a=this.children[l],c=s+a.length,h=i+a.lines-1;if((t?h:c)>=e)return a.lineInner(e,t,i,s);s=c+1,i=h+1}}decompose(e,t,i,s){for(let l=0,a=0;a<=t&&l<this.children.length;l++){let c=this.children[l],h=a+c.length;if(e<=h&&t>=a){let d=s&((a<=e?1:0)|(h>=t?2:0));a>=e&&h<=t&&!d?i.push(c):c.decompose(e-a,t-a,i,d)}a=h+1}}replace(e,t,i){if([e,t]=Lo(this,e,t),i.lines<this.lines)for(let s=0,l=0;s<this.children.length;s++){let a=this.children[s],c=l+a.length;if(e>=l&&t<=c){let h=a.replace(e-l,t-l,i),d=this.lines-a.lines+h.lines;if(h.lines<d>>4&&h.lines>d>>6){let p=this.children.slice();return p[s]=h,new Ni(p,this.length-(t-e)+i.length)}return super.replace(l,c,h)}l=c+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){[e,t]=Lo(this,e,t);let s="";for(let l=0,a=0;l<this.children.length&&a<=t;l++){let c=this.children[l],h=a+c.length;a>e&&l&&(s+=i),e<h&&t>a&&(s+=c.sliceString(e-a,t-a,i)),a=h+1}return s}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Ni))return 0;let i=0,[s,l,a,c]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=t,l+=t){if(s==a||l==c)return i;let h=this.children[s],d=e.children[l];if(h!=d)return i+h.scanIdentical(d,t);i+=h.length+1}}static from(e,t=e.reduce((i,s)=>i+s.length+1,-1)){let i=0;for(let v of e)i+=v.lines;if(i<32){let v=[];for(let w of e)w.flatten(v);return new pt(v,t)}let s=Math.max(32,i>>5),l=s<<1,a=s>>1,c=[],h=0,d=-1,p=[];function m(v){let w;if(v.lines>l&&v instanceof Ni)for(let k of v.children)m(k);else v.lines>a&&(h>a||!h)?(b(),c.push(v)):v instanceof pt&&h&&(w=p[p.length-1])instanceof pt&&v.lines+w.lines<=32?(h+=v.lines,d+=v.length+1,p[p.length-1]=new pt(w.text.concat(v.text),w.length+1+v.length)):(h+v.lines>s&&b(),h+=v.lines,d+=v.length+1,p.push(v))}function b(){h!=0&&(c.push(p.length==1?p[0]:Ni.from(p,d)),d=-1,h=p.length=0)}for(let v of e)m(v);return b(),c.length==1?c[0]:new Ni(c,t)}}He.empty=new pt([""],0);function uU(n){let e=-1;for(let t of n)e+=t.length+1;return e}function pf(n,e,t=0,i=1e9){for(let s=0,l=0,a=!0;l<n.length&&s<=i;l++){let c=n[l],h=s+c.length;h>=t&&(h>i&&(c=c.slice(0,i-s)),s<t&&(c=c.slice(t-s)),a?(e[e.length-1]+=c,a=!1):e.push(c)),s=h+1}return e}function Lx(n,e,t){return pf(n,[""],e,t)}class lc{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof pt?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,s=this.nodes[i],l=this.offsets[i],a=l>>1,c=s instanceof pt?s.text.length:s.children.length;if(a==(t>0?c:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((l&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof pt){let h=s.text[a+(t<0?-1:0)];if(this.offsets[i]+=t,h.length>Math.max(0,e))return this.value=e==0?h:t>0?h.slice(e):h.slice(0,h.length-e),this;e-=h.length}else{let h=s.children[a+(t<0?-1:0)];e>h.length?(e-=h.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(h),this.offsets.push(t>0?1:(h instanceof pt?h.text.length:h.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class vC{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new lc(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*t,this.value=s.length<=i?s:t<0?s.slice(s.length-i):s.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class wC{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:s}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(He.prototype[Symbol.iterator]=function(){return this.iter()},lc.prototype[Symbol.iterator]=vC.prototype[Symbol.iterator]=wC.prototype[Symbol.iterator]=function(){return this});class hU{constructor(e,t,i,s){this.from=e,this.to=t,this.number=i,this.text=s}get length(){return this.to-this.from}}function Lo(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function Ct(n,e,t=!0,i=!0){return aU(n,e,t,i)}function fU(n){return n>=56320&&n<57344}function dU(n){return n>=55296&&n<56320}function fn(n,e){let t=n.charCodeAt(e);if(!dU(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return fU(i)?(t-55296<<10)+(i-56320)+65536:t}function Sb(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function Li(n){return n<65536?1:2}const Z0=/\r\n?|\n/;var tn=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(tn||(tn={}));class zi{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,s=0;t<this.sections.length;){let l=this.sections[t++],a=this.sections[t++];a<0?(e(i,s,l),s+=l):s+=a,i+=l}}iterChangedRanges(e,t=!1){ey(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];s<0?e.push(i,s):e.push(s,i)}return new zi(e)}composeDesc(e){return this.empty?e:e.empty?this:SC(this,e)}mapDesc(e,t=!1){return e.empty?this:ty(this,e,t)}mapPos(e,t=-1,i=tn.Simple){let s=0,l=0;for(let a=0;a<this.sections.length;){let c=this.sections[a++],h=this.sections[a++],d=s+c;if(h<0){if(d>e)return l+(e-s);l+=c}else{if(i!=tn.Simple&&d>=e&&(i==tn.TrackDel&&s<e&&d>e||i==tn.TrackBefore&&s<e||i==tn.TrackAfter&&d>e))return null;if(d>e||d==e&&t<0&&!c)return e==s||t<0?l:l+h;l+=h}s=d}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return l}touchesRange(e,t=e){for(let i=0,s=0;i<this.sections.length&&s<=t;){let l=this.sections[i++],a=this.sections[i++],c=s+l;if(a>=0&&s<=t&&c>=e)return s<e&&c>t?"cover":!0;s=c}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];e+=(e?" ":"")+i+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new zi(e)}static create(e){return new zi(e)}}class At extends zi{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return ey(this,(t,i,s,l,a)=>e=e.replace(s,s+(i-t),a),!1),e}mapDesc(e,t=!1){return ty(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let s=0,l=0;s<t.length;s+=2){let a=t[s],c=t[s+1];if(c>=0){t[s]=c,t[s+1]=a;let h=s>>1;for(;i.length<h;)i.push(He.empty);i.push(a?e.slice(l,l+a):He.empty)}l+=a}return new At(t,i)}compose(e){return this.empty?e:e.empty?this:SC(this,e,!0)}map(e,t=!1){return e.empty?this:ty(this,e,t,!0)}iterChanges(e,t=!1){ey(this,e,t)}get desc(){return zi.create(this.sections)}filter(e){let t=[],i=[],s=[],l=new Nc(this);e:for(let a=0,c=0;;){let h=a==e.length?1e9:e[a++];for(;c<h||c==h&&l.len==0;){if(l.done)break e;let p=Math.min(l.len,h-c);Yt(s,p,-1);let m=l.ins==-1?-1:l.off==0?l.ins:0;Yt(t,p,m),m>0&&tr(i,t,l.text),l.forward(p),c+=p}let d=e[a++];for(;c<d;){if(l.done)break e;let p=Math.min(l.len,d-c);Yt(t,p,-1),Yt(s,p,l.ins==-1?-1:l.off==0?l.ins:0),l.forward(p),c+=p}}return{changes:new At(t,i),filtered:zi.create(s)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],s=this.sections[t+1];s<0?e.push(i):s==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let s=[],l=[],a=0,c=null;function h(p=!1){if(!p&&!s.length)return;a<t&&Yt(s,t-a,-1);let m=new At(s,l);c=c?c.compose(m.map(c)):m,s=[],l=[],a=0}function d(p){if(Array.isArray(p))for(let m of p)d(m);else if(p instanceof At){if(p.length!=t)throw new RangeError(`Mismatched change set length (got ${p.length}, expected ${t})`);h(),c=c?c.compose(p.map(c)):p}else{let{from:m,to:b=m,insert:v}=p;if(m>b||m<0||b>t)throw new RangeError(`Invalid change range ${m} to ${b} (in doc of length ${t})`);let w=v?typeof v=="string"?He.of(v.split(i||Z0)):v:He.empty,k=w.length;if(m==b&&k==0)return;m<a&&h(),m>a&&Yt(s,m-a,-1),Yt(s,b-m,k),tr(l,s,w),a=b}}return d(e),h(!c),c}static empty(e){return new At(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let s=0;s<e.length;s++){let l=e[s];if(typeof l=="number")t.push(l,-1);else{if(!Array.isArray(l)||typeof l[0]!="number"||l.some((a,c)=>c&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(l.length==1)t.push(l[0],0);else{for(;i.length<s;)i.push(He.empty);i[s]=He.of(l.slice(1)),t.push(l[0],i[s].length)}}}return new At(t,i)}static createSet(e,t){return new At(e,t)}}function Yt(n,e,t,i=!1){if(e==0&&t<=0)return;let s=n.length-2;s>=0&&t<=0&&t==n[s+1]?n[s]+=e:s>=0&&e==0&&n[s]==0?n[s+1]+=t:i?(n[s]+=e,n[s+1]+=t):n.push(e,t)}function tr(n,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<i;)n.push(He.empty);n.push(t)}}function ey(n,e,t){let i=n.inserted;for(let s=0,l=0,a=0;a<n.sections.length;){let c=n.sections[a++],h=n.sections[a++];if(h<0)s+=c,l+=c;else{let d=s,p=l,m=He.empty;for(;d+=c,p+=h,h&&i&&(m=m.append(i[a-2>>1])),!(t||a==n.sections.length||n.sections[a+1]<0);)c=n.sections[a++],h=n.sections[a++];e(s,d,l,p,m),s=d,l=p}}}function ty(n,e,t,i=!1){let s=[],l=i?[]:null,a=new Nc(n),c=new Nc(e);for(let h=-1;;){if(a.done&&c.len||c.done&&a.len)throw new Error("Mismatched change set lengths");if(a.ins==-1&&c.ins==-1){let d=Math.min(a.len,c.len);Yt(s,d,-1),a.forward(d),c.forward(d)}else if(c.ins>=0&&(a.ins<0||h==a.i||a.off==0&&(c.len<a.len||c.len==a.len&&!t))){let d=c.len;for(Yt(s,c.ins,-1);d;){let p=Math.min(a.len,d);a.ins>=0&&h<a.i&&a.len<=p&&(Yt(s,0,a.ins),l&&tr(l,s,a.text),h=a.i),a.forward(p),d-=p}c.next()}else if(a.ins>=0){let d=0,p=a.len;for(;p;)if(c.ins==-1){let m=Math.min(p,c.len);d+=m,p-=m,c.forward(m)}else if(c.ins==0&&c.len<p)p-=c.len,c.next();else break;Yt(s,d,h<a.i?a.ins:0),l&&h<a.i&&tr(l,s,a.text),h=a.i,a.forward(a.len-p)}else{if(a.done&&c.done)return l?At.createSet(s,l):zi.create(s);throw new Error("Mismatched change set lengths")}}}function SC(n,e,t=!1){let i=[],s=t?[]:null,l=new Nc(n),a=new Nc(e);for(let c=!1;;){if(l.done&&a.done)return s?At.createSet(i,s):zi.create(i);if(l.ins==0)Yt(i,l.len,0,c),l.next();else if(a.len==0&&!a.done)Yt(i,0,a.ins,c),s&&tr(s,i,a.text),a.next();else{if(l.done||a.done)throw new Error("Mismatched change set lengths");{let h=Math.min(l.len2,a.len),d=i.length;if(l.ins==-1){let p=a.ins==-1?-1:a.off?0:a.ins;Yt(i,h,p,c),s&&p&&tr(s,i,a.text)}else a.ins==-1?(Yt(i,l.off?0:l.len,h,c),s&&tr(s,i,l.textBit(h))):(Yt(i,l.off?0:l.len,a.off?0:a.ins,c),s&&!a.off&&tr(s,i,a.text));c=(l.ins>h||a.ins>=0&&a.len>h)&&(c||i.length>d),l.forward2(h),a.forward(h)}}}}class Nc{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?He.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?He.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class qr{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let i,s;return this.empty?i=s=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),i==this.from&&s==this.to?this:new qr(i,s,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return G.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return G.range(this.anchor,i)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return G.range(e.anchor,e.head)}static create(e,t,i){return new qr(e,t,i)}}class G{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:G.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new G([this.main],0)}addRange(e,t=!0){return G.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,G.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new G(e.ranges.map(t=>qr.fromJSON(t)),e.main)}static single(e,t=e){return new G([G.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,s=0;s<e.length;s++){let l=e[s];if(l.empty?l.from<=i:l.from<i)return G.normalized(e.slice(),t);i=l.to}return new G(e,t)}static cursor(e,t=0,i,s){return qr.create(e,e,(t==0?0:t<0?8:16)|(i==null?7:Math.min(6,i))|(s??16777215)<<6)}static range(e,t,i,s){let l=(i??16777215)<<6|(s==null?7:Math.min(6,s));return t<e?qr.create(t,e,48|l):qr.create(e,t,(t>e?8:0)|l)}static normalized(e,t=0){let i=e[t];e.sort((s,l)=>s.from-l.from),t=e.indexOf(i);for(let s=1;s<e.length;s++){let l=e[s],a=e[s-1];if(l.empty?l.from<=a.to:l.from<a.to){let c=a.from,h=Math.max(l.to,a.to);s<=t&&t--,e.splice(--s,2,l.anchor>l.head?G.range(h,c):G.range(c,h))}}return new G(e,t)}}function kC(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let kb=0;class te{constructor(e,t,i,s,l){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=s,this.id=kb++,this.default=e([]),this.extensions=typeof l=="function"?l(this):l}get reader(){return this}static define(e={}){return new te(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:xb),!!e.static,e.enables)}of(e){return new gf([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new gf(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new gf(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function xb(n,e){return n==e||n.length==e.length&&n.every((t,i)=>t===e[i])}class gf{constructor(e,t,i,s){this.dependencies=e,this.facet=t,this.type=i,this.value=s,this.id=kb++}dynamicSlot(e){var t;let i=this.value,s=this.facet.compareInput,l=this.id,a=e[l]>>1,c=this.type==2,h=!1,d=!1,p=[];for(let m of this.dependencies)m=="doc"?h=!0:m=="selection"?d=!0:(((t=e[m.id])!==null&&t!==void 0?t:1)&1)==0&&p.push(e[m.id]);return{create(m){return m.values[a]=i(m),1},update(m,b){if(h&&b.docChanged||d&&(b.docChanged||b.selection)||ny(m,p)){let v=i(m);if(c?!Bx(v,m.values[a],s):!s(v,m.values[a]))return m.values[a]=v,1}return 0},reconfigure:(m,b)=>{let v,w=b.config.address[l];if(w!=null){let k=Pf(b,w);if(this.dependencies.every(_=>_ instanceof te?b.facet(_)===m.facet(_):_ instanceof Wt?b.field(_,!1)==m.field(_,!1):!0)||(c?Bx(v=i(m),k,s):s(v=i(m),k)))return m.values[a]=k,0}else v=i(m);return m.values[a]=v,1}}}}function Bx(n,e,t){if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(!t(n[i],e[i]))return!1;return!0}function ny(n,e){let t=!1;for(let i of e)oc(n,i)&1&&(t=!0);return t}function pU(n,e,t){let i=t.map(h=>n[h.id]),s=t.map(h=>h.type),l=i.filter(h=>!(h&1)),a=n[e.id]>>1;function c(h){let d=[];for(let p=0;p<i.length;p++){let m=Pf(h,i[p]);if(s[p]==2)for(let b of m)d.push(b);else d.push(m)}return e.combine(d)}return{create(h){for(let d of i)oc(h,d);return h.values[a]=c(h),1},update(h,d){if(!ny(h,l))return 0;let p=c(h);return e.compare(p,h.values[a])?0:(h.values[a]=p,1)},reconfigure(h,d){let p=ny(h,i),m=d.config.facets[e.id],b=d.facet(e);if(m&&!p&&xb(t,m))return h.values[a]=b,0;let v=c(h);return e.compare(v,b)?(h.values[a]=b,0):(h.values[a]=v,1)}}}const Ih=te.define({static:!0});class Wt{constructor(e,t,i,s,l){this.id=e,this.createF=t,this.updateF=i,this.compareF=s,this.spec=l,this.provides=void 0}static define(e){let t=new Wt(kb++,e.create,e.update,e.compare||((i,s)=>i===s),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Ih).find(i=>i.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,s)=>{let l=i.values[t],a=this.updateF(l,s);return this.compareF(l,a)?0:(i.values[t]=a,1)},reconfigure:(i,s)=>{let l=i.facet(Ih),a=s.facet(Ih),c;return(c=l.find(h=>h.field==this))&&c!=a.find(h=>h.field==this)?(i.values[t]=c.create(i),1):s.config.address[this.id]!=null?(i.values[t]=s.field(this),0):(i.values[t]=this.create(i),1)}}}init(e){return[this,Ih.of({field:this,create:e})]}get extension(){return this}}const Ir={lowest:4,low:3,default:2,high:1,highest:0};function Ka(n){return e=>new xC(e,n)}const ol={highest:Ka(Ir.highest),high:Ka(Ir.high),default:Ka(Ir.default),low:Ka(Ir.low),lowest:Ka(Ir.lowest)};class xC{constructor(e,t){this.inner=e,this.prec=t}}class Dd{of(e){return new iy(this,e)}reconfigure(e){return Dd.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class iy{constructor(e,t){this.compartment=e,this.inner=t}}class If{constructor(e,t,i,s,l,a){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=s,this.staticValues=l,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let s=[],l=Object.create(null),a=new Map;for(let b of gU(e,t,a))b instanceof Wt?s.push(b):(l[b.facet.id]||(l[b.facet.id]=[])).push(b);let c=Object.create(null),h=[],d=[];for(let b of s)c[b.id]=d.length<<1,d.push(v=>b.slot(v));let p=i?.config.facets;for(let b in l){let v=l[b],w=v[0].facet,k=p&&p[b]||[];if(v.every(_=>_.type==0))if(c[w.id]=h.length<<1|1,xb(k,v))h.push(i.facet(w));else{let _=w.combine(v.map(O=>O.value));h.push(i&&w.compare(_,i.facet(w))?i.facet(w):_)}else{for(let _ of v)_.type==0?(c[_.id]=h.length<<1|1,h.push(_.value)):(c[_.id]=d.length<<1,d.push(O=>_.dynamicSlot(O)));c[w.id]=d.length<<1,d.push(_=>pU(_,w,v))}}let m=d.map(b=>b(c));return new If(e,a,m,c,h,l)}}function gU(n,e,t){let i=[[],[],[],[],[]],s=new Map;function l(a,c){let h=s.get(a);if(h!=null){if(h<=c)return;let d=i[h].indexOf(a);d>-1&&i[h].splice(d,1),a instanceof iy&&t.delete(a.compartment)}if(s.set(a,c),Array.isArray(a))for(let d of a)l(d,c);else if(a instanceof iy){if(t.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let d=e.get(a.compartment)||a.inner;t.set(a.compartment,d),l(d,c)}else if(a instanceof xC)l(a.inner,a.prec);else if(a instanceof Wt)i[c].push(a),a.provides&&l(a.provides,c);else if(a instanceof gf)i[c].push(a),a.facet.extensions&&l(a.facet.extensions,Ir.default);else{let d=a.extension;if(!d)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);l(d,c)}}return l(n,Ir.default),i.reduce((a,c)=>a.concat(c))}function oc(n,e){if(e&1)return 2;let t=e>>1,i=n.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;n.status[t]=4;let s=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|s}function Pf(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const _C=te.define(),sy=te.define({combine:n=>n.some(e=>e),static:!0}),OC=te.define({combine:n=>n.length?n[0]:void 0,static:!0}),AC=te.define(),CC=te.define(),TC=te.define(),EC=te.define({combine:n=>n.length?n[0]:!1});class Si{constructor(e,t){this.type=e,this.value=t}static define(){return new mU}}class mU{of(e){return new Si(this,e)}}class yU{constructor(e){this.map=e}of(e){return new _e(this,e)}}class _e{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new _e(this.type,t)}is(e){return this.type==e}static define(e={}){return new yU(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let s of e){let l=s.map(t);l&&i.push(l)}return i}}_e.reconfigure=_e.define();_e.appendConfig=_e.define();class Tt{constructor(e,t,i,s,l,a){this.startState=e,this.changes=t,this.selection=i,this.effects=s,this.annotations=l,this.scrollIntoView=a,this._doc=null,this._state=null,i&&kC(i,t.newLength),l.some(c=>c.type==Tt.time)||(this.annotations=l.concat(Tt.time.of(Date.now())))}static create(e,t,i,s,l,a){return new Tt(e,t,i,s,l,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Tt.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Tt.time=Si.define();Tt.userEvent=Si.define();Tt.addToHistory=Si.define();Tt.remote=Si.define();function bU(n,e){let t=[];for(let i=0,s=0;;){let l,a;if(i<n.length&&(s==e.length||e[s]>=n[i]))l=n[i++],a=n[i++];else if(s<e.length)l=e[s++],a=e[s++];else return t;!t.length||t[t.length-1]<l?t.push(l,a):t[t.length-1]<a&&(t[t.length-1]=a)}}function DC(n,e,t){var i;let s,l,a;return t?(s=e.changes,l=At.empty(e.changes.length),a=n.changes.compose(e.changes)):(s=e.changes.map(n.changes),l=n.changes.mapDesc(e.changes,!0),a=n.changes.compose(s)),{changes:a,selection:e.selection?e.selection.map(l):(i=n.selection)===null||i===void 0?void 0:i.map(s),effects:_e.mapEffects(n.effects,s).concat(_e.mapEffects(e.effects,l)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function ry(n,e,t){let i=e.selection,s=vo(e.annotations);return e.userEvent&&(s=s.concat(Tt.userEvent.of(e.userEvent))),{changes:e.changes instanceof At?e.changes:At.of(e.changes||[],t,n.facet(OC)),selection:i&&(i instanceof G?i:G.single(i.anchor,i.head)),effects:vo(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function RC(n,e,t){let i=ry(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let l=1;l<e.length;l++){e[l].filter===!1&&(t=!1);let a=!!e[l].sequential;i=DC(i,ry(n,e[l],a?i.changes.newLength:n.doc.length),a)}let s=Tt.create(n,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return wU(t?vU(s):s)}function vU(n){let e=n.startState,t=!0;for(let s of e.facet(AC)){let l=s(n);if(l===!1){t=!1;break}Array.isArray(l)&&(t=t===!0?l:bU(t,l))}if(t!==!0){let s,l;if(t===!1)l=n.changes.invertedDesc,s=At.empty(e.doc.length);else{let a=n.changes.filter(t);s=a.changes,l=a.filtered.mapDesc(a.changes).invertedDesc}n=Tt.create(e,s,n.selection&&n.selection.map(l),_e.mapEffects(n.effects,l),n.annotations,n.scrollIntoView)}let i=e.facet(CC);for(let s=i.length-1;s>=0;s--){let l=i[s](n);l instanceof Tt?n=l:Array.isArray(l)&&l.length==1&&l[0]instanceof Tt?n=l[0]:n=RC(e,vo(l),!1)}return n}function wU(n){let e=n.startState,t=e.facet(TC),i=n;for(let s=t.length-1;s>=0;s--){let l=t[s](n);l&&Object.keys(l).length&&(i=DC(i,ry(e,l,n.changes.newLength),!0))}return i==n?n:Tt.create(e,n.changes,n.selection,i.effects,i.annotations,i.scrollIntoView)}const SU=[];function vo(n){return n==null?SU:Array.isArray(n)?n:[n]}var rt=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})(rt||(rt={}));const kU=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ly;try{ly=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function xU(n){if(ly)return ly.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||kU.test(t)))return!0}return!1}function _U(n){return e=>{if(!/\S/.test(e))return rt.Space;if(xU(e))return rt.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return rt.Word;return rt.Other}}class Ue{constructor(e,t,i,s,l,a){this.config=e,this.doc=t,this.selection=i,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=l,a&&(a._state=this);for(let c=0;c<this.config.dynamicSlots.length;c++)oc(this,c<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return oc(this,i),Pf(this,i)}update(...e){return RC(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:s}=t;for(let c of e.effects)c.is(Dd.reconfigure)?(t&&(s=new Map,t.compartments.forEach((h,d)=>s.set(d,h)),t=null),s.set(c.value.compartment,c.value.extension)):c.is(_e.reconfigure)?(t=null,i=c.value):c.is(_e.appendConfig)&&(t=null,i=vo(i).concat(c.value));let l;t?l=e.startState.values.slice():(t=If.resolve(i,s,this),l=new Ue(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(h,d)=>d.reconfigure(h,this),null).values);let a=e.startState.facet(sy)?e.newSelection:e.newSelection.asSingle();new Ue(t,e.newDoc,a,l,(c,h)=>h.update(c,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:G.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),s=this.changes(i.changes),l=[i.range],a=vo(i.effects);for(let c=1;c<t.ranges.length;c++){let h=e(t.ranges[c]),d=this.changes(h.changes),p=d.map(s);for(let b=0;b<c;b++)l[b]=l[b].map(p);let m=s.mapDesc(d,!0);l.push(h.range.map(m)),s=s.compose(p),a=_e.mapEffects(a,p).concat(_e.mapEffects(vo(h.effects),m))}return{changes:s,selection:G.create(l,t.mainIndex),effects:a}}changes(e=[]){return e instanceof At?e:At.of(e,this.doc.length,this.facet(Ue.lineSeparator))}toText(e){return He.of(e.split(this.facet(Ue.lineSeparator)||Z0))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(oc(this,t),Pf(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let s=e[i];s instanceof Wt&&this.config.address[s.id]!=null&&(t[i]=s.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(i){for(let l in i)if(Object.prototype.hasOwnProperty.call(e,l)){let a=i[l],c=e[l];s.push(a.init(h=>a.spec.fromJSON(c,h)))}}return Ue.create({doc:e.doc,selection:G.fromJSON(e.selection),extensions:t.extensions?s.concat([t.extensions]):s})}static create(e={}){let t=If.resolve(e.extensions||[],new Map),i=e.doc instanceof He?e.doc:He.of((e.doc||"").split(t.staticFacet(Ue.lineSeparator)||Z0)),s=e.selection?e.selection instanceof G?e.selection:G.single(e.selection.anchor,e.selection.head):G.single(0);return kC(s,i.length),t.staticFacet(sy)||(s=s.asSingle()),new Ue(t,i,s,t.dynamicSlots.map(()=>null),(l,a)=>a.create(l),null)}get tabSize(){return this.facet(Ue.tabSize)}get lineBreak(){return this.facet(Ue.lineSeparator)||`
`}get readOnly(){return this.facet(EC)}phrase(e,...t){for(let i of this.facet(Ue.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,s)=>{if(s=="$")return"$";let l=+(s||1);return!l||l>t.length?i:t[l-1]})),e}languageDataAt(e,t,i=-1){let s=[];for(let l of this.facet(_C))for(let a of l(this,t,i))Object.prototype.hasOwnProperty.call(a,e)&&s.push(a[e]);return s}charCategorizer(e){let t=this.languageDataAt("wordChars",e);return _U(t.length?t[0]:"")}wordAt(e){let{text:t,from:i,length:s}=this.doc.lineAt(e),l=this.charCategorizer(e),a=e-i,c=e-i;for(;a>0;){let h=Ct(t,a,!1);if(l(t.slice(h,a))!=rt.Word)break;a=h}for(;c<s;){let h=Ct(t,c);if(l(t.slice(c,h))!=rt.Word)break;c=h}return a==c?null:G.range(a+i,c+i)}}Ue.allowMultipleSelections=sy;Ue.tabSize=te.define({combine:n=>n.length?n[0]:4});Ue.lineSeparator=OC;Ue.readOnly=EC;Ue.phrases=te.define({compare(n,e){let t=Object.keys(n),i=Object.keys(e);return t.length==i.length&&t.every(s=>n[s]==e[s])}});Ue.languageData=_C;Ue.changeFilter=AC;Ue.transactionFilter=CC;Ue.transactionExtender=TC;Dd.reconfigure=_e.define();function Ki(n,e,t={}){let i={};for(let s of n)for(let l of Object.keys(s)){let a=s[l],c=i[l];if(c===void 0)i[l]=a;else if(!(c===a||a===void 0))if(Object.hasOwnProperty.call(t,l))i[l]=t[l](c,a);else throw new Error("Config merge conflict for field "+l)}for(let s in e)i[s]===void 0&&(i[s]=e[s]);return i}class rr{eq(e){return this==e}range(e,t=e){return oy.create(e,t,this)}}rr.prototype.startSide=rr.prototype.endSide=0;rr.prototype.point=!1;rr.prototype.mapMode=tn.TrackDel;function _b(n,e){return n==e||n.constructor==e.constructor&&n.eq(e)}let oy=class MC{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new MC(e,t,i)}};function ay(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Ob{constructor(e,t,i,s){this.from=e,this.to=t,this.value=i,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,s=0){let l=i?this.to:this.from;for(let a=s,c=l.length;;){if(a==c)return a;let h=a+c>>1,d=l[h]-e||(i?this.value[h].endSide:this.value[h].startSide)-t;if(h==a)return d>=0?a:c;d>=0?c=h:a=h+1}}between(e,t,i,s){for(let l=this.findIndex(t,-1e9,!0),a=this.findIndex(i,1e9,!1,l);l<a;l++)if(s(this.from[l]+e,this.to[l]+e,this.value[l])===!1)return!1}map(e,t){let i=[],s=[],l=[],a=-1,c=-1;for(let h=0;h<this.value.length;h++){let d=this.value[h],p=this.from[h]+e,m=this.to[h]+e,b,v;if(p==m){let w=t.mapPos(p,d.startSide,d.mapMode);if(w==null||(b=v=w,d.startSide!=d.endSide&&(v=t.mapPos(p,d.endSide),v<b)))continue}else if(b=t.mapPos(p,d.startSide),v=t.mapPos(m,d.endSide),b>v||b==v&&d.startSide>0&&d.endSide<=0)continue;(v-b||d.endSide-d.startSide)<0||(a<0&&(a=b),d.point&&(c=Math.max(c,v-b)),i.push(d),s.push(b-a),l.push(v-a))}return{mapped:i.length?new Ob(s,l,i,c):null,pos:a}}}class De{constructor(e,t,i,s){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=s}static create(e,t,i,s){return new De(e,t,i,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:s=0,filterTo:l=this.length}=e,a=e.filter;if(t.length==0&&!a)return this;if(i&&(t=t.slice().sort(ay)),this.isEmpty)return t.length?De.of(t):this;let c=new NC(this,null,-1).goto(0),h=0,d=[],p=new qi;for(;c.value||h<t.length;)if(h<t.length&&(c.from-t[h].from||c.startSide-t[h].value.startSide)>=0){let m=t[h++];p.addInner(m.from,m.to,m.value)||d.push(m)}else c.rangeIndex==1&&c.chunkIndex<this.chunk.length&&(h==t.length||this.chunkEnd(c.chunkIndex)<t[h].from)&&(!a||s>this.chunkEnd(c.chunkIndex)||l<this.chunkPos[c.chunkIndex])&&p.addChunk(this.chunkPos[c.chunkIndex],this.chunk[c.chunkIndex])?c.nextChunk():((!a||s>c.to||l<c.from||a(c.from,c.to,c.value))&&(p.addInner(c.from,c.to,c.value)||d.push(oy.create(c.from,c.to,c.value))),c.next());return p.finishInner(this.nextLayer.isEmpty&&!d.length?De.empty:this.nextLayer.update({add:d,filter:a,filterFrom:s,filterTo:l}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],s=-1;for(let a=0;a<this.chunk.length;a++){let c=this.chunkPos[a],h=this.chunk[a],d=e.touchesRange(c,c+h.length);if(d===!1)s=Math.max(s,h.maxPoint),t.push(h),i.push(e.mapPos(c));else if(d===!0){let{mapped:p,pos:m}=h.map(c,e);p&&(s=Math.max(s,p.maxPoint),t.push(p),i.push(m))}}let l=this.nextLayer.map(e);return t.length==0?l:new De(i,t,l||De.empty,s)}between(e,t,i){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let l=this.chunkPos[s],a=this.chunk[s];if(t>=l&&e<=l+a.length&&a.between(l,e-l,t-l,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return Lc.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Lc.from(e).goto(t)}static compare(e,t,i,s,l=-1){let a=e.filter(m=>m.maxPoint>0||!m.isEmpty&&m.maxPoint>=l),c=t.filter(m=>m.maxPoint>0||!m.isEmpty&&m.maxPoint>=l),h=jx(a,c,i),d=new Wa(a,h,l),p=new Wa(c,h,l);i.iterGaps((m,b,v)=>Ux(d,m,p,b,v,s)),i.empty&&i.length==0&&Ux(d,0,p,0,0,s)}static eq(e,t,i=0,s){s==null&&(s=999999999);let l=e.filter(p=>!p.isEmpty&&t.indexOf(p)<0),a=t.filter(p=>!p.isEmpty&&e.indexOf(p)<0);if(l.length!=a.length)return!1;if(!l.length)return!0;let c=jx(l,a),h=new Wa(l,c,0).goto(i),d=new Wa(a,c,0).goto(i);for(;;){if(h.to!=d.to||!cy(h.active,d.active)||h.point&&(!d.point||!_b(h.point,d.point)))return!1;if(h.to>s)return!0;h.next(),d.next()}}static spans(e,t,i,s,l=-1){let a=new Wa(e,null,l).goto(t),c=t,h=a.openStart;for(;;){let d=Math.min(a.to,i);if(a.point){let p=a.activeForPoint(a.to),m=a.pointFrom<t?p.length+1:a.point.startSide<0?p.length:Math.min(p.length,h);s.point(c,d,a.point,p,m,a.pointRank),h=Math.min(a.openEnd(d),p.length)}else d>c&&(s.span(c,d,a.active,h),h=a.openEnd(d));if(a.to>i)return h+(a.point&&a.to>i?1:0);c=a.to,a.next()}}static of(e,t=!1){let i=new qi;for(let s of e instanceof oy?[e]:t?OU(e):e)i.add(s.from,s.to,s.value);return i.finish()}static join(e){if(!e.length)return De.empty;let t=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let s=e[i];s!=De.empty;s=s.nextLayer)t=new De(s.chunkPos,s.chunk,t,Math.max(s.maxPoint,t.maxPoint));return t}}De.empty=new De([],[],null,-1);function OU(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let i=n[t];if(ay(e,i)>0)return n.slice().sort(ay);e=i}return n}De.empty.nextLayer=De.empty;class qi{finishChunk(e){this.chunks.push(new Ob(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new qi)).add(e,t,i)}addInner(e,t,i){let s=e-this.lastTo||i.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(De.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=De.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function jx(n,e,t){let i=new Map;for(let l of n)for(let a=0;a<l.chunk.length;a++)l.chunk[a].maxPoint<=0&&i.set(l.chunk[a],l.chunkPos[a]);let s=new Set;for(let l of e)for(let a=0;a<l.chunk.length;a++){let c=i.get(l.chunk[a]);c!=null&&(t?t.mapPos(c):c)==l.chunkPos[a]&&!t?.touchesRange(c,c+l.chunk[a].length)&&s.add(l.chunk[a])}return s}class NC{constructor(e,t,i,s=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Lc{constructor(e){this.heap=e}static from(e,t=null,i=-1){let s=[];for(let l=0;l<e.length;l++)for(let a=e[l];!a.isEmpty;a=a.nextLayer)a.maxPoint>=i&&s.push(new NC(a,t,i,l));return s.length==1?s[0]:new Lc(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)Xm(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)Xm(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Xm(this.heap,0)}}}function Xm(n,e){for(let t=n[e];;){let i=(e<<1)+1;if(i>=n.length)break;let s=n[i];if(i+1<n.length&&s.compare(n[i+1])>=0&&(s=n[i+1],i++),t.compare(s)<0)break;n[i]=t,n[e]=s,e=i}}class Wa{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Lc.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Ph(this.active,e),Ph(this.activeTo,e),Ph(this.activeRank,e),this.minActive=zx(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:s,rank:l}=this.cursor;for(;t<this.activeRank.length&&(l-this.activeRank[t]||s-this.activeTo[t])>0;)t++;Hh(this.active,t,i),Hh(this.activeTo,t,s),Hh(this.activeRank,t,l),e&&Hh(e,t,this.cursor.from),this.minActive=zx(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),i&&Ph(i,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let l=this.cursor.value;if(!l.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=l,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=l.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let s=i.length-1;s>=0&&i[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function Ux(n,e,t,i,s,l){n.goto(e),t.goto(i);let a=i+s,c=i,h=i-e,d=!!l.boundChange;for(let p=!1;;){let m=n.to+h-t.to,b=m||n.endSide-t.endSide,v=b<0?n.to+h:t.to,w=Math.min(v,a);if(n.point||t.point?(n.point&&t.point&&_b(n.point,t.point)&&cy(n.activeForPoint(n.to),t.activeForPoint(t.to))||l.comparePoint(c,w,n.point,t.point),p=!1):(p&&l.boundChange(c),w>c&&!cy(n.active,t.active)&&l.compareRange(c,w,n.active,t.active),d&&w<a&&(m||n.openEnd(v)!=t.openEnd(v))&&(p=!0)),v>a)break;c=v,b<=0&&n.next(),b>=0&&t.next()}}function cy(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!_b(n[t],e[t]))return!1;return!0}function Ph(n,e){for(let t=e,i=n.length-1;t<i;t++)n[t]=n[t+1];n.pop()}function Hh(n,e,t){for(let i=n.length-1;i>=e;i--)n[i+1]=n[i];n[e]=t}function zx(n,e){let t=-1,i=1e9;for(let s=0;s<e.length;s++)(e[s]-i||n[s].endSide-n[t].endSide)<0&&(t=s,i=e[s]);return t}function Wo(n,e,t=n.length){let i=0;for(let s=0;s<t&&s<n.length;)n.charCodeAt(s)==9?(i+=e-i%e,s++):(i++,s=Ct(n,s));return i}function uy(n,e,t,i){for(let s=0,l=0;;){if(l>=e)return s;if(s==n.length)break;l+=n.charCodeAt(s)==9?t-l%t:1,s=Ct(n,s)}return i===!0?-1:n.length}const hy="",Ix=typeof Symbol>"u"?"__"+hy:Symbol.for(hy),fy=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Px=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class lr{constructor(e,t){this.rules=[];let{finish:i}=t||{};function s(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function l(a,c,h,d){let p=[],m=/^@(\w+)\b/.exec(a[0]),b=m&&m[1]=="keyframes";if(m&&c==null)return h.push(a[0]+";");for(let v in c){let w=c[v];if(/&/.test(v))l(v.split(/,\s*/).map(k=>a.map(_=>k.replace(/&/,_))).reduce((k,_)=>k.concat(_)),w,h);else if(w&&typeof w=="object"){if(!m)throw new RangeError("The value of a property ("+v+") should be a primitive value.");l(s(v),w,p,b)}else w!=null&&p.push(v.replace(/_.*/,"").replace(/[A-Z]/g,k=>"-"+k.toLowerCase())+": "+w+";")}(p.length||b)&&h.push((i&&!m&&!d?a.map(i):a).join(", ")+" {"+p.join(" ")+"}")}for(let a in e)l(s(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Px[Ix]||1;return Px[Ix]=e+1,hy+e.toString(36)}static mount(e,t,i){let s=e[fy],l=i&&i.nonce;s?l&&s.setNonce(l):s=new AU(e,l),s.mount(Array.isArray(t)?t:[t],e)}}let Hx=new Map;class AU{constructor(e,t){let i=e.ownerDocument||e,s=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&s.CSSStyleSheet){let l=Hx.get(i);if(l)return e[fy]=l;this.sheet=new s.CSSStyleSheet,Hx.set(i,this)}else this.styleTag=i.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[fy]=this}mount(e,t){let i=this.sheet,s=0,l=0;for(let a=0;a<e.length;a++){let c=e[a],h=this.modules.indexOf(c);if(h<l&&h>-1&&(this.modules.splice(h,1),l--,h=-1),h==-1){if(this.modules.splice(l++,0,c),i)for(let d=0;d<c.rules.length;d++)i.insertRule(c.rules[d],s++)}else{for(;l<h;)s+=this.modules[l++].rules.length;s+=c.rules.length,l++}}if(i)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let a="";for(let h=0;h<this.modules.length;h++)a+=this.modules[h].getRules()+`
`;this.styleTag.textContent=a;let c=t.head||t;this.styleTag.parentNode!=c&&c.insertBefore(this.styleTag,c.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var or={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Bc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},CU=typeof navigator<"u"&&/Mac/.test(navigator.platform),TU=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var $t=0;$t<10;$t++)or[48+$t]=or[96+$t]=String($t);for(var $t=1;$t<=24;$t++)or[$t+111]="F"+$t;for(var $t=65;$t<=90;$t++)or[$t]=String.fromCharCode($t+32),Bc[$t]=String.fromCharCode($t);for(var Qm in or)Bc.hasOwnProperty(Qm)||(Bc[Qm]=or[Qm]);function EU(n){var e=CU&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||TU&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Bc:or)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Fe(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=t[i];typeof s=="string"?n.setAttribute(i,s):s!=null&&(n[i]=s)}e++}for(;e<arguments.length;e++)LC(n,arguments[e]);return n}function LC(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)LC(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}let en=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},dy=typeof document<"u"?document:{documentElement:{style:{}}};const py=/Edge\/(\d+)/.exec(en.userAgent),BC=/MSIE \d/.test(en.userAgent),gy=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(en.userAgent),Rd=!!(BC||gy||py),qx=!Rd&&/gecko\/(\d+)/i.test(en.userAgent),Jm=!Rd&&/Chrome\/(\d+)/.exec(en.userAgent),DU="webkitFontSmoothing"in dy.documentElement.style,my=!Rd&&/Apple Computer/.test(en.vendor),Vx=my&&(/Mobile\/\w+/.test(en.userAgent)||en.maxTouchPoints>2);var se={mac:Vx||/Mac/.test(en.platform),windows:/Win/.test(en.platform),linux:/Linux|X11/.test(en.platform),ie:Rd,ie_version:BC?dy.documentMode||6:gy?+gy[1]:py?+py[1]:0,gecko:qx,gecko_version:qx?+(/Firefox\/(\d+)/.exec(en.userAgent)||[0,0])[1]:0,chrome:!!Jm,chrome_version:Jm?+Jm[1]:0,ios:Vx,android:/Android\b/.test(en.userAgent),webkit_version:DU?+(/\bAppleWebKit\/(\d+)/.exec(en.userAgent)||[0,0])[1]:0,safari:my,safari_version:my?+(/\bVersion\/(\d+(\.\d+)?)/.exec(en.userAgent)||[0,0])[1]:0,tabSize:dy.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function Ab(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const Hf=Object.create(null);function Cb(n,e,t){if(n==e)return!0;n||(n=Hf),e||(e=Hf);let i=Object.keys(n),s=Object.keys(e);if(i.length-0!=s.length-0)return!1;for(let l of i)if(l!=t&&(s.indexOf(l)==-1||n[l]!==e[l]))return!1;return!0}function RU(n,e){for(let t=n.attributes.length-1;t>=0;t--){let i=n.attributes[t].name;e[i]==null&&n.removeAttribute(i)}for(let t in e){let i=e[t];t=="style"?n.style.cssText=i:n.getAttribute(t)!=i&&n.setAttribute(t,i)}}function $x(n,e,t){let i=!1;if(e)for(let s in e)t&&s in t||(i=!0,s=="style"?n.style.cssText="":n.removeAttribute(s));if(t)for(let s in t)e&&e[s]==t[s]||(i=!0,s=="style"?n.style.cssText=t[s]:n.setAttribute(s,t[s]));return i}function MU(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let i=n.attributes[t];e[i.name]=i.value}return e}class Wi{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Gt=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(Gt||(Gt={}));class he extends rr{constructor(e,t,i,s){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=s}get heightRelevant(){return!1}static mark(e){return new nu(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return t+=i&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new el(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,s;if(e.isBlockGap)i=-5e8,s=4e8;else{let{start:l,end:a}=jC(e,t);i=(l?t?-3e8:-1:5e8)-1,s=(a?t?2e8:1:-6e8)+1}return new el(e,i,s,t,e.widget||null,!0)}static line(e){return new iu(e)}static set(e,t=!1){return De.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}he.none=De.empty;class nu extends he{constructor(e){let{start:t,end:i}=jC(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?Ab(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||Hf}eq(e){return this==e||e instanceof nu&&this.tagName==e.tagName&&Cb(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}nu.prototype.point=!1;class iu extends he{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof iu&&this.spec.class==e.spec.class&&Cb(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}iu.prototype.mapMode=tn.TrackBefore;iu.prototype.point=!0;class el extends he{constructor(e,t,i,s,l,a){super(t,i,l,e),this.block=s,this.isReplace=a,this.mapMode=s?t<=0?tn.TrackBefore:tn.TrackAfter:tn.TrackDel}get type(){return this.startSide!=this.endSide?Gt.WidgetRange:this.startSide<=0?Gt.WidgetBefore:Gt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof el&&NU(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}el.prototype.point=!0;function jC(n,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=n;return t==null&&(t=n.inclusive),i==null&&(i=n.inclusive),{start:t??e,end:i??e}}function NU(n,e){return n==e||!!(n&&e&&n.compare(e))}function wo(n,e,t,i=0){let s=t.length-1;s>=0&&t[s]+i>=n?t[s]=Math.max(t[s],e):t.push(n,e)}class jc extends rr{constructor(e,t){super(),this.tagName=e,this.attributes=t}eq(e){return e==this||e instanceof jc&&this.tagName==e.tagName&&Cb(this.attributes,e.attributes)}static create(e){return new jc(e.tagName,e.attributes||Hf)}static set(e,t=!1){return De.of(e,t)}}jc.prototype.startSide=jc.prototype.endSide=-1;function Bo(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function yy(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function ac(n,e){if(!e.anchorNode)return!1;try{return yy(n,e.anchorNode)}catch{return!1}}function mf(n){return n.nodeType==3?Uc(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function cc(n,e,t,i){return t?Gx(n,e,t,i,-1)||Gx(n,e,t,i,1):!1}function ar(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function qf(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function Gx(n,e,t,i,s){for(;;){if(n==t&&e==i)return!0;if(e==(s<0?0:bs(n))){if(n.nodeName=="DIV")return!1;let l=n.parentNode;if(!l||l.nodeType!=1)return!1;e=ar(n)+(s<0?0:1),n=l}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=s<0?bs(n):0}else return!1}}function bs(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Vf(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function LU(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function UC(n,e){let t=e.width/n.offsetWidth,i=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-n.offsetHeight)<1)&&(i=1),{scaleX:t,scaleY:i}}function BU(n,e,t,i,s,l,a,c){let h=n.ownerDocument,d=h.defaultView||window;for(let p=n,m=!1;p&&!m;)if(p.nodeType==1){let b,v=p==h.body,w=1,k=1;if(v)b=LU(d);else{if(/^(fixed|sticky)$/.test(getComputedStyle(p).position)&&(m=!0),p.scrollHeight<=p.clientHeight&&p.scrollWidth<=p.clientWidth){p=p.assignedSlot||p.parentNode;continue}let R=p.getBoundingClientRect();({scaleX:w,scaleY:k}=UC(p,R)),b={left:R.left,right:R.left+p.clientWidth*w,top:R.top,bottom:R.top+p.clientHeight*k}}let _=0,O=0;if(s=="nearest")e.top<b.top?(O=e.top-(b.top+a),t>0&&e.bottom>b.bottom+O&&(O=e.bottom-b.bottom+a)):e.bottom>b.bottom&&(O=e.bottom-b.bottom+a,t<0&&e.top-O<b.top&&(O=e.top-(b.top+a)));else{let R=e.bottom-e.top,C=b.bottom-b.top;O=(s=="center"&&R<=C?e.top+R/2-C/2:s=="start"||s=="center"&&t<0?e.top-a:e.bottom-C+a)-b.top}if(i=="nearest"?e.left<b.left?(_=e.left-(b.left+l),t>0&&e.right>b.right+_&&(_=e.right-b.right+l)):e.right>b.right&&(_=e.right-b.right+l,t<0&&e.left<b.left+_&&(_=e.left-(b.left+l))):_=(i=="center"?e.left+(e.right-e.left)/2-(b.right-b.left)/2:i=="start"==c?e.left-l:e.right-(b.right-b.left)+l)-b.left,_||O)if(v)d.scrollBy(_,O);else{let R=0,C=0;if(O){let U=p.scrollTop;p.scrollTop+=O/k,C=(p.scrollTop-U)*k}if(_){let U=p.scrollLeft;p.scrollLeft+=_/w,R=(p.scrollLeft-U)*w}e={left:e.left-R,top:e.top-C,right:e.right-R,bottom:e.bottom-C},R&&Math.abs(R-_)<1&&(i="nearest"),C&&Math.abs(C-O)<1&&(s="nearest")}if(v)break;(e.top<b.top||e.bottom>b.bottom||e.left<b.left||e.right>b.right)&&(e={left:Math.max(e.left,b.left),right:Math.min(e.right,b.right),top:Math.max(e.top,b.top),bottom:Math.min(e.bottom,b.bottom)}),p=p.assignedSlot||p.parentNode}else if(p.nodeType==11)p=p.host;else break}function jU(n){let e=n.ownerDocument,t,i;for(let s=n.parentNode;s&&!(s==e.body||t&&i);)if(s.nodeType==1)!i&&s.scrollHeight>s.clientHeight&&(i=s),!t&&s.scrollWidth>s.clientWidth&&(t=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:t,y:i}}class UU{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:i}=e;this.set(t,Math.min(e.anchorOffset,t?bs(t):0),i,Math.min(e.focusOffset,i?bs(i):0))}set(e,t,i,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=s}}let jr=null;se.safari&&se.safari_version>=26&&(jr=!1);function zC(n){if(n.setActive)return n.setActive();if(jr)return n.focus(jr);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(jr==null?{get preventScroll(){return jr={preventScroll:!0},!0}}:void 0),!jr){jr=!1;for(let t=0;t<e.length;){let i=e[t++],s=e[t++],l=e[t++];i.scrollTop!=s&&(i.scrollTop=s),i.scrollLeft!=l&&(i.scrollLeft=l)}}}let Kx;function Uc(n,e,t=e){let i=Kx||(Kx=document.createRange());return i.setEnd(n,t),i.setStart(n,e),i}function So(n,e,t,i){let s={key:e,code:e,keyCode:t,which:t,cancelable:!0};i&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=i);let l=new KeyboardEvent("keydown",s);l.synthetic=!0,n.dispatchEvent(l);let a=new KeyboardEvent("keyup",s);return a.synthetic=!0,n.dispatchEvent(a),l.defaultPrevented||a.defaultPrevented}function zU(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function IU(n,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(i=Math.min(i,bs(t));;)if(i){if(t.nodeType!=1)return!1;let s=t.childNodes[i-1];s.contentEditable=="false"?i--:(t=s,i=bs(t))}else{if(t==n)return!0;i=ar(t),t=t.parentNode}}function IC(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function PC(n,e){for(let t=n,i=e;;){if(t.nodeType==3&&i>0)return{node:t,offset:i};if(t.nodeType==1&&i>0){if(t.contentEditable=="false")return null;t=t.childNodes[i-1],i=bs(t)}else if(t.parentNode&&!qf(t))i=ar(t),t=t.parentNode;else return null}}function HC(n,e){for(let t=n,i=e;;){if(t.nodeType==3&&i<t.nodeValue.length)return{node:t,offset:i};if(t.nodeType==1&&i<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[i],i=0}else if(t.parentNode&&!qf(t))i=ar(t)+1,t=t.parentNode;else return null}}class mi{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new mi(e.parentNode,ar(e),t)}static after(e,t){return new mi(e.parentNode,ar(e)+1,t)}}var Ze=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(Ze||(Ze={}));const tl=Ze.LTR,Tb=Ze.RTL;function qC(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const PU=qC("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),HU=qC("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),by=Object.create(null),Ei=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);by[e]=t,by[t]=-e}function VC(n){return n<=247?PU[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?HU[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const qU=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class gs{get dir(){return this.level%2?Tb:tl}constructor(e,t,i){this.from=e,this.to=t,this.level=i}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,i,s){let l=-1;for(let a=0;a<e.length;a++){let c=e[a];if(c.from<=t&&c.to>=t){if(c.level==i)return a;(l<0||(s!=0?s<0?c.from<t:c.to>t:e[l].level>c.level))&&(l=a)}}if(l<0)throw new RangeError("Index out of range");return l}}function $C(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let i=n[t],s=e[t];if(i.from!=s.from||i.to!=s.to||i.direction!=s.direction||!$C(i.inner,s.inner))return!1}return!0}const Xe=[];function VU(n,e,t,i,s){for(let l=0;l<=i.length;l++){let a=l?i[l-1].to:e,c=l<i.length?i[l].from:t,h=l?256:s;for(let d=a,p=h,m=h;d<c;d++){let b=VC(n.charCodeAt(d));b==512?b=p:b==8&&m==4&&(b=16),Xe[d]=b==4?2:b,b&7&&(m=b),p=b}for(let d=a,p=h,m=h;d<c;d++){let b=Xe[d];if(b==128)d<c-1&&p==Xe[d+1]&&p&24?b=Xe[d]=p:Xe[d]=256;else if(b==64){let v=d+1;for(;v<c&&Xe[v]==64;)v++;let w=d&&p==8||v<t&&Xe[v]==8?m==1?1:8:256;for(let k=d;k<v;k++)Xe[k]=w;d=v-1}else b==8&&m==1&&(Xe[d]=1);p=b,b&7&&(m=b)}}}function $U(n,e,t,i,s){let l=s==1?2:1;for(let a=0,c=0,h=0;a<=i.length;a++){let d=a?i[a-1].to:e,p=a<i.length?i[a].from:t;for(let m=d,b,v,w;m<p;m++)if(v=by[b=n.charCodeAt(m)])if(v<0){for(let k=c-3;k>=0;k-=3)if(Ei[k+1]==-v){let _=Ei[k+2],O=_&2?s:_&4?_&1?l:s:0;O&&(Xe[m]=Xe[Ei[k]]=O),c=k;break}}else{if(Ei.length==189)break;Ei[c++]=m,Ei[c++]=b,Ei[c++]=h}else if((w=Xe[m])==2||w==1){let k=w==s;h=k?0:1;for(let _=c-3;_>=0;_-=3){let O=Ei[_+2];if(O&2)break;if(k)Ei[_+2]|=2;else{if(O&4)break;Ei[_+2]|=4}}}}}function GU(n,e,t,i){for(let s=0,l=i;s<=t.length;s++){let a=s?t[s-1].to:n,c=s<t.length?t[s].from:e;for(let h=a;h<c;){let d=Xe[h];if(d==256){let p=h+1;for(;;)if(p==c){if(s==t.length)break;p=t[s++].to,c=s<t.length?t[s].from:e}else if(Xe[p]==256)p++;else break;let m=l==1,b=(p<e?Xe[p]:i)==1,v=m==b?m?1:2:i;for(let w=p,k=s,_=k?t[k-1].to:n;w>h;)w==_&&(w=t[--k].from,_=k?t[k-1].to:n),Xe[--w]=v;h=p}else l=d,h++}}}function vy(n,e,t,i,s,l,a){let c=i%2?2:1;if(i%2==s%2)for(let h=e,d=0;h<t;){let p=!0,m=!1;if(d==l.length||h<l[d].from){let k=Xe[h];k!=c&&(p=!1,m=k==16)}let b=!p&&c==1?[]:null,v=p?i:i+1,w=h;e:for(;;)if(d<l.length&&w==l[d].from){if(m)break e;let k=l[d];if(!p)for(let _=k.to,O=d+1;;){if(_==t)break e;if(O<l.length&&l[O].from==_)_=l[O++].to;else{if(Xe[_]==c)break e;break}}if(d++,b)b.push(k);else{k.from>h&&a.push(new gs(h,k.from,v));let _=k.direction==tl!=!(v%2);wy(n,_?i+1:i,s,k.inner,k.from,k.to,a),h=k.to}w=k.to}else{if(w==t||(p?Xe[w]!=c:Xe[w]==c))break;w++}b?vy(n,h,w,i+1,s,b,a):h<w&&a.push(new gs(h,w,v)),h=w}else for(let h=t,d=l.length;h>e;){let p=!0,m=!1;if(!d||h>l[d-1].to){let k=Xe[h-1];k!=c&&(p=!1,m=k==16)}let b=!p&&c==1?[]:null,v=p?i:i+1,w=h;e:for(;;)if(d&&w==l[d-1].to){if(m)break e;let k=l[--d];if(!p)for(let _=k.from,O=d;;){if(_==e)break e;if(O&&l[O-1].to==_)_=l[--O].from;else{if(Xe[_-1]==c)break e;break}}if(b)b.push(k);else{k.to<h&&a.push(new gs(k.to,h,v));let _=k.direction==tl!=!(v%2);wy(n,_?i+1:i,s,k.inner,k.from,k.to,a),h=k.from}w=k.from}else{if(w==e||(p?Xe[w-1]!=c:Xe[w-1]==c))break;w--}b?vy(n,w,h,i+1,s,b,a):w<h&&a.push(new gs(w,h,v)),h=w}}function wy(n,e,t,i,s,l,a){let c=e%2?2:1;VU(n,s,l,i,c),$U(n,s,l,i,c),GU(s,l,i,c),vy(n,s,l,e,t,i,a)}function KU(n,e,t){if(!n)return[new gs(0,0,e==Tb?1:0)];if(e==tl&&!t.length&&!qU.test(n))return GC(n.length);if(t.length)for(;n.length>Xe.length;)Xe[Xe.length]=256;let i=[],s=e==tl?0:1;return wy(n,s,s,t,0,n.length,i),i}function GC(n){return[new gs(0,n,0)]}let KC="";function WU(n,e,t,i,s){var l;let a=i.head-n.from,c=gs.find(e,a,(l=i.bidiLevel)!==null&&l!==void 0?l:-1,i.assoc),h=e[c],d=h.side(s,t);if(a==d){let b=c+=s?1:-1;if(b<0||b>=e.length)return null;h=e[c=b],a=h.side(!s,t),d=h.side(s,t)}let p=Ct(n.text,a,h.forward(s,t));(p<h.from||p>h.to)&&(p=d),KC=n.text.slice(Math.min(a,p),Math.max(a,p));let m=c==(s?e.length-1:0)?null:e[c+(s?1:-1)];return m&&p==d&&m.level+(s?0:1)<h.level?G.cursor(m.side(!s,t)+n.from,m.forward(s,t)?1:-1,m.level):G.cursor(p+n.from,h.forward(s,t)?-1:1,h.level)}function FU(n,e,t){for(let i=e;i<t;i++){let s=VC(n.charCodeAt(i));if(s==1)return tl;if(s==2||s==4)return Tb}return tl}const WC=te.define(),FC=te.define(),YC=te.define(),XC=te.define(),Sy=te.define(),QC=te.define(),JC=te.define(),Eb=te.define(),Db=te.define(),ZC=te.define({combine:n=>n.some(e=>e)}),eT=te.define({combine:n=>n.some(e=>e)}),tT=te.define();class ko{constructor(e,t="nearest",i="nearest",s=5,l=5,a=!1){this.range=e,this.y=t,this.x=i,this.yMargin=s,this.xMargin=l,this.isSnapshot=a}map(e){return e.empty?this:new ko(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new ko(G.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const qh=_e.define({map:(n,e)=>n.map(e)}),nT=_e.define();function mn(n,e,t){let i=n.facet(XC);i.length?i[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const ps=te.define({combine:n=>n.length?n[0]:!0});let YU=0;const ao=te.define({combine(n){return n.filter((e,t)=>{for(let i=0;i<t;i++)if(n[i].plugin==e.plugin)return!1;return!0})}});class lt{constructor(e,t,i,s,l){this.id=e,this.create=t,this.domEventHandlers=i,this.domEventObservers=s,this.baseExtensions=l(this),this.extension=this.baseExtensions.concat(ao.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(ao.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:i,eventObservers:s,provide:l,decorations:a}=t||{};return new lt(YU++,e,i,s,c=>{let h=[];return a&&h.push(Md.of(d=>{let p=d.plugin(c);return p?a(p):he.none})),l&&h.push(l(c)),h})}static fromClass(e,t){return lt.define((i,s)=>new e(i,s),t)}}class Zm{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(mn(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){mn(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){mn(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const iT=te.define(),Rb=te.define(),Md=te.define(),sT=te.define(),Mb=te.define(),su=te.define(),rT=te.define();function Wx(n,e){let t=n.state.facet(rT);if(!t.length)return t;let i=t.map(l=>l instanceof Function?l(n):l),s=[];return De.spans(i,e.from,e.to,{point(){},span(l,a,c,h){let d=l-e.from,p=a-e.from,m=s;for(let b=c.length-1;b>=0;b--,h--){let v=c[b].spec.bidiIsolate,w;if(v==null&&(v=FU(e.text,d,p)),h>0&&m.length&&(w=m[m.length-1]).to==d&&w.direction==v)w.to=p,m=w.inner;else{let k={from:d,to:p,direction:v,inner:[]};m.push(k),m=k.inner}}}}),s}const lT=te.define();function Nb(n){let e=0,t=0,i=0,s=0;for(let l of n.state.facet(lT)){let a=l(n);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(t=Math.max(t,a.right)),a.top!=null&&(i=Math.max(i,a.top)),a.bottom!=null&&(s=Math.max(s,a.bottom)))}return{left:e,right:t,top:i,bottom:s}}const Za=te.define();class ti{constructor(e,t,i,s){this.fromA=e,this.toA=t,this.fromB=i,this.toB=s}join(e){return new ti(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>i.toA)){if(s.toA<i.fromA)break;i=i.join(s),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let s=0,l=0,a=0;;){let c=s<e.length?e[s].fromB:1e9,h=l<t.length?t[l]:1e9,d=Math.min(c,h);if(d==1e9)break;let p=d+a,m=d,b=p;for(;;)if(l<t.length&&t[l]<=m){let v=t[l+1];l+=2,m=Math.max(m,v);for(let w=s;w<e.length&&e[w].fromB<=m;w++)a=e[w].toA-e[w].toB;b=Math.max(b,v+a)}else if(s<e.length&&e[s].fromB<=m){let v=e[s++];m=Math.max(m,v.toB),b=Math.max(b,v.toA),a=v.toA-v.toB}else break;i.push(new ti(p,b,d,m))}return i}}class $f{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=At.empty(this.startState.doc.length);for(let l of i)this.changes=this.changes.compose(l.changes);let s=[];this.changes.iterChangedRanges((l,a,c,h)=>s.push(new ti(l,a,c,h))),this.changedRanges=s}static create(e,t,i){return new $f(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const XU=[];class kt{constructor(e,t,i=0){this.dom=e,this.length=t,this.flags=i,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return XU}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let t=this.domAttrs;t&&RU(this.dom,t)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,t=this.posAtStart){let i=t;for(let s of this.children){if(s==e)return i;i+=s.length+s.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,t){return null}domPosFor(e,t){let i=ar(this.dom),s=this.length?e>0:t>0;return new mi(this.parent.dom,i+(s?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof Ld)return e;return null}static get(e){return e.cmTile}}class Nd extends kt{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let t=this.dom,i=null,s,l=e?.node==t?e:null,a=0;for(let c of this.children){if(c.sync(e),a+=c.length+c.breakAfter,s=i?i.nextSibling:t.firstChild,l&&s!=c.dom&&(l.written=!0),c.dom.parentNode==t)for(;s&&s!=c.dom;)s=Fx(s);else t.insertBefore(c.dom,s);i=c.dom}for(s=i?i.nextSibling:t.firstChild,l&&s&&(l.written=!0);s;)s=Fx(s);this.length=a}}function Fx(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Ld extends Nd{constructor(e,t){super(t),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let t=kt.get(e);if(t&&this.owns(t))return t;e=e.parentNode}}blockTiles(e){for(let t=[],i=this,s=0,l=0;;)if(s==i.children.length){if(!t.length)return;i=i.parent,i.breakAfter&&l++,s=t.pop()}else{let a=i.children[s++];if(a instanceof ir)t.push(s),i=a,s=0;else{let c=l+a.length,h=e(a,l);if(h!==void 0)return h;l=c+a.breakAfter}}}resolveBlock(e,t){let i,s=-1,l,a=-1;if(this.blockTiles((c,h)=>{let d=h+c.length;if(e>=h&&e<=d){if(c.isWidget()&&t>=-1&&t<=1){if(c.flags&32)return!0;c.flags&16&&(i=void 0)}(h<e||e==d&&(t<-1?c.length:c.covers(1)))&&(!i||!c.isWidget()&&i.isWidget())&&(i=c,s=e-h),(d>e||e==h&&(t>1?c.length:c.covers(-1)))&&(!l||!c.isWidget()&&l.isWidget())&&(l=c,a=e-h)}}),!i&&!l)throw new Error("No tile at position "+e);return i&&t<0||!l?{tile:i,offset:s}:{tile:l,offset:a}}}class ir extends Nd{constructor(e,t){super(e),this.wrapper=t}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,t){let i=new ir(t||document.createElement(e.tagName),e);return t||(i.flags|=4),i}}class jo extends Nd{constructor(e,t){super(e),this.attrs=t}isLine(){return!0}static start(e,t,i){let s=new jo(t||document.createElement("div"),e);return(!t||!i)&&(s.flags|=4),s}get domAttrs(){return this.attrs}resolveInline(e,t,i){let s=null,l=-1,a=null,c=-1;function h(p,m){for(let b=0,v=0;b<p.children.length&&v<=m;b++){let w=p.children[b],k=v+w.length;k>=m&&(w.isComposite()?h(w,m-v):(!a||a.isHidden&&(t>0||i&&JU(a,w)))&&(k>m||w.flags&32)?(a=w,c=m-v):(v<m||w.flags&16&&!w.isHidden)&&(s=w,l=m-v)),v=k}}h(this,e);let d=(t<0?s:a)||s||a;return d?{tile:d,offset:d==s?l:c}:null}coordsIn(e,t){let i=this.resolveInline(e,t,!0);return i?i.tile.coordsIn(Math.max(0,i.offset),t):QU(this)}domIn(e,t){let i=this.resolveInline(e,t);if(i){let{tile:s,offset:l}=i;if(this.dom.contains(s.dom))return s.isText()?new mi(s.dom,Math.min(s.dom.nodeValue.length,l)):s.domPosFor(l,s.flags&16?1:s.flags&32?-1:t);let a=i.tile.parent,c=!1;for(let h of a.children){if(c)return new mi(h.dom,0);h==i.tile&&(c=!0)}}return new mi(this.dom,0)}}function QU(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=mf(e);return t[t.length-1]||null}function JU(n,e){let t=n.coordsIn(0,1),i=e.coordsIn(0,1);return t&&i&&i.top<t.bottom}class gn extends Nd{constructor(e,t){super(e),this.mark=t}get domAttrs(){return this.mark.attrs}static of(e,t){let i=new gn(t||document.createElement(e.tagName),e);return t||(i.flags|=4),i}}class Vr extends kt{constructor(e,t){super(e,t.length),this.text=t}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,t){let i=this.dom.nodeValue.length;e>i&&(e=i);let s=e,l=e,a=0;e==0&&t<0||e==i&&t>=0?se.chrome||se.gecko||(e?(s--,a=1):l<i&&(l++,a=-1)):t<0?s--:l<i&&l++;let c=Uc(this.dom,s,l).getClientRects();if(!c.length)return null;let h=c[(a?a<0:t>=0)?0:c.length-1];return se.safari&&!a&&h.width==0&&(h=Array.prototype.find.call(c,d=>d.width)||h),a?Vf(h,a<0):h||null}static of(e,t){let i=new Vr(t||document.createTextNode(e),e);return t||(i.flags|=2),i}}class nl extends kt{constructor(e,t,i,s){super(e,t,s),this.widget=i}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,t){return this.coordsInWidget(e,t,!1)}coordsInWidget(e,t,i){let s=this.widget.coordsAt(this.dom,e,t);if(s)return s;if(i)return Vf(this.dom.getBoundingClientRect(),this.length?e==0:t<=0);{let l=this.dom.getClientRects(),a=null;if(!l.length)return null;let c=this.flags&16?!0:this.flags&32?!1:e>0;for(let h=c?l.length-1:0;a=l[h],!(e>0?h==0:h==l.length-1||a.top<a.bottom);h+=c?-1:1);return Vf(a,!c)}}get overrideDOMText(){if(!this.length)return He.empty;let{root:e}=this;if(!e)return He.empty;let t=this.posAtStart;return e.view.state.doc.slice(t,t+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,t,i,s,l){return l||(l=e.toDOM(t),e.editable||(l.contentEditable="false")),new nl(l,i,e,s)}}class Gf extends kt{constructor(e){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),super(t,0,e)}get isHidden(){return!0}get overrideDOMText(){return He.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class ZU{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,t,i){let{tile:s,index:l,beforeBreak:a,parents:c}=this;for(;e||t>0;)if(s.isComposite())if(a){if(!e)break;i&&i.break(),e--,a=!1}else if(l==s.children.length){if(!e&&!c.length)break;i&&i.leave(s),a=!!s.breakAfter,{tile:s,index:l}=c.pop(),l++}else{let h=s.children[l],d=h.breakAfter;(t>0?h.length<=e:h.length<e)&&(!i||i.skip(h,0,h.length)!==!1||!h.isComposite)?(a=!!d,l++,e-=h.length):(c.push({tile:s,index:l}),s=h,l=0,i&&h.isComposite()&&i.enter(h))}else if(l==s.length)a=!!s.breakAfter,{tile:s,index:l}=c.pop(),l++;else if(e){let h=Math.min(e,s.length-l);i&&i.skip(s,l,l+h),e-=h,l+=h}else break;return this.tile=s,this.index=l,this.beforeBreak=a,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class e4{constructor(e,t,i,s){this.from=e,this.to=t,this.wrapper=i,this.rank=s}}class t4{constructor(e,t,i){this.cache=e,this.root=t,this.blockWrappers=i,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,t,i,s){var l;this.flushBuffer();let a=this.ensureMarks(t,i),c=a.lastChild;if(c&&c.isText()&&!(c.flags&8)&&c.length+e.length<512){this.cache.reused.set(c,2);let h=a.children[a.children.length-1]=new Vr(c.dom,c.text+e);h.parent=a}else a.append(s||Vr.of(e,(l=this.cache.find(Vr))===null||l===void 0?void 0:l.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,t){let i=this.curLine;i.dom!=t.line.dom&&(i.setDOM(this.cache.reused.has(t.line)?e0(t.line.dom):t.line.dom),this.cache.reused.set(t.line,2));let s=i;for(let c=t.marks.length-1;c>=0;c--){let h=t.marks[c],d=s.lastChild;if(d instanceof gn&&d.mark.eq(h.mark))d.dom!=h.dom&&d.setDOM(e0(h.dom)),s=d;else{if(this.cache.reused.get(h)){let m=kt.get(h.dom);m&&m.setDOM(e0(h.dom))}let p=gn.of(h.mark,h.dom);s.append(p),s=p}this.cache.reused.set(h,2)}let l=kt.get(e.text);l&&this.cache.reused.set(l,2);let a=new Vr(e.text,e.text.nodeValue);a.flags|=8,s.append(a)}addInlineWidget(e,t,i){let s=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);s||this.flushBuffer();let l=this.ensureMarks(t,i);!s&&!(e.flags&16)&&l.append(this.getBuffer(1)),l.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,t,i){this.flushBuffer(),this.ensureMarks(t,i).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let t=this.afterWidget||this.lastBlock;t.length+=e,this.pos+=e}addLineStart(e,t){var i;e||(e=oT);let s=jo.start(e,t||((i=this.cache.find(jo))===null||i===void 0?void 0:i.dom),!!t);this.getBlockPos().append(this.lastBlock=this.curLine=s)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,t){var i;let s=this.curLine;for(let l=e.length-1;l>=0;l--){let a=e[l],c;if(t>0&&(c=s.lastChild)&&c instanceof gn&&c.mark.eq(a))s=c,t--;else{let h=gn.of(a,(i=this.cache.find(gn,d=>d.mark.eq(a)))===null||i===void 0?void 0:i.dom);s.append(h),s=h,t=0}}return s}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!Yx(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(se.ios&&Yx(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(t0,0,32)||new nl(t0.toDOM(),0,t0,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let t=new e4(e.from,e.to,e.value,e.rank),i=this.wrappers.length;for(;i>0&&(this.wrappers[i-1].rank-t.rank||this.wrappers[i-1].to-t.to)<0;)i--;this.wrappers.splice(i,0,t)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let t=this.root;for(let i of this.wrappers){let s=t.lastChild;if(i.from<this.pos&&s instanceof ir&&s.wrapper.eq(i.wrapper))t=s;else{let l=ir.of(i.wrapper,(e=this.cache.find(ir,a=>a.wrapper.eq(i.wrapper)))===null||e===void 0?void 0:e.dom);t.append(l),t=l}}return t}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let t=2|(e<0?16:32),i=this.cache.find(Gf,void 0,1);return i&&(i.flags=t),i||new Gf(t)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class n4{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:s,lineBreak:l,done:a}=this.cursor.next(this.skipCount);if(this.skipCount=0,a)throw new Error("Ran out of text content when drawing inline views");this.text=s;let c=this.textOff=Math.min(e,s.length);return l?null:s.slice(0,c)}let t=Math.min(this.text.length,this.textOff+e),i=this.text.slice(this.textOff,t);return this.textOff=t,i}}const Kf=[nl,jo,Vr,gn,Gf,ir,Ld];for(let n=0;n<Kf.length;n++)Kf[n].bucket=n;class i4{constructor(e){this.view=e,this.buckets=Kf.map(()=>[]),this.index=Kf.map(()=>0),this.reused=new Map}add(e){let t=e.constructor.bucket,i=this.buckets[t];i.length<6?i.push(e):i[this.index[t]=(this.index[t]+1)%6]=e}find(e,t,i=2){let s=e.bucket,l=this.buckets[s],a=this.index[s];for(let c=l.length-1;c>=0;c--){let h=(c+a)%l.length,d=l[h];if((!t||t(d))&&!this.reused.has(d))return l.splice(h,1),h<a&&this.index[s]--,this.reused.set(d,i),d}return null}findWidget(e,t,i){let s=this.buckets[0];if(s.length)for(let l=0,a=0;;l++){if(l==s.length){if(a)return null;a=1,l=0}let c=s[l];if(!this.reused.has(c)&&(a==0?c.widget.compare(e):c.widget.constructor==e.constructor&&e.updateDOM(c.dom,this.view)))return s.splice(l,1),l<this.index[0]&&this.index[0]--,c.widget==e&&c.length==t&&(c.flags&497)==i?(this.reused.set(c,1),c):(this.reused.set(c,2),new nl(c.dom,t,e,c.flags&-498|i))}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,t=2){if(!this.reused.has(e))return this.reused.set(e,t),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class s4{constructor(e,t,i,s,l){this.view=e,this.decorations=s,this.disallowBlockEffectsFor=l,this.openWidget=!1,this.openMarks=0,this.cache=new i4(e),this.text=new n4(e.state.doc),this.builder=new t4(this.cache,new Ld(e,e.contentDOM),De.iter(i)),this.cache.reused.set(t,2),this.old=new ZU(t),this.reuseWalker={skip:(a,c,h)=>{if(this.cache.add(a),a.isComposite())return!1},enter:a=>this.cache.add(a),leave:()=>{},break:()=>{}}}run(e,t){let i=t&&this.getCompositionContext(t.text);for(let s=0,l=0,a=0;;){let c=a<e.length?e[a++]:null,h=c?c.fromA:this.old.root.length;if(h>s){let d=h-s;this.preserve(d,!a,!c),s=h,l+=d}if(!c)break;t&&c.fromA<=t.range.fromA&&c.toA>=t.range.toA?(this.forward(c.fromA,t.range.fromA,t.range.fromA<t.range.toA?1:-1),this.emit(l,t.range.fromB),this.cache.clear(),this.builder.addComposition(t,i),this.text.skip(t.range.toB-t.range.fromB),this.forward(t.range.fromA,c.toA),this.emit(t.range.toB,c.toB)):(this.forward(c.fromA,c.toA),this.emit(l,c.toB)),l=c.toB,s=c.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,t,i){let s=o4(this.old),l=this.openMarks;this.old.advance(e,i?1:-1,{skip:(a,c,h)=>{if(a.isWidget())if(this.openWidget)this.builder.continueWidget(h-c);else{let d=h>0||c<a.length?nl.of(a.widget,this.view,h-c,a.flags&496,this.cache.maybeReuse(a)):this.cache.reuse(a);d.flags&256?(d.flags&=-2,this.builder.addBlockWidget(d)):(this.builder.ensureLine(null),this.builder.addInlineWidget(d,s,l),l=s.length)}else if(a.isText())this.builder.ensureLine(null),!c&&h==a.length?this.builder.addText(a.text,s,l,this.cache.reuse(a)):(this.cache.add(a),this.builder.addText(a.text.slice(c,h),s,l)),l=s.length;else if(a.isLine())a.flags&=-2,this.cache.reused.set(a,1),this.builder.addLine(a);else if(a instanceof Gf)this.cache.add(a);else if(a instanceof gn)this.builder.ensureLine(null),this.builder.addMark(a,s,l),this.cache.reused.set(a,1),l=s.length;else return!1;this.openWidget=!1},enter:a=>{a.isLine()?this.builder.addLineStart(a.attrs,this.cache.maybeReuse(a)):(this.cache.add(a),a instanceof gn&&s.unshift(a.mark)),this.openWidget=!1},leave:a=>{a.isLine()?s.length&&(s.length=l=0):a instanceof gn&&(s.shift(),l=Math.min(l,s.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,t){let i=null,s=this.builder,l=0,a=De.spans(this.decorations,e,t,{point:(c,h,d,p,m,b)=>{if(d instanceof el){if(this.disallowBlockEffectsFor[b]){if(d.block)throw new RangeError("Block decorations may not be specified via plugins");if(h>this.view.state.doc.lineAt(c).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(l=p.length,m>p.length)s.continueWidget(h-c);else{let v=d.widget||(d.block?Uo.block:Uo.inline),w=r4(d),k=this.cache.findWidget(v,h-c,w)||nl.of(v,this.view,h-c,w);d.block?(d.startSide>0&&s.addLineStartIfNotCovered(i),s.addBlockWidget(k)):(s.ensureLine(i),s.addInlineWidget(k,p,m))}i=null}else i=l4(i,d);h>c&&this.text.skip(h-c)},span:(c,h,d,p)=>{for(let m=c;m<h;){let b=this.text.next(Math.min(512,h-m));b==null?(s.addLineStartIfNotCovered(i),s.addBreak(),m++):(s.ensureLine(i),s.addText(b,d,m==c?p:d.length),m+=b.length),i=null}}});s.addLineStartIfNotCovered(i),this.openWidget=a>l,this.openMarks=a}forward(e,t,i=1){t-e<=10?this.old.advance(t-e,i,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(t-e-10,-1),this.old.advance(5,i,this.reuseWalker))}getCompositionContext(e){let t=[],i=null;for(let s=e.parentNode;;s=s.parentNode){let l=kt.get(s);if(s==this.view.contentDOM)break;l instanceof gn?t.push(l):l?.isLine()?i=l:s.nodeName=="DIV"&&!i&&s!=this.view.contentDOM?i=new jo(s,oT):t.push(gn.of(new nu({tagName:s.nodeName.toLowerCase(),attributes:MU(s)}),s))}return{line:i,marks:t}}}function Yx(n,e){let t=i=>{for(let s of i.children)if((e?s.isText():s.length)||t(s))return!0;return!1};return t(n)}function r4(n){let e=n.isReplace?(n.startSide<0?64:0)|(n.endSide>0?128:0):n.startSide>0?32:16;return n.block&&(e|=256),e}const oT={class:"cm-line"};function l4(n,e){let t=e.spec.attributes,i=e.spec.class;return!t&&!i||(n||(n={class:"cm-line"}),t&&Ab(t,n),i&&(n.class+=" "+i)),n}function o4(n){let e=[];for(let t=n.parents.length;t>1;t--){let i=t==n.parents.length?n.tile:n.parents[t].tile;i instanceof gn&&e.push(i.mark)}return e}function e0(n){let e=kt.get(n);return e&&e.setDOM(n.cloneNode()),n}class Uo extends Wi{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Uo.inline=new Uo("span");Uo.block=new Uo("div");const t0=new class extends Wi{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class Xx{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=he.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new Ld(e,e.contentDOM),this.updateInner([new ti(0,0,0,e.state.doc.length)],null)}update(e){var t;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:p,toA:m})=>m<this.minWidthFrom||p>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?s=this.domChanged.newSel.head:!m4(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let l=s>-1?c4(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){let{from:p,to:m}=this.hasComposition;i=new ti(p,m,e.changes.mapPos(p,-1),e.changes.mapPos(m,1)).addToSet(i.slice())}this.hasComposition=l?{from:l.range.fromB,to:l.range.toB}:null,(se.ie||se.chrome)&&!l&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,c=this.blockWrappers;this.updateDeco();let h=f4(a,this.decorations,e.changes);h.length&&(i=ti.extendWithRanges(i,h));let d=p4(c,this.blockWrappers,e.changes);return d.length&&(i=ti.extendWithRanges(i,d)),l&&!i.some(p=>p.fromA<=l.range.fromA&&p.toA>=l.range.toA)&&(i=l.range.addToSet(i.slice())),this.tile.flags&2&&i.length==0?!1:(this.updateInner(i,l),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0;let{observer:i}=this.view;i.ignore(()=>{if(t||e.length){let a=this.tile,c=new s4(this.view,a,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=c.run(e,t),ky(a,c.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let l=se.chrome||se.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(l),l&&(l.written||i.selectionRange.focusNode!=l.node||!this.tile.dom.contains(l.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let l of this.tile.children)l.isWidget()&&l.widget instanceof n0&&s.push(l.dom);i.updateGaps(s)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let i of t.effects)i.is(nT)&&(this.editContextFormatting=i.value)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:i}=this.tile,s=this.view.root.activeElement,l=s==i,a=!l&&!(this.view.state.facet(ps)||i.tabIndex>-1)&&ac(i,this.view.observer.selectionRange)&&!(s&&i.contains(s));if(!(l||t||a))return;let c=this.forceSelection;this.forceSelection=!1;let h=this.view.state.selection.main,d,p;if(h.empty?p=d=this.inlineDOMNearPos(h.anchor,h.assoc||1):(p=this.inlineDOMNearPos(h.head,h.head==h.from?1:-1),d=this.inlineDOMNearPos(h.anchor,h.anchor==h.from?1:-1)),se.gecko&&h.empty&&!this.hasComposition&&a4(d)){let b=document.createTextNode("");this.view.observer.ignore(()=>d.node.insertBefore(b,d.node.childNodes[d.offset]||null)),d=p=new mi(b,0),c=!0}let m=this.view.observer.selectionRange;(c||!m.focusNode||(!cc(d.node,d.offset,m.anchorNode,m.anchorOffset)||!cc(p.node,p.offset,m.focusNode,m.focusOffset))&&!this.suppressWidgetCursorChange(m,h))&&(this.view.observer.ignore(()=>{se.android&&se.chrome&&i.contains(m.focusNode)&&g4(m.focusNode,i)&&(i.blur(),i.focus({preventScroll:!0}));let b=Bo(this.view.root);if(b)if(h.empty){if(se.gecko){let v=u4(d.node,d.offset);if(v&&v!=3){let w=(v==1?PC:HC)(d.node,d.offset);w&&(d=new mi(w.node,w.offset))}}b.collapse(d.node,d.offset),h.bidiLevel!=null&&b.caretBidiLevel!==void 0&&(b.caretBidiLevel=h.bidiLevel)}else if(b.extend){b.collapse(d.node,d.offset);try{b.extend(p.node,p.offset)}catch{}}else{let v=document.createRange();h.anchor>h.head&&([d,p]=[p,d]),v.setEnd(p.node,p.offset),v.setStart(d.node,d.offset),b.removeAllRanges(),b.addRange(v)}a&&this.view.root.activeElement==i&&(i.blur(),s&&s.focus())}),this.view.observer.setSelectionRange(d,p)),this.impreciseAnchor=d.precise?null:new mi(m.anchorNode,m.anchorOffset),this.impreciseHead=p.precise?null:new mi(m.focusNode,m.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&cc(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,i=Bo(e.root),{anchorNode:s,anchorOffset:l}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let a=this.lineAt(t.head,t.assoc);if(!a)return;let c=a.posAtStart;if(t.head==c||t.head==c+a.length)return;let h=this.coordsAt(t.head,-1),d=this.coordsAt(t.head,1);if(!h||!d||h.bottom>d.top)return;let p=this.domAtPos(t.head+t.assoc,t.assoc);i.collapse(p.node,p.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let m=e.observer.selectionRange;e.docView.posFromDOM(m.anchorNode,m.anchorOffset)!=t.from&&i.collapse(s,l)}posFromDOM(e,t){let i=this.tile.nearest(e);if(!i)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let s=i.posAtStart;if(i.isComposite()){let l;if(e==i.dom)l=i.dom.childNodes[t];else{let a=bs(e)==0?0:t==0?-1:1;for(;;){let c=e.parentNode;if(c==i.dom)break;a==0&&c.firstChild!=c.lastChild&&(e==c.firstChild?a=-1:a=1),e=c}a<0?l=e:l=e.nextSibling}if(l==i.dom.firstChild)return s;for(;l&&!kt.get(l);)l=l.nextSibling;if(!l)return s+i.length;for(let a=0,c=s;;a++){let h=i.children[a];if(h.dom==l)return c;c+=h.length+h.breakAfter}}else return i.isText()?e==i.dom?s+t:s+(t?i.length:0):s}domAtPos(e,t){let{tile:i,offset:s}=this.tile.resolveBlock(e,t);return i.isWidget()?i.domPosFor(e,t):i.domIn(s,t)}inlineDOMNearPos(e,t){let i,s=-1,l=!1,a,c=-1,h=!1;return this.tile.blockTiles((d,p)=>{if(d.isWidget()){if(d.flags&32&&p>=e)return!0;d.flags&16&&(l=!0)}else{let m=p+d.length;if(p<=e&&(i=d,s=e-p,l=m<e),m>=e&&!a&&(a=d,c=e-p,h=p>e),p>e&&a)return!0}}),!i&&!a?this.domAtPos(e,t):(l&&a?i=null:h&&i&&(a=null),i&&t<0||!a?i.domIn(s,t):a.domIn(c,t))}coordsAt(e,t){let{tile:i,offset:s}=this.tile.resolveBlock(e,t);return i.isWidget()?i.widget instanceof n0?null:i.coordsInWidget(s,t,!0):i.coordsIn(s,t)}lineAt(e,t){let{tile:i}=this.tile.resolveBlock(e,t);return i.isLine()?i:null}coordsForChar(e){let{tile:t,offset:i}=this.tile.resolveBlock(e,1);if(!t.isLine())return null;function s(l,a){if(l.isComposite())for(let c of l.children){if(c.length>=a){let h=s(c,a);if(h)return h}if(a-=c.length,a<0)break}else if(l.isText()&&a<l.length){let c=Ct(l.text,a);if(c==a)return null;let h=Uc(l.dom,a,c).getClientRects();for(let d=0;d<h.length;d++){let p=h[d];if(d==h.length-1||p.top<p.bottom&&p.left<p.right)return p}}return null}return s(t,i)}measureVisibleLineHeights(e){let t=[],{from:i,to:s}=e,l=this.view.contentDOM.clientWidth,a=l>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,c=-1,h=this.view.textDirection==Ze.LTR,d=0,p=(m,b,v)=>{for(let w=0;w<m.children.length&&!(b>s);w++){let k=m.children[w],_=b+k.length,O=k.dom.getBoundingClientRect(),{height:R}=O;if(v&&!w&&(d+=O.top-v.top),k instanceof ir)_>i&&p(k,b,O);else if(b>=i&&(d>0&&t.push(-d),t.push(R+d),d=0,a)){let C=k.dom.lastChild,U=C?mf(C):[];if(U.length){let B=U[U.length-1],z=h?B.right-O.left:O.right-B.left;z>c&&(c=z,this.minWidth=l,this.minWidthFrom=b,this.minWidthTo=_)}}v&&w==m.children.length-1&&(d+=v.bottom-O.bottom),b=_+k.breakAfter}};return p(this.tile,0,null),t}textDirectionAt(e){let{tile:t}=this.tile.resolveBlock(e,1);return getComputedStyle(t.dom).direction=="rtl"?Ze.RTL:Ze.LTR}measureTextSize(){let e=this.tile.blockTiles(a=>{if(a.isLine()&&a.children.length&&a.length<=20){let c=0,h;for(let d of a.children){if(!d.isText()||/[^ -~]/.test(d.text))return;let p=mf(d.dom);if(p.length!=1)return;c+=p[0].width,h=p[0].height}if(c)return{lineHeight:a.dom.getBoundingClientRect().height,charWidth:c/a.length,textHeight:h}}});if(e)return e;let t=document.createElement("div"),i,s,l;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(t);let a=mf(t.firstChild)[0];i=t.getBoundingClientRect().height,s=a&&a.width?a.width/27:7,l=a&&a.height?a.height:i,t.remove()}),{lineHeight:i,charWidth:s,textHeight:l}}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,s=0;;s++){let l=s==t.viewports.length?null:t.viewports[s],a=l?l.from-1:this.view.state.doc.length;if(a>i){let c=(t.lineBlockAt(a).bottom-t.lineBlockAt(i).top)/this.view.scaleY;e.push(he.replace({widget:new n0(c),block:!0,inclusive:!0,isBlockGap:!0}).range(i,a))}if(!l)break;i=l.to+1}return he.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Md).map(l=>(this.dynamicDecorationMap[e++]=typeof l=="function")?l(this.view):l),i=!1,s=this.view.state.facet(Mb).map((l,a)=>{let c=typeof l=="function";return c&&(i=!0),c?l(this.view):l});for(s.length&&(this.dynamicDecorationMap[e++]=i,t.push(De.join(s))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(sT).map(l=>typeof l=="function"?l(this.view):l)}scrollIntoView(e){if(e.isSnapshot){let d=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=d.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let d of this.view.state.facet(tT))try{if(d(this.view,e.range,e))return!0}catch(p){mn(this.view.state,p,"scroll handler")}let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!i)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,s.left),top:Math.min(i.top,s.top),right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)});let l=Nb(this.view),a={left:i.left-l.left,top:i.top-l.top,right:i.right+l.right,bottom:i.bottom+l.bottom},{offsetWidth:c,offsetHeight:h}=this.view.scrollDOM;BU(this.view.scrollDOM,a,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,c),-c),Math.max(Math.min(e.yMargin,h),-h),this.view.textDirection==Ze.LTR)}lineHasWidget(e){let t=i=>i.isWidget()||i.children.some(t);return t(this.tile.resolveBlock(e,1).tile)}destroy(){ky(this.tile)}}function ky(n,e){let t=e?.get(n);if(t!=1){t==null&&n.destroy();for(let i of n.children)ky(i,e)}}function a4(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function aT(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let i=PC(t.focusNode,t.focusOffset),s=HC(t.focusNode,t.focusOffset),l=i||s;if(s&&i&&s.node!=i.node){let c=kt.get(s.node);if(!c||c.isText()&&c.text!=s.node.nodeValue)l=s;else if(n.docView.lastCompositionAfterCursor){let h=kt.get(i.node);!h||h.isText()&&h.text!=i.node.nodeValue||(l=s)}}if(n.docView.lastCompositionAfterCursor=l!=i,!l)return null;let a=e-l.offset;return{from:a,to:a+l.node.nodeValue.length,node:l.node}}function c4(n,e,t){let i=aT(n,t);if(!i)return null;let{node:s,from:l,to:a}=i,c=s.nodeValue;if(/[\n\r]/.test(c)||n.state.doc.sliceString(i.from,i.to)!=c)return null;let h=e.invertedDesc;return{range:new ti(h.mapPos(l),h.mapPos(a),l,a),text:s}}function u4(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let h4=class{constructor(){this.changes=[]}compareRange(e,t){wo(e,t,this.changes)}comparePoint(e,t){wo(e,t,this.changes)}boundChange(e){wo(e,e,this.changes)}};function f4(n,e,t){let i=new h4;return De.compare(n,e,t,i),i.changes}class d4{constructor(){this.changes=[]}compareRange(e,t){wo(e,t,this.changes)}comparePoint(){}boundChange(e){wo(e,e,this.changes)}}function p4(n,e,t){let i=new d4;return De.compare(n,e,t,i),i.changes}function g4(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function m4(n,e){let t=!1;return e&&n.iterChangedRanges((i,s)=>{i<e.to&&s>e.from&&(t=!0)}),t}class n0 extends Wi{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function y4(n,e,t=1){let i=n.charCategorizer(e),s=n.doc.lineAt(e),l=e-s.from;if(s.length==0)return G.cursor(e);l==0?t=1:l==s.length&&(t=-1);let a=l,c=l;t<0?a=Ct(s.text,l,!1):c=Ct(s.text,l);let h=i(s.text.slice(a,c));for(;a>0;){let d=Ct(s.text,a,!1);if(i(s.text.slice(d,a))!=h)break;a=d}for(;c<s.length;){let d=Ct(s.text,c);if(i(s.text.slice(c,d))!=h)break;c=d}return G.range(a+s.from,c+s.from)}function b4(n,e,t,i,s){let l=Math.round((i-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let c=n.viewState.heightOracle.textHeight,h=Math.floor((s-t.top-(n.defaultLineHeight-c)*.5)/c);l+=h*n.viewState.heightOracle.lineLength}let a=n.state.sliceDoc(t.from,t.to);return t.from+uy(a,l,n.state.tabSize)}function xy(n,e,t){let i=n.lineBlockAt(e);if(Array.isArray(i.type)){let s;for(let l of i.type){if(l.from>e)break;if(!(l.to<e)){if(l.from<e&&l.to>e)return l;(!s||l.type==Gt.Text&&(s.type!=l.type||(t<0?l.from<e:l.to>e)))&&(s=l)}}return s||i}return i}function v4(n,e,t,i){let s=xy(n,e.head,e.assoc||-1),l=!i||s.type!=Gt.Text||!(n.lineWrapping||s.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(l){let a=n.dom.getBoundingClientRect(),c=n.textDirectionAt(s.from),h=n.posAtCoords({x:t==(c==Ze.LTR)?a.right-1:a.left+1,y:(l.top+l.bottom)/2});if(h!=null)return G.cursor(h,t?-1:1)}return G.cursor(t?s.to:s.from,t?-1:1)}function Qx(n,e,t,i){let s=n.state.doc.lineAt(e.head),l=n.bidiSpans(s),a=n.textDirectionAt(s.from);for(let c=e,h=null;;){let d=WU(s,l,a,c,t),p=KC;if(!d){if(s.number==(t?n.state.doc.lines:1))return c;p=`
`,s=n.state.doc.line(s.number+(t?1:-1)),l=n.bidiSpans(s),d=n.visualLineSide(s,!t)}if(h){if(!h(p))return c}else{if(!i)return d;h=i(p)}c=d}}function w4(n,e,t){let i=n.state.charCategorizer(e),s=i(t);return l=>{let a=i(l);return s==rt.Space&&(s=a),s==a}}function S4(n,e,t,i){let s=e.head,l=t?1:-1;if(s==(t?n.state.doc.length:0))return G.cursor(s,e.assoc);let a=e.goalColumn,c,h=n.contentDOM.getBoundingClientRect(),d=n.coordsAtPos(s,e.assoc||-1),p=n.documentTop;if(d)a==null&&(a=d.left-h.left),c=l<0?d.top:d.bottom;else{let w=n.viewState.lineBlockAt(s);a==null&&(a=Math.min(h.right-h.left,n.defaultCharacterWidth*(s-w.from))),c=(l<0?w.top:w.bottom)+p}let m=h.left+a,b=i??n.viewState.heightOracle.textHeight>>1,v=_y(n,{x:m,y:c+b*l},!1,l);return G.cursor(v.pos,v.assoc,void 0,a)}function uc(n,e,t){for(;;){let i=0;for(let s of n)s.between(e-1,e+1,(l,a,c)=>{if(e>l&&e<a){let h=i||t||(e-l<a-e?-1:1);e=h<0?l:a,i=h}});if(!i)return e}}function cT(n,e){let t=null;for(let i=0;i<e.ranges.length;i++){let s=e.ranges[i],l=null;if(s.empty){let a=uc(n,s.from,0);a!=s.from&&(l=G.cursor(a,-1))}else{let a=uc(n,s.from,-1),c=uc(n,s.to,1);(a!=s.from||c!=s.to)&&(l=G.range(s.from==s.anchor?a:c,s.from==s.head?a:c))}l&&(t||(t=e.ranges.slice()),t[i]=l)}return t?G.create(t,e.mainIndex):e}function i0(n,e,t){let i=uc(n.state.facet(su).map(s=>s(n)),t.from,e.head>t.from?-1:1);return i==t.from?t:G.cursor(i,i<t.from?1:-1)}class Bi{constructor(e,t){this.pos=e,this.assoc=t}}function _y(n,e,t,i){let s=n.contentDOM.getBoundingClientRect(),l=s.top+n.viewState.paddingTop,{x:a,y:c}=e,h=c-l,d;for(;;){if(h<0)return new Bi(0,1);if(h>n.viewState.docHeight)return new Bi(n.state.doc.length,-1);if(d=n.elementAtHeight(h),i==null)break;if(d.type==Gt.Text){if(i<0?d.to<n.viewport.from:d.from>n.viewport.to)break;let b=n.docView.coordsAt(i<0?d.from:d.to,i);if(b&&(i<0?b.top<=h+l:b.bottom>=h+l))break}let m=n.viewState.heightOracle.textHeight/2;h=i>0?d.bottom+m:d.top-m}if(n.viewport.from>=d.to||n.viewport.to<=d.from){if(t)return null;if(d.type==Gt.Text){let m=b4(n,s,d,a,c);return new Bi(m,m==d.from?1:-1)}}if(d.type!=Gt.Text)return h<(d.top+d.bottom)/2?new Bi(d.from,1):new Bi(d.to,-1);let p=n.docView.lineAt(d.from,2);return(!p||p.length!=d.length)&&(p=n.docView.lineAt(d.from,-2)),uT(n,p,d.from,a,c)}function uT(n,e,t,i,s){let l=-1,a=null,c=1e9,h=1e9,d=s,p=s,m=(b,v)=>{for(let w=0;w<b.length;w++){let k=b[w];if(k.top==k.bottom)continue;let _=k.left>i?k.left-i:k.right<i?i-k.right:0,O=k.top>s?k.top-s:k.bottom<s?s-k.bottom:0;k.top<=p&&k.bottom>=d&&(d=Math.min(k.top,d),p=Math.max(k.bottom,p),O=0),(l<0||(O-h||_-c)<0)&&(l>=0&&h&&c<_&&a.top<=p-2&&a.bottom>=d+2?h=0:(l=v,c=_,h=O,a=k))}};if(e.isText()){for(let v=0;v<e.length;){let w=Ct(e.text,v);if(m(Uc(e.dom,v,w).getClientRects(),v),!c&&!h)break;v=w}return i>(a.left+a.right)/2==(Jx(n,l+t)==Ze.LTR)?new Bi(t+Ct(e.text,l),-1):new Bi(t+l,1)}else{if(!e.length)return new Bi(t,1);for(let k=0;k<e.children.length;k++){let _=e.children[k];if(_.flags&48)continue;let O=(_.dom.nodeType==1?_.dom:Uc(_.dom,0,_.length)).getClientRects();if(m(O,k),!c&&!h)break}let b=e.children[l],v=e.posBefore(b,t);return b.isComposite()||b.isText()?uT(n,b,v,Math.max(a.left,Math.min(a.right,i)),s):i>(a.left+a.right)/2==(Jx(n,l+t)==Ze.LTR)?new Bi(v+b.length,-1):new Bi(v,1)}}function Jx(n,e){let t=n.state.doc.lineAt(e);return n.bidiSpans(t)[gs.find(n.bidiSpans(t),e-t.from,-1,1)].dir}const ec="";class k4{constructor(e,t){this.points=e,this.view=t,this.text="",this.lineSeparator=t.state.facet(Ue.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=ec}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let s=e;;){this.findPointBefore(i,s);let l=this.text.length;this.readNode(s);let a=kt.get(s),c=s.nextSibling;if(c==t){a?.breakAfter&&!c&&i!=this.view.contentDOM&&this.lineBreak();break}let h=kt.get(c);(a&&h?a.breakAfter:(a?a.breakAfter:qf(s))||qf(c)&&(s.nodeName!="BR"||a?.isWidget())&&this.text.length>l)&&!_4(c,t)&&this.lineBreak(),s=c}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let l=-1,a=1,c;if(this.lineSeparator?(l=t.indexOf(this.lineSeparator,i),a=this.lineSeparator.length):(c=s.exec(t))&&(l=c.index,a=c[0].length),this.append(t.slice(i,l<0?t.length:l)),l<0)break;if(this.lineBreak(),a>1)for(let h of this.points)h.node==e&&h.pos>this.text.length&&(h.pos-=a-1);i=l+a}}readNode(e){let t=kt.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let s=i.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(x4(e,i.node,i.offset)?t:0))}}function x4(n,e,t){for(;;){if(!e||t<bs(e))return!1;if(e==n)return!0;t=ar(e)+1,e=e.parentNode}}function _4(n,e){let t;for(;!(n==e||!n);n=n.nextSibling){let i=kt.get(n);if(!i?.isWidget())return!1;i&&(t||(t=[])).push(i)}if(t)for(let i of t){let s=i.overrideDOMText;if(s?.length)return!1}return!0}class Zx{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class O4{constructor(e,t,i,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:l,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=hT(e.docView.tile,t,i,0))){let c=l||a?[]:C4(e),h=new k4(c,e);h.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=h.text,this.newSel=T4(c,this.bounds.from)}else{let c=e.observer.selectionRange,h=l&&l.node==c.focusNode&&l.offset==c.focusOffset||!yy(e.contentDOM,c.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(c.focusNode,c.focusOffset),d=a&&a.node==c.anchorNode&&a.offset==c.anchorOffset||!yy(e.contentDOM,c.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(c.anchorNode,c.anchorOffset),p=e.viewport;if((se.ios||se.chrome)&&e.state.selection.main.empty&&h!=d&&(p.from>0||p.to<e.state.doc.length)){let m=Math.min(h,d),b=Math.max(h,d),v=p.from-m,w=p.to-b;(v==0||v==1||m==0)&&(w==0||w==-1||b==e.state.doc.length)&&(h=0,d=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(G.range(d,h)):this.newSel=G.single(d,h)}}}function hT(n,e,t,i){if(n.isComposite()){let s=-1,l=-1,a=-1,c=-1;for(let h=0,d=i,p=i;h<n.children.length;h++){let m=n.children[h],b=d+m.length;if(d<e&&b>t)return hT(m,e,t,d);if(b>=e&&s==-1&&(s=h,l=d),d>t&&m.dom.parentNode==n.dom){a=h,c=p;break}p=b,d=b+m.breakAfter}return{from:l,to:c<0?i+n.length:c,startDOM:(s?n.children[s-1].dom.nextSibling:null)||n.dom.firstChild,endDOM:a<n.children.length&&a>=0?n.children[a].dom:null}}else return n.isText()?{from:i,to:i+n.length,startDOM:n.dom,endDOM:n.dom.nextSibling}:null}function fT(n,e){let t,{newSel:i}=e,s=n.state.selection.main,l=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:c}=e.bounds,h=s.from,d=null;(l===8||se.android&&e.text.length<c-a)&&(h=s.to,d="end");let p=dT(n.state.doc.sliceString(a,c,ec),e.text,h-a,d);p&&(se.chrome&&l==13&&p.toB==p.from+2&&e.text.slice(p.from,p.toB)==ec+ec&&p.toB--,t={from:a+p.from,to:a+p.toA,insert:He.of(e.text.slice(p.from,p.toB).split(ec))})}else i&&(!n.hasFocus&&n.state.facet(ps)||Wf(i,s))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!s.empty&&i&&i.main.empty?t={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,s.to)}:(se.mac||se.android)&&t&&t.from==t.to&&t.from==s.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=G.single(i.main.anchor-1,i.main.head-1)),t={from:t.from,to:t.to,insert:He.of([t.insert.toString().replace("."," ")])}):t&&t.from>=s.from&&t.to<=s.to&&(t.from!=s.from||t.to!=s.to)&&s.to-s.from-(t.to-t.from)<=4?t={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,s.to))}:n.state.doc.lineAt(s.from).to<s.to&&n.docView.lineHasWidget(s.to)&&n.inputState.insertingTextAt>Date.now()-50?t={from:s.from,to:s.to,insert:n.state.toText(n.inputState.insertingText)}:se.chrome&&t&&t.from==t.to&&t.from==s.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(i&&(i=G.single(i.main.anchor-1,i.main.head-1)),t={from:s.from,to:s.to,insert:He.of([" "])}),t)return Lb(n,t,i,l);if(i&&!Wf(i,s)){let a=!1,c="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(a=!0),c=n.inputState.lastSelectionOrigin,c=="select.pointer"&&(i=cT(n.state.facet(su).map(h=>h(n)),i))),n.dispatch({selection:i,scrollIntoView:a,userEvent:c}),!0}else return!1}function Lb(n,e,t,i=-1){if(se.ios&&n.inputState.flushIOSKey(e))return!0;let s=n.state.selection.main;if(se.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&n.state.sliceDoc(e.from,s.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&So(n.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>s.head)&&So(n.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&e.insert.length==0&&So(n.contentDOM,"Delete",46)))return!0;let l=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let a,c=()=>a||(a=A4(n,e,t));return n.state.facet(QC).some(h=>h(n,e.from,e.to,l,c))||n.dispatch(c()),!0}function A4(n,e,t){let i,s=n.state,l=s.selection.main,a=-1;if(e.from==e.to&&e.from<l.from||e.from>l.to){let h=e.from<l.from?-1:1,d=h<0?l.from:l.to,p=uc(s.facet(su).map(m=>m(n)),d,h);e.from==p&&(a=p)}if(a>-1)i={changes:e,selection:G.cursor(e.from+e.insert.length,-1)};else if(e.from>=l.from&&e.to<=l.to&&e.to-e.from>=(l.to-l.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let h=l.from<e.from?s.sliceDoc(l.from,e.from):"",d=l.to>e.to?s.sliceDoc(e.to,l.to):"";i=s.replaceSelection(n.state.toText(h+e.insert.sliceString(0,void 0,n.state.lineBreak)+d))}else{let h=s.changes(e),d=t&&t.main.to<=h.newLength?t.main:void 0;if(s.selection.ranges.length>1&&(n.inputState.composing>=0||n.inputState.compositionPendingChange)&&e.to<=l.to+10&&e.to>=l.to-10){let p=n.state.sliceDoc(e.from,e.to),m,b=t&&aT(n,t.main.head);if(b){let w=e.insert.length-(e.to-e.from);m={from:b.from,to:b.to-w}}else m=n.state.doc.lineAt(l.head);let v=l.to-e.to;i=s.changeByRange(w=>{if(w.from==l.from&&w.to==l.to)return{changes:h,range:d||w.map(h)};let k=w.to-v,_=k-p.length;if(n.state.sliceDoc(_,k)!=p||k>=m.from&&_<=m.to)return{range:w};let O=s.changes({from:_,to:k,insert:e.insert}),R=w.to-l.to;return{changes:O,range:d?G.range(Math.max(0,d.anchor+R),Math.max(0,d.head+R)):w.map(O)}})}else i={changes:h,selection:d&&s.selection.replaceRange(d)}}let c="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,c+=".compose",n.inputState.compositionFirstChange&&(c+=".start",n.inputState.compositionFirstChange=!1)),s.update(i,{userEvent:c,scrollIntoView:!0})}function dT(n,e,t,i){let s=Math.min(n.length,e.length),l=0;for(;l<s&&n.charCodeAt(l)==e.charCodeAt(l);)l++;if(l==s&&n.length==e.length)return null;let a=n.length,c=e.length;for(;a>0&&c>0&&n.charCodeAt(a-1)==e.charCodeAt(c-1);)a--,c--;if(i=="end"){let h=Math.max(0,l-Math.min(a,c));t-=a+h-l}if(a<l&&n.length<e.length){let h=t<=l&&t>=a?l-t:0;l-=h,c=l+(c-a),a=l}else if(c<l){let h=t<=l&&t>=c?l-t:0;l-=h,a=l+(a-c),c=l}return{from:l,toA:a,toB:c}}function C4(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:l}=n.observer.selectionRange;return t&&(e.push(new Zx(t,i)),(s!=t||l!=i)&&e.push(new Zx(s,l))),e}function T4(n,e){if(n.length==0)return null;let t=n[0].pos,i=n.length==2?n[1].pos:t;return t>-1&&i>-1?G.single(t+e,i+e):null}function Wf(n,e){return e.head==n.main.head&&e.anchor==n.main.anchor}class E4{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,se.safari&&e.contentDOM.addEventListener("input",()=>null),se.gecko&&$4(e.contentDOM.ownerDocument)}handleEvent(e){!U4(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let i=this.handlers[e];if(i){for(let s of i.observers)s(this.view,t);for(let s of i.handlers){if(t.defaultPrevented)break;if(s(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=D4(e),i=this.handlers,s=this.view.contentDOM;for(let l in t)if(l!="scroll"){let a=!t[l].handlers.length,c=i[l];c&&a!=!c.handlers.length&&(s.removeEventListener(l,this.handleEvent),c=null),c||s.addEventListener(l,this.handleEvent,{passive:a})}for(let l in i)l!="scroll"&&!t[l]&&s.removeEventListener(l,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&gT.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),se.android&&se.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return se.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=pT.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||R4.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,So(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:se.safari&&!se.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function e_(n,e){return(t,i)=>{try{return e.call(n,i,t)}catch(s){mn(t.state,s)}}}function D4(n){let e=Object.create(null);function t(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of n){let s=i.spec,l=s&&s.plugin.domEventHandlers,a=s&&s.plugin.domEventObservers;if(l)for(let c in l){let h=l[c];h&&t(c).handlers.push(e_(i.value,h))}if(a)for(let c in a){let h=a[c];h&&t(c).observers.push(e_(i.value,h))}}for(let i in wi)t(i).handlers.push(wi[i]);for(let i in ri)t(i).observers.push(ri[i]);return e}const pT=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],R4="dthko",gT=[16,17,18,20,91,92,224,225],Vh=6;function $h(n){return Math.max(0,n)*.7+8}function M4(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class N4{constructor(e,t,i,s){this.view=e,this.startEvent=t,this.style=i,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=jU(e.contentDOM),this.atoms=e.state.facet(su).map(a=>a(e));let l=e.contentDOM.ownerDocument;l.addEventListener("mousemove",this.move=this.move.bind(this)),l.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Ue.allowMultipleSelections)&&L4(e,t),this.dragging=j4(e,t)&&bT(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&M4(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,i=0,s=0,l=0,a=this.view.win.innerWidth,c=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:l,bottom:c}=this.scrollParents.y.getBoundingClientRect());let h=Nb(this.view);e.clientX-h.left<=s+Vh?t=-$h(s-e.clientX):e.clientX+h.right>=a-Vh&&(t=$h(e.clientX-a)),e.clientY-h.top<=l+Vh?i=-$h(l-e.clientY):e.clientY+h.bottom>=c-Vh&&(i=$h(e.clientY-c)),this.setScrollSpeed(t,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,i=cT(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function L4(n,e){let t=n.state.facet(WC);return t.length?t[0](e):se.mac?e.metaKey:e.ctrlKey}function B4(n,e){let t=n.state.facet(FC);return t.length?t[0](e):se.mac?!e.altKey:!e.ctrlKey}function j4(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let i=Bo(n.root);if(!i||i.rangeCount==0)return!0;let s=i.getRangeAt(0).getClientRects();for(let l=0;l<s.length;l++){let a=s[l];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function U4(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=kt.get(t))&&i.isWidget()&&!i.isHidden&&i.widget.ignoreEvent(e))return!1;return!0}const wi=Object.create(null),ri=Object.create(null),mT=se.ie&&se.ie_version<15||se.ios&&se.webkit_version<604;function z4(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),yT(n,t.value)},50)}function Bd(n,e,t){for(let i of n.facet(e))t=i(t,n);return t}function yT(n,e){e=Bd(n.state,Eb,e);let{state:t}=n,i,s=1,l=t.toText(e),a=l.lines==t.selection.ranges.length;if(Oy!=null&&t.selection.ranges.every(h=>h.empty)&&Oy==l.toString()){let h=-1;i=t.changeByRange(d=>{let p=t.doc.lineAt(d.from);if(p.from==h)return{range:d};h=p.from;let m=t.toText((a?l.line(s++).text:e)+t.lineBreak);return{changes:{from:p.from,insert:m},range:G.cursor(d.from+m.length)}})}else a?i=t.changeByRange(h=>{let d=l.line(s++);return{changes:{from:h.from,to:h.to,insert:d.text},range:G.cursor(h.from+d.length)}}):i=t.replaceSelection(l);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}ri.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};wi.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);ri.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};ri.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};wi.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let i of n.state.facet(YC))if(t=i(n,e),t)break;if(!t&&e.button==0&&(t=P4(n,e)),t){let i=!n.hasFocus;n.inputState.startMouseSelection(new N4(n,e,t,i)),i&&n.observer.ignore(()=>{zC(n.contentDOM);let l=n.root.activeElement;l&&!l.contains(n.contentDOM)&&l.blur()});let s=n.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}else n.inputState.setSelectionOrigin("select.pointer");return!1};function t_(n,e,t,i){if(i==1)return G.cursor(e,t);if(i==2)return y4(n.state,e,t);{let s=n.docView.lineAt(e,t),l=n.state.doc.lineAt(s?s.posAtEnd:e),a=s?s.posAtStart:l.from,c=s?s.posAtEnd:l.to;return c<n.state.doc.length&&c==l.to&&c++,G.range(a,c)}}const I4=se.ie&&se.ie_version<=11;let n_=null,i_=0,s_=0;function bT(n){if(!I4)return n.detail;let e=n_,t=s_;return n_=n,s_=Date.now(),i_=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(i_+1)%3:1}function P4(n,e){let t=n.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),i=bT(e),s=n.state.selection;return{update(l){l.docChanged&&(t.pos=l.changes.mapPos(t.pos),s=s.map(l.changes))},get(l,a,c){let h=n.posAndSideAtCoords({x:l.clientX,y:l.clientY},!1),d,p=t_(n,h.pos,h.assoc,i);if(t.pos!=h.pos&&!a){let m=t_(n,t.pos,t.assoc,i),b=Math.min(m.from,p.from),v=Math.max(m.to,p.to);p=b<p.from?G.range(b,v):G.range(v,b)}return a?s.replaceRange(s.main.extend(p.from,p.to)):c&&i==1&&s.ranges.length>1&&(d=H4(s,h.pos))?d:c?s.addRange(p):G.create([p])}}}function H4(n,e){for(let t=0;t<n.ranges.length;t++){let{from:i,to:s}=n.ranges[t];if(i<=e&&s>=e)return G.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}wi.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let s=n.docView.tile.nearest(e.target);if(s&&s.isWidget()){let l=s.posAtStart,a=l+s.length;(l>=t.to||a<=t.from)&&(t=G.range(l,a))}}let{inputState:i}=n;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Bd(n.state,Db,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};wi.dragend=n=>(n.inputState.draggedContent=null,!1);function r_(n,e,t,i){if(t=Bd(n.state,Eb,t),!t)return;let s=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:l}=n.inputState,a=i&&l&&B4(n,e)?{from:l.from,to:l.to}:null,c={from:s,insert:t},h=n.state.changes(a?[a,c]:c);n.focus(),n.dispatch({changes:h,selection:{anchor:h.mapPos(s,-1),head:h.mapPos(s,1)},userEvent:a?"move.drop":"input.drop"}),n.inputState.draggedContent=null}wi.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let i=Array(t.length),s=0,l=()=>{++s==t.length&&r_(n,e,i.filter(a=>a!=null).join(n.state.lineBreak),!1)};for(let a=0;a<t.length;a++){let c=new FileReader;c.onerror=l,c.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(c.result)||(i[a]=c.result),l()},c.readAsText(t[a])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return r_(n,e,i,!0),!0}return!1};wi.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=mT?null:e.clipboardData;return t?(yT(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(z4(n),!1)};function q4(n,e){let t=n.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function V4(n){let e=[],t=[],i=!1;for(let s of n.selection.ranges)s.empty||(e.push(n.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:l}of n.selection.ranges){let a=n.doc.lineAt(l);a.number>s&&(e.push(a.text),t.push({from:a.from,to:Math.min(n.doc.length,a.to+1)})),s=a.number}i=!0}return{text:Bd(n,Db,e.join(n.lineBreak)),ranges:t,linewise:i}}let Oy=null;wi.copy=wi.cut=(n,e)=>{let t=Bo(n.root);if(t&&!ac(n.contentDOM,t))return!1;let{text:i,ranges:s,linewise:l}=V4(n.state);if(!i&&!l)return!1;Oy=l?i:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"});let a=mT?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",i),!0):(q4(n,i),!1)};const vT=Si.define();function wT(n,e){let t=[];for(let i of n.facet(JC)){let s=i(n,e);s&&t.push(s)}return t.length?n.update({effects:t,annotations:vT.of(!0)}):null}function ST(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=wT(n.state,e);t?n.dispatch(t):n.update([])}},10)}ri.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),ST(n)};ri.blur=n=>{n.observer.clearSelectionRange(),ST(n)};ri.compositionstart=ri.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};ri.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,se.chrome&&se.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};ri.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};wi.beforeinput=(n,e)=>{var t,i;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(n.inputState.insertingText=e.data,n.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&n.observer.editContext){let l=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),a=e.getTargetRanges();if(l&&a.length){let c=a[0],h=n.posAtDOM(c.startContainer,c.startOffset),d=n.posAtDOM(c.endContainer,c.endOffset);return Lb(n,{from:h,to:d,insert:n.state.toText(l)},null),!0}}let s;if(se.chrome&&se.android&&(s=pT.find(l=>l.inputType==e.inputType))&&(n.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let l=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>l+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return se.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),se.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>ri.compositionend(n,e),20),!1};const l_=new Set;function $4(n){l_.has(n)||(l_.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const o_=["pre-wrap","normal","pre-line","break-spaces"];let zo=!1;function a_(){zo=!1}class G4{constructor(e){this.lineWrapping=e,this.doc=He.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return o_.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let s=e[i];s<0?i++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,i,s,l,a){let c=o_.indexOf(e)>-1,h=Math.abs(t-this.lineHeight)>.3||this.lineWrapping!=c||Math.abs(i-this.charWidth)>.1;if(this.lineWrapping=c,this.lineHeight=t,this.charWidth=i,this.textHeight=s,this.lineLength=l,h){this.heightSamples={};for(let d=0;d<a.length;d++){let p=a[d];p<0?d++:this.heightSamples[Math.floor(p*10)]=!0}}return h}}class K4{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class pi{constructor(e,t,i,s,l){this.from=e,this.length=t,this.top=i,this.height=s,this._content=l}get type(){return typeof this._content=="number"?Gt.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof el?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new pi(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var tt=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})(tt||(tt={}));const yf=.001;class nn{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>yf&&(zo=!0),this.height=e)}replace(e,t,i){return nn.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,s){let l=this,a=i.doc;for(let c=s.length-1;c>=0;c--){let{fromA:h,toA:d,fromB:p,toB:m}=s[c],b=l.lineAt(h,tt.ByPosNoHeight,i.setDoc(t),0,0),v=b.to>=d?b:l.lineAt(d,tt.ByPosNoHeight,i,0,0);for(m+=v.to-d,d=v.to;c>0&&b.from<=s[c-1].toA;)h=s[c-1].fromA,p=s[c-1].fromB,c--,h<b.from&&(b=l.lineAt(h,tt.ByPosNoHeight,i,0,0));p+=b.from-h,h=b.from;let w=Bb.build(i.setDoc(a),e,p,m);l=Ff(l,l.replace(h,d,w))}return l.updateHeight(i,0)}static empty(){return new Un(0,0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,s=0,l=0;for(;;)if(t==i)if(s>l*2){let c=e[t-1];c.break?e.splice(--t,1,c.left,null,c.right):e.splice(--t,1,c.left,c.right),i+=1+c.break,s-=c.size}else if(l>s*2){let c=e[i];c.break?e.splice(i,1,c.left,null,c.right):e.splice(i,1,c.left,c.right),i+=2+c.break,l-=c.size}else break;else if(s<l){let c=e[t++];c&&(s+=c.size)}else{let c=e[--i];c&&(l+=c.size)}let a=0;return e[t-1]==null?(a=1,t--):e[t]==null&&(a=1,i++),new F4(nn.of(e.slice(0,t)),a,nn.of(e.slice(i)))}}function Ff(n,e){return n==e?n:(n.constructor!=e.constructor&&(zo=!0),e)}nn.prototype.size=1;const W4=he.replace({});class kT extends nn{constructor(e,t,i){super(e,t),this.deco=i,this.spaceAbove=0}mainBlock(e,t){return new pi(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,t,i,s){return this.spaceAbove&&e<i+this.spaceAbove?new pi(s,0,i,this.spaceAbove,W4):this.mainBlock(i,s)}lineAt(e,t,i,s,l){let a=this.mainBlock(s,l);return this.spaceAbove?this.blockAt(0,i,s,l).join(a):a}forEachLine(e,t,i,s,l,a){e<=l+this.length&&t>=l&&a(this.lineAt(0,tt.ByPos,i,s,l))}setMeasuredHeight(e){let t=e.heights[e.index++];t<0?(this.spaceAbove=-t,t=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(t)}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more&&this.setMeasuredHeight(s),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Un extends kT{constructor(e,t,i){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=i}mainBlock(e,t){return new pi(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,t,i){let s=i[0];return i.length==1&&(s instanceof Un||s instanceof Vt&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Vt?s=new Un(s.length,this.height,this.spaceAbove):s.height=this.height,this.outdated||(s.outdated=!1),s):nn.of(i)}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more?this.setMeasuredHeight(s):(i||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Vt extends nn{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,s=e.doc.lineAt(t+this.length).number,l=s-i+1,a,c=0;if(e.lineWrapping){let h=Math.min(this.height,e.lineHeight*l);a=h/l,this.length>l+1&&(c=(this.height-h)/(this.length-l-1))}else a=this.height/l;return{firstLine:i,lastLine:s,perLine:a,perChar:c}}blockAt(e,t,i,s){let{firstLine:l,lastLine:a,perLine:c,perChar:h}=this.heightMetrics(t,s);if(t.lineWrapping){let d=s+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),p=t.doc.lineAt(d),m=c+p.length*h,b=Math.max(i,e-m/2);return new pi(p.from,p.length,b,m,0)}else{let d=Math.max(0,Math.min(a-l,Math.floor((e-i)/c))),{from:p,length:m}=t.doc.line(l+d);return new pi(p,m,i+c*d,c,0)}}lineAt(e,t,i,s,l){if(t==tt.ByHeight)return this.blockAt(e,i,s,l);if(t==tt.ByPosNoHeight){let{from:v,to:w}=i.doc.lineAt(e);return new pi(v,w-v,0,0,0)}let{firstLine:a,perLine:c,perChar:h}=this.heightMetrics(i,l),d=i.doc.lineAt(e),p=c+d.length*h,m=d.number-a,b=s+c*m+h*(d.from-l-m);return new pi(d.from,d.length,Math.max(s,Math.min(b,s+this.height-p)),p,0)}forEachLine(e,t,i,s,l,a){e=Math.max(e,l),t=Math.min(t,l+this.length);let{firstLine:c,perLine:h,perChar:d}=this.heightMetrics(i,l);for(let p=e,m=s;p<=t;){let b=i.doc.lineAt(p);if(p==e){let w=b.number-c;m+=h*w+d*(e-l-w)}let v=h+d*b.length;a(new pi(b.from,b.length,m,v,0)),m+=v,p=b.to+1}}replace(e,t,i){let s=this.length-t;if(s>0){let l=i[i.length-1];l instanceof Vt?i[i.length-1]=new Vt(l.length+s):i.push(null,new Vt(s-1))}if(e>0){let l=i[0];l instanceof Vt?i[0]=new Vt(e+l.length):i.unshift(new Vt(e-1),null)}return nn.of(i)}decomposeLeft(e,t){t.push(new Vt(e-1),null)}decomposeRight(e,t){t.push(null,new Vt(this.length-e-1))}updateHeight(e,t=0,i=!1,s){let l=t+this.length;if(s&&s.from<=t+this.length&&s.more){let a=[],c=Math.max(t,s.from),h=-1;for(s.from>t&&a.push(new Vt(s.from-t-1).updateHeight(e,t));c<=l&&s.more;){let p=e.doc.lineAt(c).length;a.length&&a.push(null);let m=s.heights[s.index++],b=0;m<0&&(b=-m,m=s.heights[s.index++]),h==-1?h=m:Math.abs(m-h)>=yf&&(h=-2);let v=new Un(p,m,b);v.outdated=!1,a.push(v),c+=p+1}c<=l&&a.push(null,new Vt(l-c).updateHeight(e,c));let d=nn.of(a);return(h<0||Math.abs(d.height-this.height)>=yf||Math.abs(h-this.heightMetrics(e,t).perLine)>=yf)&&(zo=!0),Ff(this,d)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class F4 extends nn{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,s){let l=i+this.left.height;return e<l?this.left.blockAt(e,t,i,s):this.right.blockAt(e,t,l,s+this.left.length+this.break)}lineAt(e,t,i,s,l){let a=s+this.left.height,c=l+this.left.length+this.break,h=t==tt.ByHeight?e<a:e<c,d=h?this.left.lineAt(e,t,i,s,l):this.right.lineAt(e,t,i,a,c);if(this.break||(h?d.to<c:d.from>c))return d;let p=t==tt.ByPosNoHeight?tt.ByPosNoHeight:tt.ByPos;return h?d.join(this.right.lineAt(c,p,i,a,c)):this.left.lineAt(c,p,i,s,l).join(d)}forEachLine(e,t,i,s,l,a){let c=s+this.left.height,h=l+this.left.length+this.break;if(this.break)e<h&&this.left.forEachLine(e,t,i,s,l,a),t>=h&&this.right.forEachLine(e,t,i,c,h,a);else{let d=this.lineAt(h,tt.ByPos,i,s,l);e<d.from&&this.left.forEachLine(e,d.from-1,i,s,l,a),d.to>=e&&d.from<=t&&a(d),t>d.to&&this.right.forEachLine(d.to+1,t,i,c,h,a)}}replace(e,t,i){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,i));let l=[];e>0&&this.decomposeLeft(e,l);let a=l.length;for(let c of i)l.push(c);if(e>0&&c_(l,a-1),t<this.length){let c=l.length;this.decomposeRight(t,l),c_(l,c)}return nn.of(l)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,s=i+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?nn.of(this.break?[e,null,t]:[e,t]):(this.left=Ff(this.left,e),this.right=Ff(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,s){let{left:l,right:a}=this,c=t+l.length+this.break,h=null;return s&&s.from<=t+l.length&&s.more?h=l=l.updateHeight(e,t,i,s):l.updateHeight(e,t,i),s&&s.from<=c+a.length&&s.more?h=a=a.updateHeight(e,c,i,s):a.updateHeight(e,c,i),h?this.balanced(l,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function c_(n,e){let t,i;n[e]==null&&(t=n[e-1])instanceof Vt&&(i=n[e+1])instanceof Vt&&n.splice(e-1,3,new Vt(t.length+1+i.length))}const Y4=5;class Bb{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Un?s.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Un(i-this.pos,-1,0)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let s=i.widget?i.widget.estimatedHeight:0,l=i.widget?i.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let a=t-e;i.block?this.addBlock(new kT(a,s,i)):(a||l||s>=Y4)&&this.addLineDeco(s,l,a)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Un(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,t){let i=new Vt(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Un)return e;let t=new Un(0,-1,0);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,i){let s=this.ensureLine();s.length+=i,s.collapsed+=i,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=t,this.writtenTo=this.pos=this.pos+i}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Un)&&!this.isCovered?this.nodes.push(new Un(0,-1,0)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let s of this.nodes)s instanceof Un&&s.updateHeight(this.oracle,i),i+=s?s.length:1;return this.nodes}static build(e,t,i,s){let l=new Bb(i,e);return De.spans(t,i,s,l,0),l.finish(i)}}function X4(n,e,t){let i=new Q4;return De.compare(n,e,t,i,0),i.changes}class Q4{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,s){(e<t||i&&i.heightRelevant||s&&s.heightRelevant)&&wo(e,t,this.changes,5)}}function J4(n,e){let t=n.getBoundingClientRect(),i=n.ownerDocument,s=i.defaultView||window,l=Math.max(0,t.left),a=Math.min(s.innerWidth,t.right),c=Math.max(0,t.top),h=Math.min(s.innerHeight,t.bottom);for(let d=n.parentNode;d&&d!=i.body;)if(d.nodeType==1){let p=d,m=window.getComputedStyle(p);if((p.scrollHeight>p.clientHeight||p.scrollWidth>p.clientWidth)&&m.overflow!="visible"){let b=p.getBoundingClientRect();l=Math.max(l,b.left),a=Math.min(a,b.right),c=Math.max(c,b.top),h=Math.min(d==n.parentNode?s.innerHeight:h,b.bottom)}d=m.position=="absolute"||m.position=="fixed"?p.offsetParent:p.parentNode}else if(d.nodeType==11)d=d.host;else break;return{left:l-t.left,right:Math.max(l,a)-t.left,top:c-(t.top+e),bottom:Math.max(c,h)-(t.top+e)}}function Z4(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function e8(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class s0{constructor(e,t,i,s){this.from=e,this.to=t,this.size=i,this.displaySize=s}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let s=e[i],l=t[i];if(s.from!=l.from||s.to!=l.to||s.size!=l.size)return!1}return!0}draw(e,t){return he.replace({widget:new t8(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class t8 extends Wi{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class u_{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=h_,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Ze.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(Rb).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new G4(t),this.stateDeco=f_(e),this.heightMap=nn.empty().applyChanges(this.stateDeco,He.empty,this.heightOracle.setDoc(e.doc),[new ti(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=he.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let s=i?t.head:t.anchor;if(!e.some(({from:l,to:a})=>s>=l&&s<=a)){let{from:l,to:a}=this.lineBlockAt(s);e.push(new Gh(l,a))}}return this.viewports=e.sort((i,s)=>i.from-s.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?h_:new jb(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(tc(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=f_(this.state);let s=e.changedRanges,l=ti.extendWithRanges(s,X4(i,this.stateDeco,e?e.changes:At.empty(this.state.doc.length))),a=this.heightMap.height,c=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);a_(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),l),(this.heightMap.height!=a||zo)&&(e.flags|=2),c?(this.scrollAnchorPos=e.changes.mapPos(c.from,-1),this.scrollAnchorHeight=c.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=a);let h=l.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<h.from||t.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,t));let d=h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,e.flags|=this.updateForViewport(),(d||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(eT)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),s=this.heightOracle,l=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?Ze.RTL:Ze.LTR;let a=this.heightOracle.mustRefreshForWrapping(l)||this.mustMeasureContent,c=t.getBoundingClientRect(),h=a||this.mustMeasureContent||this.contentDOMHeight!=c.height;this.contentDOMHeight=c.height,this.mustMeasureContent=!1;let d=0,p=0;if(c.width&&c.height){let{scaleX:U,scaleY:B}=UC(t,c);(U>.005&&Math.abs(this.scaleX-U)>.005||B>.005&&Math.abs(this.scaleY-B)>.005)&&(this.scaleX=U,this.scaleY=B,d|=16,a=h=!0)}let m=(parseInt(i.paddingTop)||0)*this.scaleY,b=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=m||this.paddingBottom!=b)&&(this.paddingTop=m,this.paddingBottom=b,d|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(h=!0),this.editorWidth=e.scrollDOM.clientWidth,d|=16);let v=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=v&&(this.scrollAnchorHeight=-1,this.scrollTop=v),this.scrolledToBottom=IC(e.scrollDOM);let w=(this.printing?e8:J4)(t,this.paddingTop),k=w.top-this.pixelViewport.top,_=w.bottom-this.pixelViewport.bottom;this.pixelViewport=w;let O=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(O!=this.inView&&(this.inView=O,O&&(h=!0)),!this.inView&&!this.scrollTarget&&!Z4(e.dom))return 0;let R=c.width;if((this.contentDOMWidth!=R||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=c.width,this.editorHeight=e.scrollDOM.clientHeight,d|=16),h){let U=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(U)&&(a=!0),a||s.lineWrapping&&Math.abs(R-this.contentDOMWidth)>s.charWidth){let{lineHeight:B,charWidth:z,textHeight:D}=e.docView.measureTextSize();a=B>0&&s.refresh(l,B,z,D,Math.max(5,R/z),U),a&&(e.docView.minWidth=0,d|=16)}k>0&&_>0?p=Math.max(k,_):k<0&&_<0&&(p=Math.min(k,_)),a_();for(let B of this.viewports){let z=B.from==this.viewport.from?U:e.docView.measureVisibleLineHeights(B);this.heightMap=(a?nn.empty().applyChanges(this.stateDeco,He.empty,this.heightOracle,[new ti(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,a,new K4(B.from,z))}zo&&(d|=2)}let C=!this.viewportIsAppropriate(this.viewport,p)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return C&&(d&2&&(d|=this.updateScaler()),this.viewport=this.getViewport(p,this.scrollTarget),d|=this.updateForViewport()),(d&2||C)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),d|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),d}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,l=this.heightOracle,{visibleTop:a,visibleBottom:c}=this,h=new Gh(s.lineAt(a-i*1e3,tt.ByHeight,l,0,0).from,s.lineAt(c+(1-i)*1e3,tt.ByHeight,l,0,0).to);if(t){let{head:d}=t.range;if(d<h.from||d>h.to){let p=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),m=s.lineAt(d,tt.ByPos,l,0,0),b;t.y=="center"?b=(m.top+m.bottom)/2-p/2:t.y=="start"||t.y=="nearest"&&d<h.from?b=m.top:b=m.bottom-p,h=new Gh(s.lineAt(b-1e3/2,tt.ByHeight,l,0,0).from,s.lineAt(b+p+1e3/2,tt.ByHeight,l,0,0).to)}}return h}mapViewport(e,t){let i=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new Gh(this.heightMap.lineAt(i,tt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,tt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,tt.ByPos,this.heightOracle,0,0),{bottom:l}=this.heightMap.lineAt(t,tt.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:c}=this;return(e==0||s<=a-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||l>=c+Math.max(10,Math.min(i,250)))&&s>a-2*1e3&&l<c+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let s of e)t.touchesRange(s.from,s.to)||i.push(new s0(t.mapPos(s.from),t.mapPos(s.to),s.size,s.displaySize));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,s=i?1e4:2e3,l=s>>1,a=s<<1;if(this.defaultTextDirection!=Ze.LTR&&!i)return[];let c=[],h=(p,m,b,v)=>{if(m-p<l)return;let w=this.state.selection.main,k=[w.from];w.empty||k.push(w.to);for(let O of k)if(O>p&&O<m){h(p,O-10,b,v),h(O+10,m,b,v);return}let _=i8(e,O=>O.from>=b.from&&O.to<=b.to&&Math.abs(O.from-p)<l&&Math.abs(O.to-m)<l&&!k.some(R=>O.from<R&&O.to>R));if(!_){if(m<b.to&&t&&i&&t.visibleRanges.some(C=>C.from<=m&&C.to>=m)){let C=t.moveToLineBoundary(G.cursor(m),!1,!0).head;C>p&&(m=C)}let O=this.gapSize(b,p,m,v),R=i||O<2e6?O:2e6;_=new s0(p,m,O,R)}c.push(_)},d=p=>{if(p.length<a||p.type!=Gt.Text)return;let m=n8(p.from,p.to,this.stateDeco);if(m.total<a)return;let b=this.scrollTarget?this.scrollTarget.range.head:null,v,w;if(i){let k=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,_,O;if(b!=null){let R=Wh(m,b),C=((this.visibleBottom-this.visibleTop)/2+k)/p.height;_=R-C,O=R+C}else _=(this.visibleTop-p.top-k)/p.height,O=(this.visibleBottom-p.top+k)/p.height;v=Kh(m,_),w=Kh(m,O)}else{let k=m.total*this.heightOracle.charWidth,_=s*this.heightOracle.charWidth,O=0;if(k>2e6)for(let z of e)z.from>=p.from&&z.from<p.to&&z.size!=z.displaySize&&z.from*this.heightOracle.charWidth+O<this.pixelViewport.left&&(O=z.size-z.displaySize);let R=this.pixelViewport.left+O,C=this.pixelViewport.right+O,U,B;if(b!=null){let z=Wh(m,b),D=((C-R)/2+_)/k;U=z-D,B=z+D}else U=(R-_)/k,B=(C+_)/k;v=Kh(m,U),w=Kh(m,B)}v>p.from&&h(p.from,v,p,m),w<p.to&&h(w,p.to,p,m)};for(let p of this.viewportLines)Array.isArray(p.type)?p.type.forEach(d):d(p);return c}gapSize(e,t,i,s){let l=Wh(s,i)-Wh(s,t);return this.heightOracle.lineWrapping?e.height*l:s.total*this.heightOracle.charWidth*l}updateLineGaps(e){s0.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=he.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let i=[];De.spans(t,this.viewport.from,this.viewport.to,{span(l,a){i.push({from:l,to:a})},point(){}},20);let s=0;if(i.length!=this.visibleRanges.length)s=12;else for(let l=0;l<i.length&&!(s&8);l++){let a=this.visibleRanges[l],c=i[l];(a.from!=c.from||a.to!=c.to)&&(s|=4,e&&e.mapPos(a.from,-1)==c.from&&e.mapPos(a.to,1)==c.to||(s|=8))}return this.visibleRanges=i,s}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||tc(this.heightMap.lineAt(e,tt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||tc(this.heightMap.lineAt(this.scaler.fromDOM(e),tt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return tc(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Gh{constructor(e,t){this.from=e,this.to=t}}function n8(n,e,t){let i=[],s=n,l=0;return De.spans(t,n,e,{span(){},point(a,c){a>s&&(i.push({from:s,to:a}),l+=a-s),s=c}},20),s<e&&(i.push({from:s,to:e}),l+=e-s),{total:l,ranges:i}}function Kh({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(n*t);for(let s=0;;s++){let{from:l,to:a}=e[s],c=a-l;if(i<=c)return l+i;i-=c}}function Wh(n,e){let t=0;for(let{from:i,to:s}of n.ranges){if(e<=s){t+=e-i;break}t+=s-i}return t/n.total}function i8(n,e){for(let t of n)if(e(t))return t}const h_={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};function f_(n){let e=n.facet(Md).filter(i=>typeof i!="function"),t=n.facet(Mb).filter(i=>typeof i!="function");return t.length&&e.push(De.join(t)),e}class jb{constructor(e,t,i){let s=0,l=0,a=0;this.viewports=i.map(({from:c,to:h})=>{let d=t.lineAt(c,tt.ByPos,e,0,0).top,p=t.lineAt(h,tt.ByPos,e,0,0).bottom;return s+=p-d,{from:c,to:h,top:d,bottom:p,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let c of this.viewports)c.domTop=a+(c.top-l)*this.scale,a=c.domBottom=c.domTop+(c.bottom-c.top),l=c.bottom}toDOM(e){for(let t=0,i=0,s=0;;t++){let l=t<this.viewports.length?this.viewports[t]:null;if(!l||e<l.top)return s+(e-i)*this.scale;if(e<=l.bottom)return l.domTop+(e-l.top);i=l.bottom,s=l.domBottom}}fromDOM(e){for(let t=0,i=0,s=0;;t++){let l=t<this.viewports.length?this.viewports[t]:null;if(!l||e<l.domTop)return i+(e-s)/this.scale;if(e<=l.domBottom)return l.top+(e-l.domTop);i=l.bottom,s=l.domBottom}}eq(e){return e instanceof jb?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,i)=>t.from==e.viewports[i].from&&t.to==e.viewports[i].to):!1}}function tc(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),i=e.toDOM(n.bottom);return new pi(n.from,n.length,t,i-t,Array.isArray(n._content)?n._content.map(s=>tc(s,e)):n._content)}const Fh=te.define({combine:n=>n.join(" ")}),Ay=te.define({combine:n=>n.indexOf(!0)>-1}),Cy=lr.newName(),xT=lr.newName(),_T=lr.newName(),OT={"&light":"."+xT,"&dark":"."+_T};function Ty(n,e,t){return new lr(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,s=>{if(s=="&")return n;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):n+" "+i}})}const s8=Ty("."+Cy,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},OT),r8={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},r0=se.ie&&se.ie_version<=11;class l8{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new UU,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(se.ie&&se.ie_version<=11||se.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&se.android&&e.constructor.EDIT_CONTEXT!==!1&&!(se.chrome&&se.chrome_version<126)&&(this.editContext=new a8(e),e.state.facet(ps)&&(e.contentDOM.editContext=this.editContext.editContext)),r0&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,s=this.selectionRange;if(i.state.facet(ps)?i.root.activeElement!=this.dom:!ac(this.dom,s))return;let l=s.anchorNode&&i.docView.tile.nearest(s.anchorNode);if(l&&l.isWidget()&&l.widget.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(se.ie&&se.ie_version<=11||se.android&&se.chrome)&&!i.state.selection.main.empty&&s.focusNode&&cc(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Bo(e.root);if(!t)return!1;let i=se.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&o8(this.view,t)||t;if(!i||this.selectionRange.eq(i))return!1;let s=ac(this.dom,i);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&IU(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,r8),r0&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),r0&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let s=()=>{let l=this.delayedAndroidKey;l&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=l.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&l.force&&So(this.dom,l.key,l.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,i=-1,s=!1;for(let l of e){let a=this.readMutation(l);a&&(a.typeOver&&(s=!0),t==-1?{from:t,to:i}=a:(t=Math.min(a.from,t),i=Math.max(a.to,i)))}return{from:t,to:i,typeOver:s}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),s=this.selectionChanged&&ac(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let l=new O4(this.view,e,t,i);return this.view.docView.domChanged={newSel:l.newSel?l.newSel.main:null},l}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let i=this.view.state,s=fT(this.view,t);return this.view.state==i&&(t.domChanged||t.newSel&&!Wf(this.view.state.selection,t.newSel.main))&&this.view.update([]),s}readMutation(e){let t=this.view.docView.tile.nearest(e.target);if(!t||t.isWidget())return null;if(t.markDirty(e.type=="attributes"),e.type=="childList"){let i=d_(t,e.previousSibling||e.target.previousSibling,-1),s=d_(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(ps)!=e.state.facet(ps)&&(e.view.contentDOM.editContext=e.state.facet(ps)?this.editContext.editContext:null))}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function d_(n,e,t){for(;e;){let i=kt.get(e);if(i&&i.parent==n)return i;let s=e.parentNode;e=s!=n.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function p_(n,e){let t=e.startContainer,i=e.startOffset,s=e.endContainer,l=e.endOffset,a=n.docView.domAtPos(n.state.selection.main.anchor,1);return cc(a.node,a.offset,s,l)&&([t,i,s,l]=[s,l,t,i]),{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:l}}function o8(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return p_(n,s)}let t=null;function i(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",i,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",i,!0),t?p_(n,t):null}class a8{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let s=e.state.selection.main,{anchor:l,head:a}=s,c=this.toEditorPos(i.updateRangeStart),h=this.toEditorPos(i.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:c,drifted:!1});let d=h-c>i.text.length;c==this.from&&l<this.from?c=l:h==this.to&&l>this.to&&(h=l);let p=dT(e.state.sliceDoc(c,h),i.text,(d?s.from:s.to)-c,d?"end":null);if(!p){let b=G.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));Wf(b,s)||e.dispatch({selection:b,userEvent:"select"});return}let m={from:p.from+c,to:p.toA+c,insert:He.of(i.text.slice(p.from,p.toB).split(`
`))};if((se.mac||se.android)&&m.from==a-1&&/^\. ?$/.test(i.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(m={from:c,to:h,insert:He.of([i.text.replace("."," ")])}),this.pendingContextChange=m,!e.state.readOnly){let b=this.to-this.from+(m.to-m.from+m.insert.length);Lb(e,m,G.single(this.toEditorPos(i.selectionStart,b),this.toEditorPos(i.selectionEnd,b)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),m.from<m.to&&!m.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,i.updateRangeStart-1),Math.min(t.text.length,i.updateRangeStart+1)))&&this.handlers.compositionend(i)},this.handlers.characterboundsupdate=i=>{let s=[],l=null;for(let a=this.toEditorPos(i.rangeStart),c=this.toEditorPos(i.rangeEnd);a<c;a++){let h=e.coordsForChar(a);l=h&&new DOMRect(h.left,h.top,h.right-h.left,h.bottom-h.top)||l||new DOMRect,s.push(l)}t.updateCharacterBounds(i.rangeStart,s)},this.handlers.textformatupdate=i=>{let s=[];for(let l of i.getTextFormats()){let a=l.underlineStyle,c=l.underlineThickness;if(!/none/i.test(a)&&!/none/i.test(c)){let h=this.toEditorPos(l.rangeStart),d=this.toEditorPos(l.rangeEnd);if(h<d){let p=`text-decoration: underline ${/^[a-z]/.test(a)?a+" ":a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${/thin/i.test(c)?1:2}px`;s.push(he.mark({attributes:{style:p}}).range(h,d))}}}e.dispatch({effects:nT.of(he.set(s))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(e.state)}};for(let i in this.handlers)t.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let s=Bo(i.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,i=!1,s=this.pendingContextChange;return e.changes.iterChanges((l,a,c,h,d)=>{if(i)return;let p=d.length-(a-l);if(s&&a>=s.to)if(s.from==l&&s.to==a&&s.insert.eq(d)){s=this.pendingContextChange=null,t+=p,this.to+=p;return}else s=null,this.revertPending(e.state);if(l+=t,a+=t,a<=this.from)this.from+=p,this.to+=p;else if(l<this.to){if(l<this.from||a>this.to||this.to-this.from+d.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(l),this.toContextPos(a),d.toString()),this.to+=p}t+=p}),s&&!i&&this.revertPending(e.state),!i}update(e){let t=this.pendingContextChange,i=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(i.from,i.to)&&e.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),s=this.toContextPos(t.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(i,s)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let i=this.composing;return i&&i.drifted?i.editorBase+(e-i.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class ee{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(s=>s.forEach(l=>i(l,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=e.root||zU(e.parent)||document,this.viewState=new u_(e.state||Ue.create(e)),e.scrollTo&&e.scrollTo.is(qh)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(ao).map(s=>new Zm(s));for(let s of this.plugins)s.update(this);this.observer=new l8(this),this.inputState=new E4(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Xx(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...e){let t=e.length==1&&e[0]instanceof Tt?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,s,l=this.state;for(let b of e){if(b.startState!=l)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");l=b.state}if(this.destroyed){this.viewState.state=l;return}let a=this.hasFocus,c=0,h=null;e.some(b=>b.annotation(vT))?(this.inputState.notifiedFocused=a,c=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,h=wT(l,a),h||(c=1));let d=this.observer.delayedAndroidKey,p=null;if(d?(this.observer.clearDelayedAndroidKey(),p=this.observer.readChange(),(p&&!this.state.doc.eq(l.doc)||!this.state.selection.eq(l.selection))&&(p=null)):this.observer.clear(),l.facet(Ue.phrases)!=this.state.facet(Ue.phrases))return this.setState(l);s=$f.create(this,l,e),s.flags|=c;let m=this.viewState.scrollTarget;try{this.updateState=2;for(let b of e){if(m&&(m=m.map(b.changes)),b.scrollIntoView){let{main:v}=b.state.selection;m=new ko(v.empty?v:G.cursor(v.head,v.head>v.anchor?-1:1))}for(let v of b.effects)v.is(qh)&&(m=v.value.clip(this.state))}this.viewState.update(s,m),this.bidiCache=Yf.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(Za)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(b=>b.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(Fh)!=s.state.facet(Fh)&&(this.viewState.mustMeasureContent=!0),(t||i||m||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!s.empty)for(let b of this.state.facet(Sy))try{b(s)}catch(v){mn(this.state,v,"update listener")}(h||p)&&Promise.resolve().then(()=>{h&&this.state==h.startState&&this.dispatch(h),p&&!fT(this,p)&&d.force&&So(this.contentDOM,d.key,d.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new u_(e),this.plugins=e.facet(ao).map(i=>new Zm(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new Xx(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(ao),i=e.state.facet(ao);if(t!=i){let s=[];for(let l of i){let a=t.indexOf(l);if(a<0)s.push(new Zm(l));else{let c=this.plugins[a];c.mustUpdate=e,s.push(c)}}for(let l of this.plugins)l.mustUpdate!=e&&l.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);t!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(i){mn(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,i=this.scrollDOM,s=i.scrollTop*this.scaleY,{scrollAnchorPos:l,scrollAnchorHeight:a}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let c=0;;c++){if(a<0)if(IC(i))l=-1,a=this.viewState.heightMap.height;else{let v=this.viewState.scrollAnchorAt(s);l=v.from,a=v.top}this.updateState=1;let h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(c>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let d=[];h&4||([this.measureRequests,d]=[d,this.measureRequests]);let p=d.map(v=>{try{return v.read(this)}catch(w){return mn(this.state,w),g_}}),m=$f.create(this,this.state,[]),b=!1;m.flags|=h,t?t.flags|=h:t=m,this.updateState=2,m.empty||(this.updatePlugins(m),this.inputState.update(m),this.updateAttrs(),b=this.docView.update(m),b&&this.docViewUpdate());for(let v=0;v<d.length;v++)if(p[v]!=g_)try{let w=d[v];w.write&&w.write(p[v],this)}catch(w){mn(this.state,w)}if(b&&this.docView.updateSelection(!0),!m.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let w=(l<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(l).top)-a;if(w>1||w<-1){s=s+w,i.scrollTop=s/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let c of this.state.facet(Sy))c(t)}get themeClasses(){return Cy+" "+(this.state.facet(Ay)?_T:xT)+" "+this.state.facet(Fh)}updateAttrs(){let e=m_(this,iT,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(ps)?"true":"false",class:"cm-content",style:`${se.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),m_(this,Rb,t);let i=this.observer.ignore(()=>{let s=$x(this.contentDOM,this.contentAttrs,t),l=$x(this.dom,this.editorAttrs,e);return s||l});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let s of i.effects)if(s.is(ee.announce)){t&&(this.announceDOM.textContent=""),t=!1;let l=this.announceDOM.appendChild(document.createElement("div"));l.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Za);let e=this.state.facet(ee.cspNonce);lr.mount(this.root,this.styleModules.concat(s8).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return i0(this,e,Qx(this,e,t,i))}moveByGroup(e,t){return i0(this,e,Qx(this,e,t,i=>w4(this,e.head,i)))}visualLineSide(e,t){let i=this.bidiSpans(e),s=this.textDirectionAt(e.from),l=i[t?i.length-1:0];return G.cursor(l.side(t,s)+e.from,l.forward(!t,s)?1:-1)}moveToLineBoundary(e,t,i=!0){return v4(this,e,t,i)}moveVertically(e,t,i){return i0(this,e,S4(this,e,t,i))}domAtPos(e,t=1){return this.docView.domAtPos(e,t)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){this.readMeasured();let i=_y(this,e,t);return i&&i.pos}posAndSideAtCoords(e,t=!0){return this.readMeasured(),_y(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(e),l=this.bidiSpans(s),a=l[gs.find(l,e-s.from,-1,t)];return Vf(i,a.dir==Ze.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(ZC)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>c8)return GC(e.length);let t=this.textDirectionAt(e.from),i;for(let l of this.bidiCache)if(l.from==e.from&&l.dir==t&&(l.fresh||$C(l.isolates,i=Wx(this,e))))return l.order;i||(i=Wx(this,e));let s=KU(e.text,t,i);return this.bidiCache.push(new Yf(e.from,e.to,t,i,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||se.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{zC(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return qh.of(new ko(typeof e=="number"?G.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return qh.of(new ko(G.cursor(i.from),"start","start",i.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return lt.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return lt.define(()=>({}),{eventObservers:e})}static theme(e,t){let i=lr.newName(),s=[Fh.of(i),Za.of(Ty(`.${i}`,e))];return t&&t.dark&&s.push(Ay.of(!0)),s}static baseTheme(e){return ol.lowest(Za.of(Ty("."+Cy,e,OT)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),s=i&&kt.get(i)||kt.get(e);return((t=s?.root)===null||t===void 0?void 0:t.view)||null}}ee.styleModule=Za;ee.inputHandler=QC;ee.clipboardInputFilter=Eb;ee.clipboardOutputFilter=Db;ee.scrollHandler=tT;ee.focusChangeEffect=JC;ee.perLineTextDirection=ZC;ee.exceptionSink=XC;ee.updateListener=Sy;ee.editable=ps;ee.mouseSelectionStyle=YC;ee.dragMovesSelection=FC;ee.clickAddsSelectionRange=WC;ee.decorations=Md;ee.blockWrappers=sT;ee.outerDecorations=Mb;ee.atomicRanges=su;ee.bidiIsolatedRanges=rT;ee.scrollMargins=lT;ee.darkTheme=Ay;ee.cspNonce=te.define({combine:n=>n.length?n[0]:""});ee.contentAttributes=Rb;ee.editorAttributes=iT;ee.lineWrapping=ee.contentAttributes.of({class:"cm-lineWrapping"});ee.announce=_e.define();const c8=4096,g_={};class Yf{constructor(e,t,i,s,l,a){this.from=e,this.to=t,this.dir=i,this.isolates=s,this.fresh=l,this.order=a}static update(e,t){if(t.empty&&!e.some(l=>l.fresh))return e;let i=[],s=e.length?e[e.length-1].dir:Ze.LTR;for(let l=Math.max(0,e.length-10);l<e.length;l++){let a=e[l];a.dir==s&&!t.touchesRange(a.from,a.to)&&i.push(new Yf(t.mapPos(a.from,1),t.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return i}}function m_(n,e,t){for(let i=n.state.facet(e),s=i.length-1;s>=0;s--){let l=i[s],a=typeof l=="function"?l(n):l;a&&Ab(a,t)}return t}const u8=se.mac?"mac":se.windows?"win":se.linux?"linux":"key";function h8(n,e){const t=n.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let s,l,a,c;for(let h=0;h<t.length-1;++h){const d=t[h];if(/^(cmd|meta|m)$/i.test(d))c=!0;else if(/^a(lt)?$/i.test(d))s=!0;else if(/^(c|ctrl|control)$/i.test(d))l=!0;else if(/^s(hift)?$/i.test(d))a=!0;else if(/^mod$/i.test(d))e=="mac"?c=!0:l=!0;else throw new Error("Unrecognized modifier name: "+d)}return s&&(i="Alt-"+i),l&&(i="Ctrl-"+i),c&&(i="Meta-"+i),a&&(i="Shift-"+i),i}function Yh(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const f8=ol.default(ee.domEventHandlers({keydown(n,e){return CT(AT(e.state),n,e,"editor")}})),Ub=te.define({enables:f8}),y_=new WeakMap;function AT(n){let e=n.facet(Ub),t=y_.get(e);return t||y_.set(e,t=g8(e.reduce((i,s)=>i.concat(s),[]))),t}function d8(n,e,t){return CT(AT(n.state),e,n,t)}let Zs=null;const p8=4e3;function g8(n,e=u8){let t=Object.create(null),i=Object.create(null),s=(a,c)=>{let h=i[a];if(h==null)i[a]=c;else if(h!=c)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},l=(a,c,h,d,p)=>{var m,b;let v=t[a]||(t[a]=Object.create(null)),w=c.split(/ (?!$)/).map(O=>h8(O,e));for(let O=1;O<w.length;O++){let R=w.slice(0,O).join(" ");s(R,!0),v[R]||(v[R]={preventDefault:!0,stopPropagation:!1,run:[C=>{let U=Zs={view:C,prefix:R,scope:a};return setTimeout(()=>{Zs==U&&(Zs=null)},p8),!0}]})}let k=w.join(" ");s(k,!1);let _=v[k]||(v[k]={preventDefault:!1,stopPropagation:!1,run:((b=(m=v._any)===null||m===void 0?void 0:m.run)===null||b===void 0?void 0:b.slice())||[]});h&&_.run.push(h),d&&(_.preventDefault=!0),p&&(_.stopPropagation=!0)};for(let a of n){let c=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let d of c){let p=t[d]||(t[d]=Object.create(null));p._any||(p._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:m}=a;for(let b in p)p[b].run.push(v=>m(v,Ey))}let h=a[e]||a.key;if(h)for(let d of c)l(d,h,a.run,a.preventDefault,a.stopPropagation),a.shift&&l(d,"Shift-"+h,a.shift,a.preventDefault,a.stopPropagation)}return t}let Ey=null;function CT(n,e,t,i){Ey=e;let s=EU(e),l=fn(s,0),a=Li(l)==s.length&&s!=" ",c="",h=!1,d=!1,p=!1;Zs&&Zs.view==t&&Zs.scope==i&&(c=Zs.prefix+" ",gT.indexOf(e.keyCode)<0&&(d=!0,Zs=null));let m=new Set,b=_=>{if(_){for(let O of _.run)if(!m.has(O)&&(m.add(O),O(t)))return _.stopPropagation&&(p=!0),!0;_.preventDefault&&(_.stopPropagation&&(p=!0),d=!0)}return!1},v=n[i],w,k;return v&&(b(v[c+Yh(s,e,!a)])?h=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(se.windows&&e.ctrlKey&&e.altKey)&&!(se.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(w=or[e.keyCode])&&w!=s?(b(v[c+Yh(w,e,!0)])||e.shiftKey&&(k=Bc[e.keyCode])!=s&&k!=w&&b(v[c+Yh(k,e,!1)]))&&(h=!0):a&&e.shiftKey&&b(v[c+Yh(s,e,!0)])&&(h=!0),!h&&b(v._any)&&(h=!0)),d&&(h=!0),h&&p&&e.stopPropagation(),Ey=null,h}class ru{constructor(e,t,i,s,l){this.className=e,this.left=t,this.top=i,this.width=s,this.height=l}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,i){if(i.empty){let s=e.coordsAtPos(i.head,i.assoc||1);if(!s)return[];let l=TT(e);return[new ru(t,s.left-l.left,s.top-l.top,null,s.bottom-s.top)]}else return m8(e,t,i)}}function TT(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Ze.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function b_(n,e,t,i){let s=n.coordsAtPos(e,t*2);if(!s)return i;let l=n.dom.getBoundingClientRect(),a=(s.top+s.bottom)/2,c=n.posAtCoords({x:l.left+1,y:a}),h=n.posAtCoords({x:l.right-1,y:a});return c==null||h==null?i:{from:Math.max(i.from,Math.min(c,h)),to:Math.min(i.to,Math.max(c,h))}}function m8(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let i=Math.max(t.from,n.viewport.from),s=Math.min(t.to,n.viewport.to),l=n.textDirection==Ze.LTR,a=n.contentDOM,c=a.getBoundingClientRect(),h=TT(n),d=a.querySelector(".cm-line"),p=d&&window.getComputedStyle(d),m=c.left+(p?parseInt(p.paddingLeft)+Math.min(0,parseInt(p.textIndent)):0),b=c.right-(p?parseInt(p.paddingRight):0),v=xy(n,i,1),w=xy(n,s,-1),k=v.type==Gt.Text?v:null,_=w.type==Gt.Text?w:null;if(k&&(n.lineWrapping||v.widgetLineBreaks)&&(k=b_(n,i,1,k)),_&&(n.lineWrapping||w.widgetLineBreaks)&&(_=b_(n,s,-1,_)),k&&_&&k.from==_.from&&k.to==_.to)return R(C(t.from,t.to,k));{let B=k?C(t.from,null,k):U(v,!1),z=_?C(null,t.to,_):U(w,!0),D=[];return(k||v).to<(_||w).from-(k&&_?1:0)||v.widgetLineBreaks>1&&B.bottom+n.defaultLineHeight/2<z.top?D.push(O(m,B.bottom,b,z.top)):B.bottom<z.top&&n.elementAtHeight((B.bottom+z.top)/2).type==Gt.Text&&(B.bottom=z.top=(B.bottom+z.top)/2),R(B).concat(D).concat(R(z))}function O(B,z,D,W){return new ru(e,B-h.left,z-h.top,Math.max(0,D-B),W-z)}function R({top:B,bottom:z,horizontal:D}){let W=[];for(let ne=0;ne<D.length;ne+=2)W.push(O(D[ne],B,D[ne+1],z));return W}function C(B,z,D){let W=1e9,ne=-1e9,Ce=[];function de(Q,ue,I,F,ae){let ve=n.coordsAtPos(Q,Q==D.to?-2:2),Te=n.coordsAtPos(I,I==D.from?2:-2);!ve||!Te||(W=Math.min(ve.top,Te.top,W),ne=Math.max(ve.bottom,Te.bottom,ne),ae==Ze.LTR?Ce.push(l&&ue?m:ve.left,l&&F?b:Te.right):Ce.push(!l&&F?m:Te.left,!l&&ue?b:ve.right))}let J=B??D.from,oe=z??D.to;for(let Q of n.visibleRanges)if(Q.to>J&&Q.from<oe)for(let ue=Math.max(Q.from,J),I=Math.min(Q.to,oe);;){let F=n.state.doc.lineAt(ue);for(let ae of n.bidiSpans(F)){let ve=ae.from+F.from,Te=ae.to+F.from;if(ve>=I)break;Te>ue&&de(Math.max(ve,ue),B==null&&ve<=J,Math.min(Te,I),z==null&&Te>=oe,ae.dir)}if(ue=F.to+1,ue>=I)break}return Ce.length==0&&de(J,B==null,oe,z==null,n.textDirection),{top:W,bottom:ne,horizontal:Ce}}function U(B,z){let D=c.top+(z?B.top:B.bottom);return{top:D,bottom:D,horizontal:[]}}}function y8(n,e){return n.constructor==e.constructor&&n.eq(e)}class b8{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(bf)!=e.state.facet(bf)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,i=e.facet(bf);for(;t<i.length&&i[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,i)=>!y8(t,this.drawn[i]))){let t=this.dom.firstChild,i=0;for(let s of e)s.update&&t&&s.constructor&&this.drawn[i].constructor&&s.update(t,this.drawn[i])?(t=t.nextSibling,i++):this.dom.insertBefore(s.draw(),t);for(;t;){let s=t.nextSibling;t.remove(),t=s}this.drawn=e,se.safari&&se.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const bf=te.define();function ET(n){return[lt.define(e=>new b8(e,n)),bf.of(n)]}const zc=te.define({combine(n){return Ki(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function v8(n={}){return[zc.of(n),w8,S8,k8,eT.of(!0)]}function DT(n){return n.startState.facet(zc)!=n.state.facet(zc)}const w8=ET({above:!0,markers(n){let{state:e}=n,t=e.facet(zc),i=[];for(let s of e.selection.ranges){let l=s==e.selection.main;if(s.empty||t.drawRangeCursor){let a=l?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",c=s.empty?s:G.cursor(s.head,s.head>s.anchor?-1:1);for(let h of ru.forRange(n,a,c))i.push(h)}}return i},update(n,e){n.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=DT(n);return t&&v_(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){v_(e.state,n)},class:"cm-cursorLayer"});function v_(n,e){e.style.animationDuration=n.facet(zc).cursorBlinkRate+"ms"}const S8=ET({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:ru.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||DT(n)},class:"cm-selectionLayer"}),k8=ol.highest(ee.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),RT=_e.define({map(n,e){return n==null?null:e.mapPos(n)}}),nc=Wt.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,i)=>i.is(RT)?i.value:t,n)}}),x8=lt.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(nc);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(nc)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(nc),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let i=n.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-i.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(nc)!=n&&this.view.dispatch({effects:RT.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function _8(){return[nc,x8]}function w_(n,e,t,i,s){e.lastIndex=0;for(let l=n.iterRange(t,i),a=t,c;!l.next().done;a+=l.value.length)if(!l.lineBreak)for(;c=e.exec(l.value);)s(a+c.index,c)}function O8(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let i=[];for(let{from:s,to:l}of t)s=Math.max(n.state.doc.lineAt(s).from,s-e),l=Math.min(n.state.doc.lineAt(l).to,l+e),i.length&&i[i.length-1].to>=s?i[i.length-1].to=l:i.push({from:s,to:l});return i}class A8{constructor(e){const{regexp:t,decoration:i,decorate:s,boundary:l,maxLength:a=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,s)this.addMatch=(c,h,d,p)=>s(p,d,d+c[0].length,c,h);else if(typeof i=="function")this.addMatch=(c,h,d,p)=>{let m=i(c,h,d);m&&p(d,d+c[0].length,m)};else if(i)this.addMatch=(c,h,d,p)=>p(d,d+c[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=l,this.maxLength=a}createDeco(e){let t=new qi,i=t.add.bind(t);for(let{from:s,to:l}of O8(e,this.maxLength))w_(e.state.doc,this.regexp,s,l,(a,c)=>this.addMatch(c,e,a,i));return t.finish()}updateDeco(e,t){let i=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((l,a,c,h)=>{h>=e.view.viewport.from&&c<=e.view.viewport.to&&(i=Math.min(c,i),s=Math.max(h,s))}),e.viewportMoved||s-i>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,t.map(e.changes),i,s):t}updateRange(e,t,i,s){for(let l of e.visibleRanges){let a=Math.max(l.from,i),c=Math.min(l.to,s);if(c>=a){let h=e.state.doc.lineAt(a),d=h.to<c?e.state.doc.lineAt(c):h,p=Math.max(l.from,h.from),m=Math.min(l.to,d.to);if(this.boundary){for(;a>h.from;a--)if(this.boundary.test(h.text[a-1-h.from])){p=a;break}for(;c<d.to;c++)if(this.boundary.test(d.text[c-d.from])){m=c;break}}let b=[],v,w=(k,_,O)=>b.push(O.range(k,_));if(h==d)for(this.regexp.lastIndex=p-h.from;(v=this.regexp.exec(h.text))&&v.index<m-h.from;)this.addMatch(v,e,v.index+h.from,w);else w_(e.state.doc,this.regexp,p,m,(k,_)=>this.addMatch(_,e,k,w));t=t.update({filterFrom:p,filterTo:m,filter:(k,_)=>k<p||_>m,add:b})}}return t}}const Dy=/x/.unicode!=null?"gu":"g",C8=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Dy),T8={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let l0=null;function E8(){var n;if(l0==null&&typeof document<"u"&&document.body){let e=document.body.style;l0=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return l0||!1}const vf=te.define({combine(n){let e=Ki(n,{render:null,specialChars:C8,addSpecialChars:null});return(e.replaceTabs=!E8())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Dy)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Dy)),e}});function D8(n={}){return[vf.of(n),R8()]}let S_=null;function R8(){return S_||(S_=lt.fromClass(class{constructor(n){this.view=n,this.decorations=he.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(vf)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new A8({regexp:n.specialChars,decoration:(e,t,i)=>{let{doc:s}=t.state,l=fn(e[0],0);if(l==9){let a=s.lineAt(i),c=t.state.tabSize,h=Wo(a.text,c,i-a.from);return he.replace({widget:new B8((c-h%c)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[l]||(this.decorationCache[l]=he.replace({widget:new L8(n,l)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(vf);n.startState.facet(vf)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const M8="";function N8(n){return n>=32?M8:n==10?"":String.fromCharCode(9216+n)}class L8 extends Wi{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=N8(this.code),i=e.state.phrase("Control character")+" "+(T8[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,i,t);if(s)return s;let l=document.createElement("span");return l.textContent=t,l.title=i,l.setAttribute("aria-label",i),l.className="cm-specialChar",l}ignoreEvent(){return!1}}class B8 extends Wi{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function j8(){return z8}const U8=he.line({class:"cm-activeLine"}),z8=lt.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let i of n.state.selection.ranges){let s=n.lineBlockAt(i.head);s.from>e&&(t.push(U8.range(s.from)),e=s.from)}return he.set(t)}},{decorations:n=>n.decorations}),Ry=2e3;function I8(n,e,t){let i=Math.min(e.line,t.line),s=Math.max(e.line,t.line),l=[];if(e.off>Ry||t.off>Ry||e.col<0||t.col<0){let a=Math.min(e.off,t.off),c=Math.max(e.off,t.off);for(let h=i;h<=s;h++){let d=n.doc.line(h);d.length<=c&&l.push(G.range(d.from+a,d.to+c))}}else{let a=Math.min(e.col,t.col),c=Math.max(e.col,t.col);for(let h=i;h<=s;h++){let d=n.doc.line(h),p=uy(d.text,a,n.tabSize,!0);if(p<0)l.push(G.cursor(d.to));else{let m=uy(d.text,c,n.tabSize);l.push(G.range(d.from+p,d.from+m))}}}return l}function P8(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function k_(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),i=n.state.doc.lineAt(t),s=t-i.from,l=s>Ry?-1:s==i.length?P8(n,e.clientX):Wo(i.text,n.state.tabSize,t-i.from);return{line:i.number,col:l,off:s}}function H8(n,e){let t=k_(n,e),i=n.state.selection;return t?{update(s){if(s.docChanged){let l=s.changes.mapPos(s.startState.doc.line(t.line).from),a=s.state.doc.lineAt(l);t={line:a.number,col:t.col,off:Math.min(t.off,a.length)},i=i.map(s.changes)}},get(s,l,a){let c=k_(n,s);if(!c)return i;let h=I8(n.state,t,c);return h.length?a?G.create(h.concat(i.ranges)):G.create(h):i}}:null}function q8(n){let e=(t=>t.altKey&&t.button==0);return ee.mouseSelectionStyle.of((t,i)=>e(i)?H8(t,i):null)}const V8={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},$8={style:"cursor: crosshair"};function G8(n={}){let[e,t]=V8[n.key||"Alt"],i=lt.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventObservers:{keydown(s){this.set(s.keyCode==e||t(s))},keyup(s){(s.keyCode==e||!t(s))&&this.set(!1)},mousemove(s){this.set(t(s))}}});return[i,ee.contentAttributes.of(s=>{var l;return!((l=s.plugin(i))===null||l===void 0)&&l.isDown?$8:null})]}const Xh="-10000px";class MT{constructor(e,t,i,s){this.facet=t,this.createTooltipView=i,this.removeTooltipView=s,this.input=e.state.facet(t),this.tooltips=this.input.filter(a=>a);let l=null;this.tooltipViews=this.tooltips.map(a=>l=i(a,l))}update(e,t){var i;let s=e.state.facet(this.facet),l=s.filter(h=>h);if(s===this.input){for(let h of this.tooltipViews)h.update&&h.update(e);return!1}let a=[],c=t?[]:null;for(let h=0;h<l.length;h++){let d=l[h],p=-1;if(d){for(let m=0;m<this.tooltips.length;m++){let b=this.tooltips[m];b&&b.create==d.create&&(p=m)}if(p<0)a[h]=this.createTooltipView(d,h?a[h-1]:null),c&&(c[h]=!!d.above);else{let m=a[h]=this.tooltipViews[p];c&&(c[h]=t[p]),m.update&&m.update(e)}}}for(let h of this.tooltipViews)a.indexOf(h)<0&&(this.removeTooltipView(h),(i=h.destroy)===null||i===void 0||i.call(h));return t&&(c.forEach((h,d)=>t[d]=h),t.length=c.length),this.input=s,this.tooltips=l,this.tooltipViews=a,!0}}function K8(n){let e=n.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const o0=te.define({combine:n=>{var e,t,i;return{position:se.ios?"absolute":((e=n.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(s=>s.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=n.find(s=>s.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||K8}}}),x_=new WeakMap,zb=lt.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(o0);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new MT(n,Ib,(t,i)=>this.createTooltip(t,i),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,i=n.state.facet(o0);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),i=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",t.dom.appendChild(s)}return t.dom.style.position=this.position,t.dom.style.top=Xh,t.dom.style.left="0px",this.container.insertBefore(t.dom,i),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(n=i.destroy)===null||n===void 0||n.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:l}=this.manager.tooltipViews[0];if(se.safari){let a=l.getBoundingClientRect();t=Math.abs(a.top+1e4)>1||Math.abs(a.left)>1}else t=!!l.offsetParent&&l.offsetParent!=this.container.ownerDocument.body}if(t||this.position=="absolute")if(this.parent){let l=this.parent.getBoundingClientRect();l.width&&l.height&&(n=l.width/this.parent.offsetWidth,e=l.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:e}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),s=Nb(this.view);return{visible:{left:i.left+s.left,top:i.top+s.top,right:i.right-s.right,bottom:i.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((l,a)=>{let c=this.manager.tooltipViews[a];return c.getCoords?c.getCoords(l.pos):this.view.coordsAtPos(l.pos)}),size:this.manager.tooltipViews.map(({dom:l})=>l.getBoundingClientRect()),space:this.view.state.facet(o0).tooltipSpace(this.view),scaleX:n,scaleY:e,makeAbsolute:t}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let c of this.manager.tooltipViews)c.dom.style.position="absolute"}let{visible:t,space:i,scaleX:s,scaleY:l}=n,a=[];for(let c=0;c<this.manager.tooltips.length;c++){let h=this.manager.tooltips[c],d=this.manager.tooltipViews[c],{dom:p}=d,m=n.pos[c],b=n.size[c];if(!m||h.clip!==!1&&(m.bottom<=Math.max(t.top,i.top)||m.top>=Math.min(t.bottom,i.bottom)||m.right<Math.max(t.left,i.left)-.1||m.left>Math.min(t.right,i.right)+.1)){p.style.top=Xh;continue}let v=h.arrow?d.dom.querySelector(".cm-tooltip-arrow"):null,w=v?7:0,k=b.right-b.left,_=(e=x_.get(d))!==null&&e!==void 0?e:b.bottom-b.top,O=d.offset||F8,R=this.view.textDirection==Ze.LTR,C=b.width>i.right-i.left?R?i.left:i.right-b.width:R?Math.max(i.left,Math.min(m.left-(v?14:0)+O.x,i.right-k)):Math.min(Math.max(i.left,m.left-k+(v?14:0)-O.x),i.right-k),U=this.above[c];!h.strictSide&&(U?m.top-_-w-O.y<i.top:m.bottom+_+w+O.y>i.bottom)&&U==i.bottom-m.bottom>m.top-i.top&&(U=this.above[c]=!U);let B=(U?m.top-i.top:i.bottom-m.bottom)-w;if(B<_&&d.resize!==!1){if(B<this.view.defaultLineHeight){p.style.top=Xh;continue}x_.set(d,_),p.style.height=(_=B)/l+"px"}else p.style.height&&(p.style.height="");let z=U?m.top-_-w-O.y:m.bottom+w+O.y,D=C+k;if(d.overlap!==!0)for(let W of a)W.left<D&&W.right>C&&W.top<z+_&&W.bottom>z&&(z=U?W.top-_-2-w:W.bottom+w+2);if(this.position=="absolute"?(p.style.top=(z-n.parent.top)/l+"px",__(p,(C-n.parent.left)/s)):(p.style.top=z/l+"px",__(p,C/s)),v){let W=m.left+(R?O.x:-O.x)-(C+14-7);v.style.left=W/s+"px"}d.overlap!==!0&&a.push({left:C,top:z,right:D,bottom:z+_}),p.classList.toggle("cm-tooltip-above",U),p.classList.toggle("cm-tooltip-below",!U),d.positioned&&d.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Xh}},{eventObservers:{scroll(){this.maybeMeasure()}}});function __(n,e){let t=parseInt(n.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(n.style.left=e+"px")}const W8=ee.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),F8={x:0,y:0},Ib=te.define({enables:[zb,W8]}),Xf=te.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class jd{static create(e){return new jd(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new MT(e,Xf,(t,i)=>this.createHostedView(t,i),t=>t.dom.remove())}createHostedView(e,t){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let i of this.manager.tooltipViews){let s=i[e];if(s!==void 0){if(t===void 0)t=s;else if(t!==s)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const Y8=Ib.compute([Xf],n=>{let e=n.facet(Xf);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var i;return(i=t.end)!==null&&i!==void 0?i:t.pos})),create:jd.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class X8{constructor(e,t,i,s,l){this.view=e,this.source=t,this.field=i,this.setHover=s,this.hoverTime=l,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,i=e.docView.tile.nearest(t.target);if(!i)return;let s,l=1;if(i.isWidget())s=i.posAtStart;else{if(s=e.posAtCoords(t),s==null)return;let c=e.coordsAtPos(s);if(!c||t.y<c.top||t.y>c.bottom||t.x<c.left-e.defaultCharacterWidth||t.x>c.right+e.defaultCharacterWidth)return;let h=e.bidiSpans(e.state.doc.lineAt(s)).find(p=>p.from<=s&&p.to>=s),d=h&&h.dir==Ze.RTL?-1:1;l=t.x<c.left?-d:d}let a=this.source(e,s,l);if(a?.then){let c=this.pending={pos:s};a.then(h=>{this.pending==c&&(this.pending=null,h&&!(Array.isArray(h)&&!h.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(h)?h:[h])}))},h=>mn(e.state,h,"hover tooltip"))}else a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}get tooltip(){let e=this.view.plugin(zb),t=e?e.manager.tooltips.findIndex(i=>i.create==jd.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:s,tooltip:l}=this;if(s.length&&l&&!Q8(l.dom,e)||this.pending){let{pos:a}=s[0]||this.pending,c=(i=(t=s[0])===null||t===void 0?void 0:t.end)!==null&&i!==void 0?i:a;(a==c?this.view.posAtCoords(this.lastMove)!=a:!J8(this.view,a,c,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=i=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),clearTimeout(this.restartTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Qh=4;function Q8(n,e){let{left:t,right:i,top:s,bottom:l}=n.getBoundingClientRect(),a;if(a=n.querySelector(".cm-tooltip-arrow")){let c=a.getBoundingClientRect();s=Math.min(c.top,s),l=Math.max(c.bottom,l)}return e.clientX>=t-Qh&&e.clientX<=i+Qh&&e.clientY>=s-Qh&&e.clientY<=l+Qh}function J8(n,e,t,i,s,l){let a=n.scrollDOM.getBoundingClientRect(),c=n.documentTop+n.documentPadding.top+n.contentHeight;if(a.left>i||a.right<i||a.top>s||Math.min(a.bottom,c)<s)return!1;let h=n.posAtCoords({x:i,y:s},!1);return h>=e&&h<=t}function Z8(n,e={}){let t=_e.define(),i=Wt.define({create(){return[]},update(s,l){if(s.length&&(e.hideOnChange&&(l.docChanged||l.selection)?s=[]:e.hideOn&&(s=s.filter(a=>!e.hideOn(l,a))),l.docChanged)){let a=[];for(let c of s){let h=l.changes.mapPos(c.pos,-1,tn.TrackDel);if(h!=null){let d=Object.assign(Object.create(null),c);d.pos=h,d.end!=null&&(d.end=l.changes.mapPos(d.end)),a.push(d)}}s=a}for(let a of l.effects)a.is(t)&&(s=a.value),a.is(ez)&&(s=[]);return s},provide:s=>Xf.from(s)});return{active:i,extension:[i,lt.define(s=>new X8(s,n,i,t,e.hoverTime||300)),Y8]}}function NT(n,e){let t=n.plugin(zb);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}const ez=_e.define(),O_=te.define({combine(n){let e,t;for(let i of n)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Pb(n,e){let t=n.plugin(LT),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const LT=lt.fromClass(class{constructor(n){this.input=n.state.facet(Ic),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(O_);this.top=new Jh(n,!0,e.topContainer),this.bottom=new Jh(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(O_);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Jh(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Jh(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Ic);if(t!=this.input){let i=t.filter(h=>h),s=[],l=[],a=[],c=[];for(let h of i){let d=this.specs.indexOf(h),p;d<0?(p=h(n.view),c.push(p)):(p=this.panels[d],p.update&&p.update(n)),s.push(p),(p.top?l:a).push(p)}this.specs=i,this.panels=s,this.top.sync(l),this.bottom.sync(a);for(let h of c)h.dom.classList.add("cm-panel"),h.mount&&h.mount()}else for(let i of this.panels)i.update&&i.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>ee.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Jh{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=A_(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=A_(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function A_(n){let e=n.nextSibling;return n.remove(),e}const Ic=te.define({enables:LT});function tz(n,e){let t,i=new Promise(a=>t=a),s=a=>nz(a,e,t);n.state.field(a0,!1)?n.dispatch({effects:BT.of(s)}):n.dispatch({effects:_e.appendConfig.of(a0.init(()=>[s]))});let l=jT.of(s);return{close:l,result:i.then(a=>((n.win.queueMicrotask||(h=>n.win.setTimeout(h,10)))(()=>{n.state.field(a0).indexOf(s)>-1&&n.dispatch({effects:l})}),a))}}const a0=Wt.define({create(){return[]},update(n,e){for(let t of e.effects)t.is(BT)?n=[t.value].concat(n):t.is(jT)&&(n=n.filter(i=>i!=t.value));return n},provide:n=>Ic.computeN([n],e=>e.field(n))}),BT=_e.define(),jT=_e.define();function nz(n,e,t){let i=e.content?e.content(n,()=>a(null)):null;if(!i){if(i=Fe("form"),e.input){let c=Fe("input",e.input);/^(text|password|number|email|tel|url)$/.test(c.type)&&c.classList.add("cm-textfield"),c.name||(c.name="input"),i.appendChild(Fe("label",(e.label||"")+": ",c))}else i.appendChild(document.createTextNode(e.label||""));i.appendChild(document.createTextNode(" ")),i.appendChild(Fe("button",{class:"cm-button",type:"submit"},e.submitLabel||"OK"))}let s=i.nodeName=="FORM"?[i]:i.querySelectorAll("form");for(let c=0;c<s.length;c++){let h=s[c];h.addEventListener("keydown",d=>{d.keyCode==27?(d.preventDefault(),a(null)):d.keyCode==13&&(d.preventDefault(),a(h))}),h.addEventListener("submit",d=>{d.preventDefault(),a(h)})}let l=Fe("div",i,Fe("button",{onclick:()=>a(null),"aria-label":n.state.phrase("close"),class:"cm-dialog-close",type:"button"},[""]));e.class&&(l.className=e.class),l.classList.add("cm-dialog");function a(c){l.contains(l.ownerDocument.activeElement)&&n.focus(),t(c)}return{dom:l,top:e.top,mount:()=>{if(e.focus){let c;typeof e.focus=="string"?c=i.querySelector(e.focus):c=i.querySelector("input")||i.querySelector("button"),c&&"select"in c?c.select():c&&"focus"in c&&c.focus()}}}}class vs extends rr{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}vs.prototype.elementClass="";vs.prototype.toDOM=void 0;vs.prototype.mapMode=tn.TrackBefore;vs.prototype.startSide=vs.prototype.endSide=-1;vs.prototype.point=!0;const wf=te.define(),iz=te.define(),sz={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>De.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},hc=te.define();function rz(n){return[UT(),hc.of({...sz,...n})]}const C_=te.define({combine:n=>n.some(e=>e)});function UT(n){return[lz]}const lz=lt.fromClass(class{constructor(n){this.view=n,this.domAfter=null,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(hc).map(e=>new E_(n,e)),this.fixed=!n.state.facet(C_);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}if(n.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(C_)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let t=De.iter(this.view.state.facet(wf),this.view.viewport.from),i=[],s=this.gutters.map(l=>new oz(l,this.view.viewport,-this.view.documentPadding.top));for(let l of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(l.type)){let a=!0;for(let c of l.type)if(c.type==Gt.Text&&a){My(t,i,c.from);for(let h of s)h.line(this.view,c,i);a=!1}else if(c.widget)for(let h of s)h.widget(this.view,c)}else if(l.type==Gt.Text){My(t,i,l.from);for(let a of s)a.line(this.view,l,i)}else if(l.widget)for(let a of s)a.widget(this.view,l);for(let l of s)l.finish();n&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(n){let e=n.startState.facet(hc),t=n.state.facet(hc),i=n.docChanged||n.heightChanged||n.viewportChanged||!De.eq(n.startState.facet(wf),n.state.facet(wf),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let s of this.gutters)s.update(n)&&(i=!0);else{i=!0;let s=[];for(let l of t){let a=e.indexOf(l);a<0?s.push(new E_(this.view,l)):(this.gutters[a].update(n),s.push(this.gutters[a]))}for(let l of this.gutters)l.dom.remove(),s.indexOf(l)<0&&l.destroy();for(let l of s)l.config.side=="after"?this.getDOMAfter().appendChild(l.dom):this.dom.appendChild(l.dom);this.gutters=s}return i}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:n=>ee.scrollMargins.of(e=>{let t=e.plugin(n);if(!t||t.gutters.length==0||!t.fixed)return null;let i=t.dom.offsetWidth*e.scaleX,s=t.domAfter?t.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==Ze.LTR?{left:i,right:s}:{right:i,left:s}})});function T_(n){return Array.isArray(n)?n:[n]}function My(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class oz{constructor(e,t,i){this.gutter=e,this.height=i,this.i=0,this.cursor=De.iter(e.markers,t.from)}addElement(e,t,i){let{gutter:s}=this,l=(t.top-this.height)/e.scaleY,a=t.height/e.scaleY;if(this.i==s.elements.length){let c=new zT(e,a,l,i);s.elements.push(c),s.dom.appendChild(c.dom)}else s.elements[this.i].update(e,a,l,i);this.height=t.bottom,this.i++}line(e,t,i){let s=[];My(this.cursor,s,t.from),i.length&&(s=s.concat(i));let l=this.gutter.config.lineMarker(e,t,s);l&&s.unshift(l);let a=this.gutter;s.length==0&&!a.config.renderEmptyElements||this.addElement(e,t,s)}widget(e,t){let i=this.gutter.config.widgetMarker(e,t.widget,t),s=i?[i]:null;for(let l of e.state.facet(iz)){let a=l(e,t.widget,t);a&&(s||(s=[])).push(a)}s&&this.addElement(e,t,s)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class E_{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,s=>{let l=s.target,a;if(l!=this.dom&&this.dom.contains(l)){for(;l.parentNode!=this.dom;)l=l.parentNode;let h=l.getBoundingClientRect();a=(h.top+h.bottom)/2}else a=s.clientY;let c=e.lineBlockAtHeight(a-e.documentTop);t.domEventHandlers[i](e,c,s)&&s.preventDefault()});this.markers=T_(t.markers(e)),t.initialSpacer&&(this.spacer=new zT(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=T_(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let i=e.view.viewport;return!De.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class zT{constructor(e,t,i,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,s)}update(e,t,i,s){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),az(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,t){let i="cm-gutterElement",s=this.dom.firstChild;for(let l=0,a=0;;){let c=a,h=l<t.length?t[l++]:null,d=!1;if(h){let p=h.elementClass;p&&(i+=" "+p);for(let m=a;m<this.markers.length;m++)if(this.markers[m].compare(h)){c=m,d=!0;break}}else c=this.markers.length;for(;a<c;){let p=this.markers[a++];if(p.toDOM){p.destroy(s);let m=s.nextSibling;s.remove(),s=m}}if(!h)break;h.toDOM&&(d?s=s.nextSibling:this.dom.insertBefore(h.toDOM(e),s)),d&&a++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function az(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const cz=te.define(),uz=te.define(),co=te.define({combine(n){return Ki(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let s in t){let l=i[s],a=t[s];i[s]=l?(c,h,d)=>l(c,h,d)||a(c,h,d):a}return i}})}});class c0 extends vs{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function u0(n,e){return n.state.facet(co).formatNumber(e,n.state)}const hz=hc.compute([co],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(cz)},lineMarker(e,t,i){return i.some(s=>s.toDOM)?null:new c0(u0(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,i)=>{for(let s of e.state.facet(uz)){let l=s(e,t,i);if(l)return l}return null},lineMarkerChange:e=>e.startState.facet(co)!=e.state.facet(co),initialSpacer(e){return new c0(u0(e,D_(e.state.doc.lines)))},updateSpacer(e,t){let i=u0(t.view,D_(t.view.state.doc.lines));return i==e.number?e:new c0(i)},domEventHandlers:n.facet(co).domEventHandlers,side:"before"}));function fz(n={}){return[co.of(n),UT(),hz]}function D_(n){let e=9;for(;e<n;)e=e*10+9;return e}const dz=new class extends vs{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},pz=wf.compute(["selection"],n=>{let e=[],t=-1;for(let i of n.selection.ranges){let s=n.doc.lineAt(i.head).from;s>t&&(t=s,e.push(dz.range(s)))}return De.of(e)});function gz(){return pz}const h0=3e4;class mz extends kL{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const t=_c();this.getLocalState()!==null&&h0/2<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const i=[];this.meta.forEach((s,l)=>{l!==this.clientID&&h0<=t-s.lastUpdated&&this.states.has(l)&&i.push(l)}),i.length>0&&yz(this,i,"timeout")},vi(h0/10)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,i=this.meta.get(t),s=i===void 0?0:i.clock+1,l=this.states.get(t);e===null?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:s,lastUpdated:_c()});const a=[],c=[],h=[],d=[];e===null?d.push(t):l==null?e!=null&&a.push(t):(c.push(t),po(l,e)||h.push(t)),(a.length>0||h.length>0||d.length>0)&&this.emit("change",[{added:a,updated:h,removed:d},"local"]),this.emit("update",[{added:a,updated:c,removed:d},"local"])}setLocalStateField(e,t){const i=this.getLocalState();i!==null&&this.setLocalState({...i,[e]:t})}getStates(){return this.states}}const yz=(n,e,t)=>{const i=[];for(let s=0;s<e.length;s++){const l=e[s];if(n.states.has(l)){if(n.states.delete(l),l===n.clientID){const a=n.meta.get(l);n.meta.set(l,{clock:a.clock+1,lastUpdated:_c()})}i.push(l)}}i.length>0&&(n.emit("change",[{added:[],updated:[],removed:i},t]),n.emit("update",[{added:[],updated:[],removed:i},t]))},bz=(n,e,t=n.states)=>{const i=e.length,s=Xc();Ee(s,i);for(let l=0;l<i;l++){const a=e[l],c=t.get(a)||null,h=n.meta.get(a).clock;Ee(s,a),Ee(s,h),Kr(s,JSON.stringify(c))}return gi(s)},vz=(n,e,t)=>{const i=sl(e),s=_c(),l=[],a=[],c=[],h=[],d=Ae(i);for(let p=0;p<d;p++){const m=Ae(i);let b=Ae(i);const v=JSON.parse(Wr(i)),w=n.meta.get(m),k=n.states.get(m),_=w===void 0?0:w.clock;(_<b||_===b&&v===null&&n.states.has(m))&&(v===null?m===n.clientID&&n.getLocalState()!=null?b++:n.states.delete(m):n.states.set(m,v),n.meta.set(m,{clock:b,lastUpdated:s}),w===void 0&&v!==null?l.push(m):w!==void 0&&v===null?h.push(m):v!==null&&(po(v,k)||c.push(m),a.push(m)))}(l.length>0||c.length>0||h.length>0)&&n.emit("change",[{added:l,updated:c,removed:h},t]),(l.length>0||a.length>0||h.length>0)&&n.emit("update",[{added:l,updated:a,removed:h},t])},wz=n=>{if(typeof Buffer<"u")return Buffer.from(n).toString("base64");const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return btoa(e)},f0=n=>{if(typeof Buffer<"u")return new Uint8Array(Buffer.from(n,"base64"));const e=atob(n);return Uint8Array.from(e,t=>t.codePointAt(0))};class Sz{doc;channel;awareness;_isConnected=!1;_resyncInterval=null;constructor(e,t,i){this.doc=e,this.awareness=new mz(e),this.channel=t.channel(i),this.channel.on("broadcast",{event:"awareness-update"},({payload:s})=>{const l=f0(s);vz(this.awareness,l,"remote")}).on("broadcast",{event:"sync-step-1"},({payload:s})=>{const l=f0(s),a=NA(e,l);a.length>0&&this.broadcast("sync-step-2",a)}).on("broadcast",{event:"sync-step-2"},({payload:s})=>{const l=f0(s);$0(e,l,"remote")}).subscribe(s=>{s==="SUBSCRIBED"?(this._isConnected=!0,this.initSync()):this._isConnected=!1}),e.on("update",(s,l)=>{l!=="remote"&&l!=="db-load"&&this._isConnected&&this.broadcast("sync-step-2",s)}),this.awareness.on("update",({added:s,updated:l,removed:a})=>{if(!this._isConnected)return;const c=s.concat(l).concat(a),h=bz(this.awareness,c);this.broadcast("awareness-update",h)}),this._resyncInterval=setInterval(()=>{this._isConnected&&this.awareness.getStates().size>0&&this.initSync()},3e4)}initSync(){const e=M3(this.doc);this.broadcast("sync-step-1",e)}broadcast(e,t){if(!this._isConnected)return;const i=wz(t);this.channel.send({type:"broadcast",event:e,payload:i})}destroy(){this._resyncInterval&&clearInterval(this._resyncInterval),this.channel.unsubscribe(),this.awareness.destroy()}}const IT=1024;let kz=0;class d0{constructor(e,t){this.from=e,this.to=t}}class Re{constructor(e={}){this.id=kz++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=vn.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}Re.closedBy=new Re({deserialize:n=>n.split(" ")});Re.openedBy=new Re({deserialize:n=>n.split(" ")});Re.group=new Re({deserialize:n=>n.split(" ")});Re.isolate=new Re({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});Re.contextHash=new Re({perNode:!0});Re.lookAhead=new Re({perNode:!0});Re.mounted=new Re({perNode:!0});class fc{constructor(e,t,i,s=!1){this.tree=e,this.overlay=t,this.parser=i,this.bracketed=s}static get(e){return e&&e.props&&e.props[Re.mounted.id]}}const xz=Object.create(null);class vn{constructor(e,t,i,s=0){this.name=e,this.props=t,this.id=i,this.flags=s}static define(e){let t=e.props&&e.props.length?Object.create(null):xz,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new vn(e.name||"",t,e.id,i);if(e.props){for(let l of e.props)if(Array.isArray(l)||(l=l(s)),l){if(l[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[l[0].id]=l[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Re.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let s of i.split(" "))t[s]=e[i];return i=>{for(let s=i.prop(Re.group),l=-1;l<(s?s.length:0);l++){let a=t[l<0?i.name:s[l]];if(a)return a}}}}vn.none=new vn("",Object.create(null),0,8);class Hb{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let s=null;for(let l of e){let a=l(i);if(a){s||(s=Object.assign({},i.props));let c=a[1],h=a[0];h.combine&&h.id in s&&(c=h.combine(s[h.id],c)),s[h.id]=c}}t.push(s?new vn(i.name,s,i.id,i.flags):i)}return new Hb(t)}}const Zh=new WeakMap,R_=new WeakMap;var ut;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays",n[n.EnterBracketed=16]="EnterBracketed"})(ut||(ut={}));class mt{constructor(e,t,i,s,l){if(this.type=e,this.children=t,this.positions=i,this.length=s,this.props=null,l&&l.length){this.props=Object.create(null);for(let[a,c]of l)this.props[typeof a=="number"?a:a.id]=c}}toString(){let e=fc.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let s=i.toString();s&&(t&&(t+=","),t+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Ly(this.topNode,e)}cursorAt(e,t=0,i=0){let s=Zh.get(this)||this.topNode,l=new Ly(s);return l.moveTo(e,t),Zh.set(this,l._tree),l}get topNode(){return new si(this,0,0,null)}resolve(e,t=0){let i=Pc(Zh.get(this)||this.topNode,e,t,!1);return Zh.set(this,i),i}resolveInner(e,t=0){let i=Pc(R_.get(this)||this.topNode,e,t,!0);return R_.set(this,i),i}resolveStack(e,t=0){return Az(this,e,t)}iterate(e){let{enter:t,leave:i,from:s=0,to:l=this.length}=e,a=e.mode||0,c=(a&ut.IncludeAnonymous)>0;for(let h=this.cursor(a|ut.IncludeAnonymous);;){let d=!1;if(h.from<=l&&h.to>=s&&(!c&&h.type.isAnonymous||t(h)!==!1)){if(h.firstChild())continue;d=!0}for(;d&&i&&(c||!h.type.isAnonymous)&&i(h),!h.nextSibling();){if(!h.parent())return;d=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:$b(vn.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,s)=>new mt(this.type,t,i,s,this.propValues),e.makeTree||((t,i,s)=>new mt(vn.none,t,i,s)))}static build(e){return Cz(e)}}mt.empty=new mt(vn.none,[],[],0);class qb{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new qb(this.buffer,this.index)}}class cr{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return vn.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],s=this.set.types[t],l=s.name;if(/\W/.test(l)&&!s.isError&&(l=JSON.stringify(l)),e+=4,i==e)return l;let a=[];for(;e<i;)a.push(this.childString(e)),e=this.buffer[e+3];return l+"("+a.join(",")+")"}findChild(e,t,i,s,l){let{buffer:a}=this,c=-1;for(let h=e;h!=t&&!(PT(l,s,a[h+1],a[h+2])&&(c=h,i>0));h=a[h+3]);return c}slice(e,t,i){let s=this.buffer,l=new Uint16Array(t-e),a=0;for(let c=e,h=0;c<t;){l[h++]=s[c++],l[h++]=s[c++]-i;let d=l[h++]=s[c++]-i;l[h++]=s[c++]-e,a=Math.max(a,d)}return new cr(l,a,this.set)}}function PT(n,e,t,i){switch(n){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function Pc(n,e,t,i){for(var s;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let a=!i&&n instanceof si&&n.index<0?null:n.parent;if(!a)return n;n=a}let l=i?0:ut.IgnoreOverlays;if(i)for(let a=n,c=a.parent;c;a=c,c=a.parent)a instanceof si&&a.index<0&&((s=c.enter(e,t,l))===null||s===void 0?void 0:s.from)!=a.from&&(n=c);for(;;){let a=n.enter(e,t,l);if(!a)return n;n=a}}class HT{cursor(e=0){return new Ly(this,e)}getChild(e,t=null,i=null){let s=M_(this,e,t,i);return s.length?s[0]:null}getChildren(e,t=null,i=null){return M_(this,e,t,i)}resolve(e,t=0){return Pc(this,e,t,!1)}resolveInner(e,t=0){return Pc(this,e,t,!0)}matchContext(e){return Ny(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),i=this;for(;t;){let s=t.lastChild;if(!s||s.to!=t.to)break;s.type.isError&&s.from==s.to?(i=t,t=s.prevSibling):t=s}return i}get node(){return this}get next(){return this.parent}}class si extends HT{constructor(e,t,i,s){super(),this._tree=e,this.from=t,this.index=i,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,s,l=0){for(let a=this;;){for(let{children:c,positions:h}=a._tree,d=t>0?c.length:-1;e!=d;e+=t){let p=c[e],m=h[e]+a.from,b;if(!(!(l&ut.EnterBracketed&&p instanceof mt&&(b=fc.get(p))&&!b.overlay&&b.bracketed&&i>=m&&i<=m+p.length)&&!PT(s,i,m,m+p.length))){if(p instanceof cr){if(l&ut.ExcludeBuffers)continue;let v=p.findChild(0,p.buffer.length,t,i-m,s);if(v>-1)return new nr(new _z(a,p,e,m),null,v)}else if(l&ut.IncludeAnonymous||!p.type.isAnonymous||Vb(p)){let v;if(!(l&ut.IgnoreMounts)&&(v=fc.get(p))&&!v.overlay)return new si(v.tree,m,e,a);let w=new si(p,m,e,a);return l&ut.IncludeAnonymous||!w.type.isAnonymous?w:w.nextChild(t<0?p.children.length-1:0,t,i,s,l)}}}if(l&ut.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,t,i=0){let s;if(!(i&ut.IgnoreOverlays)&&(s=fc.get(this._tree))&&s.overlay){let l=e-this.from,a=i&ut.EnterBracketed&&s.bracketed;for(let{from:c,to:h}of s.overlay)if((t>0||a?c<=l:c<l)&&(t<0||a?h>=l:h>l))return new si(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function M_(n,e,t,i){let s=n.cursor(),l=[];if(!s.firstChild())return l;if(t!=null){for(let a=!1;!a;)if(a=s.type.is(t),!s.nextSibling())return l}for(;;){if(i!=null&&s.type.is(i))return l;if(s.type.is(e)&&l.push(s.node),!s.nextSibling())return i==null?l:[]}}function Ny(n,e,t=e.length-1){for(let i=n;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class _z{constructor(e,t,i,s){this.parent=e,this.buffer=t,this.index=i,this.start=s}}class nr extends HT{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,i){super(),this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,t,i){let{buffer:s}=this.context,l=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.context.start,i);return l<0?null:new nr(this.context,this,l)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,t,i=0){if(i&ut.ExcludeBuffers)return null;let{buffer:s}=this.context,l=s.findChild(this.index+4,s.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return l<0?null:new nr(this.context,this,l)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new nr(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new nr(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,s=this.index+4,l=i.buffer[this.index+3];if(l>s){let a=i.buffer[this.index+1];e.push(i.slice(s,l,a)),t.push(0)}return new mt(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function qT(n){if(!n.length)return null;let e=0,t=n[0];for(let l=1;l<n.length;l++){let a=n[l];(a.from>t.from||a.to<t.to)&&(t=a,e=l)}let i=t instanceof si&&t.index<0?null:t.parent,s=n.slice();return i?s[e]=i:s.splice(e,1),new Oz(s,t)}class Oz{constructor(e,t){this.heads=e,this.node=t}get next(){return qT(this.heads)}}function Az(n,e,t){let i=n.resolveInner(e,t),s=null;for(let l=i instanceof si?i:i.context.parent;l;l=l.parent)if(l.index<0){let a=l.parent;(s||(s=[i])).push(a.resolve(e,t)),l=a}else{let a=fc.get(l.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let c=new si(a.tree,a.overlay[0].from+l.from,-1,l);(s||(s=[i])).push(Pc(c,e,t,!1))}}return s?qT(s):i}class Ly{get name(){return this.type.name}constructor(e,t=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=t&~ut.EnterBracketed,e instanceof si)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:s}=this.buffer;return this.type=t||s.set.types[s.buffer[e]],this.from=i+s.buffer[e+1],this.to=i+s.buffer[e+2],!0}yield(e){return e?e instanceof si?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:s}=this.buffer,l=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.buffer.start,i);return l<0?!1:(this.stack.push(this.index),this.yieldBuf(l))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&ut.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ut.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ut.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let s=i<0?0:this.stack[i]+4;if(this.index!=s)return this.yieldBuf(t.findChild(s,this.index,-1,0,4))}else{let s=t.buffer[this.index+3];if(s<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(s)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let l=0;l<this.index;l++)if(s.buffer.buffer[l+3]<this.index)return!1;({index:t,parent:i}=s)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let l=t+e,a=e<0?-1:i._tree.children.length;l!=a;l+=e){let c=i._tree.children[l];if(this.mode&ut.IncludeAnonymous||c instanceof cr||!c.type.isAnonymous||Vb(c))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let s=this.index,l=this.stack.length;l>=0;){for(let a=e;a;a=a._parent)if(a.index==s){if(s==this.index)return a;t=a,i=l+1;break e}s=this.stack[--l]}for(let s=i;s<this.stack.length;s++)t=new nr(this.buffer,t,this.stack[s]);return this.bufferNode=new nr(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&t&&t(this),s=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,s=!0}}}matchContext(e){if(!this.buffer)return Ny(this.node.parent,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let s=e.length-1,l=this.stack.length-1;s>=0;l--){if(l<0)return Ny(this._tree,e,s);let a=i[t.buffer[this.stack[l]]];if(!a.isAnonymous){if(e[s]&&e[s]!=a.name)return!1;s--}}return!0}}function Vb(n){return n.children.some(e=>e instanceof cr||!e.type.isAnonymous||Vb(e))}function Cz(n){var e;let{buffer:t,nodeSet:i,maxBufferLength:s=IT,reused:l=[],minRepeatType:a=i.types.length}=n,c=Array.isArray(t)?new qb(t,t.length):t,h=i.types,d=0,p=0;function m(B,z,D,W,ne,Ce){let{id:de,start:J,end:oe,size:Q}=c,ue=p,I=d;if(Q<0)if(c.next(),Q==-1){let T=l[de];D.push(T),W.push(J-B);return}else if(Q==-3){d=de;return}else if(Q==-4){p=de;return}else throw new RangeError(`Unrecognized record size: ${Q}`);let F=h[de],ae,ve,Te=J-B;if(oe-J<=s&&(ve=_(c.pos-z,ne))){let T=new Uint16Array(ve.size-ve.skip),V=c.pos-ve.size,Y=T.length;for(;c.pos>V;)Y=O(ve.start,T,Y);ae=new cr(T,oe-ve.start,i),Te=ve.start-B}else{let T=c.pos-Q;c.next();let V=[],Y=[],ie=de>=a?de:-1,ye=0,Se=oe;for(;c.pos>T;)ie>=0&&c.id==ie&&c.size>=0?(c.end<=Se-s&&(w(V,Y,J,ye,c.end,Se,ie,ue,I),ye=V.length,Se=c.end),c.next()):Ce>2500?b(J,T,V,Y):m(J,T,V,Y,ie,Ce+1);if(ie>=0&&ye>0&&ye<V.length&&w(V,Y,J,ye,J,Se,ie,ue,I),V.reverse(),Y.reverse(),ie>-1&&ye>0){let ze=v(F,I);ae=$b(F,V,Y,0,V.length,0,oe-J,ze,ze)}else ae=k(F,V,Y,oe-J,ue-oe,I)}D.push(ae),W.push(Te)}function b(B,z,D,W){let ne=[],Ce=0,de=-1;for(;c.pos>z;){let{id:J,start:oe,end:Q,size:ue}=c;if(ue>4)c.next();else{if(de>-1&&oe<de)break;de<0&&(de=Q-s),ne.push(J,oe,Q),Ce++,c.next()}}if(Ce){let J=new Uint16Array(Ce*4),oe=ne[ne.length-2];for(let Q=ne.length-3,ue=0;Q>=0;Q-=3)J[ue++]=ne[Q],J[ue++]=ne[Q+1]-oe,J[ue++]=ne[Q+2]-oe,J[ue++]=ue;D.push(new cr(J,ne[2]-oe,i)),W.push(oe-B)}}function v(B,z){return(D,W,ne)=>{let Ce=0,de=D.length-1,J,oe;if(de>=0&&(J=D[de])instanceof mt){if(!de&&J.type==B&&J.length==ne)return J;(oe=J.prop(Re.lookAhead))&&(Ce=W[de]+J.length+oe)}return k(B,D,W,ne,Ce,z)}}function w(B,z,D,W,ne,Ce,de,J,oe){let Q=[],ue=[];for(;B.length>W;)Q.push(B.pop()),ue.push(z.pop()+D-ne);B.push(k(i.types[de],Q,ue,Ce-ne,J-Ce,oe)),z.push(ne-D)}function k(B,z,D,W,ne,Ce,de){if(Ce){let J=[Re.contextHash,Ce];de=de?[J].concat(de):[J]}if(ne>25){let J=[Re.lookAhead,ne];de=de?[J].concat(de):[J]}return new mt(B,z,D,W,de)}function _(B,z){let D=c.fork(),W=0,ne=0,Ce=0,de=D.end-s,J={size:0,start:0,skip:0};e:for(let oe=D.pos-B;D.pos>oe;){let Q=D.size;if(D.id==z&&Q>=0){J.size=W,J.start=ne,J.skip=Ce,Ce+=4,W+=4,D.next();continue}let ue=D.pos-Q;if(Q<0||ue<oe||D.start<de)break;let I=D.id>=a?4:0,F=D.start;for(D.next();D.pos>ue;){if(D.size<0)if(D.size==-3||D.size==-4)I+=4;else break e;else D.id>=a&&(I+=4);D.next()}ne=F,W+=Q,Ce+=I}return(z<0||W==B)&&(J.size=W,J.start=ne,J.skip=Ce),J.size>4?J:void 0}function O(B,z,D){let{id:W,start:ne,end:Ce,size:de}=c;if(c.next(),de>=0&&W<a){let J=D;if(de>4){let oe=c.pos-(de-4);for(;c.pos>oe;)D=O(B,z,D)}z[--D]=J,z[--D]=Ce-B,z[--D]=ne-B,z[--D]=W}else de==-3?d=W:de==-4&&(p=W);return D}let R=[],C=[];for(;c.pos>0;)m(n.start||0,n.bufferStart||0,R,C,-1,0);let U=(e=n.length)!==null&&e!==void 0?e:R.length?C[0]+R[0].length:0;return new mt(h[n.topID],R.reverse(),C.reverse(),U)}const N_=new WeakMap;function Sf(n,e){if(!n.isAnonymous||e instanceof cr||e.type!=n)return 1;let t=N_.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=n||!(i instanceof mt)){t=1;break}t+=Sf(n,i)}N_.set(e,t)}return t}function $b(n,e,t,i,s,l,a,c,h){let d=0;for(let w=i;w<s;w++)d+=Sf(n,e[w]);let p=Math.ceil(d*1.5/8),m=[],b=[];function v(w,k,_,O,R){for(let C=_;C<O;){let U=C,B=k[C],z=Sf(n,w[C]);for(C++;C<O;C++){let D=Sf(n,w[C]);if(z+D>=p)break;z+=D}if(C==U+1){if(z>p){let D=w[U];v(D.children,D.positions,0,D.children.length,k[U]+R);continue}m.push(w[U])}else{let D=k[C-1]+w[C-1].length-B;m.push($b(n,w,k,U,C,B,D,null,h))}b.push(B+R-l)}}return v(e,t,i,s,0),(c||h)(m,b,a)}class Fr{constructor(e,t,i,s,l=!1,a=!1){this.from=e,this.to=t,this.tree=i,this.offset=s,this.open=(l?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let s=[new Fr(0,e.length,e,0,!1,i)];for(let l of t)l.to>e.length&&s.push(l);return s}static applyChanges(e,t,i=128){if(!t.length)return e;let s=[],l=1,a=e.length?e[0]:null;for(let c=0,h=0,d=0;;c++){let p=c<t.length?t[c]:null,m=p?p.fromA:1e9;if(m-h>=i)for(;a&&a.from<m;){let b=a;if(h>=b.from||m<=b.to||d){let v=Math.max(b.from,h)-d,w=Math.min(b.to,m)-d;b=v>=w?null:new Fr(v,w,b.tree,b.offset+d,c>0,!!p)}if(b&&s.push(b),a.to>m)break;a=l<e.length?e[l++]:null}if(!p)break;h=p.toA,d=p.toA-p.toB}return s}}class VT{startParse(e,t,i){return typeof e=="string"&&(e=new Tz(e)),i=i?i.length?i.map(s=>new d0(s.from,s.to)):[new d0(0,0)]:[new d0(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let s=this.startParse(e,t,i);for(;;){let l=s.advance();if(l)return l}}}class Tz{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Re({perNode:!0});let Ez=0;class Jn{constructor(e,t,i,s){this.name=e,this.set=t,this.base=i,this.modified=s,this.id=Ez++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let i=typeof e=="string"?e:"?";if(e instanceof Jn&&(t=e),t?.base)throw new Error("Can not derive from a modified tag");let s=new Jn(i,[],null,[]);if(s.set.push(s),t)for(let l of t.set)s.set.push(l);return s}static defineModifier(e){let t=new Qf(e);return i=>i.modified.indexOf(t)>-1?i:Qf.get(i.base||i,i.modified.concat(t).sort((s,l)=>s.id-l.id))}}let Dz=0;class Qf{constructor(e){this.name=e,this.instances=[],this.id=Dz++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(c=>c.base==e&&Rz(t,c.modified));if(i)return i;let s=[],l=new Jn(e.name,s,e,t);for(let c of t)c.instances.push(l);let a=Mz(t);for(let c of e.set)if(!c.modified.length)for(let h of a)s.push(Qf.get(c,h));return l}}function Rz(n,e){return n.length==e.length&&n.every((t,i)=>t==e[i])}function Mz(n){let e=[[]];for(let t=0;t<n.length;t++)for(let i=0,s=e.length;i<s;i++)e.push(e[i].concat(n[t]));return e.sort((t,i)=>i.length-t.length)}function Nz(n){let e=Object.create(null);for(let t in n){let i=n[t];Array.isArray(i)||(i=[i]);for(let s of t.split(" "))if(s){let l=[],a=2,c=s;for(let m=0;;){if(c=="..."&&m>0&&m+3==s.length){a=1;break}let b=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(c);if(!b)throw new RangeError("Invalid path: "+s);if(l.push(b[0]=="*"?"":b[0][0]=='"'?JSON.parse(b[0]):b[0]),m+=b[0].length,m==s.length)break;let v=s[m++];if(m==s.length&&v=="!"){a=0;break}if(v!="/")throw new RangeError("Invalid path: "+s);c=s.slice(m)}let h=l.length-1,d=l[h];if(!d)throw new RangeError("Invalid path: "+s);let p=new Hc(i,a,h>0?l.slice(0,h):null);e[d]=p.sort(e[d])}}return $T.add(e)}const $T=new Re({combine(n,e){let t,i,s;for(;n||e;){if(!n||e&&n.depth>=e.depth?(s=e,e=e.next):(s=n,n=n.next),t&&t.mode==s.mode&&!s.context&&!t.context)continue;let l=new Hc(s.tags,s.mode,s.context);t?t.next=l:i=l,t=l}return i}});class Hc{constructor(e,t,i,s){this.tags=e,this.mode=t,this.context=i,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Hc.empty=new Hc([],2,null);function GT(n,e){let t=Object.create(null);for(let l of n)if(!Array.isArray(l.tag))t[l.tag.id]=l.class;else for(let a of l.tag)t[a.id]=l.class;let{scope:i,all:s=null}=e||{};return{style:l=>{let a=s;for(let c of l)for(let h of c.set){let d=t[h.id];if(d){a=a?a+" "+d:d;break}}return a},scope:i}}function Lz(n,e){let t=null;for(let i of n){let s=i.style(e);s&&(t=t?t+" "+s:s)}return t}function Bz(n,e,t,i=0,s=n.length){let l=new jz(i,Array.isArray(e)?e:[e],t);l.highlightRange(n.cursor(),i,s,"",l.highlighters),l.flush(s)}class jz{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,s,l){let{type:a,from:c,to:h}=e;if(c>=i||h<=t)return;a.isTop&&(l=this.highlighters.filter(v=>!v.scope||v.scope(a)));let d=s,p=Uz(e)||Hc.empty,m=Lz(l,p.tags);if(m&&(d&&(d+=" "),d+=m,p.mode==1&&(s+=(s?" ":"")+m)),this.startSpan(Math.max(t,c),d),p.opaque)return;let b=e.tree&&e.tree.prop(Re.mounted);if(b&&b.overlay){let v=e.node.enter(b.overlay[0].from+c,1),w=this.highlighters.filter(_=>!_.scope||_.scope(b.tree.type)),k=e.firstChild();for(let _=0,O=c;;_++){let R=_<b.overlay.length?b.overlay[_]:null,C=R?R.from+c:h,U=Math.max(t,O),B=Math.min(i,C);if(U<B&&k)for(;e.from<B&&(this.highlightRange(e,U,B,s,l),this.startSpan(Math.min(B,e.to),d),!(e.to>=C||!e.nextSibling())););if(!R||C>i)break;O=R.to+c,O>t&&(this.highlightRange(v.cursor(),Math.max(t,R.from+c),Math.min(i,O),"",w),this.startSpan(Math.min(i,O),d))}k&&e.parent()}else if(e.firstChild()){b&&(s="");do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,s,l),this.startSpan(Math.min(i,e.to),d)}while(e.nextSibling());e.parent()}}}function Uz(n){let e=n.type.prop($T);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const X=Jn.define,ef=X(),Ys=X(),L_=X(Ys),B_=X(Ys),Xs=X(),tf=X(Xs),p0=X(Xs),Mi=X(),Lr=X(Mi),Di=X(),Ri=X(),By=X(),Fa=X(By),nf=X(),Z={comment:ef,lineComment:X(ef),blockComment:X(ef),docComment:X(ef),name:Ys,variableName:X(Ys),typeName:L_,tagName:X(L_),propertyName:B_,attributeName:X(B_),className:X(Ys),labelName:X(Ys),namespace:X(Ys),macroName:X(Ys),literal:Xs,string:tf,docString:X(tf),character:X(tf),attributeValue:X(tf),number:p0,integer:X(p0),float:X(p0),bool:X(Xs),regexp:X(Xs),escape:X(Xs),color:X(Xs),url:X(Xs),keyword:Di,self:X(Di),null:X(Di),atom:X(Di),unit:X(Di),modifier:X(Di),operatorKeyword:X(Di),controlKeyword:X(Di),definitionKeyword:X(Di),moduleKeyword:X(Di),operator:Ri,derefOperator:X(Ri),arithmeticOperator:X(Ri),logicOperator:X(Ri),bitwiseOperator:X(Ri),compareOperator:X(Ri),updateOperator:X(Ri),definitionOperator:X(Ri),typeOperator:X(Ri),controlOperator:X(Ri),punctuation:By,separator:X(By),bracket:Fa,angleBracket:X(Fa),squareBracket:X(Fa),paren:X(Fa),brace:X(Fa),content:Mi,heading:Lr,heading1:X(Lr),heading2:X(Lr),heading3:X(Lr),heading4:X(Lr),heading5:X(Lr),heading6:X(Lr),contentSeparator:X(Mi),list:X(Mi),quote:X(Mi),emphasis:X(Mi),strong:X(Mi),link:X(Mi),monospace:X(Mi),strikethrough:X(Mi),inserted:X(),deleted:X(),changed:X(),invalid:X(),meta:nf,documentMeta:X(nf),annotation:X(nf),processingInstruction:X(nf),definition:Jn.defineModifier("definition"),constant:Jn.defineModifier("constant"),function:Jn.defineModifier("function"),standard:Jn.defineModifier("standard"),local:Jn.defineModifier("local"),special:Jn.defineModifier("special")};for(let n in Z){let e=Z[n];e instanceof Jn&&(e.name=n)}GT([{tag:Z.link,class:"tok-link"},{tag:Z.heading,class:"tok-heading"},{tag:Z.emphasis,class:"tok-emphasis"},{tag:Z.strong,class:"tok-strong"},{tag:Z.keyword,class:"tok-keyword"},{tag:Z.atom,class:"tok-atom"},{tag:Z.bool,class:"tok-bool"},{tag:Z.url,class:"tok-url"},{tag:Z.labelName,class:"tok-labelName"},{tag:Z.inserted,class:"tok-inserted"},{tag:Z.deleted,class:"tok-deleted"},{tag:Z.literal,class:"tok-literal"},{tag:Z.string,class:"tok-string"},{tag:Z.number,class:"tok-number"},{tag:[Z.regexp,Z.escape,Z.special(Z.string)],class:"tok-string2"},{tag:Z.variableName,class:"tok-variableName"},{tag:Z.local(Z.variableName),class:"tok-variableName tok-local"},{tag:Z.definition(Z.variableName),class:"tok-variableName tok-definition"},{tag:Z.special(Z.variableName),class:"tok-variableName2"},{tag:Z.definition(Z.propertyName),class:"tok-propertyName tok-definition"},{tag:Z.typeName,class:"tok-typeName"},{tag:Z.namespace,class:"tok-namespace"},{tag:Z.className,class:"tok-className"},{tag:Z.macroName,class:"tok-macroName"},{tag:Z.propertyName,class:"tok-propertyName"},{tag:Z.operator,class:"tok-operator"},{tag:Z.comment,class:"tok-comment"},{tag:Z.meta,class:"tok-meta"},{tag:Z.invalid,class:"tok-invalid"},{tag:Z.punctuation,class:"tok-punctuation"}]);var g0;const uo=new Re;function zz(n){return te.define({combine:n?e=>e.concat(n):void 0})}const Iz=new Re;class yi{constructor(e,t,i=[],s=""){this.data=e,this.name=s,Ue.prototype.hasOwnProperty("tree")||Object.defineProperty(Ue.prototype,"tree",{get(){return Kt(this)}}),this.parser=t,this.extension=[ur.of(this),Ue.languageData.of((l,a,c)=>{let h=j_(l,a,c),d=h.type.prop(uo);if(!d)return[];let p=l.facet(d),m=h.type.prop(Iz);if(m){let b=h.resolve(a-h.from,c);for(let v of m)if(v.test(b,l)){let w=l.facet(v.facet);return v.type=="replace"?w:w.concat(p)}}return p})].concat(i)}isActiveAt(e,t,i=-1){return j_(e,t,i).type.prop(uo)==this.data}findRegions(e){let t=e.facet(ur);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],s=(l,a)=>{if(l.prop(uo)==this.data){i.push({from:a,to:a+l.length});return}let c=l.prop(Re.mounted);if(c){if(c.tree.prop(uo)==this.data){if(c.overlay)for(let h of c.overlay)i.push({from:h.from+a,to:h.to+a});else i.push({from:a,to:a+l.length});return}else if(c.overlay){let h=i.length;if(s(c.tree,c.overlay[0].from+a),i.length>h)return}}for(let h=0;h<l.children.length;h++){let d=l.children[h];d instanceof mt&&s(d,l.positions[h]+a)}};return s(Kt(e),0),i}get allowsNesting(){return!0}}yi.setState=_e.define();function j_(n,e,t){let i=n.facet(ur),s=Kt(n).topNode;if(!i||i.allowsNesting)for(let l=s;l;l=l.enter(e,t,ut.ExcludeBuffers|ut.EnterBracketed))l.type.isTop&&(s=l);return s}class Jf extends yi{constructor(e,t,i){super(e,t,[],i),this.parser=t}static define(e){let t=zz(e.languageData);return new Jf(t,e.parser.configure({props:[uo.add(i=>i.isTop?t:void 0)]}),e.name)}configure(e,t){return new Jf(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Kt(n){let e=n.field(yi.state,!1);return e?e.tree:mt.empty}class Pz{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let Ya=null;class Zf{constructor(e,t,i=[],s,l,a,c,h){this.parser=e,this.state=t,this.fragments=i,this.tree=s,this.treeLen=l,this.viewport=a,this.skipped=c,this.scheduleOn=h,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new Zf(e,t,[],mt.empty,0,i,[],null)}startParse(){return this.parser.startParse(new Pz(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=mt.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(Fr.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Fr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Ya;Ya=this;try{return e()}finally{Ya=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=U_(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:s,treeLen:l,viewport:a,skipped:c}=this;if(this.takeTree(),!e.empty){let h=[];if(e.iterChangedRanges((d,p,m,b)=>h.push({fromA:d,toA:p,fromB:m,toB:b})),i=Fr.applyChanges(i,h),s=mt.empty,l=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){c=[];for(let d of this.skipped){let p=e.mapPos(d.from,1),m=e.mapPos(d.to,-1);p<m&&c.push({from:p,to:m})}}}return new Zf(this.parser,t,i,s,l,a,c,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:s,to:l}=this.skipped[i];s<e.to&&l>e.from&&(this.fragments=U_(this.fragments,s,l),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends VT{createParse(t,i,s){let l=s[0].from,a=s[s.length-1].to;return{parsedPos:l,advance(){let h=Ya;if(h){for(let d of s)h.tempSkipped.push(d);e&&(h.scheduleOn=h.scheduleOn?Promise.all([h.scheduleOn,e]):e)}return this.parsedPos=a,new mt(vn.none,[],[],a-l)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Ya}}function U_(n,e,t){return Fr.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Io{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new Io(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=Zf.create(e.facet(ur).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new Io(i)}}yi.state=Wt.define({create:Io.init,update(n,e){for(let t of e.effects)if(t.is(yi.setState))return t.value;return e.startState.facet(ur)!=e.state.facet(ur)?Io.init(e.state):n.apply(e)}});let KT=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(KT=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const m0=typeof navigator<"u"&&(!((g0=navigator.scheduling)===null||g0===void 0)&&g0.isInputPending)?()=>navigator.scheduling.isInputPending():null,Hz=lt.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(yi.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(yi.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=KT(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:s}}=this.view,l=i.field(yi.state);if(l.tree==l.context.tree&&l.context.isDone(s+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!m0?Math.max(25,e.timeRemaining()-5):1e9),c=l.context.treeLen<s&&i.doc.length>s+1e3,h=l.context.work(()=>m0&&m0()||Date.now()>a,s+(c?0:1e5));this.chunkBudget-=Date.now()-t,(h||this.chunkBudget<=0)&&(l.context.takeTree(),this.view.dispatch({effects:yi.setState.of(new Io(l.context))})),this.chunkBudget>0&&!(h&&!c)&&this.scheduleWork(),this.checkAsyncSchedule(l.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>mn(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),ur=te.define({combine(n){return n.length?n[0]:null},enables:n=>[yi.state,Hz,ee.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]}),qz=te.define(),Gb=te.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function ed(n){let e=n.facet(Gb);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function qc(n,e){let t="",i=n.tabSize,s=n.facet(Gb)[0];if(s=="	"){for(;e>=i;)t+="	",e-=i;s=" "}for(let l=0;l<e;l++)t+=s;return t}function Kb(n,e){n instanceof Ue&&(n=new Ud(n));for(let i of n.state.facet(qz)){let s=i(n,e);if(s!==void 0)return s}let t=Kt(n.state);return t.length>=e?$z(n,t,e):null}class Ud{constructor(e,t={}){this.state=e,this.options=t,this.unit=ed(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:l}=this.options;return s!=null&&s>=i.from&&s<=i.to?l&&s==e?{text:"",from:e}:(t<0?s<e:s<=e)?{text:i.text.slice(s-i.from),from:s}:{text:i.text.slice(0,s-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:s}=this.lineAt(e,t);return i.slice(e-s,Math.min(i.length,e+100-s))}column(e,t=1){let{text:i,from:s}=this.lineAt(e,t),l=this.countColumn(i,e-s),a=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return a>-1&&(l+=a-this.countColumn(i,i.search(/\S|$/))),l}countColumn(e,t=e.length){return Wo(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:s}=this.lineAt(e,t),l=this.options.overrideIndentation;if(l){let a=l(s);if(a>-1)return a}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Vz=new Re;function $z(n,e,t){let i=e.resolveStack(t),s=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(s!=i.node){let l=[];for(let a=s;a&&!(a.from<i.node.from||a.to>i.node.to||a.from==i.node.from&&a.type==i.node.type);a=a.parent)l.push(a);for(let a=l.length-1;a>=0;a--)i={node:l[a],next:i}}return WT(i,n,t)}function WT(n,e,t){for(let i=n;i;i=i.next){let s=Kz(i.node);if(s)return s(Wb.create(e,t,i))}return 0}function Gz(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function Kz(n){let e=n.type.prop(Vz);if(e)return e;let t=n.firstChild,i;if(t&&(i=t.type.prop(Re.closedBy))){let s=n.lastChild,l=s&&i.indexOf(s.name)>-1;return a=>Xz(a,!0,1,void 0,l&&!Gz(a)?s.from:void 0)}return n.parent==null?Wz:null}function Wz(){return 0}class Wb extends Ud{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.context=i}get node(){return this.context.node}static create(e,t,i){return new Wb(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(t.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(Fz(i,e))break;t=this.state.doc.lineAt(i.from)}return this.lineIndent(t.from)}continue(){return WT(this.context.next,this.base,this.pos)}}function Fz(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function Yz(n){let e=n.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let s=n.options.simulateBreak,l=n.state.doc.lineAt(t.from),a=s==null||s<=l.from?l.to:Math.min(l.to,s);for(let c=t.to;;){let h=e.childAfter(c);if(!h||h==i)return null;if(!h.type.isSkipped){if(h.from>=a)return null;let d=/^ */.exec(l.text.slice(t.to-l.from))[0].length;return{from:t.from,to:t.to+d}}c=h.to}}function Xz(n,e,t,i,s){let l=n.textAfter,a=l.match(/^\s*/)[0].length,c=i&&l.slice(a,a+i.length)==i||s==n.pos+a,h=Yz(n);return h?c?n.column(h.from):n.column(h.to):n.baseIndent+(c?0:n.unit*t)}const Qz=200;function Jz(){return Ue.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:i}=n.newSelection.main,s=t.lineAt(i);if(i>s.from+Qz)return n;let l=t.sliceString(s.from,i);if(!e.some(d=>d.test(l)))return n;let{state:a}=n,c=-1,h=[];for(let{head:d}of a.selection.ranges){let p=a.doc.lineAt(d);if(p.from==c)continue;c=p.from;let m=Kb(a,p.from);if(m==null)continue;let b=/^\s*/.exec(p.text)[0],v=qc(a,m);b!=v&&h.push({from:p.from,to:p.from+b.length,insert:v})}return h.length?[n,{changes:h,sequential:!0}]:n})}const Zz=te.define(),e5=new Re;function t5(n,e,t){let i=Kt(n);if(i.length<t)return null;let s=i.resolveStack(t,1),l=null;for(let a=s;a;a=a.next){let c=a.node;if(c.to<=t||c.from>t)continue;if(l&&c.from<e)break;let h=c.type.prop(e5);if(h&&(c.to<i.length-50||i.length==n.doc.length||!n5(c))){let d=h(c,n);d&&d.from<=t&&d.from>=e&&d.to>t&&(l=d)}}return l}function n5(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function td(n,e,t){for(let i of n.facet(Zz)){let s=i(n,e,t);if(s)return s}return t5(n,e,t)}function FT(n,e){let t=e.mapPos(n.from,1),i=e.mapPos(n.to,-1);return t>=i?void 0:{from:t,to:i}}const zd=_e.define({map:FT}),lu=_e.define({map:FT});function YT(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(i=>i.from<=t&&i.to>=t)||e.push(n.lineBlockAt(t));return e}const il=Wt.define({create(){return he.none},update(n,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((t,i)=>n=z_(n,t,i)),n=n.map(e.changes);for(let t of e.effects)if(t.is(zd)&&!i5(n,t.value.from,t.value.to)){let{preparePlaceholder:i}=e.state.facet(JT),s=i?he.replace({widget:new u5(i(e.state,t.value))}):I_;n=n.update({add:[s.range(t.value.from,t.value.to)]})}else t.is(lu)&&(n=n.update({filter:(i,s)=>t.value.from!=i||t.value.to!=s,filterFrom:t.value.from,filterTo:t.value.to}));return e.selection&&(n=z_(n,e.selection.main.head)),n},provide:n=>ee.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(i,s)=>{t.push(i,s)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let i=n[t++],s=n[t++];if(typeof i!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");e.push(I_.range(i,s))}return he.set(e,!0)}});function z_(n,e,t=e){let i=!1;return n.between(e,t,(s,l)=>{s<t&&l>e&&(i=!0)}),i?n.update({filterFrom:e,filterTo:t,filter:(s,l)=>s>=t||l<=e}):n}function nd(n,e,t){var i;let s=null;return(i=n.field(il,!1))===null||i===void 0||i.between(e,t,(l,a)=>{(!s||s.from>l)&&(s={from:l,to:a})}),s}function i5(n,e,t){let i=!1;return n.between(e,e,(s,l)=>{s==e&&l==t&&(i=!0)}),i}function XT(n,e){return n.field(il,!1)?e:e.concat(_e.appendConfig.of(ZT()))}const s5=n=>{for(let e of YT(n)){let t=td(n.state,e.from,e.to);if(t)return n.dispatch({effects:XT(n.state,[zd.of(t),QT(n,t)])}),!0}return!1},r5=n=>{if(!n.state.field(il,!1))return!1;let e=[];for(let t of YT(n)){let i=nd(n.state,t.from,t.to);i&&e.push(lu.of(i),QT(n,i,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function QT(n,e,t=!0){let i=n.state.doc.lineAt(e.from).number,s=n.state.doc.lineAt(e.to).number;return ee.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${i} ${n.state.phrase("to")} ${s}.`)}const l5=n=>{let{state:e}=n,t=[];for(let i=0;i<e.doc.length;){let s=n.lineBlockAt(i),l=td(e,s.from,s.to);l&&t.push(zd.of(l)),i=(l?n.lineBlockAt(l.to):s).to+1}return t.length&&n.dispatch({effects:XT(n.state,t)}),!!t.length},o5=n=>{let e=n.state.field(il,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(i,s)=>{t.push(lu.of({from:i,to:s}))}),n.dispatch({effects:t}),!0},a5=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:s5},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:r5},{key:"Ctrl-Alt-[",run:l5},{key:"Ctrl-Alt-]",run:o5}],c5={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},JT=te.define({combine(n){return Ki(n,c5)}});function ZT(n){return[il,d5]}function eE(n,e){let{state:t}=n,i=t.facet(JT),s=a=>{let c=n.lineBlockAt(n.posAtDOM(a.target)),h=nd(n.state,c.from,c.to);h&&n.dispatch({effects:lu.of(h)}),a.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(n,s,e);let l=document.createElement("span");return l.textContent=i.placeholderText,l.setAttribute("aria-label",t.phrase("folded code")),l.title=t.phrase("unfold"),l.className="cm-foldPlaceholder",l.onclick=s,l}const I_=he.replace({widget:new class extends Wi{toDOM(n){return eE(n,null)}}});class u5 extends Wi{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return eE(e,this.value)}}const h5={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class y0 extends vs{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function f5(n={}){let e={...h5,...n},t=new y0(e,!0),i=new y0(e,!1),s=lt.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(ur)!=a.state.facet(ur)||a.startState.field(il,!1)!=a.state.field(il,!1)||Kt(a.startState)!=Kt(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let c=new qi;for(let h of a.viewportLineBlocks){let d=nd(a.state,h.from,h.to)?i:td(a.state,h.from,h.to)?t:null;d&&c.add(h.from,h.from,d)}return c.finish()}}),{domEventHandlers:l}=e;return[s,rz({class:"cm-foldGutter",markers(a){var c;return((c=a.plugin(s))===null||c===void 0?void 0:c.markers)||De.empty},initialSpacer(){return new y0(e,!1)},domEventHandlers:{...l,click:(a,c,h)=>{if(l.click&&l.click(a,c,h))return!0;let d=nd(a.state,c.from,c.to);if(d)return a.dispatch({effects:lu.of(d)}),!0;let p=td(a.state,c.from,c.to);return p?(a.dispatch({effects:zd.of(p)}),!0):!1}}}),ZT()]}const d5=ee.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Id{constructor(e,t){this.specs=e;let i;function s(c){let h=lr.newName();return(i||(i=Object.create(null)))["."+h]=c,h}const l=typeof t.all=="string"?t.all:t.all?s(t.all):void 0,a=t.scope;this.scope=a instanceof yi?c=>c.prop(uo)==a.data:a?c=>c==a:void 0,this.style=GT(e.map(c=>({tag:c.tag,class:c.class||s(Object.assign({},c,{tag:null}))})),{all:l}).style,this.module=i?new lr(i):null,this.themeType=t.themeType}static define(e,t){return new Id(e,t||{})}}const jy=te.define(),tE=te.define({combine(n){return n.length?[n[0]]:null}});function b0(n){let e=n.facet(jy);return e.length?e:n.facet(tE)}function p5(n,e){let t=[m5],i;return n instanceof Id&&(n.module&&t.push(ee.styleModule.of(n.module)),i=n.themeType),e?.fallback?t.push(tE.of(n)):i?t.push(jy.computeN([ee.darkTheme],s=>s.facet(ee.darkTheme)==(i=="dark")?[n]:[])):t.push(jy.of(n)),t}class g5{constructor(e){this.markCache=Object.create(null),this.tree=Kt(e.state),this.decorations=this.buildDeco(e,b0(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Kt(e.state),i=b0(e.state),s=i!=b0(e.startState),{viewport:l}=e.view,a=e.changes.mapPos(this.decoratedTo,1);t.length<l.to&&!s&&t.type==this.tree.type&&a>=l.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(t!=this.tree||e.viewportChanged||s)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=l.to)}buildDeco(e,t){if(!t||!this.tree.length)return he.none;let i=new qi;for(let{from:s,to:l}of e.visibleRanges)Bz(this.tree,t,(a,c,h)=>{i.add(a,c,this.markCache[h]||(this.markCache[h]=he.mark({class:h})))},s,l);return i.finish()}}const m5=ol.high(lt.fromClass(g5,{decorations:n=>n.decorations})),y5=Id.define([{tag:Z.meta,color:"#404740"},{tag:Z.link,textDecoration:"underline"},{tag:Z.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Z.emphasis,fontStyle:"italic"},{tag:Z.strong,fontWeight:"bold"},{tag:Z.strikethrough,textDecoration:"line-through"},{tag:Z.keyword,color:"#708"},{tag:[Z.atom,Z.bool,Z.url,Z.contentSeparator,Z.labelName],color:"#219"},{tag:[Z.literal,Z.inserted],color:"#164"},{tag:[Z.string,Z.deleted],color:"#a11"},{tag:[Z.regexp,Z.escape,Z.special(Z.string)],color:"#e40"},{tag:Z.definition(Z.variableName),color:"#00f"},{tag:Z.local(Z.variableName),color:"#30a"},{tag:[Z.typeName,Z.namespace],color:"#085"},{tag:Z.className,color:"#167"},{tag:[Z.special(Z.variableName),Z.macroName],color:"#256"},{tag:Z.definition(Z.propertyName),color:"#00c"},{tag:Z.comment,color:"#940"},{tag:Z.invalid,color:"#f00"}]),b5=ee.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),nE=1e4,iE="()[]{}",sE=te.define({combine(n){return Ki(n,{afterCursor:!0,brackets:iE,maxScanDistance:nE,renderMatch:S5})}}),v5=he.mark({class:"cm-matchingBracket"}),w5=he.mark({class:"cm-nonmatchingBracket"});function S5(n){let e=[],t=n.matched?v5:w5;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const k5=Wt.define({create(){return he.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],i=e.state.facet(sE);for(let s of e.state.selection.ranges){if(!s.empty)continue;let l=ji(e.state,s.head,-1,i)||s.head>0&&ji(e.state,s.head-1,1,i)||i.afterCursor&&(ji(e.state,s.head,1,i)||s.head<e.state.doc.length&&ji(e.state,s.head+1,-1,i));l&&(t=t.concat(i.renderMatch(l,e.state)))}return he.set(t,!0)},provide:n=>ee.decorations.from(n)}),x5=[k5,b5];function _5(n={}){return[sE.of(n),x5]}const O5=new Re;function Uy(n,e,t){let i=n.prop(e<0?Re.openedBy:Re.closedBy);if(i)return i;if(n.name.length==1){let s=t.indexOf(n.name);if(s>-1&&s%2==(e<0?1:0))return[t[s+e]]}return null}function zy(n){let e=n.type.prop(O5);return e?e(n.node):n}function ji(n,e,t,i={}){let s=i.maxScanDistance||nE,l=i.brackets||iE,a=Kt(n),c=a.resolveInner(e,t);for(let h=c;h;h=h.parent){let d=Uy(h.type,t,l);if(d&&h.from<h.to){let p=zy(h);if(p&&(t>0?e>=p.from&&e<p.to:e>p.from&&e<=p.to))return A5(n,e,t,h,p,d,l)}}return C5(n,e,t,a,c.type,s,l)}function A5(n,e,t,i,s,l,a){let c=i.parent,h={from:s.from,to:s.to},d=0,p=c?.cursor();if(p&&(t<0?p.childBefore(i.from):p.childAfter(i.to)))do if(t<0?p.to<=i.from:p.from>=i.to){if(d==0&&l.indexOf(p.type.name)>-1&&p.from<p.to){let m=zy(p);return{start:h,end:m?{from:m.from,to:m.to}:void 0,matched:!0}}else if(Uy(p.type,t,a))d++;else if(Uy(p.type,-t,a)){if(d==0){let m=zy(p);return{start:h,end:m&&m.from<m.to?{from:m.from,to:m.to}:void 0,matched:!1}}d--}}while(t<0?p.prevSibling():p.nextSibling());return{start:h,matched:!1}}function C5(n,e,t,i,s,l,a){let c=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),h=a.indexOf(c);if(h<0||h%2==0!=t>0)return null;let d={from:t<0?e-1:e,to:t>0?e+1:e},p=n.doc.iterRange(e,t>0?n.doc.length:0),m=0;for(let b=0;!p.next().done&&b<=l;){let v=p.value;t<0&&(b+=v.length);let w=e+b*t;for(let k=t>0?0:v.length-1,_=t>0?v.length:-1;k!=_;k+=t){let O=a.indexOf(v[k]);if(!(O<0||i.resolveInner(w+k,1).type!=s))if(O%2==0==t>0)m++;else{if(m==1)return{start:d,end:{from:w+k,to:w+k+1},matched:O>>1==h>>1};m--}}t>0&&(b+=v.length)}return p.done?{start:d,matched:!1}:null}const T5=Object.create(null),P_=[vn.none],H_=[],q_=Object.create(null),E5=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])E5[n]=D5(T5,e);function v0(n,e){H_.indexOf(n)>-1||(H_.push(n),console.warn(e))}function D5(n,e){let t=[];for(let c of e.split(" ")){let h=[];for(let d of c.split(".")){let p=n[d]||Z[d];p?typeof p=="function"?h.length?h=h.map(p):v0(d,`Modifier ${d} used at start of tag`):h.length?v0(d,`Tag ${d} used as modifier`):h=Array.isArray(p)?p:[p]:v0(d,`Unknown highlighting tag ${d}`)}for(let d of h)t.push(d)}if(!t.length)return 0;let i=e.replace(/ /g,"_"),s=i+" "+t.map(c=>c.id),l=q_[s];if(l)return l.id;let a=q_[s]=vn.define({id:P_.length,name:i,props:[Nz({[i]:t})]});return P_.push(a),a.id}Ze.RTL,Ze.LTR;const R5=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),i=Yb(n.state,t.from);return i.line?M5(n):i.block?L5(n):!1};function Fb(n,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let s=n(e,t);return s?(i(t.update(s)),!0):!1}}const M5=Fb(U5,0),N5=Fb(rE,0),L5=Fb((n,e)=>rE(n,e,j5(e)),0);function Yb(n,e){let t=n.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const Xa=50;function B5(n,{open:e,close:t},i,s){let l=n.sliceDoc(i-Xa,i),a=n.sliceDoc(s,s+Xa),c=/\s*$/.exec(l)[0].length,h=/^\s*/.exec(a)[0].length,d=l.length-c;if(l.slice(d-e.length,d)==e&&a.slice(h,h+t.length)==t)return{open:{pos:i-c,margin:c&&1},close:{pos:s+h,margin:h&&1}};let p,m;s-i<=2*Xa?p=m=n.sliceDoc(i,s):(p=n.sliceDoc(i,i+Xa),m=n.sliceDoc(s-Xa,s));let b=/^\s*/.exec(p)[0].length,v=/\s*$/.exec(m)[0].length,w=m.length-v-t.length;return p.slice(b,b+e.length)==e&&m.slice(w,w+t.length)==t?{open:{pos:i+b+e.length,margin:/\s/.test(p.charAt(b+e.length))?1:0},close:{pos:s-v-t.length,margin:/\s/.test(m.charAt(w-1))?1:0}}:null}function j5(n){let e=[];for(let t of n.selection.ranges){let i=n.doc.lineAt(t.from),s=t.to<=i.to?i:n.doc.lineAt(t.to);s.from>i.from&&s.from==t.to&&(s=t.to==i.to+1?i:n.doc.lineAt(t.to-1));let l=e.length-1;l>=0&&e[l].to>i.from?e[l].to=s.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:s.to})}return e}function rE(n,e,t=e.selection.ranges){let i=t.map(l=>Yb(e,l.from).block);if(!i.every(l=>l))return null;let s=t.map((l,a)=>B5(e,i[a],l.from,l.to));if(n!=2&&!s.every(l=>l))return{changes:e.changes(t.map((l,a)=>s[a]?[]:[{from:l.from,insert:i[a].open+" "},{from:l.to,insert:" "+i[a].close}]))};if(n!=1&&s.some(l=>l)){let l=[];for(let a=0,c;a<s.length;a++)if(c=s[a]){let h=i[a],{open:d,close:p}=c;l.push({from:d.pos-h.open.length,to:d.pos+d.margin},{from:p.pos-p.margin,to:p.pos+h.close.length})}return{changes:l}}return null}function U5(n,e,t=e.selection.ranges){let i=[],s=-1;for(let{from:l,to:a}of t){let c=i.length,h=1e9,d=Yb(e,l).line;if(d){for(let p=l;p<=a;){let m=e.doc.lineAt(p);if(m.from>s&&(l==a||a>m.from)){s=m.from;let b=/^\s*/.exec(m.text)[0].length,v=b==m.length,w=m.text.slice(b,b+d.length)==d?b:-1;b<m.text.length&&b<h&&(h=b),i.push({line:m,comment:w,token:d,indent:b,empty:v,single:!1})}p=m.to+1}if(h<1e9)for(let p=c;p<i.length;p++)i[p].indent<i[p].line.text.length&&(i[p].indent=h);i.length==c+1&&(i[c].single=!0)}}if(n!=2&&i.some(l=>l.comment<0&&(!l.empty||l.single))){let l=[];for(let{line:c,token:h,indent:d,empty:p,single:m}of i)(m||!p)&&l.push({from:c.from+d,insert:h+" "});let a=e.changes(l);return{changes:a,selection:e.selection.map(a,1)}}else if(n!=1&&i.some(l=>l.comment>=0)){let l=[];for(let{line:a,comment:c,token:h}of i)if(c>=0){let d=a.from+c,p=d+h.length;a.text[p-a.from]==" "&&p++,l.push({from:d,to:p})}return{changes:l}}return null}const Iy=Si.define(),z5=Si.define(),I5=te.define(),lE=te.define({combine(n){return Ki(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(i,s)=>e(i,s)||t(i,s)})}}),oE=Wt.define({create(){return Ui.empty},update(n,e){let t=e.state.facet(lE),i=e.annotation(Iy);if(i){let h=yn.fromTransaction(e,i.selection),d=i.side,p=d==0?n.undone:n.done;return h?p=id(p,p.length,t.minDepth,h):p=uE(p,e.startState.selection),new Ui(d==0?i.rest:p,d==0?p:i.rest)}let s=e.annotation(z5);if((s=="full"||s=="before")&&(n=n.isolate()),e.annotation(Tt.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let l=yn.fromTransaction(e),a=e.annotation(Tt.time),c=e.annotation(Tt.userEvent);return l?n=n.addChanges(l,a,c,t,e):e.selection&&(n=n.addSelection(e.startState.selection,a,c,t.newGroupDelay)),(s=="full"||s=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Ui(n.done.map(yn.fromJSON),n.undone.map(yn.fromJSON))}});function P5(n={}){return[oE,lE.of(n),ee.domEventHandlers({beforeinput(e,t){let i=e.inputType=="historyUndo"?aE:e.inputType=="historyRedo"?Py:null;return i?(e.preventDefault(),i(t)):!1}})]}function Pd(n,e){return function({state:t,dispatch:i}){if(!e&&t.readOnly)return!1;let s=t.field(oE,!1);if(!s)return!1;let l=s.pop(n,t,e);return l?(i(l),!0):!1}}const aE=Pd(0,!1),Py=Pd(1,!1),H5=Pd(0,!0),q5=Pd(1,!0);class yn{constructor(e,t,i,s,l){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=s,this.selectionsAfter=l}setSelAfter(e){return new yn(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(e){return new yn(e.changes&&At.fromJSON(e.changes),[],e.mapped&&zi.fromJSON(e.mapped),e.startSelection&&G.fromJSON(e.startSelection),e.selectionsAfter.map(G.fromJSON))}static fromTransaction(e,t){let i=ni;for(let s of e.startState.facet(I5)){let l=s(e);l.length&&(i=i.concat(l))}return!i.length&&e.changes.empty?null:new yn(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,ni)}static selection(e){return new yn(void 0,ni,void 0,void 0,e)}}function id(n,e,t,i){let s=e+1>t+20?e-t-1:0,l=n.slice(s,e);return l.push(i),l}function V5(n,e){let t=[],i=!1;return n.iterChangedRanges((s,l)=>t.push(s,l)),e.iterChangedRanges((s,l,a,c)=>{for(let h=0;h<t.length;){let d=t[h++],p=t[h++];c>=d&&a<=p&&(i=!0)}}),i}function $5(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,i)=>t.empty!=e.ranges[i].empty).length===0}function cE(n,e){return n.length?e.length?n.concat(e):n:e}const ni=[],G5=200;function uE(n,e){if(n.length){let t=n[n.length-1],i=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-G5));return i.length&&i[i.length-1].eq(e)?n:(i.push(e),id(n,n.length-1,1e9,t.setSelAfter(i)))}else return[yn.selection([e])]}function K5(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function w0(n,e){if(!n.length)return n;let t=n.length,i=ni;for(;t;){let s=W5(n[t-1],e,i);if(s.changes&&!s.changes.empty||s.effects.length){let l=n.slice(0,t);return l[t-1]=s,l}else e=s.mapped,t--,i=s.selectionsAfter}return i.length?[yn.selection(i)]:ni}function W5(n,e,t){let i=cE(n.selectionsAfter.length?n.selectionsAfter.map(c=>c.map(e)):ni,t);if(!n.changes)return yn.selection(i);let s=n.changes.map(e),l=e.mapDesc(n.changes,!0),a=n.mapped?n.mapped.composeDesc(l):l;return new yn(s,_e.mapEffects(n.effects,e),a,n.startSelection.map(l),i)}const F5=/^(input\.type|delete)($|\.)/;class Ui{constructor(e,t,i=0,s=void 0){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=s}isolate(){return this.prevTime?new Ui(this.done,this.undone):this}addChanges(e,t,i,s,l){let a=this.done,c=a[a.length-1];return c&&c.changes&&!c.changes.empty&&e.changes&&(!i||F5.test(i))&&(!c.selectionsAfter.length&&t-this.prevTime<s.newGroupDelay&&s.joinToEvent(l,V5(c.changes,e.changes))||i=="input.type.compose")?a=id(a,a.length-1,s.minDepth,new yn(e.changes.compose(c.changes),cE(_e.mapEffects(e.effects,c.changes),c.effects),c.mapped,c.startSelection,ni)):a=id(a,a.length,s.minDepth,e),new Ui(a,ni,t,i)}addSelection(e,t,i,s){let l=this.done.length?this.done[this.done.length-1].selectionsAfter:ni;return l.length>0&&t-this.prevTime<s&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&$5(l[l.length-1],e)?this:new Ui(uE(this.done,e),this.undone,t,i)}addMapping(e){return new Ui(w0(this.done,e),w0(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let s=e==0?this.done:this.undone;if(s.length==0)return null;let l=s[s.length-1],a=l.selectionsAfter[0]||t.selection;if(i&&l.selectionsAfter.length)return t.update({selection:l.selectionsAfter[l.selectionsAfter.length-1],annotations:Iy.of({side:e,rest:K5(s),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(l.changes){let c=s.length==1?ni:s.slice(0,s.length-1);return l.mapped&&(c=w0(c,l.mapped)),t.update({changes:l.changes,selection:l.startSelection,effects:l.effects,annotations:Iy.of({side:e,rest:c,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Ui.empty=new Ui(ni,ni);const Y5=[{key:"Mod-z",run:aE,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Py,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Py,preventDefault:!0},{key:"Mod-u",run:H5,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:q5,preventDefault:!0}];function Fo(n,e){return G.create(n.ranges.map(e),n.mainIndex)}function ki(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function xi({state:n,dispatch:e},t){let i=Fo(n.selection,t);return i.eq(n.selection,!0)?!1:(e(ki(n,i)),!0)}function Hd(n,e){return G.cursor(e?n.to:n.from)}function hE(n,e){return xi(n,t=>t.empty?n.moveByChar(t,e):Hd(t,e))}function Qt(n){return n.textDirectionAt(n.state.selection.main.head)==Ze.LTR}const fE=n=>hE(n,!Qt(n)),dE=n=>hE(n,Qt(n));function pE(n,e){return xi(n,t=>t.empty?n.moveByGroup(t,e):Hd(t,e))}const X5=n=>pE(n,!Qt(n)),Q5=n=>pE(n,Qt(n));function J5(n,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function qd(n,e,t){let i=Kt(n).resolveInner(e.head),s=t?Re.closedBy:Re.openedBy;for(let h=e.head;;){let d=t?i.childAfter(h):i.childBefore(h);if(!d)break;J5(n,d,s)?i=d:h=t?d.to:d.from}let l=i.type.prop(s),a,c;return l&&(a=t?ji(n,i.from,1):ji(n,i.to,-1))&&a.matched?c=t?a.end.to:a.end.from:c=t?i.to:i.from,G.cursor(c,t?-1:1)}const Z5=n=>xi(n,e=>qd(n.state,e,!Qt(n))),e6=n=>xi(n,e=>qd(n.state,e,Qt(n)));function gE(n,e){return xi(n,t=>{if(!t.empty)return Hd(t,e);let i=n.moveVertically(t,e);return i.head!=t.head?i:n.moveToLineBoundary(t,e)})}const mE=n=>gE(n,!1),yE=n=>gE(n,!0);function bE(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,i=0,s;if(e){for(let l of n.state.facet(ee.scrollMargins)){let a=l(n);a?.top&&(t=Math.max(a?.top,t)),a?.bottom&&(i=Math.max(a?.bottom,i))}s=n.scrollDOM.clientHeight-t-i}else s=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:i,selfScroll:e,height:Math.max(n.defaultLineHeight,s-5)}}function vE(n,e){let t=bE(n),{state:i}=n,s=Fo(i.selection,a=>a.empty?n.moveVertically(a,e,t.height):Hd(a,e));if(s.eq(i.selection))return!1;let l;if(t.selfScroll){let a=n.coordsAtPos(i.selection.main.head),c=n.scrollDOM.getBoundingClientRect(),h=c.top+t.marginTop,d=c.bottom-t.marginBottom;a&&a.top>h&&a.bottom<d&&(l=ee.scrollIntoView(s.main.head,{y:"start",yMargin:a.top-h}))}return n.dispatch(ki(i,s),{effects:l}),!0}const V_=n=>vE(n,!1),Hy=n=>vE(n,!0);function fr(n,e,t){let i=n.lineBlockAt(e.head),s=n.moveToLineBoundary(e,t);if(s.head==e.head&&s.head!=(t?i.to:i.from)&&(s=n.moveToLineBoundary(e,t,!1)),!t&&s.head==i.from&&i.length){let l=/^\s*/.exec(n.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;l&&e.head!=i.from+l&&(s=G.cursor(i.from+l))}return s}const t6=n=>xi(n,e=>fr(n,e,!0)),n6=n=>xi(n,e=>fr(n,e,!1)),i6=n=>xi(n,e=>fr(n,e,!Qt(n))),s6=n=>xi(n,e=>fr(n,e,Qt(n))),r6=n=>xi(n,e=>G.cursor(n.lineBlockAt(e.head).from,1)),l6=n=>xi(n,e=>G.cursor(n.lineBlockAt(e.head).to,-1));function o6(n,e,t){let i=!1,s=Fo(n.selection,l=>{let a=ji(n,l.head,-1)||ji(n,l.head,1)||l.head>0&&ji(n,l.head-1,1)||l.head<n.doc.length&&ji(n,l.head+1,-1);if(!a||!a.end)return l;i=!0;let c=a.start.from==l.head?a.end.to:a.end.from;return G.cursor(c)});return i?(e(ki(n,s)),!0):!1}const a6=({state:n,dispatch:e})=>o6(n,e);function li(n,e){let t=Fo(n.state.selection,i=>{let s=e(i);return G.range(i.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(ki(n.state,t)),!0)}function wE(n,e){return li(n,t=>n.moveByChar(t,e))}const SE=n=>wE(n,!Qt(n)),kE=n=>wE(n,Qt(n));function xE(n,e){return li(n,t=>n.moveByGroup(t,e))}const c6=n=>xE(n,!Qt(n)),u6=n=>xE(n,Qt(n)),h6=n=>li(n,e=>qd(n.state,e,!Qt(n))),f6=n=>li(n,e=>qd(n.state,e,Qt(n)));function _E(n,e){return li(n,t=>n.moveVertically(t,e))}const OE=n=>_E(n,!1),AE=n=>_E(n,!0);function CE(n,e){return li(n,t=>n.moveVertically(t,e,bE(n).height))}const $_=n=>CE(n,!1),G_=n=>CE(n,!0),d6=n=>li(n,e=>fr(n,e,!0)),p6=n=>li(n,e=>fr(n,e,!1)),g6=n=>li(n,e=>fr(n,e,!Qt(n))),m6=n=>li(n,e=>fr(n,e,Qt(n))),y6=n=>li(n,e=>G.cursor(n.lineBlockAt(e.head).from)),b6=n=>li(n,e=>G.cursor(n.lineBlockAt(e.head).to)),K_=({state:n,dispatch:e})=>(e(ki(n,{anchor:0})),!0),W_=({state:n,dispatch:e})=>(e(ki(n,{anchor:n.doc.length})),!0),F_=({state:n,dispatch:e})=>(e(ki(n,{anchor:n.selection.main.anchor,head:0})),!0),Y_=({state:n,dispatch:e})=>(e(ki(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),v6=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),w6=({state:n,dispatch:e})=>{let t=Vd(n).map(({from:i,to:s})=>G.range(i,Math.min(s+1,n.doc.length)));return e(n.update({selection:G.create(t),userEvent:"select"})),!0},S6=({state:n,dispatch:e})=>{let t=Fo(n.selection,i=>{let s=Kt(n),l=s.resolveStack(i.from,1);if(i.empty){let a=s.resolveStack(i.from,-1);a.node.from>=l.node.from&&a.node.to<=l.node.to&&(l=a)}for(let a=l;a;a=a.next){let{node:c}=a;if((c.from<i.from&&c.to>=i.to||c.to>i.to&&c.from<=i.from)&&a.next)return G.range(c.to,c.from)}return i});return t.eq(n.selection)?!1:(e(ki(n,t)),!0)};function TE(n,e){let{state:t}=n,i=t.selection,s=t.selection.ranges.slice();for(let l of t.selection.ranges){let a=t.doc.lineAt(l.head);if(e?a.to<n.state.doc.length:a.from>0)for(let c=l;;){let h=n.moveVertically(c,e);if(h.head<a.from||h.head>a.to){s.some(d=>d.head==h.head)||s.push(h);break}else{if(h.head==c.head)break;c=h}}}return s.length==i.ranges.length?!1:(n.dispatch(ki(t,G.create(s,s.length-1))),!0)}const k6=n=>TE(n,!1),x6=n=>TE(n,!0),_6=({state:n,dispatch:e})=>{let t=n.selection,i=null;return t.ranges.length>1?i=G.create([t.main]):t.main.empty||(i=G.create([G.cursor(t.main.head)])),i?(e(ki(n,i)),!0):!1};function ou(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:i}=n,s=i.changeByRange(l=>{let{from:a,to:c}=l;if(a==c){let h=e(l);h<a?(t="delete.backward",h=sf(n,h,!1)):h>a&&(t="delete.forward",h=sf(n,h,!0)),a=Math.min(a,h),c=Math.max(c,h)}else a=sf(n,a,!1),c=sf(n,c,!0);return a==c?{range:l}:{changes:{from:a,to:c},range:G.cursor(a,a<l.head?-1:1)}});return s.changes.empty?!1:(n.dispatch(i.update(s,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?ee.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function sf(n,e,t){if(n instanceof ee)for(let i of n.state.facet(ee.atomicRanges).map(s=>s(n)))i.between(e,e,(s,l)=>{s<e&&l>e&&(e=t?l:s)});return e}const EE=(n,e,t)=>ou(n,i=>{let s=i.from,{state:l}=n,a=l.doc.lineAt(s),c,h;if(t&&!e&&s>a.from&&s<a.from+200&&!/[^ \t]/.test(c=a.text.slice(0,s-a.from))){if(c[c.length-1]=="	")return s-1;let d=Wo(c,l.tabSize),p=d%ed(l)||ed(l);for(let m=0;m<p&&c[c.length-1-m]==" ";m++)s--;h=s}else h=Ct(a.text,s-a.from,e,e)+a.from,h==s&&a.number!=(e?l.doc.lines:1)?h+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(h-a.from,s-a.from))&&(h=Ct(a.text,h-a.from,!1,!1)+a.from);return h}),qy=n=>EE(n,!1,!0),DE=n=>EE(n,!0,!1),RE=(n,e)=>ou(n,t=>{let i=t.head,{state:s}=n,l=s.doc.lineAt(i),a=s.charCategorizer(i);for(let c=null;;){if(i==(e?l.to:l.from)){i==t.head&&l.number!=(e?s.doc.lines:1)&&(i+=e?1:-1);break}let h=Ct(l.text,i-l.from,e)+l.from,d=l.text.slice(Math.min(i,h)-l.from,Math.max(i,h)-l.from),p=a(d);if(c!=null&&p!=c)break;(d!=" "||i!=t.head)&&(c=p),i=h}return i}),ME=n=>RE(n,!1),O6=n=>RE(n,!0),A6=n=>ou(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),C6=n=>ou(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),T6=n=>ou(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),E6=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:He.of(["",""])},range:G.cursor(i.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},D6=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>{if(!i.empty||i.from==0||i.from==n.doc.length)return{range:i};let s=i.from,l=n.doc.lineAt(s),a=s==l.from?s-1:Ct(l.text,s-l.from,!1)+l.from,c=s==l.to?s+1:Ct(l.text,s-l.from,!0)+l.from;return{changes:{from:a,to:c,insert:n.doc.slice(s,c).append(n.doc.slice(a,s))},range:G.cursor(c)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Vd(n){let e=[],t=-1;for(let i of n.selection.ranges){let s=n.doc.lineAt(i.from),l=n.doc.lineAt(i.to);if(!i.empty&&i.to==l.from&&(l=n.doc.lineAt(i.to-1)),t>=s.number){let a=e[e.length-1];a.to=l.to,a.ranges.push(i)}else e.push({from:s.from,to:l.to,ranges:[i]});t=l.number+1}return e}function NE(n,e,t){if(n.readOnly)return!1;let i=[],s=[];for(let l of Vd(n)){if(t?l.to==n.doc.length:l.from==0)continue;let a=n.doc.lineAt(t?l.to+1:l.from-1),c=a.length+1;if(t){i.push({from:l.to,to:a.to},{from:l.from,insert:a.text+n.lineBreak});for(let h of l.ranges)s.push(G.range(Math.min(n.doc.length,h.anchor+c),Math.min(n.doc.length,h.head+c)))}else{i.push({from:a.from,to:l.from},{from:l.to,insert:n.lineBreak+a.text});for(let h of l.ranges)s.push(G.range(h.anchor-c,h.head-c))}}return i.length?(e(n.update({changes:i,scrollIntoView:!0,selection:G.create(s,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const R6=({state:n,dispatch:e})=>NE(n,e,!1),M6=({state:n,dispatch:e})=>NE(n,e,!0);function LE(n,e,t){if(n.readOnly)return!1;let i=[];for(let l of Vd(n))t?i.push({from:l.from,insert:n.doc.slice(l.from,l.to)+n.lineBreak}):i.push({from:l.to,insert:n.lineBreak+n.doc.slice(l.from,l.to)});let s=n.changes(i);return e(n.update({changes:s,selection:n.selection.map(s,t?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const N6=({state:n,dispatch:e})=>LE(n,e,!1),L6=({state:n,dispatch:e})=>LE(n,e,!0),B6=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(Vd(e).map(({from:s,to:l})=>(s>0?s--:l<e.doc.length&&l++,{from:s,to:l}))),i=Fo(e.selection,s=>{let l;if(n.lineWrapping){let a=n.lineBlockAt(s.head),c=n.coordsAtPos(s.head,s.assoc||1);c&&(l=a.bottom+n.documentTop-c.bottom+n.defaultLineHeight/2)}return n.moveVertically(s,!0,l)}).map(t);return n.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function j6(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Kt(n).resolveInner(e),i=t.childBefore(e),s=t.childAfter(e),l;return i&&s&&i.to<=e&&s.from>=e&&(l=i.type.prop(Re.closedBy))&&l.indexOf(s.name)>-1&&n.doc.lineAt(i.to).from==n.doc.lineAt(s.from).from&&!/\S/.test(n.sliceDoc(i.to,s.from))?{from:i.to,to:s.from}:null}const X_=BE(!1),U6=BE(!0);function BE(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(s=>{let{from:l,to:a}=s,c=e.doc.lineAt(l),h=!n&&l==a&&j6(e,l);n&&(l=a=(a<=c.to?c:e.doc.lineAt(a)).to);let d=new Ud(e,{simulateBreak:l,simulateDoubleBreak:!!h}),p=Kb(d,l);for(p==null&&(p=Wo(/^\s*/.exec(e.doc.lineAt(l).text)[0],e.tabSize));a<c.to&&/\s/.test(c.text[a-c.from]);)a++;h?{from:l,to:a}=h:l>c.from&&l<c.from+100&&!/\S/.test(c.text.slice(0,l))&&(l=c.from);let m=["",qc(e,p)];return h&&m.push(qc(e,d.lineIndent(c.from,-1))),{changes:{from:l,to:a,insert:He.of(m)},range:G.cursor(l+1+m[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function Xb(n,e){let t=-1;return n.changeByRange(i=>{let s=[];for(let a=i.from;a<=i.to;){let c=n.doc.lineAt(a);c.number>t&&(i.empty||i.to>c.from)&&(e(c,s,i),t=c.number),a=c.to+1}let l=n.changes(s);return{changes:s,range:G.range(l.mapPos(i.anchor,1),l.mapPos(i.head,1))}})}const z6=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),i=new Ud(n,{overrideIndentation:l=>{let a=t[l];return a??-1}}),s=Xb(n,(l,a,c)=>{let h=Kb(i,l.from);if(h==null)return;/\S/.test(l.text)||(h=0);let d=/^\s*/.exec(l.text)[0],p=qc(n,h);(d!=p||c.from<l.from+d.length)&&(t[l.from]=h,a.push({from:l.from,to:l.from+d.length,insert:p}))});return s.changes.empty||e(n.update(s,{userEvent:"indent"})),!0},I6=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Xb(n,(t,i)=>{i.push({from:t.from,insert:n.facet(Gb)})}),{userEvent:"input.indent"})),!0),P6=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Xb(n,(t,i)=>{let s=/^\s*/.exec(t.text)[0];if(!s)return;let l=Wo(s,n.tabSize),a=0,c=qc(n,Math.max(0,l-ed(n)));for(;a<s.length&&a<c.length&&s.charCodeAt(a)==c.charCodeAt(a);)a++;i.push({from:t.from+a,to:t.from+s.length,insert:c.slice(a)})}),{userEvent:"delete.dedent"})),!0),H6=n=>(n.setTabFocusMode(),!0),q6=[{key:"Ctrl-b",run:fE,shift:SE,preventDefault:!0},{key:"Ctrl-f",run:dE,shift:kE},{key:"Ctrl-p",run:mE,shift:OE},{key:"Ctrl-n",run:yE,shift:AE},{key:"Ctrl-a",run:r6,shift:y6},{key:"Ctrl-e",run:l6,shift:b6},{key:"Ctrl-d",run:DE},{key:"Ctrl-h",run:qy},{key:"Ctrl-k",run:A6},{key:"Ctrl-Alt-h",run:ME},{key:"Ctrl-o",run:E6},{key:"Ctrl-t",run:D6},{key:"Ctrl-v",run:Hy}],V6=[{key:"ArrowLeft",run:fE,shift:SE,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:X5,shift:c6,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:i6,shift:g6,preventDefault:!0},{key:"ArrowRight",run:dE,shift:kE,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Q5,shift:u6,preventDefault:!0},{mac:"Cmd-ArrowRight",run:s6,shift:m6,preventDefault:!0},{key:"ArrowUp",run:mE,shift:OE,preventDefault:!0},{mac:"Cmd-ArrowUp",run:K_,shift:F_},{mac:"Ctrl-ArrowUp",run:V_,shift:$_},{key:"ArrowDown",run:yE,shift:AE,preventDefault:!0},{mac:"Cmd-ArrowDown",run:W_,shift:Y_},{mac:"Ctrl-ArrowDown",run:Hy,shift:G_},{key:"PageUp",run:V_,shift:$_},{key:"PageDown",run:Hy,shift:G_},{key:"Home",run:n6,shift:p6,preventDefault:!0},{key:"Mod-Home",run:K_,shift:F_},{key:"End",run:t6,shift:d6,preventDefault:!0},{key:"Mod-End",run:W_,shift:Y_},{key:"Enter",run:X_,shift:X_},{key:"Mod-a",run:v6},{key:"Backspace",run:qy,shift:qy,preventDefault:!0},{key:"Delete",run:DE,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:ME,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:O6,preventDefault:!0},{mac:"Mod-Backspace",run:C6,preventDefault:!0},{mac:"Mod-Delete",run:T6,preventDefault:!0}].concat(q6.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),$6=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Z5,shift:h6},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e6,shift:f6},{key:"Alt-ArrowUp",run:R6},{key:"Shift-Alt-ArrowUp",run:N6},{key:"Alt-ArrowDown",run:M6},{key:"Shift-Alt-ArrowDown",run:L6},{key:"Mod-Alt-ArrowUp",run:k6},{key:"Mod-Alt-ArrowDown",run:x6},{key:"Escape",run:_6},{key:"Mod-Enter",run:U6},{key:"Alt-l",mac:"Ctrl-l",run:w6},{key:"Mod-i",run:S6,preventDefault:!0},{key:"Mod-[",run:P6},{key:"Mod-]",run:I6},{key:"Mod-Alt-\\",run:z6},{key:"Shift-Mod-k",run:B6},{key:"Shift-Mod-\\",run:a6},{key:"Mod-/",run:R5},{key:"Alt-A",run:N5},{key:"Ctrl-m",mac:"Shift-Alt-m",run:H6}].concat(V6),Q_=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class Po{constructor(e,t,i=0,s=e.length,l,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,s),this.bufferStart=i,this.normalize=l?c=>l(Q_(c)):Q_,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return fn(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Sb(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Li(e);let s=this.normalize(t);if(s.length)for(let l=0,a=i;;l++){let c=s.charCodeAt(l),h=this.match(c,a,this.bufferPos+this.bufferStart);if(l==s.length-1){if(h)return this.value=h,this;break}a==i&&l<t.length&&t.charCodeAt(l)==c&&a++}}}match(e,t,i){let s=null;for(let l=0;l<this.matches.length;l+=2){let a=this.matches[l],c=!1;this.query.charCodeAt(a)==e&&(a==this.query.length-1?s={from:this.matches[l+1],to:i}:(this.matches[l]++,c=!0)),c||(this.matches.splice(l,2),l-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?s={from:t,to:i}:this.matches.push(1,t)),s&&this.test&&!this.test(s.from,s.to,this.buffer,this.bufferStart)&&(s=null),s}}typeof Symbol<"u"&&(Po.prototype[Symbol.iterator]=function(){return this});const jE={from:-1,to:-1,match:/.*/.exec("")},Qb="gm"+(/x/.unicode==null?"":"u");class UE{constructor(e,t,i,s=0,l=e.length){if(this.text=e,this.to=l,this.curLine="",this.done=!1,this.value=jE,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new zE(e,t,i,s,l);this.re=new RegExp(t,Qb+(i?.ignoreCase?"i":"")),this.test=i?.test,this.iter=e.iter();let a=e.lineAt(s);this.curLineStart=a.from,this.matchPos=sd(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,s=i+t[0].length;if(this.matchPos=sd(this.text,s+(i==s?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<s||i>this.value.to)&&(!this.test||this.test(i,s,t)))return this.value={from:i,to:s,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const S0=new WeakMap;class xo{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let s=S0.get(e);if(!s||s.from>=i||s.to<=t){let c=new xo(t,e.sliceString(t,i));return S0.set(e,c),c}if(s.from==t&&s.to==i)return s;let{text:l,from:a}=s;return a>t&&(l=e.sliceString(t,a)+l,a=t),s.to<i&&(l+=e.sliceString(s.to,i)),S0.set(e,new xo(a,l)),new xo(t,l.slice(t-a,i-a))}}class zE{constructor(e,t,i,s,l){this.text=e,this.to=l,this.done=!1,this.value=jE,this.matchPos=sd(e,s),this.re=new RegExp(t,Qb+(i?.ignoreCase?"i":"")),this.test=i?.test,this.flat=xo.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let i=this.flat.from+t.index,s=i+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,s,t)))return this.value={from:i,to:s,match:t},this.matchPos=sd(this.text,s+(i==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=xo.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(UE.prototype[Symbol.iterator]=zE.prototype[Symbol.iterator]=function(){return this});function G6(n){try{return new RegExp(n,Qb),!0}catch{return!1}}function sd(n,e){if(e>=n.length)return e;let t=n.lineAt(e),i;for(;e<t.to&&(i=t.text.charCodeAt(e-t.from))>=56320&&i<57344;)e++;return e}const K6=n=>{let{state:e}=n,t=String(e.doc.lineAt(n.state.selection.main.head).number),{close:i,result:s}=tz(n,{label:e.phrase("Go to line"),input:{type:"text",name:"line",value:t},focus:!0,submitLabel:e.phrase("go")});return s.then(l=>{let a=l&&/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(l.elements.line.value);if(!a){n.dispatch({effects:i});return}let c=e.doc.lineAt(e.selection.main.head),[,h,d,p,m]=a,b=p?+p.slice(1):0,v=d?+d:c.number;if(d&&m){let _=v/100;h&&(_=_*(h=="-"?-1:1)+c.number/e.doc.lines),v=Math.round(e.doc.lines*_)}else d&&h&&(v=v*(h=="-"?-1:1)+c.number);let w=e.doc.line(Math.max(1,Math.min(e.doc.lines,v))),k=G.cursor(w.from+Math.max(0,Math.min(b,w.length)));n.dispatch({effects:[i,ee.scrollIntoView(k.from,{y:"center"})],selection:k})}),!0},W6={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},F6=te.define({combine(n){return Ki(n,W6,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function Y6(n){return[eI,Z6]}const X6=he.mark({class:"cm-selectionMatch"}),Q6=he.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function J_(n,e,t,i){return(t==0||n(e.sliceDoc(t-1,t))!=rt.Word)&&(i==e.doc.length||n(e.sliceDoc(i,i+1))!=rt.Word)}function J6(n,e,t,i){return n(e.sliceDoc(t,t+1))==rt.Word&&n(e.sliceDoc(i-1,i))==rt.Word}const Z6=lt.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(F6),{state:t}=n,i=t.selection;if(i.ranges.length>1)return he.none;let s=i.main,l,a=null;if(s.empty){if(!e.highlightWordAroundCursor)return he.none;let h=t.wordAt(s.head);if(!h)return he.none;a=t.charCategorizer(s.head),l=t.sliceDoc(h.from,h.to)}else{let h=s.to-s.from;if(h<e.minSelectionLength||h>200)return he.none;if(e.wholeWords){if(l=t.sliceDoc(s.from,s.to),a=t.charCategorizer(s.head),!(J_(a,t,s.from,s.to)&&J6(a,t,s.from,s.to)))return he.none}else if(l=t.sliceDoc(s.from,s.to),!l)return he.none}let c=[];for(let h of n.visibleRanges){let d=new Po(t.doc,l,h.from,h.to);for(;!d.next().done;){let{from:p,to:m}=d.value;if((!a||J_(a,t,p,m))&&(s.empty&&p<=s.from&&m>=s.to?c.push(Q6.range(p,m)):(p>=s.to||m<=s.from)&&c.push(X6.range(p,m)),c.length>e.maxMatches))return he.none}}return he.set(c)}},{decorations:n=>n.decorations}),eI=ee.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),tI=({state:n,dispatch:e})=>{let{selection:t}=n,i=G.create(t.ranges.map(s=>n.wordAt(s.head)||G.cursor(s.head)),t.mainIndex);return i.eq(t)?!1:(e(n.update({selection:i})),!0)};function nI(n,e){let{main:t,ranges:i}=n.selection,s=n.wordAt(t.head),l=s&&s.from==t.from&&s.to==t.to;for(let a=!1,c=new Po(n.doc,e,i[i.length-1].to);;)if(c.next(),c.done){if(a)return null;c=new Po(n.doc,e,0,Math.max(0,i[i.length-1].from-1)),a=!0}else{if(a&&i.some(h=>h.from==c.value.from))continue;if(l){let h=n.wordAt(c.value.from);if(!h||h.from!=c.value.from||h.to!=c.value.to)continue}return c.value}}const iI=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(l=>l.from===l.to))return tI({state:n,dispatch:e});let i=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(l=>n.sliceDoc(l.from,l.to)!=i))return!1;let s=nI(n,i);return s?(e(n.update({selection:n.selection.addRange(G.range(s.from,s.to),!1),effects:ee.scrollIntoView(s.to)})),!0):!1},Yo=te.define({combine(n){return Ki(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new yI(e),scrollToMatch:e=>ee.scrollIntoView(e)})}});class IE{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||G6(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord,this.test=e.test}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord&&this.test==e.test}create(){return this.regexp?new cI(this):new lI(this)}getCursor(e,t=0,i){let s=e.doc?e:Ue.create({doc:e});return i==null&&(i=s.doc.length),this.regexp?ro(this,s,t,i):so(this,s,t,i)}}class PE{constructor(e){this.spec=e}}function sI(n,e,t){return(i,s,l,a)=>{if(t&&!t(i,s,l,a))return!1;let c=i>=a&&s<=a+l.length?l.slice(i-a,s-a):e.doc.sliceString(i,s);return n(c,e,i,s)}}function so(n,e,t,i){let s;return n.wholeWord&&(s=rI(e.doc,e.charCategorizer(e.selection.main.head))),n.test&&(s=sI(n.test,e,s)),new Po(e.doc,n.unquoted,t,i,n.caseSensitive?void 0:l=>l.toLowerCase(),s)}function rI(n,e){return(t,i,s,l)=>((l>t||l+s.length<i)&&(l=Math.max(0,t-2),s=n.sliceString(l,Math.min(n.length,i+2))),(e(rd(s,t-l))!=rt.Word||e(ld(s,t-l))!=rt.Word)&&(e(ld(s,i-l))!=rt.Word||e(rd(s,i-l))!=rt.Word))}class lI extends PE{constructor(e){super(e)}nextMatch(e,t,i){let s=so(this.spec,e,i,e.doc.length).nextOverlapping();if(s.done){let l=Math.min(e.doc.length,t+this.spec.unquoted.length);s=so(this.spec,e,0,l).nextOverlapping()}return s.done||s.value.from==t&&s.value.to==i?null:s.value}prevMatchInRange(e,t,i){for(let s=i;;){let l=Math.max(t,s-1e4-this.spec.unquoted.length),a=so(this.spec,e,l,s),c=null;for(;!a.nextOverlapping().done;)c=a.value;if(c)return c;if(l==t)return null;s-=1e4}}prevMatch(e,t,i){let s=this.prevMatchInRange(e,0,t);return s||(s=this.prevMatchInRange(e,Math.max(0,i-this.spec.unquoted.length),e.doc.length)),s&&(s.from!=t||s.to!=i)?s:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let i=so(this.spec,e,0,e.doc.length),s=[];for(;!i.next().done;){if(s.length>=t)return null;s.push(i.value)}return s}highlight(e,t,i,s){let l=so(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!l.next().done;)s(l.value.from,l.value.to)}}function oI(n,e,t){return(i,s,l)=>(!t||t(i,s,l))&&n(l[0],e,i,s)}function ro(n,e,t,i){let s;return n.wholeWord&&(s=aI(e.charCategorizer(e.selection.main.head))),n.test&&(s=oI(n.test,e,s)),new UE(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:s},t,i)}function rd(n,e){return n.slice(Ct(n,e,!1),e)}function ld(n,e){return n.slice(e,Ct(n,e))}function aI(n){return(e,t,i)=>!i[0].length||(n(rd(i.input,i.index))!=rt.Word||n(ld(i.input,i.index))!=rt.Word)&&(n(ld(i.input,i.index+i[0].length))!=rt.Word||n(rd(i.input,i.index+i[0].length))!=rt.Word)}class cI extends PE{nextMatch(e,t,i){let s=ro(this.spec,e,i,e.doc.length).next();return s.done&&(s=ro(this.spec,e,0,t).next()),s.done?null:s.value}prevMatchInRange(e,t,i){for(let s=1;;s++){let l=Math.max(t,i-s*1e4),a=ro(this.spec,e,l,i),c=null;for(;!a.next().done;)c=a.value;if(c&&(l==t||c.from>l+10))return c;if(l==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,i)=>{if(i=="&")return e.match[0];if(i=="$")return"$";for(let s=i.length;s>0;s--){let l=+i.slice(0,s);if(l>0&&l<e.match.length)return e.match[l]+i.slice(s)}return t})}matchAll(e,t){let i=ro(this.spec,e,0,e.doc.length),s=[];for(;!i.next().done;){if(s.length>=t)return null;s.push(i.value)}return s}highlight(e,t,i,s){let l=ro(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.doc.length));for(;!l.next().done;)s(l.value.from,l.value.to)}}const Vc=_e.define(),Jb=_e.define(),sr=Wt.define({create(n){return new k0(Vy(n).create(),null)},update(n,e){for(let t of e.effects)t.is(Vc)?n=new k0(t.value.create(),n.panel):t.is(Jb)&&(n=new k0(n.query,t.value?Zb:null));return n},provide:n=>Ic.from(n,e=>e.panel)});class k0{constructor(e,t){this.query=e,this.panel=t}}const uI=he.mark({class:"cm-searchMatch"}),hI=he.mark({class:"cm-searchMatch cm-searchMatch-selected"}),fI=lt.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(sr))}update(n){let e=n.state.field(sr);(e!=n.startState.field(sr)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return he.none;let{view:t}=this,i=new qi;for(let s=0,l=t.visibleRanges,a=l.length;s<a;s++){let{from:c,to:h}=l[s];for(;s<a-1&&h>l[s+1].from-500;)h=l[++s].to;n.highlight(t.state,c,h,(d,p)=>{let m=t.state.selection.ranges.some(b=>b.from==d&&b.to==p);i.add(d,p,m?hI:uI)})}return i.finish()}},{decorations:n=>n.decorations});function au(n){return e=>{let t=e.state.field(sr,!1);return t&&t.query.spec.valid?n(e,t):VE(e)}}const od=au((n,{query:e})=>{let{to:t}=n.state.selection.main,i=e.nextMatch(n.state,t,t);if(!i)return!1;let s=G.single(i.from,i.to),l=n.state.facet(Yo);return n.dispatch({selection:s,effects:[ev(n,i),l.scrollToMatch(s.main,n)],userEvent:"select.search"}),qE(n),!0}),ad=au((n,{query:e})=>{let{state:t}=n,{from:i}=t.selection.main,s=e.prevMatch(t,i,i);if(!s)return!1;let l=G.single(s.from,s.to),a=n.state.facet(Yo);return n.dispatch({selection:l,effects:[ev(n,s),a.scrollToMatch(l.main,n)],userEvent:"select.search"}),qE(n),!0}),dI=au((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:G.create(t.map(i=>G.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),pI=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:s}=t.main,l=[],a=0;for(let c=new Po(n.doc,n.sliceDoc(i,s));!c.next().done;){if(l.length>1e3)return!1;c.value.from==i&&(a=l.length),l.push(G.range(c.value.from,c.value.to))}return e(n.update({selection:G.create(l,a),userEvent:"select.search.matches"})),!0},Z_=au((n,{query:e})=>{let{state:t}=n,{from:i,to:s}=t.selection.main;if(t.readOnly)return!1;let l=e.nextMatch(t,i,i);if(!l)return!1;let a=l,c=[],h,d,p=[];a.from==i&&a.to==s&&(d=t.toText(e.getReplacement(a)),c.push({from:a.from,to:a.to,insert:d}),a=e.nextMatch(t,a.from,a.to),p.push(ee.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(i).number)+".")));let m=n.state.changes(c);return a&&(h=G.single(a.from,a.to).map(m),p.push(ev(n,a)),p.push(t.facet(Yo).scrollToMatch(h.main,n))),n.dispatch({changes:m,selection:h,effects:p,userEvent:"input.replace"}),!0}),gI=au((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(s=>{let{from:l,to:a}=s;return{from:l,to:a,insert:e.getReplacement(s)}});if(!t.length)return!1;let i=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:ee.announce.of(i),userEvent:"input.replace.all"}),!0});function Zb(n){return n.state.facet(Yo).createPanel(n)}function Vy(n,e){var t,i,s,l,a;let c=n.selection.main,h=c.empty||c.to>c.from+100?"":n.sliceDoc(c.from,c.to);if(e&&!h)return e;let d=n.facet(Yo);return new IE({search:((t=e?.literal)!==null&&t!==void 0?t:d.literal)?h:h.replace(/\n/g,"\\n"),caseSensitive:(i=e?.caseSensitive)!==null&&i!==void 0?i:d.caseSensitive,literal:(s=e?.literal)!==null&&s!==void 0?s:d.literal,regexp:(l=e?.regexp)!==null&&l!==void 0?l:d.regexp,wholeWord:(a=e?.wholeWord)!==null&&a!==void 0?a:d.wholeWord})}function HE(n){let e=Pb(n,Zb);return e&&e.dom.querySelector("[main-field]")}function qE(n){let e=HE(n);e&&e==n.root.activeElement&&e.select()}const VE=n=>{let e=n.state.field(sr,!1);if(e&&e.panel){let t=HE(n);if(t&&t!=n.root.activeElement){let i=Vy(n.state,e.query.spec);i.valid&&n.dispatch({effects:Vc.of(i)}),t.focus(),t.select()}}else n.dispatch({effects:[Jb.of(!0),e?Vc.of(Vy(n.state,e.query.spec)):_e.appendConfig.of(vI)]});return!0},$E=n=>{let e=n.state.field(sr,!1);if(!e||!e.panel)return!1;let t=Pb(n,Zb);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:Jb.of(!1)}),!0},mI=[{key:"Mod-f",run:VE,scope:"editor search-panel"},{key:"F3",run:od,shift:ad,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:od,shift:ad,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:$E,scope:"editor search-panel"},{key:"Mod-Shift-l",run:pI},{key:"Mod-Alt-g",run:K6},{key:"Mod-d",run:iI,preventDefault:!0}];class yI{constructor(e){this.view=e;let t=this.query=e.state.field(sr).query.spec;this.commit=this.commit.bind(this),this.searchField=Fe("input",{value:t.search,placeholder:Dn(e,"Find"),"aria-label":Dn(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Fe("input",{value:t.replace,placeholder:Dn(e,"Replace"),"aria-label":Dn(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Fe("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=Fe("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=Fe("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function i(s,l,a){return Fe("button",{class:"cm-button",name:s,onclick:l,type:"button"},a)}this.dom=Fe("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,i("next",()=>od(e),[Dn(e,"next")]),i("prev",()=>ad(e),[Dn(e,"previous")]),i("select",()=>dI(e),[Dn(e,"all")]),Fe("label",null,[this.caseField,Dn(e,"match case")]),Fe("label",null,[this.reField,Dn(e,"regexp")]),Fe("label",null,[this.wordField,Dn(e,"by word")]),...e.state.readOnly?[]:[Fe("br"),this.replaceField,i("replace",()=>Z_(e),[Dn(e,"replace")]),i("replaceAll",()=>gI(e),[Dn(e,"replace all")])],Fe("button",{name:"close",onclick:()=>$E(e),"aria-label":Dn(e,"close"),type:"button"},[""])])}commit(){let e=new IE({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Vc.of(e)}))}keydown(e){d8(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?ad:od)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),Z_(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(Vc)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Yo).top}}function Dn(n,e){return n.state.phrase(e)}const rf=30,lf=/[\s\.,:;?!]/;function ev(n,{from:e,to:t}){let i=n.state.doc.lineAt(e),s=n.state.doc.lineAt(t).to,l=Math.max(i.from,e-rf),a=Math.min(s,t+rf),c=n.state.sliceDoc(l,a);if(l!=i.from){for(let h=0;h<rf;h++)if(!lf.test(c[h+1])&&lf.test(c[h])){c=c.slice(h);break}}if(a!=s){for(let h=c.length-1;h>c.length-rf;h--)if(!lf.test(c[h-1])&&lf.test(c[h])){c=c.slice(0,h);break}}return ee.announce.of(`${n.state.phrase("current match")}. ${c} ${n.state.phrase("on line")} ${i.number}.`)}const bI=ee.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),vI=[sr,ol.low(fI),bI];class GE{constructor(e,t,i,s){this.state=e,this.pos=t,this.explicit=i,this.view=s,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=Kt(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),s=t.text.slice(i-t.from,this.pos-t.from),l=s.search(KE(e,!1));return l<0?null:{from:i+l,to:this.pos,text:s.slice(l)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function eO(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function wI(n){let e=Object.create(null),t=Object.create(null);for(let{label:s}of n){e[s[0]]=!0;for(let l=1;l<s.length;l++)t[s[l]]=!0}let i=eO(e)+eO(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function SI(n){let e=n.map(s=>typeof s=="string"?{label:s}:s),[t,i]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:wI(e);return s=>{let l=s.matchBefore(i);return l||s.explicit?{from:l?l.from:s.pos,options:e,validFor:t}:null}}class tO{constructor(e,t,i,s){this.completion=e,this.source=t,this.match=i,this.score=s}}function Yr(n){return n.selection.main.from}function KE(n,e){var t;let{source:i}=n,s=e&&i[0]!="^",l=i[i.length-1]!="$";return!s&&!l?n:new RegExp(`${s?"^":""}(?:${i})${l?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const WE=Si.define();function kI(n,e,t,i){let{main:s}=n.selection,l=t-s.from,a=i-s.from;return{...n.changeByRange(c=>{if(c!=s&&t!=i&&n.sliceDoc(c.from+l,c.from+a)!=n.sliceDoc(t,i))return{range:c};let h=n.toText(e);return{changes:{from:c.from+l,to:i==s.from?c.to:c.from+a,insert:h},range:G.cursor(c.from+l+h.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const nO=new WeakMap;function xI(n){if(!Array.isArray(n))return n;let e=nO.get(n);return e||nO.set(n,e=SI(n)),e}const cd=_e.define(),$c=_e.define();class _I{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let i=fn(e,t),s=Li(i);this.chars.push(i);let l=e.slice(t,t+s),a=l.toUpperCase();this.folded.push(fn(a==l?l.toLowerCase():a,0)),t+=s}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:s,precise:l,byWord:a}=this;if(t.length==1){let R=fn(e,0),C=Li(R),U=C==e.length?0:-100;if(R!=t[0])if(R==i[0])U+=-200;else return null;return this.ret(U,[0,C])}let c=e.indexOf(this.pattern);if(c==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let h=t.length,d=0;if(c<0){for(let R=0,C=Math.min(e.length,200);R<C&&d<h;){let U=fn(e,R);(U==t[d]||U==i[d])&&(s[d++]=R),R+=Li(U)}if(d<h)return null}let p=0,m=0,b=!1,v=0,w=-1,k=-1,_=/[a-z]/.test(e),O=!0;for(let R=0,C=Math.min(e.length,200),U=0;R<C&&m<h;){let B=fn(e,R);c<0&&(p<h&&B==t[p]&&(l[p++]=R),v<h&&(B==t[v]||B==i[v]?(v==0&&(w=R),k=R+1,v++):v=0));let z,D=B<255?B>=48&&B<=57||B>=97&&B<=122?2:B>=65&&B<=90?1:0:(z=Sb(B))!=z.toLowerCase()?1:z!=z.toUpperCase()?2:0;(!R||D==1&&_||U==0&&D!=0)&&(t[m]==B||i[m]==B&&(b=!0)?a[m++]=R:a.length&&(O=!1)),U=D,R+=Li(B)}return m==h&&a[0]==0&&O?this.result(-100+(b?-200:0),a,e):v==h&&w==0?this.ret(-200-e.length+(k==e.length?0:-100),[0,k]):c>-1?this.ret(-700-e.length,[c,c+this.pattern.length]):v==h?this.ret(-900-e.length,[w,k]):m==h?this.result(-100+(b?-200:0)+-700+(O?0:-1100),a,e):t.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,t,i){let s=[],l=0;for(let a of t){let c=a+(this.astral?Li(fn(i,a)):1);l&&s[l-1]==a?s[l-1]=c:(s[l++]=a,s[l++]=c)}return this.ret(e-i.length,s)}}class OI{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),i=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,t.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const Nt=te.define({combine(n){return Ki(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:AI,filterStrict:!1,compareCompletions:(e,t)=>(e.sortText||e.label).localeCompare(t.sortText||t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>i=>iO(e(i),t(i)),optionClass:(e,t)=>i=>iO(e(i),t(i)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function iO(n,e){return n?e?n+" "+e:n:e}function AI(n,e,t,i,s,l){let a=n.textDirection==Ze.RTL,c=a,h=!1,d="top",p,m,b=e.left-s.left,v=s.right-e.right,w=i.right-i.left,k=i.bottom-i.top;if(c&&b<Math.min(w,v)?c=!1:!c&&v<Math.min(w,b)&&(c=!0),w<=(c?b:v))p=Math.max(s.top,Math.min(t.top,s.bottom-k))-e.top,m=Math.min(400,c?b:v);else{h=!0,m=Math.min(400,(a?e.right:s.right-e.left)-30);let R=s.bottom-e.bottom;R>=k||R>e.top?p=t.bottom-e.top:(d="bottom",p=e.bottom-t.top)}let _=(e.bottom-e.top)/l.offsetHeight,O=(e.right-e.left)/l.offsetWidth;return{style:`${d}: ${p/_}px; max-width: ${m/O}px`,class:"cm-completionInfo-"+(h?a?"left-narrow":"right-narrow":c?"left":"right")}}function CI(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,s,l){let a=document.createElement("span");a.className="cm-completionLabel";let c=t.displayLabel||t.label,h=0;for(let d=0;d<l.length;){let p=l[d++],m=l[d++];p>h&&a.appendChild(document.createTextNode(c.slice(h,p)));let b=a.appendChild(document.createElement("span"));b.appendChild(document.createTextNode(c.slice(p,m))),b.className="cm-completionMatchedText",h=m}return h<c.length&&a.appendChild(document.createTextNode(c.slice(h))),a},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function x0(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let s=Math.floor(e/t);return{from:s*t,to:(s+1)*t}}let i=Math.floor((n-e)/t);return{from:n-(i+1)*t,to:n-i*t}}class TI{constructor(e,t,i){this.view=e,this.stateField=t,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:h=>this.placeInfo(h),key:this},this.space=null,this.currentClass="";let s=e.state.field(t),{options:l,selected:a}=s.open,c=e.state.facet(Nt);this.optionContent=CI(c),this.optionClass=c.optionClass,this.tooltipClass=c.tooltipClass,this.range=x0(l.length,a,c.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",h=>{let{options:d}=e.state.field(t).open;for(let p=h.target,m;p&&p!=this.dom;p=p.parentNode)if(p.nodeName=="LI"&&(m=/-(\d+)$/.exec(p.id))&&+m[1]<d.length){this.applyCompletion(e,d[+m[1]]),h.preventDefault();return}}),this.dom.addEventListener("focusout",h=>{let d=e.state.field(this.stateField,!1);d&&d.tooltip&&e.state.facet(Nt).closeOnBlur&&h.relatedTarget!=e.contentDOM&&e.dispatch({effects:$c.of(null)})}),this.showOptions(l,s.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let i=e.state.field(this.stateField),s=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=s){let{options:l,selected:a,disabled:c}=i.open;(!s.open||s.open.options!=l)&&(this.range=x0(l.length,a,e.state.facet(Nt).maxRenderedOptions),this.showOptions(l,i.id)),this.updateSel(),c!=((t=s.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!c)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of t.split(" "))i&&this.dom.classList.add(i);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;(t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=x0(t.options.length,t.selected,this.view.state.facet(Nt).maxRenderedOptions),this.showOptions(t.options,e.id));let i=this.updateSelectedOption(t.selected);if(i){this.destroyInfo();let{completion:s}=t.options[t.selected],{info:l}=s;if(!l)return;let a=typeof l=="string"?document.createTextNode(l):l(s);if(!a)return;"then"in a?a.then(c=>{c&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(c,s)}).catch(c=>mn(this.view.state,c,"completion info")):(this.addInfoPane(a,s),i.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",i.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:s,destroy:l}=e;i.appendChild(s),this.infoDestroy=l||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,s=this.range.from;i;i=i.nextSibling,s++)i.nodeName!="LI"||!i.id?s--:s==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&(i.removeAttribute("aria-selected"),i.removeAttribute("aria-describedby"));return t&&DI(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),l=this.space;if(!l){let a=this.dom.ownerDocument.documentElement;l={left:0,top:0,right:a.clientWidth,bottom:a.clientHeight}}return s.top>Math.min(l.bottom,t.bottom)-10||s.bottom<Math.max(l.top,t.top)+10?null:this.view.state.facet(Nt).positionInfo(this.view,t,s,i,l,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,i){const s=document.createElement("ul");s.id=t,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions")),s.addEventListener("mousedown",a=>{a.target==s&&a.preventDefault()});let l=null;for(let a=i.from;a<i.to;a++){let{completion:c,match:h}=e[a],{section:d}=c;if(d){let b=typeof d=="string"?d:d.name;if(b!=l&&(a>i.from||i.from==0))if(l=b,typeof d!="string"&&d.header)s.appendChild(d.header(d));else{let v=s.appendChild(document.createElement("completion-section"));v.textContent=b}}const p=s.appendChild(document.createElement("li"));p.id=t+"-"+a,p.setAttribute("role","option");let m=this.optionClass(c);m&&(p.className=m);for(let b of this.optionContent){let v=b(c,this.view.state,this.view,h);v&&p.appendChild(v)}}return i.from&&s.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function EI(n,e){return t=>new TI(t,n,e)}function DI(n,e){let t=n.getBoundingClientRect(),i=e.getBoundingClientRect(),s=t.height/n.offsetHeight;i.top<t.top?n.scrollTop-=(t.top-i.top)/s:i.bottom>t.bottom&&(n.scrollTop+=(i.bottom-t.bottom)/s)}function sO(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function RI(n,e){let t=[],i=null,s=null,l=p=>{t.push(p);let{section:m}=p.completion;if(m){i||(i=[]);let b=typeof m=="string"?m:m.name;i.some(v=>v.name==b)||i.push(typeof m=="string"?{name:b}:m)}},a=e.facet(Nt);for(let p of n)if(p.hasResult()){let m=p.result.getMatch;if(p.result.filter===!1)for(let b of p.result.options)l(new tO(b,p.source,m?m(b):[],1e9-t.length));else{let b=e.sliceDoc(p.from,p.to),v,w=a.filterStrict?new OI(b):new _I(b);for(let k of p.result.options)if(v=w.match(k.label)){let _=k.displayLabel?m?m(k,v.matched):[]:v.matched,O=v.score+(k.boost||0);if(l(new tO(k,p.source,_,O)),typeof k.section=="object"&&k.section.rank==="dynamic"){let{name:R}=k.section;s||(s=Object.create(null)),s[R]=Math.max(O,s[R]||-1e9)}}}}if(i){let p=Object.create(null),m=0,b=(v,w)=>(v.rank==="dynamic"&&w.rank==="dynamic"?s[w.name]-s[v.name]:0)||(typeof v.rank=="number"?v.rank:1e9)-(typeof w.rank=="number"?w.rank:1e9)||(v.name<w.name?-1:1);for(let v of i.sort(b))m-=1e5,p[v.name]=m;for(let v of t){let{section:w}=v.completion;w&&(v.score+=p[typeof w=="string"?w:w.name])}}let c=[],h=null,d=a.compareCompletions;for(let p of t.sort((m,b)=>b.score-m.score||d(m.completion,b.completion))){let m=p.completion;!h||h.label!=m.label||h.detail!=m.detail||h.type!=null&&m.type!=null&&h.type!=m.type||h.apply!=m.apply||h.boost!=m.boost?c.push(p):sO(p.completion)>sO(h)&&(c[c.length-1]=p),h=p.completion}return c}class ho{constructor(e,t,i,s,l,a){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=s,this.selected=l,this.disabled=a}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new ho(this.options,rO(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,i,s,l,a){if(s&&!a&&e.some(d=>d.isPending))return s.setDisabled();let c=RI(e,t);if(!c.length)return s&&e.some(d=>d.isPending)?s.setDisabled():null;let h=t.facet(Nt).selectOnOpen?0:-1;if(s&&s.selected!=h&&s.selected!=-1){let d=s.options[s.selected].completion;for(let p=0;p<c.length;p++)if(c[p].completion==d){h=p;break}}return new ho(c,rO(i,h),{pos:e.reduce((d,p)=>p.hasResult()?Math.min(d,p.from):d,1e8),create:UI,above:l.aboveCursor},s?s.timestamp:Date.now(),h,!1)}map(e){return new ho(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new ho(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class ud{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new ud(BI,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(Nt),l=(i.override||t.languageDataAt("autocomplete",Yr(t)).map(xI)).map(h=>(this.active.find(p=>p.source==h)||new ii(h,this.active.some(p=>p.state!=0)?1:0)).update(e,i));l.length==this.active.length&&l.every((h,d)=>h==this.active[d])&&(l=this.active);let a=this.open,c=e.effects.some(h=>h.is(tv));a&&e.docChanged&&(a=a.map(e.changes)),e.selection||l.some(h=>h.hasResult()&&e.changes.touchesRange(h.from,h.to))||!MI(l,this.active)||c?a=ho.build(l,t,this.id,a,i,c):a&&a.disabled&&!l.some(h=>h.isPending)&&(a=null),!a&&l.every(h=>!h.isPending)&&l.some(h=>h.hasResult())&&(l=l.map(h=>h.hasResult()?new ii(h.source,0):h));for(let h of e.effects)h.is(YE)&&(a=a&&a.setSelected(h.value,this.id));return l==this.active&&a==this.open?this:new ud(l,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?NI:LI}}function MI(n,e){if(n==e)return!0;for(let t=0,i=0;;){for(;t<n.length&&!n[t].hasResult();)t++;for(;i<e.length&&!e[i].hasResult();)i++;let s=t==n.length,l=i==e.length;if(s||l)return s==l;if(n[t++].result!=e[i++].result)return!1}}const NI={"aria-autocomplete":"list"},LI={};function rO(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const BI=[];function FE(n,e){if(n.isUserEvent("input.complete")){let i=n.annotation(WE);if(i&&e.activateOnCompletion(i))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class ii{constructor(e,t,i=!1){this.source=e,this.state=t,this.explicit=i}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let i=FE(e,t),s=this;(i&8||i&16&&this.touches(e))&&(s=new ii(s.source,0)),i&4&&s.state==0&&(s=new ii(this.source,1)),s=s.updateFor(e,i);for(let l of e.effects)if(l.is(cd))s=new ii(s.source,1,l.value);else if(l.is($c))s=new ii(s.source,0);else if(l.is(tv))for(let a of l.value)a.source==s.source&&(s=a);return s}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Yr(e.state))}}class _o extends ii{constructor(e,t,i,s,l,a){super(e,3,t),this.limit=i,this.result=s,this.from=l,this.to=a}hasResult(){return!0}updateFor(e,t){var i;if(!(t&3))return this.map(e.changes);let s=this.result;s.map&&!e.changes.empty&&(s=s.map(s,e.changes));let l=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),c=Yr(e.state);if(c>a||!s||t&2&&(Yr(e.startState)==this.from||c<this.limit))return new ii(this.source,t&4?1:0);let h=e.changes.mapPos(this.limit);return jI(s.validFor,e.state,l,a)?new _o(this.source,this.explicit,h,s,l,a):s.update&&(s=s.update(s,l,a,new GE(e.state,c,!1)))?new _o(this.source,this.explicit,h,s,s.from,(i=s.to)!==null&&i!==void 0?i:Yr(e.state)):new ii(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new _o(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new ii(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function jI(n,e,t,i){if(!n)return!1;let s=e.sliceDoc(t,i);return typeof n=="function"?n(s,t,i,e):KE(n,!0).test(s)}const tv=_e.define({map(n,e){return n.map(t=>t.map(e))}}),YE=_e.define(),dn=Wt.define({create(){return ud.start()},update(n,e){return n.update(e)},provide:n=>[Ib.from(n,e=>e.tooltip),ee.contentAttributes.from(n,e=>e.attrs)]});function nv(n,e){const t=e.completion.apply||e.completion.label;let i=n.state.field(dn).active.find(s=>s.source==e.source);return i instanceof _o?(typeof t=="string"?n.dispatch({...kI(n.state,t,i.from,i.to),annotations:WE.of(e.completion)}):t(n,e.completion,i.from,i.to),!0):!1}const UI=EI(dn,nv);function of(n,e="option"){return t=>{let i=t.state.field(dn,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<t.state.facet(Nt).interactionDelay)return!1;let s=1,l;e=="page"&&(l=NT(t,i.open.tooltip))&&(s=Math.max(2,Math.floor(l.dom.offsetHeight/l.dom.querySelector("li").offsetHeight)-1));let{length:a}=i.open.options,c=i.open.selected>-1?i.open.selected+s*(n?1:-1):n?0:a-1;return c<0?c=e=="page"?0:a-1:c>=a&&(c=e=="page"?a-1:0),t.dispatch({effects:YE.of(c)}),!0}}const zI=n=>{let e=n.state.field(dn,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(Nt).interactionDelay?!1:nv(n,e.open.options[e.open.selected])},_0=n=>n.state.field(dn,!1)?(n.dispatch({effects:cd.of(!0)}),!0):!1,II=n=>{let e=n.state.field(dn,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:$c.of(null)}),!0)};class PI{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const HI=50,qI=1e3,VI=lt.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(dn).active)e.isPending&&this.startQuery(e)}update(n){let e=n.state.field(dn),t=n.state.facet(Nt);if(!n.selectionSet&&!n.docChanged&&n.startState.field(dn)==e)return;let i=n.transactions.some(l=>{let a=FE(l,t);return a&8||(l.selection||l.docChanged)&&!(a&3)});for(let l=0;l<this.running.length;l++){let a=this.running[l];if(i||a.context.abortOnDocChange&&n.docChanged||a.updates.length+n.transactions.length>HI&&Date.now()-a.time>qI){for(let c of a.context.abortListeners)try{c()}catch(h){mn(this.view.state,h)}a.context.abortListeners=null,this.running.splice(l--,1)}else a.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(l=>l.effects.some(a=>a.is(cd)))&&(this.pendingStart=!0);let s=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(l=>l.isPending&&!this.running.some(a=>a.active.source==l.source))?setTimeout(()=>this.startUpdate(),s):-1,this.composing!=0)for(let l of n.transactions)l.isUserEvent("input.type")?this.composing=2:this.composing==2&&l.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(dn);for(let t of e.active)t.isPending&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Nt).updateSyncTime))}startQuery(n){let{state:e}=this.view,t=Yr(e),i=new GE(e,t,n.explicit,this.view),s=new PI(n,i);this.running.push(s),Promise.resolve(n.source(i)).then(l=>{s.context.aborted||(s.done=l||null,this.scheduleAccept())},l=>{this.view.dispatch({effects:$c.of(null)}),mn(this.view.state,l)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Nt).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Nt),i=this.view.state.field(dn);for(let s=0;s<this.running.length;s++){let l=this.running[s];if(l.done===void 0)continue;if(this.running.splice(s--,1),l.done){let c=Yr(l.updates.length?l.updates[0].startState:this.view.state),h=Math.min(c,l.done.from+(l.active.explicit?0:1)),d=new _o(l.active.source,l.active.explicit,h,l.done,l.done.from,(n=l.done.to)!==null&&n!==void 0?n:c);for(let p of l.updates)d=d.update(p,t);if(d.hasResult()){e.push(d);continue}}let a=i.active.find(c=>c.source==l.active.source);if(a&&a.isPending)if(l.done==null){let c=new ii(l.active.source,0);for(let h of l.updates)c=c.update(h,t);c.isPending||e.push(c)}else this.startQuery(a)}(e.length||i.open&&i.open.disabled)&&this.view.dispatch({effects:tv.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(dn,!1);if(e&&e.tooltip&&this.view.state.facet(Nt).closeOnBlur){let t=e.open&&NT(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:$c.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:cd.of(!1)}),20),this.composing=0}}}),$I=typeof navigator=="object"&&/Win/.test(navigator.platform),GI=ol.highest(ee.domEventHandlers({keydown(n,e){let t=e.state.field(dn,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!($I&&n.altKey)||n.metaKey)return!1;let i=t.open.options[t.open.selected],s=t.active.find(a=>a.source==i.source),l=i.completion.commitCharacters||s.result.commitCharacters;return l&&l.indexOf(n.key)>-1&&nv(e,i),!1}})),KI=ee.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Gc={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},$r=_e.define({map(n,e){let t=e.mapPos(n,-1,tn.TrackAfter);return t??void 0}}),iv=new class extends rr{};iv.startSide=1;iv.endSide=-1;const XE=Wt.define({create(){return De.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:i=>i>=t.from&&i<=t.to})}for(let t of e.effects)t.is($r)&&(n=n.update({add:[iv.range(t.value,t.value+1)]}));return n}});function WI(){return[YI,XE]}const O0="()[]{}<>";function QE(n){for(let e=0;e<O0.length;e+=2)if(O0.charCodeAt(e)==n)return O0.charAt(e+1);return Sb(n<128?n:n+1)}function JE(n,e){return n.languageDataAt("closeBrackets",e)[0]||Gc}const FI=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),YI=ee.inputHandler.of((n,e,t,i)=>{if((FI?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let s=n.state.selection.main;if(i.length>2||i.length==2&&Li(fn(i,0))==1||e!=s.from||t!=s.to)return!1;let l=JI(n.state,i);return l?(n.dispatch(l),!0):!1}),XI=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let i=JE(n,n.selection.main.head).brackets||Gc.brackets,s=null,l=n.changeByRange(a=>{if(a.empty){let c=ZI(n.doc,a.head);for(let h of i)if(h==c&&$d(n.doc,a.head)==QE(fn(h,0)))return{changes:{from:a.head-h.length,to:a.head+h.length},range:G.cursor(a.head-h.length)}}return{range:s=a}});return s||e(n.update(l,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},QI=[{key:"Backspace",run:XI}];function JI(n,e){let t=JE(n,n.selection.main.head),i=t.brackets||Gc.brackets;for(let s of i){let l=QE(fn(s,0));if(e==s)return l==s?nP(n,s,i.indexOf(s+s+s)>-1,t):eP(n,s,l,t.before||Gc.before);if(e==l&&ZE(n,n.selection.main.from))return tP(n,s,l)}return null}function ZE(n,e){let t=!1;return n.field(XE).between(0,n.doc.length,i=>{i==e&&(t=!0)}),t}function $d(n,e){let t=n.sliceString(e,e+2);return t.slice(0,Li(fn(t,0)))}function ZI(n,e){let t=n.sliceString(e-2,e);return Li(fn(t,0))==t.length?t:t.slice(1)}function eP(n,e,t,i){let s=null,l=n.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:t,from:a.to}],effects:$r.of(a.to+e.length),range:G.range(a.anchor+e.length,a.head+e.length)};let c=$d(n.doc,a.head);return!c||/\s/.test(c)||i.indexOf(c)>-1?{changes:{insert:e+t,from:a.head},effects:$r.of(a.head+e.length),range:G.cursor(a.head+e.length)}:{range:s=a}});return s?null:n.update(l,{scrollIntoView:!0,userEvent:"input.type"})}function tP(n,e,t){let i=null,s=n.changeByRange(l=>l.empty&&$d(n.doc,l.head)==t?{changes:{from:l.head,to:l.head+t.length,insert:t},range:G.cursor(l.head+t.length)}:i={range:l});return i?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function nP(n,e,t,i){let s=i.stringPrefixes||Gc.stringPrefixes,l=null,a=n.changeByRange(c=>{if(!c.empty)return{changes:[{insert:e,from:c.from},{insert:e,from:c.to}],effects:$r.of(c.to+e.length),range:G.range(c.anchor+e.length,c.head+e.length)};let h=c.head,d=$d(n.doc,h),p;if(d==e){if(lO(n,h))return{changes:{insert:e+e,from:h},effects:$r.of(h+e.length),range:G.cursor(h+e.length)};if(ZE(n,h)){let b=t&&n.sliceDoc(h,h+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:h,to:h+b.length,insert:b},range:G.cursor(h+b.length)}}}else{if(t&&n.sliceDoc(h-2*e.length,h)==e+e&&(p=oO(n,h-2*e.length,s))>-1&&lO(n,p))return{changes:{insert:e+e+e+e,from:h},effects:$r.of(h+e.length),range:G.cursor(h+e.length)};if(n.charCategorizer(h)(d)!=rt.Word&&oO(n,h,s)>-1&&!iP(n,h,e,s))return{changes:{insert:e+e,from:h},effects:$r.of(h+e.length),range:G.cursor(h+e.length)}}return{range:l=c}});return l?null:n.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function lO(n,e){let t=Kt(n).resolveInner(e+1);return t.parent&&t.from==e}function iP(n,e,t,i){let s=Kt(n).resolveInner(e,-1),l=i.reduce((a,c)=>Math.max(a,c.length),0);for(let a=0;a<5;a++){let c=n.sliceDoc(s.from,Math.min(s.to,s.from+t.length+l)),h=c.indexOf(t);if(!h||h>-1&&i.indexOf(c.slice(0,h))>-1){let p=s.firstChild;for(;p&&p.from==s.from&&p.to-p.from>t.length+h;){if(n.sliceDoc(p.to-t.length,p.to)==t)return!1;p=p.firstChild}return!0}let d=s.to==e&&s.parent;if(!d)break;s=d}return!1}function oO(n,e,t){let i=n.charCategorizer(e);if(i(n.sliceDoc(e-1,e))!=rt.Word)return e;for(let s of t){let l=e-s.length;if(n.sliceDoc(l,e)==s&&i(n.sliceDoc(l-1,l))!=rt.Word)return l}return-1}function sP(n={}){return[GI,dn,Nt.of(n),VI,rP,KI]}const e2=[{key:"Ctrl-Space",run:_0},{mac:"Alt-`",run:_0},{mac:"Alt-i",run:_0},{key:"Escape",run:II},{key:"ArrowDown",run:of(!0)},{key:"ArrowUp",run:of(!1)},{key:"PageDown",run:of(!0,"page")},{key:"PageUp",run:of(!1,"page")},{key:"Enter",run:zI}],rP=ol.highest(Ub.computeN([Nt],n=>n.facet(Nt).defaultKeymap?[e2]:[]));class aO{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class Pr{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let s=i.facet(Kc).markerFilter;s&&(e=s(e,i));let l=e.slice().sort((v,w)=>v.from-w.from||v.to-w.to),a=new qi,c=[],h=0,d=i.doc.iter(),p=0,m=i.doc.length;for(let v=0;;){let w=v==l.length?null:l[v];if(!w&&!c.length)break;let k,_;if(c.length)k=h,_=c.reduce((C,U)=>Math.min(C,U.to),w&&w.from>k?w.from:1e8);else{if(k=w.from,k>m)break;_=w.to,c.push(w),v++}for(;v<l.length;){let C=l[v];if(C.from==k&&(C.to>C.from||C.to==k))c.push(C),v++,_=Math.min(C.to,_);else{_=Math.min(C.from,_);break}}_=Math.min(_,m);let O=!1;if(c.some(C=>C.from==k&&(C.to==_||_==m))&&(O=k==_,!O&&_-k<10)){let C=k-(p+d.value.length);C>0&&(d.next(C),p=k);for(let U=k;;){if(U>=_){O=!0;break}if(!d.lineBreak&&p+d.value.length>U)break;U=p+d.value.length,p+=d.value.length,d.next()}}let R=bP(c);if(O)a.add(k,k,he.widget({widget:new pP(R),diagnostics:c.slice()}));else{let C=c.reduce((U,B)=>B.markClass?U+" "+B.markClass:U,"");a.add(k,_,he.mark({class:"cm-lintRange cm-lintRange-"+R+C,diagnostics:c.slice(),inclusiveEnd:c.some(U=>U.to>_)}))}if(h=_,h==m)break;for(let C=0;C<c.length;C++)c[C].to<=h&&c.splice(C--,1)}let b=a.finish();return new Pr(b,t,Ho(b))}}function Ho(n,e=null,t=0){let i=null;return n.between(t,1e9,(s,l,{spec:a})=>{if(!(e&&a.diagnostics.indexOf(e)<0))if(!i)i=new aO(s,l,e||a.diagnostics[0]);else{if(a.diagnostics.indexOf(i.diagnostic)<0)return!1;i=new aO(i.from,l,i.diagnostic)}}),i}function lP(n,e){let t=e.pos,i=e.end||t,s=n.state.facet(Kc).hideOn(n,t,i);if(s!=null)return s;let l=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(a=>a.is(t2))||n.changes.touchesRange(l.from,Math.max(l.to,i)))}function oP(n,e){return n.field(In,!1)?e:e.concat(_e.appendConfig.of(vP))}const t2=_e.define(),sv=_e.define(),n2=_e.define(),In=Wt.define({create(){return new Pr(he.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),i=null,s=n.panel;if(n.selected){let l=e.changes.mapPos(n.selected.from,1);i=Ho(t,n.selected.diagnostic,l)||Ho(t,null,l)}!t.size&&s&&e.state.facet(Kc).autoPanel&&(s=null),n=new Pr(t,s,i)}for(let t of e.effects)if(t.is(t2)){let i=e.state.facet(Kc).autoPanel?t.value.length?Wc.open:null:n.panel;n=Pr.init(t.value,i,e.state)}else t.is(sv)?n=new Pr(n.diagnostics,t.value?Wc.open:null,n.selected):t.is(n2)&&(n=new Pr(n.diagnostics,n.panel,t.value));return n},provide:n=>[Ic.from(n,e=>e.panel),ee.decorations.from(n,e=>e.diagnostics)]}),aP=he.mark({class:"cm-lintRange cm-lintRange-active"});function cP(n,e,t){let{diagnostics:i}=n.state.field(In),s,l=-1,a=-1;i.between(e-(t<0?1:0),e+(t>0?1:0),(h,d,{spec:p})=>{if(e>=h&&e<=d&&(h==d||(e>h||t>0)&&(e<d||t<0)))return s=p.diagnostics,l=h,a=d,!1});let c=n.state.facet(Kc).tooltipFilter;return s&&c&&(s=c(s,n.state)),s?{pos:l,end:a,above:n.state.doc.lineAt(l).to<a,create(){return{dom:uP(n,s)}}}:null}function uP(n,e){return Fe("ul",{class:"cm-tooltip-lint"},e.map(t=>s2(n,t,!1)))}const hP=n=>{let e=n.state.field(In,!1);(!e||!e.panel)&&n.dispatch({effects:oP(n.state,[sv.of(!0)])});let t=Pb(n,Wc.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},cO=n=>{let e=n.state.field(In,!1);return!e||!e.panel?!1:(n.dispatch({effects:sv.of(!1)}),!0)},fP=n=>{let e=n.state.field(In,!1);if(!e)return!1;let t=n.state.selection.main,i=e.diagnostics.iter(t.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==t.from&&i.to==t.to)?!1:(n.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},dP=[{key:"Mod-Shift-m",run:hP,preventDefault:!0},{key:"F8",run:fP}],Kc=te.define({combine(n){return{sources:n.map(e=>e.source).filter(e=>e!=null),...Ki(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:uO,tooltipFilter:uO,needsRefresh:(e,t)=>e?t?i=>e(i)||t(i):e:t,hideOn:(e,t)=>e?t?(i,s,l)=>e(i,s,l)||t(i,s,l):e:t,autoPanel:(e,t)=>e||t})}}});function uO(n,e){return n?e?(t,i)=>e(n(t,i),i):n:e}function i2(n){let e=[];if(n)e:for(let{name:t}of n){for(let i=0;i<t.length;i++){let s=t[i];if(/[a-zA-Z]/.test(s)&&!e.some(l=>l.toLowerCase()==s.toLowerCase())){e.push(s);continue e}}e.push("")}return e}function s2(n,e,t){var i;let s=t?i2(e.actions):[];return Fe("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Fe("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((l,a)=>{let c=!1,h=v=>{if(v.preventDefault(),c)return;c=!0;let w=Ho(n.state.field(In).diagnostics,e);w&&l.apply(n,w.from,w.to)},{name:d}=l,p=s[a]?d.indexOf(s[a]):-1,m=p<0?d:[d.slice(0,p),Fe("u",d.slice(p,p+1)),d.slice(p+1)],b=l.markClass?" "+l.markClass:"";return Fe("button",{type:"button",class:"cm-diagnosticAction"+b,onclick:h,onmousedown:h,"aria-label":` Action: ${d}${p<0?"":` (access key "${s[a]})"`}.`},m)}),e.source&&Fe("div",{class:"cm-diagnosticSource"},e.source))}class pP extends Wi{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Fe("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class hO{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=s2(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Wc{constructor(e){this.view=e,this.items=[];let t=s=>{if(!(s.ctrlKey||s.altKey||s.metaKey)){if(s.keyCode==27)cO(this.view),this.view.focus();else if(s.keyCode==38||s.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(s.keyCode==40||s.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(s.keyCode==36)this.moveSelection(0);else if(s.keyCode==35)this.moveSelection(this.items.length-1);else if(s.keyCode==13)this.view.focus();else if(s.keyCode>=65&&s.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:l}=this.items[this.selectedIndex],a=i2(l.actions);for(let c=0;c<a.length;c++)if(a[c].toUpperCase().charCodeAt(0)==s.keyCode){let h=Ho(this.view.state.field(In).diagnostics,l);h&&l.actions[c].apply(e,h.from,h.to)}}else return;s.preventDefault()}},i=s=>{for(let l=0;l<this.items.length;l++)this.items[l].dom.contains(s.target)&&this.moveSelection(l)};this.list=Fe("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i}),this.dom=Fe("div",{class:"cm-panel-lint"},this.list,Fe("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>cO(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(In).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(In),i=0,s=!1,l=null,a=new Set;for(e.between(0,this.view.state.doc.length,(c,h,{spec:d})=>{for(let p of d.diagnostics){if(a.has(p))continue;a.add(p);let m=-1,b;for(let v=i;v<this.items.length;v++)if(this.items[v].diagnostic==p){m=v;break}m<0?(b=new hO(this.view,p),this.items.splice(i,0,b),s=!0):(b=this.items[m],m>i&&(this.items.splice(i,m-i),s=!0)),t&&b.diagnostic==t.diagnostic?b.dom.hasAttribute("aria-selected")||(b.dom.setAttribute("aria-selected","true"),l=b):b.dom.hasAttribute("aria-selected")&&b.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();this.items.length==0&&(this.items.push(new hO(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),l?(this.list.setAttribute("aria-activedescendant",l.id),this.view.requestMeasure({key:this,read:()=>({sel:l.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:c,panel:h})=>{let d=h.height/this.list.offsetHeight;c.top<h.top?this.list.scrollTop-=(h.top-c.top)/d:c.bottom>h.bottom&&(this.list.scrollTop+=(c.bottom-h.bottom)/d)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let e=this.list.firstChild;function t(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(In),i=Ho(t.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:n2.of(i)})}static open(e){return new Wc(e)}}function gP(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function af(n){return gP(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const mP=ee.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:af("#d11")},".cm-lintRange-warning":{backgroundImage:af("orange")},".cm-lintRange-info":{backgroundImage:af("#999")},".cm-lintRange-hint":{backgroundImage:af("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function yP(n){return n=="error"?4:n=="warning"?3:n=="info"?2:1}function bP(n){let e="hint",t=1;for(let i of n){let s=yP(i.severity);s>t&&(t=s,e=i.severity)}return e}const vP=[In,ee.decorations.compute([In],n=>{let{selected:e,panel:t}=n.field(In);return!e||!t||e.from==e.to?he.none:he.set([aP.range(e.from,e.to)])}),Z8(cP,{hideOn:lP}),mP],wP=[fz(),gz(),D8(),P5(),f5(),v8(),_8(),Ue.allowMultipleSelections.of(!0),Jz(),p5(y5,{fallback:!0}),_5(),WI(),sP(),q8(),G8(),j8(),Y6(),Ub.of([...QI,...$6,...mI,...Y5,...a5,...e2,...dP])];class rv{constructor(e,t){this.yanchor=e,this.yhead=t}toJSON(){return{yanchor:sx(this.yanchor),yhead:sx(this.yhead)}}static fromJSON(e){return new rv(Ec(e.yanchor),Ec(e.yhead))}}class SP{constructor(e,t){this.ytext=e,this.awareness=t,this.undoManager=new VA(e)}toYPos(e,t=0){return G0(this.ytext,e,t)}fromYPos(e){const t=K0(Ec(e),this.ytext.doc);if(t==null||t.type!==this.ytext)throw new Error("[y-codemirror] The position you want to retrieve was created by a different document");return{pos:t.index,assoc:t.assoc}}toYRange(e){const t=e.assoc,i=this.toYPos(e.anchor,t),s=this.toYPos(e.head,t);return new rv(i,s)}fromYRange(e){const t=this.fromYPos(e.yanchor),i=this.fromYPos(e.yhead);return t.pos===i.pos?G.cursor(i.pos,i.assoc):G.range(t.pos,i.pos)}}const Gd=te.define({combine(n){return n[n.length-1]}}),$y=Si.define();class kP{constructor(e){this.view=e,this.conf=e.state.facet(Gd),this._observer=(t,i)=>{if(i.origin!==this.conf){const s=t.delta,l=[];let a=0;for(let c=0;c<s.length;c++){const h=s[c];h.insert!=null?l.push({from:a,to:a,insert:h.insert}):h.delete!=null?(l.push({from:a,to:a+h.delete,insert:""}),a+=h.delete):a+=h.retain}e.dispatch({changes:l,annotations:[$y.of(this.conf)]})}},this._ytext=this.conf.ytext,this._ytext.observe(this._observer)}update(e){if(!e.docChanged||e.transactions.length>0&&e.transactions[0].annotation($y)===this.conf)return;const t=this.conf.ytext;t.doc.transact(()=>{let i=0;e.changes.iterChanges((s,l,a,c,h)=>{const d=h.sliceString(0,h.length,`
`);s!==l&&t.delete(s+i,l-s),d.length>0&&t.insert(s+i,d),i+=d.length-(l-s)})},this.conf)}destroy(){this._ytext.unobserve(this._observer)}}const xP=lt.fromClass(kP),_P=ee.baseTheme({".cm-ySelection":{},".cm-yLineSelection":{padding:0,margin:"0px 2px 0px 4px"},".cm-ySelectionCaret":{position:"relative",borderLeft:"1px solid black",borderRight:"1px solid black",marginLeft:"-1px",marginRight:"-1px",boxSizing:"border-box",display:"inline"},".cm-ySelectionCaretDot":{borderRadius:"50%",position:"absolute",width:".4em",height:".4em",top:"-.2em",left:"-.2em",backgroundColor:"inherit",transition:"transform .3s ease-in-out",boxSizing:"border-box"},".cm-ySelectionCaret:hover > .cm-ySelectionCaretDot":{transformOrigin:"bottom center",transform:"scale(0)"},".cm-ySelectionInfo":{position:"absolute",top:"-1.05em",left:"-1px",fontSize:".75em",fontFamily:"serif",fontStyle:"normal",fontWeight:"normal",lineHeight:"normal",userSelect:"none",color:"white",paddingLeft:"2px",paddingRight:"2px",zIndex:101,transition:"opacity .3s ease-in-out",backgroundColor:"inherit",opacity:0,transitionDelay:"0s",whiteSpace:"nowrap"},".cm-ySelectionCaret:hover > .cm-ySelectionInfo":{opacity:1,transitionDelay:"0s"}}),OP=Si.define();class AP extends Wi{constructor(e,t){super(),this.color=e,this.name=t}toDOM(){return Rm("span",[jn("class","cm-ySelectionCaret"),jn("style",`background-color: ${this.color}; border-color: ${this.color}`)],[Bh(""),Rm("div",[jn("class","cm-ySelectionCaretDot")]),Bh(""),Rm("div",[jn("class","cm-ySelectionInfo")],[Bh(this.name)]),Bh("")])}eq(e){return e.color===this.color}compare(e){return e.color===this.color}updateDOM(){return!1}get estimatedHeight(){return-1}ignoreEvent(){return!0}}class CP{constructor(e){this.conf=e.state.facet(Gd),this._listener=({added:t,updated:i,removed:s},l,a)=>{t.concat(i).concat(s).findIndex(h=>h!==this.conf.awareness.doc.clientID)>=0&&e.dispatch({annotations:[OP.of([])]})},this._awareness=this.conf.awareness,this._awareness.on("change",this._listener),this.decorations=De.of([])}destroy(){this._awareness.off("change",this._listener)}update(e){const t=this.conf.ytext,i=t.doc,s=this.conf.awareness,l=[],a=this.conf.awareness.getLocalState();if(a!=null){const c=e.view.hasFocus&&e.view.dom.ownerDocument.hasFocus(),h=c?e.state.selection.main:null,d=a.cursor==null?null:Ec(a.cursor.anchor),p=a.cursor==null?null:Ec(a.cursor.head);if(h!=null){const m=G0(t,h.anchor),b=G0(t,h.head);(a.cursor==null||!rx(d,m)||!rx(p,b))&&s.setLocalStateField("cursor",{anchor:m,head:b})}else a.cursor!=null&&c&&s.setLocalStateField("cursor",null)}s.getStates().forEach((c,h)=>{if(h===s.doc.clientID)return;const d=c.cursor;if(d==null||d.anchor==null||d.head==null)return;const p=K0(d.anchor,i),m=K0(d.head,i);if(p==null||m==null||p.type!==t||m.type!==t)return;const{color:b="#30bced",name:v="Anonymous"}=c.user||{},w=c.user&&c.user.colorLight||b+"33",k=Xy(p.index,m.index),_=hr(p.index,m.index),O=e.view.state.doc.lineAt(k),R=e.view.state.doc.lineAt(_);if(O.number===R.number)l.push({from:k,to:_,value:he.mark({attributes:{style:`background-color: ${w}`},class:"cm-ySelection"})});else{l.push({from:k,to:O.from+O.length,value:he.mark({attributes:{style:`background-color: ${w}`},class:"cm-ySelection"})}),l.push({from:R.from,to:_,value:he.mark({attributes:{style:`background-color: ${w}`},class:"cm-ySelection"})});for(let C=O.number+1;C<R.number;C++){const U=e.view.state.doc.line(C).from;l.push({from:U,to:U,value:he.line({attributes:{style:`background-color: ${w}`,class:"cm-yLineSelection"}})})}}l.push({from:m.index,to:m.index,value:he.widget({side:m.index-p.index>0?-1:1,block:!1,widget:new AP(b,v)})})}),this.decorations=he.set(l,!0)}}const TP=lt.fromClass(CP,{decorations:n=>n.decorations}),EP=()=>{let n=!0;return(e,t)=>{if(n){n=!1;try{e()}finally{n=!0}}else t!==void 0&&t()}};class DP{constructor(e){this.undoManager=e}addTrackedOrigin(e){this.undoManager.addTrackedOrigin(e)}removeTrackedOrigin(e){this.undoManager.removeTrackedOrigin(e)}undo(){return this.undoManager.undo()!=null}redo(){return this.undoManager.redo()!=null}}const Kd=te.define({combine(n){return n[n.length-1]}});class RP{constructor(e){this.view=e,this.conf=e.state.facet(Kd),this._undoManager=this.conf.undoManager,this.syncConf=e.state.facet(Gd),this._beforeChangeSelection=null,this._mux=EP(),this._onStackItemAdded=({stackItem:t,changedParentTypes:i})=>{i.has(this.syncConf.ytext)&&this._beforeChangeSelection&&!t.meta.has(this)&&t.meta.set(this,this._beforeChangeSelection)},this._onStackItemPopped=({stackItem:t})=>{const i=t.meta.get(this);if(i){const s=this.syncConf.fromYRange(i);e.dispatch(e.state.update({selection:s,effects:[ee.scrollIntoView(s)]})),this._storeSelection()}},this._storeSelection=()=>{this._beforeChangeSelection=this.syncConf.toYRange(this.view.state.selection.main)},this._undoManager.on("stack-item-added",this._onStackItemAdded),this._undoManager.on("stack-item-popped",this._onStackItemPopped),this._undoManager.addTrackedOrigin(this.syncConf)}update(e){e.selectionSet&&(e.transactions.length===0||e.transactions[0].annotation($y)!==this.syncConf)&&this._storeSelection()}destroy(){this._undoManager.off("stack-item-added",this._onStackItemAdded),this._undoManager.off("stack-item-popped",this._onStackItemPopped),this._undoManager.removeTrackedOrigin(this.syncConf)}}const MP=lt.fromClass(RP),NP=({state:n,dispatch:e})=>n.facet(Kd).undo()||!0,LP=({state:n,dispatch:e})=>n.facet(Kd).redo()||!0,BP=(n,e,{undoManager:t=new VA(n)}={})=>{const i=new SP(n,e),s=[Gd.of(i),xP];return e&&s.push(_P,TP),t!==!1&&s.push(Kd.of(new DP(t)),MP,ee.domEventHandlers({beforeinput(l,a){return l.inputType==="historyUndo"?NP(a):l.inputType==="historyRedo"?LP(a):!1}})),s};var fO={};class hd{constructor(e,t,i,s,l,a,c,h,d,p=0,m){this.p=e,this.stack=t,this.state=i,this.reducePos=s,this.pos=l,this.score=a,this.buffer=c,this.bufferBase=h,this.curContext=d,this.lookAhead=p,this.parent=m}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,i=0){let s=e.parser.context;return new hd(e,[],t,i,i,0,[],0,s?new dO(s,s.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let i=e>>19,s=e&65535,{parser:l}=this.p,a=this.reducePos<this.pos-25&&this.setLookAhead(this.pos),c=l.dynamicPrecedence(s);if(c&&(this.score+=c),i==0){this.pushState(l.getGoto(this.state,s,!0),this.reducePos),s<l.minRepeatTerm&&this.storeNode(s,this.reducePos,this.reducePos,a?8:4,!0),this.reduceContext(s,this.reducePos);return}let h=this.stack.length-(i-1)*3-(e&262144?6:0),d=h?this.stack[h-2]:this.p.ranges[0].from,p=this.reducePos-d;p>=2e3&&!(!((t=this.p.parser.nodeSet.types[s])===null||t===void 0)&&t.isAnonymous)&&(d==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=p):this.p.lastBigReductionSize<p&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=d,this.p.lastBigReductionSize=p));let m=h?this.stack[h-1]:0,b=this.bufferBase+this.buffer.length-m;if(s<l.minRepeatTerm||e&131072){let v=l.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(s,d,v,b+4,!0)}if(e&262144)this.state=this.stack[h];else{let v=this.stack[h-3];this.state=l.getGoto(v,s,!0)}for(;this.stack.length>h;)this.stack.pop();this.reduceContext(s,d)}storeNode(e,t,i,s=4,l=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,c=this.buffer.length;if(c==0&&a.parent&&(c=a.bufferBase-a.parent.bufferBase,a=a.parent),c>0&&a.buffer[c-4]==0&&a.buffer[c-1]>-1){if(t==i)return;if(a.buffer[c-2]>=t){a.buffer[c-2]=i;return}}}if(!l||this.pos==i)this.buffer.push(e,t,i,s);else{let a=this.buffer.length;if(a>0&&(this.buffer[a-4]!=0||this.buffer[a-1]<0)){let c=!1;for(let h=a;h>0&&this.buffer[h-2]>i;h-=4)if(this.buffer[h-1]>=0){c=!0;break}if(c)for(;a>0&&this.buffer[a-2]>i;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,s>4&&(s-=4)}this.buffer[a]=e,this.buffer[a+1]=t,this.buffer[a+2]=i,this.buffer[a+3]=s}}shift(e,t,i,s){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let l=e,{parser:a}=this.p;this.pos=s;let c=a.stateFlag(l,1);!c&&(s>i||t<=a.maxNode)&&(this.reducePos=s),this.pushState(l,c?i:Math.min(i,this.reducePos)),this.shiftContext(t,i),t<=a.maxNode&&this.buffer.push(t,i,s,4)}else this.pos=s,this.shiftContext(t,i),t<=this.p.parser.maxNode&&this.buffer.push(t,i,s,4)}apply(e,t,i,s){e&65536?this.reduce(e):this.shift(e,t,i,s)}useNode(e,t){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=e)&&(this.p.reused.push(e),i++);let s=this.pos;this.reducePos=this.pos=s+e.length,this.pushState(t,s),this.buffer.push(i,s,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let i=e.buffer.slice(t),s=e.bufferBase+t;for(;e&&s==e.bufferBase;)e=e.parent;return new hd(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,s,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let i=e<=this.p.parser.maxNode;i&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,i?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new jP(this);;){let i=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(i==0)return!1;if((i&65536)==0)return!0;t.reduce(i)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let s=[];for(let l=0,a;l<t.length;l+=2)(a=t[l+1])!=this.state&&this.p.parser.hasAction(a,e)&&s.push(t[l],a);if(this.stack.length<120)for(let l=0;s.length<8&&l<t.length;l+=2){let a=t[l+1];s.some((c,h)=>h&1&&c==a)||s.push(t[l],a)}t=s}let i=[];for(let s=0;s<t.length&&i.length<4;s+=2){let l=t[s+1];if(l==this.state)continue;let a=this.split();a.pushState(l,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(t[s],this.pos),a.reducePos=this.pos,a.score-=200,i.push(a)}return i}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if((t&65536)==0)return!1;if(!e.validAction(this.state,t)){let i=t>>19,s=t&65535,l=this.stack.length-i*3;if(l<0||e.getGoto(this.stack[l],s,!1)<0){let a=this.findForcedReduction();if(a==null)return!1;t=a}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],i=(s,l)=>{if(!t.includes(s))return t.push(s),e.allActions(s,a=>{if(!(a&393216))if(a&65536){let c=(a>>19)-l;if(c>1){let h=a&65535,d=this.stack.length-c*3;if(d>=0&&e.getGoto(this.stack[d],h,!1)>=0)return c<<19|65536|h}}else{let c=i(a,l+1);if(c!=null)return c}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new dO(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){return e<=this.lookAhead?!1:(this.emitLookAhead(),this.lookAhead=e,!0)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class dO{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class jP{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,i=e>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let s=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=s}}class fd{constructor(e,t,i){this.stack=e,this.pos=t,this.index=i,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new fd(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new fd(this.stack,this.pos,this.index)}}function cf(n,e=Uint16Array){if(typeof n!="string")return n;let t=null;for(let i=0,s=0;i<n.length;){let l=0;for(;;){let a=n.charCodeAt(i++),c=!1;if(a==126){l=65535;break}a>=92&&a--,a>=34&&a--;let h=a-32;if(h>=46&&(h-=46,c=!0),l+=h,c)break;l*=46}t?t[s++]=l:t=new e(l)}return t}class kf{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const pO=new kf;class UP{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=pO,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let i=this.range,s=this.rangeIndex,l=this.pos+e;for(;l<i.from;){if(!s)return null;let a=this.ranges[--s];l-=i.from-a.to,i=a}for(;t<0?l>i.to:l>=i.to;){if(s==this.ranges.length-1)return null;let a=this.ranges[++s];l+=a.from-i.to,i=a}return l}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,i,s;if(t>=0&&t<this.chunk.length)i=this.pos+e,s=this.chunk.charCodeAt(t);else{let l=this.resolveOffset(e,1);if(l==null)return-1;if(i=l,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)s=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let a=this.rangeIndex,c=this.range;for(;c.to<=i;)c=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>c.to&&(this.chunk2=this.chunk2.slice(0,c.to-i)),s=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),s}acceptToken(e,t=0){let i=t?this.resolveOffset(t,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=i}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=pO,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let i="";for(let s of this.ranges){if(s.from>=t)break;s.to>e&&(i+=this.input.read(Math.max(s.from,e),Math.min(s.to,t)))}return i}}class Oo{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:i}=t.p;IP(this.data,e,t,this.id,i.data,i.tokenPrecTable)}}Oo.prototype.contextual=Oo.prototype.fallback=Oo.prototype.extend=!1;Oo.prototype.fallback=Oo.prototype.extend=!1;class zP{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function IP(n,e,t,i,s,l){let a=0,c=1<<i,{dialect:h}=t.p.parser;e:for(;(c&n[a])!=0;){let d=n[a+1];for(let v=a+3;v<d;v+=2)if((n[v+1]&c)>0){let w=n[v];if(h.allows(w)&&(e.token.value==-1||e.token.value==w||PP(w,e.token.value,s,l))){e.acceptToken(w);break}}let p=e.next,m=0,b=n[a+2];if(e.next<0&&b>m&&n[d+b*3-3]==65535){a=n[d+b*3-1];continue e}for(;m<b;){let v=m+b>>1,w=d+v+(v<<1),k=n[w],_=n[w+1]||65536;if(p<k)b=v;else if(p>=_)m=v+1;else{a=n[w+2],e.advance();continue e}}break}}function gO(n,e,t){for(let i=e,s;(s=n[i])!=65535;i++)if(s==t)return i-e;return-1}function PP(n,e,t,i){let s=gO(t,i,e);return s<0||gO(t,i,n)<s}const Rn=typeof process<"u"&&fO&&/\bparse\b/.test(fO.LOG);let A0=null;function mO(n,e,t){let i=n.cursor(ut.IncludeAnonymous);for(i.moveTo(e);;)if(!(t<0?i.childBefore(e):i.childAfter(e)))for(;;){if((t<0?i.to<e:i.from>e)&&!i.type.isError)return t<0?Math.max(0,Math.min(i.to-1,e-25)):Math.min(n.length,Math.max(i.from+1,e+25));if(t<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return t<0?0:n.length}}class HP{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?mO(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?mO(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let i=this.trees[t],s=this.index[t];if(s==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let l=i.children[s],a=this.start[t]+i.positions[s];if(a>e)return this.nextStart=a,null;if(l instanceof mt){if(a==e){if(a<this.safeFrom)return null;let c=a+l.length;if(c<=this.safeTo){let h=l.prop(Re.lookAhead);if(!h||c+h<this.fragment.to)return l}}this.index[t]++,a+l.length>=Math.max(this.safeFrom,e)&&(this.trees.push(l),this.start.push(a),this.index.push(0))}else this.index[t]++,this.nextStart=a+l.length}}}class qP{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(i=>new kf)}getActions(e){let t=0,i=null,{parser:s}=e.p,{tokenizers:l}=s,a=s.stateSlot(e.state,3),c=e.curContext?e.curContext.hash:0,h=0;for(let d=0;d<l.length;d++){if((1<<d&a)==0)continue;let p=l[d],m=this.tokens[d];if(!(i&&!p.fallback)&&((p.contextual||m.start!=e.pos||m.mask!=a||m.context!=c)&&(this.updateCachedToken(m,p,e),m.mask=a,m.context=c),m.lookAhead>m.end+25&&(h=Math.max(m.lookAhead,h)),m.value!=0)){let b=t;if(m.extended>-1&&(t=this.addActions(e,m.extended,m.end,t)),t=this.addActions(e,m.value,m.end,t),!p.extend&&(i=m,t>b))break}}for(;this.actions.length>t;)this.actions.pop();return h&&e.setLookAhead(h),!i&&e.pos==this.stream.end&&(i=new kf,i.value=e.p.parser.eofTerm,i.start=i.end=e.pos,t=this.addActions(e,i.value,i.end,t)),this.mainToken=i,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new kf,{pos:i,p:s}=e;return t.start=i,t.end=Math.min(i+1,s.stream.end),t.value=i==s.stream.end?s.parser.eofTerm:0,t}updateCachedToken(e,t,i){let s=this.stream.clipPos(i.pos);if(t.token(this.stream.reset(s,e),i),e.value>-1){let{parser:l}=i.p;for(let a=0;a<l.specialized.length;a++)if(l.specialized[a]==e.value){let c=l.specializers[a](this.stream.read(e.start,e.end),i);if(c>=0&&i.p.parser.dialect.allows(c>>1)){(c&1)==0?e.value=c>>1:e.extended=c>>1;break}}}else e.value=0,e.end=this.stream.clipPos(s+1)}putAction(e,t,i,s){for(let l=0;l<s;l+=3)if(this.actions[l]==e)return s;return this.actions[s++]=e,this.actions[s++]=t,this.actions[s++]=i,s}addActions(e,t,i,s){let{state:l}=e,{parser:a}=e.p,{data:c}=a;for(let h=0;h<2;h++)for(let d=a.stateSlot(l,h?2:1);;d+=3){if(c[d]==65535)if(c[d+1]==1)d=ds(c,d+2);else{s==0&&c[d+1]==2&&(s=this.putAction(ds(c,d+2),t,i,s));break}c[d]==t&&(s=this.putAction(ds(c,d+1),t,i,s))}return s}}class VP{constructor(e,t,i,s){this.parser=e,this.input=t,this.ranges=s,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new UP(t,s),this.tokens=new qP(e,this.stream),this.topTerm=e.top[1];let{from:l}=s[0];this.stacks=[hd.start(this,e.top[0],l)],this.fragments=i.length&&this.stream.end-l>e.bufferLength*4?new HP(i,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,i=this.stacks=[],s,l;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let c=e[a];for(;;){if(this.tokens.mainToken=null,c.pos>t)i.push(c);else{if(this.advanceStack(c,i,e))continue;{s||(s=[],l=[]),s.push(c);let h=this.tokens.getMainToken(c);l.push(h.value,h.end)}}break}}if(!i.length){let a=s&&GP(s);if(a)return Rn&&console.log("Finish with "+this.stackID(a)),this.stackToTree(a);if(this.parser.strict)throw Rn&&s&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&s){let a=this.stoppedAt!=null&&s[0].pos>this.stoppedAt?s[0]:this.runRecovery(s,l,i);if(a)return Rn&&console.log("Force-finish "+this.stackID(a)),this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(i.length>a)for(i.sort((c,h)=>h.score-c.score);i.length>a;)i.pop();i.some(c=>c.reducePos>t)&&this.recovering--}else if(i.length>1){e:for(let a=0;a<i.length-1;a++){let c=i[a];for(let h=a+1;h<i.length;h++){let d=i[h];if(c.sameState(d)||c.buffer.length>500&&d.buffer.length>500)if((c.score-d.score||c.buffer.length-d.buffer.length)>0)i.splice(h--,1);else{i.splice(a--,1);continue e}}}i.length>12&&(i.sort((a,c)=>c.score-a.score),i.splice(12,i.length-12))}this.minStackPos=i[0].pos;for(let a=1;a<i.length;a++)i[a].pos<this.minStackPos&&(this.minStackPos=i[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,i){let s=e.pos,{parser:l}=this,a=Rn?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&s>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let d=e.curContext&&e.curContext.tracker.strict,p=d?e.curContext.hash:0;for(let m=this.fragments.nodeAt(s);m;){let b=this.parser.nodeSet.types[m.type.id]==m.type?l.getGoto(e.state,m.type.id):-1;if(b>-1&&m.length&&(!d||(m.prop(Re.contextHash)||0)==p))return e.useNode(m,b),Rn&&console.log(a+this.stackID(e)+` (via reuse of ${l.getName(m.type.id)})`),!0;if(!(m instanceof mt)||m.children.length==0||m.positions[0]>0)break;let v=m.children[0];if(v instanceof mt&&m.positions[0]==0)m=v;else break}}let c=l.stateSlot(e.state,4);if(c>0)return e.reduce(c),Rn&&console.log(a+this.stackID(e)+` (via always-reduce ${l.getName(c&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let h=this.tokens.getActions(e);for(let d=0;d<h.length;){let p=h[d++],m=h[d++],b=h[d++],v=d==h.length||!i,w=v?e:e.split(),k=this.tokens.mainToken;if(w.apply(p,m,k?k.start:w.pos,b),Rn&&console.log(a+this.stackID(w)+` (via ${(p&65536)==0?"shift":`reduce of ${l.getName(p&65535)}`} for ${l.getName(m)} @ ${s}${w==e?"":", split"})`),v)return!0;w.pos>s?t.push(w):i.push(w)}return!1}advanceFully(e,t){let i=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>i)return yO(e,t),!0}}runRecovery(e,t,i){let s=null,l=!1;for(let a=0;a<e.length;a++){let c=e[a],h=t[a<<1],d=t[(a<<1)+1],p=Rn?this.stackID(c)+" -> ":"";if(c.deadEnd&&(l||(l=!0,c.restart(),Rn&&console.log(p+this.stackID(c)+" (restarted)"),this.advanceFully(c,i))))continue;let m=c.split(),b=p;for(let v=0;v<10&&m.forceReduce()&&(Rn&&console.log(b+this.stackID(m)+" (via force-reduce)"),!this.advanceFully(m,i));v++)Rn&&(b=this.stackID(m)+" -> ");for(let v of c.recoverByInsert(h))Rn&&console.log(p+this.stackID(v)+" (via recover-insert)"),this.advanceFully(v,i);this.stream.end>c.pos?(d==c.pos&&(d++,h=0),c.recoverByDelete(h,d),Rn&&console.log(p+this.stackID(c)+` (via recover-delete ${this.parser.getName(h)})`),yO(c,i)):(!s||s.score<m.score)&&(s=m)}return s}stackToTree(e){return e.close(),mt.build({buffer:fd.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(A0||(A0=new WeakMap)).get(e);return t||A0.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function yO(n,e){for(let t=0;t<e.length;t++){let i=e[t];if(i.pos==n.pos&&i.sameState(n)){e[t].score<n.score&&(e[t]=n);return}}e.push(n)}class $P{constructor(e,t,i){this.source=e,this.flags=t,this.disabled=i}allows(e){return!this.disabled||this.disabled[e]==0}}class dd extends VT{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let c=0;c<e.repeatNodeCount;c++)t.push("");let i=Object.keys(e.topRules).map(c=>e.topRules[c][1]),s=[];for(let c=0;c<t.length;c++)s.push([]);function l(c,h,d){s[c].push([h,h.deserialize(String(d))])}if(e.nodeProps)for(let c of e.nodeProps){let h=c[0];typeof h=="string"&&(h=Re[h]);for(let d=1;d<c.length;){let p=c[d++];if(p>=0)l(p,h,c[d++]);else{let m=c[d+-p];for(let b=-p;b>0;b--)l(c[d++],h,m);d++}}}this.nodeSet=new Hb(t.map((c,h)=>vn.define({name:h>=this.minRepeatTerm?void 0:c,id:h,props:s[h],top:i.indexOf(h)>-1,error:h==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(h)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=IT;let a=cf(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let c=0;c<this.specializerSpecs.length;c++)this.specialized[c]=this.specializerSpecs[c].term;this.specializers=this.specializerSpecs.map(bO),this.states=cf(e.states,Uint32Array),this.data=cf(e.stateData),this.goto=cf(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(c=>typeof c=="number"?new Oo(a,c):c),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,i){let s=new VP(this,e,t,i);for(let l of this.wrappers)s=l(s,e,t,i);return s}getGoto(e,t,i=!1){let s=this.goto;if(t>=s[0])return-1;for(let l=s[t+1];;){let a=s[l++],c=a&1,h=s[l++];if(c&&i)return h;for(let d=l+(a>>1);l<d;l++)if(s[l]==e)return h;if(c)return-1}}hasAction(e,t){let i=this.data;for(let s=0;s<2;s++)for(let l=this.stateSlot(e,s?2:1),a;;l+=3){if((a=i[l])==65535)if(i[l+1]==1)a=i[l=ds(i,l+2)];else{if(i[l+1]==2)return ds(i,l+2);break}if(a==t||a==0)return ds(i,l+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,i=>i==t?!0:null)}allActions(e,t){let i=this.stateSlot(e,4),s=i?t(i):void 0;for(let l=this.stateSlot(e,1);s==null;l+=3){if(this.data[l]==65535)if(this.data[l+1]==1)l=ds(this.data,l+2);else break;s=t(ds(this.data,l+1))}return s}nextStates(e){let t=[];for(let i=this.stateSlot(e,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=ds(this.data,i+2);else break;if((this.data[i+2]&1)==0){let s=this.data[i+1];t.some((l,a)=>a&1&&l==s)||t.push(this.data[i],s)}}return t}configure(e){let t=Object.assign(Object.create(dd.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let i=this.topRules[e.top];if(!i)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=i}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(i=>{let s=e.tokenizers.find(l=>l.from==i);return s?s.to:i})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((i,s)=>{let l=e.specializers.find(c=>c.from==i.external);if(!l)return i;let a=Object.assign(Object.assign({},i),{external:l.to});return t.specializers[s]=bO(a),a})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),i=t.map(()=>!1);if(e)for(let l of e.split(" ")){let a=t.indexOf(l);a>=0&&(i[a]=!0)}let s=null;for(let l=0;l<t.length;l++)if(!i[l])for(let a=this.dialects[t[l]],c;(c=this.data[a++])!=65535;)(s||(s=new Uint8Array(this.maxTerm+1)))[c]=1;return new $P(e,i,s)}static deserialize(e){return new dd(e)}}function ds(n,e){return n[e]|n[e+1]<<16}function GP(n){let e=null;for(let t of n){let i=t.p.stoppedAt;(t.pos==t.p.stream.end||i!=null&&t.pos>i)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function bO(n){if(n.external){let e=n.extend?1:0;return(t,i)=>n.external(t,i)<<1|e}return n.get}const KP=1,WP=2,FP=3,vO=4,wO=5,SO=6,YP=7,XP=8,kO=9,QP=10,JP=11,ZP=12,eH=13,tH=14,Mn=10,ui=32,xO=9,_O=42,OO=47,AO=58,nH=40,iH=41,Qa=61,sH=62,rH=60,lH=64,oH=97,aH=122,cH=84,uH=79,hH=33,CO=65,TO=90;class fH{constructor(){this.inBoneyard=!1}token(e,t){const i=e.pos;if(e.peek(0)===OO&&e.peek(1)===_O&&!this.inBoneyard){this.inBoneyard=!0,e.advance(2),e.acceptToken(ZP);return}if(e.peek(0)===_O&&e.peek(1)===OO&&this.inBoneyard){this.inBoneyard=!1,e.advance(2),e.acceptToken(eH);return}if(t.canShift(wO)){let D=0;for(;e.peek(D)!==Mn&&e.peek(D)!==-1;)D++;let W=D;for(;!(e.peek(W)===-1||e.peek(W)!==Mn);){let ne=W+1;const Ce=e.peek(ne)===xO,de=e.peek(ne)===ui&&e.peek(ne+1)===ui;if(Ce||de){let J=ne;for(;e.peek(J)!==Mn&&e.peek(J)!==-1;)J++;D=J,W=J}else break}e.advance(D),e.acceptToken(wO);return}if(e.peek(0)===rH){let D=1;for(;e.peek(D)===ui;)D++;const W=e.peek(D);if(W===Mn||W===-1){e.advance(1),e.acceptToken(JP);return}}if(!(i===0||e.peek(-1)===Mn))return;let l=0;for(;;){const D=e.peek(l);if(D===ui||D===xO){l++;continue}if(D===Mn){e.advance(l+1),e.acceptToken(tH);return}break}if(e.peek(0)===sH){e.advance(1),e.acceptToken(QP);return}if(e.peek(0)===Qa&&e.peek(1)!==Qa){e.advance(1),e.acceptToken(XP);return}if(e.peek(0)===Qa&&e.peek(1)===Qa&&e.peek(2)===Qa){const D=e.peek(3);if(D===Mn||D===-1){e.advance(3),e.acceptToken(WP);return}}let a=i,c=-1,h=!1;for(;;){const D=e.peek(a-i);if(D===-1||D===Mn)break;D===AO&&(c=a),D!==ui&&c===-1&&(h=!0),a++}if(c!==-1&&h&&t.canShift(vO)){e.advance(c-i+1),e.acceptToken(vO);return}const d=["INT./EXT.","INT/EXT.","INT.","EXT.","I/E."];let p="";for(let D=0;D<10;D++){const W=e.peek(D);if(W===-1)break;p+=String.fromCharCode(W)}for(const D of d)if(p.startsWith(D)){e.advance(D.length),e.acceptToken(kO);return}if(e.peek(0)===46){const D=e.peek(1);if(D!==46&&D!==Mn&&D!==-1&&D!==ui){e.advance(1),e.acceptToken(kO);return}}if(e.peek(0)===hH){e.advance(1),e.acceptToken(KP);return}const m=()=>{if(i===0)return!0;let D=e.peek(-2);return D===13&&(D=e.peek(-3)),D===Mn},b=D=>{let W=D;for(e.peek(W-i)===13&&W++,e.peek(W-i)===Mn&&W++;e.peek(W-i)===ui;)W++;const ne=e.peek(W-i);return ne!==Mn&&ne!==-1};let v=i,w=!1,k=i,_=-1,O=-1,R=!1;for(;;){const D=e.peek(v-i);if(D===-1||D===Mn)break;D>=oH&&D<=aH&&(w=!0),D!==ui&&(k=v+1,O=D,R=!0),D===nH&&_===-1&&(_=v),v++}if(!R)return;let C=!1;if(e.peek(k-i-1)===94){for(C=!0,k--;k>i&&e.peek(k-i-1)===ui;)k--;O=e.peek(k-i-1)}if(e.peek(0)===lH&&m()&&b(v)){let D=_!==-1?_:k;for(;D>i&&e.peek(D-i-1)===ui;)D--;e.advance(D-i),e.acceptToken(SO);return}if(w)return;if(v-i>3&&e.peek(k-i-3)===cH&&e.peek(k-i-2)===uH&&e.peek(k-i-1)===AO){e.advance(v-i),e.acceptToken(YP);return}const U=e.peek(0),B=e.peek(1);if(U>=CO&&U<=TO&&B>=CO&&B<=TO&&m()&&b(v)&&(_===-1||_!==-1&&O===iH)){let W=_!==-1?_:k;for(;W>i&&e.peek(W-i-1)===ui;)W--;C?(e.advance(W-i),e.acceptToken(FP)):(e.advance(W-i),e.acceptToken(SO));return}}}const EO=new fH,dH=new zP(EO.token.bind(EO)),pH=dd.deserialize({version:14,states:".WO!_OROOO!fOPO'#DfO!kOPO'#ClO!sORO'#CtO!sORO'#CvO!sORO'#CxO!sORO'#CzO!sORO'#C}O#_ORO'#CsOOOP'#Cs'#CsO!sORO'#CqOOOP'#Di'#DiO$rORO'#CpO$uORO'#DSO$uORO'#DUO$|ORO'#D]O%UOQO'#DWO%aOQO'#DVO%fOQO'#D[O%qOQO'#DZO%vORO'#D^OOOP'#Do'#DoO&TORO'#DbO$uORO'#DcO&bOQO'#DdO&gOQO'#DeOOOP'#Co'#CoO&lORO'#CnOOOP'#Dg'#DgQQOROOOQOROOO&sOQO,5:QOOOP-E7d-E7dO&xOPO,59WO'fORO,59`OOOP'#Dj'#DjO(UORO,59bO(tORO,59dO)dORO,59fO)kORO,59iO)rORO,59]OOOP-E7g-E7gOOOP,59[,59[O)yORO,59nO*TORO,59pO*bOQO,59oOOOP,59w,59wOOOO'#Dk'#DkO*gOQO,59rO*rORO,59qO*yOQO,59vO*rORO,59uOOOP'#Dm'#DmO+UORO,59xO+cOSO'#D_OOOP,59x,59xO+kOQO,59xO+pORO,59|OOOP-E7m-E7mOOOP,59|,59|O+zORO,59}OOOP,5:O,5:OOOOP,5:P,5:POOOP'#Dh'#DhO,UORO,59YOOOP,59Y,59YOOOP-E7e-E7eOOOP1G/l1G/lOOOP1G.r1G.rO,]ORO1G.zOOOP-E7h-E7hO-ZORO1G.|O.XORO1G/OO/VORO1G/QOOOP1G/T1G/TOOOP1G.w1G.wOOOP1G/Y1G/YOOOP1G/Z1G/ZOOOO-E7i-E7iO0TORO'#DXO!sORO'#DYO0[OQO'#DlO0aORO1G/]O1^ORO1G/aOOOP-E7k-E7kOOOP1G/d1G/dO2ZOQO1G/dOOOO'#Dn'#DnO2`OSO,59yOOOO,59y,59yOOOP1G/h1G/hOOOP1G/i1G/iOOOP-E7f-E7fOOOP1G.t1G.tO2hORO,59tOOOP,5:W,5:WOOOP-E7j-E7jOOOP7+%O7+%OOOOO-E7l-E7lOOOO1G/e1G/eOOOO1G/`1G/`",stateData:"2|~OP]OQiORbOU`OVhOWgOXdOY^O[kO^jOfYOiROkSOmTOoUOpXOrVOtXO!SeO~OSPO~PQOToO~OSPO^qO~O[kOiROkSOmTOoUOpXOrVOtXO~OP!ZXQ!ZXR!ZXU!ZXV!ZXW!ZXX!ZXY!ZX[gX^!ZXagXfgXigXkgXmgXogXpgXrgXtgX!S!ZX!d!ZX~OazOfYO~P!sOZ}Oa!OO~OfYOt!POazX~Oa!RO~OfYOt!POa!OX~Oa!TO~Oa!XOfYO!S!WO~P!sOa!]OfYO!SeO~P!sOa!_O~Oa!`O~O]!cO~PQOa!eO~O^!fO~O[kOkSOmTOoUOpXOrVOtXO~Oi!gO~P&}O[kOiROmTOoUOpXOrVOtXO~Ok!iO~P'mO[kOiROkSOoUOpXOrVOtXO~Om!jO~P(]O[kOiROkSOmTOpXOrVOtXO~Oo!kO~P({Os!lO~P!sOu!mO~P!sOa!nOfYO~P!sOfYOZxaaxa~P!sOa!oO~OfYOt!POaza~Of!rO~P!sOfYOt!POa!Oa~Oa!wOfYO!S!WO~P!sO!S!{O!T!yO~Oa!wO~Oa!|OfYO~P!sOa!}OfYO~P!sO]#PO~PQO[kOahifhiihikhimhiohiphirhithishiuhiZhi!Shi~O[kOajifjiijikjimjiojipjirjitjisjiujiZji!Sji~O[kOalifliiliklimlioliplirlitlisliuliZli!Sli~O[kOanifniiniknimnionipnirnitnisniuniZni!Sni~Oa{X~P!sOa#RO~Of!rOPyiQyiRyiUyiVyiWyiXyiYyi^yi!Syi!dyi]yi~P!sOf!rOP}iQ}iR}iU}iV}iW}iX}iY}i^}i!S}i!d}i]}i~P!sOa#TO~O!S#VO!T!yO~Ou#WO~P!sOrs!Sfukmoitpk~",goto:")n!dPPPPPPPPPPPPPPPP!eP!h#e#n#uP$a%`P%`P%`P%`PP%`PPPP#n#n&V#n&^&e&e#n&k#n#n&rPP#n#n#n#n&x'O'V']'w(r(|)W)^)dRnOUWOmn!kXRSTUVY[]^dfgkrtuvwx{|!R!T!V!Z!^!b!g!i!j!k!q!r!t!u#QUlOmnT!ak!bZjOkmn!blZO[]^fgkmn{|!Z!^!bW!P`b!Q!ST!Ud!VlZO[]^fgkmn{|!Z!^!b!OsRSTUVYrtuvwx!R!T!g!i!j!k!q!r!t!u#QT!Ud!V!iXORSTUVY[]^dfgkmnrtuvwx{|!R!T!V!Z!^!b!q!r!t!u#QZ_Okmn!bZaOkmn!bX!s!R!T!t!uZcOkmn!bQ!YdR!x!VQQORpQSmOnR!dmQ!bkR#O!bY[Okmn!bYy[{|!Z!^Q{]Q|^Q!ZfR!^gSrR!gStS!iSuT!jSvU!kQwVQxY`!hrtuvwx!q#QW!q!R!T!t!uR#Q!rQ!Q`Q!SbT!p!Q!SQ!t!RQ!u!TT#S!t!uQ!VdR!v!VQ!z!WR#U!zYfOkmn!bR![f",nodeNames:" ForceActionMark PageBreak DualCharacter TitleKey TitleValue Character Transition SynopsisMark SceneHeading GreaterThan LessThan BoneStart BoneEnd EmptyLine Screenplay TitlePage Newline Boneyard Element ActionLine LineParenthetical LParen Inline Underline Underscore ItalicBold TripleAsterisks Bold DoubleAsterisks Italic SingleAsterisk PlainText Note NoteStart NoteEnd WhiteSpace RParen ForcedActionLine CenterLine ForceRight CharacterBlock CharacterCue DialogueLine Parenthetical DualCharacterBlock DualCharacterCue ForceTransition SceneHeadingLine SceneNumber SectionMark Numbers SectionLine SynopsisLine TransitionLine PageBreakLine",maxTerm:66,skippedNodes:[0],repeatNodeCount:10,tokenData:"&V~RdOY!aYZ#XZp!apq#^qs!ast$Qtx!axy$Vyz$[z{$a{!P!a!Q![$v![!^!a!_!}!a!}#O%j#P#Q%u#R#S&Q#S;'S!a;'S;=`#R<%lO!aP!fXpPOY!aZs!atx!a{!P!a!Q!^!a!_!}!a#S;'S!a;'S;=`#R<%lO!aP#UP;=`<%l!a~#^Oa~~#eXt~pPOY!aZs!atx!a{!P!a!Q!^!a!_!}!a#S;'S!a;'S;=`#R<%lO!a~$VO!S~~$[Of~~$aOu~~$fPo~z{$i~$nPm~z{$q~$vOk~R$}X!TQpPOY!aZs!atx!a{!P!a!Q!^!a!_!}!a#S;'S!a;'S;=`#R<%lO!a~%mP!}#O%p~%uOr~~%xP#P#Q%{~&QOs~~&VOi~",tokenizers:[dH,0,1],topRules:{Screenplay:[0,15]},tokenPrec:813}),gH=Jf.define({parser:pH}),mH=new Map([["SceneHeadingLine","cm-fountain-scene"],["ActionLine","cm-fountain-action"],["ForcedActionLine","cm-fountain-action"],["CharacterCue","cm-fountain-character"],["DualCharacterCue","cm-fountain-character"],["Parenthetical","cm-fountain-parenthetical"],["DialogueLine","cm-fountain-dialogue"],["TransitionLine","cm-fountain-transition"],["ForceTransition","cm-fountain-right"],["CenterLine","cm-fountain-center"],["SectionLine","cm-fountain-section"],["SynopsisLine","cm-fountain-synopsis"]]),DO=n=>{const e=new qi,t=new Map;for(const{from:i,to:s}of n.visibleRanges)Kt(n.state).iterate({from:i,to:s,enter:l=>{const a=mH.get(l.type.name);if(!a)return;const c=n.state.doc.lineAt(l.from);t.has(c.from)||t.set(c.from,a)}});for(const[i,s]of t.entries())e.add(i,i,he.line({class:s}));return e.finish()},yH=lt.fromClass(class{constructor(n){this.view=n,this.decorations=DO(n)}decorations;update(n){(n.docChanged||n.viewportChanged)&&(this.decorations=DO(n.view))}},{decorations:n=>n.decorations}),bH=ee.theme({"&":{height:"100vh",backgroundColor:"transparent",color:"#e0e0e0"},".cm-scroller":{overflow:"auto",fontFamily:"'Courier Prime', 'Courier', monospace"},".cm-content":{caretColor:"white",margin:"0 auto",maxWidth:"60ch",paddingLeft:"2.5ch",paddingRight:"2.5ch",paddingTop:"50vh",paddingBottom:"50vh"},".cm-cursor":{borderLeftColor:"white",borderLeftWidth:"2px"},".cm-gutters":{display:"none"},".cm-activeLine":{backgroundColor:"transparent"},".cm-activeLineGutter":{backgroundColor:"transparent"}}),vH=({isReadOnly:n,ytext:e,awareness:t})=>[wP,bH,gH,yH,Ue.readOnly.of(n),BP(e,t),ee.lineWrapping,ee.scrollMargins.of(i=>{const l=i.dom.clientHeight/2;return{top:l-10,bottom:l-10}})],wH=({editorRef:n,doc:e,supabase:t,documentId:i,currentUserEmail:s,isReadOnly:l,permissionLoaded:a,accessDenied:c,loadDocument:h})=>{pe.useEffect(()=>{if(!a||c||!n.current)return;const d=new Sz(e,t,i),p=e.getText("codemirror");d.awareness.setLocalStateField("user",{name:s?.split("@")[0]||"Anonymous",color:"#30bced"});const m=Ue.create({doc:p.toString(),extensions:vH({isReadOnly:l,ytext:p,awareness:d.awareness})}),b=new ee({state:m,parent:n.current});return h(i),()=>{b.destroy(),d.destroy()}},[n,e,t,i,s,l,a,c,h])},SH=({documentId:n,supabase:e,currentUserEmail:t,onSetIsOwner:i,onAuthRequired:s})=>{const l=pe.useRef(null),[a]=pe.useState(()=>new rl),{status:c,loadDocument:h,saveUpdate:d,cancelSave:p}=Yj(e,a),{permissionLoaded:m,isReadOnly:b,accessDenied:v,isOwner:w,requiresAuth:k}=lU(e,n,t);return pe.useEffect(()=>{k&&s()},[k,s]),pe.useEffect(()=>{i(w)},[w,i]),pe.useEffect(()=>{if(!m||v)return;const _=(O,R)=>{b||R==="remote"||R==="db-load"||d(n,O)};return a.on("update",_),()=>{a.off("update",_),p()}},[a,n,b,m,v,d,p]),wH({editorRef:l,doc:a,supabase:e,documentId:n,currentUserEmail:t,isReadOnly:b,permissionLoaded:m,accessDenied:v||k,loadDocument:h}),v?H.jsxs("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:20},children:[H.jsx("h2",{style:{color:"#e0e0e0"},children:"Access Denied"}),H.jsx("p",{style:{color:"#888"},children:"You do not have permission to view this screenplay."}),H.jsx("a",{href:"/",style:{color:"#30bced"},children:"Back to Home"})]}):!m||k?H.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:"Loading screenplay..."}):H.jsxs(H.Fragment,{children:[H.jsx("div",{ref:l,style:{width:"100%",height:"100vh",outline:"none"}}),H.jsx("div",{style:{position:"fixed",bottom:20,right:20,color:"#666",fontFamily:"sans-serif",fontSize:"12px",pointerEvents:"none"},children:b?"Read Only":H.jsxs(H.Fragment,{children:[c==="loading"&&"Loading...",c==="saving"&&"Saving...",c==="saved"&&"Saved",c==="error"&&"Sync Error"]})})]})},kH=(n,e,t)=>n.auth.signInWithPassword({email:e,password:t}),xH=(n,e,t)=>n.auth.signUp({email:e,password:t}),_H=(n,e)=>n.auth.signInWithOAuth({provider:"google",options:{redirectTo:e}}),OH=({supabase:n})=>{const[e,t]=pe.useState(!1),[i,s]=pe.useState(""),[l,a]=pe.useState(""),[c,h]=pe.useState(!0),[d,p]=pe.useState(""),m=async()=>{t(!0),p("");try{const{error:v}=await _H(n,window.location.origin);if(v)throw v}catch(v){p(v.message),t(!1)}},b=async v=>{v.preventDefault(),t(!0),p("");try{if(c){const{error:w}=await kH(n,i,l);if(w)throw w}else{const{error:w}=await xH(n,i,l);if(w)throw w;p("Check your email for the login link!")}}catch(w){p(w.message)}finally{t(!1)}};return H.jsxs("div",{className:"auth-shell",children:[H.jsxs("header",{className:"auth-nav",children:[H.jsx("div",{className:"auth-logo",children:"ArcScript"}),H.jsx("button",{className:"auth-nav-btn",onClick:()=>h(!c),children:c?"Sign Up":"Log In"})]}),H.jsxs("main",{className:"auth-hero",children:[H.jsxs("div",{className:"auth-hero-copy",children:[H.jsx("p",{className:"auth-kicker",children:"Collaborative Screenwriting"}),H.jsx("h1",{className:"auth-title",children:"A modern, focused space for screenplays."}),H.jsx("p",{className:"auth-subtitle",children:"Write in Fountain with live formatting, share instantly, and collaborate in real time."}),H.jsxs("div",{className:"auth-hero-actions",children:[H.jsx("button",{className:"auth-primary",onClick:()=>h(!0),children:"Start writing"}),H.jsx("button",{className:"auth-secondary",onClick:()=>h(!1),children:"Create account"})]}),H.jsx("div",{className:"auth-trust",children:"Simple, fast, and private by default. Your scripts stay yours."})]}),H.jsxs("div",{className:"auth-card",children:[H.jsxs("div",{className:"auth-card-header",children:[H.jsx("h2",{children:c?"Welcome back":"Create your account"}),H.jsx("p",{children:"Continue with Google or use email."})]}),H.jsx("button",{className:"auth-google-btn",onClick:m,disabled:e,children:"Continue with Google"}),H.jsx("div",{className:"auth-divider",children:H.jsx("span",{children:"or"})}),H.jsxs("form",{onSubmit:b,className:"auth-form",children:[H.jsx("input",{className:"auth-input",type:"email",placeholder:"Email",value:i,onChange:v=>s(v.target.value),required:!0}),H.jsx("input",{className:"auth-input",type:"password",placeholder:"Password",value:l,onChange:v=>a(v.target.value),required:!0}),H.jsx("button",{type:"submit",disabled:e,className:"auth-button",children:e?"Processing...":c?"Log In":"Sign Up"})]}),H.jsx("p",{className:"auth-toggle",onClick:()=>h(!c),children:c?"Need an account? Sign Up":"Have an account? Log In"}),d&&H.jsx("p",{className:"auth-error",children:d})]})]})]})},r2=pe.createContext(null),AH=()=>Math.random().toString(36).slice(2),CH=({children:n})=>{const[e,t]=pe.useState([]),i=pe.useCallback((l,a="info")=>{const c=AH();t(h=>[...h,{id:c,message:l,tone:a}]),setTimeout(()=>{t(h=>h.filter(d=>d.id!==c))},3e3)},[]),s=pe.useMemo(()=>({addToast:i}),[i]);return H.jsxs(r2.Provider,{value:s,children:[n,H.jsx("div",{className:"toast-stack","aria-live":"polite",children:e.map(l=>H.jsx("div",{className:`toast toast-${l.tone??"info"}`,children:l.message},l.id))})]})},l2=()=>{const n=pe.useContext(r2);if(!n)throw new Error("useToast must be used within ToastProvider");return n},TH=({supabase:n,userId:e,onOpenDocument:t,onShare:i,onClose:s})=>{const[l,a]=pe.useState([]),[c,h]=pe.useState(!0),[d,p]=pe.useState(""),[m,b]=pe.useState(null),[v,w]=pe.useState(""),{addToast:k}=l2();pe.useEffect(()=>{_()},[]);const _=async()=>{try{const B=await Qj(n);a(B)}catch{a([]),k("Failed to load documents.","error")}h(!1)},O=async()=>{if(d.trim())try{const B=await Jj(n,d,e);t(B.id)}catch{k("Failed to create document.","error")}},R=async(B,z)=>{if(z.stopPropagation(),!!confirm("Are you sure?"))try{await Zj(n,B),_()}catch{k("Failed to delete document.","error")}},C=(B,z)=>{B.stopPropagation(),z.owner_id===e&&(b(z.id),w(z.title))},U=async B=>{if(v.trim())try{await eU(n,B,v),b(null),_()}catch{k("Failed to rename document.","error")}};return H.jsx("div",{className:"dashboard-overlay",children:H.jsxs("div",{className:"dashboard-modal dashboard-docs ui-card",children:[H.jsxs("div",{className:"dashboard-header docs-header",children:[H.jsxs("div",{children:[H.jsx("h2",{children:"My Screenplays"}),H.jsx("p",{className:"docs-subtitle",children:"Recent files and shared projects"})]}),H.jsxs("div",{className:"docs-actions",children:[H.jsx("button",{onClick:O,className:"docs-primary-btn ui-btn ui-btn-primary",children:"New"}),H.jsx("button",{onClick:s,className:"docs-close ui-btn ui-btn-ghost",children:"Close"})]})]}),H.jsx("div",{className:"docs-toolbar",children:H.jsxs("div",{className:"docs-search",children:[H.jsx("input",{className:"docs-search-input ui-input",value:d,onChange:B=>p(B.target.value),placeholder:"New screenplay title...",onKeyDown:B=>B.key==="Enter"&&O()}),H.jsx("button",{onClick:O,className:"docs-create-btn ui-btn",children:"Create"})]})}),c?H.jsx("p",{className:"docs-loading",children:"Loading..."}):H.jsxs("div",{className:"docs-list",children:[l.map(B=>H.jsxs("div",{className:"docs-row",onClick:()=>t(B.id),children:[H.jsxs("div",{className:"docs-file",children:[H.jsx("div",{className:"docs-file-icon",children:""}),H.jsxs("div",{className:"docs-file-meta",children:[m===B.id?H.jsx("input",{autoFocus:!0,className:"docs-rename-input ui-input",value:v,onChange:z=>w(z.target.value),onBlur:()=>U(B.id),onKeyDown:z=>z.key==="Enter"&&U(B.id),onClick:z=>z.stopPropagation()}):H.jsxs("div",{className:"docs-file-title",title:B.owner_id===e?"Double click to rename":"Shared with you",onDoubleClick:z=>C(z,B),children:[B.title,B.owner_id!==e&&H.jsx("span",{className:"docs-shared",children:"(Shared)"})]}),H.jsx("div",{className:"docs-file-date",children:new Date(B.updated_at).toLocaleDateString()})]})]}),H.jsxs("div",{className:"docs-row-actions",children:[B.owner_id===e&&H.jsx("button",{className:"docs-link-btn ui-btn-text",onClick:z=>{z.stopPropagation(),i(B.id)},title:"Share",children:"Share"}),B.owner_id===e&&H.jsx("button",{className:"docs-icon-btn",onClick:z=>R(B.id,z),title:"Delete",children:""})]})]},B.id)),l.length===0&&H.jsx("p",{className:"dashboard-empty",children:"No scripts found."})]})]})})},EH=({onOpenDashboard:n,onShare:e,isOwner:t})=>{const[i,s]=pe.useState(!1),l=pe.useRef(null);return pe.useEffect(()=>{const a=c=>{l.current&&(l.current.contains(c.target)||s(!1))};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),H.jsxs("div",{className:"menu-shell",ref:l,children:[H.jsx("button",{className:"menu-trigger",onClick:()=>s(a=>!a),children:"Menu"}),i&&H.jsxs("div",{className:"menu-panel",children:[H.jsx("button",{className:"menu-item",onClick:()=>{s(!1),n()},children:"File manager"}),H.jsx("button",{className:"menu-item",onClick:()=>{s(!1),e()},disabled:!t,title:t?"Share":"Only owners can share",children:"Share"})]})]})},DH=({supabase:n,documentId:e,currentUserEmail:t,onClose:i})=>{const[s,l]=pe.useState(!1),[a,c]=pe.useState("viewer"),[h,d]=pe.useState([]),[p,m]=pe.useState(""),[b,v]=pe.useState("editor"),[w,k]=pe.useState(!0),[_,O]=pe.useState(""),[R,C]=pe.useState("Copy link"),{addToast:U}=l2(),B=`${window.location.origin}${window.location.pathname}?id=${e}`;pe.useEffect(()=>{z()},[e]);const z=async()=>{k(!0);const{data:Q}=await n.from("documents").select("is_public, public_permission").eq("id",e).single();Q&&(l(Q.is_public),c(Q.public_permission));try{const ue=await nU(n,e);d(ue)}catch{d([]),U("Failed to load sharing settings.","error")}k(!1)},D=async Q=>{if(Q.target.value==="restricted"){l(!1);try{await Dx(n,e,!1)}catch{U("Failed to update access.","error")}}else{l(!0);try{await Dx(n,e,!0)}catch{U("Failed to update access.","error")}}},W=async Q=>{const ue=Q.target.value;c(ue);try{await c(n,e,ue)}catch{U("Failed to update public role.","error")}},ne=async Q=>{if(Q.preventDefault(),!!p.trim()){if(p===t){O("You are the owner."),setTimeout(()=>O(""),2e3);return}try{await ne(n,e,p.trim(),b),O(`Added ${p}`),m(""),z()}catch(ue){O(ue.message.includes("unique")?"User already added.":ue.message)}setTimeout(()=>O(""),3e3)}},Ce=async(Q,ue)=>{try{await sU(n,e,Q,ue),z()}catch{U("Failed to update permission.","error")}},de=async Q=>{try{await rU(n,e,Q),z()}catch{U("Failed to remove user.","error")}},J=()=>{navigator.clipboard.writeText(B),C("Link copied"),setTimeout(()=>C("Copy link"),2e3)},oe=Q=>Q.substring(0,2).toUpperCase();return H.jsx("div",{className:"dashboard-overlay",children:H.jsxs("div",{className:"google-modal ui-card",children:[H.jsxs("div",{className:"google-modal-header",children:[H.jsx("h2",{children:'Share "Untitled Screenplay"'}),H.jsx("div",{className:"header-actions",children:H.jsx("button",{className:"icon-btn",onClick:i,children:""})})]}),w?H.jsx("div",{style:{padding:20},children:"Loading..."}):H.jsxs("div",{className:"google-modal-content",children:[H.jsxs("div",{className:"add-people-section",children:[H.jsxs("form",{onSubmit:ne,className:"add-people-form",children:[H.jsx("input",{type:"email",placeholder:"Add people and groups",value:p,onChange:Q=>m(Q.target.value),className:"google-input ui-input"}),H.jsxs("select",{value:b,onChange:Q=>v(Q.target.value),className:"role-select-simple",children:[H.jsx("option",{value:"editor",children:"Editor"}),H.jsx("option",{value:"viewer",children:"Viewer"})]}),H.jsx("button",{type:"submit",className:"google-primary-btn ui-btn ui-btn-primary",disabled:!p,children:"Send"})]}),_&&H.jsx("div",{className:"toast-msg",children:_})]}),H.jsxs("div",{className:"people-list-section",children:[H.jsx("div",{className:"section-label",children:"People with access"}),H.jsxs("div",{className:"person-row",children:[H.jsx("div",{className:"avatar-circle",children:oe(t||"Me")}),H.jsxs("div",{className:"person-info",children:[H.jsxs("div",{className:"person-name",children:[t," (you)"]}),H.jsx("div",{className:"person-email",children:"Owner"})]}),H.jsx("div",{className:"person-role owner-label",children:"Owner"})]}),h.map(Q=>H.jsxs("div",{className:"person-row",children:[H.jsx("div",{className:"avatar-circle",children:oe(Q.user_email)}),H.jsx("div",{className:"person-info",children:H.jsx("div",{className:"person-name",children:Q.user_email})}),H.jsxs("div",{className:"role-dropdown-container",children:[H.jsxs("select",{value:Q.permission_level,onChange:ue=>Ce(Q.user_email,ue.target.value),className:"role-select-ghost",children:[H.jsx("option",{value:"viewer",children:"Viewer"}),H.jsx("option",{value:"editor",children:"Editor"})]}),H.jsx("button",{className:"remove-btn",onClick:()=>de(Q.user_email),children:""})]})]},Q.id))]}),H.jsxs("div",{className:"general-access-section",children:[H.jsx("div",{className:"section-label",children:"General access"}),H.jsxs("div",{className:"access-row",children:[H.jsx("div",{className:"access-icon-circle",children:s?"":""}),H.jsxs("div",{className:"access-info",children:[H.jsxs("select",{value:s?"public":"restricted",onChange:D,className:"access-select",children:[H.jsx("option",{value:"restricted",children:"Restricted"}),H.jsx("option",{value:"public",children:"Anyone with the link"})]}),H.jsx("div",{className:"access-desc",children:s?"Anyone on the internet with the link can view":"Only people with access can open with the link"})]}),s&&H.jsx("div",{className:"role-dropdown-container",children:H.jsxs("select",{value:a,onChange:W,className:"role-select-ghost",style:{fontWeight:500,color:"#e0e0e0"},children:[H.jsx("option",{value:"viewer",children:"Viewer"}),H.jsx("option",{value:"editor",children:"Editor"})]})})]})]}),H.jsxs("div",{className:"google-modal-footer",children:[H.jsxs("button",{className:"copy-link-btn ui-btn ui-btn-ghost",onClick:J,children:[H.jsx("span",{style:{marginRight:8},children:""}),R]}),H.jsx("button",{className:"google-done-btn ui-btn ui-btn-primary",onClick:i,children:"Done"})]})]})]})})};class RH extends pe.Component{state={hasError:!1};static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){}render(){return this.state.hasError?this.props.fallback??H.jsx("div",{style:{padding:24,color:"#e0e0e0"},children:"Something went wrong. Try refreshing the page."}):this.props.children}}const MH={BASE_URL:"/collab-editor/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"sb_publishable_mE97Q9kBgo-eulQGtx3HHw_ur0aFNh4",VITE_SUPABASE_URL:"https://kktvjaujpqejxiqvopwa.supabase.co"},o2=n=>{const e=MH[n];if(!e)throw new Error(`Missing required environment variable: ${n}`);return e},NH=o2("VITE_SUPABASE_URL"),LH=o2("VITE_SUPABASE_ANON_KEY"),Zl=mL(NH,LH,{realtime:{params:{eventsPerSecond:10}}});function BH(){const[n,e]=pe.useState(null),[t,i]=pe.useState(null),[s,l]=pe.useState(!1),[a,c]=pe.useState(!1),[h,d]=pe.useState(null),[p,m]=pe.useState(!1),[b,v]=pe.useState(!1);pe.useEffect(()=>{Zl.auth.getSession().then(({data:{session:R}})=>{e(R);const U=new URLSearchParams(window.location.search).get("id");U?i(U):R&&l(!0)});const{data:{subscription:O}}=Zl.auth.onAuthStateChange((R,C)=>{e(C),v(!1)});return()=>O.unsubscribe()},[]);const w=O=>{i(O),l(!1);const R=`${window.location.pathname}?id=${O}`;window.history.pushState({path:R},"",R)},k=O=>{d(O),c(!0)};return b||!n&&!t?H.jsxs(H.Fragment,{children:[b&&H.jsx("div",{style:{position:"absolute",top:0,width:"100%",background:"#ee6352",color:"white",textAlign:"center",padding:"10px",fontSize:"0.9rem"},children:"This document is private. Please log in to view."}),H.jsx(OH,{supabase:Zl})]}):H.jsxs("div",{className:"App",children:[n&&t&&H.jsx(EH,{onOpenDashboard:()=>l(!0),onShare:()=>k(t),isOwner:p}),t?H.jsx(RH,{children:H.jsx(SH,{documentId:t,supabase:Zl,currentUserEmail:n?.user?.email,onSetIsOwner:m,onAuthRequired:()=>v(!0)},t)}):H.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:H.jsx("button",{onClick:()=>l(!0),className:"dashboard-create-btn",children:"Open Dashboard"})}),n&&s&&H.jsx(TH,{supabase:Zl,userId:n.user.id,onOpenDocument:w,onShare:k,onClose:()=>{t&&l(!1)}}),n&&a&&h&&H.jsx(DH,{supabase:Zl,documentId:h,currentUserEmail:n.user.email,onClose:()=>{c(!1),d(null)}})]})}HR.createRoot(document.getElementById("root")).render(H.jsx(pe.StrictMode,{children:H.jsx(CH,{children:H.jsx(BH,{})})}));
