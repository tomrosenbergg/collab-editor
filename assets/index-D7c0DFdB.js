(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();var Ah=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _R(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var um={exports:{}},qa={};var sk;function OR(){if(sk)return qa;sk=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,s,l){var a=null;if(l!==void 0&&(a=""+l),s.key!==void 0&&(a=""+s.key),"key"in s){l={};for(var c in s)c!=="key"&&(l[c]=s[c])}else l=s;return s=l.ref,{$$typeof:i,type:n,key:a,ref:s!==void 0?s:null,props:l}}return qa.Fragment=e,qa.jsx=t,qa.jsxs=t,qa}var rk;function AR(){return rk||(rk=1,um.exports=OR()),um.exports}var K=AR(),hm={exports:{}},ve={};var lk;function CR(){if(lk)return ve;lk=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),b=Symbol.iterator;function v(T){return T===null||typeof T!="object"?null:(T=b&&T[b]||T["@@iterator"],typeof T=="function"?T:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,_={};function O(T,q,X){this.props=T,this.context=q,this.refs=_,this.updater=X||w}O.prototype.isReactComponent={},O.prototype.setState=function(T,q){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,q,"setState")},O.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function R(){}R.prototype=O.prototype;function C(T,q,X){this.props=T,this.context=q,this.refs=_,this.updater=X||w}var N=C.prototype=new R;N.constructor=C,k(N,O.prototype),N.isPureReactComponent=!0;var j=Array.isArray;function H(){}var D={H:null,A:null,T:null,S:null},W=Object.prototype.hasOwnProperty;function se(T,q,X){var ie=X.ref;return{$$typeof:i,type:T,key:q,ref:ie!==void 0?ie:null,props:X}}function Ce(T,q){return se(T.type,q,T.props)}function fe(T){return typeof T=="object"&&T!==null&&T.$$typeof===i}function J(T){var q={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(X){return q[X]})}var F=/\/+/g;function re(T,q){return typeof T=="object"&&T!==null&&T.key!=null?J(""+T.key):q.toString(36)}function be(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(H,H):(T.status="pending",T.then(function(q){T.status==="pending"&&(T.status="fulfilled",T.value=q)},function(q){T.status==="pending"&&(T.status="rejected",T.reason=q)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function z(T,q,X,ie,ge){var we=typeof T;(we==="undefined"||we==="boolean")&&(T=null);var ze=!1;if(T===null)ze=!0;else switch(we){case"bigint":case"string":case"number":ze=!0;break;case"object":switch(T.$$typeof){case i:case e:ze=!0;break;case p:return ze=T._init,z(ze(T._payload),q,X,ie,ge)}}if(ze)return ge=ge(T),ze=ie===""?"."+re(T,0):ie,j(ge)?(X="",ze!=null&&(X=ze.replace(F,"$&/")+"/"),z(ge,q,X,"",function(Fo){return Fo})):ge!=null&&(fe(ge)&&(ge=Ce(ge,X+(ge.key==null||T&&T.key===ge.key?"":(""+ge.key).replace(F,"$&/")+"/")+ze)),q.push(ge)),1;ze=0;var Jt=ie===""?".":ie+":";if(j(T))for(var ht=0;ht<T.length;ht++)ie=T[ht],we=Jt+re(ie,ht),ze+=z(ie,q,X,we,ge);else if(ht=v(T),typeof ht=="function")for(T=ht.call(T),ht=0;!(ie=T.next()).done;)ie=ie.value,we=Jt+re(ie,ht++),ze+=z(ie,q,X,we,ge);else if(we==="object"){if(typeof T.then=="function")return z(be(T),q,X,ie,ge);throw q=String(T),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return ze}function Y(T,q,X){if(T==null)return T;var ie=[],ge=0;return z(T,ie,"","",function(we){return q.call(X,we,ge++)}),ie}function ae(T){if(T._status===-1){var q=T._result;q=q(),q.then(function(X){(T._status===0||T._status===-1)&&(T._status=1,T._result=X)},function(X){(T._status===0||T._status===-1)&&(T._status=2,T._result=X)}),T._status===-1&&(T._status=0,T._result=q)}if(T._status===1)return T._result.default;throw T._result}var ye=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)},Te={map:Y,forEach:function(T,q,X){Y(T,function(){q.apply(this,arguments)},X)},count:function(T){var q=0;return Y(T,function(){q++}),q},toArray:function(T){return Y(T,function(q){return q})||[]},only:function(T){if(!fe(T))throw Error("React.Children.only expected to receive a single React element child.");return T}};return ve.Activity=m,ve.Children=Te,ve.Component=O,ve.Fragment=t,ve.Profiler=s,ve.PureComponent=C,ve.StrictMode=n,ve.Suspense=h,ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,ve.__COMPILER_RUNTIME={__proto__:null,c:function(T){return D.H.useMemoCache(T)}},ve.cache=function(T){return function(){return T.apply(null,arguments)}},ve.cacheSignal=function(){return null},ve.cloneElement=function(T,q,X){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var ie=k({},T.props),ge=T.key;if(q!=null)for(we in q.key!==void 0&&(ge=""+q.key),q)!W.call(q,we)||we==="key"||we==="__self"||we==="__source"||we==="ref"&&q.ref===void 0||(ie[we]=q[we]);var we=arguments.length-2;if(we===1)ie.children=X;else if(1<we){for(var ze=Array(we),Jt=0;Jt<we;Jt++)ze[Jt]=arguments[Jt+2];ie.children=ze}return se(T.type,ge,ie)},ve.createContext=function(T){return T={$$typeof:a,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:l,_context:T},T},ve.createElement=function(T,q,X){var ie,ge={},we=null;if(q!=null)for(ie in q.key!==void 0&&(we=""+q.key),q)W.call(q,ie)&&ie!=="key"&&ie!=="__self"&&ie!=="__source"&&(ge[ie]=q[ie]);var ze=arguments.length-2;if(ze===1)ge.children=X;else if(1<ze){for(var Jt=Array(ze),ht=0;ht<ze;ht++)Jt[ht]=arguments[ht+2];ge.children=Jt}if(T&&T.defaultProps)for(ie in ze=T.defaultProps,ze)ge[ie]===void 0&&(ge[ie]=ze[ie]);return se(T,we,ge)},ve.createRef=function(){return{current:null}},ve.forwardRef=function(T){return{$$typeof:c,render:T}},ve.isValidElement=fe,ve.lazy=function(T){return{$$typeof:p,_payload:{_status:-1,_result:T},_init:ae}},ve.memo=function(T,q){return{$$typeof:d,type:T,compare:q===void 0?null:q}},ve.startTransition=function(T){var q=D.T,X={};D.T=X;try{var ie=T(),ge=D.S;ge!==null&&ge(X,ie),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"&&ie.then(H,ye)}catch(we){ye(we)}finally{q!==null&&X.types!==null&&(q.types=X.types),D.T=q}},ve.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},ve.use=function(T){return D.H.use(T)},ve.useActionState=function(T,q,X){return D.H.useActionState(T,q,X)},ve.useCallback=function(T,q){return D.H.useCallback(T,q)},ve.useContext=function(T){return D.H.useContext(T)},ve.useDebugValue=function(){},ve.useDeferredValue=function(T,q){return D.H.useDeferredValue(T,q)},ve.useEffect=function(T,q){return D.H.useEffect(T,q)},ve.useEffectEvent=function(T){return D.H.useEffectEvent(T)},ve.useId=function(){return D.H.useId()},ve.useImperativeHandle=function(T,q,X){return D.H.useImperativeHandle(T,q,X)},ve.useInsertionEffect=function(T,q){return D.H.useInsertionEffect(T,q)},ve.useLayoutEffect=function(T,q){return D.H.useLayoutEffect(T,q)},ve.useMemo=function(T,q){return D.H.useMemo(T,q)},ve.useOptimistic=function(T,q){return D.H.useOptimistic(T,q)},ve.useReducer=function(T,q,X){return D.H.useReducer(T,q,X)},ve.useRef=function(T){return D.H.useRef(T)},ve.useState=function(T){return D.H.useState(T)},ve.useSyncExternalStore=function(T,q,X){return D.H.useSyncExternalStore(T,q,X)},ve.useTransition=function(){return D.H.useTransition()},ve.version="19.2.4",ve}var ok;function qy(){return ok||(ok=1,hm.exports=CR()),hm.exports}var ke=qy(),fm={exports:{}},Va={},dm={exports:{}},pm={};var ak;function TR(){return ak||(ak=1,(function(i){function e(z,Y){var ae=z.length;z.push(Y);e:for(;0<ae;){var ye=ae-1>>>1,Te=z[ye];if(0<s(Te,Y))z[ye]=Y,z[ae]=Te,ae=ye;else break e}}function t(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var Y=z[0],ae=z.pop();if(ae!==Y){z[0]=ae;e:for(var ye=0,Te=z.length,T=Te>>>1;ye<T;){var q=2*(ye+1)-1,X=z[q],ie=q+1,ge=z[ie];if(0>s(X,ae))ie<Te&&0>s(ge,X)?(z[ye]=ge,z[ie]=ae,ye=ie):(z[ye]=X,z[q]=ae,ye=q);else if(ie<Te&&0>s(ge,ae))z[ye]=ge,z[ie]=ae,ye=ie;else break e}}return Y}function s(z,Y){var ae=z.sortIndex-Y.sortIndex;return ae!==0?ae:z.id-Y.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;i.unstable_now=function(){return l.now()}}else{var a=Date,c=a.now();i.unstable_now=function(){return a.now()-c}}var h=[],d=[],p=1,m=null,b=3,v=!1,w=!1,k=!1,_=!1,O=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function N(z){for(var Y=t(d);Y!==null;){if(Y.callback===null)n(d);else if(Y.startTime<=z)n(d),Y.sortIndex=Y.expirationTime,e(h,Y);else break;Y=t(d)}}function j(z){if(k=!1,N(z),!w)if(t(h)!==null)w=!0,H||(H=!0,J());else{var Y=t(d);Y!==null&&be(j,Y.startTime-z)}}var H=!1,D=-1,W=5,se=-1;function Ce(){return _?!0:!(i.unstable_now()-se<W)}function fe(){if(_=!1,H){var z=i.unstable_now();se=z;var Y=!0;try{e:{w=!1,k&&(k=!1,R(D),D=-1),v=!0;var ae=b;try{t:{for(N(z),m=t(h);m!==null&&!(m.expirationTime>z&&Ce());){var ye=m.callback;if(typeof ye=="function"){m.callback=null,b=m.priorityLevel;var Te=ye(m.expirationTime<=z);if(z=i.unstable_now(),typeof Te=="function"){m.callback=Te,N(z),Y=!0;break t}m===t(h)&&n(h),N(z)}else n(h);m=t(h)}if(m!==null)Y=!0;else{var T=t(d);T!==null&&be(j,T.startTime-z),Y=!1}}break e}finally{m=null,b=ae,v=!1}Y=void 0}}finally{Y?J():H=!1}}}var J;if(typeof C=="function")J=function(){C(fe)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,re=F.port2;F.port1.onmessage=fe,J=function(){re.postMessage(null)}}else J=function(){O(fe,0)};function be(z,Y){D=O(function(){z(i.unstable_now())},Y)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(z){z.callback=null},i.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<z?Math.floor(1e3/z):5},i.unstable_getCurrentPriorityLevel=function(){return b},i.unstable_next=function(z){switch(b){case 1:case 2:case 3:var Y=3;break;default:Y=b}var ae=b;b=Y;try{return z()}finally{b=ae}},i.unstable_requestPaint=function(){_=!0},i.unstable_runWithPriority=function(z,Y){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var ae=b;b=z;try{return Y()}finally{b=ae}},i.unstable_scheduleCallback=function(z,Y,ae){var ye=i.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?ye+ae:ye):ae=ye,z){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=ae+Te,z={id:p++,callback:Y,priorityLevel:z,startTime:ae,expirationTime:Te,sortIndex:-1},ae>ye?(z.sortIndex=ae,e(d,z),t(h)===null&&z===t(d)&&(k?(R(D),D=-1):k=!0,be(j,ae-ye))):(z.sortIndex=Te,e(h,z),w||v||(w=!0,H||(H=!0,J()))),z},i.unstable_shouldYield=Ce,i.unstable_wrapCallback=function(z){var Y=b;return function(){var ae=b;b=Y;try{return z.apply(this,arguments)}finally{b=ae}}}})(pm)),pm}var ck;function ER(){return ck||(ck=1,dm.exports=TR()),dm.exports}var gm={exports:{}},Yt={};var uk;function DR(){if(uk)return Yt;uk=1;var i=qy();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(h,d,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:m==null?null:""+m,children:h,containerInfo:d,implementation:p}}var a=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Yt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Yt.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return l(h,d,null,p)},Yt.flushSync=function(h){var d=a.T,p=n.p;try{if(a.T=null,n.p=2,h)return h()}finally{a.T=d,n.p=p,n.d.f()}},Yt.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},Yt.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Yt.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,m=c(p,d.crossOrigin),b=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:m,integrity:b,fetchPriority:v}):p==="script"&&n.d.X(h,{crossOrigin:m,integrity:b,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Yt.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=c(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},Yt.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,m=c(p,d.crossOrigin);n.d.L(h,p,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Yt.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=c(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},Yt.requestFormReset=function(h){n.d.r(h)},Yt.unstable_batchedUpdates=function(h,d){return h(d)},Yt.useFormState=function(h,d,p){return a.H.useFormState(h,d,p)},Yt.useFormStatus=function(){return a.H.useHostTransitionStatus()},Yt.version="19.2.4",Yt}var hk;function RR(){if(hk)return gm.exports;hk=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),gm.exports=DR(),gm.exports}var fk;function MR(){if(fk)return Va;fk=1;var i=ER(),e=qy(),t=RR();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function a(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function c(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function h(r){if(l(r)!==r)throw Error(n(188))}function d(r){var o=r.alternate;if(!o){if(o=l(r),o===null)throw Error(n(188));return o!==r?null:r}for(var u=r,f=o;;){var g=u.return;if(g===null)break;var y=g.alternate;if(y===null){if(f=g.return,f!==null){u=f;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===u)return h(g),r;if(y===f)return h(g),o;y=y.sibling}throw Error(n(188))}if(u.return!==f.return)u=g,f=y;else{for(var S=!1,x=g.child;x;){if(x===u){S=!0,u=g,f=y;break}if(x===f){S=!0,f=g,u=y;break}x=x.sibling}if(!S){for(x=y.child;x;){if(x===u){S=!0,u=y,f=g;break}if(x===f){S=!0,f=y,u=g;break}x=x.sibling}if(!S)throw Error(n(189))}}if(u.alternate!==f)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:o}function p(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=p(r),o!==null)return o;r=r.sibling}return null}var m=Object.assign,b=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),C=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),se=Symbol.for("react.activity"),Ce=Symbol.for("react.memo_cache_sentinel"),fe=Symbol.iterator;function J(r){return r===null||typeof r!="object"?null:(r=fe&&r[fe]||r["@@iterator"],typeof r=="function"?r:null)}var F=Symbol.for("react.client.reference");function re(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===F?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case k:return"Fragment";case O:return"Profiler";case _:return"StrictMode";case j:return"Suspense";case H:return"SuspenseList";case se:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case C:return r.displayName||"Context";case R:return(r._context.displayName||"Context")+".Consumer";case N:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case D:return o=r.displayName||null,o!==null?o:re(r.type)||"Memo";case W:o=r._payload,r=r._init;try{return re(r(o))}catch{}}return null}var be=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},ye=[],Te=-1;function T(r){return{current:r}}function q(r){0>Te||(r.current=ye[Te],ye[Te]=null,Te--)}function X(r,o){Te++,ye[Te]=r.current,r.current=o}var ie=T(null),ge=T(null),we=T(null),ze=T(null);function Jt(r,o){switch(X(we,o),X(ge,r),X(ie,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?C1(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=C1(o),r=T1(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}q(ie),X(ie,r)}function ht(){q(ie),q(ge),q(we)}function Fo(r){r.memoizedState!==null&&X(ze,r);var o=ie.current,u=T1(o,r.type);o!==u&&(X(ge,r),X(ie,u))}function au(r){ge.current===r&&(q(ie),q(ge)),ze.current===r&&(q(ze),za._currentValue=ae)}var Kd,nv;function fr(r){if(Kd===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);Kd=o&&o[1]||"",nv=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Kd+r+nv}var Wd=!1;function Yd(r,o){if(!r||Wd)return"";Wd=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(o){var G=function(){throw Error()};if(Object.defineProperty(G.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(G,[])}catch(I){var U=I}Reflect.construct(r,[],G)}else{try{G.call()}catch(I){U=I}r.call(G.prototype)}}else{try{throw Error()}catch(I){U=I}(G=r())&&typeof G.catch=="function"&&G.catch(function(){})}}catch(I){if(I&&U&&typeof I.stack=="string")return[I.stack,U.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=f.DetermineComponentFrameRoot(),S=y[0],x=y[1];if(S&&x){var A=S.split(`
`),B=x.split(`
`);for(g=f=0;f<A.length&&!A[f].includes("DetermineComponentFrameRoot");)f++;for(;g<B.length&&!B[g].includes("DetermineComponentFrameRoot");)g++;if(f===A.length||g===B.length)for(f=A.length-1,g=B.length-1;1<=f&&0<=g&&A[f]!==B[g];)g--;for(;1<=f&&0<=g;f--,g--)if(A[f]!==B[g]){if(f!==1||g!==1)do if(f--,g--,0>g||A[f]!==B[g]){var P=`
`+A[f].replace(" at new "," at ");return r.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",r.displayName)),P}while(1<=f&&0<=g);break}}}finally{Wd=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?fr(u):""}function t2(r,o){switch(r.tag){case 26:case 27:case 5:return fr(r.type);case 16:return fr("Lazy");case 13:return r.child!==o&&o!==null?fr("Suspense Fallback"):fr("Suspense");case 19:return fr("SuspenseList");case 0:case 15:return Yd(r.type,!1);case 11:return Yd(r.type.render,!1);case 1:return Yd(r.type,!0);case 31:return fr("Activity");default:return""}}function sv(r){try{var o="",u=null;do o+=t2(r,u),u=r,r=r.return;while(r);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Fd=Object.prototype.hasOwnProperty,Xd=i.unstable_scheduleCallback,Qd=i.unstable_cancelCallback,i2=i.unstable_shouldYield,n2=i.unstable_requestPaint,vi=i.unstable_now,s2=i.unstable_getCurrentPriorityLevel,rv=i.unstable_ImmediatePriority,lv=i.unstable_UserBlockingPriority,cu=i.unstable_NormalPriority,r2=i.unstable_LowPriority,ov=i.unstable_IdlePriority,l2=i.log,o2=i.unstable_setDisableYieldValue,Xo=null,wi=null;function ks(r){if(typeof l2=="function"&&o2(r),wi&&typeof wi.setStrictMode=="function")try{wi.setStrictMode(Xo,r)}catch{}}var Si=Math.clz32?Math.clz32:u2,a2=Math.log,c2=Math.LN2;function u2(r){return r>>>=0,r===0?32:31-(a2(r)/c2|0)|0}var uu=256,hu=262144,fu=4194304;function dr(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function du(r,o,u){var f=r.pendingLanes;if(f===0)return 0;var g=0,y=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var x=f&134217727;return x!==0?(f=x&~y,f!==0?g=dr(f):(S&=x,S!==0?g=dr(S):u||(u=x&~r,u!==0&&(g=dr(u))))):(x=f&~y,x!==0?g=dr(x):S!==0?g=dr(S):u||(u=f&~r,u!==0&&(g=dr(u)))),g===0?0:o!==0&&o!==g&&(o&y)===0&&(y=g&-g,u=o&-o,y>=u||y===32&&(u&4194048)!==0)?o:g}function Qo(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function h2(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function av(){var r=fu;return fu<<=1,(fu&62914560)===0&&(fu=4194304),r}function Jd(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function Jo(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function f2(r,o,u,f,g,y){var S=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var x=r.entanglements,A=r.expirationTimes,B=r.hiddenUpdates;for(u=S&~u;0<u;){var P=31-Si(u),G=1<<P;x[P]=0,A[P]=-1;var U=B[P];if(U!==null)for(B[P]=null,P=0;P<U.length;P++){var I=U[P];I!==null&&(I.lane&=-536870913)}u&=~G}f!==0&&cv(r,f,0),y!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=y&~(S&~o))}function cv(r,o,u){r.pendingLanes|=o,r.suspendedLanes&=~o;var f=31-Si(o);r.entangledLanes|=o,r.entanglements[f]=r.entanglements[f]|1073741824|u&261930}function uv(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var f=31-Si(u),g=1<<f;g&o|r[f]&o&&(r[f]|=o),u&=~g}}function hv(r,o){var u=o&-o;return u=(u&42)!==0?1:Zd(u),(u&(r.suspendedLanes|o))!==0?0:u}function Zd(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ep(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function fv(){var r=Y.p;return r!==0?r:(r=window.event,r===void 0?32:Q1(r.type))}function dv(r,o){var u=Y.p;try{return Y.p=r,o()}finally{Y.p=u}}var xs=Math.random().toString(36).slice(2),Ut="__reactFiber$"+xs,si="__reactProps$"+xs,ol="__reactContainer$"+xs,tp="__reactEvents$"+xs,d2="__reactListeners$"+xs,p2="__reactHandles$"+xs,pv="__reactResources$"+xs,Zo="__reactMarker$"+xs;function ip(r){delete r[Ut],delete r[si],delete r[tp],delete r[d2],delete r[p2]}function al(r){var o=r[Ut];if(o)return o;for(var u=r.parentNode;u;){if(o=u[ol]||u[Ut]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=B1(r);r!==null;){if(u=r[Ut])return u;r=B1(r)}return o}r=u,u=r.parentNode}return null}function cl(r){if(r=r[Ut]||r[ol]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function ea(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function ul(r){var o=r[pv];return o||(o=r[pv]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Dt(r){r[Zo]=!0}var gv=new Set,mv={};function pr(r,o){hl(r,o),hl(r+"Capture",o)}function hl(r,o){for(mv[r]=o,r=0;r<o.length;r++)gv.add(o[r])}var g2=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yv={},bv={};function m2(r){return Fd.call(bv,r)?!0:Fd.call(yv,r)?!1:g2.test(r)?bv[r]=!0:(yv[r]=!0,!1)}function pu(r,o,u){if(m2(o))if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var f=o.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+u)}}function gu(r,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+u)}}function Wn(r,o,u,f){if(f===null)r.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(o,u,""+f)}}function Hi(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function vv(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function y2(r,o,u){var f=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var g=f.get,y=f.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return g.call(this)},set:function(S){u=""+S,y.call(this,S)}}),Object.defineProperty(r,o,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(S){u=""+S},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function np(r){if(!r._valueTracker){var o=vv(r)?"checked":"value";r._valueTracker=y2(r,o,""+r[o])}}function wv(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),f="";return r&&(f=vv(r)?r.checked?"true":"false":r.value),r=f,r!==u?(o.setValue(r),!0):!1}function mu(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var b2=/[\n"\\]/g;function qi(r){return r.replace(b2,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function sp(r,o,u,f,g,y,S,x){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),o!=null?S==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+Hi(o)):r.value!==""+Hi(o)&&(r.value=""+Hi(o)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),o!=null?rp(r,S,Hi(o)):u!=null?rp(r,S,Hi(u)):f!=null&&r.removeAttribute("value"),g==null&&y!=null&&(r.defaultChecked=!!y),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?r.name=""+Hi(x):r.removeAttribute("name")}function Sv(r,o,u,f,g,y,S,x){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),o!=null||u!=null){if(!(y!=="submit"&&y!=="reset"||o!=null)){np(r);return}u=u!=null?""+Hi(u):"",o=o!=null?""+Hi(o):u,x||o===r.value||(r.value=o),r.defaultValue=o}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,r.checked=x?r.checked:!!f,r.defaultChecked=!!f,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S),np(r)}function rp(r,o,u){o==="number"&&mu(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function fl(r,o,u,f){if(r=r.options,o){o={};for(var g=0;g<u.length;g++)o["$"+u[g]]=!0;for(u=0;u<r.length;u++)g=o.hasOwnProperty("$"+r[u].value),r[u].selected!==g&&(r[u].selected=g),g&&f&&(r[u].defaultSelected=!0)}else{for(u=""+Hi(u),o=null,g=0;g<r.length;g++){if(r[g].value===u){r[g].selected=!0,f&&(r[g].defaultSelected=!0);return}o!==null||r[g].disabled||(o=r[g])}o!==null&&(o.selected=!0)}}function kv(r,o,u){if(o!=null&&(o=""+Hi(o),o!==r.value&&(r.value=o),u==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=u!=null?""+Hi(u):""}function xv(r,o,u,f){if(o==null){if(f!=null){if(u!=null)throw Error(n(92));if(be(f)){if(1<f.length)throw Error(n(93));f=f[0]}u=f}u==null&&(u=""),o=u}u=Hi(o),r.defaultValue=u,f=r.textContent,f===u&&f!==""&&f!==null&&(r.value=f),np(r)}function dl(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var v2=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _v(r,o,u){var f=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":f?r.setProperty(o,u):typeof u!="number"||u===0||v2.has(o)?o==="float"?r.cssFloat=u:r[o]=(""+u).trim():r[o]=u+"px"}function Ov(r,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||o!=null&&o.hasOwnProperty(f)||(f.indexOf("--")===0?r.setProperty(f,""):f==="float"?r.cssFloat="":r[f]="");for(var g in o)f=o[g],o.hasOwnProperty(g)&&u[g]!==f&&_v(r,g,f)}else for(var y in o)o.hasOwnProperty(y)&&_v(r,y,o[y])}function lp(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var w2=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),S2=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yu(r){return S2.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Yn(){}var op=null;function ap(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var pl=null,gl=null;function Av(r){var o=cl(r);if(o&&(r=o.stateNode)){var u=r[si]||null;e:switch(r=o.stateNode,o.type){case"input":if(sp(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+qi(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var f=u[o];if(f!==r&&f.form===r.form){var g=f[si]||null;if(!g)throw Error(n(90));sp(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<u.length;o++)f=u[o],f.form===r.form&&wv(f)}break e;case"textarea":kv(r,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&fl(r,!!u.multiple,o,!1)}}}var cp=!1;function Cv(r,o,u){if(cp)return r(o,u);cp=!0;try{var f=r(o);return f}finally{if(cp=!1,(pl!==null||gl!==null)&&(sh(),pl&&(o=pl,r=gl,gl=pl=null,Av(o),r)))for(o=0;o<r.length;o++)Av(r[o])}}function ta(r,o){var u=r.stateNode;if(u===null)return null;var f=u[si]||null;if(f===null)return null;u=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(r=r.type,f=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!f;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var Fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),up=!1;if(Fn)try{var ia={};Object.defineProperty(ia,"passive",{get:function(){up=!0}}),window.addEventListener("test",ia,ia),window.removeEventListener("test",ia,ia)}catch{up=!1}var _s=null,hp=null,bu=null;function Tv(){if(bu)return bu;var r,o=hp,u=o.length,f,g="value"in _s?_s.value:_s.textContent,y=g.length;for(r=0;r<u&&o[r]===g[r];r++);var S=u-r;for(f=1;f<=S&&o[u-f]===g[y-f];f++);return bu=g.slice(r,1<f?1-f:void 0)}function vu(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function wu(){return!0}function Ev(){return!1}function ri(r){function o(u,f,g,y,S){this._reactName=u,this._targetInst=g,this.type=f,this.nativeEvent=y,this.target=S,this.currentTarget=null;for(var x in r)r.hasOwnProperty(x)&&(u=r[x],this[x]=u?u(y):y[x]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?wu:Ev,this.isPropagationStopped=Ev,this}return m(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=wu)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=wu)},persist:function(){},isPersistent:wu}),o}var gr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Su=ri(gr),na=m({},gr,{view:0,detail:0}),k2=ri(na),fp,dp,sa,ku=m({},na,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gp,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==sa&&(sa&&r.type==="mousemove"?(fp=r.screenX-sa.screenX,dp=r.screenY-sa.screenY):dp=fp=0,sa=r),fp)},movementY:function(r){return"movementY"in r?r.movementY:dp}}),Dv=ri(ku),x2=m({},ku,{dataTransfer:0}),_2=ri(x2),O2=m({},na,{relatedTarget:0}),pp=ri(O2),A2=m({},gr,{animationName:0,elapsedTime:0,pseudoElement:0}),C2=ri(A2),T2=m({},gr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),E2=ri(T2),D2=m({},gr,{data:0}),Rv=ri(D2),R2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},M2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},N2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function L2(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=N2[r])?!!o[r]:!1}function gp(){return L2}var B2=m({},na,{key:function(r){if(r.key){var o=R2[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=vu(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?M2[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gp,charCode:function(r){return r.type==="keypress"?vu(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?vu(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),U2=ri(B2),j2=m({},ku,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mv=ri(j2),z2=m({},na,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gp}),I2=ri(z2),P2=m({},gr,{propertyName:0,elapsedTime:0,pseudoElement:0}),H2=ri(P2),q2=m({},ku,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),V2=ri(q2),$2=m({},gr,{newState:0,oldState:0}),G2=ri($2),K2=[9,13,27,32],mp=Fn&&"CompositionEvent"in window,ra=null;Fn&&"documentMode"in document&&(ra=document.documentMode);var W2=Fn&&"TextEvent"in window&&!ra,Nv=Fn&&(!mp||ra&&8<ra&&11>=ra),Lv=" ",Bv=!1;function Uv(r,o){switch(r){case"keyup":return K2.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jv(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ml=!1;function Y2(r,o){switch(r){case"compositionend":return jv(o);case"keypress":return o.which!==32?null:(Bv=!0,Lv);case"textInput":return r=o.data,r===Lv&&Bv?null:r;default:return null}}function F2(r,o){if(ml)return r==="compositionend"||!mp&&Uv(r,o)?(r=Tv(),bu=hp=_s=null,ml=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Nv&&o.locale!=="ko"?null:o.data;default:return null}}var X2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zv(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!X2[r.type]:o==="textarea"}function Iv(r,o,u,f){pl?gl?gl.push(f):gl=[f]:pl=f,o=hh(o,"onChange"),0<o.length&&(u=new Su("onChange","change",null,u,f),r.push({event:u,listeners:o}))}var la=null,oa=null;function Q2(r){S1(r,0)}function xu(r){var o=ea(r);if(wv(o))return r}function Pv(r,o){if(r==="change")return o}var Hv=!1;if(Fn){var yp;if(Fn){var bp="oninput"in document;if(!bp){var qv=document.createElement("div");qv.setAttribute("oninput","return;"),bp=typeof qv.oninput=="function"}yp=bp}else yp=!1;Hv=yp&&(!document.documentMode||9<document.documentMode)}function Vv(){la&&(la.detachEvent("onpropertychange",$v),oa=la=null)}function $v(r){if(r.propertyName==="value"&&xu(oa)){var o=[];Iv(o,oa,r,ap(r)),Cv(Q2,o)}}function J2(r,o,u){r==="focusin"?(Vv(),la=o,oa=u,la.attachEvent("onpropertychange",$v)):r==="focusout"&&Vv()}function Z2(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return xu(oa)}function eD(r,o){if(r==="click")return xu(o)}function tD(r,o){if(r==="input"||r==="change")return xu(o)}function iD(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var ki=typeof Object.is=="function"?Object.is:iD;function aa(r,o){if(ki(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),f=Object.keys(o);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var g=u[f];if(!Fd.call(o,g)||!ki(r[g],o[g]))return!1}return!0}function Gv(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Kv(r,o){var u=Gv(r);r=0;for(var f;u;){if(u.nodeType===3){if(f=r+u.textContent.length,r<=o&&f>=o)return{node:u,offset:o-r};r=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Gv(u)}}function Wv(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?Wv(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Yv(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=mu(r.document);o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=mu(r.document)}return o}function vp(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var nD=Fn&&"documentMode"in document&&11>=document.documentMode,yl=null,wp=null,ca=null,Sp=!1;function Fv(r,o,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Sp||yl==null||yl!==mu(f)||(f=yl,"selectionStart"in f&&vp(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),ca&&aa(ca,f)||(ca=f,f=hh(wp,"onSelect"),0<f.length&&(o=new Su("onSelect","select",null,o,u),r.push({event:o,listeners:f}),o.target=yl)))}function mr(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var bl={animationend:mr("Animation","AnimationEnd"),animationiteration:mr("Animation","AnimationIteration"),animationstart:mr("Animation","AnimationStart"),transitionrun:mr("Transition","TransitionRun"),transitionstart:mr("Transition","TransitionStart"),transitioncancel:mr("Transition","TransitionCancel"),transitionend:mr("Transition","TransitionEnd")},kp={},Xv={};Fn&&(Xv=document.createElement("div").style,"AnimationEvent"in window||(delete bl.animationend.animation,delete bl.animationiteration.animation,delete bl.animationstart.animation),"TransitionEvent"in window||delete bl.transitionend.transition);function yr(r){if(kp[r])return kp[r];if(!bl[r])return r;var o=bl[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in Xv)return kp[r]=o[u];return r}var Qv=yr("animationend"),Jv=yr("animationiteration"),Zv=yr("animationstart"),sD=yr("transitionrun"),rD=yr("transitionstart"),lD=yr("transitioncancel"),ew=yr("transitionend"),tw=new Map,xp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xp.push("scrollEnd");function on(r,o){tw.set(r,o),pr(o,[r])}var _u=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Vi=[],vl=0,_p=0;function Ou(){for(var r=vl,o=_p=vl=0;o<r;){var u=Vi[o];Vi[o++]=null;var f=Vi[o];Vi[o++]=null;var g=Vi[o];Vi[o++]=null;var y=Vi[o];if(Vi[o++]=null,f!==null&&g!==null){var S=f.pending;S===null?g.next=g:(g.next=S.next,S.next=g),f.pending=g}y!==0&&iw(u,g,y)}}function Au(r,o,u,f){Vi[vl++]=r,Vi[vl++]=o,Vi[vl++]=u,Vi[vl++]=f,_p|=f,r.lanes|=f,r=r.alternate,r!==null&&(r.lanes|=f)}function Op(r,o,u,f){return Au(r,o,u,f),Cu(r)}function br(r,o){return Au(r,null,null,o),Cu(r)}function iw(r,o,u){r.lanes|=u;var f=r.alternate;f!==null&&(f.lanes|=u);for(var g=!1,y=r.return;y!==null;)y.childLanes|=u,f=y.alternate,f!==null&&(f.childLanes|=u),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(g=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,g&&o!==null&&(g=31-Si(u),r=y.hiddenUpdates,f=r[g],f===null?r[g]=[o]:f.push(o),o.lane=u|536870912),y):null}function Cu(r){if(50<Ra)throw Ra=0,Lg=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var wl={};function oD(r,o,u,f){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xi(r,o,u,f){return new oD(r,o,u,f)}function Ap(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Xn(r,o){var u=r.alternate;return u===null?(u=xi(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function nw(r,o){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,o=u.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function Tu(r,o,u,f,g,y){var S=0;if(f=r,typeof r=="function")Ap(r)&&(S=1);else if(typeof r=="string")S=fR(r,u,ie.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case se:return r=xi(31,u,o,g),r.elementType=se,r.lanes=y,r;case k:return vr(u.children,g,y,o);case _:S=8,g|=24;break;case O:return r=xi(12,u,o,g|2),r.elementType=O,r.lanes=y,r;case j:return r=xi(13,u,o,g),r.elementType=j,r.lanes=y,r;case H:return r=xi(19,u,o,g),r.elementType=H,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case C:S=10;break e;case R:S=9;break e;case N:S=11;break e;case D:S=14;break e;case W:S=16,f=null;break e}S=29,u=Error(n(130,r===null?"null":typeof r,"")),f=null}return o=xi(S,u,o,g),o.elementType=r,o.type=f,o.lanes=y,o}function vr(r,o,u,f){return r=xi(7,r,f,o),r.lanes=u,r}function Cp(r,o,u){return r=xi(6,r,null,o),r.lanes=u,r}function sw(r){var o=xi(18,null,null,0);return o.stateNode=r,o}function Tp(r,o,u){return o=xi(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var rw=new WeakMap;function $i(r,o){if(typeof r=="object"&&r!==null){var u=rw.get(r);return u!==void 0?u:(o={value:r,source:o,stack:sv(o)},rw.set(r,o),o)}return{value:r,source:o,stack:sv(o)}}var Sl=[],kl=0,Eu=null,ua=0,Gi=[],Ki=0,Os=null,_n=1,On="";function Qn(r,o){Sl[kl++]=ua,Sl[kl++]=Eu,Eu=r,ua=o}function lw(r,o,u){Gi[Ki++]=_n,Gi[Ki++]=On,Gi[Ki++]=Os,Os=r;var f=_n;r=On;var g=32-Si(f)-1;f&=~(1<<g),u+=1;var y=32-Si(o)+g;if(30<y){var S=g-g%5;y=(f&(1<<S)-1).toString(32),f>>=S,g-=S,_n=1<<32-Si(o)+g|u<<g|f,On=y+r}else _n=1<<y|u<<g|f,On=r}function Ep(r){r.return!==null&&(Qn(r,1),lw(r,1,0))}function Dp(r){for(;r===Eu;)Eu=Sl[--kl],Sl[kl]=null,ua=Sl[--kl],Sl[kl]=null;for(;r===Os;)Os=Gi[--Ki],Gi[Ki]=null,On=Gi[--Ki],Gi[Ki]=null,_n=Gi[--Ki],Gi[Ki]=null}function ow(r,o){Gi[Ki++]=_n,Gi[Ki++]=On,Gi[Ki++]=Os,_n=o.id,On=o.overflow,Os=r}var jt=null,it=null,Ue=!1,As=null,Wi=!1,Rp=Error(n(519));function Cs(r){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ha($i(o,r)),Rp}function aw(r){var o=r.stateNode,u=r.type,f=r.memoizedProps;switch(o[Ut]=r,o[si]=f,u){case"dialog":Ne("cancel",o),Ne("close",o);break;case"iframe":case"object":case"embed":Ne("load",o);break;case"video":case"audio":for(u=0;u<Na.length;u++)Ne(Na[u],o);break;case"source":Ne("error",o);break;case"img":case"image":case"link":Ne("error",o),Ne("load",o);break;case"details":Ne("toggle",o);break;case"input":Ne("invalid",o),Sv(o,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ne("invalid",o);break;case"textarea":Ne("invalid",o),xv(o,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||f.suppressHydrationWarning===!0||O1(o.textContent,u)?(f.popover!=null&&(Ne("beforetoggle",o),Ne("toggle",o)),f.onScroll!=null&&Ne("scroll",o),f.onScrollEnd!=null&&Ne("scrollend",o),f.onClick!=null&&(o.onclick=Yn),o=!0):o=!1,o||Cs(r,!0)}function cw(r){for(jt=r.return;jt;)switch(jt.tag){case 5:case 31:case 13:Wi=!1;return;case 27:case 3:Wi=!0;return;default:jt=jt.return}}function xl(r){if(r!==jt)return!1;if(!Ue)return cw(r),Ue=!0,!1;var o=r.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||Fg(r.type,r.memoizedProps)),u=!u),u&&it&&Cs(r),cw(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));it=L1(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));it=L1(r)}else o===27?(o=it,Hs(r.type)?(r=em,em=null,it=r):it=o):it=jt?Fi(r.stateNode.nextSibling):null;return!0}function wr(){it=jt=null,Ue=!1}function Mp(){var r=As;return r!==null&&(ci===null?ci=r:ci.push.apply(ci,r),As=null),r}function ha(r){As===null?As=[r]:As.push(r)}var Np=T(null),Sr=null,Jn=null;function Ts(r,o,u){X(Np,o._currentValue),o._currentValue=u}function Zn(r){r._currentValue=Np.current,q(Np)}function Lp(r,o,u){for(;r!==null;){var f=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),r===u)break;r=r.return}}function Bp(r,o,u,f){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var y=g.dependencies;if(y!==null){var S=g.child;y=y.firstContext;e:for(;y!==null;){var x=y;y=g;for(var A=0;A<o.length;A++)if(x.context===o[A]){y.lanes|=u,x=y.alternate,x!==null&&(x.lanes|=u),Lp(y.return,u,r),f||(S=null);break e}y=x.next}}else if(g.tag===18){if(S=g.return,S===null)throw Error(n(341));S.lanes|=u,y=S.alternate,y!==null&&(y.lanes|=u),Lp(S,u,r),S=null}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===r){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}}function _l(r,o,u,f){r=null;for(var g=o,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var S=g.alternate;if(S===null)throw Error(n(387));if(S=S.memoizedProps,S!==null){var x=g.type;ki(g.pendingProps.value,S.value)||(r!==null?r.push(x):r=[x])}}else if(g===ze.current){if(S=g.alternate,S===null)throw Error(n(387));S.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(za):r=[za])}g=g.return}r!==null&&Bp(o,r,u,f),o.flags|=262144}function Du(r){for(r=r.firstContext;r!==null;){if(!ki(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function kr(r){Sr=r,Jn=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function zt(r){return uw(Sr,r)}function Ru(r,o){return Sr===null&&kr(r),uw(r,o)}function uw(r,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Jn===null){if(r===null)throw Error(n(308));Jn=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else Jn=Jn.next=o;return u}var aD=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(u,f){r.push(f)}};this.abort=function(){o.aborted=!0,r.forEach(function(u){return u()})}},cD=i.unstable_scheduleCallback,uD=i.unstable_NormalPriority,yt={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Up(){return{controller:new aD,data:new Map,refCount:0}}function fa(r){r.refCount--,r.refCount===0&&cD(uD,function(){r.controller.abort()})}var da=null,jp=0,Ol=0,Al=null;function hD(r,o){if(da===null){var u=da=[];jp=0,Ol=Pg(),Al={status:"pending",value:void 0,then:function(f){u.push(f)}}}return jp++,o.then(hw,hw),o}function hw(){if(--jp===0&&da!==null){Al!==null&&(Al.status="fulfilled");var r=da;da=null,Ol=0,Al=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function fD(r,o){var u=[],f={status:"pending",value:null,reason:null,then:function(g){u.push(g)}};return r.then(function(){f.status="fulfilled",f.value=o;for(var g=0;g<u.length;g++)(0,u[g])(o)},function(g){for(f.status="rejected",f.reason=g,g=0;g<u.length;g++)(0,u[g])(void 0)}),f}var fw=z.S;z.S=function(r,o){FS=vi(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&hD(r,o),fw!==null&&fw(r,o)};var xr=T(null);function zp(){var r=xr.current;return r!==null?r:Fe.pooledCache}function Mu(r,o){o===null?X(xr,xr.current):X(xr,o.pool)}function dw(){var r=zp();return r===null?null:{parent:yt._currentValue,pool:r}}var Cl=Error(n(460)),Ip=Error(n(474)),Nu=Error(n(542)),Lu={then:function(){}};function pw(r){return r=r.status,r==="fulfilled"||r==="rejected"}function gw(r,o,u){switch(u=r[u],u===void 0?r.push(o):u!==o&&(o.then(Yn,Yn),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,yw(r),r;default:if(typeof o.status=="string")o.then(Yn,Yn);else{if(r=Fe,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(f){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=f}},function(f){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=f}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,yw(r),r}throw Or=o,Cl}}function _r(r){try{var o=r._init;return o(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Or=u,Cl):u}}var Or=null;function mw(){if(Or===null)throw Error(n(459));var r=Or;return Or=null,r}function yw(r){if(r===Cl||r===Nu)throw Error(n(483))}var Tl=null,pa=0;function Bu(r){var o=pa;return pa+=1,Tl===null&&(Tl=[]),gw(Tl,r,o)}function ga(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Uu(r,o){throw o.$$typeof===b?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function bw(r){function o(M,E){if(r){var L=M.deletions;L===null?(M.deletions=[E],M.flags|=16):L.push(E)}}function u(M,E){if(!r)return null;for(;E!==null;)o(M,E),E=E.sibling;return null}function f(M){for(var E=new Map;M!==null;)M.key!==null?E.set(M.key,M):E.set(M.index,M),M=M.sibling;return E}function g(M,E){return M=Xn(M,E),M.index=0,M.sibling=null,M}function y(M,E,L){return M.index=L,r?(L=M.alternate,L!==null?(L=L.index,L<E?(M.flags|=67108866,E):L):(M.flags|=67108866,E)):(M.flags|=1048576,E)}function S(M){return r&&M.alternate===null&&(M.flags|=67108866),M}function x(M,E,L,V){return E===null||E.tag!==6?(E=Cp(L,M.mode,V),E.return=M,E):(E=g(E,L),E.return=M,E)}function A(M,E,L,V){var he=L.type;return he===k?P(M,E,L.props.children,V,L.key):E!==null&&(E.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===W&&_r(he)===E.type)?(E=g(E,L.props),ga(E,L),E.return=M,E):(E=Tu(L.type,L.key,L.props,null,M.mode,V),ga(E,L),E.return=M,E)}function B(M,E,L,V){return E===null||E.tag!==4||E.stateNode.containerInfo!==L.containerInfo||E.stateNode.implementation!==L.implementation?(E=Tp(L,M.mode,V),E.return=M,E):(E=g(E,L.children||[]),E.return=M,E)}function P(M,E,L,V,he){return E===null||E.tag!==7?(E=vr(L,M.mode,V,he),E.return=M,E):(E=g(E,L),E.return=M,E)}function G(M,E,L){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return E=Cp(""+E,M.mode,L),E.return=M,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case v:return L=Tu(E.type,E.key,E.props,null,M.mode,L),ga(L,E),L.return=M,L;case w:return E=Tp(E,M.mode,L),E.return=M,E;case W:return E=_r(E),G(M,E,L)}if(be(E)||J(E))return E=vr(E,M.mode,L,null),E.return=M,E;if(typeof E.then=="function")return G(M,Bu(E),L);if(E.$$typeof===C)return G(M,Ru(M,E),L);Uu(M,E)}return null}function U(M,E,L,V){var he=E!==null?E.key:null;if(typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint")return he!==null?null:x(M,E,""+L,V);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case v:return L.key===he?A(M,E,L,V):null;case w:return L.key===he?B(M,E,L,V):null;case W:return L=_r(L),U(M,E,L,V)}if(be(L)||J(L))return he!==null?null:P(M,E,L,V,null);if(typeof L.then=="function")return U(M,E,Bu(L),V);if(L.$$typeof===C)return U(M,E,Ru(M,L),V);Uu(M,L)}return null}function I(M,E,L,V,he){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return M=M.get(L)||null,x(E,M,""+V,he);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case v:return M=M.get(V.key===null?L:V.key)||null,A(E,M,V,he);case w:return M=M.get(V.key===null?L:V.key)||null,B(E,M,V,he);case W:return V=_r(V),I(M,E,L,V,he)}if(be(V)||J(V))return M=M.get(L)||null,P(E,M,V,he,null);if(typeof V.then=="function")return I(M,E,L,Bu(V),he);if(V.$$typeof===C)return I(M,E,L,Ru(E,V),he);Uu(E,V)}return null}function le(M,E,L,V){for(var he=null,Ie=null,oe=E,Oe=E=0,Be=null;oe!==null&&Oe<L.length;Oe++){oe.index>Oe?(Be=oe,oe=null):Be=oe.sibling;var Pe=U(M,oe,L[Oe],V);if(Pe===null){oe===null&&(oe=Be);break}r&&oe&&Pe.alternate===null&&o(M,oe),E=y(Pe,E,Oe),Ie===null?he=Pe:Ie.sibling=Pe,Ie=Pe,oe=Be}if(Oe===L.length)return u(M,oe),Ue&&Qn(M,Oe),he;if(oe===null){for(;Oe<L.length;Oe++)oe=G(M,L[Oe],V),oe!==null&&(E=y(oe,E,Oe),Ie===null?he=oe:Ie.sibling=oe,Ie=oe);return Ue&&Qn(M,Oe),he}for(oe=f(oe);Oe<L.length;Oe++)Be=I(oe,M,Oe,L[Oe],V),Be!==null&&(r&&Be.alternate!==null&&oe.delete(Be.key===null?Oe:Be.key),E=y(Be,E,Oe),Ie===null?he=Be:Ie.sibling=Be,Ie=Be);return r&&oe.forEach(function(Ks){return o(M,Ks)}),Ue&&Qn(M,Oe),he}function de(M,E,L,V){if(L==null)throw Error(n(151));for(var he=null,Ie=null,oe=E,Oe=E=0,Be=null,Pe=L.next();oe!==null&&!Pe.done;Oe++,Pe=L.next()){oe.index>Oe?(Be=oe,oe=null):Be=oe.sibling;var Ks=U(M,oe,Pe.value,V);if(Ks===null){oe===null&&(oe=Be);break}r&&oe&&Ks.alternate===null&&o(M,oe),E=y(Ks,E,Oe),Ie===null?he=Ks:Ie.sibling=Ks,Ie=Ks,oe=Be}if(Pe.done)return u(M,oe),Ue&&Qn(M,Oe),he;if(oe===null){for(;!Pe.done;Oe++,Pe=L.next())Pe=G(M,Pe.value,V),Pe!==null&&(E=y(Pe,E,Oe),Ie===null?he=Pe:Ie.sibling=Pe,Ie=Pe);return Ue&&Qn(M,Oe),he}for(oe=f(oe);!Pe.done;Oe++,Pe=L.next())Pe=I(oe,M,Oe,Pe.value,V),Pe!==null&&(r&&Pe.alternate!==null&&oe.delete(Pe.key===null?Oe:Pe.key),E=y(Pe,E,Oe),Ie===null?he=Pe:Ie.sibling=Pe,Ie=Pe);return r&&oe.forEach(function(xR){return o(M,xR)}),Ue&&Qn(M,Oe),he}function We(M,E,L,V){if(typeof L=="object"&&L!==null&&L.type===k&&L.key===null&&(L=L.props.children),typeof L=="object"&&L!==null){switch(L.$$typeof){case v:e:{for(var he=L.key;E!==null;){if(E.key===he){if(he=L.type,he===k){if(E.tag===7){u(M,E.sibling),V=g(E,L.props.children),V.return=M,M=V;break e}}else if(E.elementType===he||typeof he=="object"&&he!==null&&he.$$typeof===W&&_r(he)===E.type){u(M,E.sibling),V=g(E,L.props),ga(V,L),V.return=M,M=V;break e}u(M,E);break}else o(M,E);E=E.sibling}L.type===k?(V=vr(L.props.children,M.mode,V,L.key),V.return=M,M=V):(V=Tu(L.type,L.key,L.props,null,M.mode,V),ga(V,L),V.return=M,M=V)}return S(M);case w:e:{for(he=L.key;E!==null;){if(E.key===he)if(E.tag===4&&E.stateNode.containerInfo===L.containerInfo&&E.stateNode.implementation===L.implementation){u(M,E.sibling),V=g(E,L.children||[]),V.return=M,M=V;break e}else{u(M,E);break}else o(M,E);E=E.sibling}V=Tp(L,M.mode,V),V.return=M,M=V}return S(M);case W:return L=_r(L),We(M,E,L,V)}if(be(L))return le(M,E,L,V);if(J(L)){if(he=J(L),typeof he!="function")throw Error(n(150));return L=he.call(L),de(M,E,L,V)}if(typeof L.then=="function")return We(M,E,Bu(L),V);if(L.$$typeof===C)return We(M,E,Ru(M,L),V);Uu(M,L)}return typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint"?(L=""+L,E!==null&&E.tag===6?(u(M,E.sibling),V=g(E,L),V.return=M,M=V):(u(M,E),V=Cp(L,M.mode,V),V.return=M,M=V),S(M)):u(M,E)}return function(M,E,L,V){try{pa=0;var he=We(M,E,L,V);return Tl=null,he}catch(oe){if(oe===Cl||oe===Nu)throw oe;var Ie=xi(29,oe,null,M.mode);return Ie.lanes=V,Ie.return=M,Ie}}}var Ar=bw(!0),vw=bw(!1),Es=!1;function Pp(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hp(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ds(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Rs(r,o,u){var f=r.updateQueue;if(f===null)return null;if(f=f.shared,(qe&2)!==0){var g=f.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),f.pending=o,o=Cu(r),iw(r,null,u),o}return Au(r,f,o,u),Cu(r)}function ma(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,uv(r,u)}}function qp(r,o){var u=r.updateQueue,f=r.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var g=null,y=null;if(u=u.firstBaseUpdate,u!==null){do{var S={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};y===null?g=y=S:y=y.next=S,u=u.next}while(u!==null);y===null?g=y=o:y=y.next=o}else g=y=o;u={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:f.shared,callbacks:f.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}var Vp=!1;function ya(){if(Vp){var r=Al;if(r!==null)throw r}}function ba(r,o,u,f){Vp=!1;var g=r.updateQueue;Es=!1;var y=g.firstBaseUpdate,S=g.lastBaseUpdate,x=g.shared.pending;if(x!==null){g.shared.pending=null;var A=x,B=A.next;A.next=null,S===null?y=B:S.next=B,S=A;var P=r.alternate;P!==null&&(P=P.updateQueue,x=P.lastBaseUpdate,x!==S&&(x===null?P.firstBaseUpdate=B:x.next=B,P.lastBaseUpdate=A))}if(y!==null){var G=g.baseState;S=0,P=B=A=null,x=y;do{var U=x.lane&-536870913,I=U!==x.lane;if(I?(Le&U)===U:(f&U)===U){U!==0&&U===Ol&&(Vp=!0),P!==null&&(P=P.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var le=r,de=x;U=o;var We=u;switch(de.tag){case 1:if(le=de.payload,typeof le=="function"){G=le.call(We,G,U);break e}G=le;break e;case 3:le.flags=le.flags&-65537|128;case 0:if(le=de.payload,U=typeof le=="function"?le.call(We,G,U):le,U==null)break e;G=m({},G,U);break e;case 2:Es=!0}}U=x.callback,U!==null&&(r.flags|=64,I&&(r.flags|=8192),I=g.callbacks,I===null?g.callbacks=[U]:I.push(U))}else I={lane:U,tag:x.tag,payload:x.payload,callback:x.callback,next:null},P===null?(B=P=I,A=G):P=P.next=I,S|=U;if(x=x.next,x===null){if(x=g.shared.pending,x===null)break;I=x,x=I.next,I.next=null,g.lastBaseUpdate=I,g.shared.pending=null}}while(!0);P===null&&(A=G),g.baseState=A,g.firstBaseUpdate=B,g.lastBaseUpdate=P,y===null&&(g.shared.lanes=0),Us|=S,r.lanes=S,r.memoizedState=G}}function ww(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function Sw(r,o){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)ww(u[r],o)}var El=T(null),ju=T(0);function kw(r,o){r=as,X(ju,r),X(El,o),as=r|o.baseLanes}function $p(){X(ju,as),X(El,El.current)}function Gp(){as=ju.current,q(El),q(ju)}var _i=T(null),Yi=null;function Ms(r){var o=r.alternate;X(ft,ft.current&1),X(_i,r),Yi===null&&(o===null||El.current!==null||o.memoizedState!==null)&&(Yi=r)}function Kp(r){X(ft,ft.current),X(_i,r),Yi===null&&(Yi=r)}function xw(r){r.tag===22?(X(ft,ft.current),X(_i,r),Yi===null&&(Yi=r)):Ns()}function Ns(){X(ft,ft.current),X(_i,_i.current)}function Oi(r){q(_i),Yi===r&&(Yi=null),q(ft)}var ft=T(0);function zu(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||Jg(u)||Zg(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var es=0,Se=null,Ge=null,bt=null,Iu=!1,Dl=!1,Cr=!1,Pu=0,va=0,Rl=null,dD=0;function ot(){throw Error(n(321))}function Wp(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!ki(r[u],o[u]))return!1;return!0}function Yp(r,o,u,f,g,y){return es=y,Se=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,z.H=r===null||r.memoizedState===null?lS:cg,Cr=!1,y=u(f,g),Cr=!1,Dl&&(y=Ow(o,u,f,g)),_w(r),y}function _w(r){z.H=ka;var o=Ge!==null&&Ge.next!==null;if(es=0,bt=Ge=Se=null,Iu=!1,va=0,Rl=null,o)throw Error(n(300));r===null||vt||(r=r.dependencies,r!==null&&Du(r)&&(vt=!0))}function Ow(r,o,u,f){Se=r;var g=0;do{if(Dl&&(Rl=null),va=0,Dl=!1,25<=g)throw Error(n(301));if(g+=1,bt=Ge=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}z.H=oS,y=o(u,f)}while(Dl);return y}function pD(){var r=z.H,o=r.useState()[0];return o=typeof o.then=="function"?wa(o):o,r=r.useState()[0],(Ge!==null?Ge.memoizedState:null)!==r&&(Se.flags|=1024),o}function Fp(){var r=Pu!==0;return Pu=0,r}function Xp(r,o,u){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~u}function Qp(r){if(Iu){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Iu=!1}es=0,bt=Ge=Se=null,Dl=!1,va=Pu=0,Rl=null}function Zt(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?Se.memoizedState=bt=r:bt=bt.next=r,bt}function dt(){if(Ge===null){var r=Se.alternate;r=r!==null?r.memoizedState:null}else r=Ge.next;var o=bt===null?Se.memoizedState:bt.next;if(o!==null)bt=o,Ge=r;else{if(r===null)throw Se.alternate===null?Error(n(467)):Error(n(310));Ge=r,r={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},bt===null?Se.memoizedState=bt=r:bt=bt.next=r}return bt}function Hu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wa(r){var o=va;return va+=1,Rl===null&&(Rl=[]),r=gw(Rl,r,o),o=Se,(bt===null?o.memoizedState:bt.next)===null&&(o=o.alternate,z.H=o===null||o.memoizedState===null?lS:cg),r}function qu(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return wa(r);if(r.$$typeof===C)return zt(r)}throw Error(n(438,String(r)))}function Jp(r){var o=null,u=Se.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var f=Se.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(o={data:f.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Hu(),Se.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(r),f=0;f<r;f++)u[f]=Ce;return o.index++,u}function ts(r,o){return typeof o=="function"?o(r):o}function Vu(r){var o=dt();return Zp(o,Ge,r)}function Zp(r,o,u){var f=r.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=u;var g=r.baseQueue,y=f.pending;if(y!==null){if(g!==null){var S=g.next;g.next=y.next,y.next=S}o.baseQueue=g=y,f.pending=null}if(y=r.baseState,g===null)r.memoizedState=y;else{o=g.next;var x=S=null,A=null,B=o,P=!1;do{var G=B.lane&-536870913;if(G!==B.lane?(Le&G)===G:(es&G)===G){var U=B.revertLane;if(U===0)A!==null&&(A=A.next={lane:0,revertLane:0,gesture:null,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null}),G===Ol&&(P=!0);else if((es&U)===U){B=B.next,U===Ol&&(P=!0);continue}else G={lane:0,revertLane:B.revertLane,gesture:null,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null},A===null?(x=A=G,S=y):A=A.next=G,Se.lanes|=U,Us|=U;G=B.action,Cr&&u(y,G),y=B.hasEagerState?B.eagerState:u(y,G)}else U={lane:G,revertLane:B.revertLane,gesture:B.gesture,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null},A===null?(x=A=U,S=y):A=A.next=U,Se.lanes|=G,Us|=G;B=B.next}while(B!==null&&B!==o);if(A===null?S=y:A.next=x,!ki(y,r.memoizedState)&&(vt=!0,P&&(u=Al,u!==null)))throw u;r.memoizedState=y,r.baseState=S,r.baseQueue=A,f.lastRenderedState=y}return g===null&&(f.lanes=0),[r.memoizedState,f.dispatch]}function eg(r){var o=dt(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var f=u.dispatch,g=u.pending,y=o.memoizedState;if(g!==null){u.pending=null;var S=g=g.next;do y=r(y,S.action),S=S.next;while(S!==g);ki(y,o.memoizedState)||(vt=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),u.lastRenderedState=y}return[y,f]}function Aw(r,o,u){var f=Se,g=dt(),y=Ue;if(y){if(u===void 0)throw Error(n(407));u=u()}else u=o();var S=!ki((Ge||g).memoizedState,u);if(S&&(g.memoizedState=u,vt=!0),g=g.queue,ng(Ew.bind(null,f,g,r),[r]),g.getSnapshot!==o||S||bt!==null&&bt.memoizedState.tag&1){if(f.flags|=2048,Ml(9,{destroy:void 0},Tw.bind(null,f,g,u,o),null),Fe===null)throw Error(n(349));y||(es&127)!==0||Cw(f,o,u)}return u}function Cw(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=Se.updateQueue,o===null?(o=Hu(),Se.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function Tw(r,o,u,f){o.value=u,o.getSnapshot=f,Dw(o)&&Rw(r)}function Ew(r,o,u){return u(function(){Dw(o)&&Rw(r)})}function Dw(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!ki(r,u)}catch{return!0}}function Rw(r){var o=br(r,2);o!==null&&ui(o,r,2)}function tg(r){var o=Zt();if(typeof r=="function"){var u=r;if(r=u(),Cr){ks(!0);try{u()}finally{ks(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ts,lastRenderedState:r},o}function Mw(r,o,u,f){return r.baseState=u,Zp(r,Ge,typeof f=="function"?f:ts)}function gD(r,o,u,f,g){if(Ku(r))throw Error(n(485));if(r=o.action,r!==null){var y={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){y.listeners.push(S)}};z.T!==null?u(!0):y.isTransition=!1,f(y),u=o.pending,u===null?(y.next=o.pending=y,Nw(o,y)):(y.next=u.next,o.pending=u.next=y)}}function Nw(r,o){var u=o.action,f=o.payload,g=r.state;if(o.isTransition){var y=z.T,S={};z.T=S;try{var x=u(g,f),A=z.S;A!==null&&A(S,x),Lw(r,o,x)}catch(B){ig(r,o,B)}finally{y!==null&&S.types!==null&&(y.types=S.types),z.T=y}}else try{y=u(g,f),Lw(r,o,y)}catch(B){ig(r,o,B)}}function Lw(r,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){Bw(r,o,f)},function(f){return ig(r,o,f)}):Bw(r,o,u)}function Bw(r,o,u){o.status="fulfilled",o.value=u,Uw(o),r.state=u,o=r.pending,o!==null&&(u=o.next,u===o?r.pending=null:(u=u.next,o.next=u,Nw(r,u)))}function ig(r,o,u){var f=r.pending;if(r.pending=null,f!==null){f=f.next;do o.status="rejected",o.reason=u,Uw(o),o=o.next;while(o!==f)}r.action=null}function Uw(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function jw(r,o){return o}function zw(r,o){if(Ue){var u=Fe.formState;if(u!==null){e:{var f=Se;if(Ue){if(it){t:{for(var g=it,y=Wi;g.nodeType!==8;){if(!y){g=null;break t}if(g=Fi(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){it=Fi(g.nextSibling),f=g.data==="F!";break e}}Cs(f)}f=!1}f&&(o=u[0])}}return u=Zt(),u.memoizedState=u.baseState=o,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jw,lastRenderedState:o},u.queue=f,u=nS.bind(null,Se,f),f.dispatch=u,f=tg(!1),y=ag.bind(null,Se,!1,f.queue),f=Zt(),g={state:o,dispatch:null,action:r,pending:null},f.queue=g,u=gD.bind(null,Se,g,y,u),g.dispatch=u,f.memoizedState=r,[o,u,!1]}function Iw(r){var o=dt();return Pw(o,Ge,r)}function Pw(r,o,u){if(o=Zp(r,o,jw)[0],r=Vu(ts)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var f=wa(o)}catch(S){throw S===Cl?Nu:S}else f=o;o=dt();var g=o.queue,y=g.dispatch;return u!==o.memoizedState&&(Se.flags|=2048,Ml(9,{destroy:void 0},mD.bind(null,g,u),null)),[f,y,r]}function mD(r,o){r.action=o}function Hw(r){var o=dt(),u=Ge;if(u!==null)return Pw(o,u,r);dt(),o=o.memoizedState,u=dt();var f=u.queue.dispatch;return u.memoizedState=r,[o,f,!1]}function Ml(r,o,u,f){return r={tag:r,create:u,deps:f,inst:o,next:null},o=Se.updateQueue,o===null&&(o=Hu(),Se.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=r.next=r:(f=u.next,u.next=r,r.next=f,o.lastEffect=r),r}function qw(){return dt().memoizedState}function $u(r,o,u,f){var g=Zt();Se.flags|=r,g.memoizedState=Ml(1|o,{destroy:void 0},u,f===void 0?null:f)}function Gu(r,o,u,f){var g=dt();f=f===void 0?null:f;var y=g.memoizedState.inst;Ge!==null&&f!==null&&Wp(f,Ge.memoizedState.deps)?g.memoizedState=Ml(o,y,u,f):(Se.flags|=r,g.memoizedState=Ml(1|o,y,u,f))}function Vw(r,o){$u(8390656,8,r,o)}function ng(r,o){Gu(2048,8,r,o)}function yD(r){Se.flags|=4;var o=Se.updateQueue;if(o===null)o=Hu(),Se.updateQueue=o,o.events=[r];else{var u=o.events;u===null?o.events=[r]:u.push(r)}}function $w(r){var o=dt().memoizedState;return yD({ref:o,nextImpl:r}),function(){if((qe&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function Gw(r,o){return Gu(4,2,r,o)}function Kw(r,o){return Gu(4,4,r,o)}function Ww(r,o){if(typeof o=="function"){r=r();var u=o(r);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Yw(r,o,u){u=u!=null?u.concat([r]):null,Gu(4,4,Ww.bind(null,o,r),u)}function sg(){}function Fw(r,o){var u=dt();o=o===void 0?null:o;var f=u.memoizedState;return o!==null&&Wp(o,f[1])?f[0]:(u.memoizedState=[r,o],r)}function Xw(r,o){var u=dt();o=o===void 0?null:o;var f=u.memoizedState;if(o!==null&&Wp(o,f[1]))return f[0];if(f=r(),Cr){ks(!0);try{r()}finally{ks(!1)}}return u.memoizedState=[f,o],f}function rg(r,o,u){return u===void 0||(es&1073741824)!==0&&(Le&261930)===0?r.memoizedState=o:(r.memoizedState=u,r=QS(),Se.lanes|=r,Us|=r,u)}function Qw(r,o,u,f){return ki(u,o)?u:El.current!==null?(r=rg(r,u,f),ki(r,o)||(vt=!0),r):(es&42)===0||(es&1073741824)!==0&&(Le&261930)===0?(vt=!0,r.memoizedState=u):(r=QS(),Se.lanes|=r,Us|=r,o)}function Jw(r,o,u,f,g){var y=Y.p;Y.p=y!==0&&8>y?y:8;var S=z.T,x={};z.T=x,ag(r,!1,o,u);try{var A=g(),B=z.S;if(B!==null&&B(x,A),A!==null&&typeof A=="object"&&typeof A.then=="function"){var P=fD(A,f);Sa(r,o,P,Ti(r))}else Sa(r,o,f,Ti(r))}catch(G){Sa(r,o,{then:function(){},status:"rejected",reason:G},Ti())}finally{Y.p=y,S!==null&&x.types!==null&&(S.types=x.types),z.T=S}}function bD(){}function lg(r,o,u,f){if(r.tag!==5)throw Error(n(476));var g=Zw(r).queue;Jw(r,g,o,ae,u===null?bD:function(){return eS(r),u(f)})}function Zw(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ts,lastRenderedState:ae},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ts,lastRenderedState:u},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function eS(r){var o=Zw(r);o.next===null&&(o=r.alternate.memoizedState),Sa(r,o.next.queue,{},Ti())}function og(){return zt(za)}function tS(){return dt().memoizedState}function iS(){return dt().memoizedState}function vD(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var u=Ti();r=Ds(u);var f=Rs(o,r,u);f!==null&&(ui(f,o,u),ma(f,o,u)),o={cache:Up()},r.payload=o;return}o=o.return}}function wD(r,o,u){var f=Ti();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Ku(r)?sS(o,u):(u=Op(r,o,u,f),u!==null&&(ui(u,r,f),rS(u,o,f)))}function nS(r,o,u){var f=Ti();Sa(r,o,u,f)}function Sa(r,o,u,f){var g={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Ku(r))sS(o,g);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var S=o.lastRenderedState,x=y(S,u);if(g.hasEagerState=!0,g.eagerState=x,ki(x,S))return Au(r,o,g,0),Fe===null&&Ou(),!1}catch{}if(u=Op(r,o,g,f),u!==null)return ui(u,r,f),rS(u,o,f),!0}return!1}function ag(r,o,u,f){if(f={lane:2,revertLane:Pg(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Ku(r)){if(o)throw Error(n(479))}else o=Op(r,u,f,2),o!==null&&ui(o,r,2)}function Ku(r){var o=r.alternate;return r===Se||o!==null&&o===Se}function sS(r,o){Dl=Iu=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function rS(r,o,u){if((u&4194048)!==0){var f=o.lanes;f&=r.pendingLanes,u|=f,o.lanes=u,uv(r,u)}}var ka={readContext:zt,use:qu,useCallback:ot,useContext:ot,useEffect:ot,useImperativeHandle:ot,useLayoutEffect:ot,useInsertionEffect:ot,useMemo:ot,useReducer:ot,useRef:ot,useState:ot,useDebugValue:ot,useDeferredValue:ot,useTransition:ot,useSyncExternalStore:ot,useId:ot,useHostTransitionStatus:ot,useFormState:ot,useActionState:ot,useOptimistic:ot,useMemoCache:ot,useCacheRefresh:ot};ka.useEffectEvent=ot;var lS={readContext:zt,use:qu,useCallback:function(r,o){return Zt().memoizedState=[r,o===void 0?null:o],r},useContext:zt,useEffect:Vw,useImperativeHandle:function(r,o,u){u=u!=null?u.concat([r]):null,$u(4194308,4,Ww.bind(null,o,r),u)},useLayoutEffect:function(r,o){return $u(4194308,4,r,o)},useInsertionEffect:function(r,o){$u(4,2,r,o)},useMemo:function(r,o){var u=Zt();o=o===void 0?null:o;var f=r();if(Cr){ks(!0);try{r()}finally{ks(!1)}}return u.memoizedState=[f,o],f},useReducer:function(r,o,u){var f=Zt();if(u!==void 0){var g=u(o);if(Cr){ks(!0);try{u(o)}finally{ks(!1)}}}else g=o;return f.memoizedState=f.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},f.queue=r,r=r.dispatch=wD.bind(null,Se,r),[f.memoizedState,r]},useRef:function(r){var o=Zt();return r={current:r},o.memoizedState=r},useState:function(r){r=tg(r);var o=r.queue,u=nS.bind(null,Se,o);return o.dispatch=u,[r.memoizedState,u]},useDebugValue:sg,useDeferredValue:function(r,o){var u=Zt();return rg(u,r,o)},useTransition:function(){var r=tg(!1);return r=Jw.bind(null,Se,r.queue,!0,!1),Zt().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,u){var f=Se,g=Zt();if(Ue){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),Fe===null)throw Error(n(349));(Le&127)!==0||Cw(f,o,u)}g.memoizedState=u;var y={value:u,getSnapshot:o};return g.queue=y,Vw(Ew.bind(null,f,y,r),[r]),f.flags|=2048,Ml(9,{destroy:void 0},Tw.bind(null,f,y,u,o),null),u},useId:function(){var r=Zt(),o=Fe.identifierPrefix;if(Ue){var u=On,f=_n;u=(f&~(1<<32-Si(f)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Pu++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=dD++,o="_"+o+"r_"+u.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:og,useFormState:zw,useActionState:zw,useOptimistic:function(r){var o=Zt();o.memoizedState=o.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=ag.bind(null,Se,!0,u),u.dispatch=o,[r,o]},useMemoCache:Jp,useCacheRefresh:function(){return Zt().memoizedState=vD.bind(null,Se)},useEffectEvent:function(r){var o=Zt(),u={impl:r};return o.memoizedState=u,function(){if((qe&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},cg={readContext:zt,use:qu,useCallback:Fw,useContext:zt,useEffect:ng,useImperativeHandle:Yw,useInsertionEffect:Gw,useLayoutEffect:Kw,useMemo:Xw,useReducer:Vu,useRef:qw,useState:function(){return Vu(ts)},useDebugValue:sg,useDeferredValue:function(r,o){var u=dt();return Qw(u,Ge.memoizedState,r,o)},useTransition:function(){var r=Vu(ts)[0],o=dt().memoizedState;return[typeof r=="boolean"?r:wa(r),o]},useSyncExternalStore:Aw,useId:tS,useHostTransitionStatus:og,useFormState:Iw,useActionState:Iw,useOptimistic:function(r,o){var u=dt();return Mw(u,Ge,r,o)},useMemoCache:Jp,useCacheRefresh:iS};cg.useEffectEvent=$w;var oS={readContext:zt,use:qu,useCallback:Fw,useContext:zt,useEffect:ng,useImperativeHandle:Yw,useInsertionEffect:Gw,useLayoutEffect:Kw,useMemo:Xw,useReducer:eg,useRef:qw,useState:function(){return eg(ts)},useDebugValue:sg,useDeferredValue:function(r,o){var u=dt();return Ge===null?rg(u,r,o):Qw(u,Ge.memoizedState,r,o)},useTransition:function(){var r=eg(ts)[0],o=dt().memoizedState;return[typeof r=="boolean"?r:wa(r),o]},useSyncExternalStore:Aw,useId:tS,useHostTransitionStatus:og,useFormState:Hw,useActionState:Hw,useOptimistic:function(r,o){var u=dt();return Ge!==null?Mw(u,Ge,r,o):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:Jp,useCacheRefresh:iS};oS.useEffectEvent=$w;function ug(r,o,u,f){o=r.memoizedState,u=u(f,o),u=u==null?o:m({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var hg={enqueueSetState:function(r,o,u){r=r._reactInternals;var f=Ti(),g=Ds(f);g.payload=o,u!=null&&(g.callback=u),o=Rs(r,g,f),o!==null&&(ui(o,r,f),ma(o,r,f))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var f=Ti(),g=Ds(f);g.tag=1,g.payload=o,u!=null&&(g.callback=u),o=Rs(r,g,f),o!==null&&(ui(o,r,f),ma(o,r,f))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=Ti(),f=Ds(u);f.tag=2,o!=null&&(f.callback=o),o=Rs(r,f,u),o!==null&&(ui(o,r,u),ma(o,r,u))}};function aS(r,o,u,f,g,y,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(f,y,S):o.prototype&&o.prototype.isPureReactComponent?!aa(u,f)||!aa(g,y):!0}function cS(r,o,u,f){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,f),o.state!==r&&hg.enqueueReplaceState(o,o.state,null)}function Tr(r,o){var u=o;if("ref"in o){u={};for(var f in o)f!=="ref"&&(u[f]=o[f])}if(r=r.defaultProps){u===o&&(u=m({},u));for(var g in r)u[g]===void 0&&(u[g]=r[g])}return u}function uS(r){_u(r)}function hS(r){console.error(r)}function fS(r){_u(r)}function Wu(r,o){try{var u=r.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(f){setTimeout(function(){throw f})}}function dS(r,o,u){try{var f=r.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function fg(r,o,u){return u=Ds(u),u.tag=3,u.payload={element:null},u.callback=function(){Wu(r,o)},u}function pS(r){return r=Ds(r),r.tag=3,r}function gS(r,o,u,f){var g=u.type.getDerivedStateFromError;if(typeof g=="function"){var y=f.value;r.payload=function(){return g(y)},r.callback=function(){dS(o,u,f)}}var S=u.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){dS(o,u,f),typeof g!="function"&&(js===null?js=new Set([this]):js.add(this));var x=f.stack;this.componentDidCatch(f.value,{componentStack:x!==null?x:""})})}function SD(r,o,u,f,g){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(o=u.alternate,o!==null&&_l(o,u,g,!0),u=_i.current,u!==null){switch(u.tag){case 31:case 13:return Yi===null?rh():u.alternate===null&&at===0&&(at=3),u.flags&=-257,u.flags|=65536,u.lanes=g,f===Lu?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([f]):o.add(f),jg(r,f,g)),!1;case 22:return u.flags|=65536,f===Lu?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([f]):u.add(f)),jg(r,f,g)),!1}throw Error(n(435,u.tag))}return jg(r,f,g),rh(),!1}if(Ue)return o=_i.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,f!==Rp&&(r=Error(n(422),{cause:f}),ha($i(r,u)))):(f!==Rp&&(o=Error(n(423),{cause:f}),ha($i(o,u))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,f=$i(f,u),g=fg(r.stateNode,f,g),qp(r,g),at!==4&&(at=2)),!1;var y=Error(n(520),{cause:f});if(y=$i(y,u),Da===null?Da=[y]:Da.push(y),at!==4&&(at=2),o===null)return!0;f=$i(f,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,r=g&-g,u.lanes|=r,r=fg(u.stateNode,f,r),qp(u,r),!1;case 1:if(o=u.type,y=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(js===null||!js.has(y))))return u.flags|=65536,g&=-g,u.lanes|=g,g=pS(g),gS(g,r,u,f),qp(u,g),!1}u=u.return}while(u!==null);return!1}var dg=Error(n(461)),vt=!1;function It(r,o,u,f){o.child=r===null?vw(o,null,u,f):Ar(o,r.child,u,f)}function mS(r,o,u,f,g){u=u.render;var y=o.ref;if("ref"in f){var S={};for(var x in f)x!=="ref"&&(S[x]=f[x])}else S=f;return kr(o),f=Yp(r,o,u,S,y,g),x=Fp(),r!==null&&!vt?(Xp(r,o,g),is(r,o,g)):(Ue&&x&&Ep(o),o.flags|=1,It(r,o,f,g),o.child)}function yS(r,o,u,f,g){if(r===null){var y=u.type;return typeof y=="function"&&!Ap(y)&&y.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=y,bS(r,o,y,f,g)):(r=Tu(u.type,null,f,o,o.mode,g),r.ref=o.ref,r.return=o,o.child=r)}if(y=r.child,!Sg(r,g)){var S=y.memoizedProps;if(u=u.compare,u=u!==null?u:aa,u(S,f)&&r.ref===o.ref)return is(r,o,g)}return o.flags|=1,r=Xn(y,f),r.ref=o.ref,r.return=o,o.child=r}function bS(r,o,u,f,g){if(r!==null){var y=r.memoizedProps;if(aa(y,f)&&r.ref===o.ref)if(vt=!1,o.pendingProps=f=y,Sg(r,g))(r.flags&131072)!==0&&(vt=!0);else return o.lanes=r.lanes,is(r,o,g)}return pg(r,o,u,f,g)}function vS(r,o,u,f){var g=f.children,y=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((o.flags&128)!==0){if(y=y!==null?y.baseLanes|u:u,r!==null){for(f=o.child=r.child,g=0;f!==null;)g=g|f.lanes|f.childLanes,f=f.sibling;f=g&~y}else f=0,o.child=null;return wS(r,o,y,u,f)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Mu(o,y!==null?y.cachePool:null),y!==null?kw(o,y):$p(),xw(o);else return f=o.lanes=536870912,wS(r,o,y!==null?y.baseLanes|u:u,u,f)}else y!==null?(Mu(o,y.cachePool),kw(o,y),Ns(),o.memoizedState=null):(r!==null&&Mu(o,null),$p(),Ns());return It(r,o,g,u),o.child}function xa(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function wS(r,o,u,f,g){var y=zp();return y=y===null?null:{parent:yt._currentValue,pool:y},o.memoizedState={baseLanes:u,cachePool:y},r!==null&&Mu(o,null),$p(),xw(o),r!==null&&_l(r,o,f,!0),o.childLanes=g,null}function Yu(r,o){return o=Xu({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function SS(r,o,u){return Ar(o,r.child,null,u),r=Yu(o,o.pendingProps),r.flags|=2,Oi(o),o.memoizedState=null,r}function kD(r,o,u){var f=o.pendingProps,g=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Ue){if(f.mode==="hidden")return r=Yu(o,f),o.lanes=536870912,xa(null,r);if(Kp(o),(r=it)?(r=N1(r,Wi),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Os!==null?{id:_n,overflow:On}:null,retryLane:536870912,hydrationErrors:null},u=sw(r),u.return=o,o.child=u,jt=o,it=null)):r=null,r===null)throw Cs(o);return o.lanes=536870912,null}return Yu(o,f)}var y=r.memoizedState;if(y!==null){var S=y.dehydrated;if(Kp(o),g)if(o.flags&256)o.flags&=-257,o=SS(r,o,u);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(n(558));else if(vt||_l(r,o,u,!1),g=(u&r.childLanes)!==0,vt||g){if(f=Fe,f!==null&&(S=hv(f,u),S!==0&&S!==y.retryLane))throw y.retryLane=S,br(r,S),ui(f,r,S),dg;rh(),o=SS(r,o,u)}else r=y.treeContext,it=Fi(S.nextSibling),jt=o,Ue=!0,As=null,Wi=!1,r!==null&&ow(o,r),o=Yu(o,f),o.flags|=4096;return o}return r=Xn(r.child,{mode:f.mode,children:f.children}),r.ref=o.ref,o.child=r,r.return=o,r}function Fu(r,o){var u=o.ref;if(u===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(o.flags|=4194816)}}function pg(r,o,u,f,g){return kr(o),u=Yp(r,o,u,f,void 0,g),f=Fp(),r!==null&&!vt?(Xp(r,o,g),is(r,o,g)):(Ue&&f&&Ep(o),o.flags|=1,It(r,o,u,g),o.child)}function kS(r,o,u,f,g,y){return kr(o),o.updateQueue=null,u=Ow(o,f,u,g),_w(r),f=Fp(),r!==null&&!vt?(Xp(r,o,y),is(r,o,y)):(Ue&&f&&Ep(o),o.flags|=1,It(r,o,u,y),o.child)}function xS(r,o,u,f,g){if(kr(o),o.stateNode===null){var y=wl,S=u.contextType;typeof S=="object"&&S!==null&&(y=zt(S)),y=new u(f,y),o.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=hg,o.stateNode=y,y._reactInternals=o,y=o.stateNode,y.props=f,y.state=o.memoizedState,y.refs={},Pp(o),S=u.contextType,y.context=typeof S=="object"&&S!==null?zt(S):wl,y.state=o.memoizedState,S=u.getDerivedStateFromProps,typeof S=="function"&&(ug(o,u,S,f),y.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(S=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),S!==y.state&&hg.enqueueReplaceState(y,y.state,null),ba(o,f,y,g),ya(),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308),f=!0}else if(r===null){y=o.stateNode;var x=o.memoizedProps,A=Tr(u,x);y.props=A;var B=y.context,P=u.contextType;S=wl,typeof P=="object"&&P!==null&&(S=zt(P));var G=u.getDerivedStateFromProps;P=typeof G=="function"||typeof y.getSnapshotBeforeUpdate=="function",x=o.pendingProps!==x,P||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(x||B!==S)&&cS(o,y,f,S),Es=!1;var U=o.memoizedState;y.state=U,ba(o,f,y,g),ya(),B=o.memoizedState,x||U!==B||Es?(typeof G=="function"&&(ug(o,u,G,f),B=o.memoizedState),(A=Es||aS(o,u,A,f,U,B,S))?(P||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(o.flags|=4194308)):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=B),y.props=f,y.state=B,y.context=S,f=A):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{y=o.stateNode,Hp(r,o),S=o.memoizedProps,P=Tr(u,S),y.props=P,G=o.pendingProps,U=y.context,B=u.contextType,A=wl,typeof B=="object"&&B!==null&&(A=zt(B)),x=u.getDerivedStateFromProps,(B=typeof x=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S!==G||U!==A)&&cS(o,y,f,A),Es=!1,U=o.memoizedState,y.state=U,ba(o,f,y,g),ya();var I=o.memoizedState;S!==G||U!==I||Es||r!==null&&r.dependencies!==null&&Du(r.dependencies)?(typeof x=="function"&&(ug(o,u,x,f),I=o.memoizedState),(P=Es||aS(o,u,P,f,U,I,A)||r!==null&&r.dependencies!==null&&Du(r.dependencies))?(B||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(f,I,A),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(f,I,A)),typeof y.componentDidUpdate=="function"&&(o.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof y.componentDidUpdate!="function"||S===r.memoizedProps&&U===r.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&U===r.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=I),y.props=f,y.state=I,y.context=A,f=P):(typeof y.componentDidUpdate!="function"||S===r.memoizedProps&&U===r.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&U===r.memoizedState||(o.flags|=1024),f=!1)}return y=f,Fu(r,o),f=(o.flags&128)!==0,y||f?(y=o.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:y.render(),o.flags|=1,r!==null&&f?(o.child=Ar(o,r.child,null,g),o.child=Ar(o,null,u,g)):It(r,o,u,g),o.memoizedState=y.state,r=o.child):r=is(r,o,g),r}function _S(r,o,u,f){return wr(),o.flags|=256,It(r,o,u,f),o.child}var gg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function mg(r){return{baseLanes:r,cachePool:dw()}}function yg(r,o,u){return r=r!==null?r.childLanes&~u:0,o&&(r|=Ci),r}function OS(r,o,u){var f=o.pendingProps,g=!1,y=(o.flags&128)!==0,S;if((S=y)||(S=r!==null&&r.memoizedState===null?!1:(ft.current&2)!==0),S&&(g=!0,o.flags&=-129),S=(o.flags&32)!==0,o.flags&=-33,r===null){if(Ue){if(g?Ms(o):Ns(),(r=it)?(r=N1(r,Wi),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Os!==null?{id:_n,overflow:On}:null,retryLane:536870912,hydrationErrors:null},u=sw(r),u.return=o,o.child=u,jt=o,it=null)):r=null,r===null)throw Cs(o);return Zg(r)?o.lanes=32:o.lanes=536870912,null}var x=f.children;return f=f.fallback,g?(Ns(),g=o.mode,x=Xu({mode:"hidden",children:x},g),f=vr(f,g,u,null),x.return=o,f.return=o,x.sibling=f,o.child=x,f=o.child,f.memoizedState=mg(u),f.childLanes=yg(r,S,u),o.memoizedState=gg,xa(null,f)):(Ms(o),bg(o,x))}var A=r.memoizedState;if(A!==null&&(x=A.dehydrated,x!==null)){if(y)o.flags&256?(Ms(o),o.flags&=-257,o=vg(r,o,u)):o.memoizedState!==null?(Ns(),o.child=r.child,o.flags|=128,o=null):(Ns(),x=f.fallback,g=o.mode,f=Xu({mode:"visible",children:f.children},g),x=vr(x,g,u,null),x.flags|=2,f.return=o,x.return=o,f.sibling=x,o.child=f,Ar(o,r.child,null,u),f=o.child,f.memoizedState=mg(u),f.childLanes=yg(r,S,u),o.memoizedState=gg,o=xa(null,f));else if(Ms(o),Zg(x)){if(S=x.nextSibling&&x.nextSibling.dataset,S)var B=S.dgst;S=B,f=Error(n(419)),f.stack="",f.digest=S,ha({value:f,source:null,stack:null}),o=vg(r,o,u)}else if(vt||_l(r,o,u,!1),S=(u&r.childLanes)!==0,vt||S){if(S=Fe,S!==null&&(f=hv(S,u),f!==0&&f!==A.retryLane))throw A.retryLane=f,br(r,f),ui(S,r,f),dg;Jg(x)||rh(),o=vg(r,o,u)}else Jg(x)?(o.flags|=192,o.child=r.child,o=null):(r=A.treeContext,it=Fi(x.nextSibling),jt=o,Ue=!0,As=null,Wi=!1,r!==null&&ow(o,r),o=bg(o,f.children),o.flags|=4096);return o}return g?(Ns(),x=f.fallback,g=o.mode,A=r.child,B=A.sibling,f=Xn(A,{mode:"hidden",children:f.children}),f.subtreeFlags=A.subtreeFlags&65011712,B!==null?x=Xn(B,x):(x=vr(x,g,u,null),x.flags|=2),x.return=o,f.return=o,f.sibling=x,o.child=f,xa(null,f),f=o.child,x=r.child.memoizedState,x===null?x=mg(u):(g=x.cachePool,g!==null?(A=yt._currentValue,g=g.parent!==A?{parent:A,pool:A}:g):g=dw(),x={baseLanes:x.baseLanes|u,cachePool:g}),f.memoizedState=x,f.childLanes=yg(r,S,u),o.memoizedState=gg,xa(r.child,f)):(Ms(o),u=r.child,r=u.sibling,u=Xn(u,{mode:"visible",children:f.children}),u.return=o,u.sibling=null,r!==null&&(S=o.deletions,S===null?(o.deletions=[r],o.flags|=16):S.push(r)),o.child=u,o.memoizedState=null,u)}function bg(r,o){return o=Xu({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function Xu(r,o){return r=xi(22,r,null,o),r.lanes=0,r}function vg(r,o,u){return Ar(o,r.child,null,u),r=bg(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function AS(r,o,u){r.lanes|=o;var f=r.alternate;f!==null&&(f.lanes|=o),Lp(r.return,o,u)}function wg(r,o,u,f,g,y){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:g,treeForkCount:y}:(S.isBackwards=o,S.rendering=null,S.renderingStartTime=0,S.last=f,S.tail=u,S.tailMode=g,S.treeForkCount=y)}function CS(r,o,u){var f=o.pendingProps,g=f.revealOrder,y=f.tail;f=f.children;var S=ft.current,x=(S&2)!==0;if(x?(S=S&1|2,o.flags|=128):S&=1,X(ft,S),It(r,o,f,u),f=Ue?ua:0,!x&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&AS(r,u,o);else if(r.tag===19)AS(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(g){case"forwards":for(u=o.child,g=null;u!==null;)r=u.alternate,r!==null&&zu(r)===null&&(g=u),u=u.sibling;u=g,u===null?(g=o.child,o.child=null):(g=u.sibling,u.sibling=null),wg(o,!1,g,u,y,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,g=o.child,o.child=null;g!==null;){if(r=g.alternate,r!==null&&zu(r)===null){o.child=g;break}r=g.sibling,g.sibling=u,u=g,g=r}wg(o,!0,u,null,y,f);break;case"together":wg(o,!1,null,null,void 0,f);break;default:o.memoizedState=null}return o.child}function is(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),Us|=o.lanes,(u&o.childLanes)===0)if(r!==null){if(_l(r,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,u=Xn(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=Xn(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function Sg(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&Du(r)))}function xD(r,o,u){switch(o.tag){case 3:Jt(o,o.stateNode.containerInfo),Ts(o,yt,r.memoizedState.cache),wr();break;case 27:case 5:Fo(o);break;case 4:Jt(o,o.stateNode.containerInfo);break;case 10:Ts(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Kp(o),null;break;case 13:var f=o.memoizedState;if(f!==null)return f.dehydrated!==null?(Ms(o),o.flags|=128,null):(u&o.child.childLanes)!==0?OS(r,o,u):(Ms(o),r=is(r,o,u),r!==null?r.sibling:null);Ms(o);break;case 19:var g=(r.flags&128)!==0;if(f=(u&o.childLanes)!==0,f||(_l(r,o,u,!1),f=(u&o.childLanes)!==0),g){if(f)return CS(r,o,u);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),X(ft,ft.current),f)break;return null;case 22:return o.lanes=0,vS(r,o,u,o.pendingProps);case 24:Ts(o,yt,r.memoizedState.cache)}return is(r,o,u)}function TS(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps)vt=!0;else{if(!Sg(r,u)&&(o.flags&128)===0)return vt=!1,xD(r,o,u);vt=(r.flags&131072)!==0}else vt=!1,Ue&&(o.flags&1048576)!==0&&lw(o,ua,o.index);switch(o.lanes=0,o.tag){case 16:e:{var f=o.pendingProps;if(r=_r(o.elementType),o.type=r,typeof r=="function")Ap(r)?(f=Tr(r,f),o.tag=1,o=xS(null,o,r,f,u)):(o.tag=0,o=pg(null,o,r,f,u));else{if(r!=null){var g=r.$$typeof;if(g===N){o.tag=11,o=mS(null,o,r,f,u);break e}else if(g===D){o.tag=14,o=yS(null,o,r,f,u);break e}}throw o=re(r)||r,Error(n(306,o,""))}}return o;case 0:return pg(r,o,o.type,o.pendingProps,u);case 1:return f=o.type,g=Tr(f,o.pendingProps),xS(r,o,f,g,u);case 3:e:{if(Jt(o,o.stateNode.containerInfo),r===null)throw Error(n(387));f=o.pendingProps;var y=o.memoizedState;g=y.element,Hp(r,o),ba(o,f,null,u);var S=o.memoizedState;if(f=S.cache,Ts(o,yt,f),f!==y.cache&&Bp(o,[yt],u,!0),ya(),f=S.element,y.isDehydrated)if(y={element:f,isDehydrated:!1,cache:S.cache},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){o=_S(r,o,f,u);break e}else if(f!==g){g=$i(Error(n(424)),o),ha(g),o=_S(r,o,f,u);break e}else for(r=o.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,it=Fi(r.firstChild),jt=o,Ue=!0,As=null,Wi=!0,u=vw(o,null,f,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(wr(),f===g){o=is(r,o,u);break e}It(r,o,f,u)}o=o.child}return o;case 26:return Fu(r,o),r===null?(u=I1(o.type,null,o.pendingProps,null))?o.memoizedState=u:Ue||(u=o.type,r=o.pendingProps,f=fh(we.current).createElement(u),f[Ut]=o,f[si]=r,Pt(f,u,r),Dt(f),o.stateNode=f):o.memoizedState=I1(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Fo(o),r===null&&Ue&&(f=o.stateNode=U1(o.type,o.pendingProps,we.current),jt=o,Wi=!0,g=it,Hs(o.type)?(em=g,it=Fi(f.firstChild)):it=g),It(r,o,o.pendingProps.children,u),Fu(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Ue&&((g=f=it)&&(f=ZD(f,o.type,o.pendingProps,Wi),f!==null?(o.stateNode=f,jt=o,it=Fi(f.firstChild),Wi=!1,g=!0):g=!1),g||Cs(o)),Fo(o),g=o.type,y=o.pendingProps,S=r!==null?r.memoizedProps:null,f=y.children,Fg(g,y)?f=null:S!==null&&Fg(g,S)&&(o.flags|=32),o.memoizedState!==null&&(g=Yp(r,o,pD,null,null,u),za._currentValue=g),Fu(r,o),It(r,o,f,u),o.child;case 6:return r===null&&Ue&&((r=u=it)&&(u=eR(u,o.pendingProps,Wi),u!==null?(o.stateNode=u,jt=o,it=null,r=!0):r=!1),r||Cs(o)),null;case 13:return OS(r,o,u);case 4:return Jt(o,o.stateNode.containerInfo),f=o.pendingProps,r===null?o.child=Ar(o,null,f,u):It(r,o,f,u),o.child;case 11:return mS(r,o,o.type,o.pendingProps,u);case 7:return It(r,o,o.pendingProps,u),o.child;case 8:return It(r,o,o.pendingProps.children,u),o.child;case 12:return It(r,o,o.pendingProps.children,u),o.child;case 10:return f=o.pendingProps,Ts(o,o.type,f.value),It(r,o,f.children,u),o.child;case 9:return g=o.type._context,f=o.pendingProps.children,kr(o),g=zt(g),f=f(g),o.flags|=1,It(r,o,f,u),o.child;case 14:return yS(r,o,o.type,o.pendingProps,u);case 15:return bS(r,o,o.type,o.pendingProps,u);case 19:return CS(r,o,u);case 31:return kD(r,o,u);case 22:return vS(r,o,u,o.pendingProps);case 24:return kr(o),f=zt(yt),r===null?(g=zp(),g===null&&(g=Fe,y=Up(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=u),g=y),o.memoizedState={parent:f,cache:g},Pp(o),Ts(o,yt,g)):((r.lanes&u)!==0&&(Hp(r,o),ba(o,null,null,u),ya()),g=r.memoizedState,y=o.memoizedState,g.parent!==f?(g={parent:f,cache:f},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),Ts(o,yt,f)):(f=y.cache,Ts(o,yt,f),f!==g.cache&&Bp(o,[yt],u,!0))),It(r,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function ns(r){r.flags|=4}function kg(r,o,u,f,g){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(g&335544128)===g)if(r.stateNode.complete)r.flags|=8192;else if(t1())r.flags|=8192;else throw Or=Lu,Ip}else r.flags&=-16777217}function ES(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!$1(o))if(t1())r.flags|=8192;else throw Or=Lu,Ip}function Qu(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?av():536870912,r.lanes|=o,Ul|=o)}function _a(r,o){if(!Ue)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:f.sibling=null}}function nt(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,f=0;if(o)for(var g=r.child;g!==null;)u|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)u|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=f,r.childLanes=u,o}function _D(r,o,u){var f=o.pendingProps;switch(Dp(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nt(o),null;case 1:return nt(o),null;case 3:return u=o.stateNode,f=null,r!==null&&(f=r.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),Zn(yt),ht(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(xl(o)?ns(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Mp())),nt(o),null;case 26:var g=o.type,y=o.memoizedState;return r===null?(ns(o),y!==null?(nt(o),ES(o,y)):(nt(o),kg(o,g,null,f,u))):y?y!==r.memoizedState?(ns(o),nt(o),ES(o,y)):(nt(o),o.flags&=-16777217):(r=r.memoizedProps,r!==f&&ns(o),nt(o),kg(o,g,r,f,u)),null;case 27:if(au(o),u=we.current,g=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&ns(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return nt(o),null}r=ie.current,xl(o)?aw(o):(r=U1(g,f,u),o.stateNode=r,ns(o))}return nt(o),null;case 5:if(au(o),g=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==f&&ns(o);else{if(!f){if(o.stateNode===null)throw Error(n(166));return nt(o),null}if(y=ie.current,xl(o))aw(o);else{var S=fh(we.current);switch(y){case 1:y=S.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=S.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=S.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof f.is=="string"?S.createElement("select",{is:f.is}):S.createElement("select"),f.multiple?y.multiple=!0:f.size&&(y.size=f.size);break;default:y=typeof f.is=="string"?S.createElement(g,{is:f.is}):S.createElement(g)}}y[Ut]=o,y[si]=f;e:for(S=o.child;S!==null;){if(S.tag===5||S.tag===6)y.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===o)break e;for(;S.sibling===null;){if(S.return===null||S.return===o)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}o.stateNode=y;e:switch(Pt(y,g,f),g){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&ns(o)}}return nt(o),kg(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,u),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==f&&ns(o);else{if(typeof f!="string"&&o.stateNode===null)throw Error(n(166));if(r=we.current,xl(o)){if(r=o.stateNode,u=o.memoizedProps,f=null,g=jt,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}r[Ut]=o,r=!!(r.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||O1(r.nodeValue,u)),r||Cs(o,!0)}else r=fh(r).createTextNode(f),r[Ut]=o,o.stateNode=r}return nt(o),null;case 31:if(u=o.memoizedState,r===null||r.memoizedState!==null){if(f=xl(o),u!==null){if(r===null){if(!f)throw Error(n(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[Ut]=o}else wr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;nt(o),r=!1}else u=Mp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return o.flags&256?(Oi(o),o):(Oi(o),null);if((o.flags&128)!==0)throw Error(n(558))}return nt(o),null;case 13:if(f=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=xl(o),f!==null&&f.dehydrated!==null){if(r===null){if(!g)throw Error(n(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[Ut]=o}else wr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;nt(o),g=!1}else g=Mp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(Oi(o),o):(Oi(o),null)}return Oi(o),(o.flags&128)!==0?(o.lanes=u,o):(u=f!==null,r=r!==null&&r.memoizedState!==null,u&&(f=o.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool),y=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==g&&(f.flags|=2048)),u!==r&&u&&(o.child.flags|=8192),Qu(o,o.updateQueue),nt(o),null);case 4:return ht(),r===null&&$g(o.stateNode.containerInfo),nt(o),null;case 10:return Zn(o.type),nt(o),null;case 19:if(q(ft),f=o.memoizedState,f===null)return nt(o),null;if(g=(o.flags&128)!==0,y=f.rendering,y===null)if(g)_a(f,!1);else{if(at!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(y=zu(r),y!==null){for(o.flags|=128,_a(f,!1),r=y.updateQueue,o.updateQueue=r,Qu(o,r),o.subtreeFlags=0,r=u,u=o.child;u!==null;)nw(u,r),u=u.sibling;return X(ft,ft.current&1|2),Ue&&Qn(o,f.treeForkCount),o.child}r=r.sibling}f.tail!==null&&vi()>ih&&(o.flags|=128,g=!0,_a(f,!1),o.lanes=4194304)}else{if(!g)if(r=zu(y),r!==null){if(o.flags|=128,g=!0,r=r.updateQueue,o.updateQueue=r,Qu(o,r),_a(f,!0),f.tail===null&&f.tailMode==="hidden"&&!y.alternate&&!Ue)return nt(o),null}else 2*vi()-f.renderingStartTime>ih&&u!==536870912&&(o.flags|=128,g=!0,_a(f,!1),o.lanes=4194304);f.isBackwards?(y.sibling=o.child,o.child=y):(r=f.last,r!==null?r.sibling=y:o.child=y,f.last=y)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=vi(),r.sibling=null,u=ft.current,X(ft,g?u&1|2:u&1),Ue&&Qn(o,f.treeForkCount),r):(nt(o),null);case 22:case 23:return Oi(o),Gp(),f=o.memoizedState!==null,r!==null?r.memoizedState!==null!==f&&(o.flags|=8192):f&&(o.flags|=8192),f?(u&536870912)!==0&&(o.flags&128)===0&&(nt(o),o.subtreeFlags&6&&(o.flags|=8192)):nt(o),u=o.updateQueue,u!==null&&Qu(o,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),f=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),f!==u&&(o.flags|=2048),r!==null&&q(xr),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Zn(yt),nt(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function OD(r,o){switch(Dp(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Zn(yt),ht(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return au(o),null;case 31:if(o.memoizedState!==null){if(Oi(o),o.alternate===null)throw Error(n(340));wr()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(Oi(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));wr()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return q(ft),null;case 4:return ht(),null;case 10:return Zn(o.type),null;case 22:case 23:return Oi(o),Gp(),r!==null&&q(xr),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return Zn(yt),null;case 25:return null;default:return null}}function DS(r,o){switch(Dp(o),o.tag){case 3:Zn(yt),ht();break;case 26:case 27:case 5:au(o);break;case 4:ht();break;case 31:o.memoizedState!==null&&Oi(o);break;case 13:Oi(o);break;case 19:q(ft);break;case 10:Zn(o.type);break;case 22:case 23:Oi(o),Gp(),r!==null&&q(xr);break;case 24:Zn(yt)}}function Oa(r,o){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var g=f.next;u=g;do{if((u.tag&r)===r){f=void 0;var y=u.create,S=u.inst;f=y(),S.destroy=f}u=u.next}while(u!==g)}}catch(x){$e(o,o.return,x)}}function Ls(r,o,u){try{var f=o.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var y=g.next;f=y;do{if((f.tag&r)===r){var S=f.inst,x=S.destroy;if(x!==void 0){S.destroy=void 0,g=o;var A=u,B=x;try{B()}catch(P){$e(g,A,P)}}}f=f.next}while(f!==y)}}catch(P){$e(o,o.return,P)}}function RS(r){var o=r.updateQueue;if(o!==null){var u=r.stateNode;try{Sw(o,u)}catch(f){$e(r,r.return,f)}}}function MS(r,o,u){u.props=Tr(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(f){$e(r,o,f)}}function Aa(r,o){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var f=r.stateNode;break;case 30:f=r.stateNode;break;default:f=r.stateNode}typeof u=="function"?r.refCleanup=u(f):u.current=f}}catch(g){$e(r,o,g)}}function An(r,o){var u=r.ref,f=r.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(g){$e(r,o,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(g){$e(r,o,g)}else u.current=null}function NS(r){var o=r.type,u=r.memoizedProps,f=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(g){$e(r,r.return,g)}}function xg(r,o,u){try{var f=r.stateNode;WD(f,r.type,u,o),f[si]=o}catch(g){$e(r,r.return,g)}}function LS(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Hs(r.type)||r.tag===4}function _g(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||LS(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Hs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Og(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(r),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Yn));else if(f!==4&&(f===27&&Hs(r.type)&&(u=r.stateNode,o=null),r=r.child,r!==null))for(Og(r,o,u),r=r.sibling;r!==null;)Og(r,o,u),r=r.sibling}function Ju(r,o,u){var f=r.tag;if(f===5||f===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(f!==4&&(f===27&&Hs(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(Ju(r,o,u),r=r.sibling;r!==null;)Ju(r,o,u),r=r.sibling}function BS(r){var o=r.stateNode,u=r.memoizedProps;try{for(var f=r.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);Pt(o,f,u),o[Ut]=r,o[si]=u}catch(y){$e(r,r.return,y)}}var ss=!1,wt=!1,Ag=!1,US=typeof WeakSet=="function"?WeakSet:Set,Rt=null;function AD(r,o){if(r=r.containerInfo,Wg=vh,r=Yv(r),vp(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var g=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{u.nodeType,y.nodeType}catch{u=null;break e}var S=0,x=-1,A=-1,B=0,P=0,G=r,U=null;t:for(;;){for(var I;G!==u||g!==0&&G.nodeType!==3||(x=S+g),G!==y||f!==0&&G.nodeType!==3||(A=S+f),G.nodeType===3&&(S+=G.nodeValue.length),(I=G.firstChild)!==null;)U=G,G=I;for(;;){if(G===r)break t;if(U===u&&++B===g&&(x=S),U===y&&++P===f&&(A=S),(I=G.nextSibling)!==null)break;G=U,U=G.parentNode}G=I}u=x===-1||A===-1?null:{start:x,end:A}}else u=null}u=u||{start:0,end:0}}else u=null;for(Yg={focusedElem:r,selectionRange:u},vh=!1,Rt=o;Rt!==null;)if(o=Rt,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Rt=r;else for(;Rt!==null;){switch(o=Rt,y=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)g=r[u],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,u=o,g=y.memoizedProps,y=y.memoizedState,f=u.stateNode;try{var le=Tr(u.type,g);r=f.getSnapshotBeforeUpdate(le,y),f.__reactInternalSnapshotBeforeUpdate=r}catch(de){$e(u,u.return,de)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,u=r.nodeType,u===9)Qg(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Qg(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,Rt=r;break}Rt=o.return}}function jS(r,o,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:ls(r,u),f&4&&Oa(5,u);break;case 1:if(ls(r,u),f&4)if(r=u.stateNode,o===null)try{r.componentDidMount()}catch(S){$e(u,u.return,S)}else{var g=Tr(u.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(g,o,r.__reactInternalSnapshotBeforeUpdate)}catch(S){$e(u,u.return,S)}}f&64&&RS(u),f&512&&Aa(u,u.return);break;case 3:if(ls(r,u),f&64&&(r=u.updateQueue,r!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{Sw(r,o)}catch(S){$e(u,u.return,S)}}break;case 27:o===null&&f&4&&BS(u);case 26:case 5:ls(r,u),o===null&&f&4&&NS(u),f&512&&Aa(u,u.return);break;case 12:ls(r,u);break;case 31:ls(r,u),f&4&&PS(r,u);break;case 13:ls(r,u),f&4&&HS(r,u),f&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=BD.bind(null,u),tR(r,u))));break;case 22:if(f=u.memoizedState!==null||ss,!f){o=o!==null&&o.memoizedState!==null||wt,g=ss;var y=wt;ss=f,(wt=o)&&!y?os(r,u,(u.subtreeFlags&8772)!==0):ls(r,u),ss=g,wt=y}break;case 30:break;default:ls(r,u)}}function zS(r){var o=r.alternate;o!==null&&(r.alternate=null,zS(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&ip(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var st=null,li=!1;function rs(r,o,u){for(u=u.child;u!==null;)IS(r,o,u),u=u.sibling}function IS(r,o,u){if(wi&&typeof wi.onCommitFiberUnmount=="function")try{wi.onCommitFiberUnmount(Xo,u)}catch{}switch(u.tag){case 26:wt||An(u,o),rs(r,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:wt||An(u,o);var f=st,g=li;Hs(u.type)&&(st=u.stateNode,li=!1),rs(r,o,u),Ba(u.stateNode),st=f,li=g;break;case 5:wt||An(u,o);case 6:if(f=st,g=li,st=null,rs(r,o,u),st=f,li=g,st!==null)if(li)try{(st.nodeType===9?st.body:st.nodeName==="HTML"?st.ownerDocument.body:st).removeChild(u.stateNode)}catch(y){$e(u,o,y)}else try{st.removeChild(u.stateNode)}catch(y){$e(u,o,y)}break;case 18:st!==null&&(li?(r=st,R1(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),$l(r)):R1(st,u.stateNode));break;case 4:f=st,g=li,st=u.stateNode.containerInfo,li=!0,rs(r,o,u),st=f,li=g;break;case 0:case 11:case 14:case 15:Ls(2,u,o),wt||Ls(4,u,o),rs(r,o,u);break;case 1:wt||(An(u,o),f=u.stateNode,typeof f.componentWillUnmount=="function"&&MS(u,o,f)),rs(r,o,u);break;case 21:rs(r,o,u);break;case 22:wt=(f=wt)||u.memoizedState!==null,rs(r,o,u),wt=f;break;default:rs(r,o,u)}}function PS(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{$l(r)}catch(u){$e(o,o.return,u)}}}function HS(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{$l(r)}catch(u){$e(o,o.return,u)}}function CD(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new US),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new US),o;default:throw Error(n(435,r.tag))}}function Zu(r,o){var u=CD(r);o.forEach(function(f){if(!u.has(f)){u.add(f);var g=UD.bind(null,r,f);f.then(g,g)}})}function oi(r,o){var u=o.deletions;if(u!==null)for(var f=0;f<u.length;f++){var g=u[f],y=r,S=o,x=S;e:for(;x!==null;){switch(x.tag){case 27:if(Hs(x.type)){st=x.stateNode,li=!1;break e}break;case 5:st=x.stateNode,li=!1;break e;case 3:case 4:st=x.stateNode.containerInfo,li=!0;break e}x=x.return}if(st===null)throw Error(n(160));IS(y,S,g),st=null,li=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)qS(o,r),o=o.sibling}var an=null;function qS(r,o){var u=r.alternate,f=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:oi(o,r),ai(r),f&4&&(Ls(3,r,r.return),Oa(3,r),Ls(5,r,r.return));break;case 1:oi(o,r),ai(r),f&512&&(wt||u===null||An(u,u.return)),f&64&&ss&&(r=r.updateQueue,r!==null&&(f=r.callbacks,f!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var g=an;if(oi(o,r),ai(r),f&512&&(wt||u===null||An(u,u.return)),f&4){var y=u!==null?u.memoizedState:null;if(f=r.memoizedState,u===null)if(f===null)if(r.stateNode===null){e:{f=r.type,u=r.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":y=g.getElementsByTagName("title")[0],(!y||y[Zo]||y[Ut]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(f),g.head.insertBefore(y,g.querySelector("head > title"))),Pt(y,f,u),y[Ut]=r,Dt(y),f=y;break e;case"link":var S=q1("link","href",g).get(f+(u.href||""));if(S){for(var x=0;x<S.length;x++)if(y=S[x],y.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&y.getAttribute("rel")===(u.rel==null?null:u.rel)&&y.getAttribute("title")===(u.title==null?null:u.title)&&y.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){S.splice(x,1);break t}}y=g.createElement(f),Pt(y,f,u),g.head.appendChild(y);break;case"meta":if(S=q1("meta","content",g).get(f+(u.content||""))){for(x=0;x<S.length;x++)if(y=S[x],y.getAttribute("content")===(u.content==null?null:""+u.content)&&y.getAttribute("name")===(u.name==null?null:u.name)&&y.getAttribute("property")===(u.property==null?null:u.property)&&y.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&y.getAttribute("charset")===(u.charSet==null?null:u.charSet)){S.splice(x,1);break t}}y=g.createElement(f),Pt(y,f,u),g.head.appendChild(y);break;default:throw Error(n(468,f))}y[Ut]=r,Dt(y),f=y}r.stateNode=f}else V1(g,r.type,r.stateNode);else r.stateNode=H1(g,f,r.memoizedProps);else y!==f?(y===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):y.count--,f===null?V1(g,r.type,r.stateNode):H1(g,f,r.memoizedProps)):f===null&&r.stateNode!==null&&xg(r,r.memoizedProps,u.memoizedProps)}break;case 27:oi(o,r),ai(r),f&512&&(wt||u===null||An(u,u.return)),u!==null&&f&4&&xg(r,r.memoizedProps,u.memoizedProps);break;case 5:if(oi(o,r),ai(r),f&512&&(wt||u===null||An(u,u.return)),r.flags&32){g=r.stateNode;try{dl(g,"")}catch(le){$e(r,r.return,le)}}f&4&&r.stateNode!=null&&(g=r.memoizedProps,xg(r,g,u!==null?u.memoizedProps:g)),f&1024&&(Ag=!0);break;case 6:if(oi(o,r),ai(r),f&4){if(r.stateNode===null)throw Error(n(162));f=r.memoizedProps,u=r.stateNode;try{u.nodeValue=f}catch(le){$e(r,r.return,le)}}break;case 3:if(gh=null,g=an,an=dh(o.containerInfo),oi(o,r),an=g,ai(r),f&4&&u!==null&&u.memoizedState.isDehydrated)try{$l(o.containerInfo)}catch(le){$e(r,r.return,le)}Ag&&(Ag=!1,VS(r));break;case 4:f=an,an=dh(r.stateNode.containerInfo),oi(o,r),ai(r),an=f;break;case 12:oi(o,r),ai(r);break;case 31:oi(o,r),ai(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Zu(r,f)));break;case 13:oi(o,r),ai(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(th=vi()),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Zu(r,f)));break;case 22:g=r.memoizedState!==null;var A=u!==null&&u.memoizedState!==null,B=ss,P=wt;if(ss=B||g,wt=P||A,oi(o,r),wt=P,ss=B,ai(r),f&8192)e:for(o=r.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(u===null||A||ss||wt||Er(r)),u=null,o=r;;){if(o.tag===5||o.tag===26){if(u===null){A=u=o;try{if(y=A.stateNode,g)S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{x=A.stateNode;var G=A.memoizedProps.style,U=G!=null&&G.hasOwnProperty("display")?G.display:null;x.style.display=U==null||typeof U=="boolean"?"":(""+U).trim()}}catch(le){$e(A,A.return,le)}}}else if(o.tag===6){if(u===null){A=o;try{A.stateNode.nodeValue=g?"":A.memoizedProps}catch(le){$e(A,A.return,le)}}}else if(o.tag===18){if(u===null){A=o;try{var I=A.stateNode;g?M1(I,!0):M1(A.stateNode,!1)}catch(le){$e(A,A.return,le)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}f&4&&(f=r.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,Zu(r,u))));break;case 19:oi(o,r),ai(r),f&4&&(f=r.updateQueue,f!==null&&(r.updateQueue=null,Zu(r,f)));break;case 30:break;case 21:break;default:oi(o,r),ai(r)}}function ai(r){var o=r.flags;if(o&2){try{for(var u,f=r.return;f!==null;){if(LS(f)){u=f;break}f=f.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var g=u.stateNode,y=_g(r);Ju(r,y,g);break;case 5:var S=u.stateNode;u.flags&32&&(dl(S,""),u.flags&=-33);var x=_g(r);Ju(r,x,S);break;case 3:case 4:var A=u.stateNode.containerInfo,B=_g(r);Og(r,B,A);break;default:throw Error(n(161))}}catch(P){$e(r,r.return,P)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function VS(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;VS(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function ls(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)jS(r,o.alternate,o),o=o.sibling}function Er(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:Ls(4,o,o.return),Er(o);break;case 1:An(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&MS(o,o.return,u),Er(o);break;case 27:Ba(o.stateNode);case 26:case 5:An(o,o.return),Er(o);break;case 22:o.memoizedState===null&&Er(o);break;case 30:Er(o);break;default:Er(o)}r=r.sibling}}function os(r,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var f=o.alternate,g=r,y=o,S=y.flags;switch(y.tag){case 0:case 11:case 15:os(g,y,u),Oa(4,y);break;case 1:if(os(g,y,u),f=y,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(B){$e(f,f.return,B)}if(f=y,g=f.updateQueue,g!==null){var x=f.stateNode;try{var A=g.shared.hiddenCallbacks;if(A!==null)for(g.shared.hiddenCallbacks=null,g=0;g<A.length;g++)ww(A[g],x)}catch(B){$e(f,f.return,B)}}u&&S&64&&RS(y),Aa(y,y.return);break;case 27:BS(y);case 26:case 5:os(g,y,u),u&&f===null&&S&4&&NS(y),Aa(y,y.return);break;case 12:os(g,y,u);break;case 31:os(g,y,u),u&&S&4&&PS(g,y);break;case 13:os(g,y,u),u&&S&4&&HS(g,y);break;case 22:y.memoizedState===null&&os(g,y,u),Aa(y,y.return);break;case 30:break;default:os(g,y,u)}o=o.sibling}}function Cg(r,o){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&fa(u))}function Tg(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&fa(r))}function cn(r,o,u,f){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)$S(r,o,u,f),o=o.sibling}function $S(r,o,u,f){var g=o.flags;switch(o.tag){case 0:case 11:case 15:cn(r,o,u,f),g&2048&&Oa(9,o);break;case 1:cn(r,o,u,f);break;case 3:cn(r,o,u,f),g&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&fa(r)));break;case 12:if(g&2048){cn(r,o,u,f),r=o.stateNode;try{var y=o.memoizedProps,S=y.id,x=y.onPostCommit;typeof x=="function"&&x(S,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(A){$e(o,o.return,A)}}else cn(r,o,u,f);break;case 31:cn(r,o,u,f);break;case 13:cn(r,o,u,f);break;case 23:break;case 22:y=o.stateNode,S=o.alternate,o.memoizedState!==null?y._visibility&2?cn(r,o,u,f):Ca(r,o):y._visibility&2?cn(r,o,u,f):(y._visibility|=2,Nl(r,o,u,f,(o.subtreeFlags&10256)!==0||!1)),g&2048&&Cg(S,o);break;case 24:cn(r,o,u,f),g&2048&&Tg(o.alternate,o);break;default:cn(r,o,u,f)}}function Nl(r,o,u,f,g){for(g=g&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var y=r,S=o,x=u,A=f,B=S.flags;switch(S.tag){case 0:case 11:case 15:Nl(y,S,x,A,g),Oa(8,S);break;case 23:break;case 22:var P=S.stateNode;S.memoizedState!==null?P._visibility&2?Nl(y,S,x,A,g):Ca(y,S):(P._visibility|=2,Nl(y,S,x,A,g)),g&&B&2048&&Cg(S.alternate,S);break;case 24:Nl(y,S,x,A,g),g&&B&2048&&Tg(S.alternate,S);break;default:Nl(y,S,x,A,g)}o=o.sibling}}function Ca(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=r,f=o,g=f.flags;switch(f.tag){case 22:Ca(u,f),g&2048&&Cg(f.alternate,f);break;case 24:Ca(u,f),g&2048&&Tg(f.alternate,f);break;default:Ca(u,f)}o=o.sibling}}var Ta=8192;function Ll(r,o,u){if(r.subtreeFlags&Ta)for(r=r.child;r!==null;)GS(r,o,u),r=r.sibling}function GS(r,o,u){switch(r.tag){case 26:Ll(r,o,u),r.flags&Ta&&r.memoizedState!==null&&dR(u,an,r.memoizedState,r.memoizedProps);break;case 5:Ll(r,o,u);break;case 3:case 4:var f=an;an=dh(r.stateNode.containerInfo),Ll(r,o,u),an=f;break;case 22:r.memoizedState===null&&(f=r.alternate,f!==null&&f.memoizedState!==null?(f=Ta,Ta=16777216,Ll(r,o,u),Ta=f):Ll(r,o,u));break;default:Ll(r,o,u)}}function KS(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Ea(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];Rt=f,YS(f,r)}KS(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)WS(r),r=r.sibling}function WS(r){switch(r.tag){case 0:case 11:case 15:Ea(r),r.flags&2048&&Ls(9,r,r.return);break;case 3:Ea(r);break;case 12:Ea(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,eh(r)):Ea(r);break;default:Ea(r)}}function eh(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var f=o[u];Rt=f,YS(f,r)}KS(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:Ls(8,o,o.return),eh(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,eh(o));break;default:eh(o)}r=r.sibling}}function YS(r,o){for(;Rt!==null;){var u=Rt;switch(u.tag){case 0:case 11:case 15:Ls(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:fa(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,Rt=f;else e:for(u=r;Rt!==null;){f=Rt;var g=f.sibling,y=f.return;if(zS(f),f===u){Rt=null;break e}if(g!==null){g.return=y,Rt=g;break e}Rt=y}}}var TD={getCacheForType:function(r){var o=zt(yt),u=o.data.get(r);return u===void 0&&(u=r(),o.data.set(r,u)),u},cacheSignal:function(){return zt(yt).controller.signal}},ED=typeof WeakMap=="function"?WeakMap:Map,qe=0,Fe=null,Me=null,Le=0,Ve=0,Ai=null,Bs=!1,Bl=!1,Eg=!1,as=0,at=0,Us=0,Dr=0,Dg=0,Ci=0,Ul=0,Da=null,ci=null,Rg=!1,th=0,FS=0,ih=1/0,nh=null,js=null,_t=0,zs=null,jl=null,cs=0,Mg=0,Ng=null,XS=null,Ra=0,Lg=null;function Ti(){return(qe&2)!==0&&Le!==0?Le&-Le:z.T!==null?Pg():fv()}function QS(){if(Ci===0)if((Le&536870912)===0||Ue){var r=hu;hu<<=1,(hu&3932160)===0&&(hu=262144),Ci=r}else Ci=536870912;return r=_i.current,r!==null&&(r.flags|=32),Ci}function ui(r,o,u){(r===Fe&&(Ve===2||Ve===9)||r.cancelPendingCommit!==null)&&(zl(r,0),Is(r,Le,Ci,!1)),Jo(r,u),((qe&2)===0||r!==Fe)&&(r===Fe&&((qe&2)===0&&(Dr|=u),at===4&&Is(r,Le,Ci,!1)),Cn(r))}function JS(r,o,u){if((qe&6)!==0)throw Error(n(327));var f=!u&&(o&127)===0&&(o&r.expiredLanes)===0||Qo(r,o),g=f?MD(r,o):Ug(r,o,!0),y=f;do{if(g===0){Bl&&!f&&Is(r,o,0,!1);break}else{if(u=r.current.alternate,y&&!DD(u)){g=Ug(r,o,!1),y=!1;continue}if(g===2){if(y=o,r.errorRecoveryDisabledLanes&y)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){o=S;e:{var x=r;g=Da;var A=x.current.memoizedState.isDehydrated;if(A&&(zl(x,S).flags|=256),S=Ug(x,S,!1),S!==2){if(Eg&&!A){x.errorRecoveryDisabledLanes|=y,Dr|=y,g=4;break e}y=ci,ci=g,y!==null&&(ci===null?ci=y:ci.push.apply(ci,y))}g=S}if(y=!1,g!==2)continue}}if(g===1){zl(r,0),Is(r,o,0,!0);break}e:{switch(f=r,y=g,y){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:Is(f,o,Ci,!Bs);break e;case 2:ci=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(g=th+300-vi(),10<g)){if(Is(f,o,Ci,!Bs),du(f,0,!0)!==0)break e;cs=o,f.timeoutHandle=E1(ZS.bind(null,f,u,ci,nh,Rg,o,Ci,Dr,Ul,Bs,y,"Throttled",-0,0),g);break e}ZS(f,u,ci,nh,Rg,o,Ci,Dr,Ul,Bs,y,null,-0,0)}}break}while(!0);Cn(r)}function ZS(r,o,u,f,g,y,S,x,A,B,P,G,U,I){if(r.timeoutHandle=-1,G=o.subtreeFlags,G&8192||(G&16785408)===16785408){G={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Yn},GS(o,y,G);var le=(y&62914560)===y?th-vi():(y&4194048)===y?FS-vi():0;if(le=pR(G,le),le!==null){cs=y,r.cancelPendingCommit=le(o1.bind(null,r,o,y,u,f,g,S,x,A,P,G,null,U,I)),Is(r,y,S,!B);return}}o1(r,o,y,u,f,g,S,x,A)}function DD(r){for(var o=r;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var g=u[f],y=g.getSnapshot;g=g.value;try{if(!ki(y(),g))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Is(r,o,u,f){o&=~Dg,o&=~Dr,r.suspendedLanes|=o,r.pingedLanes&=~o,f&&(r.warmLanes|=o),f=r.expirationTimes;for(var g=o;0<g;){var y=31-Si(g),S=1<<y;f[y]=-1,g&=~S}u!==0&&cv(r,u,o)}function sh(){return(qe&6)===0?(Ma(0),!1):!0}function Bg(){if(Me!==null){if(Ve===0)var r=Me.return;else r=Me,Jn=Sr=null,Qp(r),Tl=null,pa=0,r=Me;for(;r!==null;)DS(r.alternate,r),r=r.return;Me=null}}function zl(r,o){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,XD(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),cs=0,Bg(),Fe=r,Me=u=Xn(r.current,null),Le=o,Ve=0,Ai=null,Bs=!1,Bl=Qo(r,o),Eg=!1,Ul=Ci=Dg=Dr=Us=at=0,ci=Da=null,Rg=!1,(o&8)!==0&&(o|=o&32);var f=r.entangledLanes;if(f!==0)for(r=r.entanglements,f&=o;0<f;){var g=31-Si(f),y=1<<g;o|=r[g],f&=~y}return as=o,Ou(),u}function e1(r,o){Se=null,z.H=ka,o===Cl||o===Nu?(o=mw(),Ve=3):o===Ip?(o=mw(),Ve=4):Ve=o===dg?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ai=o,Me===null&&(at=1,Wu(r,$i(o,r.current)))}function t1(){var r=_i.current;return r===null?!0:(Le&4194048)===Le?Yi===null:(Le&62914560)===Le||(Le&536870912)!==0?r===Yi:!1}function i1(){var r=z.H;return z.H=ka,r===null?ka:r}function n1(){var r=z.A;return z.A=TD,r}function rh(){at=4,Bs||(Le&4194048)!==Le&&_i.current!==null||(Bl=!0),(Us&134217727)===0&&(Dr&134217727)===0||Fe===null||Is(Fe,Le,Ci,!1)}function Ug(r,o,u){var f=qe;qe|=2;var g=i1(),y=n1();(Fe!==r||Le!==o)&&(nh=null,zl(r,o)),o=!1;var S=at;e:do try{if(Ve!==0&&Me!==null){var x=Me,A=Ai;switch(Ve){case 8:Bg(),S=6;break e;case 3:case 2:case 9:case 6:_i.current===null&&(o=!0);var B=Ve;if(Ve=0,Ai=null,Il(r,x,A,B),u&&Bl){S=0;break e}break;default:B=Ve,Ve=0,Ai=null,Il(r,x,A,B)}}RD(),S=at;break}catch(P){e1(r,P)}while(!0);return o&&r.shellSuspendCounter++,Jn=Sr=null,qe=f,z.H=g,z.A=y,Me===null&&(Fe=null,Le=0,Ou()),S}function RD(){for(;Me!==null;)s1(Me)}function MD(r,o){var u=qe;qe|=2;var f=i1(),g=n1();Fe!==r||Le!==o?(nh=null,ih=vi()+500,zl(r,o)):Bl=Qo(r,o);e:do try{if(Ve!==0&&Me!==null){o=Me;var y=Ai;t:switch(Ve){case 1:Ve=0,Ai=null,Il(r,o,y,1);break;case 2:case 9:if(pw(y)){Ve=0,Ai=null,r1(o);break}o=function(){Ve!==2&&Ve!==9||Fe!==r||(Ve=7),Cn(r)},y.then(o,o);break e;case 3:Ve=7;break e;case 4:Ve=5;break e;case 7:pw(y)?(Ve=0,Ai=null,r1(o)):(Ve=0,Ai=null,Il(r,o,y,7));break;case 5:var S=null;switch(Me.tag){case 26:S=Me.memoizedState;case 5:case 27:var x=Me;if(S?$1(S):x.stateNode.complete){Ve=0,Ai=null;var A=x.sibling;if(A!==null)Me=A;else{var B=x.return;B!==null?(Me=B,lh(B)):Me=null}break t}}Ve=0,Ai=null,Il(r,o,y,5);break;case 6:Ve=0,Ai=null,Il(r,o,y,6);break;case 8:Bg(),at=6;break e;default:throw Error(n(462))}}ND();break}catch(P){e1(r,P)}while(!0);return Jn=Sr=null,z.H=f,z.A=g,qe=u,Me!==null?0:(Fe=null,Le=0,Ou(),at)}function ND(){for(;Me!==null&&!i2();)s1(Me)}function s1(r){var o=TS(r.alternate,r,as);r.memoizedProps=r.pendingProps,o===null?lh(r):Me=o}function r1(r){var o=r,u=o.alternate;switch(o.tag){case 15:case 0:o=kS(u,o,o.pendingProps,o.type,void 0,Le);break;case 11:o=kS(u,o,o.pendingProps,o.type.render,o.ref,Le);break;case 5:Qp(o);default:DS(u,o),o=Me=nw(o,as),o=TS(u,o,as)}r.memoizedProps=r.pendingProps,o===null?lh(r):Me=o}function Il(r,o,u,f){Jn=Sr=null,Qp(o),Tl=null,pa=0;var g=o.return;try{if(SD(r,g,o,u,Le)){at=1,Wu(r,$i(u,r.current)),Me=null;return}}catch(y){if(g!==null)throw Me=g,y;at=1,Wu(r,$i(u,r.current)),Me=null;return}o.flags&32768?(Ue||f===1?r=!0:Bl||(Le&536870912)!==0?r=!1:(Bs=r=!0,(f===2||f===9||f===3||f===6)&&(f=_i.current,f!==null&&f.tag===13&&(f.flags|=16384))),l1(o,r)):lh(o)}function lh(r){var o=r;do{if((o.flags&32768)!==0){l1(o,Bs);return}r=o.return;var u=_D(o.alternate,o,as);if(u!==null){Me=u;return}if(o=o.sibling,o!==null){Me=o;return}Me=o=r}while(o!==null);at===0&&(at=5)}function l1(r,o){do{var u=OD(r.alternate,r);if(u!==null){u.flags&=32767,Me=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(r=r.sibling,r!==null)){Me=r;return}Me=r=u}while(r!==null);at=6,Me=null}function o1(r,o,u,f,g,y,S,x,A){r.cancelPendingCommit=null;do oh();while(_t!==0);if((qe&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(y=o.lanes|o.childLanes,y|=_p,f2(r,u,y,S,x,A),r===Fe&&(Me=Fe=null,Le=0),jl=o,zs=r,cs=u,Mg=y,Ng=g,XS=f,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,jD(cu,function(){return f1(),null})):(r.callbackNode=null,r.callbackPriority=0),f=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||f){f=z.T,z.T=null,g=Y.p,Y.p=2,S=qe,qe|=4;try{AD(r,o,u)}finally{qe=S,Y.p=g,z.T=f}}_t=1,a1(),c1(),u1()}}function a1(){if(_t===1){_t=0;var r=zs,o=jl,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=z.T,z.T=null;var f=Y.p;Y.p=2;var g=qe;qe|=4;try{qS(o,r);var y=Yg,S=Yv(r.containerInfo),x=y.focusedElem,A=y.selectionRange;if(S!==x&&x&&x.ownerDocument&&Wv(x.ownerDocument.documentElement,x)){if(A!==null&&vp(x)){var B=A.start,P=A.end;if(P===void 0&&(P=B),"selectionStart"in x)x.selectionStart=B,x.selectionEnd=Math.min(P,x.value.length);else{var G=x.ownerDocument||document,U=G&&G.defaultView||window;if(U.getSelection){var I=U.getSelection(),le=x.textContent.length,de=Math.min(A.start,le),We=A.end===void 0?de:Math.min(A.end,le);!I.extend&&de>We&&(S=We,We=de,de=S);var M=Kv(x,de),E=Kv(x,We);if(M&&E&&(I.rangeCount!==1||I.anchorNode!==M.node||I.anchorOffset!==M.offset||I.focusNode!==E.node||I.focusOffset!==E.offset)){var L=G.createRange();L.setStart(M.node,M.offset),I.removeAllRanges(),de>We?(I.addRange(L),I.extend(E.node,E.offset)):(L.setEnd(E.node,E.offset),I.addRange(L))}}}}for(G=[],I=x;I=I.parentNode;)I.nodeType===1&&G.push({element:I,left:I.scrollLeft,top:I.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<G.length;x++){var V=G[x];V.element.scrollLeft=V.left,V.element.scrollTop=V.top}}vh=!!Wg,Yg=Wg=null}finally{qe=g,Y.p=f,z.T=u}}r.current=o,_t=2}}function c1(){if(_t===2){_t=0;var r=zs,o=jl,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=z.T,z.T=null;var f=Y.p;Y.p=2;var g=qe;qe|=4;try{jS(r,o.alternate,o)}finally{qe=g,Y.p=f,z.T=u}}_t=3}}function u1(){if(_t===4||_t===3){_t=0,n2();var r=zs,o=jl,u=cs,f=XS;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?_t=5:(_t=0,jl=zs=null,h1(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(js=null),ep(u),o=o.stateNode,wi&&typeof wi.onCommitFiberRoot=="function")try{wi.onCommitFiberRoot(Xo,o,void 0,(o.current.flags&128)===128)}catch{}if(f!==null){o=z.T,g=Y.p,Y.p=2,z.T=null;try{for(var y=r.onRecoverableError,S=0;S<f.length;S++){var x=f[S];y(x.value,{componentStack:x.stack})}}finally{z.T=o,Y.p=g}}(cs&3)!==0&&oh(),Cn(r),g=r.pendingLanes,(u&261930)!==0&&(g&42)!==0?r===Lg?Ra++:(Ra=0,Lg=r):Ra=0,Ma(0)}}function h1(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,fa(o)))}function oh(){return a1(),c1(),u1(),f1()}function f1(){if(_t!==5)return!1;var r=zs,o=Mg;Mg=0;var u=ep(cs),f=z.T,g=Y.p;try{Y.p=32>u?32:u,z.T=null,u=Ng,Ng=null;var y=zs,S=cs;if(_t=0,jl=zs=null,cs=0,(qe&6)!==0)throw Error(n(331));var x=qe;if(qe|=4,WS(y.current),$S(y,y.current,S,u),qe=x,Ma(0,!1),wi&&typeof wi.onPostCommitFiberRoot=="function")try{wi.onPostCommitFiberRoot(Xo,y)}catch{}return!0}finally{Y.p=g,z.T=f,h1(r,o)}}function d1(r,o,u){o=$i(u,o),o=fg(r.stateNode,o,2),r=Rs(r,o,2),r!==null&&(Jo(r,2),Cn(r))}function $e(r,o,u){if(r.tag===3)d1(r,r,u);else for(;o!==null;){if(o.tag===3){d1(o,r,u);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(js===null||!js.has(f))){r=$i(u,r),u=pS(2),f=Rs(o,u,2),f!==null&&(gS(u,f,o,r),Jo(f,2),Cn(f));break}}o=o.return}}function jg(r,o,u){var f=r.pingCache;if(f===null){f=r.pingCache=new ED;var g=new Set;f.set(o,g)}else g=f.get(o),g===void 0&&(g=new Set,f.set(o,g));g.has(u)||(Eg=!0,g.add(u),r=LD.bind(null,r,o,u),o.then(r,r))}function LD(r,o,u){var f=r.pingCache;f!==null&&f.delete(o),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,Fe===r&&(Le&u)===u&&(at===4||at===3&&(Le&62914560)===Le&&300>vi()-th?(qe&2)===0&&zl(r,0):Dg|=u,Ul===Le&&(Ul=0)),Cn(r)}function p1(r,o){o===0&&(o=av()),r=br(r,o),r!==null&&(Jo(r,o),Cn(r))}function BD(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),p1(r,u)}function UD(r,o){var u=0;switch(r.tag){case 31:case 13:var f=r.stateNode,g=r.memoizedState;g!==null&&(u=g.retryLane);break;case 19:f=r.stateNode;break;case 22:f=r.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(o),p1(r,u)}function jD(r,o){return Xd(r,o)}var ah=null,Pl=null,zg=!1,ch=!1,Ig=!1,Ps=0;function Cn(r){r!==Pl&&r.next===null&&(Pl===null?ah=Pl=r:Pl=Pl.next=r),ch=!0,zg||(zg=!0,ID())}function Ma(r,o){if(!Ig&&ch){Ig=!0;do for(var u=!1,f=ah;f!==null;){if(r!==0){var g=f.pendingLanes;if(g===0)var y=0;else{var S=f.suspendedLanes,x=f.pingedLanes;y=(1<<31-Si(42|r)+1)-1,y&=g&~(S&~x),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(u=!0,b1(f,y))}else y=Le,y=du(f,f===Fe?y:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(y&3)===0||Qo(f,y)||(u=!0,b1(f,y));f=f.next}while(u);Ig=!1}}function zD(){g1()}function g1(){ch=zg=!1;var r=0;Ps!==0&&FD()&&(r=Ps);for(var o=vi(),u=null,f=ah;f!==null;){var g=f.next,y=m1(f,o);y===0?(f.next=null,u===null?ah=g:u.next=g,g===null&&(Pl=u)):(u=f,(r!==0||(y&3)!==0)&&(ch=!0)),f=g}_t!==0&&_t!==5||Ma(r),Ps!==0&&(Ps=0)}function m1(r,o){for(var u=r.suspendedLanes,f=r.pingedLanes,g=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var S=31-Si(y),x=1<<S,A=g[S];A===-1?((x&u)===0||(x&f)!==0)&&(g[S]=h2(x,o)):A<=o&&(r.expiredLanes|=x),y&=~x}if(o=Fe,u=Le,u=du(r,r===o?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f=r.callbackNode,u===0||r===o&&(Ve===2||Ve===9)||r.cancelPendingCommit!==null)return f!==null&&f!==null&&Qd(f),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||Qo(r,u)){if(o=u&-u,o===r.callbackPriority)return o;switch(f!==null&&Qd(f),ep(u)){case 2:case 8:u=lv;break;case 32:u=cu;break;case 268435456:u=ov;break;default:u=cu}return f=y1.bind(null,r),u=Xd(u,f),r.callbackPriority=o,r.callbackNode=u,o}return f!==null&&f!==null&&Qd(f),r.callbackPriority=2,r.callbackNode=null,2}function y1(r,o){if(_t!==0&&_t!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(oh()&&r.callbackNode!==u)return null;var f=Le;return f=du(r,r===Fe?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),f===0?null:(JS(r,f,o),m1(r,vi()),r.callbackNode!=null&&r.callbackNode===u?y1.bind(null,r):null)}function b1(r,o){if(oh())return null;JS(r,o,!0)}function ID(){QD(function(){(qe&6)!==0?Xd(rv,zD):g1()})}function Pg(){if(Ps===0){var r=Ol;r===0&&(r=uu,uu<<=1,(uu&261888)===0&&(uu=256)),Ps=r}return Ps}function v1(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:yu(""+r)}function w1(r,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,r.id&&u.setAttribute("form",r.id),o.parentNode.insertBefore(u,o),r=new FormData(r),u.parentNode.removeChild(u),r}function PD(r,o,u,f,g){if(o==="submit"&&u&&u.stateNode===g){var y=v1((g[si]||null).action),S=f.submitter;S&&(o=(o=S[si]||null)?v1(o.formAction):S.getAttribute("formAction"),o!==null&&(y=o,S=null));var x=new Su("action","action",null,f,g);r.push({event:x,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ps!==0){var A=S?w1(g,S):new FormData(g);lg(u,{pending:!0,data:A,method:g.method,action:y},null,A)}}else typeof y=="function"&&(x.preventDefault(),A=S?w1(g,S):new FormData(g),lg(u,{pending:!0,data:A,method:g.method,action:y},y,A))},currentTarget:g}]})}}for(var Hg=0;Hg<xp.length;Hg++){var qg=xp[Hg],HD=qg.toLowerCase(),qD=qg[0].toUpperCase()+qg.slice(1);on(HD,"on"+qD)}on(Qv,"onAnimationEnd"),on(Jv,"onAnimationIteration"),on(Zv,"onAnimationStart"),on("dblclick","onDoubleClick"),on("focusin","onFocus"),on("focusout","onBlur"),on(sD,"onTransitionRun"),on(rD,"onTransitionStart"),on(lD,"onTransitionCancel"),on(ew,"onTransitionEnd"),hl("onMouseEnter",["mouseout","mouseover"]),hl("onMouseLeave",["mouseout","mouseover"]),hl("onPointerEnter",["pointerout","pointerover"]),hl("onPointerLeave",["pointerout","pointerover"]),pr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),pr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),pr("onBeforeInput",["compositionend","keypress","textInput","paste"]),pr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),pr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),pr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Na="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Na));function S1(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var f=r[u],g=f.event;f=f.listeners;e:{var y=void 0;if(o)for(var S=f.length-1;0<=S;S--){var x=f[S],A=x.instance,B=x.currentTarget;if(x=x.listener,A!==y&&g.isPropagationStopped())break e;y=x,g.currentTarget=B;try{y(g)}catch(P){_u(P)}g.currentTarget=null,y=A}else for(S=0;S<f.length;S++){if(x=f[S],A=x.instance,B=x.currentTarget,x=x.listener,A!==y&&g.isPropagationStopped())break e;y=x,g.currentTarget=B;try{y(g)}catch(P){_u(P)}g.currentTarget=null,y=A}}}}function Ne(r,o){var u=o[tp];u===void 0&&(u=o[tp]=new Set);var f=r+"__bubble";u.has(f)||(k1(o,r,2,!1),u.add(f))}function Vg(r,o,u){var f=0;o&&(f|=4),k1(u,r,f,o)}var uh="_reactListening"+Math.random().toString(36).slice(2);function $g(r){if(!r[uh]){r[uh]=!0,gv.forEach(function(u){u!=="selectionchange"&&(VD.has(u)||Vg(u,!1,r),Vg(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[uh]||(o[uh]=!0,Vg("selectionchange",!1,o))}}function k1(r,o,u,f){switch(Q1(o)){case 2:var g=yR;break;case 8:g=bR;break;default:g=rm}u=g.bind(null,o,u,r),g=void 0,!up||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),f?g!==void 0?r.addEventListener(o,u,{capture:!0,passive:g}):r.addEventListener(o,u,!0):g!==void 0?r.addEventListener(o,u,{passive:g}):r.addEventListener(o,u,!1)}function Gg(r,o,u,f,g){var y=f;if((o&1)===0&&(o&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var x=f.stateNode.containerInfo;if(x===g)break;if(S===4)for(S=f.return;S!==null;){var A=S.tag;if((A===3||A===4)&&S.stateNode.containerInfo===g)return;S=S.return}for(;x!==null;){if(S=al(x),S===null)return;if(A=S.tag,A===5||A===6||A===26||A===27){f=y=S;continue e}x=x.parentNode}}f=f.return}Cv(function(){var B=y,P=ap(u),G=[];e:{var U=tw.get(r);if(U!==void 0){var I=Su,le=r;switch(r){case"keypress":if(vu(u)===0)break e;case"keydown":case"keyup":I=U2;break;case"focusin":le="focus",I=pp;break;case"focusout":le="blur",I=pp;break;case"beforeblur":case"afterblur":I=pp;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=Dv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=_2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=I2;break;case Qv:case Jv:case Zv:I=C2;break;case ew:I=H2;break;case"scroll":case"scrollend":I=k2;break;case"wheel":I=V2;break;case"copy":case"cut":case"paste":I=E2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=Mv;break;case"toggle":case"beforetoggle":I=G2}var de=(o&4)!==0,We=!de&&(r==="scroll"||r==="scrollend"),M=de?U!==null?U+"Capture":null:U;de=[];for(var E=B,L;E!==null;){var V=E;if(L=V.stateNode,V=V.tag,V!==5&&V!==26&&V!==27||L===null||M===null||(V=ta(E,M),V!=null&&de.push(La(E,V,L))),We)break;E=E.return}0<de.length&&(U=new I(U,le,null,u,P),G.push({event:U,listeners:de}))}}if((o&7)===0){e:{if(U=r==="mouseover"||r==="pointerover",I=r==="mouseout"||r==="pointerout",U&&u!==op&&(le=u.relatedTarget||u.fromElement)&&(al(le)||le[ol]))break e;if((I||U)&&(U=P.window===P?P:(U=P.ownerDocument)?U.defaultView||U.parentWindow:window,I?(le=u.relatedTarget||u.toElement,I=B,le=le?al(le):null,le!==null&&(We=l(le),de=le.tag,le!==We||de!==5&&de!==27&&de!==6)&&(le=null)):(I=null,le=B),I!==le)){if(de=Dv,V="onMouseLeave",M="onMouseEnter",E="mouse",(r==="pointerout"||r==="pointerover")&&(de=Mv,V="onPointerLeave",M="onPointerEnter",E="pointer"),We=I==null?U:ea(I),L=le==null?U:ea(le),U=new de(V,E+"leave",I,u,P),U.target=We,U.relatedTarget=L,V=null,al(P)===B&&(de=new de(M,E+"enter",le,u,P),de.target=L,de.relatedTarget=We,V=de),We=V,I&&le)t:{for(de=$D,M=I,E=le,L=0,V=M;V;V=de(V))L++;V=0;for(var he=E;he;he=de(he))V++;for(;0<L-V;)M=de(M),L--;for(;0<V-L;)E=de(E),V--;for(;L--;){if(M===E||E!==null&&M===E.alternate){de=M;break t}M=de(M),E=de(E)}de=null}else de=null;I!==null&&x1(G,U,I,de,!1),le!==null&&We!==null&&x1(G,We,le,de,!0)}}e:{if(U=B?ea(B):window,I=U.nodeName&&U.nodeName.toLowerCase(),I==="select"||I==="input"&&U.type==="file")var Ie=Pv;else if(zv(U))if(Hv)Ie=tD;else{Ie=Z2;var oe=J2}else I=U.nodeName,!I||I.toLowerCase()!=="input"||U.type!=="checkbox"&&U.type!=="radio"?B&&lp(B.elementType)&&(Ie=Pv):Ie=eD;if(Ie&&(Ie=Ie(r,B))){Iv(G,Ie,u,P);break e}oe&&oe(r,U,B),r==="focusout"&&B&&U.type==="number"&&B.memoizedProps.value!=null&&rp(U,"number",U.value)}switch(oe=B?ea(B):window,r){case"focusin":(zv(oe)||oe.contentEditable==="true")&&(yl=oe,wp=B,ca=null);break;case"focusout":ca=wp=yl=null;break;case"mousedown":Sp=!0;break;case"contextmenu":case"mouseup":case"dragend":Sp=!1,Fv(G,u,P);break;case"selectionchange":if(nD)break;case"keydown":case"keyup":Fv(G,u,P)}var Oe;if(mp)e:{switch(r){case"compositionstart":var Be="onCompositionStart";break e;case"compositionend":Be="onCompositionEnd";break e;case"compositionupdate":Be="onCompositionUpdate";break e}Be=void 0}else ml?Uv(r,u)&&(Be="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Be="onCompositionStart");Be&&(Nv&&u.locale!=="ko"&&(ml||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&ml&&(Oe=Tv()):(_s=P,hp="value"in _s?_s.value:_s.textContent,ml=!0)),oe=hh(B,Be),0<oe.length&&(Be=new Rv(Be,r,null,u,P),G.push({event:Be,listeners:oe}),Oe?Be.data=Oe:(Oe=jv(u),Oe!==null&&(Be.data=Oe)))),(Oe=W2?Y2(r,u):F2(r,u))&&(Be=hh(B,"onBeforeInput"),0<Be.length&&(oe=new Rv("onBeforeInput","beforeinput",null,u,P),G.push({event:oe,listeners:Be}),oe.data=Oe)),PD(G,r,B,u,P)}S1(G,o)})}function La(r,o,u){return{instance:r,listener:o,currentTarget:u}}function hh(r,o){for(var u=o+"Capture",f=[];r!==null;){var g=r,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=ta(r,u),g!=null&&f.unshift(La(r,g,y)),g=ta(r,o),g!=null&&f.push(La(r,g,y))),r.tag===3)return f;r=r.return}return[]}function $D(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function x1(r,o,u,f,g){for(var y=o._reactName,S=[];u!==null&&u!==f;){var x=u,A=x.alternate,B=x.stateNode;if(x=x.tag,A!==null&&A===f)break;x!==5&&x!==26&&x!==27||B===null||(A=B,g?(B=ta(u,y),B!=null&&S.unshift(La(u,B,A))):g||(B=ta(u,y),B!=null&&S.push(La(u,B,A)))),u=u.return}S.length!==0&&r.push({event:o,listeners:S})}var GD=/\r\n?/g,KD=/\u0000|\uFFFD/g;function _1(r){return(typeof r=="string"?r:""+r).replace(GD,`
`).replace(KD,"")}function O1(r,o){return o=_1(o),_1(r)===o}function Ke(r,o,u,f,g,y){switch(u){case"children":typeof f=="string"?o==="body"||o==="textarea"&&f===""||dl(r,f):(typeof f=="number"||typeof f=="bigint")&&o!=="body"&&dl(r,""+f);break;case"className":gu(r,"class",f);break;case"tabIndex":gu(r,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":gu(r,u,f);break;case"style":Ov(r,f,y);break;case"data":if(o!=="object"){gu(r,"data",f);break}case"src":case"href":if(f===""&&(o!=="a"||u!=="href")){r.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=yu(""+f),r.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(u==="formAction"?(o!=="input"&&Ke(r,o,"name",g.name,g,null),Ke(r,o,"formEncType",g.formEncType,g,null),Ke(r,o,"formMethod",g.formMethod,g,null),Ke(r,o,"formTarget",g.formTarget,g,null)):(Ke(r,o,"encType",g.encType,g,null),Ke(r,o,"method",g.method,g,null),Ke(r,o,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){r.removeAttribute(u);break}f=yu(""+f),r.setAttribute(u,f);break;case"onClick":f!=null&&(r.onclick=Yn);break;case"onScroll":f!=null&&Ne("scroll",r);break;case"onScrollEnd":f!=null&&Ne("scrollend",r);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(g.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":r.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){r.removeAttribute("xlink:href");break}u=yu(""+f),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""+f):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":f===!0?r.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?r.setAttribute(u,f):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?r.setAttribute(u,f):r.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?r.removeAttribute(u):r.setAttribute(u,f);break;case"popover":Ne("beforetoggle",r),Ne("toggle",r),pu(r,"popover",f);break;case"xlinkActuate":Wn(r,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Wn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Wn(r,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Wn(r,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Wn(r,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Wn(r,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Wn(r,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Wn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Wn(r,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":pu(r,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=w2.get(u)||u,pu(r,u,f))}}function Kg(r,o,u,f,g,y){switch(u){case"style":Ov(r,f,y);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(u=f.__html,u!=null){if(g.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof f=="string"?dl(r,f):(typeof f=="number"||typeof f=="bigint")&&dl(r,""+f);break;case"onScroll":f!=null&&Ne("scroll",r);break;case"onScrollEnd":f!=null&&Ne("scrollend",r);break;case"onClick":f!=null&&(r.onclick=Yn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!mv.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(g=u.endsWith("Capture"),o=u.slice(2,g?u.length-7:void 0),y=r[si]||null,y=y!=null?y[u]:null,typeof y=="function"&&r.removeEventListener(o,y,g),typeof f=="function")){typeof y!="function"&&y!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(o,f,g);break e}u in r?r[u]=f:f===!0?r.setAttribute(u,""):pu(r,u,f)}}}function Pt(r,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ne("error",r),Ne("load",r);var f=!1,g=!1,y;for(y in u)if(u.hasOwnProperty(y)){var S=u[y];if(S!=null)switch(y){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Ke(r,o,y,S,u,null)}}g&&Ke(r,o,"srcSet",u.srcSet,u,null),f&&Ke(r,o,"src",u.src,u,null);return;case"input":Ne("invalid",r);var x=y=S=g=null,A=null,B=null;for(f in u)if(u.hasOwnProperty(f)){var P=u[f];if(P!=null)switch(f){case"name":g=P;break;case"type":S=P;break;case"checked":A=P;break;case"defaultChecked":B=P;break;case"value":y=P;break;case"defaultValue":x=P;break;case"children":case"dangerouslySetInnerHTML":if(P!=null)throw Error(n(137,o));break;default:Ke(r,o,f,P,u,null)}}Sv(r,y,x,A,B,S,g,!1);return;case"select":Ne("invalid",r),f=S=y=null;for(g in u)if(u.hasOwnProperty(g)&&(x=u[g],x!=null))switch(g){case"value":y=x;break;case"defaultValue":S=x;break;case"multiple":f=x;default:Ke(r,o,g,x,u,null)}o=y,u=S,r.multiple=!!f,o!=null?fl(r,!!f,o,!1):u!=null&&fl(r,!!f,u,!0);return;case"textarea":Ne("invalid",r),y=g=f=null;for(S in u)if(u.hasOwnProperty(S)&&(x=u[S],x!=null))switch(S){case"value":f=x;break;case"defaultValue":g=x;break;case"children":y=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(n(91));break;default:Ke(r,o,S,x,u,null)}xv(r,f,g,y);return;case"option":for(A in u)u.hasOwnProperty(A)&&(f=u[A],f!=null)&&(A==="selected"?r.selected=f&&typeof f!="function"&&typeof f!="symbol":Ke(r,o,A,f,u,null));return;case"dialog":Ne("beforetoggle",r),Ne("toggle",r),Ne("cancel",r),Ne("close",r);break;case"iframe":case"object":Ne("load",r);break;case"video":case"audio":for(f=0;f<Na.length;f++)Ne(Na[f],r);break;case"image":Ne("error",r),Ne("load",r);break;case"details":Ne("toggle",r);break;case"embed":case"source":case"link":Ne("error",r),Ne("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(B in u)if(u.hasOwnProperty(B)&&(f=u[B],f!=null))switch(B){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Ke(r,o,B,f,u,null)}return;default:if(lp(o)){for(P in u)u.hasOwnProperty(P)&&(f=u[P],f!==void 0&&Kg(r,o,P,f,u,void 0));return}}for(x in u)u.hasOwnProperty(x)&&(f=u[x],f!=null&&Ke(r,o,x,f,u,null))}function WD(r,o,u,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,S=null,x=null,A=null,B=null,P=null;for(I in u){var G=u[I];if(u.hasOwnProperty(I)&&G!=null)switch(I){case"checked":break;case"value":break;case"defaultValue":A=G;default:f.hasOwnProperty(I)||Ke(r,o,I,null,f,G)}}for(var U in f){var I=f[U];if(G=u[U],f.hasOwnProperty(U)&&(I!=null||G!=null))switch(U){case"type":y=I;break;case"name":g=I;break;case"checked":B=I;break;case"defaultChecked":P=I;break;case"value":S=I;break;case"defaultValue":x=I;break;case"children":case"dangerouslySetInnerHTML":if(I!=null)throw Error(n(137,o));break;default:I!==G&&Ke(r,o,U,I,f,G)}}sp(r,S,x,A,B,P,y,g);return;case"select":I=S=x=U=null;for(y in u)if(A=u[y],u.hasOwnProperty(y)&&A!=null)switch(y){case"value":break;case"multiple":I=A;default:f.hasOwnProperty(y)||Ke(r,o,y,null,f,A)}for(g in f)if(y=f[g],A=u[g],f.hasOwnProperty(g)&&(y!=null||A!=null))switch(g){case"value":U=y;break;case"defaultValue":x=y;break;case"multiple":S=y;default:y!==A&&Ke(r,o,g,y,f,A)}o=x,u=S,f=I,U!=null?fl(r,!!u,U,!1):!!f!=!!u&&(o!=null?fl(r,!!u,o,!0):fl(r,!!u,u?[]:"",!1));return;case"textarea":I=U=null;for(x in u)if(g=u[x],u.hasOwnProperty(x)&&g!=null&&!f.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:Ke(r,o,x,null,f,g)}for(S in f)if(g=f[S],y=u[S],f.hasOwnProperty(S)&&(g!=null||y!=null))switch(S){case"value":U=g;break;case"defaultValue":I=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==y&&Ke(r,o,S,g,f,y)}kv(r,U,I);return;case"option":for(var le in u)U=u[le],u.hasOwnProperty(le)&&U!=null&&!f.hasOwnProperty(le)&&(le==="selected"?r.selected=!1:Ke(r,o,le,null,f,U));for(A in f)U=f[A],I=u[A],f.hasOwnProperty(A)&&U!==I&&(U!=null||I!=null)&&(A==="selected"?r.selected=U&&typeof U!="function"&&typeof U!="symbol":Ke(r,o,A,U,f,I));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var de in u)U=u[de],u.hasOwnProperty(de)&&U!=null&&!f.hasOwnProperty(de)&&Ke(r,o,de,null,f,U);for(B in f)if(U=f[B],I=u[B],f.hasOwnProperty(B)&&U!==I&&(U!=null||I!=null))switch(B){case"children":case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(137,o));break;default:Ke(r,o,B,U,f,I)}return;default:if(lp(o)){for(var We in u)U=u[We],u.hasOwnProperty(We)&&U!==void 0&&!f.hasOwnProperty(We)&&Kg(r,o,We,void 0,f,U);for(P in f)U=f[P],I=u[P],!f.hasOwnProperty(P)||U===I||U===void 0&&I===void 0||Kg(r,o,P,U,f,I);return}}for(var M in u)U=u[M],u.hasOwnProperty(M)&&U!=null&&!f.hasOwnProperty(M)&&Ke(r,o,M,null,f,U);for(G in f)U=f[G],I=u[G],!f.hasOwnProperty(G)||U===I||U==null&&I==null||Ke(r,o,G,U,f,I)}function A1(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function YD(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var g=u[f],y=g.transferSize,S=g.initiatorType,x=g.duration;if(y&&x&&A1(S)){for(S=0,x=g.responseEnd,f+=1;f<u.length;f++){var A=u[f],B=A.startTime;if(B>x)break;var P=A.transferSize,G=A.initiatorType;P&&A1(G)&&(A=A.responseEnd,S+=P*(A<x?1:(x-B)/(A-B)))}if(--f,o+=8*(y+S)/(g.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Wg=null,Yg=null;function fh(r){return r.nodeType===9?r:r.ownerDocument}function C1(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function T1(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function Fg(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Xg=null;function FD(){var r=window.event;return r&&r.type==="popstate"?r===Xg?!1:(Xg=r,!0):(Xg=null,!1)}var E1=typeof setTimeout=="function"?setTimeout:void 0,XD=typeof clearTimeout=="function"?clearTimeout:void 0,D1=typeof Promise=="function"?Promise:void 0,QD=typeof queueMicrotask=="function"?queueMicrotask:typeof D1<"u"?function(r){return D1.resolve(null).then(r).catch(JD)}:E1;function JD(r){setTimeout(function(){throw r})}function Hs(r){return r==="head"}function R1(r,o){var u=o,f=0;do{var g=u.nextSibling;if(r.removeChild(u),g&&g.nodeType===8)if(u=g.data,u==="/$"||u==="/&"){if(f===0){r.removeChild(g),$l(o);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")Ba(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,Ba(u);for(var y=u.firstChild;y;){var S=y.nextSibling,x=y.nodeName;y[Zo]||x==="SCRIPT"||x==="STYLE"||x==="LINK"&&y.rel.toLowerCase()==="stylesheet"||u.removeChild(y),y=S}}else u==="body"&&Ba(r.ownerDocument.body);u=g}while(u);$l(o)}function M1(r,o){var u=r;r=0;do{var f=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=f}while(u)}function Qg(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Qg(u),ip(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function ZD(r,o,u,f){for(;r.nodeType===1;){var g=u;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!f&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(f){if(!r[Zo])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=Fi(r.nextSibling),r===null)break}return null}function eR(r,o,u){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Fi(r.nextSibling),r===null))return null;return r}function N1(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Fi(r.nextSibling),r===null))return null;return r}function Jg(r){return r.data==="$?"||r.data==="$~"}function Zg(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function tR(r,o){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||u.readyState!=="loading")o();else{var f=function(){o(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),r._reactRetry=f}}function Fi(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var em=null;function L1(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(o===0)return Fi(r.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}r=r.nextSibling}return null}function B1(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return r;o--}else u!=="/$"&&u!=="/&"||o++}r=r.previousSibling}return null}function U1(r,o,u){switch(o=fh(u),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Ba(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);ip(r)}var Xi=new Map,j1=new Set;function dh(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var us=Y.d;Y.d={f:iR,r:nR,D:sR,C:rR,L:lR,m:oR,X:cR,S:aR,M:uR};function iR(){var r=us.f(),o=sh();return r||o}function nR(r){var o=cl(r);o!==null&&o.tag===5&&o.type==="form"?eS(o):us.r(r)}var Hl=typeof document>"u"?null:document;function z1(r,o,u){var f=Hl;if(f&&typeof o=="string"&&o){var g=qi(o);g='link[rel="'+r+'"][href="'+g+'"]',typeof u=="string"&&(g+='[crossorigin="'+u+'"]'),j1.has(g)||(j1.add(g),r={rel:r,crossOrigin:u,href:o},f.querySelector(g)===null&&(o=f.createElement("link"),Pt(o,"link",r),Dt(o),f.head.appendChild(o)))}}function sR(r){us.D(r),z1("dns-prefetch",r,null)}function rR(r,o){us.C(r,o),z1("preconnect",r,o)}function lR(r,o,u){us.L(r,o,u);var f=Hl;if(f&&r&&o){var g='link[rel="preload"][as="'+qi(o)+'"]';o==="image"&&u&&u.imageSrcSet?(g+='[imagesrcset="'+qi(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(g+='[imagesizes="'+qi(u.imageSizes)+'"]')):g+='[href="'+qi(r)+'"]';var y=g;switch(o){case"style":y=ql(r);break;case"script":y=Vl(r)}Xi.has(y)||(r=m({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:r,as:o},u),Xi.set(y,r),f.querySelector(g)!==null||o==="style"&&f.querySelector(Ua(y))||o==="script"&&f.querySelector(ja(y))||(o=f.createElement("link"),Pt(o,"link",r),Dt(o),f.head.appendChild(o)))}}function oR(r,o){us.m(r,o);var u=Hl;if(u&&r){var f=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+qi(f)+'"][href="'+qi(r)+'"]',y=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Vl(r)}if(!Xi.has(y)&&(r=m({rel:"modulepreload",href:r},o),Xi.set(y,r),u.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(ja(y)))return}f=u.createElement("link"),Pt(f,"link",r),Dt(f),u.head.appendChild(f)}}}function aR(r,o,u){us.S(r,o,u);var f=Hl;if(f&&r){var g=ul(f).hoistableStyles,y=ql(r);o=o||"default";var S=g.get(y);if(!S){var x={loading:0,preload:null};if(S=f.querySelector(Ua(y)))x.loading=5;else{r=m({rel:"stylesheet",href:r,"data-precedence":o},u),(u=Xi.get(y))&&tm(r,u);var A=S=f.createElement("link");Dt(A),Pt(A,"link",r),A._p=new Promise(function(B,P){A.onload=B,A.onerror=P}),A.addEventListener("load",function(){x.loading|=1}),A.addEventListener("error",function(){x.loading|=2}),x.loading|=4,ph(S,o,f)}S={type:"stylesheet",instance:S,count:1,state:x},g.set(y,S)}}}function cR(r,o){us.X(r,o);var u=Hl;if(u&&r){var f=ul(u).hoistableScripts,g=Vl(r),y=f.get(g);y||(y=u.querySelector(ja(g)),y||(r=m({src:r,async:!0},o),(o=Xi.get(g))&&im(r,o),y=u.createElement("script"),Dt(y),Pt(y,"link",r),u.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(g,y))}}function uR(r,o){us.M(r,o);var u=Hl;if(u&&r){var f=ul(u).hoistableScripts,g=Vl(r),y=f.get(g);y||(y=u.querySelector(ja(g)),y||(r=m({src:r,async:!0,type:"module"},o),(o=Xi.get(g))&&im(r,o),y=u.createElement("script"),Dt(y),Pt(y,"link",r),u.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(g,y))}}function I1(r,o,u,f){var g=(g=we.current)?dh(g):null;if(!g)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=ql(u.href),u=ul(g).hoistableStyles,f=u.get(o),f||(f={type:"style",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=ql(u.href);var y=ul(g).hoistableStyles,S=y.get(r);if(S||(g=g.ownerDocument||g,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,S),(y=g.querySelector(Ua(r)))&&!y._p&&(S.instance=y,S.state.loading=5),Xi.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Xi.set(r,u),y||hR(g,r,u,S.state))),o&&f===null)throw Error(n(528,""));return S}if(o&&f!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Vl(u),u=ul(g).hoistableScripts,f=u.get(o),f||(f={type:"script",instance:null,count:0,state:null},u.set(o,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function ql(r){return'href="'+qi(r)+'"'}function Ua(r){return'link[rel="stylesheet"]['+r+"]"}function P1(r){return m({},r,{"data-precedence":r.precedence,precedence:null})}function hR(r,o,u,f){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?f.loading=1:(o=r.createElement("link"),f.preload=o,o.addEventListener("load",function(){return f.loading|=1}),o.addEventListener("error",function(){return f.loading|=2}),Pt(o,"link",u),Dt(o),r.head.appendChild(o))}function Vl(r){return'[src="'+qi(r)+'"]'}function ja(r){return"script[async]"+r}function H1(r,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var f=r.querySelector('style[data-href~="'+qi(u.href)+'"]');if(f)return o.instance=f,Dt(f),f;var g=m({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(r.ownerDocument||r).createElement("style"),Dt(f),Pt(f,"style",g),ph(f,u.precedence,r),o.instance=f;case"stylesheet":g=ql(u.href);var y=r.querySelector(Ua(g));if(y)return o.state.loading|=4,o.instance=y,Dt(y),y;f=P1(u),(g=Xi.get(g))&&tm(f,g),y=(r.ownerDocument||r).createElement("link"),Dt(y);var S=y;return S._p=new Promise(function(x,A){S.onload=x,S.onerror=A}),Pt(y,"link",f),o.state.loading|=4,ph(y,u.precedence,r),o.instance=y;case"script":return y=Vl(u.src),(g=r.querySelector(ja(y)))?(o.instance=g,Dt(g),g):(f=u,(g=Xi.get(y))&&(f=m({},u),im(f,g)),r=r.ownerDocument||r,g=r.createElement("script"),Dt(g),Pt(g,"link",f),r.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(f=o.instance,o.state.loading|=4,ph(f,u.precedence,r));return o.instance}function ph(r,o,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,y=g,S=0;S<f.length;S++){var x=f[S];if(x.dataset.precedence===o)y=x;else if(y!==g)break}y?y.parentNode.insertBefore(r,y.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(r,o.firstChild))}function tm(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function im(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var gh=null;function q1(r,o,u){if(gh===null){var f=new Map,g=gh=new Map;g.set(u,f)}else g=gh,f=g.get(u),f||(f=new Map,g.set(u,f));if(f.has(r))return f;for(f.set(r,null),u=u.getElementsByTagName(r),g=0;g<u.length;g++){var y=u[g];if(!(y[Zo]||y[Ut]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var S=y.getAttribute(o)||"";S=r+S;var x=f.get(S);x?x.push(y):f.set(S,[y])}}return f}function V1(r,o,u){r=r.ownerDocument||r,r.head.insertBefore(u,o==="title"?r.querySelector("head > title"):null)}function fR(r,o,u){if(u===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(r=o.disabled,typeof o.precedence=="string"&&r==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function $1(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function dR(r,o,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var g=ql(f.href),y=o.querySelector(Ua(g));if(y){o=y._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=mh.bind(r),o.then(r,r)),u.state.loading|=4,u.instance=y,Dt(y);return}y=o.ownerDocument||o,f=P1(f),(g=Xi.get(g))&&tm(f,g),y=y.createElement("link"),Dt(y);var S=y;S._p=new Promise(function(x,A){S.onload=x,S.onerror=A}),Pt(y,"link",f),u.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=mh.bind(r),o.addEventListener("load",u),o.addEventListener("error",u))}}var nm=0;function pR(r,o){return r.stylesheets&&r.count===0&&bh(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var f=setTimeout(function(){if(r.stylesheets&&bh(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+o);0<r.imgBytes&&nm===0&&(nm=62500*YD());var g=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&bh(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>nm?50:800)+o);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(f),clearTimeout(g)}}:null}function mh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bh(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var yh=null;function bh(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,yh=new Map,o.forEach(gR,r),yh=null,mh.call(r))}function gR(r,o){if(!(o.state.loading&4)){var u=yh.get(r);if(u)var f=u.get(null);else{u=new Map,yh.set(r,u);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var S=g[y];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(u.set(S.dataset.precedence,S),f=S)}f&&u.set(null,f)}g=o.instance,S=g.getAttribute("data-precedence"),y=u.get(S)||f,y===f&&u.set(null,g),u.set(S,g),this.count++,f=mh.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),y?y.parentNode.insertBefore(g,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),o.state.loading|=4}}var za={$$typeof:C,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function mR(r,o,u,f,g,y,S,x,A){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Jd(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jd(0),this.hiddenUpdates=Jd(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=A,this.incompleteTransitions=new Map}function G1(r,o,u,f,g,y,S,x,A,B,P,G){return r=new mR(r,o,u,S,A,B,P,G,x),o=1,y===!0&&(o|=24),y=xi(3,null,null,o),r.current=y,y.stateNode=r,o=Up(),o.refCount++,r.pooledCache=o,o.refCount++,y.memoizedState={element:f,isDehydrated:u,cache:o},Pp(y),r}function K1(r){return r?(r=wl,r):wl}function W1(r,o,u,f,g,y){g=K1(g),f.context===null?f.context=g:f.pendingContext=g,f=Ds(o),f.payload={element:u},y=y===void 0?null:y,y!==null&&(f.callback=y),u=Rs(r,f,o),u!==null&&(ui(u,r,o),ma(u,r,o))}function Y1(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function sm(r,o){Y1(r,o),(r=r.alternate)&&Y1(r,o)}function F1(r){if(r.tag===13||r.tag===31){var o=br(r,67108864);o!==null&&ui(o,r,67108864),sm(r,67108864)}}function X1(r){if(r.tag===13||r.tag===31){var o=Ti();o=Zd(o);var u=br(r,o);u!==null&&ui(u,r,o),sm(r,o)}}var vh=!0;function yR(r,o,u,f){var g=z.T;z.T=null;var y=Y.p;try{Y.p=2,rm(r,o,u,f)}finally{Y.p=y,z.T=g}}function bR(r,o,u,f){var g=z.T;z.T=null;var y=Y.p;try{Y.p=8,rm(r,o,u,f)}finally{Y.p=y,z.T=g}}function rm(r,o,u,f){if(vh){var g=lm(f);if(g===null)Gg(r,o,f,wh,u),J1(r,f);else if(wR(g,r,o,u,f))f.stopPropagation();else if(J1(r,f),o&4&&-1<vR.indexOf(r)){for(;g!==null;){var y=cl(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var S=dr(y.pendingLanes);if(S!==0){var x=y;for(x.pendingLanes|=2,x.entangledLanes|=2;S;){var A=1<<31-Si(S);x.entanglements[1]|=A,S&=~A}Cn(y),(qe&6)===0&&(ih=vi()+500,Ma(0))}}break;case 31:case 13:x=br(y,2),x!==null&&ui(x,y,2),sh(),sm(y,2)}if(y=lm(f),y===null&&Gg(r,o,f,wh,u),y===g)break;g=y}g!==null&&f.stopPropagation()}else Gg(r,o,f,null,u)}}function lm(r){return r=ap(r),om(r)}var wh=null;function om(r){if(wh=null,r=al(r),r!==null){var o=l(r);if(o===null)r=null;else{var u=o.tag;if(u===13){if(r=a(o),r!==null)return r;r=null}else if(u===31){if(r=c(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return wh=r,null}function Q1(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(s2()){case rv:return 2;case lv:return 8;case cu:case r2:return 32;case ov:return 268435456;default:return 32}default:return 32}}var am=!1,qs=null,Vs=null,$s=null,Ia=new Map,Pa=new Map,Gs=[],vR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function J1(r,o){switch(r){case"focusin":case"focusout":qs=null;break;case"dragenter":case"dragleave":Vs=null;break;case"mouseover":case"mouseout":$s=null;break;case"pointerover":case"pointerout":Ia.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pa.delete(o.pointerId)}}function Ha(r,o,u,f,g,y){return r===null||r.nativeEvent!==y?(r={blockedOn:o,domEventName:u,eventSystemFlags:f,nativeEvent:y,targetContainers:[g]},o!==null&&(o=cl(o),o!==null&&F1(o)),r):(r.eventSystemFlags|=f,o=r.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),r)}function wR(r,o,u,f,g){switch(o){case"focusin":return qs=Ha(qs,r,o,u,f,g),!0;case"dragenter":return Vs=Ha(Vs,r,o,u,f,g),!0;case"mouseover":return $s=Ha($s,r,o,u,f,g),!0;case"pointerover":var y=g.pointerId;return Ia.set(y,Ha(Ia.get(y)||null,r,o,u,f,g)),!0;case"gotpointercapture":return y=g.pointerId,Pa.set(y,Ha(Pa.get(y)||null,r,o,u,f,g)),!0}return!1}function Z1(r){var o=al(r.target);if(o!==null){var u=l(o);if(u!==null){if(o=u.tag,o===13){if(o=a(u),o!==null){r.blockedOn=o,dv(r.priority,function(){X1(u)});return}}else if(o===31){if(o=c(u),o!==null){r.blockedOn=o,dv(r.priority,function(){X1(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Sh(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=lm(r.nativeEvent);if(u===null){u=r.nativeEvent;var f=new u.constructor(u.type,u);op=f,u.target.dispatchEvent(f),op=null}else return o=cl(u),o!==null&&F1(o),r.blockedOn=u,!1;o.shift()}return!0}function ek(r,o,u){Sh(r)&&u.delete(o)}function SR(){am=!1,qs!==null&&Sh(qs)&&(qs=null),Vs!==null&&Sh(Vs)&&(Vs=null),$s!==null&&Sh($s)&&($s=null),Ia.forEach(ek),Pa.forEach(ek)}function kh(r,o){r.blockedOn===o&&(r.blockedOn=null,am||(am=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,SR)))}var xh=null;function tk(r){xh!==r&&(xh=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){xh===r&&(xh=null);for(var o=0;o<r.length;o+=3){var u=r[o],f=r[o+1],g=r[o+2];if(typeof f!="function"){if(om(f||u)===null)continue;break}var y=cl(u);y!==null&&(r.splice(o,3),o-=3,lg(y,{pending:!0,data:g,method:u.method,action:f},f,g))}}))}function $l(r){function o(A){return kh(A,r)}qs!==null&&kh(qs,r),Vs!==null&&kh(Vs,r),$s!==null&&kh($s,r),Ia.forEach(o),Pa.forEach(o);for(var u=0;u<Gs.length;u++){var f=Gs[u];f.blockedOn===r&&(f.blockedOn=null)}for(;0<Gs.length&&(u=Gs[0],u.blockedOn===null);)Z1(u),u.blockedOn===null&&Gs.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var g=u[f],y=u[f+1],S=g[si]||null;if(typeof y=="function")S||tk(u);else if(S){var x=null;if(y&&y.hasAttribute("formAction")){if(g=y,S=y[si]||null)x=S.formAction;else if(om(g)!==null)continue}else x=S.action;typeof x=="function"?u[f+1]=x:(u.splice(f,3),f-=3),tk(u)}}}function ik(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(S){return g=S})},focusReset:"manual",scroll:"manual"})}function o(){g!==null&&(g(),g=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,g=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),g!==null&&(g(),g=null)}}}function cm(r){this._internalRoot=r}_h.prototype.render=cm.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,f=Ti();W1(u,f,r,o,null,null)},_h.prototype.unmount=cm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;W1(r.current,2,null,r,null,null),sh(),o[ol]=null}};function _h(r){this._internalRoot=r}_h.prototype.unstable_scheduleHydration=function(r){if(r){var o=fv();r={blockedOn:null,target:r,priority:o};for(var u=0;u<Gs.length&&o!==0&&o<Gs[u].priority;u++);Gs.splice(u,0,r),u===0&&Z1(r)}};var nk=e.version;if(nk!=="19.2.4")throw Error(n(527,nk,"19.2.4"));Y.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=d(o),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var kR={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oh.isDisabled&&Oh.supportsFiber)try{Xo=Oh.inject(kR),wi=Oh}catch{}}return Va.createRoot=function(r,o){if(!s(r))throw Error(n(299));var u=!1,f="",g=uS,y=hS,S=fS;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(y=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError)),o=G1(r,1,!1,null,null,u,f,null,g,y,S,ik),r[ol]=o.current,$g(r),new cm(o)},Va.hydrateRoot=function(r,o,u){if(!s(r))throw Error(n(299));var f=!1,g="",y=uS,S=hS,x=fS,A=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(g=u.identifierPrefix),u.onUncaughtError!==void 0&&(y=u.onUncaughtError),u.onCaughtError!==void 0&&(S=u.onCaughtError),u.onRecoverableError!==void 0&&(x=u.onRecoverableError),u.formState!==void 0&&(A=u.formState)),o=G1(r,1,!0,o,u??null,f,g,A,y,S,x,ik),o.context=K1(null),u=o.current,f=Ti(),f=Zd(f),g=Ds(f),g.callback=null,Rs(u,g,f),u=f,o.current.lanes=u,Jo(o,u),Cn(o),r[ol]=o.current,$g(r),new _h(o)},Va.version="19.2.4",Va}var dk;function NR(){if(dk)return fm.exports;dk=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),fm.exports=MR(),fm.exports}var LR=NR();function dd(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(i);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(i,n[s])&&(t[n[s]]=i[n[s]]);return t}function BR(i,e,t,n){function s(l){return l instanceof t?l:new t(function(a){a(l)})}return new(t||(t=Promise))(function(l,a){function c(p){try{d(n.next(p))}catch(m){a(m)}}function h(p){try{d(n.throw(p))}catch(m){a(m)}}function d(p){p.done?l(p.value):s(p.value).then(c,h)}d((n=n.apply(i,e||[])).next())})}const UR=i=>i?(...e)=>i(...e):(...e)=>fetch(...e);class Vy extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class jR extends Vy{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class pk extends Vy{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class gk extends Vy{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var A0;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(A0||(A0={}));class zR{constructor(e,{headers:t={},customFetch:n,region:s=A0.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=UR(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return BR(this,arguments,void 0,function*(t,n={}){var s;let l,a;try{const{headers:c,method:h,body:d,signal:p,timeout:m}=n;let b={},{region:v}=n;v||(v=this.region);const w=new URL(`${this.url}/${t}`);v&&v!=="any"&&(b["x-region"]=v,w.searchParams.set("forceFunctionRegion",v));let k;d&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(b["Content-Type"]="application/octet-stream",k=d):typeof d=="string"?(b["Content-Type"]="text/plain",k=d):typeof FormData<"u"&&d instanceof FormData?k=d:(b["Content-Type"]="application/json",k=JSON.stringify(d)):d&&typeof d!="string"&&!(typeof Blob<"u"&&d instanceof Blob)&&!(d instanceof ArrayBuffer)&&!(typeof FormData<"u"&&d instanceof FormData)?k=JSON.stringify(d):k=d;let _=p;m&&(a=new AbortController,l=setTimeout(()=>a.abort(),m),p?(_=a.signal,p.addEventListener("abort",()=>a.abort())):_=a.signal);const O=yield this.fetch(w.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},b),this.headers),c),body:k,signal:_}).catch(j=>{throw new jR(j)}),R=O.headers.get("x-relay-error");if(R&&R==="true")throw new pk(O);if(!O.ok)throw new gk(O);let C=((s=O.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),N;return C==="application/json"?N=yield O.json():C==="application/octet-stream"||C==="application/pdf"?N=yield O.blob():C==="text/event-stream"?N=O:C==="multipart/form-data"?N=yield O.formData():N=yield O.text(),{data:N,error:null,response:O}}catch(c){return{data:null,error:c,response:c instanceof gk||c instanceof pk?c.context:void 0}}finally{l&&clearTimeout(l)}})}}var IR=class extends Error{constructor(i){super(i.message),this.name="PostgrestError",this.details=i.details,this.hint=i.hint,this.code=i.code}},PR=class{constructor(i){var e,t,n;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(e=i.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=i.signal,this.isMaybeSingle=(t=i.isMaybeSingle)!==null&&t!==void 0?t:!1,this.urlLengthLimit=(n=i.urlLengthLimit)!==null&&n!==void 0?n:8e3,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,e){return this.headers=new Headers(this.headers),this.headers.set(i,e),this}then(i,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let a=null,c=null,h=null,d=l.status,p=l.statusText;if(l.ok){var m,b;if(t.method!=="HEAD"){var v;const O=await l.text();O===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((v=t.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?c=O:c=JSON.parse(O))}const k=(m=t.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),_=(b=l.headers.get("content-range"))===null||b===void 0?void 0:b.split("/");k&&_&&_.length>1&&(h=parseInt(_[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(c)&&(c.length>1?(a={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,p="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var w;const k=await l.text();try{a=JSON.parse(k),Array.isArray(a)&&l.status===404&&(c=[],a=null,d=200,p="OK")}catch{l.status===404&&k===""?(d=204,p="No Content"):a={message:k}}if(a&&t.isMaybeSingle&&(!(a==null||(w=a.details)===null||w===void 0)&&w.includes("0 rows"))&&(a=null,d=200,p="OK"),a&&t.shouldThrowOnError)throw new IR(a)}return{error:a,data:c,count:h,status:d,statusText:p}});return this.shouldThrowOnError||(s=s.catch(l=>{var a;let c="",h="",d="";const p=l?.cause;if(p){var m,b,v,w;const O=(m=p?.message)!==null&&m!==void 0?m:"",R=(b=p?.code)!==null&&b!==void 0?b:"";c=`${(v=l?.name)!==null&&v!==void 0?v:"FetchError"}: ${l?.message}`,c+=`

Caused by: ${(w=p?.name)!==null&&w!==void 0?w:"Error"}: ${O}`,R&&(c+=` (${R})`),p?.stack&&(c+=`
${p.stack}`)}else{var k;c=(k=l?.stack)!==null&&k!==void 0?k:""}const _=this.url.toString().length;return l?.name==="AbortError"||l?.code==="ABORT_ERR"?(d="",h="Request was aborted (timeout or manual cancellation)",_>this.urlLengthLimit&&(h+=`. Note: Your request URL is ${_} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(p?.name==="HeadersOverflowError"||p?.code==="UND_ERR_HEADERS_OVERFLOW")&&(d="",h="HTTP headers exceeded server limits (typically 16KB)",_>this.urlLengthLimit&&(h+=`. Your request URL is ${_} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(a=l?.name)!==null&&a!==void 0?a:"FetchError"}: ${l?.message}`,details:c,hint:h,code:d},data:null,count:null,status:0,statusText:""}})),s.then(i,e)}returns(){return this}overrideTypes(){return this}},HR=class extends PR{select(i){let e=!1;const t=(i??"*").split("").map(n=>/\s/.test(n)&&!e?"":(n==='"'&&(e=!e),n)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:e=!0,nullsFirst:t,foreignTable:n,referencedTable:s=n}={}){const l=s?`${s}.order`:"order",a=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${a?`${a},`:""}${i}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:e,referencedTable:t=e}={}){const n=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(n,`${i}`),this}range(i,e,{foreignTable:t,referencedTable:n=t}={}){const s=typeof n>"u"?"offset":`${n}.offset`,l=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${i}`),this.url.searchParams.set(l,`${e-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:e=!1,settings:t=!1,buffers:n=!1,wal:s=!1,format:l="text"}={}){var a;const c=[i?"analyze":null,e?"verbose":null,t?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${h}"; options=${c};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}};const mk=new RegExp("[,()]");var Zl=class extends HR{eq(i,e){return this.url.searchParams.append(i,`eq.${e}`),this}neq(i,e){return this.url.searchParams.append(i,`neq.${e}`),this}gt(i,e){return this.url.searchParams.append(i,`gt.${e}`),this}gte(i,e){return this.url.searchParams.append(i,`gte.${e}`),this}lt(i,e){return this.url.searchParams.append(i,`lt.${e}`),this}lte(i,e){return this.url.searchParams.append(i,`lte.${e}`),this}like(i,e){return this.url.searchParams.append(i,`like.${e}`),this}likeAllOf(i,e){return this.url.searchParams.append(i,`like(all).{${e.join(",")}}`),this}likeAnyOf(i,e){return this.url.searchParams.append(i,`like(any).{${e.join(",")}}`),this}ilike(i,e){return this.url.searchParams.append(i,`ilike.${e}`),this}ilikeAllOf(i,e){return this.url.searchParams.append(i,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(i,e){return this.url.searchParams.append(i,`ilike(any).{${e.join(",")}}`),this}regexMatch(i,e){return this.url.searchParams.append(i,`match.${e}`),this}regexIMatch(i,e){return this.url.searchParams.append(i,`imatch.${e}`),this}is(i,e){return this.url.searchParams.append(i,`is.${e}`),this}isDistinct(i,e){return this.url.searchParams.append(i,`isdistinct.${e}`),this}in(i,e){const t=Array.from(new Set(e)).map(n=>typeof n=="string"&&mk.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(i,`in.(${t})`),this}notIn(i,e){const t=Array.from(new Set(e)).map(n=>typeof n=="string"&&mk.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(i,`not.in.(${t})`),this}contains(i,e){return typeof e=="string"?this.url.searchParams.append(i,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(i,`cs.{${e.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(e)}`),this}containedBy(i,e){return typeof e=="string"?this.url.searchParams.append(i,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(i,`cd.{${e.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(e)}`),this}rangeGt(i,e){return this.url.searchParams.append(i,`sr.${e}`),this}rangeGte(i,e){return this.url.searchParams.append(i,`nxl.${e}`),this}rangeLt(i,e){return this.url.searchParams.append(i,`sl.${e}`),this}rangeLte(i,e){return this.url.searchParams.append(i,`nxr.${e}`),this}rangeAdjacent(i,e){return this.url.searchParams.append(i,`adj.${e}`),this}overlaps(i,e){return typeof e=="string"?this.url.searchParams.append(i,`ov.${e}`):this.url.searchParams.append(i,`ov.{${e.join(",")}}`),this}textSearch(i,e,{config:t,type:n}={}){let s="";n==="plain"?s="pl":n==="phrase"?s="ph":n==="websearch"&&(s="w");const l=t===void 0?"":`(${t})`;return this.url.searchParams.append(i,`${s}fts${l}.${e}`),this}match(i){return Object.entries(i).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(i,e,t){return this.url.searchParams.append(i,`not.${e}.${t}`),this}or(i,{foreignTable:e,referencedTable:t=e}={}){const n=t?`${t}.or`:"or";return this.url.searchParams.append(n,`(${i})`),this}filter(i,e,t){return this.url.searchParams.append(i,`${e}.${t}`),this}},qR=class{constructor(i,{headers:e={},schema:t,fetch:n,urlLengthLimit:s=8e3}){this.url=i,this.headers=new Headers(e),this.schema=t,this.fetch=n,this.urlLengthLimit=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(i,e){const{head:t=!1,count:n}=e??{},s=t?"HEAD":"GET";let l=!1;const a=(i??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join(""),{url:c,headers:h}=this.cloneRequestState();return c.searchParams.set("select",a),n&&h.append("Prefer",`count=${n}`),new Zl({method:s,url:c,headers:h,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(i,{count:e,defaultToNull:t=!0}={}){var n;const s="POST",{url:l,headers:a}=this.cloneRequestState();if(e&&a.append("Prefer",`count=${e}`),t||a.append("Prefer","missing=default"),Array.isArray(i)){const c=i.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(c.length>0){const h=[...new Set(c)].map(d=>`"${d}"`);l.searchParams.set("columns",h.join(","))}}return new Zl({method:s,url:l,headers:a,schema:this.schema,body:i,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(i,{onConflict:e,ignoreDuplicates:t=!1,count:n,defaultToNull:s=!0}={}){var l;const a="POST",{url:c,headers:h}=this.cloneRequestState();if(h.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&c.searchParams.set("on_conflict",e),n&&h.append("Prefer",`count=${n}`),s||h.append("Prefer","missing=default"),Array.isArray(i)){const d=i.reduce((p,m)=>p.concat(Object.keys(m)),[]);if(d.length>0){const p=[...new Set(d)].map(m=>`"${m}"`);c.searchParams.set("columns",p.join(","))}}return new Zl({method:a,url:c,headers:h,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch,urlLengthLimit:this.urlLengthLimit})}update(i,{count:e}={}){var t;const n="PATCH",{url:s,headers:l}=this.cloneRequestState();return e&&l.append("Prefer",`count=${e}`),new Zl({method:n,url:s,headers:l,schema:this.schema,body:i,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:i}={}){var e;const t="DELETE",{url:n,headers:s}=this.cloneRequestState();return i&&s.append("Prefer",`count=${i}`),new Zl({method:t,url:n,headers:s,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function fc(i){"@babel/helpers - typeof";return fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fc(i)}function VR(i,e){if(fc(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(fc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function $R(i){var e=VR(i,"string");return fc(e)=="symbol"?e:e+""}function GR(i,e,t){return(e=$R(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function yk(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,n)}return t}function Ch(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?yk(Object(t),!0).forEach(function(n){GR(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):yk(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}var KR=class CO{constructor(e,{headers:t={},schema:n,fetch:s,timeout:l,urlLengthLimit:a=8e3}={}){this.url=e,this.headers=new Headers(t),this.schemaName=n,this.urlLengthLimit=a;const c=s??globalThis.fetch;l!==void 0&&l>0?this.fetch=(h,d)=>{const p=new AbortController,m=setTimeout(()=>p.abort(),l),b=d?.signal;if(b){if(b.aborted)return clearTimeout(m),c(h,d);const v=()=>{clearTimeout(m),p.abort()};return b.addEventListener("abort",v,{once:!0}),c(h,Ch(Ch({},d),{},{signal:p.signal})).finally(()=>{clearTimeout(m),b.removeEventListener("abort",v)})}return c(h,Ch(Ch({},d),{},{signal:p.signal})).finally(()=>clearTimeout(m))}:this.fetch=c}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new qR(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new CO(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,t={},{head:n=!1,get:s=!1,count:l}={}){var a;let c;const h=new URL(`${this.url}/rpc/${e}`);let d;const p=v=>v!==null&&typeof v=="object"&&(!Array.isArray(v)||v.some(p)),m=n&&Object.values(t).some(p);m?(c="POST",d=t):n||s?(c=n?"HEAD":"GET",Object.entries(t).filter(([v,w])=>w!==void 0).map(([v,w])=>[v,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([v,w])=>{h.searchParams.append(v,w)})):(c="POST",d=t);const b=new Headers(this.headers);return m?b.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&b.set("Prefer",`count=${l}`),new Zl({method:c,url:h,headers:b,schema:this.schemaName,body:d,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}};class WR{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const n=t.versions;if(n&&n.node){const s=n.node,l=parseInt(s.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const YR="2.95.2",FR=`realtime-js/${YR}`,XR="1.0.0",TO="2.0.0",bk=TO,C0=1e4,QR=1e3,JR=100;var Ws;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Ws||(Ws={}));var Ot;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(Ot||(Ot={}));var dn;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(dn||(dn={}));var T0;(function(i){i.websocket="websocket"})(T0||(T0={}));var Ur;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Ur||(Ur={}));class ZR{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const s=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,n;const s=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:{},a=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,t,n){var s,l;const a=e.topic,c=(s=e.ref)!==null&&s!==void 0?s:"",h=(l=e.join_ref)!==null&&l!==void 0?l:"",d=e.payload.event,p=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},m=Object.keys(p).length===0?"":JSON.stringify(p);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const b=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+c.length+a.length+d.length+m.length,v=new ArrayBuffer(this.HEADER_LENGTH+b);let w=new DataView(v),k=0;w.setUint8(k++,this.KINDS.userBroadcastPush),w.setUint8(k++,h.length),w.setUint8(k++,c.length),w.setUint8(k++,a.length),w.setUint8(k++,d.length),w.setUint8(k++,m.length),w.setUint8(k++,t),Array.from(h,O=>w.setUint8(k++,O.charCodeAt(0))),Array.from(c,O=>w.setUint8(k++,O.charCodeAt(0))),Array.from(a,O=>w.setUint8(k++,O.charCodeAt(0))),Array.from(d,O=>w.setUint8(k++,O.charCodeAt(0))),Array.from(m,O=>w.setUint8(k++,O.charCodeAt(0)));var _=new Uint8Array(v.byteLength+n.byteLength);return _.set(new Uint8Array(v),0),_.set(new Uint8Array(n),v.byteLength),_.buffer}decode(e,t){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return t(n)}if(typeof e=="string"){const n=JSON.parse(e),[s,l,a,c,h]=n;return t({join_ref:s,ref:l,topic:a,event:c,payload:h})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),s=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,s)}_decodeUserBroadcast(e,t,n){const s=t.getUint8(1),l=t.getUint8(2),a=t.getUint8(3),c=t.getUint8(4);let h=this.HEADER_LENGTH+4;const d=n.decode(e.slice(h,h+s));h=h+s;const p=n.decode(e.slice(h,h+l));h=h+l;const m=n.decode(e.slice(h,h+a));h=h+a;const b=e.slice(h,e.byteLength),v=c===this.JSON_ENCODING?JSON.parse(n.decode(b)):b,w={type:this.BROADCAST_EVENT,event:p,payload:v};return a>0&&(w.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>t.includes(n)))}}class EO{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var et;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(et||(et={}));const vk=(i,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((l,a)=>(l[a]=eM(a,i,e,s),l),{}):{}},eM=(i,e,t,n)=>{const s=e.find(c=>c.name===i),l=s?.type,a=t[i];return l&&!n.includes(l)?DO(l,a):E0(a)},DO=(i,e)=>{if(i.charAt(0)==="_"){const t=i.slice(1,i.length);return sM(e,t)}switch(i){case et.bool:return tM(e);case et.float4:case et.float8:case et.int2:case et.int4:case et.int8:case et.numeric:case et.oid:return iM(e);case et.json:case et.jsonb:return nM(e);case et.timestamp:return rM(e);case et.abstime:case et.date:case et.daterange:case et.int4range:case et.int8range:case et.money:case et.reltime:case et.text:case et.time:case et.timestamptz:case et.timetz:case et.tsrange:case et.tstzrange:return E0(e);default:return E0(e)}},E0=i=>i,tM=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},iM=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},nM=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch{return i}return i},sM=(i,e)=>{if(typeof i!="string")return i;const t=i.length-1,n=i[t];if(i[0]==="{"&&n==="}"){let l;const a=i.slice(1,t);try{l=JSON.parse("["+a+"]")}catch{l=a?a.split(","):[]}return l.map(c=>DO(e,c))}return i},rM=i=>typeof i=="string"?i.replace(" ","T"):i,RO=i=>{const e=new URL(i);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class mm{constructor(e,t,n={},s=C0){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var wk;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(wk||(wk={}));class ic{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:l,onLeave:a,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ic.syncState(this.state,s,l,a),this.pendingDiffs.forEach(h=>{this.state=ic.syncDiff(this.state,h,l,a)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},s=>{const{onJoin:l,onLeave:a,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ic.syncDiff(this.state,s,l,a),c())}),this.onJoin((s,l,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:a})}),this.onLeave((s,l,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const l=this.cloneDeep(e),a=this.transformState(t),c={},h={};return this.map(l,(d,p)=>{a[d]||(h[d]=p)}),this.map(a,(d,p)=>{const m=l[d];if(m){const b=p.map(_=>_.presence_ref),v=m.map(_=>_.presence_ref),w=p.filter(_=>v.indexOf(_.presence_ref)<0),k=m.filter(_=>b.indexOf(_.presence_ref)<0);w.length>0&&(c[d]=w),k.length>0&&(h[d]=k)}else c[d]=p}),this.syncDiff(l,{joins:c,leaves:h},n,s)}static syncDiff(e,t,n,s){const{joins:l,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(l,(c,h)=>{var d;const p=(d=e[c])!==null&&d!==void 0?d:[];if(e[c]=this.cloneDeep(h),p.length>0){const m=e[c].map(v=>v.presence_ref),b=p.filter(v=>m.indexOf(v.presence_ref)<0);e[c].unshift(...b)}n(c,p,h)}),this.map(a,(c,h)=>{let d=e[c];if(!d)return;const p=h.map(m=>m.presence_ref);d=d.filter(m=>p.indexOf(m.presence_ref)<0),e[c]=d,s(c,d,h),d.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Sk;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(Sk||(Sk={}));var nc;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(nc||(nc={}));var hs;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(hs||(hs={}));class ro{constructor(e,t={config:{}},n){var s,l;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Ot.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new mm(this,dn.join,this.params,this.timeout),this.rejoinTimer=new EO(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ot.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ot.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this._on(dn.reply,{},(a,c)=>{this._trigger(this._replyEventName(c),a)}),this.presence=new ic(this),this.broadcastEndpointURL=RO(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,s,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Ot.closed){const{config:{broadcast:a,presence:c,private:h}}=this.params,d=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(v=>v.filter))!==null&&s!==void 0?s:[],p=!!this.bindings[nc.PRESENCE]&&this.bindings[nc.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,m={},b={broadcast:a,presence:Object.assign(Object.assign({},c),{enabled:p}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(hs.CHANNEL_ERROR,v)),this._onClose(()=>e?.(hs.CLOSED)),this.updateJoinPayload(Object.assign({config:b},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){e?.(hs.SUBSCRIBED);return}else{const k=this.bindings.postgres_changes,_=(w=k?.length)!==null&&w!==void 0?w:0,O=[];for(let R=0;R<_;R++){const C=k[R],{filter:{event:N,schema:j,table:H,filter:D}}=C,W=v&&v[R];if(W&&W.event===N&&ro.isFilterValueEqual(W.schema,j)&&ro.isFilterValueEqual(W.table,H)&&ro.isFilterValueEqual(W.filter,D))O.push(Object.assign(Object.assign({},C),{id:W.id}));else{this.unsubscribe(),this.state=Ot.errored,e?.(hs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=O,e&&e(hs.SUBSCRIBED);return}}).receive("error",v=>{this.state=Ot.errored,e?.(hs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(hs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===Ot.joined&&e===nc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,n)}async httpSend(e,t,n={}){var s;if(t==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(c.status===202)return{success:!0};let h=c.statusText;try{const d=await c.json();h=d.error||d.message||h}catch{}return Promise.reject(new Error(h))}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:a}=e,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var a,c,h;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(c=(a=this.params)===null||a===void 0?void 0:a.config)===null||c===void 0?void 0:c.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),d.receive("ok",()=>l("ok")),d.receive("error",()=>l("error")),d.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ot.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(dn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new mm(this,dn.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ot.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const s=new AbortController,l=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(l),a}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new mm(this,e,t,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>JR){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,l;const a=e.toLocaleLowerCase(),{close:c,error:h,leave:d,join:p}=dn;if(n&&[c,h,d,p].indexOf(a)>=0&&n!==this._joinRef())return;let b=this._onMessage(a,t,n);if(t&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(v=>{var w,k,_;return((w=v.filter)===null||w===void 0?void 0:w.event)==="*"||((_=(k=v.filter)===null||k===void 0?void 0:k.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===a}).map(v=>v.callback(b,n)):(l=this.bindings[a])===null||l===void 0||l.filter(v=>{var w,k,_,O,R,C;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in v){const N=v.id,j=(w=v.filter)===null||w===void 0?void 0:w.event;return N&&((k=t.ids)===null||k===void 0?void 0:k.includes(N))&&(j==="*"||j?.toLocaleLowerCase()===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const N=(R=(O=v?.filter)===null||O===void 0?void 0:O.event)===null||R===void 0?void 0:R.toLocaleLowerCase();return N==="*"||N===((C=t?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===a}).map(v=>{if(typeof b=="object"&&"ids"in b){const w=b.data,{schema:k,table:_,commit_timestamp:O,type:R,errors:C}=w;b=Object.assign(Object.assign({},{schema:k,table:_,commit_timestamp:O,eventType:R,new:{},old:{},errors:C}),this._getPayloadRecords(w))}v.callback(b,n)})}_isClosed(){return this.state===Ot.closed}_isJoined(){return this.state===Ot.joined}_isJoining(){return this.state===Ot.joining}_isLeaving(){return this.state===Ot.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),l={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&ro.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(dn.close,{},e)}_onError(e){this._on(dn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ot.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=vk(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=vk(e.columns,e.old_record)),t}}const ym=()=>{},Th={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},lM=[1e3,2e3,5e3,1e4],oM=1e4,aM=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class cM{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=C0,this.transport=null,this.heartbeatIntervalMs=Th.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ym,this.ref=0,this.reconnectTimer=null,this.vsn=bk,this.logger=ym,this.conn=null,this.sendBuffer=[],this.serializer=new ZR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...l)=>s(...l):(...l)=>fetch(...l),!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${T0.websocket}`,this.httpEndpoint=RO(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=WR.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ws.connecting:return Ur.Connecting;case Ws.open:return Ur.Open;case Ws.closing:return Ur.Closing;default:return Ur.Closed}}isConnected(){return this.connectionState()===Ur.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(l=>l.topic===n);if(s)return s;{const l=new ro(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:n,payload:s,ref:l}=e,a=()=>{this.encode(e,c=>{var h;(h=this.conn)===null||h===void 0||h.send(c)})};this.log("push",`${t} ${n} (${l})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(QR,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Th.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const d=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",d)}catch(p){this.log("error","error in heartbeat callback",p)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:s,payload:l,ref:a}=t,c=a?`(${a})`:"",h=l.status||"";this.log("receive",`${h} ${n} ${s} ${c}`.trim(),l),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(s,l,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Ws.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ws.open||this.conn.readyState===Ws.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(dn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([aM],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,n=!1;if(e)t=e,n=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),t=this.accessTokenValue}else t=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const l={access_token:t,version:FR};t&&s.updateJoinPayload(l),s.joinedOnce&&s._isJoined()&&s._push(dn.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new EO(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Th.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,s,l,a,c,h,d,p,m,b,v;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:C0,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:Th.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(a=e?.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:ym,this.vsn=(h=e?.vsn)!==null&&h!==void 0?h:bk,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(w=>lM[w-1]||oM),this.vsn){case XR:this.encode=(p=e?.encode)!==null&&p!==void 0?p:((w,k)=>k(JSON.stringify(w))),this.decode=(m=e?.decode)!==null&&m!==void 0?m:((w,k)=>k(JSON.parse(w)));break;case TO:this.encode=(b=e?.encode)!==null&&b!==void 0?b:this.serializer.encode.bind(this.serializer),this.decode=(v=e?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var dc=class extends Error{constructor(i,e){super(i),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function uM(i,e,t){const n=new URL(e,i);if(t)for(const[s,l]of Object.entries(t))l!==void 0&&n.searchParams.set(s,l);return n.toString()}async function hM(i){return!i||i.type==="none"?{}:i.type==="bearer"?{Authorization:`Bearer ${i.token}`}:i.type==="header"?{[i.name]:i.value}:i.type==="custom"?await i.getHeaders():{}}function fM(i){const e=i.fetchImpl??globalThis.fetch;return{async request({method:t,path:n,query:s,body:l,headers:a}){const c=uM(i.baseUrl,n,s),h=await hM(i.auth),d=await e(c,{method:t,headers:{...l?{"Content-Type":"application/json"}:{},...h,...a},body:l?JSON.stringify(l):void 0}),p=await d.text(),m=(d.headers.get("content-type")||"").includes("application/json"),b=m&&p?JSON.parse(p):p;if(!d.ok){const v=m?b:void 0,w=v?.error;throw new dc(w?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:w?.type,icebergCode:w?.code,details:v})}return{status:d.status,headers:d.headers,data:b}}}}function Eh(i){return i.join("")}var dM=class{constructor(i,e=""){this.client=i,this.prefix=e}async listNamespaces(i){const e=i?{parent:Eh(i.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(i,e){const t={namespace:i.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(i){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Eh(i.namespace)}`})}async loadNamespaceMetadata(i){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Eh(i.namespace)}`})).data.properties}}async namespaceExists(i){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Eh(i.namespace)}`}),!0}catch(e){if(e instanceof dc&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(i,e){try{return await this.createNamespace(i,e)}catch(t){if(t instanceof dc&&t.status===409)return;throw t}}};function Gl(i){return i.join("")}var pM=class{constructor(i,e="",t){this.client=i,this.prefix=e,this.accessDelegation=t}async listTables(i){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Gl(i.namespace)}/tables`})).data.identifiers}async createTable(i,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Gl(i.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(i,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Gl(i.namespace)}/tables/${i.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(i,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Gl(i.namespace)}/tables/${i.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(i){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Gl(i.namespace)}/tables/${i.name}`,headers:e})).data.metadata}async tableExists(i){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Gl(i.namespace)}/tables/${i.name}`,headers:e}),!0}catch(t){if(t instanceof dc&&t.status===404)return!1;throw t}}async createTableIfNotExists(i,e){try{return await this.createTable(i,e)}catch(t){if(t instanceof dc&&t.status===409)return await this.loadTable({namespace:i.namespace,name:e.name});throw t}}},gM=class{constructor(i){let e="v1";i.catalogName&&(e+=`/${i.catalogName}`);const t=i.baseUrl.endsWith("/")?i.baseUrl:`${i.baseUrl}/`;this.client=fM({baseUrl:t,auth:i.auth,fetchImpl:i.fetch}),this.accessDelegation=i.accessDelegation?.join(","),this.namespaceOps=new dM(this.client,e),this.tableOps=new pM(this.client,e,this.accessDelegation)}async listNamespaces(i){return this.namespaceOps.listNamespaces(i)}async createNamespace(i,e){return this.namespaceOps.createNamespace(i,e)}async dropNamespace(i){await this.namespaceOps.dropNamespace(i)}async loadNamespaceMetadata(i){return this.namespaceOps.loadNamespaceMetadata(i)}async listTables(i){return this.tableOps.listTables(i)}async createTable(i,e){return this.tableOps.createTable(i,e)}async updateTable(i,e){return this.tableOps.updateTable(i,e)}async dropTable(i,e){await this.tableOps.dropTable(i,e)}async loadTable(i){return this.tableOps.loadTable(i)}async namespaceExists(i){return this.namespaceOps.namespaceExists(i)}async tableExists(i){return this.tableOps.tableExists(i)}async createNamespaceIfNotExists(i,e){return this.namespaceOps.createNamespaceIfNotExists(i,e)}async createTableIfNotExists(i,e){return this.tableOps.createTableIfNotExists(i,e)}},pd=class extends Error{constructor(i,e="storage",t,n){super(i),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=t,this.statusCode=n}};function gd(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}var Dh=class extends pd{constructor(i,e,t,n="storage"){super(i,n,e,t),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},MO=class extends pd{constructor(i,e,t="storage"){super(i,t),this.name=t==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const mM=i=>i?(...e)=>i(...e):(...e)=>fetch(...e),yM=i=>{if(typeof i!="object"||i===null)return!1;const e=Object.getPrototypeOf(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},D0=i=>{if(Array.isArray(i))return i.map(t=>D0(t));if(typeof i=="function"||i!==Object(i))return i;const e={};return Object.entries(i).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[s]=D0(n)}),e},bM=i=>!i||typeof i!="string"||i.length===0||i.length>100||i.trim()!==i||i.includes("/")||i.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(i);function pc(i){"@babel/helpers - typeof";return pc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pc(i)}function vM(i,e){if(pc(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(pc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function wM(i){var e=vM(i,"string");return pc(e)=="symbol"?e:e+""}function SM(i,e,t){return(e=wM(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function kk(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,n)}return t}function me(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?kk(Object(t),!0).forEach(function(n){SM(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):kk(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}const xk=i=>{var e;return i.msg||i.message||i.error_description||(typeof i.error=="string"?i.error:(e=i.error)===null||e===void 0?void 0:e.message)||JSON.stringify(i)},kM=async(i,e,t,n)=>{if(i&&typeof i=="object"&&"status"in i&&"ok"in i&&typeof i.status=="number"&&!t?.noResolveJson){const s=i,l=s.status||500;if(typeof s.json=="function")s.json().then(a=>{const c=a?.statusCode||a?.code||l+"";e(new Dh(xk(a),l,c,n))}).catch(()=>{if(n==="vectors"){const a=l+"";e(new Dh(s.statusText||`HTTP ${l} error`,l,a,n))}else{const a=l+"";e(new Dh(s.statusText||`HTTP ${l} error`,l,a,n))}});else{const a=l+"";e(new Dh(s.statusText||`HTTP ${l} error`,l,a,n))}}else e(new MO(xk(i),i,n))},xM=(i,e,t,n)=>{const s={method:i,headers:e?.headers||{}};return i==="GET"||i==="HEAD"||!n?me(me({},s),t):(yM(n)?(s.headers=me({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(n)):s.body=n,e?.duplex&&(s.duplex=e.duplex),me(me({},s),t))};async function $a(i,e,t,n,s,l,a){return new Promise((c,h)=>{i(t,xM(e,n,s,l)).then(d=>{if(!d.ok)throw d;if(n?.noResolveJson)return d;if(a==="vectors"){const p=d.headers.get("content-type");if(d.headers.get("content-length")==="0"||d.status===204)return{};if(!p||!p.includes("application/json"))return{}}return d.json()}).then(d=>c(d)).catch(d=>kM(d,h,n,a))})}function NO(i="storage"){return{get:async(e,t,n,s)=>$a(e,"GET",t,n,s,void 0,i),post:async(e,t,n,s,l)=>$a(e,"POST",t,s,l,n,i),put:async(e,t,n,s,l)=>$a(e,"PUT",t,s,l,n,i),head:async(e,t,n,s)=>$a(e,"HEAD",t,me(me({},n),{},{noResolveJson:!0}),s,void 0,i),remove:async(e,t,n,s,l)=>$a(e,"DELETE",t,s,l,n,i)}}const _M=NO("storage"),{get:gc,post:fn,put:R0,head:OM,remove:$y}=_M,ji=NO("vectors");var Ho=class{constructor(i,e={},t,n="storage"){this.shouldThrowOnError=!1,this.url=i,this.headers=e,this.fetch=mM(t),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(i){var e=this;try{return{data:await i(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(gd(t))return{data:null,error:t};throw t}}},AM=class{constructor(i,e){this.downloadFn=i,this.shouldThrowOnError=e}then(i,e){return this.execute().then(i,e)}async execute(){var i=this;try{return{data:(await i.downloadFn()).body,error:null}}catch(e){if(i.shouldThrowOnError)throw e;if(gd(e))return{data:null,error:e};throw e}}};let LO;LO=Symbol.toStringTag;var CM=class{constructor(i,e){this.downloadFn=i,this.shouldThrowOnError=e,this[LO]="BlobDownloadBuilder",this.promise=null}asStream(){return new AM(this.downloadFn,this.shouldThrowOnError)}then(i,e){return this.getPromise().then(i,e)}catch(i){return this.getPromise().catch(i)}finally(i){return this.getPromise().finally(i)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var i=this;try{return{data:await(await i.downloadFn()).blob(),error:null}}catch(e){if(i.shouldThrowOnError)throw e;if(gd(e))return{data:null,error:e};throw e}}};const TM={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},_k={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var EM=class extends Ho{constructor(i,e={},t,n){super(i,e,n,"storage"),this.bucketId=t}async uploadOrUpdate(i,e,t,n){var s=this;return s.handleOperation(async()=>{let l;const a=me(me({},_k),n);let c=me(me({},s.headers),i==="POST"&&{"x-upsert":String(a.upsert)});const h=a.metadata;typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",a.cacheControl),h&&l.append("metadata",s.encodeMetadata(h)),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.has("cacheControl")||l.append("cacheControl",a.cacheControl),h&&!l.has("metadata")&&l.append("metadata",s.encodeMetadata(h))):(l=t,c["cache-control"]=`max-age=${a.cacheControl}`,c["content-type"]=a.contentType,h&&(c["x-metadata"]=s.toBase64(s.encodeMetadata(h))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!a.duplex&&(a.duplex="half")),n?.headers&&(c=me(me({},c),n.headers));const d=s._removeEmptyFolders(e),p=s._getFinalPath(d),m=await(i=="PUT"?R0:fn)(s.fetch,`${s.url}/object/${p}`,l,me({headers:c},a?.duplex?{duplex:a.duplex}:{}));return{path:d,id:m.Id,fullPath:m.Key}})}async upload(i,e,t){return this.uploadOrUpdate("POST",i,e,t)}async uploadToSignedUrl(i,e,t,n){var s=this;const l=s._removeEmptyFolders(i),a=s._getFinalPath(l),c=new URL(s.url+`/object/upload/sign/${a}`);return c.searchParams.set("token",e),s.handleOperation(async()=>{let h;const d=me({upsert:_k.upsert},n),p=me(me({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&t instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",t)):typeof FormData<"u"&&t instanceof FormData?(h=t,h.append("cacheControl",d.cacheControl)):(h=t,p["cache-control"]=`max-age=${d.cacheControl}`,p["content-type"]=d.contentType),{path:l,fullPath:(await R0(s.fetch,c.toString(),h,{headers:p})).Key}})}async createSignedUploadUrl(i,e){var t=this;return t.handleOperation(async()=>{let n=t._getFinalPath(i);const s=me({},t.headers);e?.upsert&&(s["x-upsert"]="true");const l=await fn(t.fetch,`${t.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(t.url+l.url),c=a.searchParams.get("token");if(!c)throw new pd("No token returned by API");return{signedUrl:a.toString(),path:i,token:c}})}async update(i,e,t){return this.uploadOrUpdate("PUT",i,e,t)}async move(i,e,t){var n=this;return n.handleOperation(async()=>await fn(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:i,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:n.headers}))}async copy(i,e,t){var n=this;return n.handleOperation(async()=>({path:(await fn(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:i,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(i,e,t){var n=this;return n.handleOperation(async()=>{let s=n._getFinalPath(i),l=await fn(n.fetch,`${n.url}/object/sign/${s}`,me({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:n.headers});const a=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{signedUrl:encodeURI(`${n.url}${l.signedURL}${a}`)}})}async createSignedUrls(i,e,t){var n=this;return n.handleOperation(async()=>{const s=await fn(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:e,paths:i},{headers:n.headers}),l=t?.download?`&download=${t.download===!0?"":t.download}`:"";return s.map(a=>me(me({},a),{},{signedUrl:a.signedURL?encodeURI(`${n.url}${a.signedURL}${l}`):null}))})}download(i,e){const t=typeof e?.transform<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString(e?.transform||{}),s=n?`?${n}`:"",l=this._getFinalPath(i),a=()=>gc(this.fetch,`${this.url}/${t}/${l}${s}`,{headers:this.headers,noResolveJson:!0});return new CM(a,this.shouldThrowOnError)}async info(i){var e=this;const t=e._getFinalPath(i);return e.handleOperation(async()=>D0(await gc(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})))}async exists(i){var e=this;const t=e._getFinalPath(i);try{return await OM(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(gd(n)&&n instanceof MO){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}}getPublicUrl(i,e){const t=this._getFinalPath(i),n=[],s=e?.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&n.push(s);const l=typeof e?.transform<"u"?"render/image":"object",a=this.transformOptsToQueryString(e?.transform||{});a!==""&&n.push(a);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${c}`)}}}async remove(i){var e=this;return e.handleOperation(async()=>await $y(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:i},{headers:e.headers}))}async list(i,e,t){var n=this;return n.handleOperation(async()=>{const s=me(me(me({},TM),e),{},{prefix:i||""});return await fn(n.fetch,`${n.url}/object/list/${n.bucketId}`,s,{headers:n.headers},t)})}async listV2(i,e){var t=this;return t.handleOperation(async()=>{const n=me({},i);return await fn(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,n,{headers:t.headers},e)})}encodeMetadata(i){return JSON.stringify(i)}toBase64(i){return typeof Buffer<"u"?Buffer.from(i).toString("base64"):btoa(i)}_getFinalPath(i){return`${this.bucketId}/${i.replace(/^\/+/,"")}`}_removeEmptyFolders(i){return i.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(i){const e=[];return i.width&&e.push(`width=${i.width}`),i.height&&e.push(`height=${i.height}`),i.resize&&e.push(`resize=${i.resize}`),i.format&&e.push(`format=${i.format}`),i.quality&&e.push(`quality=${i.quality}`),e.join("&")}};const DM="2.95.2",Wc={"X-Client-Info":`storage-js/${DM}`};var RM=class extends Ho{constructor(i,e={},t,n){const s=new URL(i);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."));const l=s.href.replace(/\/$/,""),a=me(me({},Wc),e);super(l,a,t,"storage")}async listBuckets(i){var e=this;return e.handleOperation(async()=>{const t=e.listBucketOptionsToQueryString(i);return await gc(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers})})}async getBucket(i){var e=this;return e.handleOperation(async()=>await gc(e.fetch,`${e.url}/bucket/${i}`,{headers:e.headers}))}async createBucket(i,e={public:!1}){var t=this;return t.handleOperation(async()=>await fn(t.fetch,`${t.url}/bucket`,{id:i,name:i,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async updateBucket(i,e){var t=this;return t.handleOperation(async()=>await R0(t.fetch,`${t.url}/bucket/${i}`,{id:i,name:i,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async emptyBucket(i){var e=this;return e.handleOperation(async()=>await fn(e.fetch,`${e.url}/bucket/${i}/empty`,{},{headers:e.headers}))}async deleteBucket(i){var e=this;return e.handleOperation(async()=>await $y(e.fetch,`${e.url}/bucket/${i}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(i){const e={};return i&&("limit"in i&&(e.limit=String(i.limit)),"offset"in i&&(e.offset=String(i.offset)),i.search&&(e.search=i.search),i.sortColumn&&(e.sortColumn=i.sortColumn),i.sortOrder&&(e.sortOrder=i.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},MM=class extends Ho{constructor(i,e={},t){const n=i.replace(/\/$/,""),s=me(me({},Wc),e);super(n,s,t,"storage")}async createBucket(i){var e=this;return e.handleOperation(async()=>await fn(e.fetch,`${e.url}/bucket`,{name:i},{headers:e.headers}))}async listBuckets(i){var e=this;return e.handleOperation(async()=>{const t=new URLSearchParams;i?.limit!==void 0&&t.set("limit",i.limit.toString()),i?.offset!==void 0&&t.set("offset",i.offset.toString()),i?.sortColumn&&t.set("sortColumn",i.sortColumn),i?.sortOrder&&t.set("sortOrder",i.sortOrder),i?.search&&t.set("search",i.search);const n=t.toString(),s=n?`${e.url}/bucket?${n}`:`${e.url}/bucket`;return await gc(e.fetch,s,{headers:e.headers})})}async deleteBucket(i){var e=this;return e.handleOperation(async()=>await $y(e.fetch,`${e.url}/bucket/${i}`,{},{headers:e.headers}))}from(i){var e=this;if(!bM(i))throw new pd("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new gM({baseUrl:this.url,catalogName:i,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(t,{get(s,l){const a=s[l];return typeof a!="function"?a:async(...c)=>{try{return{data:await a.apply(s,c),error:null}}catch(h){if(n)throw h;return{data:null,error:h}}}}})}},NM=class extends Ho{constructor(i,e={},t){const n=i.replace(/\/$/,""),s=me(me({},Wc),{},{"Content-Type":"application/json"},e);super(n,s,t,"vectors")}async createIndex(i){var e=this;return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/CreateIndex`,i,{headers:e.headers})||{})}async getIndex(i,e){var t=this;return t.handleOperation(async()=>await ji.post(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:i,indexName:e},{headers:t.headers}))}async listIndexes(i){var e=this;return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/ListIndexes`,i,{headers:e.headers}))}async deleteIndex(i,e){var t=this;return t.handleOperation(async()=>await ji.post(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:i,indexName:e},{headers:t.headers})||{})}},LM=class extends Ho{constructor(i,e={},t){const n=i.replace(/\/$/,""),s=me(me({},Wc),{},{"Content-Type":"application/json"},e);super(n,s,t,"vectors")}async putVectors(i){var e=this;if(i.vectors.length<1||i.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/PutVectors`,i,{headers:e.headers})||{})}async getVectors(i){var e=this;return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/GetVectors`,i,{headers:e.headers}))}async listVectors(i){var e=this;if(i.segmentCount!==void 0){if(i.segmentCount<1||i.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(i.segmentIndex!==void 0&&(i.segmentIndex<0||i.segmentIndex>=i.segmentCount))throw new Error(`segmentIndex must be between 0 and ${i.segmentCount-1}`)}return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/ListVectors`,i,{headers:e.headers}))}async queryVectors(i){var e=this;return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/QueryVectors`,i,{headers:e.headers}))}async deleteVectors(i){var e=this;if(i.keys.length<1||i.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/DeleteVectors`,i,{headers:e.headers})||{})}},BM=class extends Ho{constructor(i,e={},t){const n=i.replace(/\/$/,""),s=me(me({},Wc),{},{"Content-Type":"application/json"},e);super(n,s,t,"vectors")}async createBucket(i){var e=this;return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:i},{headers:e.headers})||{})}async getBucket(i){var e=this;return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:i},{headers:e.headers}))}async listBuckets(i={}){var e=this;return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/ListVectorBuckets`,i,{headers:e.headers}))}async deleteBucket(i){var e=this;return e.handleOperation(async()=>await ji.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:i},{headers:e.headers})||{})}},UM=class extends BM{constructor(i,e={}){super(i,e.headers||{},e.fetch)}from(i){return new jM(this.url,this.headers,i,this.fetch)}async createBucket(i){var e=()=>super.createBucket,t=this;return e().call(t,i)}async getBucket(i){var e=()=>super.getBucket,t=this;return e().call(t,i)}async listBuckets(i={}){var e=()=>super.listBuckets,t=this;return e().call(t,i)}async deleteBucket(i){var e=()=>super.deleteBucket,t=this;return e().call(t,i)}},jM=class extends NM{constructor(i,e,t,n){super(i,e,n),this.vectorBucketName=t}async createIndex(i){var e=()=>super.createIndex,t=this;return e().call(t,me(me({},i),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(i={}){var e=()=>super.listIndexes,t=this;return e().call(t,me(me({},i),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(i){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,i)}async deleteIndex(i){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,i)}index(i){return new zM(this.url,this.headers,this.vectorBucketName,i,this.fetch)}},zM=class extends LM{constructor(i,e,t,n,s){super(i,e,s),this.vectorBucketName=t,this.indexName=n}async putVectors(i){var e=()=>super.putVectors,t=this;return e().call(t,me(me({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(i){var e=()=>super.getVectors,t=this;return e().call(t,me(me({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(i={}){var e=()=>super.listVectors,t=this;return e().call(t,me(me({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(i){var e=()=>super.queryVectors,t=this;return e().call(t,me(me({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(i){var e=()=>super.deleteVectors,t=this;return e().call(t,me(me({},i),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},IM=class extends RM{constructor(i,e={},t,n){super(i,e,t,n)}from(i){return new EM(this.url,this.headers,i,this.fetch)}get vectors(){return new UM(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new MM(this.url+"/iceberg",this.headers,this.fetch)}};const BO="2.95.2",eo=30*1e3,M0=3,bm=M0*eo,PM="http://localhost:9999",HM="supabase.auth.token",qM={"X-Client-Info":`gotrue-js/${BO}`},N0="X-Supabase-Api-Version",UO={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},VM=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,$M=600*1e3;class mc extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function ce(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class GM extends mc{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function KM(i){return ce(i)&&i.name==="AuthApiError"}class jr extends mc{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class vs extends mc{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class Mi extends vs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function vm(i){return ce(i)&&i.name==="AuthSessionMissingError"}class Kl extends vs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Rh extends vs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Mh extends vs{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function WM(i){return ce(i)&&i.name==="AuthImplicitGrantRedirectError"}class Ok extends vs{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class YM extends vs{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class L0 extends vs{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function wm(i){return ce(i)&&i.name==="AuthRetryableFetchError"}class Ak extends vs{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class B0 extends vs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const kf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ck=` 	
\r=`.split(""),FM=(()=>{const i=new Array(128);for(let e=0;e<i.length;e+=1)i[e]=-1;for(let e=0;e<Ck.length;e+=1)i[Ck[e].charCodeAt(0)]=-2;for(let e=0;e<kf.length;e+=1)i[kf[e].charCodeAt(0)]=e;return i})();function Tk(i,e,t){if(i!==null)for(e.queue=e.queue<<8|i,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(kf[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(kf[n]),e.queuedBits-=6}}function jO(i,e,t){const n=FM[i];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function Ek(i){const e=[],t=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=a=>{JM(a,n,t)};for(let a=0;a<i.length;a+=1)jO(i.charCodeAt(a),s,l);return e.join("")}function XM(i,e){if(i<=127){e(i);return}else if(i<=2047){e(192|i>>6),e(128|i&63);return}else if(i<=65535){e(224|i>>12),e(128|i>>6&63),e(128|i&63);return}else if(i<=1114111){e(240|i>>18),e(128|i>>12&63),e(128|i>>6&63),e(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function QM(i,e){for(let t=0;t<i.length;t+=1){let n=i.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(i.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}XM(n,e)}}function JM(i,e,t){if(e.utf8seq===0){if(i<=127){t(i);return}for(let n=1;n<6;n+=1)if((i>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=i&31;else if(e.utf8seq===3)e.codepoint=i&15;else if(e.utf8seq===4)e.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|i&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function ho(i){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<i.length;s+=1)jO(i.charCodeAt(s),t,n);return new Uint8Array(e)}function ZM(i){const e=[];return QM(i,t=>e.push(t)),new Uint8Array(e)}function Pr(i){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};return i.forEach(s=>Tk(s,t,n)),Tk(null,t,n),e.join("")}function eN(i){return Math.round(Date.now()/1e3)+i}function tN(){return Symbol("auth-callback")}const qt=()=>typeof window<"u"&&typeof document<"u",Rr={tested:!1,writable:!1},zO=()=>{if(!qt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Rr.tested)return Rr.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Rr.tested=!0,Rr.writable=!0}catch{Rr.tested=!0,Rr.writable=!1}return Rr.writable};function iN(i){const e={},t=new URL(i);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,l)=>{e[l]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const IO=i=>i?(...e)=>i(...e):(...e)=>fetch(...e),nN=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",to=async(i,e,t)=>{await i.setItem(e,JSON.stringify(t))},Mr=async(i,e)=>{const t=await i.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ht=async(i,e)=>{await i.removeItem(e)};class md{constructor(){this.promise=new md.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}md.promiseConstructor=Promise;function Nh(i){const e=i.split(".");if(e.length!==3)throw new B0("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!VM.test(e[n]))throw new B0("JWT not in base64url format");return{header:JSON.parse(Ek(e[0])),payload:JSON.parse(Ek(e[1])),signature:ho(e[2]),raw:{header:e[0],payload:e[1]}}}async function sN(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function rN(i,e){return new Promise((n,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const a=await i(l);if(!e(l,null,a)){n(a);return}}catch(a){if(!e(l,a)){s(a);return}}})()})}function lN(i){return("0"+i.toString(16)).substr(-2)}function oN(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let l=0;l<56;l++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,lN).join("")}async function aN(i){const t=new TextEncoder().encode(i),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function cN(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const t=await aN(i);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wl(i,e,t=!1){const n=oN();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await to(i,`${e}-code-verifier`,s);const l=await cN(n);return[l,n===l?"plain":"s256"]}const uN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function hN(i){const e=i.headers.get(N0);if(!e||!e.match(uN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function fN(i){if(!i)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(i<=e)throw new Error("JWT has expired")}function dN(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const pN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Yl(i){if(!pN.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Sm(){const i={};return new Proxy(i,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function gN(i,e){return new Proxy(i,{get:(t,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const l=n.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,n,s)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,n,s)}})}function Dk(i){return JSON.parse(JSON.stringify(i))}const Lr=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),mN=[502,503,504];async function Rk(i){var e;if(!nN(i))throw new L0(Lr(i),0);if(mN.includes(i.status))throw new L0(Lr(i),i.status);let t;try{t=await i.json()}catch(l){throw new jr(Lr(l),l)}let n;const s=hN(i);if(s&&s.getTime()>=UO["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new Ak(Lr(t),i.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Mi}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,a)=>l&&typeof a=="string",!0))throw new Ak(Lr(t),i.status,t.weak_password.reasons);throw new GM(Lr(t),i.status||500,n)}const yN=(i,e,t,n)=>{const s={method:i,headers:e?.headers||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function pe(i,e,t,n){var s;const l=Object.assign({},n?.headers);l[N0]||(l[N0]=UO["2024-01-01"].name),n?.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const a=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(a.redirect_to=n.redirectTo);const c=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",h=await bN(i,e,t+c,{headers:l,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(h):{data:Object.assign({},h),error:null}}async function bN(i,e,t,n,s,l){const a=yN(e,n,s,l);let c;try{c=await i(t,Object.assign({},a))}catch(h){throw console.error(h),new L0(Lr(h),0)}if(c.ok||await Rk(c),n?.noResolveJson)return c;try{return await c.json()}catch(h){await Rk(h)}}function hn(i){var e;let t=null;SN(i)&&(t=Object.assign({},i),i.expires_at||(t.expires_at=eN(i.expires_in)));const n=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:t,user:n},error:null}}function Mk(i){const e=hn(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=i.weak_password),e}function Xs(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function vN(i){return{data:i,error:null}}function wN(i){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:l}=i,a=dd(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:l},h=Object.assign({},a);return{data:{properties:c,user:h},error:null}}function Nk(i){return i}function SN(i){return i.access_token&&i.refresh_token&&i.expires_in}const km=["global","local","others"];class kN{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=IO(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=km[0]){if(km.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${km.join(", ")}`);try{return await pe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await pe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Xs})}catch(n){if(ce(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=dd(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await pe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:wN,redirectTo:t?.redirectTo})}catch(t){if(ce(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await pe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Xs})}catch(t){if(ce(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,l,a,c,h;try{const d={nextPage:null,lastPage:0,total:0},p=await pe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(l=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:Nk});if(p.error)throw p.error;const m=await p.json(),b=(a=p.headers.get("x-total-count"))!==null&&a!==void 0?a:0,v=(h=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(w=>{const k=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(w.split(";")[1].split("=")[1]);d[`${_}Page`]=k}),d.total=parseInt(b)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(ce(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Yl(e);try{return await pe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Xs})}catch(t){if(ce(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Yl(e);try{return await pe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Xs})}catch(n){if(ce(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){Yl(e);try{return await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Xs})}catch(n){if(ce(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Yl(e.userId);try{const{data:t,error:n}=await pe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Yl(e.userId),Yl(e.id);try{return{data:await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,s,l,a,c,h;try{const d={nextPage:null,lastPage:0,total:0},p=await pe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(l=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:Nk});if(p.error)throw p.error;const m=await p.json(),b=(a=p.headers.get("x-total-count"))!==null&&a!==void 0?a:0,v=(h=(c=p.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(w=>{const k=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(w.split(";")[1].split("=")[1]);d[`${_}Page`]=k}),d.total=parseInt(b)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(ce(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await pe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await pe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await pe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ce(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await pe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(ce(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await pe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ce(t))return{data:null,error:t};throw t}}}function Lk(i={}){return{getItem:e=>i[e]||null,setItem:(e,t)=>{i[e]=t},removeItem:e=>{delete i[e]}}}const Fl={debug:!!(globalThis&&zO()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class PO extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class xN extends PO{}async function _N(i,e,t){Fl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Fl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Fl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,s.name);try{return await t()}finally{Fl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,s.name)}}else{if(e===0)throw Fl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new xN(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(Fl.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function ON(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function HO(i){if(!/^0x[a-fA-F0-9]{40}$/.test(i))throw new Error(`@supabase/auth-js: Address "${i}" is invalid.`);return i.toLowerCase()}function AN(i){return parseInt(i,16)}function CN(i){const e=new TextEncoder().encode(i);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function TN(i){var e;const{chainId:t,domain:n,expirationTime:s,issuedAt:l=new Date,nonce:a,notBefore:c,requestId:h,resources:d,scheme:p,uri:m,version:b}=i;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(b!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${b}`);if(!((e=i.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${i.statement}`)}const v=HO(i.address),w=p?`${p}://${n}`:n,k=i.statement?`${i.statement}
`:"",_=`${w} wants you to sign in with your Ethereum account:
${v}

${k}`;let O=`URI: ${m}
Version: ${b}
Chain ID: ${t}${a?`
Nonce: ${a}`:""}
Issued At: ${l.toISOString()}`;if(s&&(O+=`
Expiration Time: ${s.toISOString()}`),c&&(O+=`
Not Before: ${c.toISOString()}`),h&&(O+=`
Request ID: ${h}`),d){let R=`
Resources:`;for(const C of d){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);R+=`
- ${C}`}O+=R}return`${_}
${O}`}class St extends Error{constructor({message:e,code:t,cause:n,name:s}){var l;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(l=s??(n instanceof Error?n.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=t}}class xf extends St{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function EN({error:i,options:e}){var t,n,s;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(e.signal instanceof AbortSignal)return new St({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else if(i.name==="ConstraintError"){if(((t=l.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new St({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:i});if(e.mediation==="conditional"&&((n=l.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new St({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:i});if(((s=l.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new St({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:i})}else{if(i.name==="InvalidStateError")return new St({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:i});if(i.name==="NotAllowedError")return new St({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="NotSupportedError")return l.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new St({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:i}):new St({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:i});if(i.name==="SecurityError"){const a=window.location.hostname;if(qO(a)){if(l.rp.id!==a)return new St({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new St({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new St({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:i})}else if(i.name==="UnknownError")return new St({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new St({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}function DN({error:i,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(e.signal instanceof AbortSignal)return new St({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else{if(i.name==="NotAllowedError")return new St({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="SecurityError"){const n=window.location.hostname;if(qO(n)){if(t.rpId!==n)return new St({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new St({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="UnknownError")return new St({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new St({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}class RN{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const MN=new RN;function NN(i){if(!i)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(i);const{challenge:e,user:t,excludeCredentials:n}=i,s=dd(i,["challenge","user","excludeCredentials"]),l=ho(e).buffer,a=Object.assign(Object.assign({},t),{id:ho(t.id).buffer}),c=Object.assign(Object.assign({},s),{challenge:l,user:a});if(n&&n.length>0){c.excludeCredentials=new Array(n.length);for(let h=0;h<n.length;h++){const d=n[h];c.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:ho(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return c}function LN(i){if(!i)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(i);const{challenge:e,allowCredentials:t}=i,n=dd(i,["challenge","allowCredentials"]),s=ho(e).buffer,l=Object.assign(Object.assign({},n),{challenge:s});if(t&&t.length>0){l.allowCredentials=new Array(t.length);for(let a=0;a<t.length;a++){const c=t[a];l.allowCredentials[a]=Object.assign(Object.assign({},c),{id:ho(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return l}function BN(i){var e;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const t=i;return{id:i.id,rawId:i.id,response:{attestationObject:Pr(new Uint8Array(i.response.attestationObject)),clientDataJSON:Pr(new Uint8Array(i.response.clientDataJSON))},type:"public-key",clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function UN(i){var e;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const t=i,n=i.getClientExtensionResults(),s=i.response;return{id:i.id,rawId:i.id,response:{authenticatorData:Pr(new Uint8Array(s.authenticatorData)),clientDataJSON:Pr(new Uint8Array(s.clientDataJSON)),signature:Pr(new Uint8Array(s.signature)),userHandle:s.userHandle?Pr(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function qO(i){return i==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(i)}function Bk(){var i,e;return!!(qt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((i=navigator?.credentials)===null||i===void 0?void 0:i.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function jN(i){try{const e=await navigator.credentials.create(i);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new xf("Browser returned unexpected credential type",e)}:{data:null,error:new xf("Empty credential response",e)}}catch(e){return{data:null,error:EN({error:e,options:i})}}}async function zN(i){try{const e=await navigator.credentials.get(i);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new xf("Browser returned unexpected credential type",e)}:{data:null,error:new xf("Empty credential response",e)}}catch(e){return{data:null,error:DN({error:e,options:i})}}}const IN={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},PN={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function _f(...i){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of i)if(s)for(const l in s){const a=s[l];if(a!==void 0)if(Array.isArray(a))n[l]=a;else if(t(a))n[l]=a;else if(e(a)){const c=n[l];e(c)?n[l]=_f(c,a):n[l]=_f(a)}else n[l]=a}return n}function HN(i,e){return _f(IN,i,e||{})}function qN(i,e){return _f(PN,i,e||{})}class VN{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:s},l){var a;try{const{data:c,error:h}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:h};const d=s??MN.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:p}=c.webauthn.credential_options.publicKey;if(!p.name){const m=n;if(m)p.name=`${p.id}:${m}`;else{const v=(await this.client.getUser()).data.user,w=((a=v?.user_metadata)===null||a===void 0?void 0:a.name)||v?.email||v?.id||"User";p.name=`${p.id}:${w}`}}p.displayName||(p.displayName=p.name)}switch(c.webauthn.type){case"create":{const p=HN(c.webauthn.credential_options.publicKey,l?.create),{data:m,error:b}=await jN({publicKey:p,signal:d});return m?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:m}},error:null}:{data:null,error:b}}case"request":{const p=qN(c.webauthn.credential_options.publicKey,l?.request),{data:m,error:b}=await zN(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:p,signal:d}));return m?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:m}},error:null}:{data:null,error:b}}}}catch(c){return ce(c)?{data:null,error:c}:{data:null,error:new jr("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!t)return{data:null,error:new mc("rpId is required for WebAuthn authentication")};try{if(!Bk())return{data:null,error:new jr("Browser does not support WebAuthn",null)};const{data:a,error:c}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:s},{request:l});if(!a)return{data:null,error:c};const{webauthn:h}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:h.type,rpId:t,rpOrigins:n,credential_response:h.credential_response}})}catch(a){return ce(a)?{data:null,error:a}:{data:null,error:new jr("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},l){if(!t)return{data:null,error:new mc("rpId is required for WebAuthn registration")};try{if(!Bk())return{data:null,error:new jr("Browser does not support WebAuthn",null)};const{data:a,error:c}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(p=>{var m;return(m=p.data)===null||m===void 0?void 0:m.all.find(b=>b.factor_type==="webauthn"&&b.friendly_name===e&&b.status!=="unverified")}).then(p=>p?this.client.mfa.unenroll({factorId:p?.id}):void 0),{data:null,error:c};const{data:h,error:d}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:s},{create:l});return h?this._verify({factorId:a.id,challengeId:h.challengeId,webauthn:{rpId:t,rpOrigins:n,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(a){return ce(a)?{data:null,error:a}:{data:null,error:new jr("Unexpected error in register",a)}}}}ON();const $N={url:PM,storageKey:HM,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:qM,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Uk(i,e,t){return await t()}const Xl={};class yc{get jwks(){var e,t;return(t=(e=Xl[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Xl[this.storageKey]=Object.assign(Object.assign({},Xl[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Xl[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Xl[this.storageKey]=Object.assign(Object.assign({},Xl[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},$N),e);if(this.storageKey=l.storageKey,this.instanceID=(t=yc.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,yc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&qt()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new kN({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=IO(l.fetch),this.lock=l.lock||Uk,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&qt()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=_N:this.lock=Uk,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new VN(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:zO()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Lk(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=Lk(this.memoryStorage)),qt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a);try{await this._notifyAllSubscribers(a.data.event,a.data.session,!1)}catch(c){this._debug("#broadcastChannel","error",c)}})}this.initialize().catch(a=>{this._debug("#initialize()","error",a)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${BO}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},n="none";if(qt()&&(t=iN(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),qt()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:l}=await this._getSessionFromURL(t,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),WM(l)){const h=(e=l.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:a,redirectType:c}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",c),await this._saveSession(a),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ce(t)?this._returnResult({error:t}):this._returnResult({error:new jr("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const l=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:hn}),{data:a,error:c}=l;if(c||!a)return this._returnResult({data:{user:null,session:null},error:c});const h=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(ce(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var t,n,s;try{let l;if("email"in e){const{email:p,password:m,options:b}=e;let v=null,w=null;this.flowType==="pkce"&&([v,w]=await Wl(this.storage,this.storageKey)),l=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b?.emailRedirectTo,body:{email:p,password:m,data:(t=b?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:b?.captchaToken},code_challenge:v,code_challenge_method:w},xform:hn})}else if("phone"in e){const{phone:p,password:m,options:b}=e;l=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:m,data:(n=b?.data)!==null&&n!==void 0?n:{},channel:(s=b?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:hn})}else throw new Rh("You must provide either an email or phone number and a password");const{data:a,error:c}=l;if(c||!a)return await Ht(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const h=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(l){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:a,options:c}=e;t=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:a,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Mk})}else if("phone"in e){const{phone:l,password:a,options:c}=e;t=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:a,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Mk})}else throw new Rh("You must provide either an email or phone number and a password");const{data:n,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const l=new Kl;return this._returnResult({data:{user:null,session:null},error:l})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,s,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,s,l,a,c,h,d,p,m,b;let v,w;if("message"in e)v=e.message,w=e.signature;else{const{chain:k,wallet:_,statement:O,options:R}=e;let C;if(qt())if(typeof _=="object")C=_;else{const se=window;if("ethereum"in se&&typeof se.ethereum=="object"&&"request"in se.ethereum&&typeof se.ethereum.request=="function")C=se.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!R?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=_}const N=new URL((t=R?.url)!==null&&t!==void 0?t:window.location.href),j=await C.request({method:"eth_requestAccounts"}).then(se=>se).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const H=HO(j[0]);let D=(n=R?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!D){const se=await C.request({method:"eth_chainId"});D=AN(se)}const W={domain:N.host,address:H,statement:O,uri:N.href,version:"1",chainId:D,nonce:(s=R?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(a=(l=R?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(c=R?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(h=R?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=R?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(p=R?.signInWithEthereum)===null||p===void 0?void 0:p.resources};v=TN(W),w=await C.request({method:"personal_sign",params:[CN(v),H]})}try{const{data:k,error:_}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:w},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(b=e.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:hn});if(_)throw _;if(!k||!k.session||!k.user){const O=new Kl;return this._returnResult({data:{user:null,session:null},error:O})}return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),this._returnResult({data:Object.assign({},k),error:_})}catch(k){if(ce(k))return this._returnResult({data:{user:null,session:null},error:k});throw k}}async signInWithSolana(e){var t,n,s,l,a,c,h,d,p,m,b,v;let w,k;if("message"in e)w=e.message,k=e.signature;else{const{chain:_,wallet:O,statement:R,options:C}=e;let N;if(qt())if(typeof O=="object")N=O;else{const H=window;if("solana"in H&&typeof H.solana=="object"&&("signIn"in H.solana&&typeof H.solana.signIn=="function"||"signMessage"in H.solana&&typeof H.solana.signMessage=="function"))N=H.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=O}const j=new URL((t=C?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in N&&N.signIn){const H=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),R?{statement:R}:null));let D;if(Array.isArray(H)&&H[0]&&typeof H[0]=="object")D=H[0];else if(H&&typeof H=="object"&&"signedMessage"in H&&"signature"in H)D=H;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)w=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),k=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${j.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...R?["",R,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(s=(n=C?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=C?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((a=C?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((c=C?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((h=C?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((d=C?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((m=(p=C?.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||m===void 0)&&m.length?["Resources",...C.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const H=await N.signMessage(new TextEncoder().encode(w),"utf8");if(!H||!(H instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=H}}try{const{data:_,error:O}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Pr(k)},!((b=e.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:hn});if(O)throw O;if(!_||!_.session||!_.user){const R=new Kl;return this._returnResult({data:{user:null,session:null},error:R})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:O})}catch(_){if(ce(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(e){const t=await Mr(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{if(!n&&this.flowType==="pkce")throw new YM;const{data:l,error:a}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:hn});if(await Ht(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!l||!l.session||!l.user){const c=new Kl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:a})}catch(l){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:l,nonce:a}=e,c=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:l,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:hn}),{data:h,error:d}=c;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!h||!h.session||!h.user){const p=new Kl;return this._returnResult({data:{user:null,session:null},error:p})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:d})}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,s,l,a;try{if("email"in e){const{email:c,options:h}=e;let d=null,p=null;this.flowType==="pkce"&&([d,p]=await Wl(this.storage,this.storageKey));const{error:m}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=h?.data)!==null&&t!==void 0?t:{},create_user:(n=h?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:p},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:c,options:h}=e,{data:d,error:p}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(s=h?.data)!==null&&s!==void 0?s:{},create_user:(l=h?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(a=h?.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:p})}throw new Rh("You must provide either an email or phone number.")}catch(c){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var t,n;try{let s,l;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:c}=await pe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:hn});if(c)throw c;if(!a)throw new Error("An error occurred on token verification.");const h=a.session,d=a.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:d,session:h},error:null})}catch(s){if(ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,n,s,l,a;try{let c=null,h=null;this.flowType==="pkce"&&([c,h]=await Wl(this.storage,this.storageKey));const d=await pe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:h}),headers:this.headers,xform:vN});return!((l=d.data)===null||l===void 0)&&l.url&&qt()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(c){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Mi;const{error:s}=await pe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(ce(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:l}=e,{error:a}=await pe(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:n,type:s,options:l}=e,{data:a,error:c}=await pe(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a?.message_id},error:c})}throw new Rh("You must provide either an email or phone number and a type")}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Mr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<bm:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const a=await Mr(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=Sm()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=gN(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Xs}):await this._useSession(async t=>{var n,s,l;const{data:a,error:c}=t;if(c)throw c;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Mi}:await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:Xs})})}catch(t){if(ce(t))return vm(t)&&(await this._removeSession(),await Ht(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:l}=n;if(l)throw l;if(!s.session)throw new Mi;const a=s.session;let c=null,h=null;this.flowType==="pkce"&&e.email!=null&&([c,h]=await Wl(this.storage,this.storageKey));const{data:d,error:p}=await pe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:h}),jwt:a.access_token,xform:Xs});if(p)throw p;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(n){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Mi;const t=Date.now()/1e3;let n=t,s=!0,l=null;const{payload:a}=Nh(e.access_token);if(a.exp&&(n=a.exp,s=n<=t),s){const{data:c,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!c)return{data:{user:null,session:null},error:null};l=c}else{const{data:c,error:h}=await this._getUser(e.access_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});l={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(t){if(ce(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:a,error:c}=t;if(c)throw c;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new Mi;const{data:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(ce(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!qt())throw new Mh("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Mh(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Ok("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Mh("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ok("No code detected.");const{data:R,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:R.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:l,refresh_token:a,expires_in:c,expires_at:h,token_type:d}=e;if(!l||!c||!a||!d)throw new Mh("No session defined in URL");const p=Math.round(Date.now()/1e3),m=parseInt(c);let b=p+m;h&&(b=parseInt(h));const v=b-p;v*1e3<=eo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${m}s`);const w=b-m;p-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,b,p):p-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,b,p);const{data:k,error:_}=await this._getUser(l);if(_)throw _;const O={provider_token:n,provider_refresh_token:s,access_token:l,expires_in:m,expires_at:b,refresh_token:a,token_type:d,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:O,redirectType:e.type},error:null})}catch(n){if(ce(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Mr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:l}=t;if(l&&!vm(l))return this._returnResult({error:l});const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:c}=await this.admin.signOut(a,e);if(c&&!(KM(c)&&(c.status===404||c.status===401||c.status===403)||vm(c)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await Ht(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=tN(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:l},error:a}=t;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Wl(this.storage,this.storageKey,!0));try{return await pe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:s}=await this._useSession(async l=>{var a,c,h,d,p;const{data:m,error:b}=l;if(b)throw b;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await pe(this.fetch,"GET",v,{headers:this.headers,jwt:(p=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&p!==void 0?p:void 0})});if(s)throw s;return qt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:e.provider,url:n?.url},error:null})}catch(n){if(ce(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:s,data:{session:l}}=t;if(s)throw s;const{options:a,provider:c,token:h,access_token:d,nonce:p}=e,m=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=l?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:c,id_token:h,access_token:d,nonce:p,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:hn}),{data:b,error:v}=m;return v?this._returnResult({data:{user:null,session:null},error:v}):!b||!b.session||!b.user?this._returnResult({data:{user:null,session:null},error:new Kl}):(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("USER_UPDATED",b.session)),this._returnResult({data:b,error:v}))}catch(s){if(await Ht(this.storage,`${this.storageKey}-code-verifier`),ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:l,error:a}=t;if(a)throw a;return await pe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await rN(async s=>(s>0&&await sN(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await pe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:hn})),(s,l)=>{const a=200*Math.pow(2,s);return l&&wm(l)&&Date.now()+a-n<eo})}catch(n){if(this._debug(t,"error",n),ce(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),qt()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Mr(this.storage,this.storageKey);if(s&&this.userStorage){let a=await Mr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await to(this.userStorage,this.storageKey+"-user",a)),s.user=(e=a?.user)!==null&&e!==void 0?e:Sm()}else if(s&&!s.user&&!s.user){const a=await Mr(this.storage,this.storageKey+"-user");a&&a?.user?(s.user=a.user,await Ht(this.storage,this.storageKey+"-user"),await to(this.storage,this.storageKey,s)):s.user=Sm()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const l=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<bm;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${bm}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),wm(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:c}=await this._getUser(s.access_token);!c&&a?.user?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Mi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new md;const{data:l,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!l.session)throw new Mi;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const c={data:l.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(l){if(this._debug(s,"error",l),ce(l)){const a={data:null,error:l};return wm(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],a=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(h){l.push(h)}});if(await Promise.all(a),l.length>0){for(let c=0;c<l.length;c+=1)console.error(l[c]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ht(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await to(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const l=Dk(s);await to(this.storage,this.storageKey,l)}else{const s=Dk(t);await to(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ht(this.storage,this.storageKey),await Ht(this.storage,this.storageKey+"-code-verifier"),await Ht(this.storage,this.storageKey+"-user"),this.userStorage&&await Ht(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&qt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),eo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/eo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${eo}ms, refresh threshold is ${M0} ticks`),s<=M0&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof PO)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,a]=await Wl(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(c.toString())}if(n?.queryParams){const l=new URLSearchParams(n.queryParams);s.push(l.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:l}=t;return l?this._returnResult({data:null,error:l}):await pe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:l,error:a}=t;if(a)return this._returnResult({data:null,error:a});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:d}=await pe(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=l?.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&h.type==="totp"&&(!((s=h?.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:l}=t;if(l)return this._returnResult({data:null,error:l});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?BN(e.webauthn.credential_response):UN(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:h}=await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:h}))})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:l}=t;if(l)return this._returnResult({data:null,error:l});const a=await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:c}=a;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:NN(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:LN(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(l),l.status==="verified"&&s[l.factor_type].push(l);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,n,s,l;if(e)try{const{payload:v}=Nh(e);let w=null;v.aal&&(w=v.aal);let k=w;const{data:{user:_},error:O}=await this.getUser(e);if(O)return this._returnResult({data:null,error:O});((n=(t=_?.factors)===null||t===void 0?void 0:t.filter(N=>N.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(k="aal2");const C=v.amr||[];return{data:{currentLevel:w,nextLevel:k,currentAuthenticationMethods:C},error:null}}catch(v){if(ce(v))return this._returnResult({data:null,error:v});throw v}const{data:{session:a},error:c}=await this.getSession();if(c)return this._returnResult({data:null,error:c});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=Nh(a.access_token);let d=null;h.aal&&(d=h.aal);let p=d;((l=(s=a.user.factors)===null||s===void 0?void 0:s.filter(v=>v.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(p="aal2");const b=h.amr||[];return{data:{currentLevel:d,nextLevel:p,currentAuthenticationMethods:b},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:s}=t;return s?this._returnResult({data:null,error:s}):n?await pe(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Mi})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:s},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new Mi});const a=await pe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return a.data&&a.data.redirect_url&&qt()&&!t?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(n){if(ce(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:s},error:l}=n;if(l)return this._returnResult({data:null,error:l});if(!s)return this._returnResult({data:null,error:new Mi});const a=await pe(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return a.data&&a.data.redirect_url&&qt()&&!t?.skipBrowserRedirect&&window.location.assign(a.data.redirect_url),a})}catch(n){if(ce(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;return n?this._returnResult({data:null,error:n}):t?await pe(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Mi})})}catch(e){if(ce(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:n},error:s}=t;return s?this._returnResult({data:null,error:s}):n?(await pe(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Mi})})}catch(t){if(ce(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(c=>c.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(c=>c.kid===e),n&&this.jwks_cached_at+$M>s)return n;const{data:l,error:a}=await pe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,n=l.keys.find(c=>c.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:v,error:w}=await this.getSession();if(w||!v.session)return this._returnResult({data:null,error:w});n=v.session.access_token}const{header:s,payload:l,signature:a,raw:{header:c,payload:h}}=Nh(n);t?.allowExpired||fN(l.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:l,header:s,signature:a},error:null}}const p=dN(s.alg),m=await crypto.subtle.importKey("jwk",d,p,!0,["verify"]);if(!await crypto.subtle.verify(p,m,a,ZM(`${c}.${h}`)))throw new B0("Invalid JWT signature");return{data:{claims:l,header:s,signature:a},error:null}}catch(n){if(ce(n))return this._returnResult({data:null,error:n});throw n}}}yc.nextInstanceID={};const GN=yc,KN="2.95.2";let Qa="";typeof Deno<"u"?Qa="deno":typeof document<"u"?Qa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Qa="react-native":Qa="node";const WN={"X-Client-Info":`supabase-js-${Qa}/${KN}`},YN={headers:WN},FN={schema:"public"},XN={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},QN={};function bc(i){"@babel/helpers - typeof";return bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bc(i)}function JN(i,e){if(bc(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(bc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function ZN(i){var e=JN(i,"string");return bc(e)=="symbol"?e:e+""}function eL(i,e,t){return(e=ZN(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function jk(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),t.push.apply(t,n)}return t}function ct(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?jk(Object(t),!0).forEach(function(n){eL(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):jk(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}const tL=i=>i?(...e)=>i(...e):(...e)=>fetch(...e),iL=()=>Headers,nL=(i,e,t)=>{const n=tL(t),s=iL();return async(l,a)=>{var c;const h=(c=await e())!==null&&c!==void 0?c:i;let d=new s(a?.headers);return d.has("apikey")||d.set("apikey",i),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),n(l,ct(ct({},a),{},{headers:d}))}};function sL(i){return i.endsWith("/")?i:i+"/"}function rL(i,e){var t,n;const{db:s,auth:l,realtime:a,global:c}=i,{db:h,auth:d,realtime:p,global:m}=e,b={db:ct(ct({},h),s),auth:ct(ct({},d),l),realtime:ct(ct({},p),a),storage:{},global:ct(ct(ct({},m),c),{},{headers:ct(ct({},(t=m?.headers)!==null&&t!==void 0?t:{}),(n=c?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return i.accessToken?b.accessToken=i.accessToken:delete b.accessToken,b}function lL(i){const e=i?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(sL(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var oL=class extends GN{constructor(i){super(i)}},aL=class{constructor(i,e,t){var n,s;this.supabaseUrl=i,this.supabaseKey=e;const l=lL(i);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const a=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:FN,realtime:QN,auth:ct(ct({},XN),{},{storageKey:a}),global:YN},h=rL(t??{},c);if(this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=h.auth)!==null&&d!==void 0?d:{},this.headers,h.global.fetch)}this.fetch=nL(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(ct({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new KR(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch,timeout:h.db.timeout,urlLengthLimit:h.db.urlLengthLimit}),this.storage=new IM(this.storageUrl.href,this.headers,this.fetch,t?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new zR(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(i){return this.rest.from(i)}schema(i){return this.rest.schema(i)}rpc(i,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(i,e,t)}channel(i,e={config:{}}){return this.realtime.channel(i,e)}getChannels(){return this.realtime.getChannels()}removeChannel(i){return this.realtime.removeChannel(i)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var i=this,e,t;if(i.accessToken)return await i.accessToken();const{data:n}=await i.auth.getSession();return(e=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:i.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:i,persistSession:e,detectSessionInUrl:t,storage:n,userStorage:s,storageKey:l,flowType:a,lock:c,debug:h,throwOnError:d},p,m){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new oL({url:this.authUrl.href,headers:ct(ct({},b),p),storageKey:l,autoRefreshToken:i,persistSession:e,detectSessionInUrl:t,storage:n,userStorage:s,flowType:a,lock:c,debug:h,throwOnError:d,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(i){return new cM(this.realtimeUrl.href,ct(ct({},i),{},{params:ct(ct({},{apikey:this.supabaseKey}),i?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((i,e)=>{this._handleTokenChanged(i,"CLIENT",e?.access_token)})}_handleTokenChanged(i,e,t){(i==="TOKEN_REFRESHED"||i==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):i==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const cL=(i,e,t)=>new aL(i,e,t);function uL(){if(typeof window<"u")return!1;const i=globalThis.process;if(!i)return!1;const e=i.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}uL()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const yi=()=>new Map,U0=i=>{const e=yi();return i.forEach((t,n)=>{e.set(n,t)}),e},ws=(i,e,t)=>{let n=i.get(e);return n===void 0&&i.set(e,n=t()),n},hL=(i,e)=>{const t=[];for(const[n,s]of i)t.push(e(s,n));return t},fL=(i,e)=>{for(const[t,n]of i)if(e(n,t))return!0;return!1},Fr=()=>new Set,xm=i=>i[i.length-1],dL=(i,e)=>{for(let t=0;t<e.length;t++)i.push(e[t])},ms=Array.from,Gy=(i,e)=>{for(let t=0;t<i.length;t++)if(!e(i[t],t,i))return!1;return!0},Ky=(i,e)=>{for(let t=0;t<i.length;t++)if(e(i[t],t,i))return!0;return!1},pL=(i,e)=>{const t=new Array(i);for(let n=0;n<i;n++)t[n]=e(n,t);return t},Oo=Array.isArray;class VO{constructor(){this._observers=yi()}on(e,t){return ws(this._observers,e,Fr).add(t),t}once(e,t){const n=(...s)=>{this.off(e,n),t(...s)};this.on(e,n)}off(e,t){const n=this._observers.get(e);n!==void 0&&(n.delete(t),n.size===0&&this._observers.delete(e))}emit(e,t){return ms((this._observers.get(e)||yi()).values()).forEach(n=>n(...t))}destroy(){this._observers=yi()}}class gL{constructor(){this._observers=yi()}on(e,t){ws(this._observers,e,Fr).add(t)}once(e,t){const n=(...s)=>{this.off(e,n),t(...s)};this.on(e,n)}off(e,t){const n=this._observers.get(e);n!==void 0&&(n.delete(t),n.size===0&&this._observers.delete(e))}emit(e,t){return ms((this._observers.get(e)||yi()).values()).forEach(n=>n(...t))}destroy(){this._observers=yi()}}const vn=Math.floor,cf=Math.abs,Wy=(i,e)=>i<e?i:e,ur=(i,e)=>i>e?i:e,$O=i=>i!==0?i<0:1/i<0,zk=1,Ik=2,_m=4,Om=8,vc=32,gs=64,Ii=128,yd=31,j0=63,$r=127,mL=2147483647,Of=Number.MAX_SAFE_INTEGER,Pk=Number.MIN_SAFE_INTEGER,yL=Number.isInteger||(i=>typeof i=="number"&&isFinite(i)&&vn(i)===i),bL=String.fromCharCode,vL=i=>i.toLowerCase(),wL=/^\s*/g,SL=i=>i.replace(wL,""),kL=/([A-Z])/g,Hk=(i,e)=>SL(i.replace(kL,t=>`${e}${vL(t)}`)),xL=i=>{const e=unescape(encodeURIComponent(i)),t=e.length,n=new Uint8Array(t);for(let s=0;s<t;s++)n[s]=e.codePointAt(s);return n},wc=typeof TextEncoder<"u"?new TextEncoder:null,_L=i=>wc.encode(i),OL=wc?_L:xL;let sc=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});sc&&sc.decode(new Uint8Array).length===1&&(sc=null);const AL=(i,e)=>pL(e,()=>i).join("");class Yc{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Fc=()=>new Yc,CL=i=>{let e=i.cpos;for(let t=0;t<i.bufs.length;t++)e+=i.bufs[t].length;return e},gn=i=>{const e=new Uint8Array(CL(i));let t=0;for(let n=0;n<i.bufs.length;n++){const s=i.bufs[n];e.set(s,t),t+=s.length}return e.set(new Uint8Array(i.cbuf.buffer,0,i.cpos),t),e},TL=(i,e)=>{const t=i.cbuf.length;t-i.cpos<e&&(i.bufs.push(new Uint8Array(i.cbuf.buffer,0,i.cpos)),i.cbuf=new Uint8Array(ur(t,e)*2),i.cpos=0)},Mt=(i,e)=>{const t=i.cbuf.length;i.cpos===t&&(i.bufs.push(i.cbuf),i.cbuf=new Uint8Array(t*2),i.cpos=0),i.cbuf[i.cpos++]=e},z0=Mt,Ee=(i,e)=>{for(;e>$r;)Mt(i,Ii|$r&e),e=vn(e/128);Mt(i,$r&e)},Yy=(i,e)=>{const t=$O(e);for(t&&(e=-e),Mt(i,(e>j0?Ii:0)|(t?gs:0)|j0&e),e=vn(e/64);e>0;)Mt(i,(e>$r?Ii:0)|$r&e),e=vn(e/128)},I0=new Uint8Array(3e4),EL=I0.length/3,DL=(i,e)=>{if(e.length<EL){const t=wc.encodeInto(e,I0).written||0;Ee(i,t);for(let n=0;n<t;n++)Mt(i,I0[n])}else Ni(i,OL(e))},RL=(i,e)=>{const t=unescape(encodeURIComponent(e)),n=t.length;Ee(i,n);for(let s=0;s<n;s++)Mt(i,t.codePointAt(s))},Gr=wc&&wc.encodeInto?DL:RL,bd=(i,e)=>{const t=i.cbuf.length,n=i.cpos,s=Wy(t-n,e.length),l=e.length-s;i.cbuf.set(e.subarray(0,s),n),i.cpos+=s,l>0&&(i.bufs.push(i.cbuf),i.cbuf=new Uint8Array(ur(t*2,l)),i.cbuf.set(e.subarray(s)),i.cpos=l)},Ni=(i,e)=>{Ee(i,e.byteLength),bd(i,e)},Fy=(i,e)=>{TL(i,e);const t=new DataView(i.cbuf.buffer,i.cpos,e);return i.cpos+=e,t},ML=(i,e)=>Fy(i,4).setFloat32(0,e,!1),NL=(i,e)=>Fy(i,8).setFloat64(0,e,!1),LL=(i,e)=>Fy(i,8).setBigInt64(0,e,!1),qk=new DataView(new ArrayBuffer(4)),BL=i=>(qk.setFloat32(0,i),qk.getFloat32(0)===i),Sc=(i,e)=>{switch(typeof e){case"string":Mt(i,119),Gr(i,e);break;case"number":yL(e)&&cf(e)<=mL?(Mt(i,125),Yy(i,e)):BL(e)?(Mt(i,124),ML(i,e)):(Mt(i,123),NL(i,e));break;case"bigint":Mt(i,122),LL(i,e);break;case"object":if(e===null)Mt(i,126);else if(Oo(e)){Mt(i,117),Ee(i,e.length);for(let t=0;t<e.length;t++)Sc(i,e[t])}else if(e instanceof Uint8Array)Mt(i,116),Ni(i,e);else{Mt(i,118);const t=Object.keys(e);Ee(i,t.length);for(let n=0;n<t.length;n++){const s=t[n];Gr(i,s),Sc(i,e[s])}}break;case"boolean":Mt(i,e?120:121);break;default:Mt(i,127)}};class Vk extends Yc{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Ee(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const $k=i=>{i.count>0&&(Yy(i.encoder,i.count===1?i.s:-i.s),i.count>1&&Ee(i.encoder,i.count-2))};class uf{constructor(){this.encoder=new Yc,this.s=0,this.count=0}write(e){this.s===e?this.count++:($k(this),this.count=1,this.s=e)}toUint8Array(){return $k(this),gn(this.encoder)}}const Gk=i=>{if(i.count>0){const e=i.diff*2+(i.count===1?0:1);Yy(i.encoder,e),i.count>1&&Ee(i.encoder,i.count-2)}};class Am{constructor(){this.encoder=new Yc,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(Gk(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return Gk(this),gn(this.encoder)}}class UL{constructor(){this.sarr=[],this.s="",this.lensE=new uf}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new Yc;return this.sarr.push(this.s),this.s="",Gr(e,this.sarr.join("")),bd(e,this.lensE.toUint8Array()),gn(e)}}const In=i=>new Error(i),bn=()=>{throw In("Method unimplemented")},Pi=()=>{throw In("Unexpected case")},GO=In("Unexpected end of array"),KO=In("Integer out of Range");class vd{constructor(e){this.arr=e,this.pos=0}}const nl=i=>new vd(i),jL=i=>i.pos!==i.arr.length,zL=(i,e)=>{const t=new Uint8Array(i.arr.buffer,i.pos+i.arr.byteOffset,e);return i.pos+=e,t},Li=i=>zL(i,Ae(i)),Ao=i=>i.arr[i.pos++],Ae=i=>{let e=0,t=1;const n=i.arr.length;for(;i.pos<n;){const s=i.arr[i.pos++];if(e=e+(s&$r)*t,t*=128,s<Ii)return e;if(e>Of)throw KO}throw GO},Xy=i=>{let e=i.arr[i.pos++],t=e&j0,n=64;const s=(e&gs)>0?-1:1;if((e&Ii)===0)return s*t;const l=i.arr.length;for(;i.pos<l;){if(e=i.arr[i.pos++],t=t+(e&$r)*n,n*=128,e<Ii)return s*t;if(t>Of)throw KO}throw GO},IL=i=>{let e=Ae(i);if(e===0)return"";{let t=String.fromCodePoint(Ao(i));if(--e<100)for(;e--;)t+=String.fromCodePoint(Ao(i));else for(;e>0;){const n=e<1e4?e:1e4,s=i.arr.subarray(i.pos,i.pos+n);i.pos+=n,t+=String.fromCodePoint.apply(null,s),e-=n}return decodeURIComponent(escape(t))}},PL=i=>sc.decode(Li(i)),Kr=sc?PL:IL,Qy=(i,e)=>{const t=new DataView(i.arr.buffer,i.arr.byteOffset+i.pos,e);return i.pos+=e,t},HL=i=>Qy(i,4).getFloat32(0,!1),qL=i=>Qy(i,8).getFloat64(0,!1),VL=i=>Qy(i,8).getBigInt64(0,!1),$L=[i=>{},i=>null,Xy,HL,qL,VL,i=>!1,i=>!0,Kr,i=>{const e=Ae(i),t={};for(let n=0;n<e;n++){const s=Kr(i);t[s]=kc(i)}return t},i=>{const e=Ae(i),t=[];for(let n=0;n<e;n++)t.push(kc(i));return t},Li],kc=i=>$L[127-Ao(i)](i);class Kk extends vd{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),jL(this)?this.count=Ae(this)+1:this.count=-1),this.count--,this.s}}class hf extends vd{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=Xy(this);const e=$O(this.s);this.count=1,e&&(this.s=-this.s,this.count=Ae(this)+2)}return this.count--,this.s}}class Cm extends vd{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=Xy(this),t=e&1;this.diff=vn(e/2),this.count=1,t&&(this.count=Ae(this)+2)}return this.s+=this.diff,this.count--,this.s}}class GL{constructor(e){this.decoder=new hf(e),this.str=Kr(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const KL=crypto.getRandomValues.bind(crypto),WO=()=>KL(new Uint32Array(1))[0],WL="10000000-1000-4000-8000"+-1e11,YL=()=>WL.replace(/[018]/g,i=>(i^WO()&15>>i/4).toString(16)),xc=Date.now,Wk=i=>new Promise(i);Promise.all.bind(Promise);const Yk=i=>i===void 0?null:i;class FL{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let YO=new FL,XL=!0;try{typeof localStorage<"u"&&localStorage&&(YO=localStorage,XL=!1)}catch{}const QL=YO,_c=Symbol("Equality"),FO=(i,e)=>i===e||!!i?.[_c]?.(e)||!1,JL=i=>typeof i=="object",ZL=Object.assign,eB=Object.keys,tB=(i,e)=>{for(const t in i)e(i[t],t)},Af=i=>eB(i).length,iB=i=>{for(const e in i)return!1;return!0},Xc=(i,e)=>{for(const t in i)if(!e(i[t],t))return!1;return!0},Jy=(i,e)=>Object.prototype.hasOwnProperty.call(i,e),nB=(i,e)=>i===e||Af(i)===Af(e)&&Xc(i,(t,n)=>(t!==void 0||Jy(e,n))&&FO(e[n],t)),sB=Object.freeze,XO=i=>{for(const e in i){const t=i[e];(typeof t=="object"||typeof t=="function")&&XO(i[e])}return sB(i)},Zy=(i,e,t=0)=>{try{for(;t<i.length;t++)i[t](...e)}finally{t<i.length&&Zy(i,e,t+1)}},rB=i=>i,fo=(i,e)=>{if(i===e)return!0;if(i==null||e==null||i.constructor!==e.constructor&&(i.constructor||Object)!==(e.constructor||Object))return!1;if(i[_c]!=null)return i[_c](e);switch(i.constructor){case ArrayBuffer:i=new Uint8Array(i),e=new Uint8Array(e);case Uint8Array:{if(i.byteLength!==e.byteLength)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;break}case Set:{if(i.size!==e.size)return!1;for(const t of i)if(!e.has(t))return!1;break}case Map:{if(i.size!==e.size)return!1;for(const t of i.keys())if(!e.has(t)||!fo(i.get(t),e.get(t)))return!1;break}case void 0:case Object:if(Af(i)!==Af(e))return!1;for(const t in i)if(!Jy(i,t)||!fo(i[t],e[t]))return!1;break;case Array:if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!fo(i[t],e[t]))return!1;break;default:return!1}return!0},lB=(i,e)=>e.includes(i);var QO={};const Oc=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";let Tn;const oB=()=>{if(Tn===void 0)if(Oc){Tn=yi();const i=process.argv;let e=null;for(let t=0;t<i.length;t++){const n=i[t];n[0]==="-"?(e!==null&&Tn.set(e,""),e=n):e!==null&&(Tn.set(e,n),e=null)}e!==null&&Tn.set(e,"")}else typeof location=="object"?(Tn=yi(),(location.search||"?").slice(1).split("&").forEach(i=>{if(i.length!==0){const[e,t]=i.split("=");Tn.set(`--${Hk(e,"-")}`,t),Tn.set(`-${Hk(e,"-")}`,t)}})):Tn=yi();return Tn},P0=i=>oB().has(i),Cf=i=>Yk(Oc?QO[i.toUpperCase().replaceAll("-","_")]:QL.getItem(i)),JO=i=>P0("--"+i)||Cf(i)!==null,aB=JO("production"),cB=Oc&&lB(QO.FORCE_COLOR,["true","1","2"]),uB=cB||!P0("--no-colors")&&!JO("no-color")&&(!Oc||process.stdout.isTTY)&&(!Oc||P0("--color")||Cf("COLORTERM")!==null||(Cf("TERM")||"").includes("color")),hB=i=>new Uint8Array(i),fB=i=>{const e=hB(i.byteLength);return e.set(i),e};class dB{constructor(e,t){this.left=e,this.right=t}}const Bi=(i,e)=>new dB(i,e),pB=(i,e)=>i.forEach(t=>e(t.left,t.right)),Fk=i=>i.next()>=.5,Tm=(i,e,t)=>vn(i.next()*(t+1-e)+e),ZO=(i,e,t)=>vn(i.next()*(t+1-e)+e),eb=(i,e,t)=>ZO(i,e,t),gB=i=>bL(eb(i,97,122)),mB=(i,e=0,t=20)=>{const n=eb(i,e,t);let s="";for(let l=0;l<n;l++)s+=gB(i);return s},Em=(i,e)=>e[eb(i,0,e.length-1)],yB=Symbol("0schema");class bB{constructor(){this._rerrs=[]}extend(e,t,n,s=null){this._rerrs.push({path:e,expected:t,has:n,message:s})}toString(){const e=[];for(let t=this._rerrs.length-1;t>0;t--){const n=this._rerrs[t];e.push(AL(" ",(this._rerrs.length-t)*2)+`${n.path!=null?`[${n.path}] `:""}${n.has} doesn't match ${n.expected}. ${n.message}`)}return e.join(`
`)}}const H0=(i,e)=>i===e?!0:i==null||e==null||i.constructor!==e.constructor?!1:i[_c]?FO(i,e):Oo(i)?Gy(i,t=>Ky(e,n=>H0(t,n))):JL(i)?Xc(i,(t,n)=>H0(t,e[n])):!1;class ni{static _dilutes=!1;extends(e){let[t,n]=[this.shape,e.shape];return this.constructor._dilutes&&([n,t]=[t,n]),H0(t,n)}equals(e){return this.constructor===e.constructor&&fo(this.shape,e.shape)}[yB](){return!0}[_c](e){return this.equals(e)}validate(e){return this.check(e)}check(e,t){bn()}get nullable(){return qo(this,_d)}get optional(){return new iA(this)}cast(e){return Xk(e,this),e}expect(e){return Xk(e,this),e}}class tb extends ni{constructor(e,t){super(),this.shape=e,this._c=t}check(e,t=void 0){const n=e?.constructor===this.shape&&(this._c==null||this._c(e));return!n&&t?.extend(null,this.shape.name,e?.constructor.name,e?.constructor!==this.shape?"Constructor match failed":"Check failed"),n}}const xt=(i,e=null)=>new tb(i,e);xt(tb);class ib extends ni{constructor(e){super(),this.shape=e}check(e,t){const n=this.shape(e);return!n&&t?.extend(null,"custom prop",e?.constructor.name,"failed to check custom prop"),n}}const Bt=i=>new ib(i);xt(ib);class wd extends ni{constructor(e){super(),this.shape=e}check(e,t){const n=this.shape.some(s=>s===e);return!n&&t?.extend(null,this.shape.join(" | "),e.toString()),n}}const Sd=(...i)=>new wd(i),eA=xt(wd),vB=RegExp.escape||(i=>i.replace(/[().|&,$^[\]]/g,e=>"\\"+e)),tA=i=>{if(Co.check(i))return[vB(i)];if(eA.check(i))return i.shape.map(e=>e+"");if(hA.check(i))return["[+-]?\\d+.?\\d*"];if(fA.check(i))return[".*"];if(Tf.check(i))return i.shape.map(tA).flat(1);Pi()};class wB extends ni{constructor(e){super(),this.shape=e,this._r=new RegExp("^"+e.map(tA).map(t=>`(${t.join("|")})`).join("")+"$")}check(e,t){const n=this._r.exec(e)!=null;return!n&&t?.extend(null,this._r.toString(),e.toString(),"String doesn't match string template."),n}}xt(wB);const SB=Symbol("optional");class iA extends ni{constructor(e){super(),this.shape=e}check(e,t){const n=e===void 0||this.shape.check(e);return!n&&t?.extend(null,"undefined (optional)","()"),n}get[SB](){return!0}}const kB=xt(iA);class xB extends ni{check(e,t){return t?.extend(null,"never",typeof e),!1}}xt(xB);class kd extends ni{constructor(e,t=!1){super(),this.shape=e,this._isPartial=t}static _dilutes=!0;get partial(){return new kd(this.shape,!0)}check(e,t){return e==null?(t?.extend(null,"object","null"),!1):Xc(this.shape,(n,s)=>{const l=this._isPartial&&!Jy(e,s)||n.check(e[s],t);return!l&&t?.extend(s.toString(),n.toString(),typeof e[s],"Object property does not match"),l})}}const _B=i=>new kd(i),OB=xt(kd),AB=Bt(i=>i!=null&&(i.constructor===Object||i.constructor==null));class nA extends ni{constructor(e,t){super(),this.shape={keys:e,values:t}}check(e,t){return e!=null&&Xc(e,(n,s)=>{const l=this.shape.keys.check(s,t);return!l&&t?.extend(s+"","Record",typeof e,l?"Key doesn't match schema":"Value doesn't match value"),l&&this.shape.values.check(n,t)})}}const sA=(i,e)=>new nA(i,e),CB=xt(nA);class rA extends ni{constructor(e){super(),this.shape=e}check(e,t){return e!=null&&Xc(this.shape,(n,s)=>{const l=n.check(e[s],t);return!l&&t?.extend(s.toString(),"Tuple",typeof n),l})}}const TB=(...i)=>new rA(i);xt(rA);class lA extends ni{constructor(e){super(),this.shape=e.length===1?e[0]:new nb(e)}check(e,t){const n=Oo(e)&&Gy(e,s=>this.shape.check(s));return!n&&t?.extend(null,"Array",""),n}}const oA=(...i)=>new lA(i),EB=xt(lA),DB=Bt(i=>Oo(i));class aA extends ni{constructor(e,t){super(),this.shape=e,this._c=t}check(e,t){const n=e instanceof this.shape&&(this._c==null||this._c(e));return!n&&t?.extend(null,this.shape.name,e?.constructor.name),n}}const RB=(i,e=null)=>new aA(i,e);xt(aA);const MB=RB(ni);class NB extends ni{constructor(e){super(),this.len=e.length-1,this.args=TB(...e.slice(-1)),this.res=e[this.len]}check(e,t){const n=e.constructor===Function&&e.length<=this.len;return!n&&t?.extend(null,"function",typeof e),n}}const LB=xt(NB),BB=Bt(i=>typeof i=="function");class UB extends ni{constructor(e){super(),this.shape=e}check(e,t){const n=Gy(this.shape,s=>s.check(e,t));return!n&&t?.extend(null,"Intersectinon",typeof e),n}}xt(UB,i=>i.shape.length>0);class nb extends ni{static _dilutes=!0;constructor(e){super(),this.shape=e}check(e,t){const n=Ky(this.shape,s=>s.check(e,t));return t?.extend(null,"Union",typeof e),n}}const qo=(...i)=>i.findIndex(e=>Tf.check(e))>=0?qo(...i.map(e=>Ac(e)).map(e=>Tf.check(e)?e.shape:[e]).flat(1)):i.length===1?i[0]:new nb(i),Tf=xt(nb),cA=()=>!0,Ef=Bt(cA),jB=xt(ib,i=>i.shape===cA),sb=Bt(i=>typeof i=="bigint"),zB=Bt(i=>i===sb),uA=Bt(i=>typeof i=="symbol");Bt(i=>i===uA);const po=Bt(i=>typeof i=="number"),hA=Bt(i=>i===po),Co=Bt(i=>typeof i=="string"),fA=Bt(i=>i===Co),xd=Bt(i=>typeof i=="boolean"),IB=Bt(i=>i===xd),dA=Sd(void 0);xt(wd,i=>i.shape.length===1&&i.shape[0]===void 0);Sd(void 0);const _d=Sd(null),PB=xt(wd,i=>i.shape.length===1&&i.shape[0]===null);xt(Uint8Array);xt(tb,i=>i.shape===Uint8Array);const HB=qo(po,Co,_d,dA,sb,xd,uA);(()=>{const i=oA(Ef),e=sA(Co,Ef),t=qo(po,Co,_d,xd,i,e);return i.shape=t,e.shape.values=t,t})();const Ac=i=>{if(MB.check(i))return i;if(AB.check(i)){const e={};for(const t in i)e[t]=Ac(i[t]);return _B(e)}else{if(DB.check(i))return qo(...i.map(Ac));if(HB.check(i))return Sd(i);if(BB.check(i))return xt(i)}Pi()},Xk=aB?()=>{}:(i,e)=>{const t=new bB;if(!e.check(i,t))throw In(`Expected value to be of type ${e.constructor.name}.
${t.toString()}`)};class qB{constructor(e){this.patterns=[],this.$state=e}if(e,t){return this.patterns.push({if:Ac(e),h:t}),this}else(e){return this.if(Ef,e)}done(){return(e,t)=>{for(let n=0;n<this.patterns.length;n++){const s=this.patterns[n];if(s.if.check(e))return s.h(e,t)}throw In("Unhandled pattern")}}}const VB=i=>new qB(i),pA=VB(Ef).if(hA,(i,e)=>Tm(e,Pk,Of)).if(fA,(i,e)=>mB(e)).if(IB,(i,e)=>Fk(e)).if(zB,(i,e)=>BigInt(Tm(e,Pk,Of))).if(Tf,(i,e)=>Ql(e,Em(e,i.shape))).if(OB,(i,e)=>{const t={};for(const n in i.shape){let s=i.shape[n];if(kB.check(s)){if(Fk(e))continue;s=s.shape}t[n]=pA(s,e)}return t}).if(EB,(i,e)=>{const t=[],n=ZO(e,0,42);for(let s=0;s<n;s++)t.push(Ql(e,i.shape));return t}).if(eA,(i,e)=>Em(e,i.shape)).if(PB,(i,e)=>null).if(LB,(i,e)=>{const t=Ql(e,i.res);return()=>t}).if(jB,(i,e)=>Ql(e,Em(e,[po,Co,_d,dA,sb,xd,oA(po),sA(qo("a","b","c"),po)]))).if(CB,(i,e)=>{const t={},n=Tm(e,0,3);for(let s=0;s<n;s++){const l=Ql(e,i.shape.keys),a=Ql(e,i.shape.values);t[l]=a}return t}).done(),Ql=(i,e)=>pA(Ac(e),i),Vn=typeof document<"u"?document:{},$B=i=>Vn.createElement(i),GB=()=>Vn.createDocumentFragment();Bt(i=>i.nodeType===e3);const KB=i=>Vn.createTextNode(i);typeof DOMParser<"u"&&new DOMParser;const WB=(i,e)=>(pB(e,(t,n)=>{n===!1?i.removeAttribute(t):n===!0?i.setAttribute(t,""):i.setAttribute(t,n)}),i),YB=i=>{const e=GB();for(let t=0;t<i.length;t++)gA(e,i[t]);return e},FB=(i,e)=>(gA(i,YB(e)),i),Dm=(i,e=[],t=[])=>FB(WB($B(i),e),t);Bt(i=>i.nodeType===QB);const Lh=KB;Bt(i=>i.nodeType===JB);const XB=i=>hL(i,(e,t)=>`${t}:${e};`).join(""),gA=(i,e)=>i.appendChild(e),QB=Vn.ELEMENT_NODE,JB=Vn.TEXT_NODE;Vn.CDATA_SECTION_NODE;Vn.COMMENT_NODE;const ZB=Vn.DOCUMENT_NODE;Vn.DOCUMENT_TYPE_NODE;const e3=Vn.DOCUMENT_FRAGMENT_NODE;Bt(i=>i.nodeType===ZB);const Ss=Symbol,mA=Ss(),yA=Ss(),t3=Ss(),i3=Ss(),n3=Ss(),bA=Ss(),s3=Ss(),rb=Ss(),r3=Ss(),l3=i=>{i.length===1&&i[0]?.constructor===Function&&(i=i[0]());const e=[],t=[];let n=0;for(;n<i.length;n++){const s=i[n];if(s===void 0)break;if(s.constructor===String||s.constructor===Number)e.push(s);else if(s.constructor===Object)break}for(n>0&&t.push(e.join(""));n<i.length;n++){const s=i[n];s instanceof Symbol||t.push(s)}return t},o3={[mA]:Bi("font-weight","bold"),[yA]:Bi("font-weight","normal"),[t3]:Bi("color","blue"),[n3]:Bi("color","green"),[i3]:Bi("color","grey"),[bA]:Bi("color","red"),[s3]:Bi("color","purple"),[rb]:Bi("color","orange"),[r3]:Bi("color","black")},a3=i=>{i.length===1&&i[0]?.constructor===Function&&(i=i[0]());const e=[],t=[],n=yi();let s=[],l=0;for(;l<i.length;l++){const a=i[l],c=o3[a];if(c!==void 0)n.set(c.left,c.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const h=XB(n);l>0||h.length>0?(e.push("%c"+a),t.push(h)):e.push(a)}else break}}for(l>0&&(s=t,s.unshift(e.join("")));l<i.length;l++){const a=i[l];a instanceof Symbol||s.push(a)}return s},vA=uB?a3:l3,c3=(...i)=>{console.log(...vA(i)),SA.forEach(e=>e.print(i))},wA=(...i)=>{console.warn(...vA(i)),i.unshift(rb),SA.forEach(e=>e.print(i))},SA=Fr(),kA=i=>({[Symbol.iterator](){return this},next:i}),u3=(i,e)=>kA(()=>{let t;do t=i.next();while(!t.done&&!e(t.value));return t}),Rm=(i,e)=>kA(()=>{const{done:t,value:n}=i.next();return{done:t,value:t?void 0:e(n)}});class lb{constructor(e,t){this.clock=e,this.len=t}}class Vo{constructor(){this.clients=new Map}}const To=(i,e,t)=>e.clients.forEach((n,s)=>{const l=i.doc.store.clients.get(s);if(l!=null){const a=l[l.length-1],c=a.id.clock+a.length;for(let h=0,d=n[h];h<n.length&&d.clock<c;d=n[++h])zA(i,l,d.clock,d.len,t)}}),h3=(i,e)=>{let t=0,n=i.length-1;for(;t<=n;){const s=vn((t+n)/2),l=i[s],a=l.clock;if(a<=e){if(e<a+l.len)return s;t=s+1}else n=s-1}return null},Qc=(i,e)=>{const t=i.clients.get(e.client);return t!==void 0&&h3(t,e.clock)!==null},ob=i=>{i.clients.forEach(e=>{e.sort((s,l)=>s.clock-l.clock);let t,n;for(t=1,n=1;t<e.length;t++){const s=e[n-1],l=e[t];s.clock+s.len>=l.clock?s.len=ur(s.len,l.clock+l.len-s.clock):(n<t&&(e[n]=l),n++)}e.length=n})},q0=i=>{const e=new Vo;for(let t=0;t<i.length;t++)i[t].clients.forEach((n,s)=>{if(!e.clients.has(s)){const l=n.slice();for(let a=t+1;a<i.length;a++)dL(l,i[a].clients.get(s)||[]);e.clients.set(s,l)}});return ob(e),e},Cc=(i,e,t,n)=>{ws(i.clients,e,()=>[]).push(new lb(t,n))},f3=()=>new Vo,d3=i=>{const e=f3();return i.clients.forEach((t,n)=>{const s=[];for(let l=0;l<t.length;l++){const a=t[l];if(a.deleted){const c=a.id.clock;let h=a.length;if(l+1<t.length)for(let d=t[l+1];l+1<t.length&&d.deleted;d=t[++l+1])h+=d.length;s.push(new lb(c,h))}}s.length>0&&e.clients.set(n,s)}),e},$o=(i,e)=>{Ee(i.restEncoder,e.clients.size),ms(e.clients.entries()).sort((t,n)=>n[0]-t[0]).forEach(([t,n])=>{i.resetDsCurVal(),Ee(i.restEncoder,t);const s=n.length;Ee(i.restEncoder,s);for(let l=0;l<s;l++){const a=n[l];i.writeDsClock(a.clock),i.writeDsLen(a.len)}})},ab=i=>{const e=new Vo,t=Ae(i.restDecoder);for(let n=0;n<t;n++){i.resetDsCurVal();const s=Ae(i.restDecoder),l=Ae(i.restDecoder);if(l>0){const a=ws(e.clients,s,()=>[]);for(let c=0;c<l;c++)a.push(new lb(i.readDsClock(),i.readDsLen()))}}return e},Qk=(i,e,t)=>{const n=new Vo,s=Ae(i.restDecoder);for(let l=0;l<s;l++){i.resetDsCurVal();const a=Ae(i.restDecoder),c=Ae(i.restDecoder),h=t.clients.get(a)||[],d=gt(t,a);for(let p=0;p<c;p++){const m=i.readDsClock(),b=m+i.readDsLen();if(m<d){d<b&&Cc(n,a,d,b-d);let v=Pn(h,m),w=h[v];for(!w.deleted&&w.id.clock<m&&(h.splice(v+1,0,jf(e,w,m-w.id.clock)),v++);v<h.length&&(w=h[v++],w.id.clock<b);)w.deleted||(b<w.id.clock+w.length&&h.splice(v,0,jf(e,w,b-w.id.clock)),w.delete(e))}else Cc(n,a,m,b-m)}}if(n.clients.size>0){const l=new Xr;return Ee(l.restEncoder,0),$o(l,n),l.toUint8Array()}return null},xA=WO;class sl extends VO{constructor({guid:e=YL(),collectionid:t=null,gc:n=!0,gcFilter:s=()=>!0,meta:l=null,autoLoad:a=!1,shouldLoad:c=!0}={}){super(),this.gc=n,this.gcFilter=s,this.clientID=xA(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new UA,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=c,this.autoLoad=a,this.meta=l,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=Wk(d=>{this.on("load",()=>{this.isLoaded=!0,d(this)})});const h=()=>Wk(d=>{const p=m=>{(m===void 0||m===!0)&&(this.off("sync",p),d())};this.on("sync",p)});this.on("sync",d=>{d===!1&&this.isSynced&&(this.whenSynced=h()),this.isSynced=d===void 0||d===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=h()}load(){const e=this._item;e!==null&&!this.shouldLoad&&Qe(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(ms(this.subdocs).map(e=>e.guid))}transact(e,t=null){return Qe(this,e,t)}get(e,t=Lt){const n=ws(this.share,e,()=>{const l=new t;return l._integrate(this,null),l}),s=n.constructor;if(t!==Lt&&s!==t)if(s===Lt){const l=new t;l._map=n._map,n._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=l}),l._start=n._start;for(let a=l._start;a!==null;a=a.right)a.parent=l;return l._length=n._length,this.share.set(e,l),l._integrate(this,null),l}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return n}getArray(e=""){return this.get(e,yo)}getText(e=""){return this.get(e,Ro)}getMap(e=""){return this.get(e,Do)}getXmlElement(e=""){return this.get(e,Mo)}getXmlFragment(e=""){return this.get(e,Qr)}toJSON(){const e={};return this.share.forEach((t,n)=>{e[n]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,ms(this.subdocs).forEach(t=>t.destroy());const e=this._item;if(e!==null){this._item=null;const t=e.content;t.doc=new sl({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,Qe(e.parent.doc,n=>{const s=t.doc;e.deleted||n.subdocsAdded.add(s),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class _A{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Ae(this.restDecoder)}readDsLen(){return Ae(this.restDecoder)}}class OA extends _A{readLeftID(){return xe(Ae(this.restDecoder),Ae(this.restDecoder))}readRightID(){return xe(Ae(this.restDecoder),Ae(this.restDecoder))}readClient(){return Ae(this.restDecoder)}readInfo(){return Ao(this.restDecoder)}readString(){return Kr(this.restDecoder)}readParentInfo(){return Ae(this.restDecoder)===1}readTypeRef(){return Ae(this.restDecoder)}readLen(){return Ae(this.restDecoder)}readAny(){return kc(this.restDecoder)}readBuf(){return fB(Li(this.restDecoder))}readJSON(){return JSON.parse(Kr(this.restDecoder))}readKey(){return Kr(this.restDecoder)}}class p3{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Ae(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Ae(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class Eo extends p3{constructor(e){super(e),this.keys=[],Ae(e),this.keyClockDecoder=new Cm(Li(e)),this.clientDecoder=new hf(Li(e)),this.leftClockDecoder=new Cm(Li(e)),this.rightClockDecoder=new Cm(Li(e)),this.infoDecoder=new Kk(Li(e),Ao),this.stringDecoder=new GL(Li(e)),this.parentInfoDecoder=new Kk(Li(e),Ao),this.typeRefDecoder=new hf(Li(e)),this.lenDecoder=new hf(Li(e))}readLeftID(){return new go(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new go(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return kc(this.restDecoder)}readBuf(){return Li(this.restDecoder)}readJSON(){return kc(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class AA{constructor(){this.restEncoder=Fc()}toUint8Array(){return gn(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Ee(this.restEncoder,e)}writeDsLen(e){Ee(this.restEncoder,e)}}class Jc extends AA{writeLeftID(e){Ee(this.restEncoder,e.client),Ee(this.restEncoder,e.clock)}writeRightID(e){Ee(this.restEncoder,e.client),Ee(this.restEncoder,e.clock)}writeClient(e){Ee(this.restEncoder,e)}writeInfo(e){z0(this.restEncoder,e)}writeString(e){Gr(this.restEncoder,e)}writeParentInfo(e){Ee(this.restEncoder,e?1:0)}writeTypeRef(e){Ee(this.restEncoder,e)}writeLen(e){Ee(this.restEncoder,e)}writeAny(e){Sc(this.restEncoder,e)}writeBuf(e){Ni(this.restEncoder,e)}writeJSON(e){Gr(this.restEncoder,JSON.stringify(e))}writeKey(e){Gr(this.restEncoder,e)}}class CA{constructor(){this.restEncoder=Fc(),this.dsCurrVal=0}toUint8Array(){return gn(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,Ee(this.restEncoder,t)}writeDsLen(e){e===0&&Pi(),Ee(this.restEncoder,e-1),this.dsCurrVal+=e}}class Xr extends CA{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Am,this.clientEncoder=new uf,this.leftClockEncoder=new Am,this.rightClockEncoder=new Am,this.infoEncoder=new Vk(z0),this.stringEncoder=new UL,this.parentInfoEncoder=new Vk(z0),this.typeRefEncoder=new uf,this.lenEncoder=new uf}toUint8Array(){const e=Fc();return Ee(e,0),Ni(e,this.keyClockEncoder.toUint8Array()),Ni(e,this.clientEncoder.toUint8Array()),Ni(e,this.leftClockEncoder.toUint8Array()),Ni(e,this.rightClockEncoder.toUint8Array()),Ni(e,gn(this.infoEncoder)),Ni(e,this.stringEncoder.toUint8Array()),Ni(e,gn(this.parentInfoEncoder)),Ni(e,this.typeRefEncoder.toUint8Array()),Ni(e,this.lenEncoder.toUint8Array()),bd(e,gn(this.restEncoder)),gn(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){Sc(this.restEncoder,e)}writeBuf(e){Ni(this.restEncoder,e)}writeJSON(e){Sc(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const g3=(i,e,t,n)=>{n=ur(n,e[0].id.clock);const s=Pn(e,n);Ee(i.restEncoder,e.length-s),i.writeClient(t),Ee(i.restEncoder,n);const l=e[s];l.write(i,n-l.id.clock);for(let a=s+1;a<e.length;a++)e[a].write(i,0)},cb=(i,e,t)=>{const n=new Map;t.forEach((s,l)=>{gt(e,l)>s&&n.set(l,s)}),Od(e).forEach((s,l)=>{t.has(l)||n.set(l,0)}),Ee(i.restEncoder,n.size),ms(n.entries()).sort((s,l)=>l[0]-s[0]).forEach(([s,l])=>{g3(i,e.clients.get(s),s,l)})},m3=(i,e)=>{const t=yi(),n=Ae(i.restDecoder);for(let s=0;s<n;s++){const l=Ae(i.restDecoder),a=new Array(l),c=i.readClient();let h=Ae(i.restDecoder);t.set(c,{i:0,refs:a});for(let d=0;d<l;d++){const p=i.readInfo();switch(yd&p){case 0:{const m=i.readLen();a[d]=new Ji(xe(c,h),m),h+=m;break}case 10:{const m=Ae(i.restDecoder);a[d]=new Zi(xe(c,h),m),h+=m;break}default:{const m=(p&(gs|Ii))===0,b=new Je(xe(c,h),null,(p&Ii)===Ii?i.readLeftID():null,null,(p&gs)===gs?i.readRightID():null,m?i.readParentInfo()?e.get(i.readString()):i.readLeftID():null,m&&(p&vc)===vc?i.readString():null,rC(i,p));a[d]=b,h+=b.length}}}}return t},y3=(i,e,t)=>{const n=[];let s=ms(t.keys()).sort((v,w)=>v-w);if(s.length===0)return null;const l=()=>{if(s.length===0)return null;let v=t.get(s[s.length-1]);for(;v.refs.length===v.i;)if(s.pop(),s.length>0)v=t.get(s[s.length-1]);else return null;return v};let a=l();if(a===null)return null;const c=new UA,h=new Map,d=(v,w)=>{const k=h.get(v);(k==null||k>w)&&h.set(v,w)};let p=a.refs[a.i++];const m=new Map,b=()=>{for(const v of n){const w=v.id.client,k=t.get(w);k?(k.i--,c.clients.set(w,k.refs.slice(k.i)),t.delete(w),k.i=0,k.refs=[]):c.clients.set(w,[v]),s=s.filter(_=>_!==w)}n.length=0};for(;;){if(p.constructor!==Zi){const w=ws(m,p.id.client,()=>gt(e,p.id.client))-p.id.clock;if(w<0)n.push(p),d(p.id.client,p.id.clock-1),b();else{const k=p.getMissing(i,e);if(k!==null){n.push(p);const _=t.get(k)||{refs:[],i:0};if(_.refs.length===_.i)d(k,gt(e,k)),b();else{p=_.refs[_.i++];continue}}else(w===0||w<p.length)&&(p.integrate(i,w),m.set(p.id.client,p.id.clock+p.length))}}if(n.length>0)p=n.pop();else if(a!==null&&a.i<a.refs.length)p=a.refs[a.i++];else{if(a=l(),a===null)break;p=a.refs[a.i++]}}if(c.clients.size>0){const v=new Xr;return cb(v,c,new Map),Ee(v.restEncoder,0),{missing:h,update:v.toUint8Array()}}return null},b3=(i,e)=>cb(i,e.doc.store,e.beforeState),v3=(i,e,t,n=new Eo(i))=>Qe(e,s=>{s.local=!1;let l=!1;const a=s.doc,c=a.store,h=m3(n,a),d=y3(s,c,h),p=c.pendingStructs;if(p){for(const[b,v]of p.missing)if(v<gt(c,b)){l=!0;break}if(d){for(const[b,v]of d.missing){const w=p.missing.get(b);(w==null||w>v)&&p.missing.set(b,v)}p.update=Rf([p.update,d.update])}}else c.pendingStructs=d;const m=Qk(n,s,c);if(c.pendingDs){const b=new Eo(nl(c.pendingDs));Ae(b.restDecoder);const v=Qk(b,s,c);m&&v?c.pendingDs=Rf([m,v]):c.pendingDs=m||v}else c.pendingDs=m;if(l){const b=c.pendingStructs.update;c.pendingStructs=null,TA(s.doc,b)}},t,!1),TA=(i,e,t,n=Eo)=>{const s=nl(e);v3(s,i,t,new n(s))},EA=(i,e,t)=>TA(i,e,t,OA),w3=(i,e,t=new Map)=>{cb(i,e.store,t),$o(i,d3(e.store))},S3=(i,e=new Uint8Array([0]),t=new Xr)=>{const n=RA(e);w3(t,i,n);const s=[t.toUint8Array()];if(i.store.pendingDs&&s.push(i.store.pendingDs),i.store.pendingStructs&&s.push(I3(i.store.pendingStructs.update,e)),s.length>1){if(t.constructor===Jc)return j3(s.map((l,a)=>a===0?l:H3(l)));if(t.constructor===Xr)return Rf(s)}return s[0]},DA=(i,e)=>S3(i,e,new Jc),k3=i=>{const e=new Map,t=Ae(i.restDecoder);for(let n=0;n<t;n++){const s=Ae(i.restDecoder),l=Ae(i.restDecoder);e.set(s,l)}return e},RA=i=>k3(new _A(nl(i))),MA=(i,e)=>(Ee(i.restEncoder,e.size),ms(e.entries()).sort((t,n)=>n[0]-t[0]).forEach(([t,n])=>{Ee(i.restEncoder,t),Ee(i.restEncoder,n)}),i),x3=(i,e)=>MA(i,Od(e.store)),_3=(i,e=new CA)=>(i instanceof Map?MA(e,i):x3(e,i),e.toUint8Array()),O3=i=>_3(i,new AA);class A3{constructor(){this.l=[]}}const Jk=()=>new A3,Zk=(i,e)=>i.l.push(e),ex=(i,e)=>{const t=i.l,n=t.length;i.l=t.filter(s=>e!==s),n===i.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},NA=(i,e,t)=>Zy(i.l,[e,t]);class go{constructor(e,t){this.client=e,this.clock=t}}const lo=(i,e)=>i===e||i!==null&&e!==null&&i.client===e.client&&i.clock===e.clock,xe=(i,e)=>new go(i,e),LA=i=>{for(const[e,t]of i.doc.share.entries())if(t===i)return e;throw Pi()},Df=(i,e)=>{for(;e!==null;){if(e.parent===i)return!0;e=e.parent._item}return!1};class BA{constructor(e,t,n,s=0){this.type=e,this.tname=t,this.item=n,this.assoc=s}}const tx=i=>{const e={};return i.type&&(e.type=i.type),i.tname&&(e.tname=i.tname),i.item&&(e.item=i.item),i.assoc!=null&&(e.assoc=i.assoc),e},Tc=i=>new BA(i.type==null?null:xe(i.type.client,i.type.clock),i.tname??null,i.item==null?null:xe(i.item.client,i.item.clock),i.assoc==null?0:i.assoc);class C3{constructor(e,t,n=0){this.type=e,this.index=t,this.assoc=n}}const T3=(i,e,t=0)=>new C3(i,e,t),Bh=(i,e,t)=>{let n=null,s=null;return i._item===null?s=LA(i):n=xe(i._item.id.client,i._item.id.clock),new BA(n,s,e,t)},V0=(i,e,t=0)=>{let n=i._start;if(t<0){if(e===0)return Bh(i,null,t);e--}for(;n!==null;){if(!n.deleted&&n.countable){if(n.length>e)return Bh(i,xe(n.id.client,n.id.clock+e),t);e-=n.length}if(n.right===null&&t<0)return Bh(i,n.lastId,t);n=n.right}return Bh(i,null,t)},E3=(i,e)=>{const t=mo(i,e),n=e.clock-t.id.clock;return{item:t,diff:n}},$0=(i,e,t=!0)=>{const n=e.store,s=i.item,l=i.type,a=i.tname,c=i.assoc;let h=null,d=0;if(s!==null){if(gt(n,s.client)<=s.clock)return null;const p=t?Y0(n,s):E3(n,s),m=p.item;if(!(m instanceof Je))return null;if(h=m.parent,h._item===null||!h._item.deleted){d=m.deleted||!m.countable?0:p.diff+(c>=0?0:1);let b=m.left;for(;b!==null;)!b.deleted&&b.countable&&(d+=b.length),b=b.left}}else{if(a!==null)h=e.get(a);else if(l!==null){if(gt(n,l.client)<=l.clock)return null;const{item:p}=t?Y0(n,l):{item:mo(n,l)};if(p instanceof Je&&p.content instanceof $n)h=p.content.type;else return null}else throw Pi();c>=0?d=h._length:d=0}return T3(h,d,i.assoc)},ix=(i,e)=>i===e||i!==null&&e!==null&&i.tname===e.tname&&lo(i.item,e.item)&&lo(i.type,e.type)&&i.assoc===e.assoc,io=(i,e)=>e===void 0?!i.deleted:e.sv.has(i.id.client)&&(e.sv.get(i.id.client)||0)>i.id.clock&&!Qc(e.ds,i.id),G0=(i,e)=>{const t=ws(i.meta,G0,Fr),n=i.doc.store;t.has(e)||(e.sv.forEach((s,l)=>{s<gt(n,l)&&di(i,xe(l,s))}),To(i,e.ds,s=>{}),t.add(e))};class UA{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Od=i=>{const e=new Map;return i.clients.forEach((t,n)=>{const s=t[t.length-1];e.set(n,s.id.clock+s.length)}),e},gt=(i,e)=>{const t=i.clients.get(e);if(t===void 0)return 0;const n=t[t.length-1];return n.id.clock+n.length},jA=(i,e)=>{let t=i.clients.get(e.id.client);if(t===void 0)t=[],i.clients.set(e.id.client,t);else{const n=t[t.length-1];if(n.id.clock+n.length!==e.id.clock)throw Pi()}t.push(e)},Pn=(i,e)=>{let t=0,n=i.length-1,s=i[n],l=s.id.clock;if(l===e)return n;let a=vn(e/(l+s.length-1)*n);for(;t<=n;){if(s=i[a],l=s.id.clock,l<=e){if(e<l+s.length)return a;t=a+1}else n=a-1;a=vn((t+n)/2)}throw Pi()},D3=(i,e)=>{const t=i.clients.get(e.client);return t[Pn(t,e.clock)]},mo=D3,K0=(i,e,t)=>{const n=Pn(e,t),s=e[n];return s.id.clock<t&&s instanceof Je?(e.splice(n+1,0,jf(i,s,t-s.id.clock)),n+1):n},di=(i,e)=>{const t=i.doc.store.clients.get(e.client);return t[K0(i,t,e.clock)]},nx=(i,e,t)=>{const n=e.clients.get(t.client),s=Pn(n,t.clock),l=n[s];return t.clock!==l.id.clock+l.length-1&&l.constructor!==Ji&&n.splice(s+1,0,jf(i,l,t.clock-l.id.clock+1)),l},R3=(i,e,t)=>{const n=i.clients.get(e.id.client);n[Pn(n,e.id.clock)]=t},zA=(i,e,t,n,s)=>{if(n===0)return;const l=t+n;let a=K0(i,e,t),c;do c=e[a++],l<c.id.clock+c.length&&K0(i,e,l),s(c);while(a<e.length&&e[a].id.clock<l)};let M3=class{constructor(e,t,n){this.doc=e,this.deleteSet=new Vo,this.beforeState=Od(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}};const sx=(i,e)=>e.deleteSet.clients.size===0&&!fL(e.afterState,(t,n)=>e.beforeState.get(n)!==t)?!1:(ob(e.deleteSet),b3(i,e),$o(i,e.deleteSet),!0),rx=(i,e,t)=>{const n=e._item;(n===null||n.id.clock<(i.beforeState.get(n.id.client)||0)&&!n.deleted)&&ws(i.changed,e,Fr).add(t)},ff=(i,e)=>{let t=i[e],n=i[e-1],s=e;for(;s>0;t=n,n=i[--s-1]){if(n.deleted===t.deleted&&n.constructor===t.constructor&&n.mergeWith(t)){t instanceof Je&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,n);continue}break}const l=e-s;return l&&i.splice(e+1-l,l),l},N3=(i,e,t)=>{for(const[n,s]of i.clients.entries()){const l=e.clients.get(n);for(let a=s.length-1;a>=0;a--){const c=s[a],h=c.clock+c.len;for(let d=Pn(l,c.clock),p=l[d];d<l.length&&p.id.clock<h;p=l[++d]){const m=l[d];if(c.clock+c.len<=m.id.clock)break;m instanceof Je&&m.deleted&&!m.keep&&t(m)&&m.gc(e,!1)}}}},L3=(i,e)=>{i.clients.forEach((t,n)=>{const s=e.clients.get(n);for(let l=t.length-1;l>=0;l--){const a=t[l],c=Wy(s.length-1,1+Pn(s,a.clock+a.len-1));for(let h=c,d=s[h];h>0&&d.id.clock>=a.clock;d=s[h])h-=1+ff(s,h)}})},IA=(i,e)=>{if(e<i.length){const t=i[e],n=t.doc,s=n.store,l=t.deleteSet,a=t._mergeStructs;try{ob(l),t.afterState=Od(t.doc.store),n.emit("beforeObserverCalls",[t,n]);const c=[];t.changed.forEach((h,d)=>c.push(()=>{(d._item===null||!d._item.deleted)&&d._callObserver(t,h)})),c.push(()=>{t.changedParentTypes.forEach((h,d)=>{d._dEH.l.length>0&&(d._item===null||!d._item.deleted)&&(h=h.filter(p=>p.target._item===null||!p.target._item.deleted),h.forEach(p=>{p.currentTarget=d,p._path=null}),h.sort((p,m)=>p.path.length-m.path.length),c.push(()=>{NA(d._dEH,h,t)}))}),c.push(()=>n.emit("afterTransaction",[t,n])),c.push(()=>{t._needFormattingCleanup&&tU(t)})}),Zy(c,[])}finally{n.gc&&N3(l,s,n.gcFilter),L3(l,s),t.afterState.forEach((p,m)=>{const b=t.beforeState.get(m)||0;if(b!==p){const v=s.clients.get(m),w=ur(Pn(v,b),1);for(let k=v.length-1;k>=w;)k-=1+ff(v,k)}});for(let p=a.length-1;p>=0;p--){const{client:m,clock:b}=a[p].id,v=s.clients.get(m),w=Pn(v,b);w+1<v.length&&ff(v,w+1)>1||w>0&&ff(v,w)}if(!t.local&&t.afterState.get(n.clientID)!==t.beforeState.get(n.clientID)&&(c3(rb,mA,"[yjs] ",yA,bA,"Changed the client-id because another client seems to be using it."),n.clientID=xA()),n.emit("afterTransactionCleanup",[t,n]),n._observers.has("update")){const p=new Jc;sx(p,t)&&n.emit("update",[p.toUint8Array(),t.origin,n,t])}if(n._observers.has("updateV2")){const p=new Xr;sx(p,t)&&n.emit("updateV2",[p.toUint8Array(),t.origin,n,t])}const{subdocsAdded:c,subdocsLoaded:h,subdocsRemoved:d}=t;(c.size>0||d.size>0||h.size>0)&&(c.forEach(p=>{p.clientID=n.clientID,p.collectionid==null&&(p.collectionid=n.collectionid),n.subdocs.add(p)}),d.forEach(p=>n.subdocs.delete(p)),n.emit("subdocs",[{loaded:h,added:c,removed:d},n,t]),d.forEach(p=>p.destroy())),i.length<=e+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,i])):IA(i,e+1)}}},Qe=(i,e,t=null,n=!0)=>{const s=i._transactionCleanups;let l=!1,a=null;i._transaction===null&&(l=!0,i._transaction=new M3(i,t,n),s.push(i._transaction),s.length===1&&i.emit("beforeAllTransactions",[i]),i.emit("beforeTransaction",[i._transaction,i]));try{a=e(i._transaction)}finally{if(l){const c=i._transaction===s[0];i._transaction=null,c&&IA(s,0)}}return a};class B3{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}const lx=(i,e,t)=>{To(i,t.deletions,n=>{n instanceof Je&&e.scope.some(s=>s===i.doc||Df(s,n))&&yb(n,!1)})},ox=(i,e,t)=>{let n=null;const s=i.doc,l=i.scope;Qe(s,c=>{for(;e.length>0&&i.currStackItem===null;){const h=s.store,d=e.pop(),p=new Set,m=[];let b=!1;To(c,d.insertions,v=>{if(v instanceof Je){if(v.redone!==null){let{item:w,diff:k}=Y0(h,v.id);k>0&&(w=di(c,xe(w.id.client,w.id.clock+k))),v=w}!v.deleted&&l.some(w=>w===c.doc||Df(w,v))&&m.push(v)}}),To(c,d.deletions,v=>{v instanceof Je&&l.some(w=>w===c.doc||Df(w,v))&&!Qc(d.insertions,v.id)&&p.add(v)}),p.forEach(v=>{b=sC(c,v,p,d.insertions,i.ignoreRemoteMapChanges,i)!==null||b});for(let v=m.length-1;v>=0;v--){const w=m[v];i.deleteFilter(w)&&(w.delete(c),b=!0)}i.currStackItem=b?d:null}c.changed.forEach((h,d)=>{h.has(null)&&d._searchMarker&&(d._searchMarker.length=0)}),n=c},i);const a=i.currStackItem;if(a!=null){const c=n.changedParentTypes;i.emit("stack-item-popped",[{stackItem:a,type:t,changedParentTypes:c,origin:i},i]),i.currStackItem=null}return a};class PA extends VO{constructor(e,{captureTimeout:t=500,captureTransaction:n=h=>!0,deleteFilter:s=()=>!0,trackedOrigins:l=new Set([null]),ignoreRemoteMapChanges:a=!1,doc:c=Oo(e)?e[0].doc:e instanceof sl?e:e.doc}={}){super(),this.scope=[],this.doc=c,this.addToScope(e),this.deleteFilter=s,l.add(this),this.trackedOrigins=l,this.captureTransaction=n,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=a,this.captureTimeout=t,this.afterTransactionHandler=h=>{if(!this.captureTransaction(h)||!this.scope.some(_=>h.changedParentTypes.has(_)||_===this.doc)||!this.trackedOrigins.has(h.origin)&&(!h.origin||!this.trackedOrigins.has(h.origin.constructor)))return;const d=this.undoing,p=this.redoing,m=d?this.redoStack:this.undoStack;d?this.stopCapturing():p||this.clear(!1,!0);const b=new Vo;h.afterState.forEach((_,O)=>{const R=h.beforeState.get(O)||0,C=_-R;C>0&&Cc(b,O,R,C)});const v=xc();let w=!1;if(this.lastChange>0&&v-this.lastChange<this.captureTimeout&&m.length>0&&!d&&!p){const _=m[m.length-1];_.deletions=q0([_.deletions,h.deleteSet]),_.insertions=q0([_.insertions,b])}else m.push(new B3(h.deleteSet,b)),w=!0;!d&&!p&&(this.lastChange=v),To(h,h.deleteSet,_=>{_ instanceof Je&&this.scope.some(O=>O===h.doc||Df(O,_))&&yb(_,!0)});const k=[{stackItem:m[m.length-1],origin:h.origin,type:d?"redo":"undo",changedParentTypes:h.changedParentTypes},this];w?this.emit("stack-item-added",k):this.emit("stack-item-updated",k)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){const t=new Set(this.scope);e=Oo(e)?e:[e],e.forEach(n=>{t.has(n)||(t.add(n),(n instanceof Lt?n.doc!==this.doc:n!==this.doc)&&wA("[yjs#509] Not same Y.Doc"),this.scope.push(n))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,t=!0){(e&&this.canUndo()||t&&this.canRedo())&&this.doc.transact(n=>{e&&(this.undoStack.forEach(s=>lx(n,this,s)),this.undoStack=[]),t&&(this.redoStack.forEach(s=>lx(n,this,s)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:t}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=ox(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=ox(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*U3(i){const e=Ae(i.restDecoder);for(let t=0;t<e;t++){const n=Ae(i.restDecoder),s=i.readClient();let l=Ae(i.restDecoder);for(let a=0;a<n;a++){const c=i.readInfo();if(c===10){const h=Ae(i.restDecoder);yield new Zi(xe(s,l),h),l+=h}else if((yd&c)!==0){const h=(c&(gs|Ii))===0,d=new Je(xe(s,l),null,(c&Ii)===Ii?i.readLeftID():null,null,(c&gs)===gs?i.readRightID():null,h?i.readParentInfo()?i.readString():i.readLeftID():null,h&&(c&vc)===vc?i.readString():null,rC(i,c));yield d,l+=d.length}else{const h=i.readLen();yield new Ji(xe(s,l),h),l+=h}}}}class ub{constructor(e,t){this.gen=U3(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Zi);return this.curr}}class hb{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const j3=i=>Rf(i,OA,Jc),z3=(i,e)=>{if(i.constructor===Ji){const{client:t,clock:n}=i.id;return new Ji(xe(t,n+e),i.length-e)}else if(i.constructor===Zi){const{client:t,clock:n}=i.id;return new Zi(xe(t,n+e),i.length-e)}else{const t=i,{client:n,clock:s}=t.id;return new Je(xe(n,s+e),null,xe(n,s+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},Rf=(i,e=Eo,t=Xr)=>{if(i.length===1)return i[0];const n=i.map(p=>new e(nl(p)));let s=n.map(p=>new ub(p,!0)),l=null;const a=new t,c=new hb(a);for(;s=s.filter(b=>b.curr!==null),s.sort((b,v)=>{if(b.curr.id.client===v.curr.id.client){const w=b.curr.id.clock-v.curr.id.clock;return w===0?b.curr.constructor===v.curr.constructor?0:b.curr.constructor===Zi?1:-1:w}else return v.curr.id.client-b.curr.id.client}),s.length!==0;){const p=s[0],m=p.curr.id.client;if(l!==null){let b=p.curr,v=!1;for(;b!==null&&b.id.clock+b.length<=l.struct.id.clock+l.struct.length&&b.id.client>=l.struct.id.client;)b=p.next(),v=!0;if(b===null||b.id.client!==m||v&&b.id.clock>l.struct.id.clock+l.struct.length)continue;if(m!==l.struct.id.client)Qs(c,l.struct,l.offset),l={struct:b,offset:0},p.next();else if(l.struct.id.clock+l.struct.length<b.id.clock)if(l.struct.constructor===Zi)l.struct.length=b.id.clock+b.length-l.struct.id.clock;else{Qs(c,l.struct,l.offset);const w=b.id.clock-l.struct.id.clock-l.struct.length;l={struct:new Zi(xe(m,l.struct.id.clock+l.struct.length),w),offset:0}}else{const w=l.struct.id.clock+l.struct.length-b.id.clock;w>0&&(l.struct.constructor===Zi?l.struct.length-=w:b=z3(b,w)),l.struct.mergeWith(b)||(Qs(c,l.struct,l.offset),l={struct:b,offset:0},p.next())}}else l={struct:p.curr,offset:0},p.next();for(let b=p.curr;b!==null&&b.id.client===m&&b.id.clock===l.struct.id.clock+l.struct.length&&b.constructor!==Zi;b=p.next())Qs(c,l.struct,l.offset),l={struct:b,offset:0}}l!==null&&(Qs(c,l.struct,l.offset),l=null),fb(c);const h=n.map(p=>ab(p)),d=q0(h);return $o(a,d),a.toUint8Array()},I3=(i,e,t=Eo,n=Xr)=>{const s=RA(e),l=new n,a=new hb(l),c=new t(nl(i)),h=new ub(c,!1);for(;h.curr;){const p=h.curr,m=p.id.client,b=s.get(m)||0;if(h.curr.constructor===Zi){h.next();continue}if(p.id.clock+p.length>b)for(Qs(a,p,ur(b-p.id.clock,0)),h.next();h.curr&&h.curr.id.client===m;)Qs(a,h.curr,0),h.next();else for(;h.curr&&h.curr.id.client===m&&h.curr.id.clock+h.curr.length<=b;)h.next()}fb(a);const d=ab(c);return $o(l,d),l.toUint8Array()},HA=i=>{i.written>0&&(i.clientStructs.push({written:i.written,restEncoder:gn(i.encoder.restEncoder)}),i.encoder.restEncoder=Fc(),i.written=0)},Qs=(i,e,t)=>{i.written>0&&i.currClient!==e.id.client&&HA(i),i.written===0&&(i.currClient=e.id.client,i.encoder.writeClient(e.id.client),Ee(i.encoder.restEncoder,e.id.clock+t)),e.write(i.encoder,t),i.written++},fb=i=>{HA(i);const e=i.encoder.restEncoder;Ee(e,i.clientStructs.length);for(let t=0;t<i.clientStructs.length;t++){const n=i.clientStructs[t];Ee(e,n.written),bd(e,n.restEncoder)}},P3=(i,e,t,n)=>{const s=new t(nl(i)),l=new ub(s,!1),a=new n,c=new hb(a);for(let d=l.curr;d!==null;d=l.next())Qs(c,e(d),0);fb(c);const h=ab(s);return $o(a,h),a.toUint8Array()},H3=i=>P3(i,rB,Eo,Jc),ax="You must not compute changes after the event-handler fired.";class Ad{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=q3(this.currentTarget,this.target))}deletes(e){return Qc(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw In(ax);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(s=>{if(s!==null){const l=t._map.get(s);let a,c;if(this.adds(l)){let h=l.left;for(;h!==null&&this.adds(h);)h=h.left;if(this.deletes(l))if(h!==null&&this.deletes(h))a="delete",c=xm(h.content.getContent());else return;else h!==null&&this.deletes(h)?(a="update",c=xm(h.content.getContent())):(a="add",c=void 0)}else if(this.deletes(l))a="delete",c=xm(l.content.getContent());else return;e.set(s,{action:a,oldValue:c})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw In(ax);const t=this.target,n=Fr(),s=Fr(),l=[];if(e={added:n,deleted:s,delta:l,keys:this.keys},this.transaction.changed.get(t).has(null)){let c=null;const h=()=>{c&&l.push(c)};for(let d=t._start;d!==null;d=d.right)d.deleted?this.deletes(d)&&!this.adds(d)&&((c===null||c.delete===void 0)&&(h(),c={delete:0}),c.delete+=d.length,s.add(d)):this.adds(d)?((c===null||c.insert===void 0)&&(h(),c={insert:[]}),c.insert=c.insert.concat(d.content.getContent()),n.add(d)):((c===null||c.retain===void 0)&&(h(),c={retain:0}),c.retain+=d.length);c!==null&&c.retain===void 0&&h()}this._changes=e}return e}}const q3=(i,e)=>{const t=[];for(;e._item!==null&&e!==i;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let n=0,s=e._item.parent._start;for(;s!==e._item&&s!==null;)!s.deleted&&s.countable&&(n+=s.length),s=s.right;t.unshift(n)}e=e._item.parent}return t},Xt=()=>{wA("Invalid access: Add Yjs type to a document before reading data.")},qA=80;let db=0;class V3{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=db++}}const $3=i=>{i.timestamp=db++},VA=(i,e,t)=>{i.p.marker=!1,i.p=e,e.marker=!0,i.index=t,i.timestamp=db++},G3=(i,e,t)=>{if(i.length>=qA){const n=i.reduce((s,l)=>s.timestamp<l.timestamp?s:l);return VA(n,e,t),n}else{const n=new V3(e,t);return i.push(n),n}},Cd=(i,e)=>{if(i._start===null||e===0||i._searchMarker===null)return null;const t=i._searchMarker.length===0?null:i._searchMarker.reduce((l,a)=>cf(e-l.index)<cf(e-a.index)?l:a);let n=i._start,s=0;for(t!==null&&(n=t.p,s=t.index,$3(t));n.right!==null&&s<e;){if(!n.deleted&&n.countable){if(e<s+n.length)break;s+=n.length}n=n.right}for(;n.left!==null&&s>e;)n=n.left,!n.deleted&&n.countable&&(s-=n.length);for(;n.left!==null&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)n=n.left,!n.deleted&&n.countable&&(s-=n.length);return t!==null&&cf(t.index-s)<n.parent.length/qA?(VA(t,n,s),t):G3(i._searchMarker,n,s)},Ec=(i,e,t)=>{for(let n=i.length-1;n>=0;n--){const s=i[n];if(t>0){let l=s.p;for(l.marker=!1;l&&(l.deleted||!l.countable);)l=l.left,l&&!l.deleted&&l.countable&&(s.index-=l.length);if(l===null||l.marker===!0){i.splice(n,1);continue}s.p=l,l.marker=!0}(e<s.index||t>0&&e===s.index)&&(s.index=ur(e,s.index+t))}},Td=(i,e,t)=>{const n=i,s=e.changedParentTypes;for(;ws(s,i,()=>[]).push(t),i._item!==null;)i=i._item.parent;NA(n._eH,t,e)};class Lt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Jk(),this._dEH=Jk(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw bn()}clone(){throw bn()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){Zk(this._eH,e)}observeDeep(e){Zk(this._dEH,e)}unobserve(e){ex(this._eH,e)}unobserveDeep(e){ex(this._dEH,e)}toJSON(){}}const $A=(i,e,t)=>{i.doc??Xt(),e<0&&(e=i._length+e),t<0&&(t=i._length+t);let n=t-e;const s=[];let l=i._start;for(;l!==null&&n>0;){if(l.countable&&!l.deleted){const a=l.content.getContent();if(a.length<=e)e-=a.length;else{for(let c=e;c<a.length&&n>0;c++)s.push(a[c]),n--;e=0}}l=l.right}return s},GA=i=>{i.doc??Xt();const e=[];let t=i._start;for(;t!==null;){if(t.countable&&!t.deleted){const n=t.content.getContent();for(let s=0;s<n.length;s++)e.push(n[s])}t=t.right}return e},Dc=(i,e)=>{let t=0,n=i._start;for(i.doc??Xt();n!==null;){if(n.countable&&!n.deleted){const s=n.content.getContent();for(let l=0;l<s.length;l++)e(s[l],t++,i)}n=n.right}},KA=(i,e)=>{const t=[];return Dc(i,(n,s)=>{t.push(e(n,s,i))}),t},K3=i=>{let e=i._start,t=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),n=0,e=e.right}const s=t[n++];return t.length<=n&&(t=null),{done:!1,value:s}}}},WA=(i,e)=>{i.doc??Xt();const t=Cd(i,e);let n=i._start;for(t!==null&&(n=t.p,e-=t.index);n!==null;n=n.right)if(!n.deleted&&n.countable){if(e<n.length)return n.content.getContent()[e];e-=n.length}},Mf=(i,e,t,n)=>{let s=t;const l=i.doc,a=l.clientID,c=l.store,h=t===null?e._start:t.right;let d=[];const p=()=>{d.length>0&&(s=new Je(xe(a,gt(c,a)),s,s&&s.lastId,h,h&&h.id,e,null,new Jr(d)),s.integrate(i,0),d=[])};n.forEach(m=>{if(m===null)d.push(m);else switch(m.constructor){case Number:case Object:case Boolean:case Array:case String:d.push(m);break;default:switch(p(),m.constructor){case Uint8Array:case ArrayBuffer:s=new Je(xe(a,gt(c,a)),s,s&&s.lastId,h,h&&h.id,e,null,new Zc(new Uint8Array(m))),s.integrate(i,0);break;case sl:s=new Je(xe(a,gt(c,a)),s,s&&s.lastId,h,h&&h.id,e,null,new eu(m)),s.integrate(i,0);break;default:if(m instanceof Lt)s=new Je(xe(a,gt(c,a)),s,s&&s.lastId,h,h&&h.id,e,null,new $n(m)),s.integrate(i,0);else throw new Error("Unexpected content type in insert operation")}}}),p()},YA=()=>In("Length exceeded!"),FA=(i,e,t,n)=>{if(t>e._length)throw YA();if(t===0)return e._searchMarker&&Ec(e._searchMarker,t,n.length),Mf(i,e,null,n);const s=t,l=Cd(e,t);let a=e._start;for(l!==null&&(a=l.p,t-=l.index,t===0&&(a=a.prev,t+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(t<=a.length){t<a.length&&di(i,xe(a.id.client,a.id.clock+t));break}t-=a.length}return e._searchMarker&&Ec(e._searchMarker,s,n.length),Mf(i,e,a,n)},W3=(i,e,t)=>{let s=(e._searchMarker||[]).reduce((l,a)=>a.index>l.index?a:l,{index:0,p:e._start}).p;if(s)for(;s.right;)s=s.right;return Mf(i,e,s,t)},XA=(i,e,t,n)=>{if(n===0)return;const s=t,l=n,a=Cd(e,t);let c=e._start;for(a!==null&&(c=a.p,t-=a.index);c!==null&&t>0;c=c.right)!c.deleted&&c.countable&&(t<c.length&&di(i,xe(c.id.client,c.id.clock+t)),t-=c.length);for(;n>0&&c!==null;)c.deleted||(n<c.length&&di(i,xe(c.id.client,c.id.clock+n)),c.delete(i),n-=c.length),c=c.right;if(n>0)throw YA();e._searchMarker&&Ec(e._searchMarker,s,-l+n)},Nf=(i,e,t)=>{const n=e._map.get(t);n!==void 0&&n.delete(i)},pb=(i,e,t,n)=>{const s=e._map.get(t)||null,l=i.doc,a=l.clientID;let c;if(n==null)c=new Jr([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:c=new Jr([n]);break;case Uint8Array:c=new Zc(n);break;case sl:c=new eu(n);break;default:if(n instanceof Lt)c=new $n(n);else throw new Error("Unexpected content type")}new Je(xe(a,gt(l.store,a)),s,s&&s.lastId,null,null,e,t,c).integrate(i,0)},gb=(i,e)=>{i.doc??Xt();const t=i._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},QA=i=>{const e={};return i.doc??Xt(),i._map.forEach((t,n)=>{t.deleted||(e[n]=t.content.getContent()[t.length-1])}),e},JA=(i,e)=>{i.doc??Xt();const t=i._map.get(e);return t!==void 0&&!t.deleted},Y3=(i,e)=>{const t={};return i._map.forEach((n,s)=>{let l=n;for(;l!==null&&(!e.sv.has(l.id.client)||l.id.clock>=(e.sv.get(l.id.client)||0));)l=l.left;l!==null&&io(l,e)&&(t[s]=l.content.getContent()[l.length-1])}),t},Uh=i=>(i.doc??Xt(),u3(i._map.entries(),e=>!e[1].deleted));class F3 extends Ad{}class yo extends Lt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new yo;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new yo}clone(){const e=new yo;return e.insert(0,this.toArray().map(t=>t instanceof Lt?t.clone():t)),e}get length(){return this.doc??Xt(),this._length}_callObserver(e,t){super._callObserver(e,t),Td(this,e,new F3(this,e))}insert(e,t){this.doc!==null?Qe(this.doc,n=>{FA(n,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?Qe(this.doc,t=>{W3(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?Qe(this.doc,n=>{XA(n,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return WA(this,e)}toArray(){return GA(this)}slice(e=0,t=this.length){return $A(this,e,t)}toJSON(){return this.map(e=>e instanceof Lt?e.toJSON():e)}map(e){return KA(this,e)}forEach(e){Dc(this,e)}[Symbol.iterator](){return K3(this)}_write(e){e.writeTypeRef(wU)}}const X3=i=>new yo;class Q3 extends Ad{constructor(e,t,n){super(e,t),this.keysChanged=n}}class Do extends Lt{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((n,s)=>{this.set(s,n)}),this._prelimContent=null}_copy(){return new Do}clone(){const e=new Do;return this.forEach((t,n)=>{e.set(n,t instanceof Lt?t.clone():t)}),e}_callObserver(e,t){Td(this,e,new Q3(this,e,t))}toJSON(){this.doc??Xt();const e={};return this._map.forEach((t,n)=>{if(!t.deleted){const s=t.content.getContent()[t.length-1];e[n]=s instanceof Lt?s.toJSON():s}}),e}get size(){return[...Uh(this)].length}keys(){return Rm(Uh(this),e=>e[0])}values(){return Rm(Uh(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return Rm(Uh(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??Xt(),this._map.forEach((t,n)=>{t.deleted||e(t.content.getContent()[t.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Qe(this.doc,t=>{Nf(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?Qe(this.doc,n=>{pb(n,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return gb(this,e)}has(e){return JA(this,e)}clear(){this.doc!==null?Qe(this.doc,e=>{this.forEach(function(t,n,s){Nf(e,s,n)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(SU)}}const J3=i=>new Do,Zs=(i,e)=>i===e||typeof i=="object"&&typeof e=="object"&&i&&e&&nB(i,e);class W0{constructor(e,t,n,s){this.left=e,this.right=t,this.index=n,this.currentAttributes=s}forward(){this.right===null&&Pi(),this.right.content.constructor===Et?this.right.deleted||Go(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}const cx=(i,e,t)=>{for(;e.right!==null&&t>0;)e.right.content.constructor===Et?e.right.deleted||Go(e.currentAttributes,e.right.content):e.right.deleted||(t<e.right.length&&di(i,xe(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length),e.left=e.right,e.right=e.right.right;return e},jh=(i,e,t,n)=>{const s=new Map,l=n?Cd(e,t):null;if(l){const a=new W0(l.p.left,l.p,l.index,s);return cx(i,a,t-l.index)}else{const a=new W0(null,e._start,0,s);return cx(i,a,t)}},ZA=(i,e,t,n)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===Et&&Zs(n.get(t.right.content.key),t.right.content.value));)t.right.deleted||n.delete(t.right.content.key),t.forward();const s=i.doc,l=s.clientID;n.forEach((a,c)=>{const h=t.left,d=t.right,p=new Je(xe(l,gt(s.store,l)),h,h&&h.lastId,d,d&&d.id,e,null,new Et(c,a));p.integrate(i,0),t.right=p,t.forward()})},Go=(i,e)=>{const{key:t,value:n}=e;n===null?i.delete(t):i.set(t,n)},eC=(i,e)=>{for(;i.right!==null;){if(!(i.right.deleted||i.right.content.constructor===Et&&Zs(e[i.right.content.key]??null,i.right.content.value)))break;i.forward()}},tC=(i,e,t,n)=>{const s=i.doc,l=s.clientID,a=new Map;for(const c in n){const h=n[c],d=t.currentAttributes.get(c)??null;if(!Zs(d,h)){a.set(c,d);const{left:p,right:m}=t;t.right=new Je(xe(l,gt(s.store,l)),p,p&&p.lastId,m,m&&m.id,e,null,new Et(c,h)),t.right.integrate(i,0),t.forward()}}return a},Mm=(i,e,t,n,s)=>{t.currentAttributes.forEach((b,v)=>{s[v]===void 0&&(s[v]=null)});const l=i.doc,a=l.clientID;eC(t,s);const c=tC(i,e,t,s),h=n.constructor===String?new Hn(n):n instanceof Lt?new $n(n):new rl(n);let{left:d,right:p,index:m}=t;e._searchMarker&&Ec(e._searchMarker,t.index,h.getLength()),p=new Je(xe(a,gt(l.store,a)),d,d&&d.lastId,p,p&&p.id,e,null,h),p.integrate(i,0),t.right=p,t.index=m,t.forward(),ZA(i,e,t,c)},ux=(i,e,t,n,s)=>{const l=i.doc,a=l.clientID;eC(t,s);const c=tC(i,e,t,s);e:for(;t.right!==null&&(n>0||c.size>0&&(t.right.deleted||t.right.content.constructor===Et));){if(!t.right.deleted)switch(t.right.content.constructor){case Et:{const{key:h,value:d}=t.right.content,p=s[h];if(p!==void 0){if(Zs(p,d))c.delete(h);else{if(n===0)break e;c.set(h,d)}t.right.delete(i)}else t.currentAttributes.set(h,d);break}default:n<t.right.length&&di(i,xe(t.right.id.client,t.right.id.clock+n)),n-=t.right.length;break}t.forward()}if(n>0){let h="";for(;n>0;n--)h+=`
`;t.right=new Je(xe(a,gt(l.store,a)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new Hn(h)),t.right.integrate(i,0),t.forward()}ZA(i,e,t,c)},iC=(i,e,t,n,s)=>{let l=e;const a=yi();for(;l&&(!l.countable||l.deleted);){if(!l.deleted&&l.content.constructor===Et){const d=l.content;a.set(d.key,d)}l=l.right}let c=0,h=!1;for(;e!==l;){if(t===e&&(h=!0),!e.deleted){const d=e.content;if(d.constructor===Et){const{key:p,value:m}=d,b=n.get(p)??null;(a.get(p)!==d||b===m)&&(e.delete(i),c++,!h&&(s.get(p)??null)===m&&b!==m&&(b===null?s.delete(p):s.set(p,b))),!h&&!e.deleted&&Go(s,d)}}e=e.right}return c},Z3=(i,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Et){const n=e.content.key;t.has(n)?e.delete(i):t.add(n)}e=e.left}},eU=i=>{let e=0;return Qe(i.doc,t=>{let n=i._start,s=i._start,l=yi();const a=U0(l);for(;s;)s.deleted===!1&&(s.content.constructor===Et?Go(a,s.content):(e+=iC(t,n,s,l,a),l=U0(a),n=s)),s=s.right}),e},tU=i=>{const e=new Set,t=i.doc;for(const[n,s]of i.afterState.entries()){const l=i.beforeState.get(n)||0;s!==l&&zA(i,t.store.clients.get(n),l,s,a=>{!a.deleted&&a.content.constructor===Et&&a.constructor!==Ji&&e.add(a.parent)})}Qe(t,n=>{To(i,i.deleteSet,s=>{if(s instanceof Ji||!s.parent._hasFormatting||e.has(s.parent))return;const l=s.parent;s.content.constructor===Et?e.add(l):Z3(n,s)});for(const s of e)eU(s)})},hx=(i,e,t)=>{const n=t,s=U0(e.currentAttributes),l=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case $n:case rl:case Hn:t<e.right.length&&di(i,xe(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(i);break}e.forward()}l&&iC(i,l,e.right,s,e.currentAttributes);const a=(e.left||e.right).parent;return a._searchMarker&&Ec(a._searchMarker,e.index,-n+t),e};class iU extends Ad{constructor(e,t,n){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(s=>{s===null?this.childListChanged=!0:this.keysChanged.add(s)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,t=[];Qe(e,n=>{const s=new Map,l=new Map;let a=this.target._start,c=null;const h={};let d="",p=0,m=0;const b=()=>{if(c!==null){let v=null;switch(c){case"delete":m>0&&(v={delete:m}),m=0;break;case"insert":(typeof d=="object"||d.length>0)&&(v={insert:d},s.size>0&&(v.attributes={},s.forEach((w,k)=>{w!==null&&(v.attributes[k]=w)}))),d="";break;case"retain":p>0&&(v={retain:p},iB(h)||(v.attributes=ZL({},h))),p=0;break}v&&t.push(v),c=null}};for(;a!==null;){switch(a.content.constructor){case $n:case rl:this.adds(a)?this.deletes(a)||(b(),c="insert",d=a.content.getContent()[0],b()):this.deletes(a)?(c!=="delete"&&(b(),c="delete"),m+=1):a.deleted||(c!=="retain"&&(b(),c="retain"),p+=1);break;case Hn:this.adds(a)?this.deletes(a)||(c!=="insert"&&(b(),c="insert"),d+=a.content.str):this.deletes(a)?(c!=="delete"&&(b(),c="delete"),m+=a.length):a.deleted||(c!=="retain"&&(b(),c="retain"),p+=a.length);break;case Et:{const{key:v,value:w}=a.content;if(this.adds(a)){if(!this.deletes(a)){const k=s.get(v)??null;Zs(k,w)?w!==null&&a.delete(n):(c==="retain"&&b(),Zs(w,l.get(v)??null)?delete h[v]:h[v]=w)}}else if(this.deletes(a)){l.set(v,w);const k=s.get(v)??null;Zs(k,w)||(c==="retain"&&b(),h[v]=k)}else if(!a.deleted){l.set(v,w);const k=h[v];k!==void 0&&(Zs(k,w)?k!==null&&a.delete(n):(c==="retain"&&b(),w===null?delete h[v]:h[v]=w))}a.deleted||(c==="insert"&&b(),Go(s,a.content));break}}a=a.right}for(b();t.length>0;){const v=t[t.length-1];if(v.retain!==void 0&&v.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}}class Ro extends Lt{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Xt(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(n=>n())}catch(n){console.error(n)}this._pending=null}_copy(){return new Ro}clone(){const e=new Ro;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const n=new iU(this,e,t);Td(this,e,n),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??Xt();let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===Hn&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?Qe(this.doc,n=>{const s=new W0(null,this._start,0,new Map);for(let l=0;l<e.length;l++){const a=e[l];if(a.insert!==void 0){const c=!t&&typeof a.insert=="string"&&l===e.length-1&&s.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof c!="string"||c.length>0)&&Mm(n,this,s,c,a.attributes||{})}else a.retain!==void 0?ux(n,this,s,a.retain,a.attributes||{}):a.delete!==void 0&&hx(n,s,a.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,n){this.doc??Xt();const s=[],l=new Map,a=this.doc;let c="",h=this._start;function d(){if(c.length>0){const m={};let b=!1;l.forEach((w,k)=>{b=!0,m[k]=w});const v={insert:c};b&&(v.attributes=m),s.push(v),c=""}}const p=()=>{for(;h!==null;){if(io(h,e)||t!==void 0&&io(h,t))switch(h.content.constructor){case Hn:{const m=l.get("ychange");e!==void 0&&!io(h,e)?(m===void 0||m.user!==h.id.client||m.type!=="removed")&&(d(),l.set("ychange",n?n("removed",h.id):{type:"removed"})):t!==void 0&&!io(h,t)?(m===void 0||m.user!==h.id.client||m.type!=="added")&&(d(),l.set("ychange",n?n("added",h.id):{type:"added"})):m!==void 0&&(d(),l.delete("ychange")),c+=h.content.str;break}case $n:case rl:{d();const m={insert:h.content.getContent()[0]};if(l.size>0){const b={};m.attributes=b,l.forEach((v,w)=>{b[w]=v})}s.push(m);break}case Et:io(h,e)&&(d(),Go(l,h.content));break}h=h.right}d()};return e||t?Qe(a,m=>{e&&G0(m,e),t&&G0(m,t),p()},"cleanup"):p(),s}insert(e,t,n){if(t.length<=0)return;const s=this.doc;s!==null?Qe(s,l=>{const a=jh(l,this,e,!n);n||(n={},a.currentAttributes.forEach((c,h)=>{n[h]=c})),Mm(l,this,a,t,n)}):this._pending.push(()=>this.insert(e,t,n))}insertEmbed(e,t,n){const s=this.doc;s!==null?Qe(s,l=>{const a=jh(l,this,e,!n);Mm(l,this,a,t,n||{})}):this._pending.push(()=>this.insertEmbed(e,t,n||{}))}delete(e,t){if(t===0)return;const n=this.doc;n!==null?Qe(n,s=>{hx(s,jh(s,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,n){if(t===0)return;const s=this.doc;s!==null?Qe(s,l=>{const a=jh(l,this,e,!1);a.right!==null&&ux(l,this,a,t,n)}):this._pending.push(()=>this.format(e,t,n))}removeAttribute(e){this.doc!==null?Qe(this.doc,t=>{Nf(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?Qe(this.doc,n=>{pb(n,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return gb(this,e)}getAttributes(){return QA(this)}_write(e){e.writeTypeRef(kU)}}const nU=i=>new Ro;class Nm{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??Xt()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===Mo||t.constructor===Qr)&&t._start!==null)e=t._start;else for(;e!==null;){const n=e.next;if(n!==null){e=n;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Qr extends Lt{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Qr}clone(){const e=new Qr;return e.insert(0,this.toArray().map(t=>t instanceof Lt?t.clone():t)),e}get length(){return this.doc??Xt(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new Nm(this,e)}querySelector(e){e=e.toUpperCase();const n=new Nm(this,s=>s.nodeName&&s.nodeName.toUpperCase()===e).next();return n.done?null:n.value}querySelectorAll(e){return e=e.toUpperCase(),ms(new Nm(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){Td(this,e,new lU(this,t,e))}toString(){return KA(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},n){const s=e.createDocumentFragment();return n!==void 0&&n._createAssociation(s,this),Dc(this,l=>{s.insertBefore(l.toDOM(e,t,n),null)}),s}insert(e,t){this.doc!==null?Qe(this.doc,n=>{FA(n,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)Qe(this.doc,n=>{const s=e&&e instanceof Lt?e._item:e;Mf(n,this,s,t)});else{const n=this._prelimContent,s=e===null?0:n.findIndex(l=>l===e)+1;if(s===0&&e!==null)throw In("Reference item not found");n.splice(s,0,...t)}}delete(e,t=1){this.doc!==null?Qe(this.doc,n=>{XA(n,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return GA(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return WA(this,e)}slice(e=0,t=this.length){return $A(this,e,t)}forEach(e){Dc(this,e)}_write(e){e.writeTypeRef(_U)}}const sU=i=>new Qr;class Mo extends Qr{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((n,s)=>{this.setAttribute(s,n)}),this._prelimAttrs=null}_copy(){return new Mo(this.nodeName)}clone(){const e=new Mo(this.nodeName),t=this.getAttributes();return tB(t,(n,s)=>{e.setAttribute(s,n)}),e.insert(0,this.toArray().map(n=>n instanceof Lt?n.clone():n)),e}toString(){const e=this.getAttributes(),t=[],n=[];for(const c in e)n.push(c);n.sort();const s=n.length;for(let c=0;c<s;c++){const h=n[c];t.push(h+'="'+e[h]+'"')}const l=this.nodeName.toLocaleLowerCase(),a=t.length>0?" "+t.join(" "):"";return`<${l}${a}>${super.toString()}</${l}>`}removeAttribute(e){this.doc!==null?Qe(this.doc,t=>{Nf(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?Qe(this.doc,n=>{pb(n,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return gb(this,e)}hasAttribute(e){return JA(this,e)}getAttributes(e){return e?Y3(this,e):QA(this)}toDOM(e=document,t={},n){const s=e.createElement(this.nodeName),l=this.getAttributes();for(const a in l){const c=l[a];typeof c=="string"&&s.setAttribute(a,c)}return Dc(this,a=>{s.appendChild(a.toDOM(e,t,n))}),n!==void 0&&n._createAssociation(s,this),s}_write(e){e.writeTypeRef(xU),e.writeKey(this.nodeName)}}const rU=i=>new Mo(i.readKey());class lU extends Ad{constructor(e,t,n){super(e,n),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(s=>{s===null?this.childListChanged=!0:this.attributesChanged.add(s)})}}class Lf extends Do{constructor(e){super(),this.hookName=e}_copy(){return new Lf(this.hookName)}clone(){const e=new Lf(this.hookName);return this.forEach((t,n)=>{e.set(n,t)}),e}toDOM(e=document,t={},n){const s=t[this.hookName];let l;return s!==void 0?l=s.createDom(this):l=document.createElement(this.hookName),l.setAttribute("data-yjs-hook",this.hookName),n!==void 0&&n._createAssociation(l,this),l}_write(e){e.writeTypeRef(OU),e.writeKey(this.hookName)}}const oU=i=>new Lf(i.readKey());class Bf extends Ro{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new Bf}clone(){const e=new Bf;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,n){const s=e.createTextNode(this.toString());return n!==void 0&&n._createAssociation(s,this),s}toString(){return this.toDelta().map(e=>{const t=[];for(const s in e.attributes){const l=[];for(const a in e.attributes[s])l.push({key:a,value:e.attributes[s][a]});l.sort((a,c)=>a.key<c.key?-1:1),t.push({nodeName:s,attrs:l})}t.sort((s,l)=>s.nodeName<l.nodeName?-1:1);let n="";for(let s=0;s<t.length;s++){const l=t[s];n+=`<${l.nodeName}`;for(let a=0;a<l.attrs.length;a++){const c=l.attrs[a];n+=` ${c.key}="${c.value}"`}n+=">"}n+=e.insert;for(let s=t.length-1;s>=0;s--)n+=`</${t[s].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(AU)}}const aU=i=>new Bf;class mb{constructor(e,t){this.id=e,this.length=t}get deleted(){throw bn()}mergeWith(e){return!1}write(e,t,n){throw bn()}integrate(e,t){throw bn()}}const cU=0;class Ji extends mb{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),jA(e.doc.store,this)}write(e,t){e.writeInfo(cU),e.writeLen(this.length-t)}getMissing(e,t){return null}}class Zc{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Zc(this.content)}splice(e){throw bn()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}const uU=i=>new Zc(i.readBuf());class Rc{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Rc(this.len)}splice(e){const t=new Rc(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){Cc(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const hU=i=>new Rc(i.readLen()),nC=(i,e)=>new sl({guid:i,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class eu{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new eu(nC(this.doc.guid,this.opts))}splice(e){throw bn()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const fU=i=>new eu(nC(i.readString(),i.readAny()));class rl{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new rl(this.embed)}splice(e){throw bn()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}const dU=i=>new rl(i.readJSON());class Et{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Et(this.key,this.value)}splice(e){throw bn()}mergeWith(e){return!1}integrate(e,t){const n=t.parent;n._searchMarker=null,n._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const pU=i=>new Et(i.readKey(),i.readJSON());class Uf{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Uf(this.arr)}splice(e){const t=new Uf(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const n=this.arr.length;e.writeLen(n-t);for(let s=t;s<n;s++){const l=this.arr[s];e.writeString(l===void 0?"undefined":JSON.stringify(l))}}getRef(){return 2}}const gU=i=>{const e=i.readLen(),t=[];for(let n=0;n<e;n++){const s=i.readString();s==="undefined"?t.push(void 0):t.push(JSON.parse(s))}return new Uf(t)},mU=Cf("node_env")==="development";class Jr{constructor(e){this.arr=e,mU&&XO(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Jr(this.arr)}splice(e){const t=new Jr(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const n=this.arr.length;e.writeLen(n-t);for(let s=t;s<n;s++){const l=this.arr[s];e.writeAny(l)}}getRef(){return 8}}const yU=i=>{const e=i.readLen(),t=[];for(let n=0;n<e;n++)t.push(i.readAny());return new Jr(t)};class Hn{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Hn(this.str)}splice(e){const t=new Hn(this.str.slice(e));this.str=this.str.slice(0,e);const n=this.str.charCodeAt(e-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}}const bU=i=>new Hn(i.readString()),vU=[X3,J3,nU,rU,sU,oU,aU],wU=0,SU=1,kU=2,xU=3,_U=4,OU=5,AU=6;class $n{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new $n(this.type._copy())}splice(e){throw bn()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(n=>{n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(n=>{for(;n!==null;)n.gc(e,!0),n=n.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const CU=i=>new $n(vU[i.readTypeRef()](i)),Y0=(i,e)=>{let t=e,n=0,s;do n>0&&(t=xe(t.client,t.clock+n)),s=mo(i,t),n=t.clock-s.id.clock,t=s.redone;while(t!==null&&s instanceof Je);return{item:s,diff:n}},yb=(i,e)=>{for(;i!==null&&i.keep!==e;)i.keep=e,i=i.parent._item},jf=(i,e,t)=>{const{client:n,clock:s}=e.id,l=new Je(xe(n,s+t),e,xe(n,s+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&l.markDeleted(),e.keep&&(l.keep=!0),e.redone!==null&&(l.redone=xe(e.redone.client,e.redone.clock+t)),e.right=l,l.right!==null&&(l.right.left=l),i._mergeStructs.push(l),l.parentSub!==null&&l.right===null&&l.parent._map.set(l.parentSub,l),e.length=t,l},fx=(i,e)=>Ky(i,t=>Qc(t.deletions,e)),sC=(i,e,t,n,s,l)=>{const a=i.doc,c=a.store,h=a.clientID,d=e.redone;if(d!==null)return di(i,d);let p=e.parent._item,m=null,b;if(p!==null&&p.deleted===!0){if(p.redone===null&&(!t.has(p)||sC(i,p,t,n,s,l)===null))return null;for(;p.redone!==null;)p=di(i,p.redone)}const v=p===null?e.parent:p.content.type;if(e.parentSub===null){for(m=e.left,b=e;m!==null;){let O=m;for(;O!==null&&O.parent._item!==p;)O=O.redone===null?null:di(i,O.redone);if(O!==null&&O.parent._item===p){m=O;break}m=m.left}for(;b!==null;){let O=b;for(;O!==null&&O.parent._item!==p;)O=O.redone===null?null:di(i,O.redone);if(O!==null&&O.parent._item===p){b=O;break}b=b.right}}else if(b=null,e.right&&!s){for(m=e;m!==null&&m.right!==null&&(m.right.redone||Qc(n,m.right.id)||fx(l.undoStack,m.right.id)||fx(l.redoStack,m.right.id));)for(m=m.right;m.redone;)m=di(i,m.redone);if(m&&m.right!==null)return null}else m=v._map.get(e.parentSub)||null;const w=gt(c,h),k=xe(h,w),_=new Je(k,m,m&&m.lastId,b,b&&b.id,v,e.parentSub,e.content.copy());return e.redone=k,yb(_,!0),_.integrate(i,0),_};class Je extends mb{constructor(e,t,n,s,l,a,c,h){super(e,h.getLength()),this.origin=n,this.left=t,this.right=s,this.rightOrigin=l,this.parent=a,this.parentSub=c,this.redone=null,this.content=h,this.info=this.content.isCountable()?Ik:0}set marker(e){(this.info&Om)>0!==e&&(this.info^=Om)}get marker(){return(this.info&Om)>0}get keep(){return(this.info&zk)>0}set keep(e){this.keep!==e&&(this.info^=zk)}get countable(){return(this.info&Ik)>0}get deleted(){return(this.info&_m)>0}set deleted(e){this.deleted!==e&&(this.info^=_m)}markDeleted(){this.info|=_m}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=gt(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=gt(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===go&&this.id.client!==this.parent.client&&this.parent.clock>=gt(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=nx(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=di(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Ji||this.right&&this.right.constructor===Ji)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Je?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===Je&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===go){const n=mo(t,this.parent);n.constructor===Ji?this.parent=null:this.parent=n.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=nx(e,e.doc.store,xe(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let n=this.left,s;if(n!==null)s=n.right;else if(this.parentSub!==null)for(s=this.parent._map.get(this.parentSub)||null;s!==null&&s.left!==null;)s=s.left;else s=this.parent._start;const l=new Set,a=new Set;for(;s!==null&&s!==this.right;){if(a.add(s),l.add(s),lo(this.origin,s.origin)){if(s.id.client<this.id.client)n=s,l.clear();else if(lo(this.rightOrigin,s.rightOrigin))break}else if(s.origin!==null&&a.has(mo(e.doc.store,s.origin)))l.has(mo(e.doc.store,s.origin))||(n=s,l.clear());else break;s=s.right}this.left=n}if(this.left!==null){const n=this.left.right;this.right=n,this.left.right=this}else{let n;if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start,this.parent._start=this;this.right=n}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),jA(e.doc.store,this),this.content.integrate(e,this),rx(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new Ji(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:xe(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&lo(e.origin,this.lastId)&&this.right===e&&lo(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(n=>{n.p===e&&(n.p=this,!this.deleted&&this.countable&&(n.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),Cc(e.deleteSet,this.id.client,this.id.clock,this.length),rx(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw Pi();this.content.gc(e),t?R3(e,this,new Ji(this.id,this.length)):this.content=new Rc(this.length)}write(e,t){const n=t>0?xe(this.id.client,this.id.clock+t-1):this.origin,s=this.rightOrigin,l=this.parentSub,a=this.content.getRef()&yd|(n===null?0:Ii)|(s===null?0:gs)|(l===null?0:vc);if(e.writeInfo(a),n!==null&&e.writeLeftID(n),s!==null&&e.writeRightID(s),n===null&&s===null){const c=this.parent;if(c._item!==void 0){const h=c._item;if(h===null){const d=LA(c);e.writeParentInfo(!0),e.writeString(d)}else e.writeParentInfo(!1),e.writeLeftID(h.id)}else c.constructor===String?(e.writeParentInfo(!0),e.writeString(c)):c.constructor===go?(e.writeParentInfo(!1),e.writeLeftID(c)):Pi();l!==null&&e.writeString(l)}this.content.write(e,t)}}const rC=(i,e)=>TU[e&yd](i),TU=[()=>{Pi()},hU,gU,uU,bU,dU,pU,CU,yU,fU,()=>{Pi()}],EU=10;class Zi extends mb{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){Pi()}write(e,t){e.writeInfo(EU),Ee(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const lC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},oC="__ $YJS$ __";lC[oC]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");lC[oC]=!0;let F0=[],aC=[];(()=>{let i="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<i.length;e++)(e%2?aC:F0).push(t=t+i[e])})();function DU(i){if(i<768)return!1;for(let e=0,t=F0.length;;){let n=e+t>>1;if(i<F0[n])t=n;else if(i>=aC[n])e=n+1;else return!0;if(e==t)return!1}}function dx(i){return i>=127462&&i<=127487}const px=8205;function RU(i,e,t=!0,n=!0){return(t?cC:MU)(i,e,n)}function cC(i,e,t){if(e==i.length)return e;e&&uC(i.charCodeAt(e))&&hC(i.charCodeAt(e-1))&&e--;let n=Lm(i,e);for(e+=gx(n);e<i.length;){let s=Lm(i,e);if(n==px||s==px||t&&DU(s))e+=gx(s),n=s;else if(dx(s)){let l=0,a=e-2;for(;a>=0&&dx(Lm(i,a));)l++,a-=2;if(l%2==0)break;e+=2}else break}return e}function MU(i,e,t){for(;e>0;){let n=cC(i,e-2,t);if(n<e)return n;e--}return 0}function Lm(i,e){let t=i.charCodeAt(e);if(!hC(t)||e+1==i.length)return t;let n=i.charCodeAt(e+1);return uC(n)?(t-55296<<10)+(n-56320)+65536:t}function uC(i){return i>=56320&&i<57344}function hC(i){return i>=55296&&i<56320}function gx(i){return i<65536?1:2}class He{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=No(this,e,t);let s=[];return this.decompose(0,e,s,2),n.length&&n.decompose(0,n.length,s,3),this.decompose(t,this.length,s,1),Nn.from(s,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=No(this,e,t);let n=[];return this.decompose(e,t,n,0),Nn.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),s=new rc(this),l=new rc(e);for(let a=t,c=t;;){if(s.next(a),l.next(a),a=0,s.lineBreak!=l.lineBreak||s.done!=l.done||s.value!=l.value)return!1;if(c+=s.value.length,s.done||c>=n)return!0}}iter(e=1){return new rc(this,e)}iterRange(e,t=this.length){return new fC(this,e,t)}iterLines(e,t){let n;if(e==null)n=this.iter();else{t==null&&(t=this.lines+1);let s=this.line(e).from;n=this.iterRange(s,Math.max(s,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new dC(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?He.empty:e.length<=32?new pt(e):Nn.from(pt.split(e,[]))}}class pt extends He{constructor(e,t=NU(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,s){for(let l=0;;l++){let a=this.text[l],c=s+a.length;if((t?n:c)>=e)return new LU(s,c,n,a);s=c+1,n++}}decompose(e,t,n,s){let l=e<=0&&t>=this.length?this:new pt(mx(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(s&1){let a=n.pop(),c=df(l.text,a.text.slice(),0,l.length);if(c.length<=32)n.push(new pt(c,a.length+l.length));else{let h=c.length>>1;n.push(new pt(c.slice(0,h)),new pt(c.slice(h)))}}else n.push(l)}replace(e,t,n){if(!(n instanceof pt))return super.replace(e,t,n);[e,t]=No(this,e,t);let s=df(this.text,df(n.text,mx(this.text,0,e)),t),l=this.length+n.length-(t-e);return s.length<=32?new pt(s,l):Nn.from(pt.split(s,[]),l)}sliceString(e,t=this.length,n=`
`){[e,t]=No(this,e,t);let s="";for(let l=0,a=0;l<=t&&a<this.text.length;a++){let c=this.text[a],h=l+c.length;l>e&&a&&(s+=n),e<h&&t>l&&(s+=c.slice(Math.max(0,e-l),t-l)),l=h+1}return s}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],s=-1;for(let l of e)n.push(l),s+=l.length+1,n.length==32&&(t.push(new pt(n,s)),n=[],s=-1);return s>-1&&t.push(new pt(n,s)),t}}class Nn extends He{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,t,n,s){for(let l=0;;l++){let a=this.children[l],c=s+a.length,h=n+a.lines-1;if((t?h:c)>=e)return a.lineInner(e,t,n,s);s=c+1,n=h+1}}decompose(e,t,n,s){for(let l=0,a=0;a<=t&&l<this.children.length;l++){let c=this.children[l],h=a+c.length;if(e<=h&&t>=a){let d=s&((a<=e?1:0)|(h>=t?2:0));a>=e&&h<=t&&!d?n.push(c):c.decompose(e-a,t-a,n,d)}a=h+1}}replace(e,t,n){if([e,t]=No(this,e,t),n.lines<this.lines)for(let s=0,l=0;s<this.children.length;s++){let a=this.children[s],c=l+a.length;if(e>=l&&t<=c){let h=a.replace(e-l,t-l,n),d=this.lines-a.lines+h.lines;if(h.lines<d>>4&&h.lines>d>>6){let p=this.children.slice();return p[s]=h,new Nn(p,this.length-(t-e)+n.length)}return super.replace(l,c,h)}l=c+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n=`
`){[e,t]=No(this,e,t);let s="";for(let l=0,a=0;l<this.children.length&&a<=t;l++){let c=this.children[l],h=a+c.length;a>e&&l&&(s+=n),e<h&&t>a&&(s+=c.sliceString(e-a,t-a,n)),a=h+1}return s}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Nn))return 0;let n=0,[s,l,a,c]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=t,l+=t){if(s==a||l==c)return n;let h=this.children[s],d=e.children[l];if(h!=d)return n+h.scanIdentical(d,t);n+=h.length+1}}static from(e,t=e.reduce((n,s)=>n+s.length+1,-1)){let n=0;for(let v of e)n+=v.lines;if(n<32){let v=[];for(let w of e)w.flatten(v);return new pt(v,t)}let s=Math.max(32,n>>5),l=s<<1,a=s>>1,c=[],h=0,d=-1,p=[];function m(v){let w;if(v.lines>l&&v instanceof Nn)for(let k of v.children)m(k);else v.lines>a&&(h>a||!h)?(b(),c.push(v)):v instanceof pt&&h&&(w=p[p.length-1])instanceof pt&&v.lines+w.lines<=32?(h+=v.lines,d+=v.length+1,p[p.length-1]=new pt(w.text.concat(v.text),w.length+1+v.length)):(h+v.lines>s&&b(),h+=v.lines,d+=v.length+1,p.push(v))}function b(){h!=0&&(c.push(p.length==1?p[0]:Nn.from(p,d)),d=-1,h=p.length=0)}for(let v of e)m(v);return b(),c.length==1?c[0]:new Nn(c,t)}}He.empty=new pt([""],0);function NU(i){let e=-1;for(let t of i)e+=t.length+1;return e}function df(i,e,t=0,n=1e9){for(let s=0,l=0,a=!0;l<i.length&&s<=n;l++){let c=i[l],h=s+c.length;h>=t&&(h>n&&(c=c.slice(0,n-s)),s<t&&(c=c.slice(t-s)),a?(e[e.length-1]+=c,a=!1):e.push(c)),s=h+1}return e}function mx(i,e,t){return df(i,[""],e,t)}class rc{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof pt?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,s=this.nodes[n],l=this.offsets[n],a=l>>1,c=s instanceof pt?s.text.length:s.children.length;if(a==(t>0?c:0)){if(n==0)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((l&1)==(t>0?0:1)){if(this.offsets[n]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof pt){let h=s.text[a+(t<0?-1:0)];if(this.offsets[n]+=t,h.length>Math.max(0,e))return this.value=e==0?h:t>0?h.slice(e):h.slice(0,h.length-e),this;e-=h.length}else{let h=s.children[a+(t<0?-1:0)];e>h.length?(e-=h.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(h),this.offsets.push(t>0?1:(h instanceof pt?h.text.length:h.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class fC{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new rc(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*t,this.value=s.length<=n?s:t<0?s.slice(s.length-n):s.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class dC{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:s}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(He.prototype[Symbol.iterator]=function(){return this.iter()},rc.prototype[Symbol.iterator]=fC.prototype[Symbol.iterator]=dC.prototype[Symbol.iterator]=function(){return this});class LU{constructor(e,t,n,s){this.from=e,this.to=t,this.number=n,this.text=s}get length(){return this.to-this.from}}function No(i,e,t){return e=Math.max(0,Math.min(i.length,e)),[e,Math.max(e,Math.min(i.length,t))]}function Ct(i,e,t=!0,n=!0){return RU(i,e,t,n)}function BU(i){return i>=56320&&i<57344}function UU(i){return i>=55296&&i<56320}function hi(i,e){let t=i.charCodeAt(e);if(!UU(t)||e+1==i.length)return t;let n=i.charCodeAt(e+1);return BU(n)?(t-55296<<10)+(n-56320)+65536:t}function bb(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}function Ln(i){return i<65536?1:2}const X0=/\r\n?|\n/;var ti=(function(i){return i[i.Simple=0]="Simple",i[i.TrackDel=1]="TrackDel",i[i.TrackBefore=2]="TrackBefore",i[i.TrackAfter=3]="TrackAfter",i})(ti||(ti={}));class zn{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,s=0;t<this.sections.length;){let l=this.sections[t++],a=this.sections[t++];a<0?(e(n,s,l),s+=l):s+=a,n+=l}}iterChangedRanges(e,t=!1){Q0(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],s=this.sections[t++];s<0?e.push(n,s):e.push(s,n)}return new zn(e)}composeDesc(e){return this.empty?e:e.empty?this:pC(this,e)}mapDesc(e,t=!1){return e.empty?this:J0(this,e,t)}mapPos(e,t=-1,n=ti.Simple){let s=0,l=0;for(let a=0;a<this.sections.length;){let c=this.sections[a++],h=this.sections[a++],d=s+c;if(h<0){if(d>e)return l+(e-s);l+=c}else{if(n!=ti.Simple&&d>=e&&(n==ti.TrackDel&&s<e&&d>e||n==ti.TrackBefore&&s<e||n==ti.TrackAfter&&d>e))return null;if(d>e||d==e&&t<0&&!c)return e==s||t<0?l:l+h;l+=h}s=d}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return l}touchesRange(e,t=e){for(let n=0,s=0;n<this.sections.length&&s<=t;){let l=this.sections[n++],a=this.sections[n++],c=s+l;if(a>=0&&s<=t&&c>=e)return s<e&&c>t?"cover":!0;s=c}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],s=this.sections[t++];e+=(e?" ":"")+n+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new zn(e)}static create(e){return new zn(e)}}class At extends zn{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Q0(this,(t,n,s,l,a)=>e=e.replace(s,s+(n-t),a),!1),e}mapDesc(e,t=!1){return J0(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let s=0,l=0;s<t.length;s+=2){let a=t[s],c=t[s+1];if(c>=0){t[s]=c,t[s+1]=a;let h=s>>1;for(;n.length<h;)n.push(He.empty);n.push(a?e.slice(l,l+a):He.empty)}l+=a}return new At(t,n)}compose(e){return this.empty?e:e.empty?this:pC(this,e,!0)}map(e,t=!1){return e.empty?this:J0(this,e,t,!0)}iterChanges(e,t=!1){Q0(this,e,t)}get desc(){return zn.create(this.sections)}filter(e){let t=[],n=[],s=[],l=new Mc(this);e:for(let a=0,c=0;;){let h=a==e.length?1e9:e[a++];for(;c<h||c==h&&l.len==0;){if(l.done)break e;let p=Math.min(l.len,h-c);Ft(s,p,-1);let m=l.ins==-1?-1:l.off==0?l.ins:0;Ft(t,p,m),m>0&&er(n,t,l.text),l.forward(p),c+=p}let d=e[a++];for(;c<d;){if(l.done)break e;let p=Math.min(l.len,d-c);Ft(t,p,-1),Ft(s,p,l.ins==-1?-1:l.off==0?l.ins:0),l.forward(p),c+=p}}return{changes:new At(t,n),filtered:zn.create(s)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],s=this.sections[t+1];s<0?e.push(n):s==0?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let s=[],l=[],a=0,c=null;function h(p=!1){if(!p&&!s.length)return;a<t&&Ft(s,t-a,-1);let m=new At(s,l);c=c?c.compose(m.map(c)):m,s=[],l=[],a=0}function d(p){if(Array.isArray(p))for(let m of p)d(m);else if(p instanceof At){if(p.length!=t)throw new RangeError(`Mismatched change set length (got ${p.length}, expected ${t})`);h(),c=c?c.compose(p.map(c)):p}else{let{from:m,to:b=m,insert:v}=p;if(m>b||m<0||b>t)throw new RangeError(`Invalid change range ${m} to ${b} (in doc of length ${t})`);let w=v?typeof v=="string"?He.of(v.split(n||X0)):v:He.empty,k=w.length;if(m==b&&k==0)return;m<a&&h(),m>a&&Ft(s,m-a,-1),Ft(s,b-m,k),er(l,s,w),a=b}}return d(e),h(!c),c}static empty(e){return new At(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let s=0;s<e.length;s++){let l=e[s];if(typeof l=="number")t.push(l,-1);else{if(!Array.isArray(l)||typeof l[0]!="number"||l.some((a,c)=>c&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(l.length==1)t.push(l[0],0);else{for(;n.length<s;)n.push(He.empty);n[s]=He.of(l.slice(1)),t.push(l[0],n[s].length)}}}return new At(t,n)}static createSet(e,t){return new At(e,t)}}function Ft(i,e,t,n=!1){if(e==0&&t<=0)return;let s=i.length-2;s>=0&&t<=0&&t==i[s+1]?i[s]+=e:s>=0&&e==0&&i[s]==0?i[s+1]+=t:n?(i[s]+=e,i[s+1]+=t):i.push(e,t)}function er(i,e,t){if(t.length==0)return;let n=e.length-2>>1;if(n<i.length)i[i.length-1]=i[i.length-1].append(t);else{for(;i.length<n;)i.push(He.empty);i.push(t)}}function Q0(i,e,t){let n=i.inserted;for(let s=0,l=0,a=0;a<i.sections.length;){let c=i.sections[a++],h=i.sections[a++];if(h<0)s+=c,l+=c;else{let d=s,p=l,m=He.empty;for(;d+=c,p+=h,h&&n&&(m=m.append(n[a-2>>1])),!(t||a==i.sections.length||i.sections[a+1]<0);)c=i.sections[a++],h=i.sections[a++];e(s,d,l,p,m),s=d,l=p}}}function J0(i,e,t,n=!1){let s=[],l=n?[]:null,a=new Mc(i),c=new Mc(e);for(let h=-1;;){if(a.done&&c.len||c.done&&a.len)throw new Error("Mismatched change set lengths");if(a.ins==-1&&c.ins==-1){let d=Math.min(a.len,c.len);Ft(s,d,-1),a.forward(d),c.forward(d)}else if(c.ins>=0&&(a.ins<0||h==a.i||a.off==0&&(c.len<a.len||c.len==a.len&&!t))){let d=c.len;for(Ft(s,c.ins,-1);d;){let p=Math.min(a.len,d);a.ins>=0&&h<a.i&&a.len<=p&&(Ft(s,0,a.ins),l&&er(l,s,a.text),h=a.i),a.forward(p),d-=p}c.next()}else if(a.ins>=0){let d=0,p=a.len;for(;p;)if(c.ins==-1){let m=Math.min(p,c.len);d+=m,p-=m,c.forward(m)}else if(c.ins==0&&c.len<p)p-=c.len,c.next();else break;Ft(s,d,h<a.i?a.ins:0),l&&h<a.i&&er(l,s,a.text),h=a.i,a.forward(a.len-p)}else{if(a.done&&c.done)return l?At.createSet(s,l):zn.create(s);throw new Error("Mismatched change set lengths")}}}function pC(i,e,t=!1){let n=[],s=t?[]:null,l=new Mc(i),a=new Mc(e);for(let c=!1;;){if(l.done&&a.done)return s?At.createSet(n,s):zn.create(n);if(l.ins==0)Ft(n,l.len,0,c),l.next();else if(a.len==0&&!a.done)Ft(n,0,a.ins,c),s&&er(s,n,a.text),a.next();else{if(l.done||a.done)throw new Error("Mismatched change set lengths");{let h=Math.min(l.len2,a.len),d=n.length;if(l.ins==-1){let p=a.ins==-1?-1:a.off?0:a.ins;Ft(n,h,p,c),s&&p&&er(s,n,a.text)}else a.ins==-1?(Ft(n,l.off?0:l.len,h,c),s&&er(s,n,l.textBit(h))):(Ft(n,l.off?0:l.len,a.off?0:a.ins,c),s&&!a.off&&er(s,n,a.text));c=(l.ins>h||a.ins>=0&&a.len>h)&&(c||n.length>d),l.forward2(h),a.forward(h)}}}}class Mc{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?He.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?He.empty:t[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Hr{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let n,s;return this.empty?n=s=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),n==this.from&&s==this.to?this:new Hr(n,s,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return $.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return $.range(this.anchor,n)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return $.range(e.anchor,e.head)}static create(e,t,n){return new Hr(e,t,n)}}class ${constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:$.create(this.ranges.map(n=>n.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new $([this.main],0)}addRange(e,t=!0){return $.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,$.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new $(e.ranges.map(t=>Hr.fromJSON(t)),e.main)}static single(e,t=e){return new $([$.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,s=0;s<e.length;s++){let l=e[s];if(l.empty?l.from<=n:l.from<n)return $.normalized(e.slice(),t);n=l.to}return new $(e,t)}static cursor(e,t=0,n,s){return Hr.create(e,e,(t==0?0:t<0?8:16)|(n==null?7:Math.min(6,n))|(s??16777215)<<6)}static range(e,t,n,s){let l=(n??16777215)<<6|(s==null?7:Math.min(6,s));return t<e?Hr.create(t,e,48|l):Hr.create(e,t,(t>e?8:0)|l)}static normalized(e,t=0){let n=e[t];e.sort((s,l)=>s.from-l.from),t=e.indexOf(n);for(let s=1;s<e.length;s++){let l=e[s],a=e[s-1];if(l.empty?l.from<=a.to:l.from<a.to){let c=a.from,h=Math.max(l.to,a.to);s<=t&&t--,e.splice(--s,2,l.anchor>l.head?$.range(h,c):$.range(c,h))}}return new $(e,t)}}function gC(i,e){for(let t of i.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let vb=0;class te{constructor(e,t,n,s,l){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=s,this.id=vb++,this.default=e([]),this.extensions=typeof l=="function"?l(this):l}get reader(){return this}static define(e={}){return new te(e.combine||(t=>t),e.compareInput||((t,n)=>t===n),e.compare||(e.combine?(t,n)=>t===n:wb),!!e.static,e.enables)}of(e){return new pf([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new pf(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new pf(e,this,2,t)}from(e,t){return t||(t=n=>n),this.compute([e],n=>t(n.field(e)))}}function wb(i,e){return i==e||i.length==e.length&&i.every((t,n)=>t===e[n])}class pf{constructor(e,t,n,s){this.dependencies=e,this.facet=t,this.type=n,this.value=s,this.id=vb++}dynamicSlot(e){var t;let n=this.value,s=this.facet.compareInput,l=this.id,a=e[l]>>1,c=this.type==2,h=!1,d=!1,p=[];for(let m of this.dependencies)m=="doc"?h=!0:m=="selection"?d=!0:(((t=e[m.id])!==null&&t!==void 0?t:1)&1)==0&&p.push(e[m.id]);return{create(m){return m.values[a]=n(m),1},update(m,b){if(h&&b.docChanged||d&&(b.docChanged||b.selection)||Z0(m,p)){let v=n(m);if(c?!yx(v,m.values[a],s):!s(v,m.values[a]))return m.values[a]=v,1}return 0},reconfigure:(m,b)=>{let v,w=b.config.address[l];if(w!=null){let k=If(b,w);if(this.dependencies.every(_=>_ instanceof te?b.facet(_)===m.facet(_):_ instanceof Wt?b.field(_,!1)==m.field(_,!1):!0)||(c?yx(v=n(m),k,s):s(v=n(m),k)))return m.values[a]=k,0}else v=n(m);return m.values[a]=v,1}}}}function yx(i,e,t){if(i.length!=e.length)return!1;for(let n=0;n<i.length;n++)if(!t(i[n],e[n]))return!1;return!0}function Z0(i,e){let t=!1;for(let n of e)lc(i,n)&1&&(t=!0);return t}function jU(i,e,t){let n=t.map(h=>i[h.id]),s=t.map(h=>h.type),l=n.filter(h=>!(h&1)),a=i[e.id]>>1;function c(h){let d=[];for(let p=0;p<n.length;p++){let m=If(h,n[p]);if(s[p]==2)for(let b of m)d.push(b);else d.push(m)}return e.combine(d)}return{create(h){for(let d of n)lc(h,d);return h.values[a]=c(h),1},update(h,d){if(!Z0(h,l))return 0;let p=c(h);return e.compare(p,h.values[a])?0:(h.values[a]=p,1)},reconfigure(h,d){let p=Z0(h,n),m=d.config.facets[e.id],b=d.facet(e);if(m&&!p&&wb(t,m))return h.values[a]=b,0;let v=c(h);return e.compare(v,b)?(h.values[a]=b,0):(h.values[a]=v,1)}}}const zh=te.define({static:!0});class Wt{constructor(e,t,n,s,l){this.id=e,this.createF=t,this.updateF=n,this.compareF=s,this.spec=l,this.provides=void 0}static define(e){let t=new Wt(vb++,e.create,e.update,e.compare||((n,s)=>n===s),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(zh).find(n=>n.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:n=>(n.values[t]=this.create(n),1),update:(n,s)=>{let l=n.values[t],a=this.updateF(l,s);return this.compareF(l,a)?0:(n.values[t]=a,1)},reconfigure:(n,s)=>{let l=n.facet(zh),a=s.facet(zh),c;return(c=l.find(h=>h.field==this))&&c!=a.find(h=>h.field==this)?(n.values[t]=c.create(n),1):s.config.address[this.id]!=null?(n.values[t]=s.field(this),0):(n.values[t]=this.create(n),1)}}}init(e){return[this,zh.of({field:this,create:e})]}get extension(){return this}}const zr={lowest:4,low:3,default:2,high:1,highest:0};function Ga(i){return e=>new mC(e,i)}const ll={highest:Ga(zr.highest),high:Ga(zr.high),default:Ga(zr.default),low:Ga(zr.low),lowest:Ga(zr.lowest)};class mC{constructor(e,t){this.inner=e,this.prec=t}}class Ed{of(e){return new ey(this,e)}reconfigure(e){return Ed.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class ey{constructor(e,t){this.compartment=e,this.inner=t}}class zf{constructor(e,t,n,s,l,a){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=s,this.staticValues=l,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let s=[],l=Object.create(null),a=new Map;for(let b of zU(e,t,a))b instanceof Wt?s.push(b):(l[b.facet.id]||(l[b.facet.id]=[])).push(b);let c=Object.create(null),h=[],d=[];for(let b of s)c[b.id]=d.length<<1,d.push(v=>b.slot(v));let p=n?.config.facets;for(let b in l){let v=l[b],w=v[0].facet,k=p&&p[b]||[];if(v.every(_=>_.type==0))if(c[w.id]=h.length<<1|1,wb(k,v))h.push(n.facet(w));else{let _=w.combine(v.map(O=>O.value));h.push(n&&w.compare(_,n.facet(w))?n.facet(w):_)}else{for(let _ of v)_.type==0?(c[_.id]=h.length<<1|1,h.push(_.value)):(c[_.id]=d.length<<1,d.push(O=>_.dynamicSlot(O)));c[w.id]=d.length<<1,d.push(_=>jU(_,w,v))}}let m=d.map(b=>b(c));return new zf(e,a,m,c,h,l)}}function zU(i,e,t){let n=[[],[],[],[],[]],s=new Map;function l(a,c){let h=s.get(a);if(h!=null){if(h<=c)return;let d=n[h].indexOf(a);d>-1&&n[h].splice(d,1),a instanceof ey&&t.delete(a.compartment)}if(s.set(a,c),Array.isArray(a))for(let d of a)l(d,c);else if(a instanceof ey){if(t.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let d=e.get(a.compartment)||a.inner;t.set(a.compartment,d),l(d,c)}else if(a instanceof mC)l(a.inner,a.prec);else if(a instanceof Wt)n[c].push(a),a.provides&&l(a.provides,c);else if(a instanceof pf)n[c].push(a),a.facet.extensions&&l(a.facet.extensions,zr.default);else{let d=a.extension;if(!d)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);l(d,c)}}return l(i,zr.default),n.reduce((a,c)=>a.concat(c))}function lc(i,e){if(e&1)return 2;let t=e>>1,n=i.status[t];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;i.status[t]=4;let s=i.computeSlot(i,i.config.dynamicSlots[t]);return i.status[t]=2|s}function If(i,e){return e&1?i.config.staticValues[e>>1]:i.values[e>>1]}const yC=te.define(),ty=te.define({combine:i=>i.some(e=>e),static:!0}),bC=te.define({combine:i=>i.length?i[0]:void 0,static:!0}),vC=te.define(),wC=te.define(),SC=te.define(),kC=te.define({combine:i=>i.length?i[0]:!1});class Sn{constructor(e,t){this.type=e,this.value=t}static define(){return new IU}}class IU{of(e){return new Sn(this,e)}}class PU{constructor(e){this.map=e}of(e){return new _e(this,e)}}class _e{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new _e(this.type,t)}is(e){return this.type==e}static define(e={}){return new PU(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let s of e){let l=s.map(t);l&&n.push(l)}return n}}_e.reconfigure=_e.define();_e.appendConfig=_e.define();class Tt{constructor(e,t,n,s,l,a){this.startState=e,this.changes=t,this.selection=n,this.effects=s,this.annotations=l,this.scrollIntoView=a,this._doc=null,this._state=null,n&&gC(n,t.newLength),l.some(c=>c.type==Tt.time)||(this.annotations=l.concat(Tt.time.of(Date.now())))}static create(e,t,n,s,l,a){return new Tt(e,t,n,s,l,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Tt.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Tt.time=Sn.define();Tt.userEvent=Sn.define();Tt.addToHistory=Sn.define();Tt.remote=Sn.define();function HU(i,e){let t=[];for(let n=0,s=0;;){let l,a;if(n<i.length&&(s==e.length||e[s]>=i[n]))l=i[n++],a=i[n++];else if(s<e.length)l=e[s++],a=e[s++];else return t;!t.length||t[t.length-1]<l?t.push(l,a):t[t.length-1]<a&&(t[t.length-1]=a)}}function xC(i,e,t){var n;let s,l,a;return t?(s=e.changes,l=At.empty(e.changes.length),a=i.changes.compose(e.changes)):(s=e.changes.map(i.changes),l=i.changes.mapDesc(e.changes,!0),a=i.changes.compose(s)),{changes:a,selection:e.selection?e.selection.map(l):(n=i.selection)===null||n===void 0?void 0:n.map(s),effects:_e.mapEffects(i.effects,s).concat(_e.mapEffects(e.effects,l)),annotations:i.annotations.length?i.annotations.concat(e.annotations):e.annotations,scrollIntoView:i.scrollIntoView||e.scrollIntoView}}function iy(i,e,t){let n=e.selection,s=bo(e.annotations);return e.userEvent&&(s=s.concat(Tt.userEvent.of(e.userEvent))),{changes:e.changes instanceof At?e.changes:At.of(e.changes||[],t,i.facet(bC)),selection:n&&(n instanceof $?n:$.single(n.anchor,n.head)),effects:bo(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function _C(i,e,t){let n=iy(i,e.length?e[0]:{},i.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let l=1;l<e.length;l++){e[l].filter===!1&&(t=!1);let a=!!e[l].sequential;n=xC(n,iy(i,e[l],a?n.changes.newLength:i.doc.length),a)}let s=Tt.create(i,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return VU(t?qU(s):s)}function qU(i){let e=i.startState,t=!0;for(let s of e.facet(vC)){let l=s(i);if(l===!1){t=!1;break}Array.isArray(l)&&(t=t===!0?l:HU(t,l))}if(t!==!0){let s,l;if(t===!1)l=i.changes.invertedDesc,s=At.empty(e.doc.length);else{let a=i.changes.filter(t);s=a.changes,l=a.filtered.mapDesc(a.changes).invertedDesc}i=Tt.create(e,s,i.selection&&i.selection.map(l),_e.mapEffects(i.effects,l),i.annotations,i.scrollIntoView)}let n=e.facet(wC);for(let s=n.length-1;s>=0;s--){let l=n[s](i);l instanceof Tt?i=l:Array.isArray(l)&&l.length==1&&l[0]instanceof Tt?i=l[0]:i=_C(e,bo(l),!1)}return i}function VU(i){let e=i.startState,t=e.facet(SC),n=i;for(let s=t.length-1;s>=0;s--){let l=t[s](i);l&&Object.keys(l).length&&(n=xC(n,iy(e,l,i.changes.newLength),!0))}return n==i?i:Tt.create(e,i.changes,i.selection,n.effects,n.annotations,n.scrollIntoView)}const $U=[];function bo(i){return i==null?$U:Array.isArray(i)?i:[i]}var rt=(function(i){return i[i.Word=0]="Word",i[i.Space=1]="Space",i[i.Other=2]="Other",i})(rt||(rt={}));const GU=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ny;try{ny=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function KU(i){if(ny)return ny.test(i);for(let e=0;e<i.length;e++){let t=i[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||GU.test(t)))return!0}return!1}function WU(i){return e=>{if(!/\S/.test(e))return rt.Space;if(KU(e))return rt.Word;for(let t=0;t<i.length;t++)if(e.indexOf(i[t])>-1)return rt.Word;return rt.Other}}class je{constructor(e,t,n,s,l,a){this.config=e,this.doc=t,this.selection=n,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=l,a&&(a._state=this);for(let c=0;c<this.config.dynamicSlots.length;c++)lc(this,c<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(n==null){if(t)throw new RangeError("Field is not present in this state");return}return lc(this,n),If(this,n)}update(...e){return _C(this,e,!0)}applyTransaction(e){let t=this.config,{base:n,compartments:s}=t;for(let c of e.effects)c.is(Ed.reconfigure)?(t&&(s=new Map,t.compartments.forEach((h,d)=>s.set(d,h)),t=null),s.set(c.value.compartment,c.value.extension)):c.is(_e.reconfigure)?(t=null,n=c.value):c.is(_e.appendConfig)&&(t=null,n=bo(n).concat(c.value));let l;t?l=e.startState.values.slice():(t=zf.resolve(n,s,this),l=new je(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(h,d)=>d.reconfigure(h,this),null).values);let a=e.startState.facet(ty)?e.newSelection:e.newSelection.asSingle();new je(t,e.newDoc,a,l,(c,h)=>h.update(c,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:$.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),s=this.changes(n.changes),l=[n.range],a=bo(n.effects);for(let c=1;c<t.ranges.length;c++){let h=e(t.ranges[c]),d=this.changes(h.changes),p=d.map(s);for(let b=0;b<c;b++)l[b]=l[b].map(p);let m=s.mapDesc(d,!0);l.push(h.range.map(m)),s=s.compose(p),a=_e.mapEffects(a,p).concat(_e.mapEffects(bo(h.effects),m))}return{changes:s,selection:$.create(l,t.mainIndex),effects:a}}changes(e=[]){return e instanceof At?e:At.of(e,this.doc.length,this.facet(je.lineSeparator))}toText(e){return He.of(e.split(this.facet(je.lineSeparator)||X0))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(lc(this,t),If(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let s=e[n];s instanceof Wt&&this.config.address[s.id]!=null&&(t[n]=s.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(n){for(let l in n)if(Object.prototype.hasOwnProperty.call(e,l)){let a=n[l],c=e[l];s.push(a.init(h=>a.spec.fromJSON(c,h)))}}return je.create({doc:e.doc,selection:$.fromJSON(e.selection),extensions:t.extensions?s.concat([t.extensions]):s})}static create(e={}){let t=zf.resolve(e.extensions||[],new Map),n=e.doc instanceof He?e.doc:He.of((e.doc||"").split(t.staticFacet(je.lineSeparator)||X0)),s=e.selection?e.selection instanceof $?e.selection:$.single(e.selection.anchor,e.selection.head):$.single(0);return gC(s,n.length),t.staticFacet(ty)||(s=s.asSingle()),new je(t,n,s,t.dynamicSlots.map(()=>null),(l,a)=>a.create(l),null)}get tabSize(){return this.facet(je.tabSize)}get lineBreak(){return this.facet(je.lineSeparator)||`
`}get readOnly(){return this.facet(kC)}phrase(e,...t){for(let n of this.facet(je.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(n,s)=>{if(s=="$")return"$";let l=+(s||1);return!l||l>t.length?n:t[l-1]})),e}languageDataAt(e,t,n=-1){let s=[];for(let l of this.facet(yC))for(let a of l(this,t,n))Object.prototype.hasOwnProperty.call(a,e)&&s.push(a[e]);return s}charCategorizer(e){let t=this.languageDataAt("wordChars",e);return WU(t.length?t[0]:"")}wordAt(e){let{text:t,from:n,length:s}=this.doc.lineAt(e),l=this.charCategorizer(e),a=e-n,c=e-n;for(;a>0;){let h=Ct(t,a,!1);if(l(t.slice(h,a))!=rt.Word)break;a=h}for(;c<s;){let h=Ct(t,c);if(l(t.slice(c,h))!=rt.Word)break;c=h}return a==c?null:$.range(a+n,c+n)}}je.allowMultipleSelections=ty;je.tabSize=te.define({combine:i=>i.length?i[0]:4});je.lineSeparator=bC;je.readOnly=kC;je.phrases=te.define({compare(i,e){let t=Object.keys(i),n=Object.keys(e);return t.length==n.length&&t.every(s=>i[s]==e[s])}});je.languageData=yC;je.changeFilter=vC;je.transactionFilter=wC;je.transactionExtender=SC;Ed.reconfigure=_e.define();function Gn(i,e,t={}){let n={};for(let s of i)for(let l of Object.keys(s)){let a=s[l],c=n[l];if(c===void 0)n[l]=a;else if(!(c===a||a===void 0))if(Object.hasOwnProperty.call(t,l))n[l]=t[l](c,a);else throw new Error("Config merge conflict for field "+l)}for(let s in e)n[s]===void 0&&(n[s]=e[s]);return n}class sr{eq(e){return this==e}range(e,t=e){return sy.create(e,t,this)}}sr.prototype.startSide=sr.prototype.endSide=0;sr.prototype.point=!1;sr.prototype.mapMode=ti.TrackDel;function Sb(i,e){return i==e||i.constructor==e.constructor&&i.eq(e)}let sy=class OC{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(e,t,n){return new OC(e,t,n)}};function ry(i,e){return i.from-e.from||i.value.startSide-e.value.startSide}class kb{constructor(e,t,n,s){this.from=e,this.to=t,this.value=n,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,s=0){let l=n?this.to:this.from;for(let a=s,c=l.length;;){if(a==c)return a;let h=a+c>>1,d=l[h]-e||(n?this.value[h].endSide:this.value[h].startSide)-t;if(h==a)return d>=0?a:c;d>=0?c=h:a=h+1}}between(e,t,n,s){for(let l=this.findIndex(t,-1e9,!0),a=this.findIndex(n,1e9,!1,l);l<a;l++)if(s(this.from[l]+e,this.to[l]+e,this.value[l])===!1)return!1}map(e,t){let n=[],s=[],l=[],a=-1,c=-1;for(let h=0;h<this.value.length;h++){let d=this.value[h],p=this.from[h]+e,m=this.to[h]+e,b,v;if(p==m){let w=t.mapPos(p,d.startSide,d.mapMode);if(w==null||(b=v=w,d.startSide!=d.endSide&&(v=t.mapPos(p,d.endSide),v<b)))continue}else if(b=t.mapPos(p,d.startSide),v=t.mapPos(m,d.endSide),b>v||b==v&&d.startSide>0&&d.endSide<=0)continue;(v-b||d.endSide-d.startSide)<0||(a<0&&(a=b),d.point&&(c=Math.max(c,v-b)),n.push(d),s.push(b-a),l.push(v-a))}return{mapped:n.length?new kb(s,l,n,c):null,pos:a}}}class De{constructor(e,t,n,s){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=s}static create(e,t,n,s){return new De(e,t,n,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:s=0,filterTo:l=this.length}=e,a=e.filter;if(t.length==0&&!a)return this;if(n&&(t=t.slice().sort(ry)),this.isEmpty)return t.length?De.of(t):this;let c=new AC(this,null,-1).goto(0),h=0,d=[],p=new qn;for(;c.value||h<t.length;)if(h<t.length&&(c.from-t[h].from||c.startSide-t[h].value.startSide)>=0){let m=t[h++];p.addInner(m.from,m.to,m.value)||d.push(m)}else c.rangeIndex==1&&c.chunkIndex<this.chunk.length&&(h==t.length||this.chunkEnd(c.chunkIndex)<t[h].from)&&(!a||s>this.chunkEnd(c.chunkIndex)||l<this.chunkPos[c.chunkIndex])&&p.addChunk(this.chunkPos[c.chunkIndex],this.chunk[c.chunkIndex])?c.nextChunk():((!a||s>c.to||l<c.from||a(c.from,c.to,c.value))&&(p.addInner(c.from,c.to,c.value)||d.push(sy.create(c.from,c.to,c.value))),c.next());return p.finishInner(this.nextLayer.isEmpty&&!d.length?De.empty:this.nextLayer.update({add:d,filter:a,filterFrom:s,filterTo:l}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],s=-1;for(let a=0;a<this.chunk.length;a++){let c=this.chunkPos[a],h=this.chunk[a],d=e.touchesRange(c,c+h.length);if(d===!1)s=Math.max(s,h.maxPoint),t.push(h),n.push(e.mapPos(c));else if(d===!0){let{mapped:p,pos:m}=h.map(c,e);p&&(s=Math.max(s,p.maxPoint),t.push(p),n.push(m))}}let l=this.nextLayer.map(e);return t.length==0?l:new De(n,t,l||De.empty,s)}between(e,t,n){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let l=this.chunkPos[s],a=this.chunk[s];if(t>=l&&e<=l+a.length&&a.between(l,e-l,t-l,n)===!1)return}this.nextLayer.between(e,t,n)}}iter(e=0){return Nc.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Nc.from(e).goto(t)}static compare(e,t,n,s,l=-1){let a=e.filter(m=>m.maxPoint>0||!m.isEmpty&&m.maxPoint>=l),c=t.filter(m=>m.maxPoint>0||!m.isEmpty&&m.maxPoint>=l),h=bx(a,c,n),d=new Ka(a,h,l),p=new Ka(c,h,l);n.iterGaps((m,b,v)=>vx(d,m,p,b,v,s)),n.empty&&n.length==0&&vx(d,0,p,0,0,s)}static eq(e,t,n=0,s){s==null&&(s=999999999);let l=e.filter(p=>!p.isEmpty&&t.indexOf(p)<0),a=t.filter(p=>!p.isEmpty&&e.indexOf(p)<0);if(l.length!=a.length)return!1;if(!l.length)return!0;let c=bx(l,a),h=new Ka(l,c,0).goto(n),d=new Ka(a,c,0).goto(n);for(;;){if(h.to!=d.to||!ly(h.active,d.active)||h.point&&(!d.point||!Sb(h.point,d.point)))return!1;if(h.to>s)return!0;h.next(),d.next()}}static spans(e,t,n,s,l=-1){let a=new Ka(e,null,l).goto(t),c=t,h=a.openStart;for(;;){let d=Math.min(a.to,n);if(a.point){let p=a.activeForPoint(a.to),m=a.pointFrom<t?p.length+1:a.point.startSide<0?p.length:Math.min(p.length,h);s.point(c,d,a.point,p,m,a.pointRank),h=Math.min(a.openEnd(d),p.length)}else d>c&&(s.span(c,d,a.active,h),h=a.openEnd(d));if(a.to>n)return h+(a.point&&a.to>n?1:0);c=a.to,a.next()}}static of(e,t=!1){let n=new qn;for(let s of e instanceof sy?[e]:t?YU(e):e)n.add(s.from,s.to,s.value);return n.finish()}static join(e){if(!e.length)return De.empty;let t=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let s=e[n];s!=De.empty;s=s.nextLayer)t=new De(s.chunkPos,s.chunk,t,Math.max(s.maxPoint,t.maxPoint));return t}}De.empty=new De([],[],null,-1);function YU(i){if(i.length>1)for(let e=i[0],t=1;t<i.length;t++){let n=i[t];if(ry(e,n)>0)return i.slice().sort(ry);e=n}return i}De.empty.nextLayer=De.empty;class qn{finishChunk(e){this.chunks.push(new kb(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new qn)).add(e,t,n)}addInner(e,t,n){let s=e-this.lastTo||n.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(De.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=De.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function bx(i,e,t){let n=new Map;for(let l of i)for(let a=0;a<l.chunk.length;a++)l.chunk[a].maxPoint<=0&&n.set(l.chunk[a],l.chunkPos[a]);let s=new Set;for(let l of e)for(let a=0;a<l.chunk.length;a++){let c=n.get(l.chunk[a]);c!=null&&(t?t.mapPos(c):c)==l.chunkPos[a]&&!t?.touchesRange(c,c+l.chunk[a].length)&&s.add(l.chunk[a])}return s}class AC{constructor(e,t,n,s=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Nc{constructor(e){this.heap=e}static from(e,t=null,n=-1){let s=[];for(let l=0;l<e.length;l++)for(let a=e[l];!a.isEmpty;a=a.nextLayer)a.maxPoint>=n&&s.push(new AC(a,t,n,l));return s.length==1?s[0]:new Nc(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let n=this.heap.length>>1;n>=0;n--)Bm(this.heap,n);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let n=this.heap.length>>1;n>=0;n--)Bm(this.heap,n);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Bm(this.heap,0)}}}function Bm(i,e){for(let t=i[e];;){let n=(e<<1)+1;if(n>=i.length)break;let s=i[n];if(n+1<i.length&&s.compare(i[n+1])>=0&&(s=i[n+1],n++),t.compare(s)<0)break;i[n]=t,i[e]=s,e=n}}class Ka{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Nc.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Ih(this.active,e),Ih(this.activeTo,e),Ih(this.activeRank,e),this.minActive=wx(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:s,rank:l}=this.cursor;for(;t<this.activeRank.length&&(l-this.activeRank[t]||s-this.activeTo[t])>0;)t++;Ph(this.active,t,n),Ph(this.activeTo,t,s),Ph(this.activeRank,t,l),e&&Ph(e,t,this.cursor.from),this.minActive=wx(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),n&&Ih(n,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let l=this.cursor.value;if(!l.point)this.addActive(n),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=l,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=l.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let s=n.length-1;s>=0&&n[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}function vx(i,e,t,n,s,l){i.goto(e),t.goto(n);let a=n+s,c=n,h=n-e,d=!!l.boundChange;for(let p=!1;;){let m=i.to+h-t.to,b=m||i.endSide-t.endSide,v=b<0?i.to+h:t.to,w=Math.min(v,a);if(i.point||t.point?(i.point&&t.point&&Sb(i.point,t.point)&&ly(i.activeForPoint(i.to),t.activeForPoint(t.to))||l.comparePoint(c,w,i.point,t.point),p=!1):(p&&l.boundChange(c),w>c&&!ly(i.active,t.active)&&l.compareRange(c,w,i.active,t.active),d&&w<a&&(m||i.openEnd(v)!=t.openEnd(v))&&(p=!0)),v>a)break;c=v,b<=0&&i.next(),b>=0&&t.next()}}function ly(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!=e[t]&&!Sb(i[t],e[t]))return!1;return!0}function Ih(i,e){for(let t=e,n=i.length-1;t<n;t++)i[t]=i[t+1];i.pop()}function Ph(i,e,t){for(let n=i.length-1;n>=e;n--)i[n+1]=i[n];i[e]=t}function wx(i,e){let t=-1,n=1e9;for(let s=0;s<e.length;s++)(e[s]-n||i[s].endSide-i[t].endSide)<0&&(t=s,n=e[s]);return t}function Ko(i,e,t=i.length){let n=0;for(let s=0;s<t&&s<i.length;)i.charCodeAt(s)==9?(n+=e-n%e,s++):(n++,s=Ct(i,s));return n}function oy(i,e,t,n){for(let s=0,l=0;;){if(l>=e)return s;if(s==i.length)break;l+=i.charCodeAt(s)==9?t-l%t:1,s=Ct(i,s)}return n===!0?-1:i.length}const ay="",Sx=typeof Symbol>"u"?"__"+ay:Symbol.for(ay),cy=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),kx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class rr{constructor(e,t){this.rules=[];let{finish:n}=t||{};function s(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function l(a,c,h,d){let p=[],m=/^@(\w+)\b/.exec(a[0]),b=m&&m[1]=="keyframes";if(m&&c==null)return h.push(a[0]+";");for(let v in c){let w=c[v];if(/&/.test(v))l(v.split(/,\s*/).map(k=>a.map(_=>k.replace(/&/,_))).reduce((k,_)=>k.concat(_)),w,h);else if(w&&typeof w=="object"){if(!m)throw new RangeError("The value of a property ("+v+") should be a primitive value.");l(s(v),w,p,b)}else w!=null&&p.push(v.replace(/_.*/,"").replace(/[A-Z]/g,k=>"-"+k.toLowerCase())+": "+w+";")}(p.length||b)&&h.push((n&&!m&&!d?a.map(n):a).join(", ")+" {"+p.join(" ")+"}")}for(let a in e)l(s(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=kx[Sx]||1;return kx[Sx]=e+1,ay+e.toString(36)}static mount(e,t,n){let s=e[cy],l=n&&n.nonce;s?l&&s.setNonce(l):s=new FU(e,l),s.mount(Array.isArray(t)?t:[t],e)}}let xx=new Map;class FU{constructor(e,t){let n=e.ownerDocument||e,s=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&s.CSSStyleSheet){let l=xx.get(n);if(l)return e[cy]=l;this.sheet=new s.CSSStyleSheet,xx.set(n,this)}else this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[cy]=this}mount(e,t){let n=this.sheet,s=0,l=0;for(let a=0;a<e.length;a++){let c=e[a],h=this.modules.indexOf(c);if(h<l&&h>-1&&(this.modules.splice(h,1),l--,h=-1),h==-1){if(this.modules.splice(l++,0,c),n)for(let d=0;d<c.rules.length;d++)n.insertRule(c.rules[d],s++)}else{for(;l<h;)s+=this.modules[l++].rules.length;s+=c.rules.length,l++}}if(n)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let a="";for(let h=0;h<this.modules.length;h++)a+=this.modules[h].getRules()+`
`;this.styleTag.textContent=a;let c=t.head||t;this.styleTag.parentNode!=c&&c.insertBefore(this.styleTag,c.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var lr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Lc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},XU=typeof navigator<"u"&&/Mac/.test(navigator.platform),QU=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var $t=0;$t<10;$t++)lr[48+$t]=lr[96+$t]=String($t);for(var $t=1;$t<=24;$t++)lr[$t+111]="F"+$t;for(var $t=65;$t<=90;$t++)lr[$t]=String.fromCharCode($t+32),Lc[$t]=String.fromCharCode($t);for(var Um in lr)Lc.hasOwnProperty(Um)||(Lc[Um]=lr[Um]);function JU(i){var e=XU&&i.metaKey&&i.shiftKey&&!i.ctrlKey&&!i.altKey||QU&&i.shiftKey&&i.key&&i.key.length==1||i.key=="Unidentified",t=!e&&i.key||(i.shiftKey?Lc:lr)[i.keyCode]||i.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function Ye(){var i=arguments[0];typeof i=="string"&&(i=document.createElement(i));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var s=t[n];typeof s=="string"?i.setAttribute(n,s):s!=null&&(i[n]=s)}e++}for(;e<arguments.length;e++)CC(i,arguments[e]);return i}function CC(i,e){if(typeof e=="string")i.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)i.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)CC(i,e[t]);else throw new RangeError("Unsupported child node: "+e)}let ei=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},uy=typeof document<"u"?document:{documentElement:{style:{}}};const hy=/Edge\/(\d+)/.exec(ei.userAgent),TC=/MSIE \d/.test(ei.userAgent),fy=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ei.userAgent),Dd=!!(TC||fy||hy),_x=!Dd&&/gecko\/(\d+)/i.test(ei.userAgent),jm=!Dd&&/Chrome\/(\d+)/.exec(ei.userAgent),ZU="webkitFontSmoothing"in uy.documentElement.style,dy=!Dd&&/Apple Computer/.test(ei.vendor),Ox=dy&&(/Mobile\/\w+/.test(ei.userAgent)||ei.maxTouchPoints>2);var ne={mac:Ox||/Mac/.test(ei.platform),windows:/Win/.test(ei.platform),linux:/Linux|X11/.test(ei.platform),ie:Dd,ie_version:TC?uy.documentMode||6:fy?+fy[1]:hy?+hy[1]:0,gecko:_x,gecko_version:_x?+(/Firefox\/(\d+)/.exec(ei.userAgent)||[0,0])[1]:0,chrome:!!jm,chrome_version:jm?+jm[1]:0,ios:Ox,android:/Android\b/.test(ei.userAgent),webkit_version:ZU?+(/\bAppleWebKit\/(\d+)/.exec(ei.userAgent)||[0,0])[1]:0,safari:dy,safari_version:dy?+(/\bVersion\/(\d+(\.\d+)?)/.exec(ei.userAgent)||[0,0])[1]:0,tabSize:uy.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function xb(i,e){for(let t in i)t=="class"&&e.class?e.class+=" "+i.class:t=="style"&&e.style?e.style+=";"+i.style:e[t]=i[t];return e}const Pf=Object.create(null);function _b(i,e,t){if(i==e)return!0;i||(i=Pf),e||(e=Pf);let n=Object.keys(i),s=Object.keys(e);if(n.length-0!=s.length-0)return!1;for(let l of n)if(l!=t&&(s.indexOf(l)==-1||i[l]!==e[l]))return!1;return!0}function ej(i,e){for(let t=i.attributes.length-1;t>=0;t--){let n=i.attributes[t].name;e[n]==null&&i.removeAttribute(n)}for(let t in e){let n=e[t];t=="style"?i.style.cssText=n:i.getAttribute(t)!=n&&i.setAttribute(t,n)}}function Ax(i,e,t){let n=!1;if(e)for(let s in e)t&&s in t||(n=!0,s=="style"?i.style.cssText="":i.removeAttribute(s));if(t)for(let s in t)e&&e[s]==t[s]||(n=!0,s=="style"?i.style.cssText=t[s]:i.setAttribute(s,t[s]));return n}function tj(i){let e=Object.create(null);for(let t=0;t<i.attributes.length;t++){let n=i.attributes[t];e[n.name]=n.value}return e}class Kn{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Gt=(function(i){return i[i.Text=0]="Text",i[i.WidgetBefore=1]="WidgetBefore",i[i.WidgetAfter=2]="WidgetAfter",i[i.WidgetRange=3]="WidgetRange",i})(Gt||(Gt={}));class ue extends sr{constructor(e,t,n,s){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=s}get heightRelevant(){return!1}static mark(e){return new tu(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Zr(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,s;if(e.isBlockGap)n=-5e8,s=4e8;else{let{start:l,end:a}=EC(e,t);n=(l?t?-3e8:-1:5e8)-1,s=(a?t?2e8:1:-6e8)+1}return new Zr(e,n,s,t,e.widget||null,!0)}static line(e){return new iu(e)}static set(e,t=!1){return De.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ue.none=De.empty;class tu extends ue{constructor(e){let{start:t,end:n}=EC(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?xb(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||Pf}eq(e){return this==e||e instanceof tu&&this.tagName==e.tagName&&_b(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}tu.prototype.point=!1;class iu extends ue{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof iu&&this.spec.class==e.spec.class&&_b(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}iu.prototype.mapMode=ti.TrackBefore;iu.prototype.point=!0;class Zr extends ue{constructor(e,t,n,s,l,a){super(t,n,l,e),this.block=s,this.isReplace=a,this.mapMode=s?t<=0?ti.TrackBefore:ti.TrackAfter:ti.TrackDel}get type(){return this.startSide!=this.endSide?Gt.WidgetRange:this.startSide<=0?Gt.WidgetBefore:Gt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Zr&&ij(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Zr.prototype.point=!0;function EC(i,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=i;return t==null&&(t=i.inclusive),n==null&&(n=i.inclusive),{start:t??e,end:n??e}}function ij(i,e){return i==e||!!(i&&e&&i.compare(e))}function vo(i,e,t,n=0){let s=t.length-1;s>=0&&t[s]+n>=i?t[s]=Math.max(t[s],e):t.push(i,e)}class Bc extends sr{constructor(e,t){super(),this.tagName=e,this.attributes=t}eq(e){return e==this||e instanceof Bc&&this.tagName==e.tagName&&_b(this.attributes,e.attributes)}static create(e){return new Bc(e.tagName,e.attributes||Pf)}static set(e,t=!1){return De.of(e,t)}}Bc.prototype.startSide=Bc.prototype.endSide=-1;function Lo(i){let e;return i.nodeType==11?e=i.getSelection?i:i.ownerDocument:e=i,e.getSelection()}function py(i,e){return e?i==e||i.contains(e.nodeType!=1?e.parentNode:e):!1}function oc(i,e){if(!e.anchorNode)return!1;try{return py(i,e.anchorNode)}catch{return!1}}function gf(i){return i.nodeType==3?Uc(i,0,i.nodeValue.length).getClientRects():i.nodeType==1?i.getClientRects():[]}function ac(i,e,t,n){return t?Cx(i,e,t,n,-1)||Cx(i,e,t,n,1):!1}function or(i){for(var e=0;;e++)if(i=i.previousSibling,!i)return e}function Hf(i){return i.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(i.nodeName)}function Cx(i,e,t,n,s){for(;;){if(i==t&&e==n)return!0;if(e==(s<0?0:ys(i))){if(i.nodeName=="DIV")return!1;let l=i.parentNode;if(!l||l.nodeType!=1)return!1;e=or(i)+(s<0?0:1),i=l}else if(i.nodeType==1){if(i=i.childNodes[e+(s<0?-1:0)],i.nodeType==1&&i.contentEditable=="false")return!1;e=s<0?ys(i):0}else return!1}}function ys(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}function qf(i,e){let t=e?i.left:i.right;return{left:t,right:t,top:i.top,bottom:i.bottom}}function nj(i){let e=i.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:i.innerWidth,top:0,bottom:i.innerHeight}}function DC(i,e){let t=e.width/i.offsetWidth,n=e.height/i.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-i.offsetWidth)<1)&&(t=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-i.offsetHeight)<1)&&(n=1),{scaleX:t,scaleY:n}}function sj(i,e,t,n,s,l,a,c){let h=i.ownerDocument,d=h.defaultView||window;for(let p=i,m=!1;p&&!m;)if(p.nodeType==1){let b,v=p==h.body,w=1,k=1;if(v)b=nj(d);else{if(/^(fixed|sticky)$/.test(getComputedStyle(p).position)&&(m=!0),p.scrollHeight<=p.clientHeight&&p.scrollWidth<=p.clientWidth){p=p.assignedSlot||p.parentNode;continue}let R=p.getBoundingClientRect();({scaleX:w,scaleY:k}=DC(p,R)),b={left:R.left,right:R.left+p.clientWidth*w,top:R.top,bottom:R.top+p.clientHeight*k}}let _=0,O=0;if(s=="nearest")e.top<b.top?(O=e.top-(b.top+a),t>0&&e.bottom>b.bottom+O&&(O=e.bottom-b.bottom+a)):e.bottom>b.bottom&&(O=e.bottom-b.bottom+a,t<0&&e.top-O<b.top&&(O=e.top-(b.top+a)));else{let R=e.bottom-e.top,C=b.bottom-b.top;O=(s=="center"&&R<=C?e.top+R/2-C/2:s=="start"||s=="center"&&t<0?e.top-a:e.bottom-C+a)-b.top}if(n=="nearest"?e.left<b.left?(_=e.left-(b.left+l),t>0&&e.right>b.right+_&&(_=e.right-b.right+l)):e.right>b.right&&(_=e.right-b.right+l,t<0&&e.left<b.left+_&&(_=e.left-(b.left+l))):_=(n=="center"?e.left+(e.right-e.left)/2-(b.right-b.left)/2:n=="start"==c?e.left-l:e.right-(b.right-b.left)+l)-b.left,_||O)if(v)d.scrollBy(_,O);else{let R=0,C=0;if(O){let N=p.scrollTop;p.scrollTop+=O/k,C=(p.scrollTop-N)*k}if(_){let N=p.scrollLeft;p.scrollLeft+=_/w,R=(p.scrollLeft-N)*w}e={left:e.left-R,top:e.top-C,right:e.right-R,bottom:e.bottom-C},R&&Math.abs(R-_)<1&&(n="nearest"),C&&Math.abs(C-O)<1&&(s="nearest")}if(v)break;(e.top<b.top||e.bottom>b.bottom||e.left<b.left||e.right>b.right)&&(e={left:Math.max(e.left,b.left),right:Math.min(e.right,b.right),top:Math.max(e.top,b.top),bottom:Math.min(e.bottom,b.bottom)}),p=p.assignedSlot||p.parentNode}else if(p.nodeType==11)p=p.host;else break}function rj(i){let e=i.ownerDocument,t,n;for(let s=i.parentNode;s&&!(s==e.body||t&&n);)if(s.nodeType==1)!n&&s.scrollHeight>s.clientHeight&&(n=s),!t&&s.scrollWidth>s.clientWidth&&(t=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:t,y:n}}class lj{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?ys(t):0),n,Math.min(e.focusOffset,n?ys(n):0))}set(e,t,n,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=s}}let Br=null;ne.safari&&ne.safari_version>=26&&(Br=!1);function RC(i){if(i.setActive)return i.setActive();if(Br)return i.focus(Br);let e=[];for(let t=i;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(i.focus(Br==null?{get preventScroll(){return Br={preventScroll:!0},!0}}:void 0),!Br){Br=!1;for(let t=0;t<e.length;){let n=e[t++],s=e[t++],l=e[t++];n.scrollTop!=s&&(n.scrollTop=s),n.scrollLeft!=l&&(n.scrollLeft=l)}}}let Tx;function Uc(i,e,t=e){let n=Tx||(Tx=document.createRange());return n.setEnd(i,t),n.setStart(i,e),n}function wo(i,e,t,n){let s={key:e,code:e,keyCode:t,which:t,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let l=new KeyboardEvent("keydown",s);l.synthetic=!0,i.dispatchEvent(l);let a=new KeyboardEvent("keyup",s);return a.synthetic=!0,i.dispatchEvent(a),l.defaultPrevented||a.defaultPrevented}function oj(i){for(;i;){if(i&&(i.nodeType==9||i.nodeType==11&&i.host))return i;i=i.assignedSlot||i.parentNode}return null}function aj(i,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,ys(t));;)if(n){if(t.nodeType!=1)return!1;let s=t.childNodes[n-1];s.contentEditable=="false"?n--:(t=s,n=ys(t))}else{if(t==i)return!0;n=or(t),t=t.parentNode}}function MC(i){return i.scrollTop>Math.max(1,i.scrollHeight-i.clientHeight-4)}function NC(i,e){for(let t=i,n=e;;){if(t.nodeType==3&&n>0)return{node:t,offset:n};if(t.nodeType==1&&n>0){if(t.contentEditable=="false")return null;t=t.childNodes[n-1],n=ys(t)}else if(t.parentNode&&!Hf(t))n=or(t),t=t.parentNode;else return null}}function LC(i,e){for(let t=i,n=e;;){if(t.nodeType==3&&n<t.nodeValue.length)return{node:t,offset:n};if(t.nodeType==1&&n<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[n],n=0}else if(t.parentNode&&!Hf(t))n=or(t)+1,t=t.parentNode;else return null}}class mn{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new mn(e.parentNode,or(e),t)}static after(e,t){return new mn(e.parentNode,or(e)+1,t)}}var Ze=(function(i){return i[i.LTR=0]="LTR",i[i.RTL=1]="RTL",i})(Ze||(Ze={}));const el=Ze.LTR,Ob=Ze.RTL;function BC(i){let e=[];for(let t=0;t<i.length;t++)e.push(1<<+i[t]);return e}const cj=BC("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),uj=BC("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),gy=Object.create(null),En=[];for(let i of["()","[]","{}"]){let e=i.charCodeAt(0),t=i.charCodeAt(1);gy[e]=t,gy[t]=-e}function UC(i){return i<=247?cj[i]:1424<=i&&i<=1524?2:1536<=i&&i<=1785?uj[i-1536]:1774<=i&&i<=2220?4:8192<=i&&i<=8204?256:64336<=i&&i<=65023?4:1}const hj=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ps{get dir(){return this.level%2?Ob:el}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,s){let l=-1;for(let a=0;a<e.length;a++){let c=e[a];if(c.from<=t&&c.to>=t){if(c.level==n)return a;(l<0||(s!=0?s<0?c.from<t:c.to>t:e[l].level>c.level))&&(l=a)}}if(l<0)throw new RangeError("Index out of range");return l}}function jC(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++){let n=i[t],s=e[t];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!jC(n.inner,s.inner))return!1}return!0}const Xe=[];function fj(i,e,t,n,s){for(let l=0;l<=n.length;l++){let a=l?n[l-1].to:e,c=l<n.length?n[l].from:t,h=l?256:s;for(let d=a,p=h,m=h;d<c;d++){let b=UC(i.charCodeAt(d));b==512?b=p:b==8&&m==4&&(b=16),Xe[d]=b==4?2:b,b&7&&(m=b),p=b}for(let d=a,p=h,m=h;d<c;d++){let b=Xe[d];if(b==128)d<c-1&&p==Xe[d+1]&&p&24?b=Xe[d]=p:Xe[d]=256;else if(b==64){let v=d+1;for(;v<c&&Xe[v]==64;)v++;let w=d&&p==8||v<t&&Xe[v]==8?m==1?1:8:256;for(let k=d;k<v;k++)Xe[k]=w;d=v-1}else b==8&&m==1&&(Xe[d]=1);p=b,b&7&&(m=b)}}}function dj(i,e,t,n,s){let l=s==1?2:1;for(let a=0,c=0,h=0;a<=n.length;a++){let d=a?n[a-1].to:e,p=a<n.length?n[a].from:t;for(let m=d,b,v,w;m<p;m++)if(v=gy[b=i.charCodeAt(m)])if(v<0){for(let k=c-3;k>=0;k-=3)if(En[k+1]==-v){let _=En[k+2],O=_&2?s:_&4?_&1?l:s:0;O&&(Xe[m]=Xe[En[k]]=O),c=k;break}}else{if(En.length==189)break;En[c++]=m,En[c++]=b,En[c++]=h}else if((w=Xe[m])==2||w==1){let k=w==s;h=k?0:1;for(let _=c-3;_>=0;_-=3){let O=En[_+2];if(O&2)break;if(k)En[_+2]|=2;else{if(O&4)break;En[_+2]|=4}}}}}function pj(i,e,t,n){for(let s=0,l=n;s<=t.length;s++){let a=s?t[s-1].to:i,c=s<t.length?t[s].from:e;for(let h=a;h<c;){let d=Xe[h];if(d==256){let p=h+1;for(;;)if(p==c){if(s==t.length)break;p=t[s++].to,c=s<t.length?t[s].from:e}else if(Xe[p]==256)p++;else break;let m=l==1,b=(p<e?Xe[p]:n)==1,v=m==b?m?1:2:n;for(let w=p,k=s,_=k?t[k-1].to:i;w>h;)w==_&&(w=t[--k].from,_=k?t[k-1].to:i),Xe[--w]=v;h=p}else l=d,h++}}}function my(i,e,t,n,s,l,a){let c=n%2?2:1;if(n%2==s%2)for(let h=e,d=0;h<t;){let p=!0,m=!1;if(d==l.length||h<l[d].from){let k=Xe[h];k!=c&&(p=!1,m=k==16)}let b=!p&&c==1?[]:null,v=p?n:n+1,w=h;e:for(;;)if(d<l.length&&w==l[d].from){if(m)break e;let k=l[d];if(!p)for(let _=k.to,O=d+1;;){if(_==t)break e;if(O<l.length&&l[O].from==_)_=l[O++].to;else{if(Xe[_]==c)break e;break}}if(d++,b)b.push(k);else{k.from>h&&a.push(new ps(h,k.from,v));let _=k.direction==el!=!(v%2);yy(i,_?n+1:n,s,k.inner,k.from,k.to,a),h=k.to}w=k.to}else{if(w==t||(p?Xe[w]!=c:Xe[w]==c))break;w++}b?my(i,h,w,n+1,s,b,a):h<w&&a.push(new ps(h,w,v)),h=w}else for(let h=t,d=l.length;h>e;){let p=!0,m=!1;if(!d||h>l[d-1].to){let k=Xe[h-1];k!=c&&(p=!1,m=k==16)}let b=!p&&c==1?[]:null,v=p?n:n+1,w=h;e:for(;;)if(d&&w==l[d-1].to){if(m)break e;let k=l[--d];if(!p)for(let _=k.from,O=d;;){if(_==e)break e;if(O&&l[O-1].to==_)_=l[--O].from;else{if(Xe[_-1]==c)break e;break}}if(b)b.push(k);else{k.to<h&&a.push(new ps(k.to,h,v));let _=k.direction==el!=!(v%2);yy(i,_?n+1:n,s,k.inner,k.from,k.to,a),h=k.from}w=k.from}else{if(w==e||(p?Xe[w-1]!=c:Xe[w-1]==c))break;w--}b?my(i,w,h,n+1,s,b,a):w<h&&a.push(new ps(w,h,v)),h=w}}function yy(i,e,t,n,s,l,a){let c=e%2?2:1;fj(i,s,l,n,c),dj(i,s,l,n,c),pj(s,l,n,c),my(i,s,l,e,t,n,a)}function gj(i,e,t){if(!i)return[new ps(0,0,e==Ob?1:0)];if(e==el&&!t.length&&!hj.test(i))return zC(i.length);if(t.length)for(;i.length>Xe.length;)Xe[Xe.length]=256;let n=[],s=e==el?0:1;return yy(i,s,s,t,0,i.length,n),n}function zC(i){return[new ps(0,i,0)]}let IC="";function mj(i,e,t,n,s){var l;let a=n.head-i.from,c=ps.find(e,a,(l=n.bidiLevel)!==null&&l!==void 0?l:-1,n.assoc),h=e[c],d=h.side(s,t);if(a==d){let b=c+=s?1:-1;if(b<0||b>=e.length)return null;h=e[c=b],a=h.side(!s,t),d=h.side(s,t)}let p=Ct(i.text,a,h.forward(s,t));(p<h.from||p>h.to)&&(p=d),IC=i.text.slice(Math.min(a,p),Math.max(a,p));let m=c==(s?e.length-1:0)?null:e[c+(s?1:-1)];return m&&p==d&&m.level+(s?0:1)<h.level?$.cursor(m.side(!s,t)+i.from,m.forward(s,t)?1:-1,m.level):$.cursor(p+i.from,h.forward(s,t)?-1:1,h.level)}function yj(i,e,t){for(let n=e;n<t;n++){let s=UC(i.charCodeAt(n));if(s==1)return el;if(s==2||s==4)return Ob}return el}const PC=te.define(),HC=te.define(),qC=te.define(),VC=te.define(),by=te.define(),$C=te.define(),GC=te.define(),Ab=te.define(),Cb=te.define(),KC=te.define({combine:i=>i.some(e=>e)}),WC=te.define({combine:i=>i.some(e=>e)}),YC=te.define();class So{constructor(e,t="nearest",n="nearest",s=5,l=5,a=!1){this.range=e,this.y=t,this.x=n,this.yMargin=s,this.xMargin=l,this.isSnapshot=a}map(e){return e.empty?this:new So(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new So($.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Hh=_e.define({map:(i,e)=>i.map(e)}),FC=_e.define();function gi(i,e,t){let n=i.facet(VC);n.length?n[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const ds=te.define({combine:i=>i.length?i[0]:!0});let bj=0;const oo=te.define({combine(i){return i.filter((e,t)=>{for(let n=0;n<t;n++)if(i[n].plugin==e.plugin)return!1;return!0})}});class lt{constructor(e,t,n,s,l){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=s,this.baseExtensions=l(this),this.extension=this.baseExtensions.concat(oo.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(oo.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:n,eventObservers:s,provide:l,decorations:a}=t||{};return new lt(bj++,e,n,s,c=>{let h=[];return a&&h.push(Rd.of(d=>{let p=d.plugin(c);return p?a(p):ue.none})),l&&h.push(l(c)),h})}static fromClass(e,t){return lt.define((n,s)=>new e(n,s),t)}}class zm{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(gi(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){gi(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){gi(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const XC=te.define(),Tb=te.define(),Rd=te.define(),QC=te.define(),Eb=te.define(),nu=te.define(),JC=te.define();function Ex(i,e){let t=i.state.facet(JC);if(!t.length)return t;let n=t.map(l=>l instanceof Function?l(i):l),s=[];return De.spans(n,e.from,e.to,{point(){},span(l,a,c,h){let d=l-e.from,p=a-e.from,m=s;for(let b=c.length-1;b>=0;b--,h--){let v=c[b].spec.bidiIsolate,w;if(v==null&&(v=yj(e.text,d,p)),h>0&&m.length&&(w=m[m.length-1]).to==d&&w.direction==v)w.to=p,m=w.inner;else{let k={from:d,to:p,direction:v,inner:[]};m.push(k),m=k.inner}}}}),s}const ZC=te.define();function Db(i){let e=0,t=0,n=0,s=0;for(let l of i.state.facet(ZC)){let a=l(i);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(t=Math.max(t,a.right)),a.top!=null&&(n=Math.max(n,a.top)),a.bottom!=null&&(s=Math.max(s,a.bottom)))}return{left:e,right:t,top:n,bottom:s}}const Ja=te.define();class en{constructor(e,t,n,s){this.fromA=e,this.toA=t,this.fromB=n,this.toB=s}join(e){return new en(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>n.toA)){if(s.toA<n.fromA)break;n=n.join(s),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let s=0,l=0,a=0;;){let c=s<e.length?e[s].fromB:1e9,h=l<t.length?t[l]:1e9,d=Math.min(c,h);if(d==1e9)break;let p=d+a,m=d,b=p;for(;;)if(l<t.length&&t[l]<=m){let v=t[l+1];l+=2,m=Math.max(m,v);for(let w=s;w<e.length&&e[w].fromB<=m;w++)a=e[w].toA-e[w].toB;b=Math.max(b,v+a)}else if(s<e.length&&e[s].fromB<=m){let v=e[s++];m=Math.max(m,v.toB),b=Math.max(b,v.toA),a=v.toA-v.toB}else break;n.push(new en(p,b,d,m))}return n}}class Vf{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=At.empty(this.startState.doc.length);for(let l of n)this.changes=this.changes.compose(l.changes);let s=[];this.changes.iterChangedRanges((l,a,c,h)=>s.push(new en(l,a,c,h))),this.changedRanges=s}static create(e,t,n){return new Vf(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const vj=[];class kt{constructor(e,t,n=0){this.dom=e,this.length=t,this.flags=n,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return vj}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let t=this.domAttrs;t&&ej(this.dom,t)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,t=this.posAtStart){let n=t;for(let s of this.children){if(s==e)return n;n+=s.length+s.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,t){return null}domPosFor(e,t){let n=or(this.dom),s=this.length?e>0:t>0;return new mn(this.parent.dom,n+(s?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof Nd)return e;return null}static get(e){return e.cmTile}}class Md extends kt{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let t=this.dom,n=null,s,l=e?.node==t?e:null,a=0;for(let c of this.children){if(c.sync(e),a+=c.length+c.breakAfter,s=n?n.nextSibling:t.firstChild,l&&s!=c.dom&&(l.written=!0),c.dom.parentNode==t)for(;s&&s!=c.dom;)s=Dx(s);else t.insertBefore(c.dom,s);n=c.dom}for(s=n?n.nextSibling:t.firstChild,l&&s&&(l.written=!0);s;)s=Dx(s);this.length=a}}function Dx(i){let e=i.nextSibling;return i.parentNode.removeChild(i),e}class Nd extends Md{constructor(e,t){super(t),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let t=kt.get(e);if(t&&this.owns(t))return t;e=e.parentNode}}blockTiles(e){for(let t=[],n=this,s=0,l=0;;)if(s==n.children.length){if(!t.length)return;n=n.parent,n.breakAfter&&l++,s=t.pop()}else{let a=n.children[s++];if(a instanceof ir)t.push(s),n=a,s=0;else{let c=l+a.length,h=e(a,l);if(h!==void 0)return h;l=c+a.breakAfter}}}resolveBlock(e,t){let n,s=-1,l,a=-1;if(this.blockTiles((c,h)=>{let d=h+c.length;if(e>=h&&e<=d){if(c.isWidget()&&t>=-1&&t<=1){if(c.flags&32)return!0;c.flags&16&&(n=void 0)}(h<e||e==d&&(t<-1?c.length:c.covers(1)))&&(!n||!c.isWidget()&&n.isWidget())&&(n=c,s=e-h),(d>e||e==h&&(t>1?c.length:c.covers(-1)))&&(!l||!c.isWidget()&&l.isWidget())&&(l=c,a=e-h)}}),!n&&!l)throw new Error("No tile at position "+e);return n&&t<0||!l?{tile:n,offset:s}:{tile:l,offset:a}}}class ir extends Md{constructor(e,t){super(e),this.wrapper=t}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,t){let n=new ir(t||document.createElement(e.tagName),e);return t||(n.flags|=4),n}}class Bo extends Md{constructor(e,t){super(e),this.attrs=t}isLine(){return!0}static start(e,t,n){let s=new Bo(t||document.createElement("div"),e);return(!t||!n)&&(s.flags|=4),s}get domAttrs(){return this.attrs}resolveInline(e,t,n){let s=null,l=-1,a=null,c=-1;function h(p,m){for(let b=0,v=0;b<p.children.length&&v<=m;b++){let w=p.children[b],k=v+w.length;k>=m&&(w.isComposite()?h(w,m-v):(!a||a.isHidden&&(t>0||n&&Sj(a,w)))&&(k>m||w.flags&32)?(a=w,c=m-v):(v<m||w.flags&16&&!w.isHidden)&&(s=w,l=m-v)),v=k}}h(this,e);let d=(t<0?s:a)||s||a;return d?{tile:d,offset:d==s?l:c}:null}coordsIn(e,t){let n=this.resolveInline(e,t,!0);return n?n.tile.coordsIn(Math.max(0,n.offset),t):wj(this)}domIn(e,t){let n=this.resolveInline(e,t);if(n){let{tile:s,offset:l}=n;if(this.dom.contains(s.dom))return s.isText()?new mn(s.dom,Math.min(s.dom.nodeValue.length,l)):s.domPosFor(l,s.flags&16?1:s.flags&32?-1:t);let a=n.tile.parent,c=!1;for(let h of a.children){if(c)return new mn(h.dom,0);h==n.tile&&(c=!0)}}return new mn(this.dom,0)}}function wj(i){let e=i.dom.lastChild;if(!e)return i.dom.getBoundingClientRect();let t=gf(e);return t[t.length-1]||null}function Sj(i,e){let t=i.coordsIn(0,1),n=e.coordsIn(0,1);return t&&n&&n.top<t.bottom}class pi extends Md{constructor(e,t){super(e),this.mark=t}get domAttrs(){return this.mark.attrs}static of(e,t){let n=new pi(t||document.createElement(e.tagName),e);return t||(n.flags|=4),n}}class qr extends kt{constructor(e,t){super(e,t.length),this.text=t}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,t){let n=this.dom.nodeValue.length;e>n&&(e=n);let s=e,l=e,a=0;e==0&&t<0||e==n&&t>=0?ne.chrome||ne.gecko||(e?(s--,a=1):l<n&&(l++,a=-1)):t<0?s--:l<n&&l++;let c=Uc(this.dom,s,l).getClientRects();if(!c.length)return null;let h=c[(a?a<0:t>=0)?0:c.length-1];return ne.safari&&!a&&h.width==0&&(h=Array.prototype.find.call(c,d=>d.width)||h),a?qf(h,a<0):h||null}static of(e,t){let n=new qr(t||document.createTextNode(e),e);return t||(n.flags|=2),n}}class tl extends kt{constructor(e,t,n,s){super(e,t,s),this.widget=n}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,t){return this.coordsInWidget(e,t,!1)}coordsInWidget(e,t,n){let s=this.widget.coordsAt(this.dom,e,t);if(s)return s;if(n)return qf(this.dom.getBoundingClientRect(),this.length?e==0:t<=0);{let l=this.dom.getClientRects(),a=null;if(!l.length)return null;let c=this.flags&16?!0:this.flags&32?!1:e>0;for(let h=c?l.length-1:0;a=l[h],!(e>0?h==0:h==l.length-1||a.top<a.bottom);h+=c?-1:1);return qf(a,!c)}}get overrideDOMText(){if(!this.length)return He.empty;let{root:e}=this;if(!e)return He.empty;let t=this.posAtStart;return e.view.state.doc.slice(t,t+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,t,n,s,l){return l||(l=e.toDOM(t),e.editable||(l.contentEditable="false")),new tl(l,n,e,s)}}class $f extends kt{constructor(e){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),super(t,0,e)}get isHidden(){return!0}get overrideDOMText(){return He.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class kj{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,t,n){let{tile:s,index:l,beforeBreak:a,parents:c}=this;for(;e||t>0;)if(s.isComposite())if(a){if(!e)break;n&&n.break(),e--,a=!1}else if(l==s.children.length){if(!e&&!c.length)break;n&&n.leave(s),a=!!s.breakAfter,{tile:s,index:l}=c.pop(),l++}else{let h=s.children[l],d=h.breakAfter;(t>0?h.length<=e:h.length<e)&&(!n||n.skip(h,0,h.length)!==!1||!h.isComposite)?(a=!!d,l++,e-=h.length):(c.push({tile:s,index:l}),s=h,l=0,n&&h.isComposite()&&n.enter(h))}else if(l==s.length)a=!!s.breakAfter,{tile:s,index:l}=c.pop(),l++;else if(e){let h=Math.min(e,s.length-l);n&&n.skip(s,l,l+h),e-=h,l+=h}else break;return this.tile=s,this.index=l,this.beforeBreak=a,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class xj{constructor(e,t,n,s){this.from=e,this.to=t,this.wrapper=n,this.rank=s}}class _j{constructor(e,t,n){this.cache=e,this.root=t,this.blockWrappers=n,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,t,n,s){var l;this.flushBuffer();let a=this.ensureMarks(t,n),c=a.lastChild;if(c&&c.isText()&&!(c.flags&8)&&c.length+e.length<512){this.cache.reused.set(c,2);let h=a.children[a.children.length-1]=new qr(c.dom,c.text+e);h.parent=a}else a.append(s||qr.of(e,(l=this.cache.find(qr))===null||l===void 0?void 0:l.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,t){let n=this.curLine;n.dom!=t.line.dom&&(n.setDOM(this.cache.reused.has(t.line)?Im(t.line.dom):t.line.dom),this.cache.reused.set(t.line,2));let s=n;for(let c=t.marks.length-1;c>=0;c--){let h=t.marks[c],d=s.lastChild;if(d instanceof pi&&d.mark.eq(h.mark))d.dom!=h.dom&&d.setDOM(Im(h.dom)),s=d;else{if(this.cache.reused.get(h)){let m=kt.get(h.dom);m&&m.setDOM(Im(h.dom))}let p=pi.of(h.mark,h.dom);s.append(p),s=p}this.cache.reused.set(h,2)}let l=kt.get(e.text);l&&this.cache.reused.set(l,2);let a=new qr(e.text,e.text.nodeValue);a.flags|=8,s.append(a)}addInlineWidget(e,t,n){let s=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);s||this.flushBuffer();let l=this.ensureMarks(t,n);!s&&!(e.flags&16)&&l.append(this.getBuffer(1)),l.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,t,n){this.flushBuffer(),this.ensureMarks(t,n).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let t=this.afterWidget||this.lastBlock;t.length+=e,this.pos+=e}addLineStart(e,t){var n;e||(e=eT);let s=Bo.start(e,t||((n=this.cache.find(Bo))===null||n===void 0?void 0:n.dom),!!t);this.getBlockPos().append(this.lastBlock=this.curLine=s)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,t){var n;let s=this.curLine;for(let l=e.length-1;l>=0;l--){let a=e[l],c;if(t>0&&(c=s.lastChild)&&c instanceof pi&&c.mark.eq(a))s=c,t--;else{let h=pi.of(a,(n=this.cache.find(pi,d=>d.mark.eq(a)))===null||n===void 0?void 0:n.dom);s.append(h),s=h,t=0}}return s}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!Rx(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(ne.ios&&Rx(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(Pm,0,32)||new tl(Pm.toDOM(),0,Pm,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let t=new xj(e.from,e.to,e.value,e.rank),n=this.wrappers.length;for(;n>0&&(this.wrappers[n-1].rank-t.rank||this.wrappers[n-1].to-t.to)<0;)n--;this.wrappers.splice(n,0,t)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let t=this.root;for(let n of this.wrappers){let s=t.lastChild;if(n.from<this.pos&&s instanceof ir&&s.wrapper.eq(n.wrapper))t=s;else{let l=ir.of(n.wrapper,(e=this.cache.find(ir,a=>a.wrapper.eq(n.wrapper)))===null||e===void 0?void 0:e.dom);t.append(l),t=l}}return t}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let t=2|(e<0?16:32),n=this.cache.find($f,void 0,1);return n&&(n.flags=t),n||new $f(t)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class Oj{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:s,lineBreak:l,done:a}=this.cursor.next(this.skipCount);if(this.skipCount=0,a)throw new Error("Ran out of text content when drawing inline views");this.text=s;let c=this.textOff=Math.min(e,s.length);return l?null:s.slice(0,c)}let t=Math.min(this.text.length,this.textOff+e),n=this.text.slice(this.textOff,t);return this.textOff=t,n}}const Gf=[tl,Bo,qr,pi,$f,ir,Nd];for(let i=0;i<Gf.length;i++)Gf[i].bucket=i;class Aj{constructor(e){this.view=e,this.buckets=Gf.map(()=>[]),this.index=Gf.map(()=>0),this.reused=new Map}add(e){let t=e.constructor.bucket,n=this.buckets[t];n.length<6?n.push(e):n[this.index[t]=(this.index[t]+1)%6]=e}find(e,t,n=2){let s=e.bucket,l=this.buckets[s],a=this.index[s];for(let c=l.length-1;c>=0;c--){let h=(c+a)%l.length,d=l[h];if((!t||t(d))&&!this.reused.has(d))return l.splice(h,1),h<a&&this.index[s]--,this.reused.set(d,n),d}return null}findWidget(e,t,n){let s=this.buckets[0];if(s.length)for(let l=0,a=0;;l++){if(l==s.length){if(a)return null;a=1,l=0}let c=s[l];if(!this.reused.has(c)&&(a==0?c.widget.compare(e):c.widget.constructor==e.constructor&&e.updateDOM(c.dom,this.view)))return s.splice(l,1),l<this.index[0]&&this.index[0]--,c.widget==e&&c.length==t&&(c.flags&497)==n?(this.reused.set(c,1),c):(this.reused.set(c,2),new tl(c.dom,t,e,c.flags&-498|n))}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,t=2){if(!this.reused.has(e))return this.reused.set(e,t),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class Cj{constructor(e,t,n,s,l){this.view=e,this.decorations=s,this.disallowBlockEffectsFor=l,this.openWidget=!1,this.openMarks=0,this.cache=new Aj(e),this.text=new Oj(e.state.doc),this.builder=new _j(this.cache,new Nd(e,e.contentDOM),De.iter(n)),this.cache.reused.set(t,2),this.old=new kj(t),this.reuseWalker={skip:(a,c,h)=>{if(this.cache.add(a),a.isComposite())return!1},enter:a=>this.cache.add(a),leave:()=>{},break:()=>{}}}run(e,t){let n=t&&this.getCompositionContext(t.text);for(let s=0,l=0,a=0;;){let c=a<e.length?e[a++]:null,h=c?c.fromA:this.old.root.length;if(h>s){let d=h-s;this.preserve(d,!a,!c),s=h,l+=d}if(!c)break;t&&c.fromA<=t.range.fromA&&c.toA>=t.range.toA?(this.forward(c.fromA,t.range.fromA,t.range.fromA<t.range.toA?1:-1),this.emit(l,t.range.fromB),this.cache.clear(),this.builder.addComposition(t,n),this.text.skip(t.range.toB-t.range.fromB),this.forward(t.range.fromA,c.toA),this.emit(t.range.toB,c.toB)):(this.forward(c.fromA,c.toA),this.emit(l,c.toB)),l=c.toB,s=c.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,t,n){let s=Dj(this.old),l=this.openMarks;this.old.advance(e,n?1:-1,{skip:(a,c,h)=>{if(a.isWidget())if(this.openWidget)this.builder.continueWidget(h-c);else{let d=h>0||c<a.length?tl.of(a.widget,this.view,h-c,a.flags&496,this.cache.maybeReuse(a)):this.cache.reuse(a);d.flags&256?(d.flags&=-2,this.builder.addBlockWidget(d)):(this.builder.ensureLine(null),this.builder.addInlineWidget(d,s,l),l=s.length)}else if(a.isText())this.builder.ensureLine(null),!c&&h==a.length?this.builder.addText(a.text,s,l,this.cache.reuse(a)):(this.cache.add(a),this.builder.addText(a.text.slice(c,h),s,l)),l=s.length;else if(a.isLine())a.flags&=-2,this.cache.reused.set(a,1),this.builder.addLine(a);else if(a instanceof $f)this.cache.add(a);else if(a instanceof pi)this.builder.ensureLine(null),this.builder.addMark(a,s,l),this.cache.reused.set(a,1),l=s.length;else return!1;this.openWidget=!1},enter:a=>{a.isLine()?this.builder.addLineStart(a.attrs,this.cache.maybeReuse(a)):(this.cache.add(a),a instanceof pi&&s.unshift(a.mark)),this.openWidget=!1},leave:a=>{a.isLine()?s.length&&(s.length=l=0):a instanceof pi&&(s.shift(),l=Math.min(l,s.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,t){let n=null,s=this.builder,l=0,a=De.spans(this.decorations,e,t,{point:(c,h,d,p,m,b)=>{if(d instanceof Zr){if(this.disallowBlockEffectsFor[b]){if(d.block)throw new RangeError("Block decorations may not be specified via plugins");if(h>this.view.state.doc.lineAt(c).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(l=p.length,m>p.length)s.continueWidget(h-c);else{let v=d.widget||(d.block?Uo.block:Uo.inline),w=Tj(d),k=this.cache.findWidget(v,h-c,w)||tl.of(v,this.view,h-c,w);d.block?(d.startSide>0&&s.addLineStartIfNotCovered(n),s.addBlockWidget(k)):(s.ensureLine(n),s.addInlineWidget(k,p,m))}n=null}else n=Ej(n,d);h>c&&this.text.skip(h-c)},span:(c,h,d,p)=>{for(let m=c;m<h;){let b=this.text.next(Math.min(512,h-m));b==null?(s.addLineStartIfNotCovered(n),s.addBreak(),m++):(s.ensureLine(n),s.addText(b,d,m==c?p:d.length),m+=b.length),n=null}}});s.addLineStartIfNotCovered(n),this.openWidget=a>l,this.openMarks=a}forward(e,t,n=1){t-e<=10?this.old.advance(t-e,n,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(t-e-10,-1),this.old.advance(5,n,this.reuseWalker))}getCompositionContext(e){let t=[],n=null;for(let s=e.parentNode;;s=s.parentNode){let l=kt.get(s);if(s==this.view.contentDOM)break;l instanceof pi?t.push(l):l?.isLine()?n=l:s.nodeName=="DIV"&&!n&&s!=this.view.contentDOM?n=new Bo(s,eT):t.push(pi.of(new tu({tagName:s.nodeName.toLowerCase(),attributes:tj(s)}),s))}return{line:n,marks:t}}}function Rx(i,e){let t=n=>{for(let s of n.children)if((e?s.isText():s.length)||t(s))return!0;return!1};return t(i)}function Tj(i){let e=i.isReplace?(i.startSide<0?64:0)|(i.endSide>0?128:0):i.startSide>0?32:16;return i.block&&(e|=256),e}const eT={class:"cm-line"};function Ej(i,e){let t=e.spec.attributes,n=e.spec.class;return!t&&!n||(i||(i={class:"cm-line"}),t&&xb(t,i),n&&(i.class+=" "+n)),i}function Dj(i){let e=[];for(let t=i.parents.length;t>1;t--){let n=t==i.parents.length?i.tile:i.parents[t].tile;n instanceof pi&&e.push(n.mark)}return e}function Im(i){let e=kt.get(i);return e&&e.setDOM(i.cloneNode()),i}class Uo extends Kn{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Uo.inline=new Uo("span");Uo.block=new Uo("div");const Pm=new class extends Kn{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class Mx{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=ue.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new Nd(e,e.contentDOM),this.updateInner([new en(0,0,0,e.state.doc.length)],null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:p,toA:m})=>m<this.minWidthFrom||p>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?s=this.domChanged.newSel.head:!Ij(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let l=s>-1?Mj(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){let{from:p,to:m}=this.hasComposition;n=new en(p,m,e.changes.mapPos(p,-1),e.changes.mapPos(m,1)).addToSet(n.slice())}this.hasComposition=l?{from:l.range.fromB,to:l.range.toB}:null,(ne.ie||ne.chrome)&&!l&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,c=this.blockWrappers;this.updateDeco();let h=Bj(a,this.decorations,e.changes);h.length&&(n=en.extendWithRanges(n,h));let d=jj(c,this.blockWrappers,e.changes);return d.length&&(n=en.extendWithRanges(n,d)),l&&!n.some(p=>p.fromA<=l.range.fromA&&p.toA>=l.range.toA)&&(n=l.range.addToSet(n.slice())),this.tile.flags&2&&n.length==0?!1:(this.updateInner(n,l),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0;let{observer:n}=this.view;n.ignore(()=>{if(t||e.length){let a=this.tile,c=new Cj(this.view,a,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=c.run(e,t),vy(a,c.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let l=ne.chrome||ne.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(l),l&&(l.written||n.selectionRange.focusNode!=l.node||!this.tile.dom.contains(l.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let l of this.tile.children)l.isWidget()&&l.widget instanceof Hm&&s.push(l.dom);n.updateGaps(s)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let n of t.effects)n.is(FC)&&(this.editContextFormatting=n.value)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:n}=this.tile,s=this.view.root.activeElement,l=s==n,a=!l&&!(this.view.state.facet(ds)||n.tabIndex>-1)&&oc(n,this.view.observer.selectionRange)&&!(s&&n.contains(s));if(!(l||t||a))return;let c=this.forceSelection;this.forceSelection=!1;let h=this.view.state.selection.main,d,p;if(h.empty?p=d=this.inlineDOMNearPos(h.anchor,h.assoc||1):(p=this.inlineDOMNearPos(h.head,h.head==h.from?1:-1),d=this.inlineDOMNearPos(h.anchor,h.anchor==h.from?1:-1)),ne.gecko&&h.empty&&!this.hasComposition&&Rj(d)){let b=document.createTextNode("");this.view.observer.ignore(()=>d.node.insertBefore(b,d.node.childNodes[d.offset]||null)),d=p=new mn(b,0),c=!0}let m=this.view.observer.selectionRange;(c||!m.focusNode||(!ac(d.node,d.offset,m.anchorNode,m.anchorOffset)||!ac(p.node,p.offset,m.focusNode,m.focusOffset))&&!this.suppressWidgetCursorChange(m,h))&&(this.view.observer.ignore(()=>{ne.android&&ne.chrome&&n.contains(m.focusNode)&&zj(m.focusNode,n)&&(n.blur(),n.focus({preventScroll:!0}));let b=Lo(this.view.root);if(b)if(h.empty){if(ne.gecko){let v=Nj(d.node,d.offset);if(v&&v!=3){let w=(v==1?NC:LC)(d.node,d.offset);w&&(d=new mn(w.node,w.offset))}}b.collapse(d.node,d.offset),h.bidiLevel!=null&&b.caretBidiLevel!==void 0&&(b.caretBidiLevel=h.bidiLevel)}else if(b.extend){b.collapse(d.node,d.offset);try{b.extend(p.node,p.offset)}catch{}}else{let v=document.createRange();h.anchor>h.head&&([d,p]=[p,d]),v.setEnd(p.node,p.offset),v.setStart(d.node,d.offset),b.removeAllRanges(),b.addRange(v)}a&&this.view.root.activeElement==n&&(n.blur(),s&&s.focus())}),this.view.observer.setSelectionRange(d,p)),this.impreciseAnchor=d.precise?null:new mn(m.anchorNode,m.anchorOffset),this.impreciseHead=p.precise?null:new mn(m.focusNode,m.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&ac(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=Lo(e.root),{anchorNode:s,anchorOffset:l}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let a=this.lineAt(t.head,t.assoc);if(!a)return;let c=a.posAtStart;if(t.head==c||t.head==c+a.length)return;let h=this.coordsAt(t.head,-1),d=this.coordsAt(t.head,1);if(!h||!d||h.bottom>d.top)return;let p=this.domAtPos(t.head+t.assoc,t.assoc);n.collapse(p.node,p.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let m=e.observer.selectionRange;e.docView.posFromDOM(m.anchorNode,m.anchorOffset)!=t.from&&n.collapse(s,l)}posFromDOM(e,t){let n=this.tile.nearest(e);if(!n)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let s=n.posAtStart;if(n.isComposite()){let l;if(e==n.dom)l=n.dom.childNodes[t];else{let a=ys(e)==0?0:t==0?-1:1;for(;;){let c=e.parentNode;if(c==n.dom)break;a==0&&c.firstChild!=c.lastChild&&(e==c.firstChild?a=-1:a=1),e=c}a<0?l=e:l=e.nextSibling}if(l==n.dom.firstChild)return s;for(;l&&!kt.get(l);)l=l.nextSibling;if(!l)return s+n.length;for(let a=0,c=s;;a++){let h=n.children[a];if(h.dom==l)return c;c+=h.length+h.breakAfter}}else return n.isText()?e==n.dom?s+t:s+(t?n.length:0):s}domAtPos(e,t){let{tile:n,offset:s}=this.tile.resolveBlock(e,t);return n.isWidget()?n.domPosFor(e,t):n.domIn(s,t)}inlineDOMNearPos(e,t){let n,s=-1,l=!1,a,c=-1,h=!1;return this.tile.blockTiles((d,p)=>{if(d.isWidget()){if(d.flags&32&&p>=e)return!0;d.flags&16&&(l=!0)}else{let m=p+d.length;if(p<=e&&(n=d,s=e-p,l=m<e),m>=e&&!a&&(a=d,c=e-p,h=p>e),p>e&&a)return!0}}),!n&&!a?this.domAtPos(e,t):(l&&a?n=null:h&&n&&(a=null),n&&t<0||!a?n.domIn(s,t):a.domIn(c,t))}coordsAt(e,t){let{tile:n,offset:s}=this.tile.resolveBlock(e,t);return n.isWidget()?n.widget instanceof Hm?null:n.coordsInWidget(s,t,!0):n.coordsIn(s,t)}lineAt(e,t){let{tile:n}=this.tile.resolveBlock(e,t);return n.isLine()?n:null}coordsForChar(e){let{tile:t,offset:n}=this.tile.resolveBlock(e,1);if(!t.isLine())return null;function s(l,a){if(l.isComposite())for(let c of l.children){if(c.length>=a){let h=s(c,a);if(h)return h}if(a-=c.length,a<0)break}else if(l.isText()&&a<l.length){let c=Ct(l.text,a);if(c==a)return null;let h=Uc(l.dom,a,c).getClientRects();for(let d=0;d<h.length;d++){let p=h[d];if(d==h.length-1||p.top<p.bottom&&p.left<p.right)return p}}return null}return s(t,n)}measureVisibleLineHeights(e){let t=[],{from:n,to:s}=e,l=this.view.contentDOM.clientWidth,a=l>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,c=-1,h=this.view.textDirection==Ze.LTR,d=0,p=(m,b,v)=>{for(let w=0;w<m.children.length&&!(b>s);w++){let k=m.children[w],_=b+k.length,O=k.dom.getBoundingClientRect(),{height:R}=O;if(v&&!w&&(d+=O.top-v.top),k instanceof ir)_>n&&p(k,b,O);else if(b>=n&&(d>0&&t.push(-d),t.push(R+d),d=0,a)){let C=k.dom.lastChild,N=C?gf(C):[];if(N.length){let j=N[N.length-1],H=h?j.right-O.left:O.right-j.left;H>c&&(c=H,this.minWidth=l,this.minWidthFrom=b,this.minWidthTo=_)}}v&&w==m.children.length-1&&(d+=v.bottom-O.bottom),b=_+k.breakAfter}};return p(this.tile,0,null),t}textDirectionAt(e){let{tile:t}=this.tile.resolveBlock(e,1);return getComputedStyle(t.dom).direction=="rtl"?Ze.RTL:Ze.LTR}measureTextSize(){let e=this.tile.blockTiles(a=>{if(a.isLine()&&a.children.length&&a.length<=20){let c=0,h;for(let d of a.children){if(!d.isText()||/[^ -~]/.test(d.text))return;let p=gf(d.dom);if(p.length!=1)return;c+=p[0].width,h=p[0].height}if(c)return{lineHeight:a.dom.getBoundingClientRect().height,charWidth:c/a.length,textHeight:h}}});if(e)return e;let t=document.createElement("div"),n,s,l;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(t);let a=gf(t.firstChild)[0];n=t.getBoundingClientRect().height,s=a&&a.width?a.width/27:7,l=a&&a.height?a.height:n,t.remove()}),{lineHeight:n,charWidth:s,textHeight:l}}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,s=0;;s++){let l=s==t.viewports.length?null:t.viewports[s],a=l?l.from-1:this.view.state.doc.length;if(a>n){let c=(t.lineBlockAt(a).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(ue.replace({widget:new Hm(c),block:!0,inclusive:!0,isBlockGap:!0}).range(n,a))}if(!l)break;n=l.to+1}return ue.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Rd).map(l=>(this.dynamicDecorationMap[e++]=typeof l=="function")?l(this.view):l),n=!1,s=this.view.state.facet(Eb).map((l,a)=>{let c=typeof l=="function";return c&&(n=!0),c?l(this.view):l});for(s.length&&(this.dynamicDecorationMap[e++]=n,t.push(De.join(s))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(QC).map(l=>typeof l=="function"?l(this.view):l)}scrollIntoView(e){if(e.isSnapshot){let d=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=d.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let d of this.view.state.facet(YC))try{if(d(this.view,e.range,e))return!0}catch(p){gi(this.view.state,p,"scroll handler")}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!n)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,s.left),top:Math.min(n.top,s.top),right:Math.max(n.right,s.right),bottom:Math.max(n.bottom,s.bottom)});let l=Db(this.view),a={left:n.left-l.left,top:n.top-l.top,right:n.right+l.right,bottom:n.bottom+l.bottom},{offsetWidth:c,offsetHeight:h}=this.view.scrollDOM;sj(this.view.scrollDOM,a,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,c),-c),Math.max(Math.min(e.yMargin,h),-h),this.view.textDirection==Ze.LTR)}lineHasWidget(e){let t=n=>n.isWidget()||n.children.some(t);return t(this.tile.resolveBlock(e,1).tile)}destroy(){vy(this.tile)}}function vy(i,e){let t=e?.get(i);if(t!=1){t==null&&i.destroy();for(let n of i.children)vy(n,e)}}function Rj(i){return i.node.nodeType==1&&i.node.firstChild&&(i.offset==0||i.node.childNodes[i.offset-1].contentEditable=="false")&&(i.offset==i.node.childNodes.length||i.node.childNodes[i.offset].contentEditable=="false")}function tT(i,e){let t=i.observer.selectionRange;if(!t.focusNode)return null;let n=NC(t.focusNode,t.focusOffset),s=LC(t.focusNode,t.focusOffset),l=n||s;if(s&&n&&s.node!=n.node){let c=kt.get(s.node);if(!c||c.isText()&&c.text!=s.node.nodeValue)l=s;else if(i.docView.lastCompositionAfterCursor){let h=kt.get(n.node);!h||h.isText()&&h.text!=n.node.nodeValue||(l=s)}}if(i.docView.lastCompositionAfterCursor=l!=n,!l)return null;let a=e-l.offset;return{from:a,to:a+l.node.nodeValue.length,node:l.node}}function Mj(i,e,t){let n=tT(i,t);if(!n)return null;let{node:s,from:l,to:a}=n,c=s.nodeValue;if(/[\n\r]/.test(c)||i.state.doc.sliceString(n.from,n.to)!=c)return null;let h=e.invertedDesc;return{range:new en(h.mapPos(l),h.mapPos(a),l,a),text:s}}function Nj(i,e){return i.nodeType!=1?0:(e&&i.childNodes[e-1].contentEditable=="false"?1:0)|(e<i.childNodes.length&&i.childNodes[e].contentEditable=="false"?2:0)}let Lj=class{constructor(){this.changes=[]}compareRange(e,t){vo(e,t,this.changes)}comparePoint(e,t){vo(e,t,this.changes)}boundChange(e){vo(e,e,this.changes)}};function Bj(i,e,t){let n=new Lj;return De.compare(i,e,t,n),n.changes}class Uj{constructor(){this.changes=[]}compareRange(e,t){vo(e,t,this.changes)}comparePoint(){}boundChange(e){vo(e,e,this.changes)}}function jj(i,e,t){let n=new Uj;return De.compare(i,e,t,n),n.changes}function zj(i,e){for(let t=i;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function Ij(i,e){let t=!1;return e&&i.iterChangedRanges((n,s)=>{n<e.to&&s>e.from&&(t=!0)}),t}class Hm extends Kn{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function Pj(i,e,t=1){let n=i.charCategorizer(e),s=i.doc.lineAt(e),l=e-s.from;if(s.length==0)return $.cursor(e);l==0?t=1:l==s.length&&(t=-1);let a=l,c=l;t<0?a=Ct(s.text,l,!1):c=Ct(s.text,l);let h=n(s.text.slice(a,c));for(;a>0;){let d=Ct(s.text,a,!1);if(n(s.text.slice(d,a))!=h)break;a=d}for(;c<s.length;){let d=Ct(s.text,c);if(n(s.text.slice(c,d))!=h)break;c=d}return $.range(a+s.from,c+s.from)}function Hj(i,e,t,n,s){let l=Math.round((n-e.left)*i.defaultCharacterWidth);if(i.lineWrapping&&t.height>i.defaultLineHeight*1.5){let c=i.viewState.heightOracle.textHeight,h=Math.floor((s-t.top-(i.defaultLineHeight-c)*.5)/c);l+=h*i.viewState.heightOracle.lineLength}let a=i.state.sliceDoc(t.from,t.to);return t.from+oy(a,l,i.state.tabSize)}function wy(i,e,t){let n=i.lineBlockAt(e);if(Array.isArray(n.type)){let s;for(let l of n.type){if(l.from>e)break;if(!(l.to<e)){if(l.from<e&&l.to>e)return l;(!s||l.type==Gt.Text&&(s.type!=l.type||(t<0?l.from<e:l.to>e)))&&(s=l)}}return s||n}return n}function qj(i,e,t,n){let s=wy(i,e.head,e.assoc||-1),l=!n||s.type!=Gt.Text||!(i.lineWrapping||s.widgetLineBreaks)?null:i.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(l){let a=i.dom.getBoundingClientRect(),c=i.textDirectionAt(s.from),h=i.posAtCoords({x:t==(c==Ze.LTR)?a.right-1:a.left+1,y:(l.top+l.bottom)/2});if(h!=null)return $.cursor(h,t?-1:1)}return $.cursor(t?s.to:s.from,t?-1:1)}function Nx(i,e,t,n){let s=i.state.doc.lineAt(e.head),l=i.bidiSpans(s),a=i.textDirectionAt(s.from);for(let c=e,h=null;;){let d=mj(s,l,a,c,t),p=IC;if(!d){if(s.number==(t?i.state.doc.lines:1))return c;p=`
`,s=i.state.doc.line(s.number+(t?1:-1)),l=i.bidiSpans(s),d=i.visualLineSide(s,!t)}if(h){if(!h(p))return c}else{if(!n)return d;h=n(p)}c=d}}function Vj(i,e,t){let n=i.state.charCategorizer(e),s=n(t);return l=>{let a=n(l);return s==rt.Space&&(s=a),s==a}}function $j(i,e,t,n){let s=e.head,l=t?1:-1;if(s==(t?i.state.doc.length:0))return $.cursor(s,e.assoc);let a=e.goalColumn,c,h=i.contentDOM.getBoundingClientRect(),d=i.coordsAtPos(s,e.assoc||-1),p=i.documentTop;if(d)a==null&&(a=d.left-h.left),c=l<0?d.top:d.bottom;else{let w=i.viewState.lineBlockAt(s);a==null&&(a=Math.min(h.right-h.left,i.defaultCharacterWidth*(s-w.from))),c=(l<0?w.top:w.bottom)+p}let m=h.left+a,b=n??i.viewState.heightOracle.textHeight>>1,v=Sy(i,{x:m,y:c+b*l},!1,l);return $.cursor(v.pos,v.assoc,void 0,a)}function cc(i,e,t){for(;;){let n=0;for(let s of i)s.between(e-1,e+1,(l,a,c)=>{if(e>l&&e<a){let h=n||t||(e-l<a-e?-1:1);e=h<0?l:a,n=h}});if(!n)return e}}function iT(i,e){let t=null;for(let n=0;n<e.ranges.length;n++){let s=e.ranges[n],l=null;if(s.empty){let a=cc(i,s.from,0);a!=s.from&&(l=$.cursor(a,-1))}else{let a=cc(i,s.from,-1),c=cc(i,s.to,1);(a!=s.from||c!=s.to)&&(l=$.range(s.from==s.anchor?a:c,s.from==s.head?a:c))}l&&(t||(t=e.ranges.slice()),t[n]=l)}return t?$.create(t,e.mainIndex):e}function qm(i,e,t){let n=cc(i.state.facet(nu).map(s=>s(i)),t.from,e.head>t.from?-1:1);return n==t.from?t:$.cursor(n,n<t.from?1:-1)}class Bn{constructor(e,t){this.pos=e,this.assoc=t}}function Sy(i,e,t,n){let s=i.contentDOM.getBoundingClientRect(),l=s.top+i.viewState.paddingTop,{x:a,y:c}=e,h=c-l,d;for(;;){if(h<0)return new Bn(0,1);if(h>i.viewState.docHeight)return new Bn(i.state.doc.length,-1);if(d=i.elementAtHeight(h),n==null)break;if(d.type==Gt.Text){if(n<0?d.to<i.viewport.from:d.from>i.viewport.to)break;let b=i.docView.coordsAt(n<0?d.from:d.to,n);if(b&&(n<0?b.top<=h+l:b.bottom>=h+l))break}let m=i.viewState.heightOracle.textHeight/2;h=n>0?d.bottom+m:d.top-m}if(i.viewport.from>=d.to||i.viewport.to<=d.from){if(t)return null;if(d.type==Gt.Text){let m=Hj(i,s,d,a,c);return new Bn(m,m==d.from?1:-1)}}if(d.type!=Gt.Text)return h<(d.top+d.bottom)/2?new Bn(d.from,1):new Bn(d.to,-1);let p=i.docView.lineAt(d.from,2);return(!p||p.length!=d.length)&&(p=i.docView.lineAt(d.from,-2)),nT(i,p,d.from,a,c)}function nT(i,e,t,n,s){let l=-1,a=null,c=1e9,h=1e9,d=s,p=s,m=(b,v)=>{for(let w=0;w<b.length;w++){let k=b[w];if(k.top==k.bottom)continue;let _=k.left>n?k.left-n:k.right<n?n-k.right:0,O=k.top>s?k.top-s:k.bottom<s?s-k.bottom:0;k.top<=p&&k.bottom>=d&&(d=Math.min(k.top,d),p=Math.max(k.bottom,p),O=0),(l<0||(O-h||_-c)<0)&&(l>=0&&h&&c<_&&a.top<=p-2&&a.bottom>=d+2?h=0:(l=v,c=_,h=O,a=k))}};if(e.isText()){for(let v=0;v<e.length;){let w=Ct(e.text,v);if(m(Uc(e.dom,v,w).getClientRects(),v),!c&&!h)break;v=w}return n>(a.left+a.right)/2==(Lx(i,l+t)==Ze.LTR)?new Bn(t+Ct(e.text,l),-1):new Bn(t+l,1)}else{if(!e.length)return new Bn(t,1);for(let k=0;k<e.children.length;k++){let _=e.children[k];if(_.flags&48)continue;let O=(_.dom.nodeType==1?_.dom:Uc(_.dom,0,_.length)).getClientRects();if(m(O,k),!c&&!h)break}let b=e.children[l],v=e.posBefore(b,t);return b.isComposite()||b.isText()?nT(i,b,v,Math.max(a.left,Math.min(a.right,n)),s):n>(a.left+a.right)/2==(Lx(i,l+t)==Ze.LTR)?new Bn(v+b.length,-1):new Bn(v,1)}}function Lx(i,e){let t=i.state.doc.lineAt(e);return i.bidiSpans(t)[ps.find(i.bidiSpans(t),e-t.from,-1,1)].dir}const Za="";class Gj{constructor(e,t){this.points=e,this.view=t,this.text="",this.lineSeparator=t.state.facet(je.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Za}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let s=e;;){this.findPointBefore(n,s);let l=this.text.length;this.readNode(s);let a=kt.get(s),c=s.nextSibling;if(c==t){a?.breakAfter&&!c&&n!=this.view.contentDOM&&this.lineBreak();break}let h=kt.get(c);(a&&h?a.breakAfter:(a?a.breakAfter:Hf(s))||Hf(c)&&(s.nodeName!="BR"||a?.isWidget())&&this.text.length>l)&&!Wj(c,t)&&this.lineBreak(),s=c}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let l=-1,a=1,c;if(this.lineSeparator?(l=t.indexOf(this.lineSeparator,n),a=this.lineSeparator.length):(c=s.exec(t))&&(l=c.index,a=c[0].length),this.append(t.slice(n,l<0?t.length:l)),l<0)break;if(this.lineBreak(),a>1)for(let h of this.points)h.node==e&&h.pos>this.text.length&&(h.pos-=a-1);n=l+a}}readNode(e){let t=kt.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let s=n.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(Kj(e,n.node,n.offset)?t:0))}}function Kj(i,e,t){for(;;){if(!e||t<ys(e))return!1;if(e==i)return!0;t=or(e)+1,e=e.parentNode}}function Wj(i,e){let t;for(;!(i==e||!i);i=i.nextSibling){let n=kt.get(i);if(!n?.isWidget())return!1;n&&(t||(t=[])).push(n)}if(t)for(let n of t){let s=n.overrideDOMText;if(s?.length)return!1}return!0}class Bx{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class Yj{constructor(e,t,n,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:l,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=sT(e.docView.tile,t,n,0))){let c=l||a?[]:Xj(e),h=new Gj(c,e);h.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=h.text,this.newSel=Qj(c,this.bounds.from)}else{let c=e.observer.selectionRange,h=l&&l.node==c.focusNode&&l.offset==c.focusOffset||!py(e.contentDOM,c.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(c.focusNode,c.focusOffset),d=a&&a.node==c.anchorNode&&a.offset==c.anchorOffset||!py(e.contentDOM,c.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(c.anchorNode,c.anchorOffset),p=e.viewport;if((ne.ios||ne.chrome)&&e.state.selection.main.empty&&h!=d&&(p.from>0||p.to<e.state.doc.length)){let m=Math.min(h,d),b=Math.max(h,d),v=p.from-m,w=p.to-b;(v==0||v==1||m==0)&&(w==0||w==-1||b==e.state.doc.length)&&(h=0,d=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange($.range(d,h)):this.newSel=$.single(d,h)}}}function sT(i,e,t,n){if(i.isComposite()){let s=-1,l=-1,a=-1,c=-1;for(let h=0,d=n,p=n;h<i.children.length;h++){let m=i.children[h],b=d+m.length;if(d<e&&b>t)return sT(m,e,t,d);if(b>=e&&s==-1&&(s=h,l=d),d>t&&m.dom.parentNode==i.dom){a=h,c=p;break}p=b,d=b+m.breakAfter}return{from:l,to:c<0?n+i.length:c,startDOM:(s?i.children[s-1].dom.nextSibling:null)||i.dom.firstChild,endDOM:a<i.children.length&&a>=0?i.children[a].dom:null}}else return i.isText()?{from:n,to:n+i.length,startDOM:i.dom,endDOM:i.dom.nextSibling}:null}function rT(i,e){let t,{newSel:n}=e,s=i.state.selection.main,l=i.inputState.lastKeyTime>Date.now()-100?i.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:c}=e.bounds,h=s.from,d=null;(l===8||ne.android&&e.text.length<c-a)&&(h=s.to,d="end");let p=lT(i.state.doc.sliceString(a,c,Za),e.text,h-a,d);p&&(ne.chrome&&l==13&&p.toB==p.from+2&&e.text.slice(p.from,p.toB)==Za+Za&&p.toB--,t={from:a+p.from,to:a+p.toA,insert:He.of(e.text.slice(p.from,p.toB).split(Za))})}else n&&(!i.hasFocus&&i.state.facet(ds)||Kf(n,s))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!s.empty&&n&&n.main.empty?t={from:s.from,to:s.to,insert:i.state.doc.slice(s.from,s.to)}:(ne.mac||ne.android)&&t&&t.from==t.to&&t.from==s.head-1&&/^\. ?$/.test(t.insert.toString())&&i.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=$.single(n.main.anchor-1,n.main.head-1)),t={from:t.from,to:t.to,insert:He.of([t.insert.toString().replace("."," ")])}):t&&t.from>=s.from&&t.to<=s.to&&(t.from!=s.from||t.to!=s.to)&&s.to-s.from-(t.to-t.from)<=4?t={from:s.from,to:s.to,insert:i.state.doc.slice(s.from,t.from).append(t.insert).append(i.state.doc.slice(t.to,s.to))}:i.state.doc.lineAt(s.from).to<s.to&&i.docView.lineHasWidget(s.to)&&i.inputState.insertingTextAt>Date.now()-50?t={from:s.from,to:s.to,insert:i.state.toText(i.inputState.insertingText)}:ne.chrome&&t&&t.from==t.to&&t.from==s.head&&t.insert.toString()==`
 `&&i.lineWrapping&&(n&&(n=$.single(n.main.anchor-1,n.main.head-1)),t={from:s.from,to:s.to,insert:He.of([" "])}),t)return Rb(i,t,n,l);if(n&&!Kf(n,s)){let a=!1,c="select";return i.inputState.lastSelectionTime>Date.now()-50&&(i.inputState.lastSelectionOrigin=="select"&&(a=!0),c=i.inputState.lastSelectionOrigin,c=="select.pointer"&&(n=iT(i.state.facet(nu).map(h=>h(i)),n))),i.dispatch({selection:n,scrollIntoView:a,userEvent:c}),!0}else return!1}function Rb(i,e,t,n=-1){if(ne.ios&&i.inputState.flushIOSKey(e))return!0;let s=i.state.selection.main;if(ne.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&i.state.sliceDoc(e.from,s.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&wo(i.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>s.head)&&wo(i.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&e.insert.length==0&&wo(i.contentDOM,"Delete",46)))return!0;let l=e.insert.toString();i.inputState.composing>=0&&i.inputState.composing++;let a,c=()=>a||(a=Fj(i,e,t));return i.state.facet($C).some(h=>h(i,e.from,e.to,l,c))||i.dispatch(c()),!0}function Fj(i,e,t){let n,s=i.state,l=s.selection.main,a=-1;if(e.from==e.to&&e.from<l.from||e.from>l.to){let h=e.from<l.from?-1:1,d=h<0?l.from:l.to,p=cc(s.facet(nu).map(m=>m(i)),d,h);e.from==p&&(a=p)}if(a>-1)n={changes:e,selection:$.cursor(e.from+e.insert.length,-1)};else if(e.from>=l.from&&e.to<=l.to&&e.to-e.from>=(l.to-l.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&i.inputState.composing<0){let h=l.from<e.from?s.sliceDoc(l.from,e.from):"",d=l.to>e.to?s.sliceDoc(e.to,l.to):"";n=s.replaceSelection(i.state.toText(h+e.insert.sliceString(0,void 0,i.state.lineBreak)+d))}else{let h=s.changes(e),d=t&&t.main.to<=h.newLength?t.main:void 0;if(s.selection.ranges.length>1&&(i.inputState.composing>=0||i.inputState.compositionPendingChange)&&e.to<=l.to+10&&e.to>=l.to-10){let p=i.state.sliceDoc(e.from,e.to),m,b=t&&tT(i,t.main.head);if(b){let w=e.insert.length-(e.to-e.from);m={from:b.from,to:b.to-w}}else m=i.state.doc.lineAt(l.head);let v=l.to-e.to;n=s.changeByRange(w=>{if(w.from==l.from&&w.to==l.to)return{changes:h,range:d||w.map(h)};let k=w.to-v,_=k-p.length;if(i.state.sliceDoc(_,k)!=p||k>=m.from&&_<=m.to)return{range:w};let O=s.changes({from:_,to:k,insert:e.insert}),R=w.to-l.to;return{changes:O,range:d?$.range(Math.max(0,d.anchor+R),Math.max(0,d.head+R)):w.map(O)}})}else n={changes:h,selection:d&&s.selection.replaceRange(d)}}let c="input.type";return(i.composing||i.inputState.compositionPendingChange&&i.inputState.compositionEndedAt>Date.now()-50)&&(i.inputState.compositionPendingChange=!1,c+=".compose",i.inputState.compositionFirstChange&&(c+=".start",i.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:c,scrollIntoView:!0})}function lT(i,e,t,n){let s=Math.min(i.length,e.length),l=0;for(;l<s&&i.charCodeAt(l)==e.charCodeAt(l);)l++;if(l==s&&i.length==e.length)return null;let a=i.length,c=e.length;for(;a>0&&c>0&&i.charCodeAt(a-1)==e.charCodeAt(c-1);)a--,c--;if(n=="end"){let h=Math.max(0,l-Math.min(a,c));t-=a+h-l}if(a<l&&i.length<e.length){let h=t<=l&&t>=a?l-t:0;l-=h,c=l+(c-a),a=l}else if(c<l){let h=t<=l&&t>=c?l-t:0;l-=h,a=l+(a-c),c=l}return{from:l,toA:a,toB:c}}function Xj(i){let e=[];if(i.root.activeElement!=i.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:s,focusOffset:l}=i.observer.selectionRange;return t&&(e.push(new Bx(t,n)),(s!=t||l!=n)&&e.push(new Bx(s,l))),e}function Qj(i,e){if(i.length==0)return null;let t=i[0].pos,n=i.length==2?i[1].pos:t;return t>-1&&n>-1?$.single(t+e,n+e):null}function Kf(i,e){return e.head==i.main.head&&e.anchor==i.main.anchor}class Jj{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,ne.safari&&e.contentDOM.addEventListener("input",()=>null),ne.gecko&&d4(e.contentDOM.ownerDocument)}handleEvent(e){!l4(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let n=this.handlers[e];if(n){for(let s of n.observers)s(this.view,t);for(let s of n.handlers){if(t.defaultPrevented)break;if(s(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=Zj(e),n=this.handlers,s=this.view.contentDOM;for(let l in t)if(l!="scroll"){let a=!t[l].handlers.length,c=n[l];c&&a!=!c.handlers.length&&(s.removeEventListener(l,this.handleEvent),c=null),c||s.addEventListener(l,this.handleEvent,{passive:a})}for(let l in n)l!="scroll"&&!t[l]&&s.removeEventListener(l,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&aT.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),ne.android&&ne.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return ne.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=oT.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||e4.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,wo(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:ne.safari&&!ne.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Ux(i,e){return(t,n)=>{try{return e.call(i,n,t)}catch(s){gi(t.state,s)}}}function Zj(i){let e=Object.create(null);function t(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of i){let s=n.spec,l=s&&s.plugin.domEventHandlers,a=s&&s.plugin.domEventObservers;if(l)for(let c in l){let h=l[c];h&&t(c).handlers.push(Ux(n.value,h))}if(a)for(let c in a){let h=a[c];h&&t(c).observers.push(Ux(n.value,h))}}for(let n in wn)t(n).handlers.push(wn[n]);for(let n in rn)t(n).observers.push(rn[n]);return e}const oT=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],e4="dthko",aT=[16,17,18,20,91,92,224,225],qh=6;function Vh(i){return Math.max(0,i)*.7+8}function t4(i,e){return Math.max(Math.abs(i.clientX-e.clientX),Math.abs(i.clientY-e.clientY))}class i4{constructor(e,t,n,s){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=rj(e.contentDOM),this.atoms=e.state.facet(nu).map(a=>a(e));let l=e.contentDOM.ownerDocument;l.addEventListener("mousemove",this.move=this.move.bind(this)),l.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(je.allowMultipleSelections)&&n4(e,t),this.dragging=r4(e,t)&&hT(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&t4(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,n=0,s=0,l=0,a=this.view.win.innerWidth,c=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:l,bottom:c}=this.scrollParents.y.getBoundingClientRect());let h=Db(this.view);e.clientX-h.left<=s+qh?t=-Vh(s-e.clientX):e.clientX+h.right>=a-qh&&(t=Vh(e.clientX-a)),e.clientY-h.top<=l+qh?n=-Vh(l-e.clientY):e.clientY+h.bottom>=c-qh&&(n=Vh(e.clientY-c)),this.setScrollSpeed(t,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,n=iT(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function n4(i,e){let t=i.state.facet(PC);return t.length?t[0](e):ne.mac?e.metaKey:e.ctrlKey}function s4(i,e){let t=i.state.facet(HC);return t.length?t[0](e):ne.mac?!e.altKey:!e.ctrlKey}function r4(i,e){let{main:t}=i.state.selection;if(t.empty)return!1;let n=Lo(i.root);if(!n||n.rangeCount==0)return!0;let s=n.getRangeAt(0).getClientRects();for(let l=0;l<s.length;l++){let a=s[l];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function l4(i,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=i.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=kt.get(t))&&n.isWidget()&&!n.isHidden&&n.widget.ignoreEvent(e))return!1;return!0}const wn=Object.create(null),rn=Object.create(null),cT=ne.ie&&ne.ie_version<15||ne.ios&&ne.webkit_version<604;function o4(i){let e=i.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{i.focus(),t.remove(),uT(i,t.value)},50)}function Ld(i,e,t){for(let n of i.facet(e))t=n(t,i);return t}function uT(i,e){e=Ld(i.state,Ab,e);let{state:t}=i,n,s=1,l=t.toText(e),a=l.lines==t.selection.ranges.length;if(ky!=null&&t.selection.ranges.every(h=>h.empty)&&ky==l.toString()){let h=-1;n=t.changeByRange(d=>{let p=t.doc.lineAt(d.from);if(p.from==h)return{range:d};h=p.from;let m=t.toText((a?l.line(s++).text:e)+t.lineBreak);return{changes:{from:p.from,insert:m},range:$.cursor(d.from+m.length)}})}else a?n=t.changeByRange(h=>{let d=l.line(s++);return{changes:{from:h.from,to:h.to,insert:d.text},range:$.cursor(h.from+d.length)}}):n=t.replaceSelection(l);i.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}rn.scroll=i=>{i.inputState.lastScrollTop=i.scrollDOM.scrollTop,i.inputState.lastScrollLeft=i.scrollDOM.scrollLeft};wn.keydown=(i,e)=>(i.inputState.setSelectionOrigin("select"),e.keyCode==27&&i.inputState.tabFocusMode!=0&&(i.inputState.tabFocusMode=Date.now()+2e3),!1);rn.touchstart=(i,e)=>{i.inputState.lastTouchTime=Date.now(),i.inputState.setSelectionOrigin("select.pointer")};rn.touchmove=i=>{i.inputState.setSelectionOrigin("select.pointer")};wn.mousedown=(i,e)=>{if(i.observer.flush(),i.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let n of i.state.facet(qC))if(t=n(i,e),t)break;if(!t&&e.button==0&&(t=c4(i,e)),t){let n=!i.hasFocus;i.inputState.startMouseSelection(new i4(i,e,t,n)),n&&i.observer.ignore(()=>{RC(i.contentDOM);let l=i.root.activeElement;l&&!l.contains(i.contentDOM)&&l.blur()});let s=i.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}else i.inputState.setSelectionOrigin("select.pointer");return!1};function jx(i,e,t,n){if(n==1)return $.cursor(e,t);if(n==2)return Pj(i.state,e,t);{let s=i.docView.lineAt(e,t),l=i.state.doc.lineAt(s?s.posAtEnd:e),a=s?s.posAtStart:l.from,c=s?s.posAtEnd:l.to;return c<i.state.doc.length&&c==l.to&&c++,$.range(a,c)}}const a4=ne.ie&&ne.ie_version<=11;let zx=null,Ix=0,Px=0;function hT(i){if(!a4)return i.detail;let e=zx,t=Px;return zx=i,Px=Date.now(),Ix=!e||t>Date.now()-400&&Math.abs(e.clientX-i.clientX)<2&&Math.abs(e.clientY-i.clientY)<2?(Ix+1)%3:1}function c4(i,e){let t=i.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),n=hT(e),s=i.state.selection;return{update(l){l.docChanged&&(t.pos=l.changes.mapPos(t.pos),s=s.map(l.changes))},get(l,a,c){let h=i.posAndSideAtCoords({x:l.clientX,y:l.clientY},!1),d,p=jx(i,h.pos,h.assoc,n);if(t.pos!=h.pos&&!a){let m=jx(i,t.pos,t.assoc,n),b=Math.min(m.from,p.from),v=Math.max(m.to,p.to);p=b<p.from?$.range(b,v):$.range(v,b)}return a?s.replaceRange(s.main.extend(p.from,p.to)):c&&n==1&&s.ranges.length>1&&(d=u4(s,h.pos))?d:c?s.addRange(p):$.create([p])}}}function u4(i,e){for(let t=0;t<i.ranges.length;t++){let{from:n,to:s}=i.ranges[t];if(n<=e&&s>=e)return $.create(i.ranges.slice(0,t).concat(i.ranges.slice(t+1)),i.mainIndex==t?0:i.mainIndex-(i.mainIndex>t?1:0))}return null}wn.dragstart=(i,e)=>{let{selection:{main:t}}=i.state;if(e.target.draggable){let s=i.docView.tile.nearest(e.target);if(s&&s.isWidget()){let l=s.posAtStart,a=l+s.length;(l>=t.to||a<=t.from)&&(t=$.range(l,a))}}let{inputState:n}=i;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Ld(i.state,Cb,i.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};wn.dragend=i=>(i.inputState.draggedContent=null,!1);function Hx(i,e,t,n){if(t=Ld(i.state,Ab,t),!t)return;let s=i.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:l}=i.inputState,a=n&&l&&s4(i,e)?{from:l.from,to:l.to}:null,c={from:s,insert:t},h=i.state.changes(a?[a,c]:c);i.focus(),i.dispatch({changes:h,selection:{anchor:h.mapPos(s,-1),head:h.mapPos(s,1)},userEvent:a?"move.drop":"input.drop"}),i.inputState.draggedContent=null}wn.drop=(i,e)=>{if(!e.dataTransfer)return!1;if(i.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let n=Array(t.length),s=0,l=()=>{++s==t.length&&Hx(i,e,n.filter(a=>a!=null).join(i.state.lineBreak),!1)};for(let a=0;a<t.length;a++){let c=new FileReader;c.onerror=l,c.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(c.result)||(n[a]=c.result),l()},c.readAsText(t[a])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return Hx(i,e,n,!0),!0}return!1};wn.paste=(i,e)=>{if(i.state.readOnly)return!0;i.observer.flush();let t=cT?null:e.clipboardData;return t?(uT(i,t.getData("text/plain")||t.getData("text/uri-list")),!0):(o4(i),!1)};function h4(i,e){let t=i.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),i.focus()},50)}function f4(i){let e=[],t=[],n=!1;for(let s of i.selection.ranges)s.empty||(e.push(i.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:l}of i.selection.ranges){let a=i.doc.lineAt(l);a.number>s&&(e.push(a.text),t.push({from:a.from,to:Math.min(i.doc.length,a.to+1)})),s=a.number}n=!0}return{text:Ld(i,Cb,e.join(i.lineBreak)),ranges:t,linewise:n}}let ky=null;wn.copy=wn.cut=(i,e)=>{let t=Lo(i.root);if(t&&!oc(i.contentDOM,t))return!1;let{text:n,ranges:s,linewise:l}=f4(i.state);if(!n&&!l)return!1;ky=l?n:null,e.type=="cut"&&!i.state.readOnly&&i.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"});let a=cT?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",n),!0):(h4(i,n),!1)};const fT=Sn.define();function dT(i,e){let t=[];for(let n of i.facet(GC)){let s=n(i,e);s&&t.push(s)}return t.length?i.update({effects:t,annotations:fT.of(!0)}):null}function pT(i){setTimeout(()=>{let e=i.hasFocus;if(e!=i.inputState.notifiedFocused){let t=dT(i.state,e);t?i.dispatch(t):i.update([])}},10)}rn.focus=i=>{i.inputState.lastFocusTime=Date.now(),!i.scrollDOM.scrollTop&&(i.inputState.lastScrollTop||i.inputState.lastScrollLeft)&&(i.scrollDOM.scrollTop=i.inputState.lastScrollTop,i.scrollDOM.scrollLeft=i.inputState.lastScrollLeft),pT(i)};rn.blur=i=>{i.observer.clearSelectionRange(),pT(i)};rn.compositionstart=rn.compositionupdate=i=>{i.observer.editContext||(i.inputState.compositionFirstChange==null&&(i.inputState.compositionFirstChange=!0),i.inputState.composing<0&&(i.inputState.composing=0))};rn.compositionend=i=>{i.observer.editContext||(i.inputState.composing=-1,i.inputState.compositionEndedAt=Date.now(),i.inputState.compositionPendingKey=!0,i.inputState.compositionPendingChange=i.observer.pendingRecords().length>0,i.inputState.compositionFirstChange=null,ne.chrome&&ne.android?i.observer.flushSoon():i.inputState.compositionPendingChange?Promise.resolve().then(()=>i.observer.flush()):setTimeout(()=>{i.inputState.composing<0&&i.docView.hasComposition&&i.update([])},50))};rn.contextmenu=i=>{i.inputState.lastContextMenu=Date.now()};wn.beforeinput=(i,e)=>{var t,n;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(i.inputState.insertingText=e.data,i.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&i.observer.editContext){let l=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),a=e.getTargetRanges();if(l&&a.length){let c=a[0],h=i.posAtDOM(c.startContainer,c.startOffset),d=i.posAtDOM(c.endContainer,c.endOffset);return Rb(i,{from:h,to:d,insert:i.state.toText(l)},null),!0}}let s;if(ne.chrome&&ne.android&&(s=oT.find(l=>l.inputType==e.inputType))&&(i.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let l=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>l+10&&i.hasFocus&&(i.contentDOM.blur(),i.focus())},100)}return ne.ios&&e.inputType=="deleteContentForward"&&i.observer.flushSoon(),ne.safari&&e.inputType=="insertText"&&i.inputState.composing>=0&&setTimeout(()=>rn.compositionend(i,e),20),!1};const qx=new Set;function d4(i){qx.has(i)||(qx.add(i),i.addEventListener("copy",()=>{}),i.addEventListener("cut",()=>{}))}const Vx=["pre-wrap","normal","pre-line","break-spaces"];let jo=!1;function $x(){jo=!1}class p4{constructor(e){this.lineWrapping=e,this.doc=He.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Vx.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let s=e[n];s<0?n++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,n,s,l,a){let c=Vx.indexOf(e)>-1,h=Math.abs(t-this.lineHeight)>.3||this.lineWrapping!=c||Math.abs(n-this.charWidth)>.1;if(this.lineWrapping=c,this.lineHeight=t,this.charWidth=n,this.textHeight=s,this.lineLength=l,h){this.heightSamples={};for(let d=0;d<a.length;d++){let p=a[d];p<0?d++:this.heightSamples[Math.floor(p*10)]=!0}}return h}}class g4{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class pn{constructor(e,t,n,s,l){this.from=e,this.length=t,this.top=n,this.height=s,this._content=l}get type(){return typeof this._content=="number"?Gt.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Zr?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new pn(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var tt=(function(i){return i[i.ByPos=0]="ByPos",i[i.ByHeight=1]="ByHeight",i[i.ByPosNoHeight=2]="ByPosNoHeight",i})(tt||(tt={}));const mf=.001;class ii{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>mf&&(jo=!0),this.height=e)}replace(e,t,n){return ii.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,s){let l=this,a=n.doc;for(let c=s.length-1;c>=0;c--){let{fromA:h,toA:d,fromB:p,toB:m}=s[c],b=l.lineAt(h,tt.ByPosNoHeight,n.setDoc(t),0,0),v=b.to>=d?b:l.lineAt(d,tt.ByPosNoHeight,n,0,0);for(m+=v.to-d,d=v.to;c>0&&b.from<=s[c-1].toA;)h=s[c-1].fromA,p=s[c-1].fromB,c--,h<b.from&&(b=l.lineAt(h,tt.ByPosNoHeight,n,0,0));p+=b.from-h,h=b.from;let w=Mb.build(n.setDoc(a),e,p,m);l=Wf(l,l.replace(h,d,w))}return l.updateHeight(n,0)}static empty(){return new Ui(0,0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,s=0,l=0;for(;;)if(t==n)if(s>l*2){let c=e[t-1];c.break?e.splice(--t,1,c.left,null,c.right):e.splice(--t,1,c.left,c.right),n+=1+c.break,s-=c.size}else if(l>s*2){let c=e[n];c.break?e.splice(n,1,c.left,null,c.right):e.splice(n,1,c.left,c.right),n+=2+c.break,l-=c.size}else break;else if(s<l){let c=e[t++];c&&(s+=c.size)}else{let c=e[--n];c&&(l+=c.size)}let a=0;return e[t-1]==null?(a=1,t--):e[t]==null&&(a=1,n++),new y4(ii.of(e.slice(0,t)),a,ii.of(e.slice(n)))}}function Wf(i,e){return i==e?i:(i.constructor!=e.constructor&&(jo=!0),e)}ii.prototype.size=1;const m4=ue.replace({});class gT extends ii{constructor(e,t,n){super(e,t),this.deco=n,this.spaceAbove=0}mainBlock(e,t){return new pn(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,t,n,s){return this.spaceAbove&&e<n+this.spaceAbove?new pn(s,0,n,this.spaceAbove,m4):this.mainBlock(n,s)}lineAt(e,t,n,s,l){let a=this.mainBlock(s,l);return this.spaceAbove?this.blockAt(0,n,s,l).join(a):a}forEachLine(e,t,n,s,l,a){e<=l+this.length&&t>=l&&a(this.lineAt(0,tt.ByPos,n,s,l))}setMeasuredHeight(e){let t=e.heights[e.index++];t<0?(this.spaceAbove=-t,t=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(t)}updateHeight(e,t=0,n=!1,s){return s&&s.from<=t&&s.more&&this.setMeasuredHeight(s),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Ui extends gT{constructor(e,t,n){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=n}mainBlock(e,t){return new pn(t,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,t,n){let s=n[0];return n.length==1&&(s instanceof Ui||s instanceof Vt&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Vt?s=new Ui(s.length,this.height,this.spaceAbove):s.height=this.height,this.outdated||(s.outdated=!1),s):ii.of(n)}updateHeight(e,t=0,n=!1,s){return s&&s.from<=t&&s.more?this.setMeasuredHeight(s):(n||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Vt extends ii{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,s=e.doc.lineAt(t+this.length).number,l=s-n+1,a,c=0;if(e.lineWrapping){let h=Math.min(this.height,e.lineHeight*l);a=h/l,this.length>l+1&&(c=(this.height-h)/(this.length-l-1))}else a=this.height/l;return{firstLine:n,lastLine:s,perLine:a,perChar:c}}blockAt(e,t,n,s){let{firstLine:l,lastLine:a,perLine:c,perChar:h}=this.heightMetrics(t,s);if(t.lineWrapping){let d=s+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),p=t.doc.lineAt(d),m=c+p.length*h,b=Math.max(n,e-m/2);return new pn(p.from,p.length,b,m,0)}else{let d=Math.max(0,Math.min(a-l,Math.floor((e-n)/c))),{from:p,length:m}=t.doc.line(l+d);return new pn(p,m,n+c*d,c,0)}}lineAt(e,t,n,s,l){if(t==tt.ByHeight)return this.blockAt(e,n,s,l);if(t==tt.ByPosNoHeight){let{from:v,to:w}=n.doc.lineAt(e);return new pn(v,w-v,0,0,0)}let{firstLine:a,perLine:c,perChar:h}=this.heightMetrics(n,l),d=n.doc.lineAt(e),p=c+d.length*h,m=d.number-a,b=s+c*m+h*(d.from-l-m);return new pn(d.from,d.length,Math.max(s,Math.min(b,s+this.height-p)),p,0)}forEachLine(e,t,n,s,l,a){e=Math.max(e,l),t=Math.min(t,l+this.length);let{firstLine:c,perLine:h,perChar:d}=this.heightMetrics(n,l);for(let p=e,m=s;p<=t;){let b=n.doc.lineAt(p);if(p==e){let w=b.number-c;m+=h*w+d*(e-l-w)}let v=h+d*b.length;a(new pn(b.from,b.length,m,v,0)),m+=v,p=b.to+1}}replace(e,t,n){let s=this.length-t;if(s>0){let l=n[n.length-1];l instanceof Vt?n[n.length-1]=new Vt(l.length+s):n.push(null,new Vt(s-1))}if(e>0){let l=n[0];l instanceof Vt?n[0]=new Vt(e+l.length):n.unshift(new Vt(e-1),null)}return ii.of(n)}decomposeLeft(e,t){t.push(new Vt(e-1),null)}decomposeRight(e,t){t.push(null,new Vt(this.length-e-1))}updateHeight(e,t=0,n=!1,s){let l=t+this.length;if(s&&s.from<=t+this.length&&s.more){let a=[],c=Math.max(t,s.from),h=-1;for(s.from>t&&a.push(new Vt(s.from-t-1).updateHeight(e,t));c<=l&&s.more;){let p=e.doc.lineAt(c).length;a.length&&a.push(null);let m=s.heights[s.index++],b=0;m<0&&(b=-m,m=s.heights[s.index++]),h==-1?h=m:Math.abs(m-h)>=mf&&(h=-2);let v=new Ui(p,m,b);v.outdated=!1,a.push(v),c+=p+1}c<=l&&a.push(null,new Vt(l-c).updateHeight(e,c));let d=ii.of(a);return(h<0||Math.abs(d.height-this.height)>=mf||Math.abs(h-this.heightMetrics(e,t).perLine)>=mf)&&(jo=!0),Wf(this,d)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class y4 extends ii{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,s){let l=n+this.left.height;return e<l?this.left.blockAt(e,t,n,s):this.right.blockAt(e,t,l,s+this.left.length+this.break)}lineAt(e,t,n,s,l){let a=s+this.left.height,c=l+this.left.length+this.break,h=t==tt.ByHeight?e<a:e<c,d=h?this.left.lineAt(e,t,n,s,l):this.right.lineAt(e,t,n,a,c);if(this.break||(h?d.to<c:d.from>c))return d;let p=t==tt.ByPosNoHeight?tt.ByPosNoHeight:tt.ByPos;return h?d.join(this.right.lineAt(c,p,n,a,c)):this.left.lineAt(c,p,n,s,l).join(d)}forEachLine(e,t,n,s,l,a){let c=s+this.left.height,h=l+this.left.length+this.break;if(this.break)e<h&&this.left.forEachLine(e,t,n,s,l,a),t>=h&&this.right.forEachLine(e,t,n,c,h,a);else{let d=this.lineAt(h,tt.ByPos,n,s,l);e<d.from&&this.left.forEachLine(e,d.from-1,n,s,l,a),d.to>=e&&d.from<=t&&a(d),t>d.to&&this.right.forEachLine(d.to+1,t,n,c,h,a)}}replace(e,t,n){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,n));let l=[];e>0&&this.decomposeLeft(e,l);let a=l.length;for(let c of n)l.push(c);if(e>0&&Gx(l,a-1),t<this.length){let c=l.length;this.decomposeRight(t,l),Gx(l,c)}return ii.of(l)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,s=n+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?ii.of(this.break?[e,null,t]:[e,t]):(this.left=Wf(this.left,e),this.right=Wf(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,s){let{left:l,right:a}=this,c=t+l.length+this.break,h=null;return s&&s.from<=t+l.length&&s.more?h=l=l.updateHeight(e,t,n,s):l.updateHeight(e,t,n),s&&s.from<=c+a.length&&s.more?h=a=a.updateHeight(e,c,n,s):a.updateHeight(e,c,n),h?this.balanced(l,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Gx(i,e){let t,n;i[e]==null&&(t=i[e-1])instanceof Vt&&(n=i[e+1])instanceof Vt&&i.splice(e-1,3,new Vt(t.length+1+n.length))}const b4=5;class Mb{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Ui?s.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Ui(n-this.pos,-1,0)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let s=n.widget?n.widget.estimatedHeight:0,l=n.widget?n.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let a=t-e;n.block?this.addBlock(new gT(a,s,n)):(a||l||s>=b4)&&this.addLineDeco(s,l,a)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ui(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,t){let n=new Vt(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ui)return e;let t=new Ui(0,-1,0);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let s=this.ensureLine();s.length+=n,s.collapsed+=n,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Ui)&&!this.isCovered?this.nodes.push(new Ui(0,-1,0)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let s of this.nodes)s instanceof Ui&&s.updateHeight(this.oracle,n),n+=s?s.length:1;return this.nodes}static build(e,t,n,s){let l=new Mb(n,e);return De.spans(t,n,s,l,0),l.finish(n)}}function v4(i,e,t){let n=new w4;return De.compare(i,e,t,n,0),n.changes}class w4{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,s){(e<t||n&&n.heightRelevant||s&&s.heightRelevant)&&vo(e,t,this.changes,5)}}function S4(i,e){let t=i.getBoundingClientRect(),n=i.ownerDocument,s=n.defaultView||window,l=Math.max(0,t.left),a=Math.min(s.innerWidth,t.right),c=Math.max(0,t.top),h=Math.min(s.innerHeight,t.bottom);for(let d=i.parentNode;d&&d!=n.body;)if(d.nodeType==1){let p=d,m=window.getComputedStyle(p);if((p.scrollHeight>p.clientHeight||p.scrollWidth>p.clientWidth)&&m.overflow!="visible"){let b=p.getBoundingClientRect();l=Math.max(l,b.left),a=Math.min(a,b.right),c=Math.max(c,b.top),h=Math.min(d==i.parentNode?s.innerHeight:h,b.bottom)}d=m.position=="absolute"||m.position=="fixed"?p.offsetParent:p.parentNode}else if(d.nodeType==11)d=d.host;else break;return{left:l-t.left,right:Math.max(l,a)-t.left,top:c-(t.top+e),bottom:Math.max(c,h)-(t.top+e)}}function k4(i){let e=i.getBoundingClientRect(),t=i.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function x4(i,e){let t=i.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Vm{constructor(e,t,n,s){this.from=e,this.to=t,this.size=n,this.displaySize=s}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let s=e[n],l=t[n];if(s.from!=l.from||s.to!=l.to||s.size!=l.size)return!1}return!0}draw(e,t){return ue.replace({widget:new _4(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class _4 extends Kn{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Kx{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Wx,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Ze.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(Tb).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new p4(t),this.stateDeco=Yx(e),this.heightMap=ii.empty().applyChanges(this.stateDeco,He.empty,this.heightOracle.setDoc(e.doc),[new en(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ue.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let s=n?t.head:t.anchor;if(!e.some(({from:l,to:a})=>s>=l&&s<=a)){let{from:l,to:a}=this.lineBlockAt(s);e.push(new $h(l,a))}}return this.viewports=e.sort((n,s)=>n.from-s.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Wx:new Nb(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(ec(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=Yx(this.state);let s=e.changedRanges,l=en.extendWithRanges(s,v4(n,this.stateDeco,e?e.changes:At.empty(this.state.doc.length))),a=this.heightMap.height,c=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);$x(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),l),(this.heightMap.height!=a||jo)&&(e.flags|=2),c?(this.scrollAnchorPos=e.changes.mapPos(c.from,-1),this.scrollAnchorHeight=c.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=a);let h=l.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<h.from||t.range.head>h.to)||!this.viewportIsAppropriate(h))&&(h=this.getViewport(0,t));let d=h.from!=this.viewport.from||h.to!=this.viewport.to;this.viewport=h,e.flags|=this.updateForViewport(),(d||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(WC)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),s=this.heightOracle,l=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?Ze.RTL:Ze.LTR;let a=this.heightOracle.mustRefreshForWrapping(l)||this.mustMeasureContent,c=t.getBoundingClientRect(),h=a||this.mustMeasureContent||this.contentDOMHeight!=c.height;this.contentDOMHeight=c.height,this.mustMeasureContent=!1;let d=0,p=0;if(c.width&&c.height){let{scaleX:N,scaleY:j}=DC(t,c);(N>.005&&Math.abs(this.scaleX-N)>.005||j>.005&&Math.abs(this.scaleY-j)>.005)&&(this.scaleX=N,this.scaleY=j,d|=16,a=h=!0)}let m=(parseInt(n.paddingTop)||0)*this.scaleY,b=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=m||this.paddingBottom!=b)&&(this.paddingTop=m,this.paddingBottom=b,d|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(h=!0),this.editorWidth=e.scrollDOM.clientWidth,d|=16);let v=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=v&&(this.scrollAnchorHeight=-1,this.scrollTop=v),this.scrolledToBottom=MC(e.scrollDOM);let w=(this.printing?x4:S4)(t,this.paddingTop),k=w.top-this.pixelViewport.top,_=w.bottom-this.pixelViewport.bottom;this.pixelViewport=w;let O=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(O!=this.inView&&(this.inView=O,O&&(h=!0)),!this.inView&&!this.scrollTarget&&!k4(e.dom))return 0;let R=c.width;if((this.contentDOMWidth!=R||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=c.width,this.editorHeight=e.scrollDOM.clientHeight,d|=16),h){let N=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(N)&&(a=!0),a||s.lineWrapping&&Math.abs(R-this.contentDOMWidth)>s.charWidth){let{lineHeight:j,charWidth:H,textHeight:D}=e.docView.measureTextSize();a=j>0&&s.refresh(l,j,H,D,Math.max(5,R/H),N),a&&(e.docView.minWidth=0,d|=16)}k>0&&_>0?p=Math.max(k,_):k<0&&_<0&&(p=Math.min(k,_)),$x();for(let j of this.viewports){let H=j.from==this.viewport.from?N:e.docView.measureVisibleLineHeights(j);this.heightMap=(a?ii.empty().applyChanges(this.stateDeco,He.empty,this.heightOracle,[new en(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,a,new g4(j.from,H))}jo&&(d|=2)}let C=!this.viewportIsAppropriate(this.viewport,p)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return C&&(d&2&&(d|=this.updateScaler()),this.viewport=this.getViewport(p,this.scrollTarget),d|=this.updateForViewport()),(d&2||C)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),d|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),d}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,l=this.heightOracle,{visibleTop:a,visibleBottom:c}=this,h=new $h(s.lineAt(a-n*1e3,tt.ByHeight,l,0,0).from,s.lineAt(c+(1-n)*1e3,tt.ByHeight,l,0,0).to);if(t){let{head:d}=t.range;if(d<h.from||d>h.to){let p=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),m=s.lineAt(d,tt.ByPos,l,0,0),b;t.y=="center"?b=(m.top+m.bottom)/2-p/2:t.y=="start"||t.y=="nearest"&&d<h.from?b=m.top:b=m.bottom-p,h=new $h(s.lineAt(b-1e3/2,tt.ByHeight,l,0,0).from,s.lineAt(b+p+1e3/2,tt.ByHeight,l,0,0).to)}}return h}mapViewport(e,t){let n=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new $h(this.heightMap.lineAt(n,tt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,tt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,tt.ByPos,this.heightOracle,0,0),{bottom:l}=this.heightMap.lineAt(t,tt.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:c}=this;return(e==0||s<=a-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||l>=c+Math.max(10,Math.min(n,250)))&&s>a-2*1e3&&l<c+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let s of e)t.touchesRange(s.from,s.to)||n.push(new Vm(t.mapPos(s.from),t.mapPos(s.to),s.size,s.displaySize));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,s=n?1e4:2e3,l=s>>1,a=s<<1;if(this.defaultTextDirection!=Ze.LTR&&!n)return[];let c=[],h=(p,m,b,v)=>{if(m-p<l)return;let w=this.state.selection.main,k=[w.from];w.empty||k.push(w.to);for(let O of k)if(O>p&&O<m){h(p,O-10,b,v),h(O+10,m,b,v);return}let _=A4(e,O=>O.from>=b.from&&O.to<=b.to&&Math.abs(O.from-p)<l&&Math.abs(O.to-m)<l&&!k.some(R=>O.from<R&&O.to>R));if(!_){if(m<b.to&&t&&n&&t.visibleRanges.some(C=>C.from<=m&&C.to>=m)){let C=t.moveToLineBoundary($.cursor(m),!1,!0).head;C>p&&(m=C)}let O=this.gapSize(b,p,m,v),R=n||O<2e6?O:2e6;_=new Vm(p,m,O,R)}c.push(_)},d=p=>{if(p.length<a||p.type!=Gt.Text)return;let m=O4(p.from,p.to,this.stateDeco);if(m.total<a)return;let b=this.scrollTarget?this.scrollTarget.range.head:null,v,w;if(n){let k=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,_,O;if(b!=null){let R=Kh(m,b),C=((this.visibleBottom-this.visibleTop)/2+k)/p.height;_=R-C,O=R+C}else _=(this.visibleTop-p.top-k)/p.height,O=(this.visibleBottom-p.top+k)/p.height;v=Gh(m,_),w=Gh(m,O)}else{let k=m.total*this.heightOracle.charWidth,_=s*this.heightOracle.charWidth,O=0;if(k>2e6)for(let H of e)H.from>=p.from&&H.from<p.to&&H.size!=H.displaySize&&H.from*this.heightOracle.charWidth+O<this.pixelViewport.left&&(O=H.size-H.displaySize);let R=this.pixelViewport.left+O,C=this.pixelViewport.right+O,N,j;if(b!=null){let H=Kh(m,b),D=((C-R)/2+_)/k;N=H-D,j=H+D}else N=(R-_)/k,j=(C+_)/k;v=Gh(m,N),w=Gh(m,j)}v>p.from&&h(p.from,v,p,m),w<p.to&&h(w,p.to,p,m)};for(let p of this.viewportLines)Array.isArray(p.type)?p.type.forEach(d):d(p);return c}gapSize(e,t,n,s){let l=Kh(s,n)-Kh(s,t);return this.heightOracle.lineWrapping?e.height*l:s.total*this.heightOracle.charWidth*l}updateLineGaps(e){Vm.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ue.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let n=[];De.spans(t,this.viewport.from,this.viewport.to,{span(l,a){n.push({from:l,to:a})},point(){}},20);let s=0;if(n.length!=this.visibleRanges.length)s=12;else for(let l=0;l<n.length&&!(s&8);l++){let a=this.visibleRanges[l],c=n[l];(a.from!=c.from||a.to!=c.to)&&(s|=4,e&&e.mapPos(a.from,-1)==c.from&&e.mapPos(a.to,1)==c.to||(s|=8))}return this.visibleRanges=n,s}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||ec(this.heightMap.lineAt(e,tt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||ec(this.heightMap.lineAt(this.scaler.fromDOM(e),tt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return ec(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class $h{constructor(e,t){this.from=e,this.to=t}}function O4(i,e,t){let n=[],s=i,l=0;return De.spans(t,i,e,{span(){},point(a,c){a>s&&(n.push({from:s,to:a}),l+=a-s),s=c}},20),s<e&&(n.push({from:s,to:e}),l+=e-s),{total:l,ranges:n}}function Gh({total:i,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(i*t);for(let s=0;;s++){let{from:l,to:a}=e[s],c=a-l;if(n<=c)return l+n;n-=c}}function Kh(i,e){let t=0;for(let{from:n,to:s}of i.ranges){if(e<=s){t+=e-n;break}t+=s-n}return t/i.total}function A4(i,e){for(let t of i)if(e(t))return t}const Wx={toDOM(i){return i},fromDOM(i){return i},scale:1,eq(i){return i==this}};function Yx(i){let e=i.facet(Rd).filter(n=>typeof n!="function"),t=i.facet(Eb).filter(n=>typeof n!="function");return t.length&&e.push(De.join(t)),e}class Nb{constructor(e,t,n){let s=0,l=0,a=0;this.viewports=n.map(({from:c,to:h})=>{let d=t.lineAt(c,tt.ByPos,e,0,0).top,p=t.lineAt(h,tt.ByPos,e,0,0).bottom;return s+=p-d,{from:c,to:h,top:d,bottom:p,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let c of this.viewports)c.domTop=a+(c.top-l)*this.scale,a=c.domBottom=c.domTop+(c.bottom-c.top),l=c.bottom}toDOM(e){for(let t=0,n=0,s=0;;t++){let l=t<this.viewports.length?this.viewports[t]:null;if(!l||e<l.top)return s+(e-n)*this.scale;if(e<=l.bottom)return l.domTop+(e-l.top);n=l.bottom,s=l.domBottom}}fromDOM(e){for(let t=0,n=0,s=0;;t++){let l=t<this.viewports.length?this.viewports[t]:null;if(!l||e<l.domTop)return n+(e-s)/this.scale;if(e<=l.domBottom)return l.top+(e-l.domTop);n=l.bottom,s=l.domBottom}}eq(e){return e instanceof Nb?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,n)=>t.from==e.viewports[n].from&&t.to==e.viewports[n].to):!1}}function ec(i,e){if(e.scale==1)return i;let t=e.toDOM(i.top),n=e.toDOM(i.bottom);return new pn(i.from,i.length,t,n-t,Array.isArray(i._content)?i._content.map(s=>ec(s,e)):i._content)}const Wh=te.define({combine:i=>i.join(" ")}),xy=te.define({combine:i=>i.indexOf(!0)>-1}),_y=rr.newName(),mT=rr.newName(),yT=rr.newName(),bT={"&light":"."+mT,"&dark":"."+yT};function Oy(i,e,t){return new rr(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,s=>{if(s=="&")return i;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):i+" "+n}})}const C4=Oy("."+_y,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},bT),T4={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},$m=ne.ie&&ne.ie_version<=11;class E4{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new lj,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(ne.ie&&ne.ie_version<=11||ne.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&ne.android&&e.constructor.EDIT_CONTEXT!==!1&&!(ne.chrome&&ne.chrome_version<126)&&(this.editContext=new R4(e),e.state.facet(ds)&&(e.contentDOM.editContext=this.editContext.editContext)),$m&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,s=this.selectionRange;if(n.state.facet(ds)?n.root.activeElement!=this.dom:!oc(this.dom,s))return;let l=s.anchorNode&&n.docView.tile.nearest(s.anchorNode);if(l&&l.isWidget()&&l.widget.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(ne.ie&&ne.ie_version<=11||ne.android&&ne.chrome)&&!n.state.selection.main.empty&&s.focusNode&&ac(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Lo(e.root);if(!t)return!1;let n=ne.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&D4(this.view,t)||t;if(!n||this.selectionRange.eq(n))return!1;let s=oc(this.dom,n);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&aj(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,T4),$m&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),$m&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let s=()=>{let l=this.delayedAndroidKey;l&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=l.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&l.force&&wo(this.dom,l.key,l.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,s=!1;for(let l of e){let a=this.readMutation(l);a&&(a.typeOver&&(s=!0),t==-1?{from:t,to:n}=a:(t=Math.min(a.from,t),n=Math.max(a.to,n)))}return{from:t,to:n,typeOver:s}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),s=this.selectionChanged&&oc(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let l=new Yj(this.view,e,t,n);return this.view.docView.domChanged={newSel:l.newSel?l.newSel.main:null},l}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,s=rT(this.view,t);return this.view.state==n&&(t.domChanged||t.newSel&&!Kf(this.view.state.selection,t.newSel.main))&&this.view.update([]),s}readMutation(e){let t=this.view.docView.tile.nearest(e.target);if(!t||t.isWidget())return null;if(t.markDirty(e.type=="attributes"),e.type=="childList"){let n=Fx(t,e.previousSibling||e.target.previousSibling,-1),s=Fx(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(ds)!=e.state.facet(ds)&&(e.view.contentDOM.editContext=e.state.facet(ds)?this.editContext.editContext:null))}destroy(){var e,t,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Fx(i,e,t){for(;e;){let n=kt.get(e);if(n&&n.parent==i)return n;let s=e.parentNode;e=s!=i.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function Xx(i,e){let t=e.startContainer,n=e.startOffset,s=e.endContainer,l=e.endOffset,a=i.docView.domAtPos(i.state.selection.main.anchor,1);return ac(a.node,a.offset,s,l)&&([t,n,s,l]=[s,l,t,n]),{anchorNode:t,anchorOffset:n,focusNode:s,focusOffset:l}}function D4(i,e){if(e.getComposedRanges){let s=e.getComposedRanges(i.root)[0];if(s)return Xx(i,s)}let t=null;function n(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return i.contentDOM.addEventListener("beforeinput",n,!0),i.dom.ownerDocument.execCommand("indent"),i.contentDOM.removeEventListener("beforeinput",n,!0),t?Xx(i,t):null}class R4{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let s=e.state.selection.main,{anchor:l,head:a}=s,c=this.toEditorPos(n.updateRangeStart),h=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:c,drifted:!1});let d=h-c>n.text.length;c==this.from&&l<this.from?c=l:h==this.to&&l>this.to&&(h=l);let p=lT(e.state.sliceDoc(c,h),n.text,(d?s.from:s.to)-c,d?"end":null);if(!p){let b=$.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));Kf(b,s)||e.dispatch({selection:b,userEvent:"select"});return}let m={from:p.from+c,to:p.toA+c,insert:He.of(n.text.slice(p.from,p.toB).split(`
`))};if((ne.mac||ne.android)&&m.from==a-1&&/^\. ?$/.test(n.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(m={from:c,to:h,insert:He.of([n.text.replace("."," ")])}),this.pendingContextChange=m,!e.state.readOnly){let b=this.to-this.from+(m.to-m.from+m.insert.length);Rb(e,m,$.single(this.toEditorPos(n.selectionStart,b),this.toEditorPos(n.selectionEnd,b)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),m.from<m.to&&!m.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,n.updateRangeStart-1),Math.min(t.text.length,n.updateRangeStart+1)))&&this.handlers.compositionend(n)},this.handlers.characterboundsupdate=n=>{let s=[],l=null;for(let a=this.toEditorPos(n.rangeStart),c=this.toEditorPos(n.rangeEnd);a<c;a++){let h=e.coordsForChar(a);l=h&&new DOMRect(h.left,h.top,h.right-h.left,h.bottom-h.top)||l||new DOMRect,s.push(l)}t.updateCharacterBounds(n.rangeStart,s)},this.handlers.textformatupdate=n=>{let s=[];for(let l of n.getTextFormats()){let a=l.underlineStyle,c=l.underlineThickness;if(!/none/i.test(a)&&!/none/i.test(c)){let h=this.toEditorPos(l.rangeStart),d=this.toEditorPos(l.rangeEnd);if(h<d){let p=`text-decoration: underline ${/^[a-z]/.test(a)?a+" ":a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${/thin/i.test(c)?1:2}px`;s.push(ue.mark({attributes:{style:p}}).range(h,d))}}}e.dispatch({effects:FC.of(ue.set(s))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)t.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let s=Lo(n.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,n=!1,s=this.pendingContextChange;return e.changes.iterChanges((l,a,c,h,d)=>{if(n)return;let p=d.length-(a-l);if(s&&a>=s.to)if(s.from==l&&s.to==a&&s.insert.eq(d)){s=this.pendingContextChange=null,t+=p,this.to+=p;return}else s=null,this.revertPending(e.state);if(l+=t,a+=t,a<=this.from)this.from+=p,this.to+=p;else if(l<this.to){if(l<this.from||a>this.to||this.to-this.from+d.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(l),this.toContextPos(a),d.toString()),this.to+=p}t+=p}),s&&!n&&this.revertPending(e.state),!n}update(e){let t=this.pendingContextChange,n=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(n.from,n.to)&&e.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),s=this.toContextPos(t.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(n,s)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class ee{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(s=>s.forEach(l=>n(l,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=e.root||oj(e.parent)||document,this.viewState=new Kx(e.state||je.create(e)),e.scrollTo&&e.scrollTo.is(Hh)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(oo).map(s=>new zm(s));for(let s of this.plugins)s.update(this);this.observer=new E4(this),this.inputState=new Jj(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Mx(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...e){let t=e.length==1&&e[0]instanceof Tt?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,s,l=this.state;for(let b of e){if(b.startState!=l)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");l=b.state}if(this.destroyed){this.viewState.state=l;return}let a=this.hasFocus,c=0,h=null;e.some(b=>b.annotation(fT))?(this.inputState.notifiedFocused=a,c=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,h=dT(l,a),h||(c=1));let d=this.observer.delayedAndroidKey,p=null;if(d?(this.observer.clearDelayedAndroidKey(),p=this.observer.readChange(),(p&&!this.state.doc.eq(l.doc)||!this.state.selection.eq(l.selection))&&(p=null)):this.observer.clear(),l.facet(je.phrases)!=this.state.facet(je.phrases))return this.setState(l);s=Vf.create(this,l,e),s.flags|=c;let m=this.viewState.scrollTarget;try{this.updateState=2;for(let b of e){if(m&&(m=m.map(b.changes)),b.scrollIntoView){let{main:v}=b.state.selection;m=new So(v.empty?v:$.cursor(v.head,v.head>v.anchor?-1:1))}for(let v of b.effects)v.is(Hh)&&(m=v.value.clip(this.state))}this.viewState.update(s,m),this.bidiCache=Yf.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(Ja)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(b=>b.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(Wh)!=s.state.facet(Wh)&&(this.viewState.mustMeasureContent=!0),(t||n||m||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!s.empty)for(let b of this.state.facet(by))try{b(s)}catch(v){gi(this.state,v,"update listener")}(h||p)&&Promise.resolve().then(()=>{h&&this.state==h.startState&&this.dispatch(h),p&&!rT(this,p)&&d.force&&wo(this.contentDOM,d.key,d.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new Kx(e),this.plugins=e.facet(oo).map(n=>new zm(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new Mx(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(oo),n=e.state.facet(oo);if(t!=n){let s=[];for(let l of n){let a=t.indexOf(l);if(a<0)s.push(new zm(l));else{let c=this.plugins[a];c.mustUpdate=e,s.push(c)}}for(let l of this.plugins)l.mustUpdate!=e&&l.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(n){gi(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,s=n.scrollTop*this.scaleY,{scrollAnchorPos:l,scrollAnchorHeight:a}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let c=0;;c++){if(a<0)if(MC(n))l=-1,a=this.viewState.heightMap.height;else{let v=this.viewState.scrollAnchorAt(s);l=v.from,a=v.top}this.updateState=1;let h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(c>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let d=[];h&4||([this.measureRequests,d]=[d,this.measureRequests]);let p=d.map(v=>{try{return v.read(this)}catch(w){return gi(this.state,w),Qx}}),m=Vf.create(this,this.state,[]),b=!1;m.flags|=h,t?t.flags|=h:t=m,this.updateState=2,m.empty||(this.updatePlugins(m),this.inputState.update(m),this.updateAttrs(),b=this.docView.update(m),b&&this.docViewUpdate());for(let v=0;v<d.length;v++)if(p[v]!=Qx)try{let w=d[v];w.write&&w.write(p[v],this)}catch(w){gi(this.state,w)}if(b&&this.docView.updateSelection(!0),!m.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let w=(l<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(l).top)-a;if(w>1||w<-1){s=s+w,n.scrollTop=s/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let c of this.state.facet(by))c(t)}get themeClasses(){return _y+" "+(this.state.facet(xy)?yT:mT)+" "+this.state.facet(Wh)}updateAttrs(){let e=Jx(this,XC,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(ds)?"true":"false",class:"cm-content",style:`${ne.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),Jx(this,Tb,t);let n=this.observer.ignore(()=>{let s=Ax(this.contentDOM,this.contentAttrs,t),l=Ax(this.dom,this.editorAttrs,e);return s||l});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let s of n.effects)if(s.is(ee.announce)){t&&(this.announceDOM.textContent=""),t=!1;let l=this.announceDOM.appendChild(document.createElement("div"));l.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Ja);let e=this.state.facet(ee.cspNonce);rr.mount(this.root,this.styleModules.concat(C4).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return qm(this,e,Nx(this,e,t,n))}moveByGroup(e,t){return qm(this,e,Nx(this,e,t,n=>Vj(this,e.head,n)))}visualLineSide(e,t){let n=this.bidiSpans(e),s=this.textDirectionAt(e.from),l=n[t?n.length-1:0];return $.cursor(l.side(t,s)+e.from,l.forward(!t,s)?1:-1)}moveToLineBoundary(e,t,n=!0){return qj(this,e,t,n)}moveVertically(e,t,n){return qm(this,e,$j(this,e,t,n))}domAtPos(e,t=1){return this.docView.domAtPos(e,t)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){this.readMeasured();let n=Sy(this,e,t);return n&&n.pos}posAndSideAtCoords(e,t=!0){return this.readMeasured(),Sy(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let s=this.state.doc.lineAt(e),l=this.bidiSpans(s),a=l[ps.find(l,e-s.from,-1,t)];return qf(n,a.dir==Ze.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(KC)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>M4)return zC(e.length);let t=this.textDirectionAt(e.from),n;for(let l of this.bidiCache)if(l.from==e.from&&l.dir==t&&(l.fresh||jC(l.isolates,n=Ex(this,e))))return l.order;n||(n=Ex(this,e));let s=gj(e.text,t,n);return this.bidiCache.push(new Yf(e.from,e.to,t,n,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||ne.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{RC(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Hh.of(new So(typeof e=="number"?$.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return Hh.of(new So($.cursor(n.from),"start","start",n.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return lt.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return lt.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=rr.newName(),s=[Wh.of(n),Ja.of(Oy(`.${n}`,e))];return t&&t.dark&&s.push(xy.of(!0)),s}static baseTheme(e){return ll.lowest(Ja.of(Oy("."+_y,e,bT)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),s=n&&kt.get(n)||kt.get(e);return((t=s?.root)===null||t===void 0?void 0:t.view)||null}}ee.styleModule=Ja;ee.inputHandler=$C;ee.clipboardInputFilter=Ab;ee.clipboardOutputFilter=Cb;ee.scrollHandler=YC;ee.focusChangeEffect=GC;ee.perLineTextDirection=KC;ee.exceptionSink=VC;ee.updateListener=by;ee.editable=ds;ee.mouseSelectionStyle=qC;ee.dragMovesSelection=HC;ee.clickAddsSelectionRange=PC;ee.decorations=Rd;ee.blockWrappers=QC;ee.outerDecorations=Eb;ee.atomicRanges=nu;ee.bidiIsolatedRanges=JC;ee.scrollMargins=ZC;ee.darkTheme=xy;ee.cspNonce=te.define({combine:i=>i.length?i[0]:""});ee.contentAttributes=Tb;ee.editorAttributes=XC;ee.lineWrapping=ee.contentAttributes.of({class:"cm-lineWrapping"});ee.announce=_e.define();const M4=4096,Qx={};class Yf{constructor(e,t,n,s,l,a){this.from=e,this.to=t,this.dir=n,this.isolates=s,this.fresh=l,this.order=a}static update(e,t){if(t.empty&&!e.some(l=>l.fresh))return e;let n=[],s=e.length?e[e.length-1].dir:Ze.LTR;for(let l=Math.max(0,e.length-10);l<e.length;l++){let a=e[l];a.dir==s&&!t.touchesRange(a.from,a.to)&&n.push(new Yf(t.mapPos(a.from,1),t.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return n}}function Jx(i,e,t){for(let n=i.state.facet(e),s=n.length-1;s>=0;s--){let l=n[s],a=typeof l=="function"?l(i):l;a&&xb(a,t)}return t}const N4=ne.mac?"mac":ne.windows?"win":ne.linux?"linux":"key";function L4(i,e){const t=i.split(/-(?!$)/);let n=t[t.length-1];n=="Space"&&(n=" ");let s,l,a,c;for(let h=0;h<t.length-1;++h){const d=t[h];if(/^(cmd|meta|m)$/i.test(d))c=!0;else if(/^a(lt)?$/i.test(d))s=!0;else if(/^(c|ctrl|control)$/i.test(d))l=!0;else if(/^s(hift)?$/i.test(d))a=!0;else if(/^mod$/i.test(d))e=="mac"?c=!0:l=!0;else throw new Error("Unrecognized modifier name: "+d)}return s&&(n="Alt-"+n),l&&(n="Ctrl-"+n),c&&(n="Meta-"+n),a&&(n="Shift-"+n),n}function Yh(i,e,t){return e.altKey&&(i="Alt-"+i),e.ctrlKey&&(i="Ctrl-"+i),e.metaKey&&(i="Meta-"+i),t!==!1&&e.shiftKey&&(i="Shift-"+i),i}const B4=ll.default(ee.domEventHandlers({keydown(i,e){return wT(vT(e.state),i,e,"editor")}})),Lb=te.define({enables:B4}),Zx=new WeakMap;function vT(i){let e=i.facet(Lb),t=Zx.get(e);return t||Zx.set(e,t=z4(e.reduce((n,s)=>n.concat(s),[]))),t}function U4(i,e,t){return wT(vT(i.state),e,i,t)}let Js=null;const j4=4e3;function z4(i,e=N4){let t=Object.create(null),n=Object.create(null),s=(a,c)=>{let h=n[a];if(h==null)n[a]=c;else if(h!=c)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},l=(a,c,h,d,p)=>{var m,b;let v=t[a]||(t[a]=Object.create(null)),w=c.split(/ (?!$)/).map(O=>L4(O,e));for(let O=1;O<w.length;O++){let R=w.slice(0,O).join(" ");s(R,!0),v[R]||(v[R]={preventDefault:!0,stopPropagation:!1,run:[C=>{let N=Js={view:C,prefix:R,scope:a};return setTimeout(()=>{Js==N&&(Js=null)},j4),!0}]})}let k=w.join(" ");s(k,!1);let _=v[k]||(v[k]={preventDefault:!1,stopPropagation:!1,run:((b=(m=v._any)===null||m===void 0?void 0:m.run)===null||b===void 0?void 0:b.slice())||[]});h&&_.run.push(h),d&&(_.preventDefault=!0),p&&(_.stopPropagation=!0)};for(let a of i){let c=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let d of c){let p=t[d]||(t[d]=Object.create(null));p._any||(p._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:m}=a;for(let b in p)p[b].run.push(v=>m(v,Ay))}let h=a[e]||a.key;if(h)for(let d of c)l(d,h,a.run,a.preventDefault,a.stopPropagation),a.shift&&l(d,"Shift-"+h,a.shift,a.preventDefault,a.stopPropagation)}return t}let Ay=null;function wT(i,e,t,n){Ay=e;let s=JU(e),l=hi(s,0),a=Ln(l)==s.length&&s!=" ",c="",h=!1,d=!1,p=!1;Js&&Js.view==t&&Js.scope==n&&(c=Js.prefix+" ",aT.indexOf(e.keyCode)<0&&(d=!0,Js=null));let m=new Set,b=_=>{if(_){for(let O of _.run)if(!m.has(O)&&(m.add(O),O(t)))return _.stopPropagation&&(p=!0),!0;_.preventDefault&&(_.stopPropagation&&(p=!0),d=!0)}return!1},v=i[n],w,k;return v&&(b(v[c+Yh(s,e,!a)])?h=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(ne.windows&&e.ctrlKey&&e.altKey)&&!(ne.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(w=lr[e.keyCode])&&w!=s?(b(v[c+Yh(w,e,!0)])||e.shiftKey&&(k=Lc[e.keyCode])!=s&&k!=w&&b(v[c+Yh(k,e,!1)]))&&(h=!0):a&&e.shiftKey&&b(v[c+Yh(s,e,!0)])&&(h=!0),!h&&b(v._any)&&(h=!0)),d&&(h=!0),h&&p&&e.stopPropagation(),Ay=null,h}class su{constructor(e,t,n,s,l){this.className=e,this.left=t,this.top=n,this.width=s,this.height=l}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let s=e.coordsAtPos(n.head,n.assoc||1);if(!s)return[];let l=ST(e);return[new su(t,s.left-l.left,s.top-l.top,null,s.bottom-s.top)]}else return I4(e,t,n)}}function ST(i){let e=i.scrollDOM.getBoundingClientRect();return{left:(i.textDirection==Ze.LTR?e.left:e.right-i.scrollDOM.clientWidth*i.scaleX)-i.scrollDOM.scrollLeft*i.scaleX,top:e.top-i.scrollDOM.scrollTop*i.scaleY}}function e_(i,e,t,n){let s=i.coordsAtPos(e,t*2);if(!s)return n;let l=i.dom.getBoundingClientRect(),a=(s.top+s.bottom)/2,c=i.posAtCoords({x:l.left+1,y:a}),h=i.posAtCoords({x:l.right-1,y:a});return c==null||h==null?n:{from:Math.max(n.from,Math.min(c,h)),to:Math.min(n.to,Math.max(c,h))}}function I4(i,e,t){if(t.to<=i.viewport.from||t.from>=i.viewport.to)return[];let n=Math.max(t.from,i.viewport.from),s=Math.min(t.to,i.viewport.to),l=i.textDirection==Ze.LTR,a=i.contentDOM,c=a.getBoundingClientRect(),h=ST(i),d=a.querySelector(".cm-line"),p=d&&window.getComputedStyle(d),m=c.left+(p?parseInt(p.paddingLeft)+Math.min(0,parseInt(p.textIndent)):0),b=c.right-(p?parseInt(p.paddingRight):0),v=wy(i,n,1),w=wy(i,s,-1),k=v.type==Gt.Text?v:null,_=w.type==Gt.Text?w:null;if(k&&(i.lineWrapping||v.widgetLineBreaks)&&(k=e_(i,n,1,k)),_&&(i.lineWrapping||w.widgetLineBreaks)&&(_=e_(i,s,-1,_)),k&&_&&k.from==_.from&&k.to==_.to)return R(C(t.from,t.to,k));{let j=k?C(t.from,null,k):N(v,!1),H=_?C(null,t.to,_):N(w,!0),D=[];return(k||v).to<(_||w).from-(k&&_?1:0)||v.widgetLineBreaks>1&&j.bottom+i.defaultLineHeight/2<H.top?D.push(O(m,j.bottom,b,H.top)):j.bottom<H.top&&i.elementAtHeight((j.bottom+H.top)/2).type==Gt.Text&&(j.bottom=H.top=(j.bottom+H.top)/2),R(j).concat(D).concat(R(H))}function O(j,H,D,W){return new su(e,j-h.left,H-h.top,Math.max(0,D-j),W-H)}function R({top:j,bottom:H,horizontal:D}){let W=[];for(let se=0;se<D.length;se+=2)W.push(O(D[se],j,D[se+1],H));return W}function C(j,H,D){let W=1e9,se=-1e9,Ce=[];function fe(re,be,z,Y,ae){let ye=i.coordsAtPos(re,re==D.to?-2:2),Te=i.coordsAtPos(z,z==D.from?2:-2);!ye||!Te||(W=Math.min(ye.top,Te.top,W),se=Math.max(ye.bottom,Te.bottom,se),ae==Ze.LTR?Ce.push(l&&be?m:ye.left,l&&Y?b:Te.right):Ce.push(!l&&Y?m:Te.left,!l&&be?b:ye.right))}let J=j??D.from,F=H??D.to;for(let re of i.visibleRanges)if(re.to>J&&re.from<F)for(let be=Math.max(re.from,J),z=Math.min(re.to,F);;){let Y=i.state.doc.lineAt(be);for(let ae of i.bidiSpans(Y)){let ye=ae.from+Y.from,Te=ae.to+Y.from;if(ye>=z)break;Te>be&&fe(Math.max(ye,be),j==null&&ye<=J,Math.min(Te,z),H==null&&Te>=F,ae.dir)}if(be=Y.to+1,be>=z)break}return Ce.length==0&&fe(J,j==null,F,H==null,i.textDirection),{top:W,bottom:se,horizontal:Ce}}function N(j,H){let D=c.top+(H?j.top:j.bottom);return{top:D,bottom:D,horizontal:[]}}}function P4(i,e){return i.constructor==e.constructor&&i.eq(e)}class H4{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(yf)!=e.state.facet(yf)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,n=e.facet(yf);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!P4(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let s of e)s.update&&t&&s.constructor&&this.drawn[n].constructor&&s.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(s.draw(),t);for(;t;){let s=t.nextSibling;t.remove(),t=s}this.drawn=e,ne.safari&&ne.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const yf=te.define();function kT(i){return[lt.define(e=>new H4(e,i)),yf.of(i)]}const jc=te.define({combine(i){return Gn(i,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function q4(i={}){return[jc.of(i),V4,$4,G4,WC.of(!0)]}function xT(i){return i.startState.facet(jc)!=i.state.facet(jc)}const V4=kT({above:!0,markers(i){let{state:e}=i,t=e.facet(jc),n=[];for(let s of e.selection.ranges){let l=s==e.selection.main;if(s.empty||t.drawRangeCursor){let a=l?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",c=s.empty?s:$.cursor(s.head,s.head>s.anchor?-1:1);for(let h of su.forRange(i,a,c))n.push(h)}}return n},update(i,e){i.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=xT(i);return t&&t_(i.state,e),i.docChanged||i.selectionSet||t},mount(i,e){t_(e.state,i)},class:"cm-cursorLayer"});function t_(i,e){e.style.animationDuration=i.facet(jc).cursorBlinkRate+"ms"}const $4=kT({above:!1,markers(i){return i.state.selection.ranges.map(e=>e.empty?[]:su.forRange(i,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(i,e){return i.docChanged||i.selectionSet||i.viewportChanged||xT(i)},class:"cm-selectionLayer"}),G4=ll.highest(ee.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),_T=_e.define({map(i,e){return i==null?null:e.mapPos(i)}}),tc=Wt.define({create(){return null},update(i,e){return i!=null&&(i=e.changes.mapPos(i)),e.effects.reduce((t,n)=>n.is(_T)?n.value:t,i)}}),K4=lt.fromClass(class{constructor(i){this.view=i,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(i){var e;let t=i.state.field(tc);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(i.startState.field(tc)!=t||i.docChanged||i.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:i}=this,e=i.state.field(tc),t=e!=null&&i.coordsAtPos(e);if(!t)return null;let n=i.scrollDOM.getBoundingClientRect();return{left:t.left-n.left+i.scrollDOM.scrollLeft*i.scaleX,top:t.top-n.top+i.scrollDOM.scrollTop*i.scaleY,height:t.bottom-t.top}}drawCursor(i){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;i?(this.cursor.style.left=i.left/e+"px",this.cursor.style.top=i.top/t+"px",this.cursor.style.height=i.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(i){this.view.state.field(tc)!=i&&this.view.dispatch({effects:_T.of(i)})}},{eventObservers:{dragover(i){this.setDropPos(this.view.posAtCoords({x:i.clientX,y:i.clientY}))},dragleave(i){(i.target==this.view.contentDOM||!this.view.contentDOM.contains(i.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function W4(){return[tc,K4]}function i_(i,e,t,n,s){e.lastIndex=0;for(let l=i.iterRange(t,n),a=t,c;!l.next().done;a+=l.value.length)if(!l.lineBreak)for(;c=e.exec(l.value);)s(a+c.index,c)}function Y4(i,e){let t=i.visibleRanges;if(t.length==1&&t[0].from==i.viewport.from&&t[0].to==i.viewport.to)return t;let n=[];for(let{from:s,to:l}of t)s=Math.max(i.state.doc.lineAt(s).from,s-e),l=Math.min(i.state.doc.lineAt(l).to,l+e),n.length&&n[n.length-1].to>=s?n[n.length-1].to=l:n.push({from:s,to:l});return n}class F4{constructor(e){const{regexp:t,decoration:n,decorate:s,boundary:l,maxLength:a=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,s)this.addMatch=(c,h,d,p)=>s(p,d,d+c[0].length,c,h);else if(typeof n=="function")this.addMatch=(c,h,d,p)=>{let m=n(c,h,d);m&&p(d,d+c[0].length,m)};else if(n)this.addMatch=(c,h,d,p)=>p(d,d+c[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=l,this.maxLength=a}createDeco(e){let t=new qn,n=t.add.bind(t);for(let{from:s,to:l}of Y4(e,this.maxLength))i_(e.state.doc,this.regexp,s,l,(a,c)=>this.addMatch(c,e,a,n));return t.finish()}updateDeco(e,t){let n=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((l,a,c,h)=>{h>=e.view.viewport.from&&c<=e.view.viewport.to&&(n=Math.min(c,n),s=Math.max(h,s))}),e.viewportMoved||s-n>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,t.map(e.changes),n,s):t}updateRange(e,t,n,s){for(let l of e.visibleRanges){let a=Math.max(l.from,n),c=Math.min(l.to,s);if(c>=a){let h=e.state.doc.lineAt(a),d=h.to<c?e.state.doc.lineAt(c):h,p=Math.max(l.from,h.from),m=Math.min(l.to,d.to);if(this.boundary){for(;a>h.from;a--)if(this.boundary.test(h.text[a-1-h.from])){p=a;break}for(;c<d.to;c++)if(this.boundary.test(d.text[c-d.from])){m=c;break}}let b=[],v,w=(k,_,O)=>b.push(O.range(k,_));if(h==d)for(this.regexp.lastIndex=p-h.from;(v=this.regexp.exec(h.text))&&v.index<m-h.from;)this.addMatch(v,e,v.index+h.from,w);else i_(e.state.doc,this.regexp,p,m,(k,_)=>this.addMatch(_,e,k,w));t=t.update({filterFrom:p,filterTo:m,filter:(k,_)=>k<p||_>m,add:b})}}return t}}const Cy=/x/.unicode!=null?"gu":"g",X4=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Cy),Q4={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Gm=null;function J4(){var i;if(Gm==null&&typeof document<"u"&&document.body){let e=document.body.style;Gm=((i=e.tabSize)!==null&&i!==void 0?i:e.MozTabSize)!=null}return Gm||!1}const bf=te.define({combine(i){let e=Gn(i,{render:null,specialChars:X4,addSpecialChars:null});return(e.replaceTabs=!J4())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Cy)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Cy)),e}});function Z4(i={}){return[bf.of(i),e8()]}let n_=null;function e8(){return n_||(n_=lt.fromClass(class{constructor(i){this.view=i,this.decorations=ue.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(i.state.facet(bf)),this.decorations=this.decorator.createDeco(i)}makeDecorator(i){return new F4({regexp:i.specialChars,decoration:(e,t,n)=>{let{doc:s}=t.state,l=hi(e[0],0);if(l==9){let a=s.lineAt(n),c=t.state.tabSize,h=Ko(a.text,c,n-a.from);return ue.replace({widget:new s8((c-h%c)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[l]||(this.decorationCache[l]=ue.replace({widget:new n8(i,l)}))},boundary:i.replaceTabs?void 0:/[^]/})}update(i){let e=i.state.facet(bf);i.startState.facet(bf)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(i.view)):this.decorations=this.decorator.updateDeco(i,this.decorations)}},{decorations:i=>i.decorations}))}const t8="";function i8(i){return i>=32?t8:i==10?"":String.fromCharCode(9216+i)}class n8 extends Kn{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=i8(this.code),n=e.state.phrase("Control character")+" "+(Q4[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,n,t);if(s)return s;let l=document.createElement("span");return l.textContent=t,l.title=n,l.setAttribute("aria-label",n),l.className="cm-specialChar",l}ignoreEvent(){return!1}}class s8 extends Kn{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function r8(){return o8}const l8=ue.line({class:"cm-activeLine"}),o8=lt.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.docChanged||i.selectionSet)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let e=-1,t=[];for(let n of i.state.selection.ranges){let s=i.lineBlockAt(n.head);s.from>e&&(t.push(l8.range(s.from)),e=s.from)}return ue.set(t)}},{decorations:i=>i.decorations}),Ty=2e3;function a8(i,e,t){let n=Math.min(e.line,t.line),s=Math.max(e.line,t.line),l=[];if(e.off>Ty||t.off>Ty||e.col<0||t.col<0){let a=Math.min(e.off,t.off),c=Math.max(e.off,t.off);for(let h=n;h<=s;h++){let d=i.doc.line(h);d.length<=c&&l.push($.range(d.from+a,d.to+c))}}else{let a=Math.min(e.col,t.col),c=Math.max(e.col,t.col);for(let h=n;h<=s;h++){let d=i.doc.line(h),p=oy(d.text,a,i.tabSize,!0);if(p<0)l.push($.cursor(d.to));else{let m=oy(d.text,c,i.tabSize);l.push($.range(d.from+p,d.from+m))}}}return l}function c8(i,e){let t=i.coordsAtPos(i.viewport.from);return t?Math.round(Math.abs((t.left-e)/i.defaultCharacterWidth)):-1}function s_(i,e){let t=i.posAtCoords({x:e.clientX,y:e.clientY},!1),n=i.state.doc.lineAt(t),s=t-n.from,l=s>Ty?-1:s==n.length?c8(i,e.clientX):Ko(n.text,i.state.tabSize,t-n.from);return{line:n.number,col:l,off:s}}function u8(i,e){let t=s_(i,e),n=i.state.selection;return t?{update(s){if(s.docChanged){let l=s.changes.mapPos(s.startState.doc.line(t.line).from),a=s.state.doc.lineAt(l);t={line:a.number,col:t.col,off:Math.min(t.off,a.length)},n=n.map(s.changes)}},get(s,l,a){let c=s_(i,s);if(!c)return n;let h=a8(i.state,t,c);return h.length?a?$.create(h.concat(n.ranges)):$.create(h):n}}:null}function h8(i){let e=(t=>t.altKey&&t.button==0);return ee.mouseSelectionStyle.of((t,n)=>e(n)?u8(t,n):null)}const f8={Alt:[18,i=>!!i.altKey],Control:[17,i=>!!i.ctrlKey],Shift:[16,i=>!!i.shiftKey],Meta:[91,i=>!!i.metaKey]},d8={style:"cursor: crosshair"};function p8(i={}){let[e,t]=f8[i.key||"Alt"],n=lt.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventObservers:{keydown(s){this.set(s.keyCode==e||t(s))},keyup(s){(s.keyCode==e||!t(s))&&this.set(!1)},mousemove(s){this.set(t(s))}}});return[n,ee.contentAttributes.of(s=>{var l;return!((l=s.plugin(n))===null||l===void 0)&&l.isDown?d8:null})]}const Fh="-10000px";class OT{constructor(e,t,n,s){this.facet=t,this.createTooltipView=n,this.removeTooltipView=s,this.input=e.state.facet(t),this.tooltips=this.input.filter(a=>a);let l=null;this.tooltipViews=this.tooltips.map(a=>l=n(a,l))}update(e,t){var n;let s=e.state.facet(this.facet),l=s.filter(h=>h);if(s===this.input){for(let h of this.tooltipViews)h.update&&h.update(e);return!1}let a=[],c=t?[]:null;for(let h=0;h<l.length;h++){let d=l[h],p=-1;if(d){for(let m=0;m<this.tooltips.length;m++){let b=this.tooltips[m];b&&b.create==d.create&&(p=m)}if(p<0)a[h]=this.createTooltipView(d,h?a[h-1]:null),c&&(c[h]=!!d.above);else{let m=a[h]=this.tooltipViews[p];c&&(c[h]=t[p]),m.update&&m.update(e)}}}for(let h of this.tooltipViews)a.indexOf(h)<0&&(this.removeTooltipView(h),(n=h.destroy)===null||n===void 0||n.call(h));return t&&(c.forEach((h,d)=>t[d]=h),t.length=c.length),this.input=s,this.tooltips=l,this.tooltipViews=a,!0}}function g8(i){let e=i.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const Km=te.define({combine:i=>{var e,t,n;return{position:ne.ios?"absolute":((e=i.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=i.find(s=>s.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=i.find(s=>s.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||g8}}}),r_=new WeakMap,Bb=lt.fromClass(class{constructor(i){this.view=i,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=i.state.facet(Km);this.position=e.position,this.parent=e.parent,this.classes=i.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new OT(i,Ub,(t,n)=>this.createTooltip(t,n),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),i.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let i of this.manager.tooltipViews)this.intersectionObserver.observe(i.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(i){i.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(i,this.above);e&&this.observeIntersection();let t=e||i.geometryChanged,n=i.state.facet(Km);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(i,e){let t=i.create(this.view),n=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),i.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",t.dom.appendChild(s)}return t.dom.style.position=this.position,t.dom.style.top=Fh,t.dom.style.left="0px",this.container.insertBefore(t.dom,n),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var i,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(i=n.destroy)===null||i===void 0||i.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let i=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:l}=this.manager.tooltipViews[0];if(ne.safari){let a=l.getBoundingClientRect();t=Math.abs(a.top+1e4)>1||Math.abs(a.left)>1}else t=!!l.offsetParent&&l.offsetParent!=this.container.ownerDocument.body}if(t||this.position=="absolute")if(this.parent){let l=this.parent.getBoundingClientRect();l.width&&l.height&&(i=l.width/this.parent.offsetWidth,e=l.height/this.parent.offsetHeight)}else({scaleX:i,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),s=Db(this.view);return{visible:{left:n.left+s.left,top:n.top+s.top,right:n.right-s.right,bottom:n.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((l,a)=>{let c=this.manager.tooltipViews[a];return c.getCoords?c.getCoords(l.pos):this.view.coordsAtPos(l.pos)}),size:this.manager.tooltipViews.map(({dom:l})=>l.getBoundingClientRect()),space:this.view.state.facet(Km).tooltipSpace(this.view),scaleX:i,scaleY:e,makeAbsolute:t}}writeMeasure(i){var e;if(i.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let c of this.manager.tooltipViews)c.dom.style.position="absolute"}let{visible:t,space:n,scaleX:s,scaleY:l}=i,a=[];for(let c=0;c<this.manager.tooltips.length;c++){let h=this.manager.tooltips[c],d=this.manager.tooltipViews[c],{dom:p}=d,m=i.pos[c],b=i.size[c];if(!m||h.clip!==!1&&(m.bottom<=Math.max(t.top,n.top)||m.top>=Math.min(t.bottom,n.bottom)||m.right<Math.max(t.left,n.left)-.1||m.left>Math.min(t.right,n.right)+.1)){p.style.top=Fh;continue}let v=h.arrow?d.dom.querySelector(".cm-tooltip-arrow"):null,w=v?7:0,k=b.right-b.left,_=(e=r_.get(d))!==null&&e!==void 0?e:b.bottom-b.top,O=d.offset||y8,R=this.view.textDirection==Ze.LTR,C=b.width>n.right-n.left?R?n.left:n.right-b.width:R?Math.max(n.left,Math.min(m.left-(v?14:0)+O.x,n.right-k)):Math.min(Math.max(n.left,m.left-k+(v?14:0)-O.x),n.right-k),N=this.above[c];!h.strictSide&&(N?m.top-_-w-O.y<n.top:m.bottom+_+w+O.y>n.bottom)&&N==n.bottom-m.bottom>m.top-n.top&&(N=this.above[c]=!N);let j=(N?m.top-n.top:n.bottom-m.bottom)-w;if(j<_&&d.resize!==!1){if(j<this.view.defaultLineHeight){p.style.top=Fh;continue}r_.set(d,_),p.style.height=(_=j)/l+"px"}else p.style.height&&(p.style.height="");let H=N?m.top-_-w-O.y:m.bottom+w+O.y,D=C+k;if(d.overlap!==!0)for(let W of a)W.left<D&&W.right>C&&W.top<H+_&&W.bottom>H&&(H=N?W.top-_-2-w:W.bottom+w+2);if(this.position=="absolute"?(p.style.top=(H-i.parent.top)/l+"px",l_(p,(C-i.parent.left)/s)):(p.style.top=H/l+"px",l_(p,C/s)),v){let W=m.left+(R?O.x:-O.x)-(C+14-7);v.style.left=W/s+"px"}d.overlap!==!0&&a.push({left:C,top:H,right:D,bottom:H+_}),p.classList.toggle("cm-tooltip-above",N),p.classList.toggle("cm-tooltip-below",!N),d.positioned&&d.positioned(i.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let i of this.manager.tooltipViews)i.dom.style.top=Fh}},{eventObservers:{scroll(){this.maybeMeasure()}}});function l_(i,e){let t=parseInt(i.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(i.style.left=e+"px")}const m8=ee.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),y8={x:0,y:0},Ub=te.define({enables:[Bb,m8]}),Ff=te.define({combine:i=>i.reduce((e,t)=>e.concat(t),[])});class Bd{static create(e){return new Bd(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new OT(e,Ff,(t,n)=>this.createHostedView(t,n),t=>t.dom.remove())}createHostedView(e,t){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let s=n[e];if(s!==void 0){if(t===void 0)t=s;else if(t!==s)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const b8=Ub.compute([Ff],i=>{let e=i.facet(Ff);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var n;return(n=t.end)!==null&&n!==void 0?n:t.pos})),create:Bd.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class v8{constructor(e,t,n,s,l){this.view=e,this.source=t,this.field=n,this.setHover=s,this.hoverTime=l,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.tile.nearest(t.target);if(!n)return;let s,l=1;if(n.isWidget())s=n.posAtStart;else{if(s=e.posAtCoords(t),s==null)return;let c=e.coordsAtPos(s);if(!c||t.y<c.top||t.y>c.bottom||t.x<c.left-e.defaultCharacterWidth||t.x>c.right+e.defaultCharacterWidth)return;let h=e.bidiSpans(e.state.doc.lineAt(s)).find(p=>p.from<=s&&p.to>=s),d=h&&h.dir==Ze.RTL?-1:1;l=t.x<c.left?-d:d}let a=this.source(e,s,l);if(a?.then){let c=this.pending={pos:s};a.then(h=>{this.pending==c&&(this.pending=null,h&&!(Array.isArray(h)&&!h.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(h)?h:[h])}))},h=>gi(e.state,h,"hover tooltip"))}else a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}get tooltip(){let e=this.view.plugin(Bb),t=e?e.manager.tooltips.findIndex(n=>n.create==Bd.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:s,tooltip:l}=this;if(s.length&&l&&!w8(l.dom,e)||this.pending){let{pos:a}=s[0]||this.pending,c=(n=(t=s[0])===null||t===void 0?void 0:t.end)!==null&&n!==void 0?n:a;(a==c?this.view.posAtCoords(this.lastMove)!=a:!S8(this.view,a,c,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),clearTimeout(this.restartTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Xh=4;function w8(i,e){let{left:t,right:n,top:s,bottom:l}=i.getBoundingClientRect(),a;if(a=i.querySelector(".cm-tooltip-arrow")){let c=a.getBoundingClientRect();s=Math.min(c.top,s),l=Math.max(c.bottom,l)}return e.clientX>=t-Xh&&e.clientX<=n+Xh&&e.clientY>=s-Xh&&e.clientY<=l+Xh}function S8(i,e,t,n,s,l){let a=i.scrollDOM.getBoundingClientRect(),c=i.documentTop+i.documentPadding.top+i.contentHeight;if(a.left>n||a.right<n||a.top>s||Math.min(a.bottom,c)<s)return!1;let h=i.posAtCoords({x:n,y:s},!1);return h>=e&&h<=t}function k8(i,e={}){let t=_e.define(),n=Wt.define({create(){return[]},update(s,l){if(s.length&&(e.hideOnChange&&(l.docChanged||l.selection)?s=[]:e.hideOn&&(s=s.filter(a=>!e.hideOn(l,a))),l.docChanged)){let a=[];for(let c of s){let h=l.changes.mapPos(c.pos,-1,ti.TrackDel);if(h!=null){let d=Object.assign(Object.create(null),c);d.pos=h,d.end!=null&&(d.end=l.changes.mapPos(d.end)),a.push(d)}}s=a}for(let a of l.effects)a.is(t)&&(s=a.value),a.is(x8)&&(s=[]);return s},provide:s=>Ff.from(s)});return{active:n,extension:[n,lt.define(s=>new v8(s,i,n,t,e.hoverTime||300)),b8]}}function AT(i,e){let t=i.plugin(Bb);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}const x8=_e.define(),o_=te.define({combine(i){let e,t;for(let n of i)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function jb(i,e){let t=i.plugin(CT),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}const CT=lt.fromClass(class{constructor(i){this.input=i.state.facet(zc),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(i));let e=i.state.facet(o_);this.top=new Qh(i,!0,e.topContainer),this.bottom=new Qh(i,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(i){let e=i.state.facet(o_);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Qh(i.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Qh(i.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=i.state.facet(zc);if(t!=this.input){let n=t.filter(h=>h),s=[],l=[],a=[],c=[];for(let h of n){let d=this.specs.indexOf(h),p;d<0?(p=h(i.view),c.push(p)):(p=this.panels[d],p.update&&p.update(i)),s.push(p),(p.top?l:a).push(p)}this.specs=n,this.panels=s,this.top.sync(l),this.bottom.sync(a);for(let h of c)h.dom.classList.add("cm-panel"),h.mount&&h.mount()}else for(let n of this.panels)n.update&&n.update(i)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:i=>ee.scrollMargins.of(e=>{let t=e.plugin(i);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Qh{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=a_(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=a_(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function a_(i){let e=i.nextSibling;return i.remove(),e}const zc=te.define({enables:CT});function _8(i,e){let t,n=new Promise(a=>t=a),s=a=>O8(a,e,t);i.state.field(Wm,!1)?i.dispatch({effects:TT.of(s)}):i.dispatch({effects:_e.appendConfig.of(Wm.init(()=>[s]))});let l=ET.of(s);return{close:l,result:n.then(a=>((i.win.queueMicrotask||(h=>i.win.setTimeout(h,10)))(()=>{i.state.field(Wm).indexOf(s)>-1&&i.dispatch({effects:l})}),a))}}const Wm=Wt.define({create(){return[]},update(i,e){for(let t of e.effects)t.is(TT)?i=[t.value].concat(i):t.is(ET)&&(i=i.filter(n=>n!=t.value));return i},provide:i=>zc.computeN([i],e=>e.field(i))}),TT=_e.define(),ET=_e.define();function O8(i,e,t){let n=e.content?e.content(i,()=>a(null)):null;if(!n){if(n=Ye("form"),e.input){let c=Ye("input",e.input);/^(text|password|number|email|tel|url)$/.test(c.type)&&c.classList.add("cm-textfield"),c.name||(c.name="input"),n.appendChild(Ye("label",(e.label||"")+": ",c))}else n.appendChild(document.createTextNode(e.label||""));n.appendChild(document.createTextNode(" ")),n.appendChild(Ye("button",{class:"cm-button",type:"submit"},e.submitLabel||"OK"))}let s=n.nodeName=="FORM"?[n]:n.querySelectorAll("form");for(let c=0;c<s.length;c++){let h=s[c];h.addEventListener("keydown",d=>{d.keyCode==27?(d.preventDefault(),a(null)):d.keyCode==13&&(d.preventDefault(),a(h))}),h.addEventListener("submit",d=>{d.preventDefault(),a(h)})}let l=Ye("div",n,Ye("button",{onclick:()=>a(null),"aria-label":i.state.phrase("close"),class:"cm-dialog-close",type:"button"},[""]));e.class&&(l.className=e.class),l.classList.add("cm-dialog");function a(c){l.contains(l.ownerDocument.activeElement)&&i.focus(),t(c)}return{dom:l,top:e.top,mount:()=>{if(e.focus){let c;typeof e.focus=="string"?c=n.querySelector(e.focus):c=n.querySelector("input")||n.querySelector("button"),c&&"select"in c?c.select():c&&"focus"in c&&c.focus()}}}}class bs extends sr{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}bs.prototype.elementClass="";bs.prototype.toDOM=void 0;bs.prototype.mapMode=ti.TrackBefore;bs.prototype.startSide=bs.prototype.endSide=-1;bs.prototype.point=!0;const vf=te.define(),A8=te.define(),C8={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>De.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},uc=te.define();function T8(i){return[DT(),uc.of({...C8,...i})]}const c_=te.define({combine:i=>i.some(e=>e)});function DT(i){return[E8]}const E8=lt.fromClass(class{constructor(i){this.view=i,this.domAfter=null,this.prevViewport=i.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=i.state.facet(uc).map(e=>new h_(i,e)),this.fixed=!i.state.facet(c_);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),i.scrollDOM.insertBefore(this.dom,i.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(i){if(this.updateGutters(i)){let e=this.prevViewport,t=i.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}if(i.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(c_)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=i.view.viewport}syncGutters(i){let e=this.dom.nextSibling;i&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let t=De.iter(this.view.state.facet(vf),this.view.viewport.from),n=[],s=this.gutters.map(l=>new D8(l,this.view.viewport,-this.view.documentPadding.top));for(let l of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(l.type)){let a=!0;for(let c of l.type)if(c.type==Gt.Text&&a){Ey(t,n,c.from);for(let h of s)h.line(this.view,c,n);a=!1}else if(c.widget)for(let h of s)h.widget(this.view,c)}else if(l.type==Gt.Text){Ey(t,n,l.from);for(let a of s)a.line(this.view,l,n)}else if(l.widget)for(let a of s)a.widget(this.view,l);for(let l of s)l.finish();i&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(i){let e=i.startState.facet(uc),t=i.state.facet(uc),n=i.docChanged||i.heightChanged||i.viewportChanged||!De.eq(i.startState.facet(vf),i.state.facet(vf),i.view.viewport.from,i.view.viewport.to);if(e==t)for(let s of this.gutters)s.update(i)&&(n=!0);else{n=!0;let s=[];for(let l of t){let a=e.indexOf(l);a<0?s.push(new h_(this.view,l)):(this.gutters[a].update(i),s.push(this.gutters[a]))}for(let l of this.gutters)l.dom.remove(),s.indexOf(l)<0&&l.destroy();for(let l of s)l.config.side=="after"?this.getDOMAfter().appendChild(l.dom):this.dom.appendChild(l.dom);this.gutters=s}return n}destroy(){for(let i of this.gutters)i.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:i=>ee.scrollMargins.of(e=>{let t=e.plugin(i);if(!t||t.gutters.length==0||!t.fixed)return null;let n=t.dom.offsetWidth*e.scaleX,s=t.domAfter?t.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==Ze.LTR?{left:n,right:s}:{right:n,left:s}})});function u_(i){return Array.isArray(i)?i:[i]}function Ey(i,e,t){for(;i.value&&i.from<=t;)i.from==t&&e.push(i.value),i.next()}class D8{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=De.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:s}=this,l=(t.top-this.height)/e.scaleY,a=t.height/e.scaleY;if(this.i==s.elements.length){let c=new RT(e,a,l,n);s.elements.push(c),s.dom.appendChild(c.dom)}else s.elements[this.i].update(e,a,l,n);this.height=t.bottom,this.i++}line(e,t,n){let s=[];Ey(this.cursor,s,t.from),n.length&&(s=s.concat(n));let l=this.gutter.config.lineMarker(e,t,s);l&&s.unshift(l);let a=this.gutter;s.length==0&&!a.config.renderEmptyElements||this.addElement(e,t,s)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t),s=n?[n]:null;for(let l of e.state.facet(A8)){let a=l(e,t.widget,t);a&&(s||(s=[])).push(a)}s&&this.addElement(e,t,s)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class h_{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,s=>{let l=s.target,a;if(l!=this.dom&&this.dom.contains(l)){for(;l.parentNode!=this.dom;)l=l.parentNode;let h=l.getBoundingClientRect();a=(h.top+h.bottom)/2}else a=s.clientY;let c=e.lineBlockAtHeight(a-e.documentTop);t.domEventHandlers[n](e,c,s)&&s.preventDefault()});this.markers=u_(t.markers(e)),t.initialSpacer&&(this.spacer=new RT(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=u_(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let n=e.view.viewport;return!De.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class RT{constructor(e,t,n,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,s)}update(e,t,n,s){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),R8(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,t){let n="cm-gutterElement",s=this.dom.firstChild;for(let l=0,a=0;;){let c=a,h=l<t.length?t[l++]:null,d=!1;if(h){let p=h.elementClass;p&&(n+=" "+p);for(let m=a;m<this.markers.length;m++)if(this.markers[m].compare(h)){c=m,d=!0;break}}else c=this.markers.length;for(;a<c;){let p=this.markers[a++];if(p.toDOM){p.destroy(s);let m=s.nextSibling;s.remove(),s=m}}if(!h)break;h.toDOM&&(d?s=s.nextSibling:this.dom.insertBefore(h.toDOM(e),s)),d&&a++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}function R8(i,e){if(i.length!=e.length)return!1;for(let t=0;t<i.length;t++)if(!i[t].compare(e[t]))return!1;return!0}const M8=te.define(),N8=te.define(),ao=te.define({combine(i){return Gn(i,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let s in t){let l=n[s],a=t[s];n[s]=l?(c,h,d)=>l(c,h,d)||a(c,h,d):a}return n}})}});class Ym extends bs{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Fm(i,e){return i.state.facet(ao).formatNumber(e,i.state)}const L8=uc.compute([ao],i=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(M8)},lineMarker(e,t,n){return n.some(s=>s.toDOM)?null:new Ym(Fm(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,n)=>{for(let s of e.state.facet(N8)){let l=s(e,t,n);if(l)return l}return null},lineMarkerChange:e=>e.startState.facet(ao)!=e.state.facet(ao),initialSpacer(e){return new Ym(Fm(e,f_(e.state.doc.lines)))},updateSpacer(e,t){let n=Fm(t.view,f_(t.view.state.doc.lines));return n==e.number?e:new Ym(n)},domEventHandlers:i.facet(ao).domEventHandlers,side:"before"}));function B8(i={}){return[ao.of(i),DT(),L8]}function f_(i){let e=9;for(;e<i;)e=e*10+9;return e}const U8=new class extends bs{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},j8=vf.compute(["selection"],i=>{let e=[],t=-1;for(let n of i.selection.ranges){let s=i.doc.lineAt(n.head).from;s>t&&(t=s,e.push(U8.range(s)))}return De.of(e)});function z8(){return j8}const MT=1024;let I8=0;class Xm{constructor(e,t){this.from=e,this.to=t}}class Re{constructor(e={}){this.id=I8++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=bi.match(e)),t=>{let n=e(t);return n===void 0?null:[this,n]}}}Re.closedBy=new Re({deserialize:i=>i.split(" ")});Re.openedBy=new Re({deserialize:i=>i.split(" ")});Re.group=new Re({deserialize:i=>i.split(" ")});Re.isolate=new Re({deserialize:i=>{if(i&&i!="rtl"&&i!="ltr"&&i!="auto")throw new RangeError("Invalid value for isolate: "+i);return i||"auto"}});Re.contextHash=new Re({perNode:!0});Re.lookAhead=new Re({perNode:!0});Re.mounted=new Re({perNode:!0});class hc{constructor(e,t,n,s=!1){this.tree=e,this.overlay=t,this.parser=n,this.bracketed=s}static get(e){return e&&e.props&&e.props[Re.mounted.id]}}const P8=Object.create(null);class bi{constructor(e,t,n,s=0){this.name=e,this.props=t,this.id=n,this.flags=s}static define(e){let t=e.props&&e.props.length?Object.create(null):P8,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new bi(e.name||"",t,e.id,n);if(e.props){for(let l of e.props)if(Array.isArray(l)||(l=l(s)),l){if(l[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[l[0].id]=l[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Re.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let s of n.split(" "))t[s]=e[n];return n=>{for(let s=n.prop(Re.group),l=-1;l<(s?s.length:0);l++){let a=t[l<0?n.name:s[l]];if(a)return a}}}}bi.none=new bi("",Object.create(null),0,8);class zb{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let s=null;for(let l of e){let a=l(n);if(a){s||(s=Object.assign({},n.props));let c=a[1],h=a[0];h.combine&&h.id in s&&(c=h.combine(s[h.id],c)),s[h.id]=c}}t.push(s?new bi(n.name,s,n.id,n.flags):n)}return new zb(t)}}const Jh=new WeakMap,d_=new WeakMap;var ut;(function(i){i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays",i[i.EnterBracketed=16]="EnterBracketed"})(ut||(ut={}));class mt{constructor(e,t,n,s,l){if(this.type=e,this.children=t,this.positions=n,this.length=s,this.props=null,l&&l.length){this.props=Object.create(null);for(let[a,c]of l)this.props[typeof a=="number"?a:a.id]=c}}toString(){let e=hc.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let s=n.toString();s&&(t&&(t+=","),t+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Ry(this.topNode,e)}cursorAt(e,t=0,n=0){let s=Jh.get(this)||this.topNode,l=new Ry(s);return l.moveTo(e,t),Jh.set(this,l._tree),l}get topNode(){return new sn(this,0,0,null)}resolve(e,t=0){let n=Ic(Jh.get(this)||this.topNode,e,t,!1);return Jh.set(this,n),n}resolveInner(e,t=0){let n=Ic(d_.get(this)||this.topNode,e,t,!0);return d_.set(this,n),n}resolveStack(e,t=0){return V8(this,e,t)}iterate(e){let{enter:t,leave:n,from:s=0,to:l=this.length}=e,a=e.mode||0,c=(a&ut.IncludeAnonymous)>0;for(let h=this.cursor(a|ut.IncludeAnonymous);;){let d=!1;if(h.from<=l&&h.to>=s&&(!c&&h.type.isAnonymous||t(h)!==!1)){if(h.firstChild())continue;d=!0}for(;d&&n&&(c||!h.type.isAnonymous)&&n(h),!h.nextSibling();){if(!h.parent())return;d=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Hb(bi.none,this.children,this.positions,0,this.children.length,0,this.length,(t,n,s)=>new mt(this.type,t,n,s,this.propValues),e.makeTree||((t,n,s)=>new mt(bi.none,t,n,s)))}static build(e){return $8(e)}}mt.empty=new mt(bi.none,[],[],0);class Ib{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ib(this.buffer,this.index)}}class ar{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return bi.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],s=this.set.types[t],l=s.name;if(/\W/.test(l)&&!s.isError&&(l=JSON.stringify(l)),e+=4,n==e)return l;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return l+"("+a.join(",")+")"}findChild(e,t,n,s,l){let{buffer:a}=this,c=-1;for(let h=e;h!=t&&!(NT(l,s,a[h+1],a[h+2])&&(c=h,n>0));h=a[h+3]);return c}slice(e,t,n){let s=this.buffer,l=new Uint16Array(t-e),a=0;for(let c=e,h=0;c<t;){l[h++]=s[c++],l[h++]=s[c++]-n;let d=l[h++]=s[c++]-n;l[h++]=s[c++]-e,a=Math.max(a,d)}return new ar(l,a,this.set)}}function NT(i,e,t,n){switch(i){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function Ic(i,e,t,n){for(var s;i.from==i.to||(t<1?i.from>=e:i.from>e)||(t>-1?i.to<=e:i.to<e);){let a=!n&&i instanceof sn&&i.index<0?null:i.parent;if(!a)return i;i=a}let l=n?0:ut.IgnoreOverlays;if(n)for(let a=i,c=a.parent;c;a=c,c=a.parent)a instanceof sn&&a.index<0&&((s=c.enter(e,t,l))===null||s===void 0?void 0:s.from)!=a.from&&(i=c);for(;;){let a=i.enter(e,t,l);if(!a)return i;i=a}}class LT{cursor(e=0){return new Ry(this,e)}getChild(e,t=null,n=null){let s=p_(this,e,t,n);return s.length?s[0]:null}getChildren(e,t=null,n=null){return p_(this,e,t,n)}resolve(e,t=0){return Ic(this,e,t,!1)}resolveInner(e,t=0){return Ic(this,e,t,!0)}matchContext(e){return Dy(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let s=t.lastChild;if(!s||s.to!=t.to)break;s.type.isError&&s.from==s.to?(n=t,t=s.prevSibling):t=s}return n}get node(){return this}get next(){return this.parent}}class sn extends LT{constructor(e,t,n,s){super(),this._tree=e,this.from=t,this.index=n,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,s,l=0){for(let a=this;;){for(let{children:c,positions:h}=a._tree,d=t>0?c.length:-1;e!=d;e+=t){let p=c[e],m=h[e]+a.from,b;if(!(!(l&ut.EnterBracketed&&p instanceof mt&&(b=hc.get(p))&&!b.overlay&&b.bracketed&&n>=m&&n<=m+p.length)&&!NT(s,n,m,m+p.length))){if(p instanceof ar){if(l&ut.ExcludeBuffers)continue;let v=p.findChild(0,p.buffer.length,t,n-m,s);if(v>-1)return new tr(new H8(a,p,e,m),null,v)}else if(l&ut.IncludeAnonymous||!p.type.isAnonymous||Pb(p)){let v;if(!(l&ut.IgnoreMounts)&&(v=hc.get(p))&&!v.overlay)return new sn(v.tree,m,e,a);let w=new sn(p,m,e,a);return l&ut.IncludeAnonymous||!w.type.isAnonymous?w:w.nextChild(t<0?p.children.length-1:0,t,n,s,l)}}}if(l&ut.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,t,n=0){let s;if(!(n&ut.IgnoreOverlays)&&(s=hc.get(this._tree))&&s.overlay){let l=e-this.from,a=n&ut.EnterBracketed&&s.bracketed;for(let{from:c,to:h}of s.overlay)if((t>0||a?c<=l:c<l)&&(t<0||a?h>=l:h>l))return new sn(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function p_(i,e,t,n){let s=i.cursor(),l=[];if(!s.firstChild())return l;if(t!=null){for(let a=!1;!a;)if(a=s.type.is(t),!s.nextSibling())return l}for(;;){if(n!=null&&s.type.is(n))return l;if(s.type.is(e)&&l.push(s.node),!s.nextSibling())return n==null?l:[]}}function Dy(i,e,t=e.length-1){for(let n=i;t>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}class H8{constructor(e,t,n,s){this.parent=e,this.buffer=t,this.index=n,this.start=s}}class tr extends LT{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:s}=this.context,l=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.context.start,n);return l<0?null:new tr(this.context,this,l)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,t,n=0){if(n&ut.ExcludeBuffers)return null;let{buffer:s}=this.context,l=s.findChild(this.index+4,s.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return l<0?null:new tr(this.context,this,l)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new tr(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new tr(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,s=this.index+4,l=n.buffer[this.index+3];if(l>s){let a=n.buffer[this.index+1];e.push(n.slice(s,l,a)),t.push(0)}return new mt(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function BT(i){if(!i.length)return null;let e=0,t=i[0];for(let l=1;l<i.length;l++){let a=i[l];(a.from>t.from||a.to<t.to)&&(t=a,e=l)}let n=t instanceof sn&&t.index<0?null:t.parent,s=i.slice();return n?s[e]=n:s.splice(e,1),new q8(s,t)}class q8{constructor(e,t){this.heads=e,this.node=t}get next(){return BT(this.heads)}}function V8(i,e,t){let n=i.resolveInner(e,t),s=null;for(let l=n instanceof sn?n:n.context.parent;l;l=l.parent)if(l.index<0){let a=l.parent;(s||(s=[n])).push(a.resolve(e,t)),l=a}else{let a=hc.get(l.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let c=new sn(a.tree,a.overlay[0].from+l.from,-1,l);(s||(s=[n])).push(Ic(c,e,t,!1))}}return s?BT(s):n}class Ry{get name(){return this.type.name}constructor(e,t=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=t&~ut.EnterBracketed,e instanceof sn)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:n,buffer:s}=this.buffer;return this.type=t||s.set.types[s.buffer[e]],this.from=n+s.buffer[e+1],this.to=n+s.buffer[e+2],!0}yield(e){return e?e instanceof sn?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:s}=this.buffer,l=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.buffer.start,n);return l<0?!1:(this.stack.push(this.index),this.yieldBuf(l))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?n&ut.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ut.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ut.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let s=n<0?0:this.stack[n]+4;if(this.index!=s)return this.yieldBuf(t.findChild(s,this.index,-1,0,4))}else{let s=t.buffer[this.index+3];if(s<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(s)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let l=0;l<this.index;l++)if(s.buffer.buffer[l+3]<this.index)return!1;({index:t,parent:n}=s)}else({index:t,_parent:n}=this._tree);for(;n;{index:t,_parent:n}=n)if(t>-1)for(let l=t+e,a=e<0?-1:n._tree.children.length;l!=a;l+=e){let c=n._tree.children[l];if(this.mode&ut.IncludeAnonymous||c instanceof ar||!c.type.isAnonymous||Pb(c))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let s=this.index,l=this.stack.length;l>=0;){for(let a=e;a;a=a._parent)if(a.index==s){if(s==this.index)return a;t=a,n=l+1;break e}s=this.stack[--l]}for(let s=n;s<this.stack.length;s++)t=new tr(this.buffer,t,this.stack[s]);return this.bufferNode=new tr(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&t&&t(this),s=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,s=!0}}}matchContext(e){if(!this.buffer)return Dy(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let s=e.length-1,l=this.stack.length-1;s>=0;l--){if(l<0)return Dy(this._tree,e,s);let a=n[t.buffer[this.stack[l]]];if(!a.isAnonymous){if(e[s]&&e[s]!=a.name)return!1;s--}}return!0}}function Pb(i){return i.children.some(e=>e instanceof ar||!e.type.isAnonymous||Pb(e))}function $8(i){var e;let{buffer:t,nodeSet:n,maxBufferLength:s=MT,reused:l=[],minRepeatType:a=n.types.length}=i,c=Array.isArray(t)?new Ib(t,t.length):t,h=n.types,d=0,p=0;function m(j,H,D,W,se,Ce){let{id:fe,start:J,end:F,size:re}=c,be=p,z=d;if(re<0)if(c.next(),re==-1){let T=l[fe];D.push(T),W.push(J-j);return}else if(re==-3){d=fe;return}else if(re==-4){p=fe;return}else throw new RangeError(`Unrecognized record size: ${re}`);let Y=h[fe],ae,ye,Te=J-j;if(F-J<=s&&(ye=_(c.pos-H,se))){let T=new Uint16Array(ye.size-ye.skip),q=c.pos-ye.size,X=T.length;for(;c.pos>q;)X=O(ye.start,T,X);ae=new ar(T,F-ye.start,n),Te=ye.start-j}else{let T=c.pos-re;c.next();let q=[],X=[],ie=fe>=a?fe:-1,ge=0,we=F;for(;c.pos>T;)ie>=0&&c.id==ie&&c.size>=0?(c.end<=we-s&&(w(q,X,J,ge,c.end,we,ie,be,z),ge=q.length,we=c.end),c.next()):Ce>2500?b(J,T,q,X):m(J,T,q,X,ie,Ce+1);if(ie>=0&&ge>0&&ge<q.length&&w(q,X,J,ge,J,we,ie,be,z),q.reverse(),X.reverse(),ie>-1&&ge>0){let ze=v(Y,z);ae=Hb(Y,q,X,0,q.length,0,F-J,ze,ze)}else ae=k(Y,q,X,F-J,be-F,z)}D.push(ae),W.push(Te)}function b(j,H,D,W){let se=[],Ce=0,fe=-1;for(;c.pos>H;){let{id:J,start:F,end:re,size:be}=c;if(be>4)c.next();else{if(fe>-1&&F<fe)break;fe<0&&(fe=re-s),se.push(J,F,re),Ce++,c.next()}}if(Ce){let J=new Uint16Array(Ce*4),F=se[se.length-2];for(let re=se.length-3,be=0;re>=0;re-=3)J[be++]=se[re],J[be++]=se[re+1]-F,J[be++]=se[re+2]-F,J[be++]=be;D.push(new ar(J,se[2]-F,n)),W.push(F-j)}}function v(j,H){return(D,W,se)=>{let Ce=0,fe=D.length-1,J,F;if(fe>=0&&(J=D[fe])instanceof mt){if(!fe&&J.type==j&&J.length==se)return J;(F=J.prop(Re.lookAhead))&&(Ce=W[fe]+J.length+F)}return k(j,D,W,se,Ce,H)}}function w(j,H,D,W,se,Ce,fe,J,F){let re=[],be=[];for(;j.length>W;)re.push(j.pop()),be.push(H.pop()+D-se);j.push(k(n.types[fe],re,be,Ce-se,J-Ce,F)),H.push(se-D)}function k(j,H,D,W,se,Ce,fe){if(Ce){let J=[Re.contextHash,Ce];fe=fe?[J].concat(fe):[J]}if(se>25){let J=[Re.lookAhead,se];fe=fe?[J].concat(fe):[J]}return new mt(j,H,D,W,fe)}function _(j,H){let D=c.fork(),W=0,se=0,Ce=0,fe=D.end-s,J={size:0,start:0,skip:0};e:for(let F=D.pos-j;D.pos>F;){let re=D.size;if(D.id==H&&re>=0){J.size=W,J.start=se,J.skip=Ce,Ce+=4,W+=4,D.next();continue}let be=D.pos-re;if(re<0||be<F||D.start<fe)break;let z=D.id>=a?4:0,Y=D.start;for(D.next();D.pos>be;){if(D.size<0)if(D.size==-3||D.size==-4)z+=4;else break e;else D.id>=a&&(z+=4);D.next()}se=Y,W+=re,Ce+=z}return(H<0||W==j)&&(J.size=W,J.start=se,J.skip=Ce),J.size>4?J:void 0}function O(j,H,D){let{id:W,start:se,end:Ce,size:fe}=c;if(c.next(),fe>=0&&W<a){let J=D;if(fe>4){let F=c.pos-(fe-4);for(;c.pos>F;)D=O(j,H,D)}H[--D]=J,H[--D]=Ce-j,H[--D]=se-j,H[--D]=W}else fe==-3?d=W:fe==-4&&(p=W);return D}let R=[],C=[];for(;c.pos>0;)m(i.start||0,i.bufferStart||0,R,C,-1,0);let N=(e=i.length)!==null&&e!==void 0?e:R.length?C[0]+R[0].length:0;return new mt(h[i.topID],R.reverse(),C.reverse(),N)}const g_=new WeakMap;function wf(i,e){if(!i.isAnonymous||e instanceof ar||e.type!=i)return 1;let t=g_.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=i||!(n instanceof mt)){t=1;break}t+=wf(i,n)}g_.set(e,t)}return t}function Hb(i,e,t,n,s,l,a,c,h){let d=0;for(let w=n;w<s;w++)d+=wf(i,e[w]);let p=Math.ceil(d*1.5/8),m=[],b=[];function v(w,k,_,O,R){for(let C=_;C<O;){let N=C,j=k[C],H=wf(i,w[C]);for(C++;C<O;C++){let D=wf(i,w[C]);if(H+D>=p)break;H+=D}if(C==N+1){if(H>p){let D=w[N];v(D.children,D.positions,0,D.children.length,k[N]+R);continue}m.push(w[N])}else{let D=k[C-1]+w[C-1].length-j;m.push(Hb(i,w,k,N,C,j,D,null,h))}b.push(j+R-l)}}return v(e,t,n,s,0),(c||h)(m,b,a)}class Wr{constructor(e,t,n,s,l=!1,a=!1){this.from=e,this.to=t,this.tree=n,this.offset=s,this.open=(l?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],n=!1){let s=[new Wr(0,e.length,e,0,!1,n)];for(let l of t)l.to>e.length&&s.push(l);return s}static applyChanges(e,t,n=128){if(!t.length)return e;let s=[],l=1,a=e.length?e[0]:null;for(let c=0,h=0,d=0;;c++){let p=c<t.length?t[c]:null,m=p?p.fromA:1e9;if(m-h>=n)for(;a&&a.from<m;){let b=a;if(h>=b.from||m<=b.to||d){let v=Math.max(b.from,h)-d,w=Math.min(b.to,m)-d;b=v>=w?null:new Wr(v,w,b.tree,b.offset+d,c>0,!!p)}if(b&&s.push(b),a.to>m)break;a=l<e.length?e[l++]:null}if(!p)break;h=p.toA,d=p.toA-p.toB}return s}}class UT{startParse(e,t,n){return typeof e=="string"&&(e=new G8(e)),n=n?n.length?n.map(s=>new Xm(s.from,s.to)):[new Xm(0,0)]:[new Xm(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let s=this.startParse(e,t,n);for(;;){let l=s.advance();if(l)return l}}}class G8{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new Re({perNode:!0});let K8=0;class Qi{constructor(e,t,n,s){this.name=e,this.set=t,this.base=n,this.modified=s,this.id=K8++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let n=typeof e=="string"?e:"?";if(e instanceof Qi&&(t=e),t?.base)throw new Error("Can not derive from a modified tag");let s=new Qi(n,[],null,[]);if(s.set.push(s),t)for(let l of t.set)s.set.push(l);return s}static defineModifier(e){let t=new Xf(e);return n=>n.modified.indexOf(t)>-1?n:Xf.get(n.base||n,n.modified.concat(t).sort((s,l)=>s.id-l.id))}}let W8=0;class Xf{constructor(e){this.name=e,this.instances=[],this.id=W8++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find(c=>c.base==e&&Y8(t,c.modified));if(n)return n;let s=[],l=new Qi(e.name,s,e,t);for(let c of t)c.instances.push(l);let a=F8(t);for(let c of e.set)if(!c.modified.length)for(let h of a)s.push(Xf.get(c,h));return l}}function Y8(i,e){return i.length==e.length&&i.every((t,n)=>t==e[n])}function F8(i){let e=[[]];for(let t=0;t<i.length;t++)for(let n=0,s=e.length;n<s;n++)e.push(e[n].concat(i[t]));return e.sort((t,n)=>n.length-t.length)}function X8(i){let e=Object.create(null);for(let t in i){let n=i[t];Array.isArray(n)||(n=[n]);for(let s of t.split(" "))if(s){let l=[],a=2,c=s;for(let m=0;;){if(c=="..."&&m>0&&m+3==s.length){a=1;break}let b=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(c);if(!b)throw new RangeError("Invalid path: "+s);if(l.push(b[0]=="*"?"":b[0][0]=='"'?JSON.parse(b[0]):b[0]),m+=b[0].length,m==s.length)break;let v=s[m++];if(m==s.length&&v=="!"){a=0;break}if(v!="/")throw new RangeError("Invalid path: "+s);c=s.slice(m)}let h=l.length-1,d=l[h];if(!d)throw new RangeError("Invalid path: "+s);let p=new Pc(n,a,h>0?l.slice(0,h):null);e[d]=p.sort(e[d])}}return jT.add(e)}const jT=new Re({combine(i,e){let t,n,s;for(;i||e;){if(!i||e&&i.depth>=e.depth?(s=e,e=e.next):(s=i,i=i.next),t&&t.mode==s.mode&&!s.context&&!t.context)continue;let l=new Pc(s.tags,s.mode,s.context);t?t.next=l:n=l,t=l}return n}});class Pc{constructor(e,t,n,s){this.tags=e,this.mode=t,this.context=n,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Pc.empty=new Pc([],2,null);function zT(i,e){let t=Object.create(null);for(let l of i)if(!Array.isArray(l.tag))t[l.tag.id]=l.class;else for(let a of l.tag)t[a.id]=l.class;let{scope:n,all:s=null}=e||{};return{style:l=>{let a=s;for(let c of l)for(let h of c.set){let d=t[h.id];if(d){a=a?a+" "+d:d;break}}return a},scope:n}}function Q8(i,e){let t=null;for(let n of i){let s=n.style(e);s&&(t=t?t+" "+s:s)}return t}function J8(i,e,t,n=0,s=i.length){let l=new Z8(n,Array.isArray(e)?e:[e],t);l.highlightRange(i.cursor(),n,s,"",l.highlighters),l.flush(s)}class Z8{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,s,l){let{type:a,from:c,to:h}=e;if(c>=n||h<=t)return;a.isTop&&(l=this.highlighters.filter(v=>!v.scope||v.scope(a)));let d=s,p=ez(e)||Pc.empty,m=Q8(l,p.tags);if(m&&(d&&(d+=" "),d+=m,p.mode==1&&(s+=(s?" ":"")+m)),this.startSpan(Math.max(t,c),d),p.opaque)return;let b=e.tree&&e.tree.prop(Re.mounted);if(b&&b.overlay){let v=e.node.enter(b.overlay[0].from+c,1),w=this.highlighters.filter(_=>!_.scope||_.scope(b.tree.type)),k=e.firstChild();for(let _=0,O=c;;_++){let R=_<b.overlay.length?b.overlay[_]:null,C=R?R.from+c:h,N=Math.max(t,O),j=Math.min(n,C);if(N<j&&k)for(;e.from<j&&(this.highlightRange(e,N,j,s,l),this.startSpan(Math.min(j,e.to),d),!(e.to>=C||!e.nextSibling())););if(!R||C>n)break;O=R.to+c,O>t&&(this.highlightRange(v.cursor(),Math.max(t,R.from+c),Math.min(n,O),"",w),this.startSpan(Math.min(n,O),d))}k&&e.parent()}else if(e.firstChild()){b&&(s="");do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,s,l),this.startSpan(Math.min(n,e.to),d)}while(e.nextSibling());e.parent()}}}function ez(i){let e=i.type.prop(jT);for(;e&&e.context&&!i.matchContext(e.context);)e=e.next;return e||null}const Q=Qi.define,Zh=Q(),Ys=Q(),m_=Q(Ys),y_=Q(Ys),Fs=Q(),ef=Q(Fs),Qm=Q(Fs),Mn=Q(),Nr=Q(Mn),Dn=Q(),Rn=Q(),My=Q(),Wa=Q(My),tf=Q(),Z={comment:Zh,lineComment:Q(Zh),blockComment:Q(Zh),docComment:Q(Zh),name:Ys,variableName:Q(Ys),typeName:m_,tagName:Q(m_),propertyName:y_,attributeName:Q(y_),className:Q(Ys),labelName:Q(Ys),namespace:Q(Ys),macroName:Q(Ys),literal:Fs,string:ef,docString:Q(ef),character:Q(ef),attributeValue:Q(ef),number:Qm,integer:Q(Qm),float:Q(Qm),bool:Q(Fs),regexp:Q(Fs),escape:Q(Fs),color:Q(Fs),url:Q(Fs),keyword:Dn,self:Q(Dn),null:Q(Dn),atom:Q(Dn),unit:Q(Dn),modifier:Q(Dn),operatorKeyword:Q(Dn),controlKeyword:Q(Dn),definitionKeyword:Q(Dn),moduleKeyword:Q(Dn),operator:Rn,derefOperator:Q(Rn),arithmeticOperator:Q(Rn),logicOperator:Q(Rn),bitwiseOperator:Q(Rn),compareOperator:Q(Rn),updateOperator:Q(Rn),definitionOperator:Q(Rn),typeOperator:Q(Rn),controlOperator:Q(Rn),punctuation:My,separator:Q(My),bracket:Wa,angleBracket:Q(Wa),squareBracket:Q(Wa),paren:Q(Wa),brace:Q(Wa),content:Mn,heading:Nr,heading1:Q(Nr),heading2:Q(Nr),heading3:Q(Nr),heading4:Q(Nr),heading5:Q(Nr),heading6:Q(Nr),contentSeparator:Q(Mn),list:Q(Mn),quote:Q(Mn),emphasis:Q(Mn),strong:Q(Mn),link:Q(Mn),monospace:Q(Mn),strikethrough:Q(Mn),inserted:Q(),deleted:Q(),changed:Q(),invalid:Q(),meta:tf,documentMeta:Q(tf),annotation:Q(tf),processingInstruction:Q(tf),definition:Qi.defineModifier("definition"),constant:Qi.defineModifier("constant"),function:Qi.defineModifier("function"),standard:Qi.defineModifier("standard"),local:Qi.defineModifier("local"),special:Qi.defineModifier("special")};for(let i in Z){let e=Z[i];e instanceof Qi&&(e.name=i)}zT([{tag:Z.link,class:"tok-link"},{tag:Z.heading,class:"tok-heading"},{tag:Z.emphasis,class:"tok-emphasis"},{tag:Z.strong,class:"tok-strong"},{tag:Z.keyword,class:"tok-keyword"},{tag:Z.atom,class:"tok-atom"},{tag:Z.bool,class:"tok-bool"},{tag:Z.url,class:"tok-url"},{tag:Z.labelName,class:"tok-labelName"},{tag:Z.inserted,class:"tok-inserted"},{tag:Z.deleted,class:"tok-deleted"},{tag:Z.literal,class:"tok-literal"},{tag:Z.string,class:"tok-string"},{tag:Z.number,class:"tok-number"},{tag:[Z.regexp,Z.escape,Z.special(Z.string)],class:"tok-string2"},{tag:Z.variableName,class:"tok-variableName"},{tag:Z.local(Z.variableName),class:"tok-variableName tok-local"},{tag:Z.definition(Z.variableName),class:"tok-variableName tok-definition"},{tag:Z.special(Z.variableName),class:"tok-variableName2"},{tag:Z.definition(Z.propertyName),class:"tok-propertyName tok-definition"},{tag:Z.typeName,class:"tok-typeName"},{tag:Z.namespace,class:"tok-namespace"},{tag:Z.className,class:"tok-className"},{tag:Z.macroName,class:"tok-macroName"},{tag:Z.propertyName,class:"tok-propertyName"},{tag:Z.operator,class:"tok-operator"},{tag:Z.comment,class:"tok-comment"},{tag:Z.meta,class:"tok-meta"},{tag:Z.invalid,class:"tok-invalid"},{tag:Z.punctuation,class:"tok-punctuation"}]);var Jm;const co=new Re;function tz(i){return te.define({combine:i?e=>e.concat(i):void 0})}const iz=new Re;class yn{constructor(e,t,n=[],s=""){this.data=e,this.name=s,je.prototype.hasOwnProperty("tree")||Object.defineProperty(je.prototype,"tree",{get(){return Kt(this)}}),this.parser=t,this.extension=[cr.of(this),je.languageData.of((l,a,c)=>{let h=b_(l,a,c),d=h.type.prop(co);if(!d)return[];let p=l.facet(d),m=h.type.prop(iz);if(m){let b=h.resolve(a-h.from,c);for(let v of m)if(v.test(b,l)){let w=l.facet(v.facet);return v.type=="replace"?w:w.concat(p)}}return p})].concat(n)}isActiveAt(e,t,n=-1){return b_(e,t,n).type.prop(co)==this.data}findRegions(e){let t=e.facet(cr);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],s=(l,a)=>{if(l.prop(co)==this.data){n.push({from:a,to:a+l.length});return}let c=l.prop(Re.mounted);if(c){if(c.tree.prop(co)==this.data){if(c.overlay)for(let h of c.overlay)n.push({from:h.from+a,to:h.to+a});else n.push({from:a,to:a+l.length});return}else if(c.overlay){let h=n.length;if(s(c.tree,c.overlay[0].from+a),n.length>h)return}}for(let h=0;h<l.children.length;h++){let d=l.children[h];d instanceof mt&&s(d,l.positions[h]+a)}};return s(Kt(e),0),n}get allowsNesting(){return!0}}yn.setState=_e.define();function b_(i,e,t){let n=i.facet(cr),s=Kt(i).topNode;if(!n||n.allowsNesting)for(let l=s;l;l=l.enter(e,t,ut.ExcludeBuffers|ut.EnterBracketed))l.type.isTop&&(s=l);return s}class Qf extends yn{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=tz(e.languageData);return new Qf(t,e.parser.configure({props:[co.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e,t){return new Qf(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Kt(i){let e=i.field(yn.state,!1);return e?e.tree:mt.empty}class nz{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}let Ya=null;class Jf{constructor(e,t,n=[],s,l,a,c,h){this.parser=e,this.state=t,this.fragments=n,this.tree=s,this.treeLen=l,this.viewport=a,this.skipped=c,this.scheduleOn=h,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new Jf(e,t,[],mt.empty,0,n,[],null)}startParse(){return this.parser.startParse(new nz(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=mt.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(Wr.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Wr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Ya;Ya=this;try{return e()}finally{Ya=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=v_(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:s,treeLen:l,viewport:a,skipped:c}=this;if(this.takeTree(),!e.empty){let h=[];if(e.iterChangedRanges((d,p,m,b)=>h.push({fromA:d,toA:p,fromB:m,toB:b})),n=Wr.applyChanges(n,h),s=mt.empty,l=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){c=[];for(let d of this.skipped){let p=e.mapPos(d.from,1),m=e.mapPos(d.to,-1);p<m&&c.push({from:p,to:m})}}}return new Jf(this.parser,t,n,s,l,a,c,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:s,to:l}=this.skipped[n];s<e.to&&l>e.from&&(this.fragments=v_(this.fragments,s,l),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends UT{createParse(t,n,s){let l=s[0].from,a=s[s.length-1].to;return{parsedPos:l,advance(){let h=Ya;if(h){for(let d of s)h.tempSkipped.push(d);e&&(h.scheduleOn=h.scheduleOn?Promise.all([h.scheduleOn,e]):e)}return this.parsedPos=a,new mt(bi.none,[],[],a-l)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Ya}}function v_(i,e,t){return Wr.applyChanges(i,[{fromA:e,toA:t,fromB:e,toB:t}])}class zo{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new zo(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=Jf.create(e.facet(cr).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new zo(n)}}yn.state=Wt.define({create:zo.init,update(i,e){for(let t of e.effects)if(t.is(yn.setState))return t.value;return e.startState.facet(cr)!=e.state.facet(cr)?zo.init(e.state):i.apply(e)}});let IT=i=>{let e=setTimeout(()=>i(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(IT=i=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(i,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const Zm=typeof navigator<"u"&&(!((Jm=navigator.scheduling)===null||Jm===void 0)&&Jm.isInputPending)?()=>navigator.scheduling.isInputPending():null,sz=lt.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(yn.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(yn.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=IT(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:s}}=this.view,l=n.field(yn.state);if(l.tree==l.context.tree&&l.context.isDone(s+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!Zm?Math.max(25,e.timeRemaining()-5):1e9),c=l.context.treeLen<s&&n.doc.length>s+1e3,h=l.context.work(()=>Zm&&Zm()||Date.now()>a,s+(c?0:1e5));this.chunkBudget-=Date.now()-t,(h||this.chunkBudget<=0)&&(l.context.takeTree(),this.view.dispatch({effects:yn.setState.of(new zo(l.context))})),this.chunkBudget>0&&!(h&&!c)&&this.scheduleWork(),this.checkAsyncSchedule(l.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>gi(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),cr=te.define({combine(i){return i.length?i[0]:null},enables:i=>[yn.state,sz,ee.contentAttributes.compute([i],e=>{let t=e.facet(i);return t&&t.name?{"data-language":t.name}:{}})]}),rz=te.define(),qb=te.define({combine:i=>{if(!i.length)return"  ";let e=i[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return e}});function Zf(i){let e=i.facet(qb);return e.charCodeAt(0)==9?i.tabSize*e.length:e.length}function Hc(i,e){let t="",n=i.tabSize,s=i.facet(qb)[0];if(s=="	"){for(;e>=n;)t+="	",e-=n;s=" "}for(let l=0;l<e;l++)t+=s;return t}function Vb(i,e){i instanceof je&&(i=new Ud(i));for(let n of i.state.facet(rz)){let s=n(i,e);if(s!==void 0)return s}let t=Kt(i.state);return t.length>=e?oz(i,t,e):null}class Ud{constructor(e,t={}){this.state=e,this.options=t,this.unit=Zf(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:l}=this.options;return s!=null&&s>=n.from&&s<=n.to?l&&s==e?{text:"",from:e}:(t<0?s<e:s<=e)?{text:n.text.slice(s-n.from),from:s}:{text:n.text.slice(0,s-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:s}=this.lineAt(e,t);return n.slice(e-s,Math.min(n.length,e+100-s))}column(e,t=1){let{text:n,from:s}=this.lineAt(e,t),l=this.countColumn(n,e-s),a=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return a>-1&&(l+=a-this.countColumn(n,n.search(/\S|$/))),l}countColumn(e,t=e.length){return Ko(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:s}=this.lineAt(e,t),l=this.options.overrideIndentation;if(l){let a=l(s);if(a>-1)return a}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const lz=new Re;function oz(i,e,t){let n=e.resolveStack(t),s=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(s!=n.node){let l=[];for(let a=s;a&&!(a.from<n.node.from||a.to>n.node.to||a.from==n.node.from&&a.type==n.node.type);a=a.parent)l.push(a);for(let a=l.length-1;a>=0;a--)n={node:l[a],next:n}}return PT(n,i,t)}function PT(i,e,t){for(let n=i;n;n=n.next){let s=cz(n.node);if(s)return s($b.create(e,t,n))}return 0}function az(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function cz(i){let e=i.type.prop(lz);if(e)return e;let t=i.firstChild,n;if(t&&(n=t.type.prop(Re.closedBy))){let s=i.lastChild,l=s&&n.indexOf(s.name)>-1;return a=>dz(a,!0,1,void 0,l&&!az(a)?s.from:void 0)}return i.parent==null?uz:null}function uz(){return 0}class $b extends Ud{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e,t,n){return new $b(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(hz(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return PT(this.context.next,this.base,this.pos)}}function hz(i,e){for(let t=e;t;t=t.parent)if(i==t)return!0;return!1}function fz(i){let e=i.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let s=i.options.simulateBreak,l=i.state.doc.lineAt(t.from),a=s==null||s<=l.from?l.to:Math.min(l.to,s);for(let c=t.to;;){let h=e.childAfter(c);if(!h||h==n)return null;if(!h.type.isSkipped){if(h.from>=a)return null;let d=/^ */.exec(l.text.slice(t.to-l.from))[0].length;return{from:t.from,to:t.to+d}}c=h.to}}function dz(i,e,t,n,s){let l=i.textAfter,a=l.match(/^\s*/)[0].length,c=n&&l.slice(a,a+n.length)==n||s==i.pos+a,h=fz(i);return h?c?i.column(h.from):i.column(h.to):i.baseIndent+(c?0:i.unit*t)}const pz=200;function gz(){return je.transactionFilter.of(i=>{if(!i.docChanged||!i.isUserEvent("input.type")&&!i.isUserEvent("input.complete"))return i;let e=i.startState.languageDataAt("indentOnInput",i.startState.selection.main.head);if(!e.length)return i;let t=i.newDoc,{head:n}=i.newSelection.main,s=t.lineAt(n);if(n>s.from+pz)return i;let l=t.sliceString(s.from,n);if(!e.some(d=>d.test(l)))return i;let{state:a}=i,c=-1,h=[];for(let{head:d}of a.selection.ranges){let p=a.doc.lineAt(d);if(p.from==c)continue;c=p.from;let m=Vb(a,p.from);if(m==null)continue;let b=/^\s*/.exec(p.text)[0],v=Hc(a,m);b!=v&&h.push({from:p.from,to:p.from+b.length,insert:v})}return h.length?[i,{changes:h,sequential:!0}]:i})}const mz=te.define(),yz=new Re;function bz(i,e,t){let n=Kt(i);if(n.length<t)return null;let s=n.resolveStack(t,1),l=null;for(let a=s;a;a=a.next){let c=a.node;if(c.to<=t||c.from>t)continue;if(l&&c.from<e)break;let h=c.type.prop(yz);if(h&&(c.to<n.length-50||n.length==i.doc.length||!vz(c))){let d=h(c,i);d&&d.from<=t&&d.from>=e&&d.to>t&&(l=d)}}return l}function vz(i){let e=i.lastChild;return e&&e.to==i.to&&e.type.isError}function ed(i,e,t){for(let n of i.facet(mz)){let s=n(i,e,t);if(s)return s}return bz(i,e,t)}function HT(i,e){let t=e.mapPos(i.from,1),n=e.mapPos(i.to,-1);return t>=n?void 0:{from:t,to:n}}const jd=_e.define({map:HT}),ru=_e.define({map:HT});function qT(i){let e=[];for(let{head:t}of i.state.selection.ranges)e.some(n=>n.from<=t&&n.to>=t)||e.push(i.lineBlockAt(t));return e}const il=Wt.define({create(){return ue.none},update(i,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((t,n)=>i=w_(i,t,n)),i=i.map(e.changes);for(let t of e.effects)if(t.is(jd)&&!wz(i,t.value.from,t.value.to)){let{preparePlaceholder:n}=e.state.facet(GT),s=n?ue.replace({widget:new Cz(n(e.state,t.value))}):S_;i=i.update({add:[s.range(t.value.from,t.value.to)]})}else t.is(ru)&&(i=i.update({filter:(n,s)=>t.value.from!=n||t.value.to!=s,filterFrom:t.value.from,filterTo:t.value.to}));return e.selection&&(i=w_(i,e.selection.main.head)),i},provide:i=>ee.decorations.from(i),toJSON(i,e){let t=[];return i.between(0,e.doc.length,(n,s)=>{t.push(n,s)}),t},fromJSON(i){if(!Array.isArray(i)||i.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<i.length;){let n=i[t++],s=i[t++];if(typeof n!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");e.push(S_.range(n,s))}return ue.set(e,!0)}});function w_(i,e,t=e){let n=!1;return i.between(e,t,(s,l)=>{s<t&&l>e&&(n=!0)}),n?i.update({filterFrom:e,filterTo:t,filter:(s,l)=>s>=t||l<=e}):i}function td(i,e,t){var n;let s=null;return(n=i.field(il,!1))===null||n===void 0||n.between(e,t,(l,a)=>{(!s||s.from>l)&&(s={from:l,to:a})}),s}function wz(i,e,t){let n=!1;return i.between(e,e,(s,l)=>{s==e&&l==t&&(n=!0)}),n}function VT(i,e){return i.field(il,!1)?e:e.concat(_e.appendConfig.of(KT()))}const Sz=i=>{for(let e of qT(i)){let t=ed(i.state,e.from,e.to);if(t)return i.dispatch({effects:VT(i.state,[jd.of(t),$T(i,t)])}),!0}return!1},kz=i=>{if(!i.state.field(il,!1))return!1;let e=[];for(let t of qT(i)){let n=td(i.state,t.from,t.to);n&&e.push(ru.of(n),$T(i,n,!1))}return e.length&&i.dispatch({effects:e}),e.length>0};function $T(i,e,t=!0){let n=i.state.doc.lineAt(e.from).number,s=i.state.doc.lineAt(e.to).number;return ee.announce.of(`${i.state.phrase(t?"Folded lines":"Unfolded lines")} ${n} ${i.state.phrase("to")} ${s}.`)}const xz=i=>{let{state:e}=i,t=[];for(let n=0;n<e.doc.length;){let s=i.lineBlockAt(n),l=ed(e,s.from,s.to);l&&t.push(jd.of(l)),n=(l?i.lineBlockAt(l.to):s).to+1}return t.length&&i.dispatch({effects:VT(i.state,t)}),!!t.length},_z=i=>{let e=i.state.field(il,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,i.state.doc.length,(n,s)=>{t.push(ru.of({from:n,to:s}))}),i.dispatch({effects:t}),!0},Oz=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Sz},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:kz},{key:"Ctrl-Alt-[",run:xz},{key:"Ctrl-Alt-]",run:_z}],Az={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},GT=te.define({combine(i){return Gn(i,Az)}});function KT(i){return[il,Dz]}function WT(i,e){let{state:t}=i,n=t.facet(GT),s=a=>{let c=i.lineBlockAt(i.posAtDOM(a.target)),h=td(i.state,c.from,c.to);h&&i.dispatch({effects:ru.of(h)}),a.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(i,s,e);let l=document.createElement("span");return l.textContent=n.placeholderText,l.setAttribute("aria-label",t.phrase("folded code")),l.title=t.phrase("unfold"),l.className="cm-foldPlaceholder",l.onclick=s,l}const S_=ue.replace({widget:new class extends Kn{toDOM(i){return WT(i,null)}}});class Cz extends Kn{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return WT(e,this.value)}}const Tz={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class e0 extends bs{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function Ez(i={}){let e={...Tz,...i},t=new e0(e,!0),n=new e0(e,!1),s=lt.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(cr)!=a.state.facet(cr)||a.startState.field(il,!1)!=a.state.field(il,!1)||Kt(a.startState)!=Kt(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let c=new qn;for(let h of a.viewportLineBlocks){let d=td(a.state,h.from,h.to)?n:ed(a.state,h.from,h.to)?t:null;d&&c.add(h.from,h.from,d)}return c.finish()}}),{domEventHandlers:l}=e;return[s,T8({class:"cm-foldGutter",markers(a){var c;return((c=a.plugin(s))===null||c===void 0?void 0:c.markers)||De.empty},initialSpacer(){return new e0(e,!1)},domEventHandlers:{...l,click:(a,c,h)=>{if(l.click&&l.click(a,c,h))return!0;let d=td(a.state,c.from,c.to);if(d)return a.dispatch({effects:ru.of(d)}),!0;let p=ed(a.state,c.from,c.to);return p?(a.dispatch({effects:jd.of(p)}),!0):!1}}}),KT()]}const Dz=ee.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class zd{constructor(e,t){this.specs=e;let n;function s(c){let h=rr.newName();return(n||(n=Object.create(null)))["."+h]=c,h}const l=typeof t.all=="string"?t.all:t.all?s(t.all):void 0,a=t.scope;this.scope=a instanceof yn?c=>c.prop(co)==a.data:a?c=>c==a:void 0,this.style=zT(e.map(c=>({tag:c.tag,class:c.class||s(Object.assign({},c,{tag:null}))})),{all:l}).style,this.module=n?new rr(n):null,this.themeType=t.themeType}static define(e,t){return new zd(e,t||{})}}const Ny=te.define(),YT=te.define({combine(i){return i.length?[i[0]]:null}});function t0(i){let e=i.facet(Ny);return e.length?e:i.facet(YT)}function Rz(i,e){let t=[Nz],n;return i instanceof zd&&(i.module&&t.push(ee.styleModule.of(i.module)),n=i.themeType),e?.fallback?t.push(YT.of(i)):n?t.push(Ny.computeN([ee.darkTheme],s=>s.facet(ee.darkTheme)==(n=="dark")?[i]:[])):t.push(Ny.of(i)),t}class Mz{constructor(e){this.markCache=Object.create(null),this.tree=Kt(e.state),this.decorations=this.buildDeco(e,t0(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Kt(e.state),n=t0(e.state),s=n!=t0(e.startState),{viewport:l}=e.view,a=e.changes.mapPos(this.decoratedTo,1);t.length<l.to&&!s&&t.type==this.tree.type&&a>=l.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(t!=this.tree||e.viewportChanged||s)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=l.to)}buildDeco(e,t){if(!t||!this.tree.length)return ue.none;let n=new qn;for(let{from:s,to:l}of e.visibleRanges)J8(this.tree,t,(a,c,h)=>{n.add(a,c,this.markCache[h]||(this.markCache[h]=ue.mark({class:h})))},s,l);return n.finish()}}const Nz=ll.high(lt.fromClass(Mz,{decorations:i=>i.decorations})),Lz=zd.define([{tag:Z.meta,color:"#404740"},{tag:Z.link,textDecoration:"underline"},{tag:Z.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Z.emphasis,fontStyle:"italic"},{tag:Z.strong,fontWeight:"bold"},{tag:Z.strikethrough,textDecoration:"line-through"},{tag:Z.keyword,color:"#708"},{tag:[Z.atom,Z.bool,Z.url,Z.contentSeparator,Z.labelName],color:"#219"},{tag:[Z.literal,Z.inserted],color:"#164"},{tag:[Z.string,Z.deleted],color:"#a11"},{tag:[Z.regexp,Z.escape,Z.special(Z.string)],color:"#e40"},{tag:Z.definition(Z.variableName),color:"#00f"},{tag:Z.local(Z.variableName),color:"#30a"},{tag:[Z.typeName,Z.namespace],color:"#085"},{tag:Z.className,color:"#167"},{tag:[Z.special(Z.variableName),Z.macroName],color:"#256"},{tag:Z.definition(Z.propertyName),color:"#00c"},{tag:Z.comment,color:"#940"},{tag:Z.invalid,color:"#f00"}]),Bz=ee.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),FT=1e4,XT="()[]{}",QT=te.define({combine(i){return Gn(i,{afterCursor:!0,brackets:XT,maxScanDistance:FT,renderMatch:zz})}}),Uz=ue.mark({class:"cm-matchingBracket"}),jz=ue.mark({class:"cm-nonmatchingBracket"});function zz(i){let e=[],t=i.matched?Uz:jz;return e.push(t.range(i.start.from,i.start.to)),i.end&&e.push(t.range(i.end.from,i.end.to)),e}const Iz=Wt.define({create(){return ue.none},update(i,e){if(!e.docChanged&&!e.selection)return i;let t=[],n=e.state.facet(QT);for(let s of e.state.selection.ranges){if(!s.empty)continue;let l=Un(e.state,s.head,-1,n)||s.head>0&&Un(e.state,s.head-1,1,n)||n.afterCursor&&(Un(e.state,s.head,1,n)||s.head<e.state.doc.length&&Un(e.state,s.head+1,-1,n));l&&(t=t.concat(n.renderMatch(l,e.state)))}return ue.set(t,!0)},provide:i=>ee.decorations.from(i)}),Pz=[Iz,Bz];function Hz(i={}){return[QT.of(i),Pz]}const qz=new Re;function Ly(i,e,t){let n=i.prop(e<0?Re.openedBy:Re.closedBy);if(n)return n;if(i.name.length==1){let s=t.indexOf(i.name);if(s>-1&&s%2==(e<0?1:0))return[t[s+e]]}return null}function By(i){let e=i.type.prop(qz);return e?e(i.node):i}function Un(i,e,t,n={}){let s=n.maxScanDistance||FT,l=n.brackets||XT,a=Kt(i),c=a.resolveInner(e,t);for(let h=c;h;h=h.parent){let d=Ly(h.type,t,l);if(d&&h.from<h.to){let p=By(h);if(p&&(t>0?e>=p.from&&e<p.to:e>p.from&&e<=p.to))return Vz(i,e,t,h,p,d,l)}}return $z(i,e,t,a,c.type,s,l)}function Vz(i,e,t,n,s,l,a){let c=n.parent,h={from:s.from,to:s.to},d=0,p=c?.cursor();if(p&&(t<0?p.childBefore(n.from):p.childAfter(n.to)))do if(t<0?p.to<=n.from:p.from>=n.to){if(d==0&&l.indexOf(p.type.name)>-1&&p.from<p.to){let m=By(p);return{start:h,end:m?{from:m.from,to:m.to}:void 0,matched:!0}}else if(Ly(p.type,t,a))d++;else if(Ly(p.type,-t,a)){if(d==0){let m=By(p);return{start:h,end:m&&m.from<m.to?{from:m.from,to:m.to}:void 0,matched:!1}}d--}}while(t<0?p.prevSibling():p.nextSibling());return{start:h,matched:!1}}function $z(i,e,t,n,s,l,a){let c=t<0?i.sliceDoc(e-1,e):i.sliceDoc(e,e+1),h=a.indexOf(c);if(h<0||h%2==0!=t>0)return null;let d={from:t<0?e-1:e,to:t>0?e+1:e},p=i.doc.iterRange(e,t>0?i.doc.length:0),m=0;for(let b=0;!p.next().done&&b<=l;){let v=p.value;t<0&&(b+=v.length);let w=e+b*t;for(let k=t>0?0:v.length-1,_=t>0?v.length:-1;k!=_;k+=t){let O=a.indexOf(v[k]);if(!(O<0||n.resolveInner(w+k,1).type!=s))if(O%2==0==t>0)m++;else{if(m==1)return{start:d,end:{from:w+k,to:w+k+1},matched:O>>1==h>>1};m--}}t>0&&(b+=v.length)}return p.done?{start:d,matched:!1}:null}const Gz=Object.create(null),k_=[bi.none],x_=[],__=Object.create(null),Kz=Object.create(null);for(let[i,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Kz[i]=Wz(Gz,e);function i0(i,e){x_.indexOf(i)>-1||(x_.push(i),console.warn(e))}function Wz(i,e){let t=[];for(let c of e.split(" ")){let h=[];for(let d of c.split(".")){let p=i[d]||Z[d];p?typeof p=="function"?h.length?h=h.map(p):i0(d,`Modifier ${d} used at start of tag`):h.length?i0(d,`Tag ${d} used as modifier`):h=Array.isArray(p)?p:[p]:i0(d,`Unknown highlighting tag ${d}`)}for(let d of h)t.push(d)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),s=n+" "+t.map(c=>c.id),l=__[s];if(l)return l.id;let a=__[s]=bi.define({id:k_.length,name:n,props:[X8({[n]:t})]});return k_.push(a),a.id}Ze.RTL,Ze.LTR;const Yz=i=>{let{state:e}=i,t=e.doc.lineAt(e.selection.main.from),n=Kb(i.state,t.from);return n.line?Fz(i):n.block?Qz(i):!1};function Gb(i,e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let s=i(e,t);return s?(n(t.update(s)),!0):!1}}const Fz=Gb(e5,0),Xz=Gb(JT,0),Qz=Gb((i,e)=>JT(i,e,Zz(e)),0);function Kb(i,e){let t=i.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const Fa=50;function Jz(i,{open:e,close:t},n,s){let l=i.sliceDoc(n-Fa,n),a=i.sliceDoc(s,s+Fa),c=/\s*$/.exec(l)[0].length,h=/^\s*/.exec(a)[0].length,d=l.length-c;if(l.slice(d-e.length,d)==e&&a.slice(h,h+t.length)==t)return{open:{pos:n-c,margin:c&&1},close:{pos:s+h,margin:h&&1}};let p,m;s-n<=2*Fa?p=m=i.sliceDoc(n,s):(p=i.sliceDoc(n,n+Fa),m=i.sliceDoc(s-Fa,s));let b=/^\s*/.exec(p)[0].length,v=/\s*$/.exec(m)[0].length,w=m.length-v-t.length;return p.slice(b,b+e.length)==e&&m.slice(w,w+t.length)==t?{open:{pos:n+b+e.length,margin:/\s/.test(p.charAt(b+e.length))?1:0},close:{pos:s-v-t.length,margin:/\s/.test(m.charAt(w-1))?1:0}}:null}function Zz(i){let e=[];for(let t of i.selection.ranges){let n=i.doc.lineAt(t.from),s=t.to<=n.to?n:i.doc.lineAt(t.to);s.from>n.from&&s.from==t.to&&(s=t.to==n.to+1?n:i.doc.lineAt(t.to-1));let l=e.length-1;l>=0&&e[l].to>n.from?e[l].to=s.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:s.to})}return e}function JT(i,e,t=e.selection.ranges){let n=t.map(l=>Kb(e,l.from).block);if(!n.every(l=>l))return null;let s=t.map((l,a)=>Jz(e,n[a],l.from,l.to));if(i!=2&&!s.every(l=>l))return{changes:e.changes(t.map((l,a)=>s[a]?[]:[{from:l.from,insert:n[a].open+" "},{from:l.to,insert:" "+n[a].close}]))};if(i!=1&&s.some(l=>l)){let l=[];for(let a=0,c;a<s.length;a++)if(c=s[a]){let h=n[a],{open:d,close:p}=c;l.push({from:d.pos-h.open.length,to:d.pos+d.margin},{from:p.pos-p.margin,to:p.pos+h.close.length})}return{changes:l}}return null}function e5(i,e,t=e.selection.ranges){let n=[],s=-1;for(let{from:l,to:a}of t){let c=n.length,h=1e9,d=Kb(e,l).line;if(d){for(let p=l;p<=a;){let m=e.doc.lineAt(p);if(m.from>s&&(l==a||a>m.from)){s=m.from;let b=/^\s*/.exec(m.text)[0].length,v=b==m.length,w=m.text.slice(b,b+d.length)==d?b:-1;b<m.text.length&&b<h&&(h=b),n.push({line:m,comment:w,token:d,indent:b,empty:v,single:!1})}p=m.to+1}if(h<1e9)for(let p=c;p<n.length;p++)n[p].indent<n[p].line.text.length&&(n[p].indent=h);n.length==c+1&&(n[c].single=!0)}}if(i!=2&&n.some(l=>l.comment<0&&(!l.empty||l.single))){let l=[];for(let{line:c,token:h,indent:d,empty:p,single:m}of n)(m||!p)&&l.push({from:c.from+d,insert:h+" "});let a=e.changes(l);return{changes:a,selection:e.selection.map(a,1)}}else if(i!=1&&n.some(l=>l.comment>=0)){let l=[];for(let{line:a,comment:c,token:h}of n)if(c>=0){let d=a.from+c,p=d+h.length;a.text[p-a.from]==" "&&p++,l.push({from:d,to:p})}return{changes:l}}return null}const Uy=Sn.define(),t5=Sn.define(),i5=te.define(),ZT=te.define({combine(i){return Gn(i,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,s)=>e(n,s)||t(n,s)})}}),eE=Wt.define({create(){return jn.empty},update(i,e){let t=e.state.facet(ZT),n=e.annotation(Uy);if(n){let h=mi.fromTransaction(e,n.selection),d=n.side,p=d==0?i.undone:i.done;return h?p=id(p,p.length,t.minDepth,h):p=nE(p,e.startState.selection),new jn(d==0?n.rest:p,d==0?p:n.rest)}let s=e.annotation(t5);if((s=="full"||s=="before")&&(i=i.isolate()),e.annotation(Tt.addToHistory)===!1)return e.changes.empty?i:i.addMapping(e.changes.desc);let l=mi.fromTransaction(e),a=e.annotation(Tt.time),c=e.annotation(Tt.userEvent);return l?i=i.addChanges(l,a,c,t,e):e.selection&&(i=i.addSelection(e.startState.selection,a,c,t.newGroupDelay)),(s=="full"||s=="after")&&(i=i.isolate()),i},toJSON(i){return{done:i.done.map(e=>e.toJSON()),undone:i.undone.map(e=>e.toJSON())}},fromJSON(i){return new jn(i.done.map(mi.fromJSON),i.undone.map(mi.fromJSON))}});function n5(i={}){return[eE,ZT.of(i),ee.domEventHandlers({beforeinput(e,t){let n=e.inputType=="historyUndo"?tE:e.inputType=="historyRedo"?jy:null;return n?(e.preventDefault(),n(t)):!1}})]}function Id(i,e){return function({state:t,dispatch:n}){if(!e&&t.readOnly)return!1;let s=t.field(eE,!1);if(!s)return!1;let l=s.pop(i,t,e);return l?(n(l),!0):!1}}const tE=Id(0,!1),jy=Id(1,!1),s5=Id(0,!0),r5=Id(1,!0);class mi{constructor(e,t,n,s,l){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=s,this.selectionsAfter=l}setSelAfter(e){return new mi(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(e){return new mi(e.changes&&At.fromJSON(e.changes),[],e.mapped&&zn.fromJSON(e.mapped),e.startSelection&&$.fromJSON(e.startSelection),e.selectionsAfter.map($.fromJSON))}static fromTransaction(e,t){let n=tn;for(let s of e.startState.facet(i5)){let l=s(e);l.length&&(n=n.concat(l))}return!n.length&&e.changes.empty?null:new mi(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,tn)}static selection(e){return new mi(void 0,tn,void 0,void 0,e)}}function id(i,e,t,n){let s=e+1>t+20?e-t-1:0,l=i.slice(s,e);return l.push(n),l}function l5(i,e){let t=[],n=!1;return i.iterChangedRanges((s,l)=>t.push(s,l)),e.iterChangedRanges((s,l,a,c)=>{for(let h=0;h<t.length;){let d=t[h++],p=t[h++];c>=d&&a<=p&&(n=!0)}}),n}function o5(i,e){return i.ranges.length==e.ranges.length&&i.ranges.filter((t,n)=>t.empty!=e.ranges[n].empty).length===0}function iE(i,e){return i.length?e.length?i.concat(e):i:e}const tn=[],a5=200;function nE(i,e){if(i.length){let t=i[i.length-1],n=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-a5));return n.length&&n[n.length-1].eq(e)?i:(n.push(e),id(i,i.length-1,1e9,t.setSelAfter(n)))}else return[mi.selection([e])]}function c5(i){let e=i[i.length-1],t=i.slice();return t[i.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function n0(i,e){if(!i.length)return i;let t=i.length,n=tn;for(;t;){let s=u5(i[t-1],e,n);if(s.changes&&!s.changes.empty||s.effects.length){let l=i.slice(0,t);return l[t-1]=s,l}else e=s.mapped,t--,n=s.selectionsAfter}return n.length?[mi.selection(n)]:tn}function u5(i,e,t){let n=iE(i.selectionsAfter.length?i.selectionsAfter.map(c=>c.map(e)):tn,t);if(!i.changes)return mi.selection(n);let s=i.changes.map(e),l=e.mapDesc(i.changes,!0),a=i.mapped?i.mapped.composeDesc(l):l;return new mi(s,_e.mapEffects(i.effects,e),a,i.startSelection.map(l),n)}const h5=/^(input\.type|delete)($|\.)/;class jn{constructor(e,t,n=0,s=void 0){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=s}isolate(){return this.prevTime?new jn(this.done,this.undone):this}addChanges(e,t,n,s,l){let a=this.done,c=a[a.length-1];return c&&c.changes&&!c.changes.empty&&e.changes&&(!n||h5.test(n))&&(!c.selectionsAfter.length&&t-this.prevTime<s.newGroupDelay&&s.joinToEvent(l,l5(c.changes,e.changes))||n=="input.type.compose")?a=id(a,a.length-1,s.minDepth,new mi(e.changes.compose(c.changes),iE(_e.mapEffects(e.effects,c.changes),c.effects),c.mapped,c.startSelection,tn)):a=id(a,a.length,s.minDepth,e),new jn(a,tn,t,n)}addSelection(e,t,n,s){let l=this.done.length?this.done[this.done.length-1].selectionsAfter:tn;return l.length>0&&t-this.prevTime<s&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&o5(l[l.length-1],e)?this:new jn(nE(this.done,e),this.undone,t,n)}addMapping(e){return new jn(n0(this.done,e),n0(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let s=e==0?this.done:this.undone;if(s.length==0)return null;let l=s[s.length-1],a=l.selectionsAfter[0]||t.selection;if(n&&l.selectionsAfter.length)return t.update({selection:l.selectionsAfter[l.selectionsAfter.length-1],annotations:Uy.of({side:e,rest:c5(s),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(l.changes){let c=s.length==1?tn:s.slice(0,s.length-1);return l.mapped&&(c=n0(c,l.mapped)),t.update({changes:l.changes,selection:l.startSelection,effects:l.effects,annotations:Uy.of({side:e,rest:c,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}jn.empty=new jn(tn,tn);const f5=[{key:"Mod-z",run:tE,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:jy,preventDefault:!0},{linux:"Ctrl-Shift-z",run:jy,preventDefault:!0},{key:"Mod-u",run:s5,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:r5,preventDefault:!0}];function Wo(i,e){return $.create(i.ranges.map(e),i.mainIndex)}function kn(i,e){return i.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function xn({state:i,dispatch:e},t){let n=Wo(i.selection,t);return n.eq(i.selection,!0)?!1:(e(kn(i,n)),!0)}function Pd(i,e){return $.cursor(e?i.to:i.from)}function sE(i,e){return xn(i,t=>t.empty?i.moveByChar(t,e):Pd(t,e))}function Qt(i){return i.textDirectionAt(i.state.selection.main.head)==Ze.LTR}const rE=i=>sE(i,!Qt(i)),lE=i=>sE(i,Qt(i));function oE(i,e){return xn(i,t=>t.empty?i.moveByGroup(t,e):Pd(t,e))}const d5=i=>oE(i,!Qt(i)),p5=i=>oE(i,Qt(i));function g5(i,e,t){if(e.type.prop(t))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(i.sliceDoc(e.from,e.to)))||e.firstChild}function Hd(i,e,t){let n=Kt(i).resolveInner(e.head),s=t?Re.closedBy:Re.openedBy;for(let h=e.head;;){let d=t?n.childAfter(h):n.childBefore(h);if(!d)break;g5(i,d,s)?n=d:h=t?d.to:d.from}let l=n.type.prop(s),a,c;return l&&(a=t?Un(i,n.from,1):Un(i,n.to,-1))&&a.matched?c=t?a.end.to:a.end.from:c=t?n.to:n.from,$.cursor(c,t?-1:1)}const m5=i=>xn(i,e=>Hd(i.state,e,!Qt(i))),y5=i=>xn(i,e=>Hd(i.state,e,Qt(i)));function aE(i,e){return xn(i,t=>{if(!t.empty)return Pd(t,e);let n=i.moveVertically(t,e);return n.head!=t.head?n:i.moveToLineBoundary(t,e)})}const cE=i=>aE(i,!1),uE=i=>aE(i,!0);function hE(i){let e=i.scrollDOM.clientHeight<i.scrollDOM.scrollHeight-2,t=0,n=0,s;if(e){for(let l of i.state.facet(ee.scrollMargins)){let a=l(i);a?.top&&(t=Math.max(a?.top,t)),a?.bottom&&(n=Math.max(a?.bottom,n))}s=i.scrollDOM.clientHeight-t-n}else s=(i.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:n,selfScroll:e,height:Math.max(i.defaultLineHeight,s-5)}}function fE(i,e){let t=hE(i),{state:n}=i,s=Wo(n.selection,a=>a.empty?i.moveVertically(a,e,t.height):Pd(a,e));if(s.eq(n.selection))return!1;let l;if(t.selfScroll){let a=i.coordsAtPos(n.selection.main.head),c=i.scrollDOM.getBoundingClientRect(),h=c.top+t.marginTop,d=c.bottom-t.marginBottom;a&&a.top>h&&a.bottom<d&&(l=ee.scrollIntoView(s.main.head,{y:"start",yMargin:a.top-h}))}return i.dispatch(kn(n,s),{effects:l}),!0}const O_=i=>fE(i,!1),zy=i=>fE(i,!0);function hr(i,e,t){let n=i.lineBlockAt(e.head),s=i.moveToLineBoundary(e,t);if(s.head==e.head&&s.head!=(t?n.to:n.from)&&(s=i.moveToLineBoundary(e,t,!1)),!t&&s.head==n.from&&n.length){let l=/^\s*/.exec(i.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;l&&e.head!=n.from+l&&(s=$.cursor(n.from+l))}return s}const b5=i=>xn(i,e=>hr(i,e,!0)),v5=i=>xn(i,e=>hr(i,e,!1)),w5=i=>xn(i,e=>hr(i,e,!Qt(i))),S5=i=>xn(i,e=>hr(i,e,Qt(i))),k5=i=>xn(i,e=>$.cursor(i.lineBlockAt(e.head).from,1)),x5=i=>xn(i,e=>$.cursor(i.lineBlockAt(e.head).to,-1));function _5(i,e,t){let n=!1,s=Wo(i.selection,l=>{let a=Un(i,l.head,-1)||Un(i,l.head,1)||l.head>0&&Un(i,l.head-1,1)||l.head<i.doc.length&&Un(i,l.head+1,-1);if(!a||!a.end)return l;n=!0;let c=a.start.from==l.head?a.end.to:a.end.from;return $.cursor(c)});return n?(e(kn(i,s)),!0):!1}const O5=({state:i,dispatch:e})=>_5(i,e);function ln(i,e){let t=Wo(i.state.selection,n=>{let s=e(n);return $.range(n.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return t.eq(i.state.selection)?!1:(i.dispatch(kn(i.state,t)),!0)}function dE(i,e){return ln(i,t=>i.moveByChar(t,e))}const pE=i=>dE(i,!Qt(i)),gE=i=>dE(i,Qt(i));function mE(i,e){return ln(i,t=>i.moveByGroup(t,e))}const A5=i=>mE(i,!Qt(i)),C5=i=>mE(i,Qt(i)),T5=i=>ln(i,e=>Hd(i.state,e,!Qt(i))),E5=i=>ln(i,e=>Hd(i.state,e,Qt(i)));function yE(i,e){return ln(i,t=>i.moveVertically(t,e))}const bE=i=>yE(i,!1),vE=i=>yE(i,!0);function wE(i,e){return ln(i,t=>i.moveVertically(t,e,hE(i).height))}const A_=i=>wE(i,!1),C_=i=>wE(i,!0),D5=i=>ln(i,e=>hr(i,e,!0)),R5=i=>ln(i,e=>hr(i,e,!1)),M5=i=>ln(i,e=>hr(i,e,!Qt(i))),N5=i=>ln(i,e=>hr(i,e,Qt(i))),L5=i=>ln(i,e=>$.cursor(i.lineBlockAt(e.head).from)),B5=i=>ln(i,e=>$.cursor(i.lineBlockAt(e.head).to)),T_=({state:i,dispatch:e})=>(e(kn(i,{anchor:0})),!0),E_=({state:i,dispatch:e})=>(e(kn(i,{anchor:i.doc.length})),!0),D_=({state:i,dispatch:e})=>(e(kn(i,{anchor:i.selection.main.anchor,head:0})),!0),R_=({state:i,dispatch:e})=>(e(kn(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0),U5=({state:i,dispatch:e})=>(e(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0),j5=({state:i,dispatch:e})=>{let t=qd(i).map(({from:n,to:s})=>$.range(n,Math.min(s+1,i.doc.length)));return e(i.update({selection:$.create(t),userEvent:"select"})),!0},z5=({state:i,dispatch:e})=>{let t=Wo(i.selection,n=>{let s=Kt(i),l=s.resolveStack(n.from,1);if(n.empty){let a=s.resolveStack(n.from,-1);a.node.from>=l.node.from&&a.node.to<=l.node.to&&(l=a)}for(let a=l;a;a=a.next){let{node:c}=a;if((c.from<n.from&&c.to>=n.to||c.to>n.to&&c.from<=n.from)&&a.next)return $.range(c.to,c.from)}return n});return t.eq(i.selection)?!1:(e(kn(i,t)),!0)};function SE(i,e){let{state:t}=i,n=t.selection,s=t.selection.ranges.slice();for(let l of t.selection.ranges){let a=t.doc.lineAt(l.head);if(e?a.to<i.state.doc.length:a.from>0)for(let c=l;;){let h=i.moveVertically(c,e);if(h.head<a.from||h.head>a.to){s.some(d=>d.head==h.head)||s.push(h);break}else{if(h.head==c.head)break;c=h}}}return s.length==n.ranges.length?!1:(i.dispatch(kn(t,$.create(s,s.length-1))),!0)}const I5=i=>SE(i,!1),P5=i=>SE(i,!0),H5=({state:i,dispatch:e})=>{let t=i.selection,n=null;return t.ranges.length>1?n=$.create([t.main]):t.main.empty||(n=$.create([$.cursor(t.main.head)])),n?(e(kn(i,n)),!0):!1};function lu(i,e){if(i.state.readOnly)return!1;let t="delete.selection",{state:n}=i,s=n.changeByRange(l=>{let{from:a,to:c}=l;if(a==c){let h=e(l);h<a?(t="delete.backward",h=nf(i,h,!1)):h>a&&(t="delete.forward",h=nf(i,h,!0)),a=Math.min(a,h),c=Math.max(c,h)}else a=nf(i,a,!1),c=nf(i,c,!0);return a==c?{range:l}:{changes:{from:a,to:c},range:$.cursor(a,a<l.head?-1:1)}});return s.changes.empty?!1:(i.dispatch(n.update(s,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?ee.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function nf(i,e,t){if(i instanceof ee)for(let n of i.state.facet(ee.atomicRanges).map(s=>s(i)))n.between(e,e,(s,l)=>{s<e&&l>e&&(e=t?l:s)});return e}const kE=(i,e,t)=>lu(i,n=>{let s=n.from,{state:l}=i,a=l.doc.lineAt(s),c,h;if(t&&!e&&s>a.from&&s<a.from+200&&!/[^ \t]/.test(c=a.text.slice(0,s-a.from))){if(c[c.length-1]=="	")return s-1;let d=Ko(c,l.tabSize),p=d%Zf(l)||Zf(l);for(let m=0;m<p&&c[c.length-1-m]==" ";m++)s--;h=s}else h=Ct(a.text,s-a.from,e,e)+a.from,h==s&&a.number!=(e?l.doc.lines:1)?h+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(h-a.from,s-a.from))&&(h=Ct(a.text,h-a.from,!1,!1)+a.from);return h}),Iy=i=>kE(i,!1,!0),xE=i=>kE(i,!0,!1),_E=(i,e)=>lu(i,t=>{let n=t.head,{state:s}=i,l=s.doc.lineAt(n),a=s.charCategorizer(n);for(let c=null;;){if(n==(e?l.to:l.from)){n==t.head&&l.number!=(e?s.doc.lines:1)&&(n+=e?1:-1);break}let h=Ct(l.text,n-l.from,e)+l.from,d=l.text.slice(Math.min(n,h)-l.from,Math.max(n,h)-l.from),p=a(d);if(c!=null&&p!=c)break;(d!=" "||n!=t.head)&&(c=p),n=h}return n}),OE=i=>_E(i,!1),q5=i=>_E(i,!0),V5=i=>lu(i,e=>{let t=i.lineBlockAt(e.head).to;return e.head<t?t:Math.min(i.state.doc.length,e.head+1)}),$5=i=>lu(i,e=>{let t=i.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),G5=i=>lu(i,e=>{let t=i.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(i.state.doc.length,e.head+1)}),K5=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:He.of(["",""])},range:$.cursor(n.from)}));return e(i.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},W5=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=i.changeByRange(n=>{if(!n.empty||n.from==0||n.from==i.doc.length)return{range:n};let s=n.from,l=i.doc.lineAt(s),a=s==l.from?s-1:Ct(l.text,s-l.from,!1)+l.from,c=s==l.to?s+1:Ct(l.text,s-l.from,!0)+l.from;return{changes:{from:a,to:c,insert:i.doc.slice(s,c).append(i.doc.slice(a,s))},range:$.cursor(c)}});return t.changes.empty?!1:(e(i.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function qd(i){let e=[],t=-1;for(let n of i.selection.ranges){let s=i.doc.lineAt(n.from),l=i.doc.lineAt(n.to);if(!n.empty&&n.to==l.from&&(l=i.doc.lineAt(n.to-1)),t>=s.number){let a=e[e.length-1];a.to=l.to,a.ranges.push(n)}else e.push({from:s.from,to:l.to,ranges:[n]});t=l.number+1}return e}function AE(i,e,t){if(i.readOnly)return!1;let n=[],s=[];for(let l of qd(i)){if(t?l.to==i.doc.length:l.from==0)continue;let a=i.doc.lineAt(t?l.to+1:l.from-1),c=a.length+1;if(t){n.push({from:l.to,to:a.to},{from:l.from,insert:a.text+i.lineBreak});for(let h of l.ranges)s.push($.range(Math.min(i.doc.length,h.anchor+c),Math.min(i.doc.length,h.head+c)))}else{n.push({from:a.from,to:l.from},{from:l.to,insert:i.lineBreak+a.text});for(let h of l.ranges)s.push($.range(h.anchor-c,h.head-c))}}return n.length?(e(i.update({changes:n,scrollIntoView:!0,selection:$.create(s,i.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Y5=({state:i,dispatch:e})=>AE(i,e,!1),F5=({state:i,dispatch:e})=>AE(i,e,!0);function CE(i,e,t){if(i.readOnly)return!1;let n=[];for(let l of qd(i))t?n.push({from:l.from,insert:i.doc.slice(l.from,l.to)+i.lineBreak}):n.push({from:l.to,insert:i.lineBreak+i.doc.slice(l.from,l.to)});let s=i.changes(n);return e(i.update({changes:s,selection:i.selection.map(s,t?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const X5=({state:i,dispatch:e})=>CE(i,e,!1),Q5=({state:i,dispatch:e})=>CE(i,e,!0),J5=i=>{if(i.state.readOnly)return!1;let{state:e}=i,t=e.changes(qd(e).map(({from:s,to:l})=>(s>0?s--:l<e.doc.length&&l++,{from:s,to:l}))),n=Wo(e.selection,s=>{let l;if(i.lineWrapping){let a=i.lineBlockAt(s.head),c=i.coordsAtPos(s.head,s.assoc||1);c&&(l=a.bottom+i.documentTop-c.bottom+i.defaultLineHeight/2)}return i.moveVertically(s,!0,l)}).map(t);return i.dispatch({changes:t,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Z5(i,e){if(/\(\)|\[\]|\{\}/.test(i.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=Kt(i).resolveInner(e),n=t.childBefore(e),s=t.childAfter(e),l;return n&&s&&n.to<=e&&s.from>=e&&(l=n.type.prop(Re.closedBy))&&l.indexOf(s.name)>-1&&i.doc.lineAt(n.to).from==i.doc.lineAt(s.from).from&&!/\S/.test(i.sliceDoc(n.to,s.from))?{from:n.to,to:s.from}:null}const M_=TE(!1),e6=TE(!0);function TE(i){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(s=>{let{from:l,to:a}=s,c=e.doc.lineAt(l),h=!i&&l==a&&Z5(e,l);i&&(l=a=(a<=c.to?c:e.doc.lineAt(a)).to);let d=new Ud(e,{simulateBreak:l,simulateDoubleBreak:!!h}),p=Vb(d,l);for(p==null&&(p=Ko(/^\s*/.exec(e.doc.lineAt(l).text)[0],e.tabSize));a<c.to&&/\s/.test(c.text[a-c.from]);)a++;h?{from:l,to:a}=h:l>c.from&&l<c.from+100&&!/\S/.test(c.text.slice(0,l))&&(l=c.from);let m=["",Hc(e,p)];return h&&m.push(Hc(e,d.lineIndent(c.from,-1))),{changes:{from:l,to:a,insert:He.of(m)},range:$.cursor(l+1+m[1].length)}});return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function Wb(i,e){let t=-1;return i.changeByRange(n=>{let s=[];for(let a=n.from;a<=n.to;){let c=i.doc.lineAt(a);c.number>t&&(n.empty||n.to>c.from)&&(e(c,s,n),t=c.number),a=c.to+1}let l=i.changes(s);return{changes:s,range:$.range(l.mapPos(n.anchor,1),l.mapPos(n.head,1))}})}const t6=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let t=Object.create(null),n=new Ud(i,{overrideIndentation:l=>{let a=t[l];return a??-1}}),s=Wb(i,(l,a,c)=>{let h=Vb(n,l.from);if(h==null)return;/\S/.test(l.text)||(h=0);let d=/^\s*/.exec(l.text)[0],p=Hc(i,h);(d!=p||c.from<l.from+d.length)&&(t[l.from]=h,a.push({from:l.from,to:l.from+d.length,insert:p}))});return s.changes.empty||e(i.update(s,{userEvent:"indent"})),!0},i6=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(Wb(i,(t,n)=>{n.push({from:t.from,insert:i.facet(qb)})}),{userEvent:"input.indent"})),!0),n6=({state:i,dispatch:e})=>i.readOnly?!1:(e(i.update(Wb(i,(t,n)=>{let s=/^\s*/.exec(t.text)[0];if(!s)return;let l=Ko(s,i.tabSize),a=0,c=Hc(i,Math.max(0,l-Zf(i)));for(;a<s.length&&a<c.length&&s.charCodeAt(a)==c.charCodeAt(a);)a++;n.push({from:t.from+a,to:t.from+s.length,insert:c.slice(a)})}),{userEvent:"delete.dedent"})),!0),s6=i=>(i.setTabFocusMode(),!0),r6=[{key:"Ctrl-b",run:rE,shift:pE,preventDefault:!0},{key:"Ctrl-f",run:lE,shift:gE},{key:"Ctrl-p",run:cE,shift:bE},{key:"Ctrl-n",run:uE,shift:vE},{key:"Ctrl-a",run:k5,shift:L5},{key:"Ctrl-e",run:x5,shift:B5},{key:"Ctrl-d",run:xE},{key:"Ctrl-h",run:Iy},{key:"Ctrl-k",run:V5},{key:"Ctrl-Alt-h",run:OE},{key:"Ctrl-o",run:K5},{key:"Ctrl-t",run:W5},{key:"Ctrl-v",run:zy}],l6=[{key:"ArrowLeft",run:rE,shift:pE,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:d5,shift:A5,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:w5,shift:M5,preventDefault:!0},{key:"ArrowRight",run:lE,shift:gE,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:p5,shift:C5,preventDefault:!0},{mac:"Cmd-ArrowRight",run:S5,shift:N5,preventDefault:!0},{key:"ArrowUp",run:cE,shift:bE,preventDefault:!0},{mac:"Cmd-ArrowUp",run:T_,shift:D_},{mac:"Ctrl-ArrowUp",run:O_,shift:A_},{key:"ArrowDown",run:uE,shift:vE,preventDefault:!0},{mac:"Cmd-ArrowDown",run:E_,shift:R_},{mac:"Ctrl-ArrowDown",run:zy,shift:C_},{key:"PageUp",run:O_,shift:A_},{key:"PageDown",run:zy,shift:C_},{key:"Home",run:v5,shift:R5,preventDefault:!0},{key:"Mod-Home",run:T_,shift:D_},{key:"End",run:b5,shift:D5,preventDefault:!0},{key:"Mod-End",run:E_,shift:R_},{key:"Enter",run:M_,shift:M_},{key:"Mod-a",run:U5},{key:"Backspace",run:Iy,shift:Iy,preventDefault:!0},{key:"Delete",run:xE,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:OE,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:q5,preventDefault:!0},{mac:"Mod-Backspace",run:$5,preventDefault:!0},{mac:"Mod-Delete",run:G5,preventDefault:!0}].concat(r6.map(i=>({mac:i.key,run:i.run,shift:i.shift}))),o6=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:m5,shift:T5},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:y5,shift:E5},{key:"Alt-ArrowUp",run:Y5},{key:"Shift-Alt-ArrowUp",run:X5},{key:"Alt-ArrowDown",run:F5},{key:"Shift-Alt-ArrowDown",run:Q5},{key:"Mod-Alt-ArrowUp",run:I5},{key:"Mod-Alt-ArrowDown",run:P5},{key:"Escape",run:H5},{key:"Mod-Enter",run:e6},{key:"Alt-l",mac:"Ctrl-l",run:j5},{key:"Mod-i",run:z5,preventDefault:!0},{key:"Mod-[",run:n6},{key:"Mod-]",run:i6},{key:"Mod-Alt-\\",run:t6},{key:"Shift-Mod-k",run:J5},{key:"Shift-Mod-\\",run:O5},{key:"Mod-/",run:Yz},{key:"Alt-A",run:Xz},{key:"Ctrl-m",mac:"Shift-Alt-m",run:s6}].concat(l6),N_=typeof String.prototype.normalize=="function"?i=>i.normalize("NFKD"):i=>i;class Io{constructor(e,t,n=0,s=e.length,l,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,s),this.bufferStart=n,this.normalize=l?c=>l(N_(c)):N_,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return hi(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=bb(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=Ln(e);let s=this.normalize(t);if(s.length)for(let l=0,a=n;;l++){let c=s.charCodeAt(l),h=this.match(c,a,this.bufferPos+this.bufferStart);if(l==s.length-1){if(h)return this.value=h,this;break}a==n&&l<t.length&&t.charCodeAt(l)==c&&a++}}}match(e,t,n){let s=null;for(let l=0;l<this.matches.length;l+=2){let a=this.matches[l],c=!1;this.query.charCodeAt(a)==e&&(a==this.query.length-1?s={from:this.matches[l+1],to:n}:(this.matches[l]++,c=!0)),c||(this.matches.splice(l,2),l-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?s={from:t,to:n}:this.matches.push(1,t)),s&&this.test&&!this.test(s.from,s.to,this.buffer,this.bufferStart)&&(s=null),s}}typeof Symbol<"u"&&(Io.prototype[Symbol.iterator]=function(){return this});const EE={from:-1,to:-1,match:/.*/.exec("")},Yb="gm"+(/x/.unicode==null?"":"u");class DE{constructor(e,t,n,s=0,l=e.length){if(this.text=e,this.to=l,this.curLine="",this.done=!1,this.value=EE,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new RE(e,t,n,s,l);this.re=new RegExp(t,Yb+(n?.ignoreCase?"i":"")),this.test=n?.test,this.iter=e.iter();let a=e.lineAt(s);this.curLineStart=a.from,this.matchPos=nd(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,s=n+t[0].length;if(this.matchPos=nd(this.text,s+(n==s?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<s||n>this.value.to)&&(!this.test||this.test(n,s,t)))return this.value={from:n,to:s,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const s0=new WeakMap;class ko{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let s=s0.get(e);if(!s||s.from>=n||s.to<=t){let c=new ko(t,e.sliceString(t,n));return s0.set(e,c),c}if(s.from==t&&s.to==n)return s;let{text:l,from:a}=s;return a>t&&(l=e.sliceString(t,a)+l,a=t),s.to<n&&(l+=e.sliceString(s.to,n)),s0.set(e,new ko(a,l)),new ko(t,l.slice(t-a,n-a))}}class RE{constructor(e,t,n,s,l){this.text=e,this.to=l,this.done=!1,this.value=EE,this.matchPos=nd(e,s),this.re=new RegExp(t,Yb+(n?.ignoreCase?"i":"")),this.test=n?.test,this.flat=ko.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let n=this.flat.from+t.index,s=n+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,s,t)))return this.value={from:n,to:s,match:t},this.matchPos=nd(this.text,s+(n==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=ko.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(DE.prototype[Symbol.iterator]=RE.prototype[Symbol.iterator]=function(){return this});function a6(i){try{return new RegExp(i,Yb),!0}catch{return!1}}function nd(i,e){if(e>=i.length)return e;let t=i.lineAt(e),n;for(;e<t.to&&(n=t.text.charCodeAt(e-t.from))>=56320&&n<57344;)e++;return e}const c6=i=>{let{state:e}=i,t=String(e.doc.lineAt(i.state.selection.main.head).number),{close:n,result:s}=_8(i,{label:e.phrase("Go to line"),input:{type:"text",name:"line",value:t},focus:!0,submitLabel:e.phrase("go")});return s.then(l=>{let a=l&&/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(l.elements.line.value);if(!a){i.dispatch({effects:n});return}let c=e.doc.lineAt(e.selection.main.head),[,h,d,p,m]=a,b=p?+p.slice(1):0,v=d?+d:c.number;if(d&&m){let _=v/100;h&&(_=_*(h=="-"?-1:1)+c.number/e.doc.lines),v=Math.round(e.doc.lines*_)}else d&&h&&(v=v*(h=="-"?-1:1)+c.number);let w=e.doc.line(Math.max(1,Math.min(e.doc.lines,v))),k=$.cursor(w.from+Math.max(0,Math.min(b,w.length)));i.dispatch({effects:[n,ee.scrollIntoView(k.from,{y:"center"})],selection:k})}),!0},u6={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},h6=te.define({combine(i){return Gn(i,u6,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function f6(i){return[y6,m6]}const d6=ue.mark({class:"cm-selectionMatch"}),p6=ue.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function L_(i,e,t,n){return(t==0||i(e.sliceDoc(t-1,t))!=rt.Word)&&(n==e.doc.length||i(e.sliceDoc(n,n+1))!=rt.Word)}function g6(i,e,t,n){return i(e.sliceDoc(t,t+1))==rt.Word&&i(e.sliceDoc(n-1,n))==rt.Word}const m6=lt.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.selectionSet||i.docChanged||i.viewportChanged)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let e=i.state.facet(h6),{state:t}=i,n=t.selection;if(n.ranges.length>1)return ue.none;let s=n.main,l,a=null;if(s.empty){if(!e.highlightWordAroundCursor)return ue.none;let h=t.wordAt(s.head);if(!h)return ue.none;a=t.charCategorizer(s.head),l=t.sliceDoc(h.from,h.to)}else{let h=s.to-s.from;if(h<e.minSelectionLength||h>200)return ue.none;if(e.wholeWords){if(l=t.sliceDoc(s.from,s.to),a=t.charCategorizer(s.head),!(L_(a,t,s.from,s.to)&&g6(a,t,s.from,s.to)))return ue.none}else if(l=t.sliceDoc(s.from,s.to),!l)return ue.none}let c=[];for(let h of i.visibleRanges){let d=new Io(t.doc,l,h.from,h.to);for(;!d.next().done;){let{from:p,to:m}=d.value;if((!a||L_(a,t,p,m))&&(s.empty&&p<=s.from&&m>=s.to?c.push(p6.range(p,m)):(p>=s.to||m<=s.from)&&c.push(d6.range(p,m)),c.length>e.maxMatches))return ue.none}}return ue.set(c)}},{decorations:i=>i.decorations}),y6=ee.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),b6=({state:i,dispatch:e})=>{let{selection:t}=i,n=$.create(t.ranges.map(s=>i.wordAt(s.head)||$.cursor(s.head)),t.mainIndex);return n.eq(t)?!1:(e(i.update({selection:n})),!0)};function v6(i,e){let{main:t,ranges:n}=i.selection,s=i.wordAt(t.head),l=s&&s.from==t.from&&s.to==t.to;for(let a=!1,c=new Io(i.doc,e,n[n.length-1].to);;)if(c.next(),c.done){if(a)return null;c=new Io(i.doc,e,0,Math.max(0,n[n.length-1].from-1)),a=!0}else{if(a&&n.some(h=>h.from==c.value.from))continue;if(l){let h=i.wordAt(c.value.from);if(!h||h.from!=c.value.from||h.to!=c.value.to)continue}return c.value}}const w6=({state:i,dispatch:e})=>{let{ranges:t}=i.selection;if(t.some(l=>l.from===l.to))return b6({state:i,dispatch:e});let n=i.sliceDoc(t[0].from,t[0].to);if(i.selection.ranges.some(l=>i.sliceDoc(l.from,l.to)!=n))return!1;let s=v6(i,n);return s?(e(i.update({selection:i.selection.addRange($.range(s.from,s.to),!1),effects:ee.scrollIntoView(s.to)})),!0):!1},Yo=te.define({combine(i){return Gn(i,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new L6(e),scrollToMatch:e=>ee.scrollIntoView(e)})}});class ME{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||a6(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord,this.test=e.test}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord&&this.test==e.test}create(){return this.regexp?new A6(this):new x6(this)}getCursor(e,t=0,n){let s=e.doc?e:je.create({doc:e});return n==null&&(n=s.doc.length),this.regexp?so(this,s,t,n):no(this,s,t,n)}}class NE{constructor(e){this.spec=e}}function S6(i,e,t){return(n,s,l,a)=>{if(t&&!t(n,s,l,a))return!1;let c=n>=a&&s<=a+l.length?l.slice(n-a,s-a):e.doc.sliceString(n,s);return i(c,e,n,s)}}function no(i,e,t,n){let s;return i.wholeWord&&(s=k6(e.doc,e.charCategorizer(e.selection.main.head))),i.test&&(s=S6(i.test,e,s)),new Io(e.doc,i.unquoted,t,n,i.caseSensitive?void 0:l=>l.toLowerCase(),s)}function k6(i,e){return(t,n,s,l)=>((l>t||l+s.length<n)&&(l=Math.max(0,t-2),s=i.sliceString(l,Math.min(i.length,n+2))),(e(sd(s,t-l))!=rt.Word||e(rd(s,t-l))!=rt.Word)&&(e(rd(s,n-l))!=rt.Word||e(sd(s,n-l))!=rt.Word))}class x6 extends NE{constructor(e){super(e)}nextMatch(e,t,n){let s=no(this.spec,e,n,e.doc.length).nextOverlapping();if(s.done){let l=Math.min(e.doc.length,t+this.spec.unquoted.length);s=no(this.spec,e,0,l).nextOverlapping()}return s.done||s.value.from==t&&s.value.to==n?null:s.value}prevMatchInRange(e,t,n){for(let s=n;;){let l=Math.max(t,s-1e4-this.spec.unquoted.length),a=no(this.spec,e,l,s),c=null;for(;!a.nextOverlapping().done;)c=a.value;if(c)return c;if(l==t)return null;s-=1e4}}prevMatch(e,t,n){let s=this.prevMatchInRange(e,0,t);return s||(s=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),s&&(s.from!=t||s.to!=n)?s:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=no(this.spec,e,0,e.doc.length),s=[];for(;!n.next().done;){if(s.length>=t)return null;s.push(n.value)}return s}highlight(e,t,n,s){let l=no(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!l.next().done;)s(l.value.from,l.value.to)}}function _6(i,e,t){return(n,s,l)=>(!t||t(n,s,l))&&i(l[0],e,n,s)}function so(i,e,t,n){let s;return i.wholeWord&&(s=O6(e.charCategorizer(e.selection.main.head))),i.test&&(s=_6(i.test,e,s)),new DE(e.doc,i.search,{ignoreCase:!i.caseSensitive,test:s},t,n)}function sd(i,e){return i.slice(Ct(i,e,!1),e)}function rd(i,e){return i.slice(e,Ct(i,e))}function O6(i){return(e,t,n)=>!n[0].length||(i(sd(n.input,n.index))!=rt.Word||i(rd(n.input,n.index))!=rt.Word)&&(i(rd(n.input,n.index+n[0].length))!=rt.Word||i(sd(n.input,n.index+n[0].length))!=rt.Word)}class A6 extends NE{nextMatch(e,t,n){let s=so(this.spec,e,n,e.doc.length).next();return s.done&&(s=so(this.spec,e,0,t).next()),s.done?null:s.value}prevMatchInRange(e,t,n){for(let s=1;;s++){let l=Math.max(t,n-s*1e4),a=so(this.spec,e,l,n),c=null;for(;!a.next().done;)c=a.value;if(c&&(l==t||c.from>l+10))return c;if(l==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,n)=>{if(n=="&")return e.match[0];if(n=="$")return"$";for(let s=n.length;s>0;s--){let l=+n.slice(0,s);if(l>0&&l<e.match.length)return e.match[l]+n.slice(s)}return t})}matchAll(e,t){let n=so(this.spec,e,0,e.doc.length),s=[];for(;!n.next().done;){if(s.length>=t)return null;s.push(n.value)}return s}highlight(e,t,n,s){let l=so(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!l.next().done;)s(l.value.from,l.value.to)}}const qc=_e.define(),Fb=_e.define(),nr=Wt.define({create(i){return new r0(Py(i).create(),null)},update(i,e){for(let t of e.effects)t.is(qc)?i=new r0(t.value.create(),i.panel):t.is(Fb)&&(i=new r0(i.query,t.value?Xb:null));return i},provide:i=>zc.from(i,e=>e.panel)});class r0{constructor(e,t){this.query=e,this.panel=t}}const C6=ue.mark({class:"cm-searchMatch"}),T6=ue.mark({class:"cm-searchMatch cm-searchMatch-selected"}),E6=lt.fromClass(class{constructor(i){this.view=i,this.decorations=this.highlight(i.state.field(nr))}update(i){let e=i.state.field(nr);(e!=i.startState.field(nr)||i.docChanged||i.selectionSet||i.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:i,panel:e}){if(!e||!i.spec.valid)return ue.none;let{view:t}=this,n=new qn;for(let s=0,l=t.visibleRanges,a=l.length;s<a;s++){let{from:c,to:h}=l[s];for(;s<a-1&&h>l[s+1].from-500;)h=l[++s].to;i.highlight(t.state,c,h,(d,p)=>{let m=t.state.selection.ranges.some(b=>b.from==d&&b.to==p);n.add(d,p,m?T6:C6)})}return n.finish()}},{decorations:i=>i.decorations});function ou(i){return e=>{let t=e.state.field(nr,!1);return t&&t.query.spec.valid?i(e,t):UE(e)}}const ld=ou((i,{query:e})=>{let{to:t}=i.state.selection.main,n=e.nextMatch(i.state,t,t);if(!n)return!1;let s=$.single(n.from,n.to),l=i.state.facet(Yo);return i.dispatch({selection:s,effects:[Qb(i,n),l.scrollToMatch(s.main,i)],userEvent:"select.search"}),BE(i),!0}),od=ou((i,{query:e})=>{let{state:t}=i,{from:n}=t.selection.main,s=e.prevMatch(t,n,n);if(!s)return!1;let l=$.single(s.from,s.to),a=i.state.facet(Yo);return i.dispatch({selection:l,effects:[Qb(i,s),a.scrollToMatch(l.main,i)],userEvent:"select.search"}),BE(i),!0}),D6=ou((i,{query:e})=>{let t=e.matchAll(i.state,1e3);return!t||!t.length?!1:(i.dispatch({selection:$.create(t.map(n=>$.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),R6=({state:i,dispatch:e})=>{let t=i.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:n,to:s}=t.main,l=[],a=0;for(let c=new Io(i.doc,i.sliceDoc(n,s));!c.next().done;){if(l.length>1e3)return!1;c.value.from==n&&(a=l.length),l.push($.range(c.value.from,c.value.to))}return e(i.update({selection:$.create(l,a),userEvent:"select.search.matches"})),!0},B_=ou((i,{query:e})=>{let{state:t}=i,{from:n,to:s}=t.selection.main;if(t.readOnly)return!1;let l=e.nextMatch(t,n,n);if(!l)return!1;let a=l,c=[],h,d,p=[];a.from==n&&a.to==s&&(d=t.toText(e.getReplacement(a)),c.push({from:a.from,to:a.to,insert:d}),a=e.nextMatch(t,a.from,a.to),p.push(ee.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(n).number)+".")));let m=i.state.changes(c);return a&&(h=$.single(a.from,a.to).map(m),p.push(Qb(i,a)),p.push(t.facet(Yo).scrollToMatch(h.main,i))),i.dispatch({changes:m,selection:h,effects:p,userEvent:"input.replace"}),!0}),M6=ou((i,{query:e})=>{if(i.state.readOnly)return!1;let t=e.matchAll(i.state,1e9).map(s=>{let{from:l,to:a}=s;return{from:l,to:a,insert:e.getReplacement(s)}});if(!t.length)return!1;let n=i.state.phrase("replaced $ matches",t.length)+".";return i.dispatch({changes:t,effects:ee.announce.of(n),userEvent:"input.replace.all"}),!0});function Xb(i){return i.state.facet(Yo).createPanel(i)}function Py(i,e){var t,n,s,l,a;let c=i.selection.main,h=c.empty||c.to>c.from+100?"":i.sliceDoc(c.from,c.to);if(e&&!h)return e;let d=i.facet(Yo);return new ME({search:((t=e?.literal)!==null&&t!==void 0?t:d.literal)?h:h.replace(/\n/g,"\\n"),caseSensitive:(n=e?.caseSensitive)!==null&&n!==void 0?n:d.caseSensitive,literal:(s=e?.literal)!==null&&s!==void 0?s:d.literal,regexp:(l=e?.regexp)!==null&&l!==void 0?l:d.regexp,wholeWord:(a=e?.wholeWord)!==null&&a!==void 0?a:d.wholeWord})}function LE(i){let e=jb(i,Xb);return e&&e.dom.querySelector("[main-field]")}function BE(i){let e=LE(i);e&&e==i.root.activeElement&&e.select()}const UE=i=>{let e=i.state.field(nr,!1);if(e&&e.panel){let t=LE(i);if(t&&t!=i.root.activeElement){let n=Py(i.state,e.query.spec);n.valid&&i.dispatch({effects:qc.of(n)}),t.focus(),t.select()}}else i.dispatch({effects:[Fb.of(!0),e?qc.of(Py(i.state,e.query.spec)):_e.appendConfig.of(U6)]});return!0},jE=i=>{let e=i.state.field(nr,!1);if(!e||!e.panel)return!1;let t=jb(i,Xb);return t&&t.dom.contains(i.root.activeElement)&&i.focus(),i.dispatch({effects:Fb.of(!1)}),!0},N6=[{key:"Mod-f",run:UE,scope:"editor search-panel"},{key:"F3",run:ld,shift:od,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:ld,shift:od,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:jE,scope:"editor search-panel"},{key:"Mod-Shift-l",run:R6},{key:"Mod-Alt-g",run:c6},{key:"Mod-d",run:w6,preventDefault:!0}];class L6{constructor(e){this.view=e;let t=this.query=e.state.field(nr).query.spec;this.commit=this.commit.bind(this),this.searchField=Ye("input",{value:t.search,placeholder:Ei(e,"Find"),"aria-label":Ei(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Ye("input",{value:t.replace,placeholder:Ei(e,"Replace"),"aria-label":Ei(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Ye("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=Ye("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=Ye("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function n(s,l,a){return Ye("button",{class:"cm-button",name:s,onclick:l,type:"button"},a)}this.dom=Ye("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,n("next",()=>ld(e),[Ei(e,"next")]),n("prev",()=>od(e),[Ei(e,"previous")]),n("select",()=>D6(e),[Ei(e,"all")]),Ye("label",null,[this.caseField,Ei(e,"match case")]),Ye("label",null,[this.reField,Ei(e,"regexp")]),Ye("label",null,[this.wordField,Ei(e,"by word")]),...e.state.readOnly?[]:[Ye("br"),this.replaceField,n("replace",()=>B_(e),[Ei(e,"replace")]),n("replaceAll",()=>M6(e),[Ei(e,"replace all")])],Ye("button",{name:"close",onclick:()=>jE(e),"aria-label":Ei(e,"close"),type:"button"},[""])])}commit(){let e=new ME({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:qc.of(e)}))}keydown(e){U4(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?od:ld)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),B_(this.view))}update(e){for(let t of e.transactions)for(let n of t.effects)n.is(qc)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Yo).top}}function Ei(i,e){return i.state.phrase(e)}const sf=30,rf=/[\s\.,:;?!]/;function Qb(i,{from:e,to:t}){let n=i.state.doc.lineAt(e),s=i.state.doc.lineAt(t).to,l=Math.max(n.from,e-sf),a=Math.min(s,t+sf),c=i.state.sliceDoc(l,a);if(l!=n.from){for(let h=0;h<sf;h++)if(!rf.test(c[h+1])&&rf.test(c[h])){c=c.slice(h);break}}if(a!=s){for(let h=c.length-1;h>c.length-sf;h--)if(!rf.test(c[h-1])&&rf.test(c[h])){c=c.slice(0,h);break}}return ee.announce.of(`${i.state.phrase("current match")}. ${c} ${i.state.phrase("on line")} ${n.number}.`)}const B6=ee.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),U6=[nr,ll.low(E6),B6];class zE{constructor(e,t,n,s){this.state=e,this.pos=t,this.explicit=n,this.view=s,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=Kt(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),s=t.text.slice(n-t.from,this.pos-t.from),l=s.search(IE(e,!1));return l<0?null:{from:n+l,to:this.pos,text:s.slice(l)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function U_(i){let e=Object.keys(i).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function j6(i){let e=Object.create(null),t=Object.create(null);for(let{label:s}of i){e[s[0]]=!0;for(let l=1;l<s.length;l++)t[s[l]]=!0}let n=U_(e)+U_(t)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function z6(i){let e=i.map(s=>typeof s=="string"?{label:s}:s),[t,n]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:j6(e);return s=>{let l=s.matchBefore(n);return l||s.explicit?{from:l?l.from:s.pos,options:e,validFor:t}:null}}class j_{constructor(e,t,n,s){this.completion=e,this.source=t,this.match=n,this.score=s}}function Yr(i){return i.selection.main.from}function IE(i,e){var t;let{source:n}=i,s=e&&n[0]!="^",l=n[n.length-1]!="$";return!s&&!l?i:new RegExp(`${s?"^":""}(?:${n})${l?"$":""}`,(t=i.flags)!==null&&t!==void 0?t:i.ignoreCase?"i":"")}const PE=Sn.define();function I6(i,e,t,n){let{main:s}=i.selection,l=t-s.from,a=n-s.from;return{...i.changeByRange(c=>{if(c!=s&&t!=n&&i.sliceDoc(c.from+l,c.from+a)!=i.sliceDoc(t,n))return{range:c};let h=i.toText(e);return{changes:{from:c.from+l,to:n==s.from?c.to:c.from+a,insert:h},range:$.cursor(c.from+l+h.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const z_=new WeakMap;function P6(i){if(!Array.isArray(i))return i;let e=z_.get(i);return e||z_.set(i,e=z6(i)),e}const ad=_e.define(),Vc=_e.define();class H6{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=hi(e,t),s=Ln(n);this.chars.push(n);let l=e.slice(t,t+s),a=l.toUpperCase();this.folded.push(hi(a==l?l.toLowerCase():a,0)),t+=s}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:n,any:s,precise:l,byWord:a}=this;if(t.length==1){let R=hi(e,0),C=Ln(R),N=C==e.length?0:-100;if(R!=t[0])if(R==n[0])N+=-200;else return null;return this.ret(N,[0,C])}let c=e.indexOf(this.pattern);if(c==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let h=t.length,d=0;if(c<0){for(let R=0,C=Math.min(e.length,200);R<C&&d<h;){let N=hi(e,R);(N==t[d]||N==n[d])&&(s[d++]=R),R+=Ln(N)}if(d<h)return null}let p=0,m=0,b=!1,v=0,w=-1,k=-1,_=/[a-z]/.test(e),O=!0;for(let R=0,C=Math.min(e.length,200),N=0;R<C&&m<h;){let j=hi(e,R);c<0&&(p<h&&j==t[p]&&(l[p++]=R),v<h&&(j==t[v]||j==n[v]?(v==0&&(w=R),k=R+1,v++):v=0));let H,D=j<255?j>=48&&j<=57||j>=97&&j<=122?2:j>=65&&j<=90?1:0:(H=bb(j))!=H.toLowerCase()?1:H!=H.toUpperCase()?2:0;(!R||D==1&&_||N==0&&D!=0)&&(t[m]==j||n[m]==j&&(b=!0)?a[m++]=R:a.length&&(O=!1)),N=D,R+=Ln(j)}return m==h&&a[0]==0&&O?this.result(-100+(b?-200:0),a,e):v==h&&w==0?this.ret(-200-e.length+(k==e.length?0:-100),[0,k]):c>-1?this.ret(-700-e.length,[c,c+this.pattern.length]):v==h?this.ret(-900-e.length,[w,k]):m==h?this.result(-100+(b?-200:0)+-700+(O?0:-1100),a,e):t.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,t,n){let s=[],l=0;for(let a of t){let c=a+(this.astral?Ln(hi(n,a)):1);l&&s[l-1]==a?s[l-1]=c:(s[l++]=a,s[l++]=c)}return this.ret(e-n.length,s)}}class q6{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),n=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,t.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const Nt=te.define({combine(i){return Gn(i,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:V6,filterStrict:!1,compareCompletions:(e,t)=>(e.sortText||e.label).localeCompare(t.sortText||t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>I_(e(n),t(n)),optionClass:(e,t)=>n=>I_(e(n),t(n)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function I_(i,e){return i?e?i+" "+e:i:e}function V6(i,e,t,n,s,l){let a=i.textDirection==Ze.RTL,c=a,h=!1,d="top",p,m,b=e.left-s.left,v=s.right-e.right,w=n.right-n.left,k=n.bottom-n.top;if(c&&b<Math.min(w,v)?c=!1:!c&&v<Math.min(w,b)&&(c=!0),w<=(c?b:v))p=Math.max(s.top,Math.min(t.top,s.bottom-k))-e.top,m=Math.min(400,c?b:v);else{h=!0,m=Math.min(400,(a?e.right:s.right-e.left)-30);let R=s.bottom-e.bottom;R>=k||R>e.top?p=t.bottom-e.top:(d="bottom",p=e.bottom-t.top)}let _=(e.bottom-e.top)/l.offsetHeight,O=(e.right-e.left)/l.offsetWidth;return{style:`${d}: ${p/_}px; max-width: ${m/O}px`,class:"cm-completionInfo-"+(h?a?"left-narrow":"right-narrow":c?"left":"right")}}function $6(i){let e=i.addToOptions.slice();return i.icons&&e.push({render(t){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),t.type&&n.classList.add(...t.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(t,n,s,l){let a=document.createElement("span");a.className="cm-completionLabel";let c=t.displayLabel||t.label,h=0;for(let d=0;d<l.length;){let p=l[d++],m=l[d++];p>h&&a.appendChild(document.createTextNode(c.slice(h,p)));let b=a.appendChild(document.createElement("span"));b.appendChild(document.createTextNode(c.slice(p,m))),b.className="cm-completionMatchedText",h=m}return h<c.length&&a.appendChild(document.createTextNode(c.slice(h))),a},position:50},{render(t){if(!t.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=t.detail,n},position:80}),e.sort((t,n)=>t.position-n.position).map(t=>t.render)}function l0(i,e,t){if(i<=t)return{from:0,to:i};if(e<0&&(e=0),e<=i>>1){let s=Math.floor(e/t);return{from:s*t,to:(s+1)*t}}let n=Math.floor((i-e)/t);return{from:i-(n+1)*t,to:i-n*t}}class G6{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:h=>this.placeInfo(h),key:this},this.space=null,this.currentClass="";let s=e.state.field(t),{options:l,selected:a}=s.open,c=e.state.facet(Nt);this.optionContent=$6(c),this.optionClass=c.optionClass,this.tooltipClass=c.tooltipClass,this.range=l0(l.length,a,c.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",h=>{let{options:d}=e.state.field(t).open;for(let p=h.target,m;p&&p!=this.dom;p=p.parentNode)if(p.nodeName=="LI"&&(m=/-(\d+)$/.exec(p.id))&&+m[1]<d.length){this.applyCompletion(e,d[+m[1]]),h.preventDefault();return}}),this.dom.addEventListener("focusout",h=>{let d=e.state.field(this.stateField,!1);d&&d.tooltip&&e.state.facet(Nt).closeOnBlur&&h.relatedTarget!=e.contentDOM&&e.dispatch({effects:Vc.of(null)})}),this.showOptions(l,s.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let n=e.state.field(this.stateField),s=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=s){let{options:l,selected:a,disabled:c}=n.open;(!s.open||s.open.options!=l)&&(this.range=l0(l.length,a,e.state.facet(Nt).maxRenderedOptions),this.showOptions(l,n.id)),this.updateSel(),c!=((t=s.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!c)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of t.split(" "))n&&this.dom.classList.add(n);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;(t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=l0(t.options.length,t.selected,this.view.state.facet(Nt).maxRenderedOptions),this.showOptions(t.options,e.id));let n=this.updateSelectedOption(t.selected);if(n){this.destroyInfo();let{completion:s}=t.options[t.selected],{info:l}=s;if(!l)return;let a=typeof l=="string"?document.createTextNode(l):l(s);if(!a)return;"then"in a?a.then(c=>{c&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(c,s)}).catch(c=>gi(this.view.state,c,"completion info")):(this.addInfoPane(a,s),n.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",n.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:s,destroy:l}=e;n.appendChild(s),this.infoDestroy=l||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,s=this.range.from;n;n=n.nextSibling,s++)n.nodeName!="LI"||!n.id?s--:s==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&(n.removeAttribute("aria-selected"),n.removeAttribute("aria-describedby"));return t&&W6(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),l=this.space;if(!l){let a=this.dom.ownerDocument.documentElement;l={left:0,top:0,right:a.clientWidth,bottom:a.clientHeight}}return s.top>Math.min(l.bottom,t.bottom)-10||s.bottom<Math.max(l.top,t.top)+10?null:this.view.state.facet(Nt).positionInfo(this.view,t,s,n,l,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){const s=document.createElement("ul");s.id=t,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions")),s.addEventListener("mousedown",a=>{a.target==s&&a.preventDefault()});let l=null;for(let a=n.from;a<n.to;a++){let{completion:c,match:h}=e[a],{section:d}=c;if(d){let b=typeof d=="string"?d:d.name;if(b!=l&&(a>n.from||n.from==0))if(l=b,typeof d!="string"&&d.header)s.appendChild(d.header(d));else{let v=s.appendChild(document.createElement("completion-section"));v.textContent=b}}const p=s.appendChild(document.createElement("li"));p.id=t+"-"+a,p.setAttribute("role","option");let m=this.optionClass(c);m&&(p.className=m);for(let b of this.optionContent){let v=b(c,this.view.state,this.view,h);v&&p.appendChild(v)}}return n.from&&s.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function K6(i,e){return t=>new G6(t,i,e)}function W6(i,e){let t=i.getBoundingClientRect(),n=e.getBoundingClientRect(),s=t.height/i.offsetHeight;n.top<t.top?i.scrollTop-=(t.top-n.top)/s:n.bottom>t.bottom&&(i.scrollTop+=(n.bottom-t.bottom)/s)}function P_(i){return(i.boost||0)*100+(i.apply?10:0)+(i.info?5:0)+(i.type?1:0)}function Y6(i,e){let t=[],n=null,s=null,l=p=>{t.push(p);let{section:m}=p.completion;if(m){n||(n=[]);let b=typeof m=="string"?m:m.name;n.some(v=>v.name==b)||n.push(typeof m=="string"?{name:b}:m)}},a=e.facet(Nt);for(let p of i)if(p.hasResult()){let m=p.result.getMatch;if(p.result.filter===!1)for(let b of p.result.options)l(new j_(b,p.source,m?m(b):[],1e9-t.length));else{let b=e.sliceDoc(p.from,p.to),v,w=a.filterStrict?new q6(b):new H6(b);for(let k of p.result.options)if(v=w.match(k.label)){let _=k.displayLabel?m?m(k,v.matched):[]:v.matched,O=v.score+(k.boost||0);if(l(new j_(k,p.source,_,O)),typeof k.section=="object"&&k.section.rank==="dynamic"){let{name:R}=k.section;s||(s=Object.create(null)),s[R]=Math.max(O,s[R]||-1e9)}}}}if(n){let p=Object.create(null),m=0,b=(v,w)=>(v.rank==="dynamic"&&w.rank==="dynamic"?s[w.name]-s[v.name]:0)||(typeof v.rank=="number"?v.rank:1e9)-(typeof w.rank=="number"?w.rank:1e9)||(v.name<w.name?-1:1);for(let v of n.sort(b))m-=1e5,p[v.name]=m;for(let v of t){let{section:w}=v.completion;w&&(v.score+=p[typeof w=="string"?w:w.name])}}let c=[],h=null,d=a.compareCompletions;for(let p of t.sort((m,b)=>b.score-m.score||d(m.completion,b.completion))){let m=p.completion;!h||h.label!=m.label||h.detail!=m.detail||h.type!=null&&m.type!=null&&h.type!=m.type||h.apply!=m.apply||h.boost!=m.boost?c.push(p):P_(p.completion)>P_(h)&&(c[c.length-1]=p),h=p.completion}return c}class uo{constructor(e,t,n,s,l,a){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=s,this.selected=l,this.disabled=a}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new uo(this.options,H_(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,s,l,a){if(s&&!a&&e.some(d=>d.isPending))return s.setDisabled();let c=Y6(e,t);if(!c.length)return s&&e.some(d=>d.isPending)?s.setDisabled():null;let h=t.facet(Nt).selectOnOpen?0:-1;if(s&&s.selected!=h&&s.selected!=-1){let d=s.options[s.selected].completion;for(let p=0;p<c.length;p++)if(c[p].completion==d){h=p;break}}return new uo(c,H_(n,h),{pos:e.reduce((d,p)=>p.hasResult()?Math.min(d,p.from):d,1e8),create:eI,above:l.aboveCursor},s?s.timestamp:Date.now(),h,!1)}map(e){return new uo(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new uo(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class cd{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new cd(J6,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,n=t.facet(Nt),l=(n.override||t.languageDataAt("autocomplete",Yr(t)).map(P6)).map(h=>(this.active.find(p=>p.source==h)||new nn(h,this.active.some(p=>p.state!=0)?1:0)).update(e,n));l.length==this.active.length&&l.every((h,d)=>h==this.active[d])&&(l=this.active);let a=this.open,c=e.effects.some(h=>h.is(Jb));a&&e.docChanged&&(a=a.map(e.changes)),e.selection||l.some(h=>h.hasResult()&&e.changes.touchesRange(h.from,h.to))||!F6(l,this.active)||c?a=uo.build(l,t,this.id,a,n,c):a&&a.disabled&&!l.some(h=>h.isPending)&&(a=null),!a&&l.every(h=>!h.isPending)&&l.some(h=>h.hasResult())&&(l=l.map(h=>h.hasResult()?new nn(h.source,0):h));for(let h of e.effects)h.is(qE)&&(a=a&&a.setSelected(h.value,this.id));return l==this.active&&a==this.open?this:new cd(l,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?X6:Q6}}function F6(i,e){if(i==e)return!0;for(let t=0,n=0;;){for(;t<i.length&&!i[t].hasResult();)t++;for(;n<e.length&&!e[n].hasResult();)n++;let s=t==i.length,l=n==e.length;if(s||l)return s==l;if(i[t++].result!=e[n++].result)return!1}}const X6={"aria-autocomplete":"list"},Q6={};function H_(i,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":i};return e>-1&&(t["aria-activedescendant"]=i+"-"+e),t}const J6=[];function HE(i,e){if(i.isUserEvent("input.complete")){let n=i.annotation(PE);if(n&&e.activateOnCompletion(n))return 12}let t=i.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:i.isUserEvent("delete.backward")?2:i.selection?8:i.docChanged?16:0}class nn{constructor(e,t,n=!1){this.source=e,this.state=t,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let n=HE(e,t),s=this;(n&8||n&16&&this.touches(e))&&(s=new nn(s.source,0)),n&4&&s.state==0&&(s=new nn(this.source,1)),s=s.updateFor(e,n);for(let l of e.effects)if(l.is(ad))s=new nn(s.source,1,l.value);else if(l.is(Vc))s=new nn(s.source,0);else if(l.is(Jb))for(let a of l.value)a.source==s.source&&(s=a);return s}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Yr(e.state))}}class xo extends nn{constructor(e,t,n,s,l,a){super(e,3,t),this.limit=n,this.result=s,this.from=l,this.to=a}hasResult(){return!0}updateFor(e,t){var n;if(!(t&3))return this.map(e.changes);let s=this.result;s.map&&!e.changes.empty&&(s=s.map(s,e.changes));let l=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),c=Yr(e.state);if(c>a||!s||t&2&&(Yr(e.startState)==this.from||c<this.limit))return new nn(this.source,t&4?1:0);let h=e.changes.mapPos(this.limit);return Z6(s.validFor,e.state,l,a)?new xo(this.source,this.explicit,h,s,l,a):s.update&&(s=s.update(s,l,a,new zE(e.state,c,!1)))?new xo(this.source,this.explicit,h,s,s.from,(n=s.to)!==null&&n!==void 0?n:Yr(e.state)):new nn(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new xo(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new nn(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function Z6(i,e,t,n){if(!i)return!1;let s=e.sliceDoc(t,n);return typeof i=="function"?i(s,t,n,e):IE(i,!0).test(s)}const Jb=_e.define({map(i,e){return i.map(t=>t.map(e))}}),qE=_e.define(),fi=Wt.define({create(){return cd.start()},update(i,e){return i.update(e)},provide:i=>[Ub.from(i,e=>e.tooltip),ee.contentAttributes.from(i,e=>e.attrs)]});function Zb(i,e){const t=e.completion.apply||e.completion.label;let n=i.state.field(fi).active.find(s=>s.source==e.source);return n instanceof xo?(typeof t=="string"?i.dispatch({...I6(i.state,t,n.from,n.to),annotations:PE.of(e.completion)}):t(i,e.completion,n.from,n.to),!0):!1}const eI=K6(fi,Zb);function lf(i,e="option"){return t=>{let n=t.state.field(fi,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<t.state.facet(Nt).interactionDelay)return!1;let s=1,l;e=="page"&&(l=AT(t,n.open.tooltip))&&(s=Math.max(2,Math.floor(l.dom.offsetHeight/l.dom.querySelector("li").offsetHeight)-1));let{length:a}=n.open.options,c=n.open.selected>-1?n.open.selected+s*(i?1:-1):i?0:a-1;return c<0?c=e=="page"?0:a-1:c>=a&&(c=e=="page"?a-1:0),t.dispatch({effects:qE.of(c)}),!0}}const tI=i=>{let e=i.state.field(fi,!1);return i.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<i.state.facet(Nt).interactionDelay?!1:Zb(i,e.open.options[e.open.selected])},o0=i=>i.state.field(fi,!1)?(i.dispatch({effects:ad.of(!0)}),!0):!1,iI=i=>{let e=i.state.field(fi,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(i.dispatch({effects:Vc.of(null)}),!0)};class nI{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const sI=50,rI=1e3,lI=lt.fromClass(class{constructor(i){this.view=i,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of i.state.field(fi).active)e.isPending&&this.startQuery(e)}update(i){let e=i.state.field(fi),t=i.state.facet(Nt);if(!i.selectionSet&&!i.docChanged&&i.startState.field(fi)==e)return;let n=i.transactions.some(l=>{let a=HE(l,t);return a&8||(l.selection||l.docChanged)&&!(a&3)});for(let l=0;l<this.running.length;l++){let a=this.running[l];if(n||a.context.abortOnDocChange&&i.docChanged||a.updates.length+i.transactions.length>sI&&Date.now()-a.time>rI){for(let c of a.context.abortListeners)try{c()}catch(h){gi(this.view.state,h)}a.context.abortListeners=null,this.running.splice(l--,1)}else a.updates.push(...i.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),i.transactions.some(l=>l.effects.some(a=>a.is(ad)))&&(this.pendingStart=!0);let s=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(l=>l.isPending&&!this.running.some(a=>a.active.source==l.source))?setTimeout(()=>this.startUpdate(),s):-1,this.composing!=0)for(let l of i.transactions)l.isUserEvent("input.type")?this.composing=2:this.composing==2&&l.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:i}=this.view,e=i.field(fi);for(let t of e.active)t.isPending&&!this.running.some(n=>n.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Nt).updateSyncTime))}startQuery(i){let{state:e}=this.view,t=Yr(e),n=new zE(e,t,i.explicit,this.view),s=new nI(i,n);this.running.push(s),Promise.resolve(i.source(n)).then(l=>{s.context.aborted||(s.done=l||null,this.scheduleAccept())},l=>{this.view.dispatch({effects:Vc.of(null)}),gi(this.view.state,l)})}scheduleAccept(){this.running.every(i=>i.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Nt).updateSyncTime))}accept(){var i;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Nt),n=this.view.state.field(fi);for(let s=0;s<this.running.length;s++){let l=this.running[s];if(l.done===void 0)continue;if(this.running.splice(s--,1),l.done){let c=Yr(l.updates.length?l.updates[0].startState:this.view.state),h=Math.min(c,l.done.from+(l.active.explicit?0:1)),d=new xo(l.active.source,l.active.explicit,h,l.done,l.done.from,(i=l.done.to)!==null&&i!==void 0?i:c);for(let p of l.updates)d=d.update(p,t);if(d.hasResult()){e.push(d);continue}}let a=n.active.find(c=>c.source==l.active.source);if(a&&a.isPending)if(l.done==null){let c=new nn(l.active.source,0);for(let h of l.updates)c=c.update(h,t);c.isPending||e.push(c)}else this.startQuery(a)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:Jb.of(e)})}},{eventHandlers:{blur(i){let e=this.view.state.field(fi,!1);if(e&&e.tooltip&&this.view.state.facet(Nt).closeOnBlur){let t=e.open&&AT(this.view,e.open.tooltip);(!t||!t.dom.contains(i.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Vc.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:ad.of(!1)}),20),this.composing=0}}}),oI=typeof navigator=="object"&&/Win/.test(navigator.platform),aI=ll.highest(ee.domEventHandlers({keydown(i,e){let t=e.state.field(fi,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||i.key.length>1||i.ctrlKey&&!(oI&&i.altKey)||i.metaKey)return!1;let n=t.open.options[t.open.selected],s=t.active.find(a=>a.source==n.source),l=n.completion.commitCharacters||s.result.commitCharacters;return l&&l.indexOf(i.key)>-1&&Zb(e,n),!1}})),cI=ee.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),$c={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Vr=_e.define({map(i,e){let t=e.mapPos(i,-1,ti.TrackAfter);return t??void 0}}),ev=new class extends sr{};ev.startSide=1;ev.endSide=-1;const VE=Wt.define({create(){return De.empty},update(i,e){if(i=i.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);i=i.update({filter:n=>n>=t.from&&n<=t.to})}for(let t of e.effects)t.is(Vr)&&(i=i.update({add:[ev.range(t.value,t.value+1)]}));return i}});function uI(){return[fI,VE]}const a0="()[]{}<>";function $E(i){for(let e=0;e<a0.length;e+=2)if(a0.charCodeAt(e)==i)return a0.charAt(e+1);return bb(i<128?i:i+1)}function GE(i,e){return i.languageDataAt("closeBrackets",e)[0]||$c}const hI=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),fI=ee.inputHandler.of((i,e,t,n)=>{if((hI?i.composing:i.compositionStarted)||i.state.readOnly)return!1;let s=i.state.selection.main;if(n.length>2||n.length==2&&Ln(hi(n,0))==1||e!=s.from||t!=s.to)return!1;let l=gI(i.state,n);return l?(i.dispatch(l),!0):!1}),dI=({state:i,dispatch:e})=>{if(i.readOnly)return!1;let n=GE(i,i.selection.main.head).brackets||$c.brackets,s=null,l=i.changeByRange(a=>{if(a.empty){let c=mI(i.doc,a.head);for(let h of n)if(h==c&&Vd(i.doc,a.head)==$E(hi(h,0)))return{changes:{from:a.head-h.length,to:a.head+h.length},range:$.cursor(a.head-h.length)}}return{range:s=a}});return s||e(i.update(l,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},pI=[{key:"Backspace",run:dI}];function gI(i,e){let t=GE(i,i.selection.main.head),n=t.brackets||$c.brackets;for(let s of n){let l=$E(hi(s,0));if(e==s)return l==s?vI(i,s,n.indexOf(s+s+s)>-1,t):yI(i,s,l,t.before||$c.before);if(e==l&&KE(i,i.selection.main.from))return bI(i,s,l)}return null}function KE(i,e){let t=!1;return i.field(VE).between(0,i.doc.length,n=>{n==e&&(t=!0)}),t}function Vd(i,e){let t=i.sliceString(e,e+2);return t.slice(0,Ln(hi(t,0)))}function mI(i,e){let t=i.sliceString(e-2,e);return Ln(hi(t,0))==t.length?t:t.slice(1)}function yI(i,e,t,n){let s=null,l=i.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:t,from:a.to}],effects:Vr.of(a.to+e.length),range:$.range(a.anchor+e.length,a.head+e.length)};let c=Vd(i.doc,a.head);return!c||/\s/.test(c)||n.indexOf(c)>-1?{changes:{insert:e+t,from:a.head},effects:Vr.of(a.head+e.length),range:$.cursor(a.head+e.length)}:{range:s=a}});return s?null:i.update(l,{scrollIntoView:!0,userEvent:"input.type"})}function bI(i,e,t){let n=null,s=i.changeByRange(l=>l.empty&&Vd(i.doc,l.head)==t?{changes:{from:l.head,to:l.head+t.length,insert:t},range:$.cursor(l.head+t.length)}:n={range:l});return n?null:i.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function vI(i,e,t,n){let s=n.stringPrefixes||$c.stringPrefixes,l=null,a=i.changeByRange(c=>{if(!c.empty)return{changes:[{insert:e,from:c.from},{insert:e,from:c.to}],effects:Vr.of(c.to+e.length),range:$.range(c.anchor+e.length,c.head+e.length)};let h=c.head,d=Vd(i.doc,h),p;if(d==e){if(q_(i,h))return{changes:{insert:e+e,from:h},effects:Vr.of(h+e.length),range:$.cursor(h+e.length)};if(KE(i,h)){let b=t&&i.sliceDoc(h,h+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:h,to:h+b.length,insert:b},range:$.cursor(h+b.length)}}}else{if(t&&i.sliceDoc(h-2*e.length,h)==e+e&&(p=V_(i,h-2*e.length,s))>-1&&q_(i,p))return{changes:{insert:e+e+e+e,from:h},effects:Vr.of(h+e.length),range:$.cursor(h+e.length)};if(i.charCategorizer(h)(d)!=rt.Word&&V_(i,h,s)>-1&&!wI(i,h,e,s))return{changes:{insert:e+e,from:h},effects:Vr.of(h+e.length),range:$.cursor(h+e.length)}}return{range:l=c}});return l?null:i.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function q_(i,e){let t=Kt(i).resolveInner(e+1);return t.parent&&t.from==e}function wI(i,e,t,n){let s=Kt(i).resolveInner(e,-1),l=n.reduce((a,c)=>Math.max(a,c.length),0);for(let a=0;a<5;a++){let c=i.sliceDoc(s.from,Math.min(s.to,s.from+t.length+l)),h=c.indexOf(t);if(!h||h>-1&&n.indexOf(c.slice(0,h))>-1){let p=s.firstChild;for(;p&&p.from==s.from&&p.to-p.from>t.length+h;){if(i.sliceDoc(p.to-t.length,p.to)==t)return!1;p=p.firstChild}return!0}let d=s.to==e&&s.parent;if(!d)break;s=d}return!1}function V_(i,e,t){let n=i.charCategorizer(e);if(n(i.sliceDoc(e-1,e))!=rt.Word)return e;for(let s of t){let l=e-s.length;if(i.sliceDoc(l,e)==s&&n(i.sliceDoc(l-1,l))!=rt.Word)return l}return-1}function SI(i={}){return[aI,fi,Nt.of(i),lI,kI,cI]}const WE=[{key:"Ctrl-Space",run:o0},{mac:"Alt-`",run:o0},{mac:"Alt-i",run:o0},{key:"Escape",run:iI},{key:"ArrowDown",run:lf(!0)},{key:"ArrowUp",run:lf(!1)},{key:"PageDown",run:lf(!0,"page")},{key:"PageUp",run:lf(!1,"page")},{key:"Enter",run:tI}],kI=ll.highest(Lb.computeN([Nt],i=>i.facet(Nt).defaultKeymap?[WE]:[]));class $_{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}class Ir{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let s=n.facet(Gc).markerFilter;s&&(e=s(e,n));let l=e.slice().sort((v,w)=>v.from-w.from||v.to-w.to),a=new qn,c=[],h=0,d=n.doc.iter(),p=0,m=n.doc.length;for(let v=0;;){let w=v==l.length?null:l[v];if(!w&&!c.length)break;let k,_;if(c.length)k=h,_=c.reduce((C,N)=>Math.min(C,N.to),w&&w.from>k?w.from:1e8);else{if(k=w.from,k>m)break;_=w.to,c.push(w),v++}for(;v<l.length;){let C=l[v];if(C.from==k&&(C.to>C.from||C.to==k))c.push(C),v++,_=Math.min(C.to,_);else{_=Math.min(C.from,_);break}}_=Math.min(_,m);let O=!1;if(c.some(C=>C.from==k&&(C.to==_||_==m))&&(O=k==_,!O&&_-k<10)){let C=k-(p+d.value.length);C>0&&(d.next(C),p=k);for(let N=k;;){if(N>=_){O=!0;break}if(!d.lineBreak&&p+d.value.length>N)break;N=p+d.value.length,p+=d.value.length,d.next()}}let R=BI(c);if(O)a.add(k,k,ue.widget({widget:new RI(R),diagnostics:c.slice()}));else{let C=c.reduce((N,j)=>j.markClass?N+" "+j.markClass:N,"");a.add(k,_,ue.mark({class:"cm-lintRange cm-lintRange-"+R+C,diagnostics:c.slice(),inclusiveEnd:c.some(N=>N.to>_)}))}if(h=_,h==m)break;for(let C=0;C<c.length;C++)c[C].to<=h&&c.splice(C--,1)}let b=a.finish();return new Ir(b,t,Po(b))}}function Po(i,e=null,t=0){let n=null;return i.between(t,1e9,(s,l,{spec:a})=>{if(!(e&&a.diagnostics.indexOf(e)<0))if(!n)n=new $_(s,l,e||a.diagnostics[0]);else{if(a.diagnostics.indexOf(n.diagnostic)<0)return!1;n=new $_(n.from,l,n.diagnostic)}}),n}function xI(i,e){let t=e.pos,n=e.end||t,s=i.state.facet(Gc).hideOn(i,t,n);if(s!=null)return s;let l=i.startState.doc.lineAt(e.pos);return!!(i.effects.some(a=>a.is(YE))||i.changes.touchesRange(l.from,Math.max(l.to,n)))}function _I(i,e){return i.field(zi,!1)?e:e.concat(_e.appendConfig.of(UI))}const YE=_e.define(),tv=_e.define(),FE=_e.define(),zi=Wt.define({create(){return new Ir(ue.none,null,null)},update(i,e){if(e.docChanged&&i.diagnostics.size){let t=i.diagnostics.map(e.changes),n=null,s=i.panel;if(i.selected){let l=e.changes.mapPos(i.selected.from,1);n=Po(t,i.selected.diagnostic,l)||Po(t,null,l)}!t.size&&s&&e.state.facet(Gc).autoPanel&&(s=null),i=new Ir(t,s,n)}for(let t of e.effects)if(t.is(YE)){let n=e.state.facet(Gc).autoPanel?t.value.length?Kc.open:null:i.panel;i=Ir.init(t.value,n,e.state)}else t.is(tv)?i=new Ir(i.diagnostics,t.value?Kc.open:null,i.selected):t.is(FE)&&(i=new Ir(i.diagnostics,i.panel,t.value));return i},provide:i=>[zc.from(i,e=>e.panel),ee.decorations.from(i,e=>e.diagnostics)]}),OI=ue.mark({class:"cm-lintRange cm-lintRange-active"});function AI(i,e,t){let{diagnostics:n}=i.state.field(zi),s,l=-1,a=-1;n.between(e-(t<0?1:0),e+(t>0?1:0),(h,d,{spec:p})=>{if(e>=h&&e<=d&&(h==d||(e>h||t>0)&&(e<d||t<0)))return s=p.diagnostics,l=h,a=d,!1});let c=i.state.facet(Gc).tooltipFilter;return s&&c&&(s=c(s,i.state)),s?{pos:l,end:a,above:i.state.doc.lineAt(l).to<a,create(){return{dom:CI(i,s)}}}:null}function CI(i,e){return Ye("ul",{class:"cm-tooltip-lint"},e.map(t=>QE(i,t,!1)))}const TI=i=>{let e=i.state.field(zi,!1);(!e||!e.panel)&&i.dispatch({effects:_I(i.state,[tv.of(!0)])});let t=jb(i,Kc.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},G_=i=>{let e=i.state.field(zi,!1);return!e||!e.panel?!1:(i.dispatch({effects:tv.of(!1)}),!0)},EI=i=>{let e=i.state.field(zi,!1);if(!e)return!1;let t=i.state.selection.main,n=e.diagnostics.iter(t.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==t.from&&n.to==t.to)?!1:(i.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},DI=[{key:"Mod-Shift-m",run:TI,preventDefault:!0},{key:"F8",run:EI}],Gc=te.define({combine(i){return{sources:i.map(e=>e.source).filter(e=>e!=null),...Gn(i.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:K_,tooltipFilter:K_,needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t,hideOn:(e,t)=>e?t?(n,s,l)=>e(n,s,l)||t(n,s,l):e:t,autoPanel:(e,t)=>e||t})}}});function K_(i,e){return i?e?(t,n)=>e(i(t,n),n):i:e}function XE(i){let e=[];if(i)e:for(let{name:t}of i){for(let n=0;n<t.length;n++){let s=t[n];if(/[a-zA-Z]/.test(s)&&!e.some(l=>l.toLowerCase()==s.toLowerCase())){e.push(s);continue e}}e.push("")}return e}function QE(i,e,t){var n;let s=t?XE(e.actions):[];return Ye("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Ye("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(i):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((l,a)=>{let c=!1,h=v=>{if(v.preventDefault(),c)return;c=!0;let w=Po(i.state.field(zi).diagnostics,e);w&&l.apply(i,w.from,w.to)},{name:d}=l,p=s[a]?d.indexOf(s[a]):-1,m=p<0?d:[d.slice(0,p),Ye("u",d.slice(p,p+1)),d.slice(p+1)],b=l.markClass?" "+l.markClass:"";return Ye("button",{type:"button",class:"cm-diagnosticAction"+b,onclick:h,onmousedown:h,"aria-label":` Action: ${d}${p<0?"":` (access key "${s[a]})"`}.`},m)}),e.source&&Ye("div",{class:"cm-diagnosticSource"},e.source))}class RI extends Kn{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Ye("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class W_{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=QE(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Kc{constructor(e){this.view=e,this.items=[];let t=s=>{if(!(s.ctrlKey||s.altKey||s.metaKey)){if(s.keyCode==27)G_(this.view),this.view.focus();else if(s.keyCode==38||s.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(s.keyCode==40||s.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(s.keyCode==36)this.moveSelection(0);else if(s.keyCode==35)this.moveSelection(this.items.length-1);else if(s.keyCode==13)this.view.focus();else if(s.keyCode>=65&&s.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:l}=this.items[this.selectedIndex],a=XE(l.actions);for(let c=0;c<a.length;c++)if(a[c].toUpperCase().charCodeAt(0)==s.keyCode){let h=Po(this.view.state.field(zi).diagnostics,l);h&&l.actions[c].apply(e,h.from,h.to)}}else return;s.preventDefault()}},n=s=>{for(let l=0;l<this.items.length;l++)this.items[l].dom.contains(s.target)&&this.moveSelection(l)};this.list=Ye("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:n}),this.dom=Ye("div",{class:"cm-panel-lint"},this.list,Ye("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>G_(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(zi).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(zi),n=0,s=!1,l=null,a=new Set;for(e.between(0,this.view.state.doc.length,(c,h,{spec:d})=>{for(let p of d.diagnostics){if(a.has(p))continue;a.add(p);let m=-1,b;for(let v=n;v<this.items.length;v++)if(this.items[v].diagnostic==p){m=v;break}m<0?(b=new W_(this.view,p),this.items.splice(n,0,b),s=!0):(b=this.items[m],m>n&&(this.items.splice(n,m-n),s=!0)),t&&b.diagnostic==t.diagnostic?b.dom.hasAttribute("aria-selected")||(b.dom.setAttribute("aria-selected","true"),l=b):b.dom.hasAttribute("aria-selected")&&b.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();this.items.length==0&&(this.items.push(new W_(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),l?(this.list.setAttribute("aria-activedescendant",l.id),this.view.requestMeasure({key:this,read:()=>({sel:l.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:c,panel:h})=>{let d=h.height/this.list.offsetHeight;c.top<h.top?this.list.scrollTop-=(h.top-c.top)/d:c.bottom>h.bottom&&(this.list.scrollTop+=(c.bottom-h.bottom)/d)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let e=this.list.firstChild;function t(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(zi),n=Po(t.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:FE.of(n)})}static open(e){return new Kc(e)}}function MI(i,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(i)}</svg>')`}function of(i){return MI(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${i}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const NI=ee.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:of("#d11")},".cm-lintRange-warning":{backgroundImage:of("orange")},".cm-lintRange-info":{backgroundImage:of("#999")},".cm-lintRange-hint":{backgroundImage:of("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function LI(i){return i=="error"?4:i=="warning"?3:i=="info"?2:1}function BI(i){let e="hint",t=1;for(let n of i){let s=LI(n.severity);s>t&&(t=s,e=n.severity)}return e}const UI=[zi,ee.decorations.compute([zi],i=>{let{selected:e,panel:t}=i.field(zi);return!e||!t||e.from==e.to?ue.none:ue.set([OI.range(e.from,e.to)])}),k8(AI,{hideOn:xI}),NI],jI=[B8(),z8(),Z4(),n5(),Ez(),q4(),W4(),je.allowMultipleSelections.of(!0),gz(),Rz(Lz,{fallback:!0}),Hz(),uI(),SI(),h8(),p8(),r8(),f6(),Lb.of([...pI,...o6,...N6,...f5,...Oz,...WE,...DI])];class iv{constructor(e,t){this.yanchor=e,this.yhead=t}toJSON(){return{yanchor:tx(this.yanchor),yhead:tx(this.yhead)}}static fromJSON(e){return new iv(Tc(e.yanchor),Tc(e.yhead))}}class zI{constructor(e,t){this.ytext=e,this.awareness=t,this.undoManager=new PA(e)}toYPos(e,t=0){return V0(this.ytext,e,t)}fromYPos(e){const t=$0(Tc(e),this.ytext.doc);if(t==null||t.type!==this.ytext)throw new Error("[y-codemirror] The position you want to retrieve was created by a different document");return{pos:t.index,assoc:t.assoc}}toYRange(e){const t=e.assoc,n=this.toYPos(e.anchor,t),s=this.toYPos(e.head,t);return new iv(n,s)}fromYRange(e){const t=this.fromYPos(e.yanchor),n=this.fromYPos(e.yhead);return t.pos===n.pos?$.cursor(n.pos,n.assoc):$.range(t.pos,n.pos)}}const $d=te.define({combine(i){return i[i.length-1]}}),Hy=Sn.define();class II{constructor(e){this.view=e,this.conf=e.state.facet($d),this._observer=(t,n)=>{if(n.origin!==this.conf){const s=t.delta,l=[];let a=0;for(let c=0;c<s.length;c++){const h=s[c];h.insert!=null?l.push({from:a,to:a,insert:h.insert}):h.delete!=null?(l.push({from:a,to:a+h.delete,insert:""}),a+=h.delete):a+=h.retain}e.dispatch({changes:l,annotations:[Hy.of(this.conf)]})}},this._ytext=this.conf.ytext,this._ytext.observe(this._observer)}update(e){if(!e.docChanged||e.transactions.length>0&&e.transactions[0].annotation(Hy)===this.conf)return;const t=this.conf.ytext;t.doc.transact(()=>{let n=0;e.changes.iterChanges((s,l,a,c,h)=>{const d=h.sliceString(0,h.length,`
`);s!==l&&t.delete(s+n,l-s),d.length>0&&t.insert(s+n,d),n+=d.length-(l-s)})},this.conf)}destroy(){this._ytext.unobserve(this._observer)}}const PI=lt.fromClass(II),HI=ee.baseTheme({".cm-ySelection":{},".cm-yLineSelection":{padding:0,margin:"0px 2px 0px 4px"},".cm-ySelectionCaret":{position:"relative",borderLeft:"1px solid black",borderRight:"1px solid black",marginLeft:"-1px",marginRight:"-1px",boxSizing:"border-box",display:"inline"},".cm-ySelectionCaretDot":{borderRadius:"50%",position:"absolute",width:".4em",height:".4em",top:"-.2em",left:"-.2em",backgroundColor:"inherit",transition:"transform .3s ease-in-out",boxSizing:"border-box"},".cm-ySelectionCaret:hover > .cm-ySelectionCaretDot":{transformOrigin:"bottom center",transform:"scale(0)"},".cm-ySelectionInfo":{position:"absolute",top:"-1.05em",left:"-1px",fontSize:".75em",fontFamily:"serif",fontStyle:"normal",fontWeight:"normal",lineHeight:"normal",userSelect:"none",color:"white",paddingLeft:"2px",paddingRight:"2px",zIndex:101,transition:"opacity .3s ease-in-out",backgroundColor:"inherit",opacity:0,transitionDelay:"0s",whiteSpace:"nowrap"},".cm-ySelectionCaret:hover > .cm-ySelectionInfo":{opacity:1,transitionDelay:"0s"}}),qI=Sn.define();class VI extends Kn{constructor(e,t){super(),this.color=e,this.name=t}toDOM(){return Dm("span",[Bi("class","cm-ySelectionCaret"),Bi("style",`background-color: ${this.color}; border-color: ${this.color}`)],[Lh(""),Dm("div",[Bi("class","cm-ySelectionCaretDot")]),Lh(""),Dm("div",[Bi("class","cm-ySelectionInfo")],[Lh(this.name)]),Lh("")])}eq(e){return e.color===this.color}compare(e){return e.color===this.color}updateDOM(){return!1}get estimatedHeight(){return-1}ignoreEvent(){return!0}}class $I{constructor(e){this.conf=e.state.facet($d),this._listener=({added:t,updated:n,removed:s},l,a)=>{t.concat(n).concat(s).findIndex(h=>h!==this.conf.awareness.doc.clientID)>=0&&e.dispatch({annotations:[qI.of([])]})},this._awareness=this.conf.awareness,this._awareness.on("change",this._listener),this.decorations=De.of([])}destroy(){this._awareness.off("change",this._listener)}update(e){const t=this.conf.ytext,n=t.doc,s=this.conf.awareness,l=[],a=this.conf.awareness.getLocalState();if(a!=null){const c=e.view.hasFocus&&e.view.dom.ownerDocument.hasFocus(),h=c?e.state.selection.main:null,d=a.cursor==null?null:Tc(a.cursor.anchor),p=a.cursor==null?null:Tc(a.cursor.head);if(h!=null){const m=V0(t,h.anchor),b=V0(t,h.head);(a.cursor==null||!ix(d,m)||!ix(p,b))&&s.setLocalStateField("cursor",{anchor:m,head:b})}else a.cursor!=null&&c&&s.setLocalStateField("cursor",null)}s.getStates().forEach((c,h)=>{if(h===s.doc.clientID)return;const d=c.cursor;if(d==null||d.anchor==null||d.head==null)return;const p=$0(d.anchor,n),m=$0(d.head,n);if(p==null||m==null||p.type!==t||m.type!==t)return;const{color:b="#30bced",name:v="Anonymous"}=c.user||{},w=c.user&&c.user.colorLight||b+"33",k=Wy(p.index,m.index),_=ur(p.index,m.index),O=e.view.state.doc.lineAt(k),R=e.view.state.doc.lineAt(_);if(O.number===R.number)l.push({from:k,to:_,value:ue.mark({attributes:{style:`background-color: ${w}`},class:"cm-ySelection"})});else{l.push({from:k,to:O.from+O.length,value:ue.mark({attributes:{style:`background-color: ${w}`},class:"cm-ySelection"})}),l.push({from:R.from,to:_,value:ue.mark({attributes:{style:`background-color: ${w}`},class:"cm-ySelection"})});for(let C=O.number+1;C<R.number;C++){const N=e.view.state.doc.line(C).from;l.push({from:N,to:N,value:ue.line({attributes:{style:`background-color: ${w}`,class:"cm-yLineSelection"}})})}}l.push({from:m.index,to:m.index,value:ue.widget({side:m.index-p.index>0?-1:1,block:!1,widget:new VI(b,v)})})}),this.decorations=ue.set(l,!0)}}const GI=lt.fromClass($I,{decorations:i=>i.decorations}),KI=()=>{let i=!0;return(e,t)=>{if(i){i=!1;try{e()}finally{i=!0}}else t!==void 0&&t()}};class WI{constructor(e){this.undoManager=e}addTrackedOrigin(e){this.undoManager.addTrackedOrigin(e)}removeTrackedOrigin(e){this.undoManager.removeTrackedOrigin(e)}undo(){return this.undoManager.undo()!=null}redo(){return this.undoManager.redo()!=null}}const Gd=te.define({combine(i){return i[i.length-1]}});class YI{constructor(e){this.view=e,this.conf=e.state.facet(Gd),this._undoManager=this.conf.undoManager,this.syncConf=e.state.facet($d),this._beforeChangeSelection=null,this._mux=KI(),this._onStackItemAdded=({stackItem:t,changedParentTypes:n})=>{n.has(this.syncConf.ytext)&&this._beforeChangeSelection&&!t.meta.has(this)&&t.meta.set(this,this._beforeChangeSelection)},this._onStackItemPopped=({stackItem:t})=>{const n=t.meta.get(this);if(n){const s=this.syncConf.fromYRange(n);e.dispatch(e.state.update({selection:s,effects:[ee.scrollIntoView(s)]})),this._storeSelection()}},this._storeSelection=()=>{this._beforeChangeSelection=this.syncConf.toYRange(this.view.state.selection.main)},this._undoManager.on("stack-item-added",this._onStackItemAdded),this._undoManager.on("stack-item-popped",this._onStackItemPopped),this._undoManager.addTrackedOrigin(this.syncConf)}update(e){e.selectionSet&&(e.transactions.length===0||e.transactions[0].annotation(Hy)!==this.syncConf)&&this._storeSelection()}destroy(){this._undoManager.off("stack-item-added",this._onStackItemAdded),this._undoManager.off("stack-item-popped",this._onStackItemPopped),this._undoManager.removeTrackedOrigin(this.syncConf)}}const FI=lt.fromClass(YI),XI=({state:i,dispatch:e})=>i.facet(Gd).undo()||!0,QI=({state:i,dispatch:e})=>i.facet(Gd).redo()||!0,JI=(i,e,{undoManager:t=new PA(i)}={})=>{const n=new zI(i,e),s=[$d.of(n),PI];return e&&s.push(HI,GI),t!==!1&&s.push(Gd.of(new WI(t)),FI,ee.domEventHandlers({beforeinput(l,a){return l.inputType==="historyUndo"?XI(a):l.inputType==="historyRedo"?QI(a):!1}})),s},c0=3e4;class ZI extends gL{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const t=xc();this.getLocalState()!==null&&c0/2<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const n=[];this.meta.forEach((s,l)=>{l!==this.clientID&&c0<=t-s.lastUpdated&&this.states.has(l)&&n.push(l)}),n.length>0&&eP(this,n,"timeout")},vn(c0/10)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,n=this.meta.get(t),s=n===void 0?0:n.clock+1,l=this.states.get(t);e===null?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:s,lastUpdated:xc()});const a=[],c=[],h=[],d=[];e===null?d.push(t):l==null?e!=null&&a.push(t):(c.push(t),fo(l,e)||h.push(t)),(a.length>0||h.length>0||d.length>0)&&this.emit("change",[{added:a,updated:h,removed:d},"local"]),this.emit("update",[{added:a,updated:c,removed:d},"local"])}setLocalStateField(e,t){const n=this.getLocalState();n!==null&&this.setLocalState({...n,[e]:t})}getStates(){return this.states}}const eP=(i,e,t)=>{const n=[];for(let s=0;s<e.length;s++){const l=e[s];if(i.states.has(l)){if(i.states.delete(l),l===i.clientID){const a=i.meta.get(l);i.meta.set(l,{clock:a.clock+1,lastUpdated:xc()})}n.push(l)}}n.length>0&&(i.emit("change",[{added:[],updated:[],removed:n},t]),i.emit("update",[{added:[],updated:[],removed:n},t]))},tP=(i,e,t=i.states)=>{const n=e.length,s=Fc();Ee(s,n);for(let l=0;l<n;l++){const a=e[l],c=t.get(a)||null,h=i.meta.get(a).clock;Ee(s,a),Ee(s,h),Gr(s,JSON.stringify(c))}return gn(s)},iP=(i,e,t)=>{const n=nl(e),s=xc(),l=[],a=[],c=[],h=[],d=Ae(n);for(let p=0;p<d;p++){const m=Ae(n);let b=Ae(n);const v=JSON.parse(Kr(n)),w=i.meta.get(m),k=i.states.get(m),_=w===void 0?0:w.clock;(_<b||_===b&&v===null&&i.states.has(m))&&(v===null?m===i.clientID&&i.getLocalState()!=null?b++:i.states.delete(m):i.states.set(m,v),i.meta.set(m,{clock:b,lastUpdated:s}),w===void 0&&v!==null?l.push(m):w!==void 0&&v===null?h.push(m):v!==null&&(fo(v,k)||c.push(m),a.push(m)))}(l.length>0||c.length>0||h.length>0)&&i.emit("change",[{added:l,updated:c,removed:h},t]),(l.length>0||a.length>0||h.length>0)&&i.emit("update",[{added:l,updated:a,removed:h},t])},nP=i=>{if(typeof Buffer<"u")return Buffer.from(i).toString("base64");const e=Array.from(i,t=>String.fromCodePoint(t)).join("");return btoa(e)},u0=i=>{if(typeof Buffer<"u")return new Uint8Array(Buffer.from(i,"base64"));const e=atob(i);return Uint8Array.from(e,t=>t.codePointAt(0))};class sP{doc;channel;awareness;_isConnected=!1;_resyncInterval=null;constructor(e,t,n){this.doc=e,this.awareness=new ZI(e),this.channel=t.channel(n),this.channel.on("broadcast",{event:"awareness-update"},({payload:s})=>{const l=u0(s);iP(this.awareness,l,"remote")}).on("broadcast",{event:"sync-step-1"},({payload:s})=>{const l=u0(s),a=DA(e,l);a.length>0&&this.broadcast("sync-step-2",a)}).on("broadcast",{event:"sync-step-2"},({payload:s})=>{const l=u0(s);EA(e,l,"remote")}).subscribe(s=>{s==="SUBSCRIBED"?(this._isConnected=!0,this.initSync()):this._isConnected=!1}),e.on("update",(s,l)=>{l!=="remote"&&l!=="db-load"&&this._isConnected&&this.broadcast("sync-step-2",s)}),this.awareness.on("update",({added:s,updated:l,removed:a})=>{if(!this._isConnected)return;const c=s.concat(l).concat(a),h=tP(this.awareness,c);this.broadcast("awareness-update",h)}),this._resyncInterval=setInterval(()=>{this._isConnected&&this.awareness.getStates().size>0&&this.initSync()},3e4)}initSync(){const e=O3(this.doc);this.broadcast("sync-step-1",e)}broadcast(e,t){if(!this._isConnected)return;const n=nP(t);this.channel.send({type:"broadcast",event:e,payload:n})}destroy(){this._resyncInterval&&clearInterval(this._resyncInterval),this.channel.unsubscribe(),this.awareness.destroy()}}var h0,Y_;function JE(){if(Y_)return h0;Y_=1;function i(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return h0=i,h0}var f0,F_;function rP(){if(F_)return f0;F_=1;var i=typeof Ah=="object"&&Ah&&Ah.Object===Object&&Ah;return f0=i,f0}var d0,X_;function ZE(){if(X_)return d0;X_=1;var i=rP(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=i||e||Function("return this")();return d0=t,d0}var p0,Q_;function lP(){if(Q_)return p0;Q_=1;var i=ZE(),e=function(){return i.Date.now()};return p0=e,p0}var g0,J_;function oP(){if(J_)return g0;J_=1;var i=/\s/;function e(t){for(var n=t.length;n--&&i.test(t.charAt(n)););return n}return g0=e,g0}var m0,Z_;function aP(){if(Z_)return m0;Z_=1;var i=oP(),e=/^\s+/;function t(n){return n&&n.slice(0,i(n)+1).replace(e,"")}return m0=t,m0}var y0,eO;function e2(){if(eO)return y0;eO=1;var i=ZE(),e=i.Symbol;return y0=e,y0}var b0,tO;function cP(){if(tO)return b0;tO=1;var i=e2(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,s=i?i.toStringTag:void 0;function l(a){var c=t.call(a,s),h=a[s];try{a[s]=void 0;var d=!0}catch{}var p=n.call(a);return d&&(c?a[s]=h:delete a[s]),p}return b0=l,b0}var v0,iO;function uP(){if(iO)return v0;iO=1;var i=Object.prototype,e=i.toString;function t(n){return e.call(n)}return v0=t,v0}var w0,nO;function hP(){if(nO)return w0;nO=1;var i=e2(),e=cP(),t=uP(),n="[object Null]",s="[object Undefined]",l=i?i.toStringTag:void 0;function a(c){return c==null?c===void 0?s:n:l&&l in Object(c)?e(c):t(c)}return w0=a,w0}var S0,sO;function fP(){if(sO)return S0;sO=1;function i(e){return e!=null&&typeof e=="object"}return S0=i,S0}var k0,rO;function dP(){if(rO)return k0;rO=1;var i=hP(),e=fP(),t="[object Symbol]";function n(s){return typeof s=="symbol"||e(s)&&i(s)==t}return k0=n,k0}var x0,lO;function pP(){if(lO)return x0;lO=1;var i=aP(),e=JE(),t=dP(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt;function h(d){if(typeof d=="number")return d;if(t(d))return n;if(e(d)){var p=typeof d.valueOf=="function"?d.valueOf():d;d=e(p)?p+"":p}if(typeof d!="string")return d===0?d:+d;d=i(d);var m=l.test(d);return m||a.test(d)?c(d.slice(2),m?2:8):s.test(d)?n:+d}return x0=h,x0}var _0,oO;function gP(){if(oO)return _0;oO=1;var i=JE(),e=lP(),t=pP(),n="Expected a function",s=Math.max,l=Math.min;function a(c,h,d){var p,m,b,v,w,k,_=0,O=!1,R=!1,C=!0;if(typeof c!="function")throw new TypeError(n);h=t(h)||0,i(d)&&(O=!!d.leading,R="maxWait"in d,b=R?s(t(d.maxWait)||0,h):b,C="trailing"in d?!!d.trailing:C);function N(F){var re=p,be=m;return p=m=void 0,_=F,v=c.apply(be,re),v}function j(F){return _=F,w=setTimeout(W,h),O?N(F):v}function H(F){var re=F-k,be=F-_,z=h-re;return R?l(z,b-be):z}function D(F){var re=F-k,be=F-_;return k===void 0||re>=h||re<0||R&&be>=b}function W(){var F=e();if(D(F))return se(F);w=setTimeout(W,H(F))}function se(F){return w=void 0,C&&p?N(F):(p=m=void 0,v)}function Ce(){w!==void 0&&clearTimeout(w),_=0,p=k=m=w=void 0}function fe(){return w===void 0?v:se(e())}function J(){var F=e(),re=D(F);if(p=arguments,m=this,k=F,re){if(w===void 0)return j(k);if(R)return clearTimeout(w),w=setTimeout(W,h),N(k)}return w===void 0&&(w=setTimeout(W,h)),v}return J.cancel=Ce,J.flush=fe,J}return _0=a,_0}var mP=gP();const yP=_R(mP),bP=(i,e)=>{const[t,n]=ke.useState("idle"),s=ke.useRef(!1),l=d=>{const p=d.startsWith("\\x")?d.slice(2):d;if(!/^[0-9a-fA-F]*$/.test(p))return new Uint8Array([]);const m=p.match(/.{1,2}/g);return m?new Uint8Array(m.map(b=>parseInt(b,16))):new Uint8Array([])},a=ke.useCallback(async d=>{n("loading"),s.current=!1;try{const{data:p,error:m}=await i.from("documents").select("content").eq("id",d).maybeSingle();if(m)throw m;if(p?.content){const b=typeof p.content=="string"?p.content:"",v=l(b);v.length>0&&EA(e,v,"db-load")}s.current=!0,n("saved")}catch(p){console.error("Failed to load document:",p),n("error")}},[i,e]),c=ke.useMemo(()=>yP(async d=>{if(s.current){n("saving");try{const p=DA(e),m=Array.from(p).map(v=>v.toString(16).padStart(2,"0")).join(""),{error:b}=await i.rpc("update_document_content",{p_document_id:d,p_content_hex:m});if(b)throw b;n("saved")}catch(p){console.error("Failed to save document:",p),n("error")}}},2e3),[i,e]),h=ke.useCallback(d=>{c(d)},[c]);return{status:t,loadDocument:a,saveDocument:h,cancelSave:c.cancel}};var aO={};class ud{constructor(e,t,n,s,l,a,c,h,d,p=0,m){this.p=e,this.stack=t,this.state=n,this.reducePos=s,this.pos=l,this.score=a,this.buffer=c,this.bufferBase=h,this.curContext=d,this.lookAhead=p,this.parent=m}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let s=e.parser.context;return new ud(e,[],t,n,n,0,[],0,s?new cO(s,s.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,s=e&65535,{parser:l}=this.p,a=this.reducePos<this.pos-25&&this.setLookAhead(this.pos),c=l.dynamicPrecedence(s);if(c&&(this.score+=c),n==0){this.pushState(l.getGoto(this.state,s,!0),this.reducePos),s<l.minRepeatTerm&&this.storeNode(s,this.reducePos,this.reducePos,a?8:4,!0),this.reduceContext(s,this.reducePos);return}let h=this.stack.length-(n-1)*3-(e&262144?6:0),d=h?this.stack[h-2]:this.p.ranges[0].from,p=this.reducePos-d;p>=2e3&&!(!((t=this.p.parser.nodeSet.types[s])===null||t===void 0)&&t.isAnonymous)&&(d==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=p):this.p.lastBigReductionSize<p&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=d,this.p.lastBigReductionSize=p));let m=h?this.stack[h-1]:0,b=this.bufferBase+this.buffer.length-m;if(s<l.minRepeatTerm||e&131072){let v=l.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(s,d,v,b+4,!0)}if(e&262144)this.state=this.stack[h];else{let v=this.stack[h-3];this.state=l.getGoto(v,s,!0)}for(;this.stack.length>h;)this.stack.pop();this.reduceContext(s,d)}storeNode(e,t,n,s=4,l=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,c=this.buffer.length;if(c==0&&a.parent&&(c=a.bufferBase-a.parent.bufferBase,a=a.parent),c>0&&a.buffer[c-4]==0&&a.buffer[c-1]>-1){if(t==n)return;if(a.buffer[c-2]>=t){a.buffer[c-2]=n;return}}}if(!l||this.pos==n)this.buffer.push(e,t,n,s);else{let a=this.buffer.length;if(a>0&&(this.buffer[a-4]!=0||this.buffer[a-1]<0)){let c=!1;for(let h=a;h>0&&this.buffer[h-2]>n;h-=4)if(this.buffer[h-1]>=0){c=!0;break}if(c)for(;a>0&&this.buffer[a-2]>n;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,s>4&&(s-=4)}this.buffer[a]=e,this.buffer[a+1]=t,this.buffer[a+2]=n,this.buffer[a+3]=s}}shift(e,t,n,s){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let l=e,{parser:a}=this.p;this.pos=s;let c=a.stateFlag(l,1);!c&&(s>n||t<=a.maxNode)&&(this.reducePos=s),this.pushState(l,c?n:Math.min(n,this.reducePos)),this.shiftContext(t,n),t<=a.maxNode&&this.buffer.push(t,n,s,4)}else this.pos=s,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,s,4)}apply(e,t,n,s){e&65536?this.reduce(e):this.shift(e,t,n,s)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let s=this.pos;this.reducePos=this.pos=s+e.length,this.pushState(t,s),this.buffer.push(n,s,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),s=e.bufferBase+t;for(;e&&s==e.bufferBase;)e=e.parent;return new ud(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,s,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new vP(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(n==0)return!1;if((n&65536)==0)return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let s=[];for(let l=0,a;l<t.length;l+=2)(a=t[l+1])!=this.state&&this.p.parser.hasAction(a,e)&&s.push(t[l],a);if(this.stack.length<120)for(let l=0;s.length<8&&l<t.length;l+=2){let a=t[l+1];s.some((c,h)=>h&1&&c==a)||s.push(t[l],a)}t=s}let n=[];for(let s=0;s<t.length&&n.length<4;s+=2){let l=t[s+1];if(l==this.state)continue;let a=this.split();a.pushState(l,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(t[s],this.pos),a.reducePos=this.pos,a.score-=200,n.push(a)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if((t&65536)==0)return!1;if(!e.validAction(this.state,t)){let n=t>>19,s=t&65535,l=this.stack.length-n*3;if(l<0||e.getGoto(this.stack[l],s,!1)<0){let a=this.findForcedReduction();if(a==null)return!1;t=a}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(s,l)=>{if(!t.includes(s))return t.push(s),e.allActions(s,a=>{if(!(a&393216))if(a&65536){let c=(a>>19)-l;if(c>1){let h=a&65535,d=this.stack.length-c*3;if(d>=0&&e.getGoto(this.stack[d],h,!1)>=0)return c<<19|65536|h}}else{let c=n(a,l+1);if(c!=null)return c}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new cO(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){return e<=this.lookAhead?!1:(this.emitLookAhead(),this.lookAhead=e,!0)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class cO{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class vP{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let s=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=s}}class hd{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new hd(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new hd(this.stack,this.pos,this.index)}}function af(i,e=Uint16Array){if(typeof i!="string")return i;let t=null;for(let n=0,s=0;n<i.length;){let l=0;for(;;){let a=i.charCodeAt(n++),c=!1;if(a==126){l=65535;break}a>=92&&a--,a>=34&&a--;let h=a-32;if(h>=46&&(h-=46,c=!0),l+=h,c)break;l*=46}t?t[s++]=l:t=new e(l)}return t}class Sf{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const uO=new Sf;class wP{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=uO,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,s=this.rangeIndex,l=this.pos+e;for(;l<n.from;){if(!s)return null;let a=this.ranges[--s];l-=n.from-a.to,n=a}for(;t<0?l>n.to:l>=n.to;){if(s==this.ranges.length-1)return null;let a=this.ranges[++s];l+=a.from-n.to,n=a}return l}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,n,s;if(t>=0&&t<this.chunk.length)n=this.pos+e,s=this.chunk.charCodeAt(t);else{let l=this.resolveOffset(e,1);if(l==null)return-1;if(n=l,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)s=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let a=this.rangeIndex,c=this.range;for(;c.to<=n;)c=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>c.to&&(this.chunk2=this.chunk2.slice(0,c.to-n)),s=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),s}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=uO,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let s of this.ranges){if(s.from>=t)break;s.to>e&&(n+=this.input.read(Math.max(s.from,e),Math.min(s.to,t)))}return n}}class _o{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;kP(this.data,e,t,this.id,n.data,n.tokenPrecTable)}}_o.prototype.contextual=_o.prototype.fallback=_o.prototype.extend=!1;_o.prototype.fallback=_o.prototype.extend=!1;class SP{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function kP(i,e,t,n,s,l){let a=0,c=1<<n,{dialect:h}=t.p.parser;e:for(;(c&i[a])!=0;){let d=i[a+1];for(let v=a+3;v<d;v+=2)if((i[v+1]&c)>0){let w=i[v];if(h.allows(w)&&(e.token.value==-1||e.token.value==w||xP(w,e.token.value,s,l))){e.acceptToken(w);break}}let p=e.next,m=0,b=i[a+2];if(e.next<0&&b>m&&i[d+b*3-3]==65535){a=i[d+b*3-1];continue e}for(;m<b;){let v=m+b>>1,w=d+v+(v<<1),k=i[w],_=i[w+1]||65536;if(p<k)b=v;else if(p>=_)m=v+1;else{a=i[w+2],e.advance();continue e}}break}}function hO(i,e,t){for(let n=e,s;(s=i[n])!=65535;n++)if(s==t)return n-e;return-1}function xP(i,e,t,n){let s=hO(t,n,e);return s<0||hO(t,n,i)<s}const Di=typeof process<"u"&&aO&&/\bparse\b/.test(aO.LOG);let O0=null;function fO(i,e,t){let n=i.cursor(ut.IncludeAnonymous);for(n.moveTo(e);;)if(!(t<0?n.childBefore(e):n.childAfter(e)))for(;;){if((t<0?n.to<e:n.from>e)&&!n.type.isError)return t<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(i.length,Math.max(n.from+1,e+25));if(t<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return t<0?0:i.length}}class _P{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?fO(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?fO(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],s=this.index[t];if(s==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let l=n.children[s],a=this.start[t]+n.positions[s];if(a>e)return this.nextStart=a,null;if(l instanceof mt){if(a==e){if(a<this.safeFrom)return null;let c=a+l.length;if(c<=this.safeTo){let h=l.prop(Re.lookAhead);if(!h||c+h<this.fragment.to)return l}}this.index[t]++,a+l.length>=Math.max(this.safeFrom,e)&&(this.trees.push(l),this.start.push(a),this.index.push(0))}else this.index[t]++,this.nextStart=a+l.length}}}class OP{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new Sf)}getActions(e){let t=0,n=null,{parser:s}=e.p,{tokenizers:l}=s,a=s.stateSlot(e.state,3),c=e.curContext?e.curContext.hash:0,h=0;for(let d=0;d<l.length;d++){if((1<<d&a)==0)continue;let p=l[d],m=this.tokens[d];if(!(n&&!p.fallback)&&((p.contextual||m.start!=e.pos||m.mask!=a||m.context!=c)&&(this.updateCachedToken(m,p,e),m.mask=a,m.context=c),m.lookAhead>m.end+25&&(h=Math.max(m.lookAhead,h)),m.value!=0)){let b=t;if(m.extended>-1&&(t=this.addActions(e,m.extended,m.end,t)),t=this.addActions(e,m.value,m.end,t),!p.extend&&(n=m,t>b))break}}for(;this.actions.length>t;)this.actions.pop();return h&&e.setLookAhead(h),!n&&e.pos==this.stream.end&&(n=new Sf,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new Sf,{pos:n,p:s}=e;return t.start=n,t.end=Math.min(n+1,s.stream.end),t.value=n==s.stream.end?s.parser.eofTerm:0,t}updateCachedToken(e,t,n){let s=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(s,e),n),e.value>-1){let{parser:l}=n.p;for(let a=0;a<l.specialized.length;a++)if(l.specialized[a]==e.value){let c=l.specializers[a](this.stream.read(e.start,e.end),n);if(c>=0&&n.p.parser.dialect.allows(c>>1)){(c&1)==0?e.value=c>>1:e.extended=c>>1;break}}}else e.value=0,e.end=this.stream.clipPos(s+1)}putAction(e,t,n,s){for(let l=0;l<s;l+=3)if(this.actions[l]==e)return s;return this.actions[s++]=e,this.actions[s++]=t,this.actions[s++]=n,s}addActions(e,t,n,s){let{state:l}=e,{parser:a}=e.p,{data:c}=a;for(let h=0;h<2;h++)for(let d=a.stateSlot(l,h?2:1);;d+=3){if(c[d]==65535)if(c[d+1]==1)d=fs(c,d+2);else{s==0&&c[d+1]==2&&(s=this.putAction(fs(c,d+2),t,n,s));break}c[d]==t&&(s=this.putAction(fs(c,d+1),t,n,s))}return s}}class AP{constructor(e,t,n,s){this.parser=e,this.input=t,this.ranges=s,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new wP(t,s),this.tokens=new OP(e,this.stream),this.topTerm=e.top[1];let{from:l}=s[0];this.stacks=[ud.start(this,e.top[0],l)],this.fragments=n.length&&this.stream.end-l>e.bufferLength*4?new _P(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,n=this.stacks=[],s,l;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let c=e[a];for(;;){if(this.tokens.mainToken=null,c.pos>t)n.push(c);else{if(this.advanceStack(c,n,e))continue;{s||(s=[],l=[]),s.push(c);let h=this.tokens.getMainToken(c);l.push(h.value,h.end)}}break}}if(!n.length){let a=s&&TP(s);if(a)return Di&&console.log("Finish with "+this.stackID(a)),this.stackToTree(a);if(this.parser.strict)throw Di&&s&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&s){let a=this.stoppedAt!=null&&s[0].pos>this.stoppedAt?s[0]:this.runRecovery(s,l,n);if(a)return Di&&console.log("Force-finish "+this.stackID(a)),this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(n.length>a)for(n.sort((c,h)=>h.score-c.score);n.length>a;)n.pop();n.some(c=>c.reducePos>t)&&this.recovering--}else if(n.length>1){e:for(let a=0;a<n.length-1;a++){let c=n[a];for(let h=a+1;h<n.length;h++){let d=n[h];if(c.sameState(d)||c.buffer.length>500&&d.buffer.length>500)if((c.score-d.score||c.buffer.length-d.buffer.length)>0)n.splice(h--,1);else{n.splice(a--,1);continue e}}}n.length>12&&(n.sort((a,c)=>c.score-a.score),n.splice(12,n.length-12))}this.minStackPos=n[0].pos;for(let a=1;a<n.length;a++)n[a].pos<this.minStackPos&&(this.minStackPos=n[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let s=e.pos,{parser:l}=this,a=Di?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&s>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let d=e.curContext&&e.curContext.tracker.strict,p=d?e.curContext.hash:0;for(let m=this.fragments.nodeAt(s);m;){let b=this.parser.nodeSet.types[m.type.id]==m.type?l.getGoto(e.state,m.type.id):-1;if(b>-1&&m.length&&(!d||(m.prop(Re.contextHash)||0)==p))return e.useNode(m,b),Di&&console.log(a+this.stackID(e)+` (via reuse of ${l.getName(m.type.id)})`),!0;if(!(m instanceof mt)||m.children.length==0||m.positions[0]>0)break;let v=m.children[0];if(v instanceof mt&&m.positions[0]==0)m=v;else break}}let c=l.stateSlot(e.state,4);if(c>0)return e.reduce(c),Di&&console.log(a+this.stackID(e)+` (via always-reduce ${l.getName(c&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let h=this.tokens.getActions(e);for(let d=0;d<h.length;){let p=h[d++],m=h[d++],b=h[d++],v=d==h.length||!n,w=v?e:e.split(),k=this.tokens.mainToken;if(w.apply(p,m,k?k.start:w.pos,b),Di&&console.log(a+this.stackID(w)+` (via ${(p&65536)==0?"shift":`reduce of ${l.getName(p&65535)}`} for ${l.getName(m)} @ ${s}${w==e?"":", split"})`),v)return!0;w.pos>s?t.push(w):n.push(w)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return dO(e,t),!0}}runRecovery(e,t,n){let s=null,l=!1;for(let a=0;a<e.length;a++){let c=e[a],h=t[a<<1],d=t[(a<<1)+1],p=Di?this.stackID(c)+" -> ":"";if(c.deadEnd&&(l||(l=!0,c.restart(),Di&&console.log(p+this.stackID(c)+" (restarted)"),this.advanceFully(c,n))))continue;let m=c.split(),b=p;for(let v=0;v<10&&m.forceReduce()&&(Di&&console.log(b+this.stackID(m)+" (via force-reduce)"),!this.advanceFully(m,n));v++)Di&&(b=this.stackID(m)+" -> ");for(let v of c.recoverByInsert(h))Di&&console.log(p+this.stackID(v)+" (via recover-insert)"),this.advanceFully(v,n);this.stream.end>c.pos?(d==c.pos&&(d++,h=0),c.recoverByDelete(h,d),Di&&console.log(p+this.stackID(c)+` (via recover-delete ${this.parser.getName(h)})`),dO(c,n)):(!s||s.score<m.score)&&(s=m)}return s}stackToTree(e){return e.close(),mt.build({buffer:hd.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(O0||(O0=new WeakMap)).get(e);return t||O0.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function dO(i,e){for(let t=0;t<e.length;t++){let n=e[t];if(n.pos==i.pos&&n.sameState(i)){e[t].score<i.score&&(e[t]=i);return}}e.push(i)}class CP{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}}class fd extends UT{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let c=0;c<e.repeatNodeCount;c++)t.push("");let n=Object.keys(e.topRules).map(c=>e.topRules[c][1]),s=[];for(let c=0;c<t.length;c++)s.push([]);function l(c,h,d){s[c].push([h,h.deserialize(String(d))])}if(e.nodeProps)for(let c of e.nodeProps){let h=c[0];typeof h=="string"&&(h=Re[h]);for(let d=1;d<c.length;){let p=c[d++];if(p>=0)l(p,h,c[d++]);else{let m=c[d+-p];for(let b=-p;b>0;b--)l(c[d++],h,m);d++}}}this.nodeSet=new zb(t.map((c,h)=>bi.define({name:h>=this.minRepeatTerm?void 0:c,id:h,props:s[h],top:n.indexOf(h)>-1,error:h==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(h)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=MT;let a=af(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let c=0;c<this.specializerSpecs.length;c++)this.specialized[c]=this.specializerSpecs[c].term;this.specializers=this.specializerSpecs.map(pO),this.states=af(e.states,Uint32Array),this.data=af(e.stateData),this.goto=af(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(c=>typeof c=="number"?new _o(a,c):c),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let s=new AP(this,e,t,n);for(let l of this.wrappers)s=l(s,e,t,n);return s}getGoto(e,t,n=!1){let s=this.goto;if(t>=s[0])return-1;for(let l=s[t+1];;){let a=s[l++],c=a&1,h=s[l++];if(c&&n)return h;for(let d=l+(a>>1);l<d;l++)if(s[l]==e)return h;if(c)return-1}}hasAction(e,t){let n=this.data;for(let s=0;s<2;s++)for(let l=this.stateSlot(e,s?2:1),a;;l+=3){if((a=n[l])==65535)if(n[l+1]==1)a=n[l=fs(n,l+2)];else{if(n[l+1]==2)return fs(n,l+2);break}if(a==t||a==0)return fs(n,l+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,n=>n==t?!0:null)}allActions(e,t){let n=this.stateSlot(e,4),s=n?t(n):void 0;for(let l=this.stateSlot(e,1);s==null;l+=3){if(this.data[l]==65535)if(this.data[l+1]==1)l=fs(this.data,l+2);else break;s=t(fs(this.data,l+1))}return s}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=fs(this.data,n+2);else break;if((this.data[n+2]&1)==0){let s=this.data[n+1];t.some((l,a)=>a&1&&l==s)||t.push(this.data[n],s)}}return t}configure(e){let t=Object.assign(Object.create(fd.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(n=>{let s=e.tokenizers.find(l=>l.from==n);return s?s.to:n})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((n,s)=>{let l=e.specializers.find(c=>c.from==n.external);if(!l)return n;let a=Object.assign(Object.assign({},n),{external:l.to});return t.specializers[s]=pO(a),a})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map(()=>!1);if(e)for(let l of e.split(" ")){let a=t.indexOf(l);a>=0&&(n[a]=!0)}let s=null;for(let l=0;l<t.length;l++)if(!n[l])for(let a=this.dialects[t[l]],c;(c=this.data[a++])!=65535;)(s||(s=new Uint8Array(this.maxTerm+1)))[c]=1;return new CP(e,n,s)}static deserialize(e){return new fd(e)}}function fs(i,e){return i[e]|i[e+1]<<16}function TP(i){let e=null;for(let t of i){let n=t.p.stoppedAt;(t.pos==t.p.stream.end||n!=null&&t.pos>n)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function pO(i){if(i.external){let e=i.extend?1:0;return(t,n)=>i.external(t,n)<<1|e}return i.get}const EP=1,DP=2,RP=3,gO=4,mO=5,yO=6,MP=7,NP=8,bO=9,LP=10,BP=11,UP=12,jP=13,zP=14,Ri=10,un=32,vO=9,wO=42,SO=47,kO=58,IP=40,PP=41,Xa=61,HP=62,qP=60,VP=64,$P=97,GP=122,KP=84,WP=79,YP=33,xO=65,_O=90;class FP{constructor(){this.inBoneyard=!1}token(e,t){const n=e.pos;if(e.peek(0)===SO&&e.peek(1)===wO&&!this.inBoneyard){this.inBoneyard=!0,e.advance(2),e.acceptToken(UP);return}if(e.peek(0)===wO&&e.peek(1)===SO&&this.inBoneyard){this.inBoneyard=!1,e.advance(2),e.acceptToken(jP);return}if(t.canShift(mO)){let D=0;for(;e.peek(D)!==Ri&&e.peek(D)!==-1;)D++;let W=D;for(;!(e.peek(W)===-1||e.peek(W)!==Ri);){let se=W+1;const Ce=e.peek(se)===vO,fe=e.peek(se)===un&&e.peek(se+1)===un;if(Ce||fe){let J=se;for(;e.peek(J)!==Ri&&e.peek(J)!==-1;)J++;D=J,W=J}else break}e.advance(D),e.acceptToken(mO);return}if(e.peek(0)===qP){let D=1;for(;e.peek(D)===un;)D++;const W=e.peek(D);if(W===Ri||W===-1){e.advance(1),e.acceptToken(BP);return}}if(!(n===0||e.peek(-1)===Ri))return;let l=0;for(;;){const D=e.peek(l);if(D===un||D===vO){l++;continue}if(D===Ri){e.advance(l+1),e.acceptToken(zP);return}break}if(e.peek(0)===HP){e.advance(1),e.acceptToken(LP);return}if(e.peek(0)===Xa&&e.peek(1)!==Xa){e.advance(1),e.acceptToken(NP);return}if(e.peek(0)===Xa&&e.peek(1)===Xa&&e.peek(2)===Xa){const D=e.peek(3);if(D===Ri||D===-1){e.advance(3),e.acceptToken(DP);return}}let a=n,c=-1,h=!1;for(;;){const D=e.peek(a-n);if(D===-1||D===Ri)break;D===kO&&(c=a),D!==un&&c===-1&&(h=!0),a++}if(c!==-1&&h&&t.canShift(gO)){e.advance(c-n+1),e.acceptToken(gO);return}const d=["INT./EXT.","INT/EXT.","INT.","EXT.","I/E."];let p="";for(let D=0;D<10;D++){const W=e.peek(D);if(W===-1)break;p+=String.fromCharCode(W)}for(const D of d)if(p.startsWith(D)){e.advance(D.length),e.acceptToken(bO);return}if(e.peek(0)===46){const D=e.peek(1);if(D!==46&&D!==Ri&&D!==-1&&D!==un){e.advance(1),e.acceptToken(bO);return}}if(e.peek(0)===YP){e.advance(1),e.acceptToken(EP);return}const m=()=>{if(n===0)return!0;let D=e.peek(-2);return D===13&&(D=e.peek(-3)),D===Ri},b=D=>{let W=D;for(e.peek(W-n)===13&&W++,e.peek(W-n)===Ri&&W++;e.peek(W-n)===un;)W++;const se=e.peek(W-n);return se!==Ri&&se!==-1};let v=n,w=!1,k=n,_=-1,O=-1,R=!1;for(;;){const D=e.peek(v-n);if(D===-1||D===Ri)break;D>=$P&&D<=GP&&(w=!0),D!==un&&(k=v+1,O=D,R=!0),D===IP&&_===-1&&(_=v),v++}if(!R)return;let C=!1;if(e.peek(k-n-1)===94){for(C=!0,k--;k>n&&e.peek(k-n-1)===un;)k--;O=e.peek(k-n-1)}if(e.peek(0)===VP&&m()&&b(v)){let D=_!==-1?_:k;for(;D>n&&e.peek(D-n-1)===un;)D--;e.advance(D-n),e.acceptToken(yO);return}if(w)return;if(v-n>3&&e.peek(k-n-3)===KP&&e.peek(k-n-2)===WP&&e.peek(k-n-1)===kO){e.advance(v-n),e.acceptToken(MP);return}const N=e.peek(0),j=e.peek(1);if(N>=xO&&N<=_O&&j>=xO&&j<=_O&&m()&&b(v)&&(_===-1||_!==-1&&O===PP)){let W=_!==-1?_:k;for(;W>n&&e.peek(W-n-1)===un;)W--;C?(e.advance(W-n),e.acceptToken(RP)):(e.advance(W-n),e.acceptToken(yO));return}}}const OO=new FP,XP=new SP(OO.token.bind(OO)),QP=fd.deserialize({version:14,states:".WO!_OROOO!fOPO'#DfO!kOPO'#ClO!sORO'#CtO!sORO'#CvO!sORO'#CxO!sORO'#CzO!sORO'#C}O#_ORO'#CsOOOP'#Cs'#CsO!sORO'#CqOOOP'#Di'#DiO$rORO'#CpO$uORO'#DSO$uORO'#DUO$|ORO'#D]O%UOQO'#DWO%aOQO'#DVO%fOQO'#D[O%qOQO'#DZO%vORO'#D^OOOP'#Do'#DoO&TORO'#DbO$uORO'#DcO&bOQO'#DdO&gOQO'#DeOOOP'#Co'#CoO&lORO'#CnOOOP'#Dg'#DgQQOROOOQOROOO&sOQO,5:QOOOP-E7d-E7dO&xOPO,59WO'fORO,59`OOOP'#Dj'#DjO(UORO,59bO(tORO,59dO)dORO,59fO)kORO,59iO)rORO,59]OOOP-E7g-E7gOOOP,59[,59[O)yORO,59nO*TORO,59pO*bOQO,59oOOOP,59w,59wOOOO'#Dk'#DkO*gOQO,59rO*rORO,59qO*yOQO,59vO*rORO,59uOOOP'#Dm'#DmO+UORO,59xO+cOSO'#D_OOOP,59x,59xO+kOQO,59xO+pORO,59|OOOP-E7m-E7mOOOP,59|,59|O+zORO,59}OOOP,5:O,5:OOOOP,5:P,5:POOOP'#Dh'#DhO,UORO,59YOOOP,59Y,59YOOOP-E7e-E7eOOOP1G/l1G/lOOOP1G.r1G.rO,]ORO1G.zOOOP-E7h-E7hO-ZORO1G.|O.XORO1G/OO/VORO1G/QOOOP1G/T1G/TOOOP1G.w1G.wOOOP1G/Y1G/YOOOP1G/Z1G/ZOOOO-E7i-E7iO0TORO'#DXO!sORO'#DYO0[OQO'#DlO0aORO1G/]O1^ORO1G/aOOOP-E7k-E7kOOOP1G/d1G/dO2ZOQO1G/dOOOO'#Dn'#DnO2`OSO,59yOOOO,59y,59yOOOP1G/h1G/hOOOP1G/i1G/iOOOP-E7f-E7fOOOP1G.t1G.tO2hORO,59tOOOP,5:W,5:WOOOP-E7j-E7jOOOP7+%O7+%OOOOO-E7l-E7lOOOO1G/e1G/eOOOO1G/`1G/`",stateData:"2|~OP]OQiORbOU`OVhOWgOXdOY^O[kO^jOfYOiROkSOmTOoUOpXOrVOtXO!SeO~OSPO~PQOToO~OSPO^qO~O[kOiROkSOmTOoUOpXOrVOtXO~OP!ZXQ!ZXR!ZXU!ZXV!ZXW!ZXX!ZXY!ZX[gX^!ZXagXfgXigXkgXmgXogXpgXrgXtgX!S!ZX!d!ZX~OazOfYO~P!sOZ}Oa!OO~OfYOt!POazX~Oa!RO~OfYOt!POa!OX~Oa!TO~Oa!XOfYO!S!WO~P!sOa!]OfYO!SeO~P!sOa!_O~Oa!`O~O]!cO~PQOa!eO~O^!fO~O[kOkSOmTOoUOpXOrVOtXO~Oi!gO~P&}O[kOiROmTOoUOpXOrVOtXO~Ok!iO~P'mO[kOiROkSOoUOpXOrVOtXO~Om!jO~P(]O[kOiROkSOmTOpXOrVOtXO~Oo!kO~P({Os!lO~P!sOu!mO~P!sOa!nOfYO~P!sOfYOZxaaxa~P!sOa!oO~OfYOt!POaza~Of!rO~P!sOfYOt!POa!Oa~Oa!wOfYO!S!WO~P!sO!S!{O!T!yO~Oa!wO~Oa!|OfYO~P!sOa!}OfYO~P!sO]#PO~PQO[kOahifhiihikhimhiohiphirhithishiuhiZhi!Shi~O[kOajifjiijikjimjiojipjirjitjisjiujiZji!Sji~O[kOalifliiliklimlioliplirlitlisliuliZli!Sli~O[kOanifniiniknimnionipnirnitnisniuniZni!Sni~Oa{X~P!sOa#RO~Of!rOPyiQyiRyiUyiVyiWyiXyiYyi^yi!Syi!dyi]yi~P!sOf!rOP}iQ}iR}iU}iV}iW}iX}iY}i^}i!S}i!d}i]}i~P!sOa#TO~O!S#VO!T!yO~Ou#WO~P!sOrs!Sfukmoitpk~",goto:")n!dPPPPPPPPPPPPPPPP!eP!h#e#n#uP$a%`P%`P%`P%`PP%`PPPP#n#n&V#n&^&e&e#n&k#n#n&rPP#n#n#n#n&x'O'V']'w(r(|)W)^)dRnOUWOmn!kXRSTUVY[]^dfgkrtuvwx{|!R!T!V!Z!^!b!g!i!j!k!q!r!t!u#QUlOmnT!ak!bZjOkmn!blZO[]^fgkmn{|!Z!^!bW!P`b!Q!ST!Ud!VlZO[]^fgkmn{|!Z!^!b!OsRSTUVYrtuvwx!R!T!g!i!j!k!q!r!t!u#QT!Ud!V!iXORSTUVY[]^dfgkmnrtuvwx{|!R!T!V!Z!^!b!q!r!t!u#QZ_Okmn!bZaOkmn!bX!s!R!T!t!uZcOkmn!bQ!YdR!x!VQQORpQSmOnR!dmQ!bkR#O!bY[Okmn!bYy[{|!Z!^Q{]Q|^Q!ZfR!^gSrR!gStS!iSuT!jSvU!kQwVQxY`!hrtuvwx!q#QW!q!R!T!t!uR#Q!rQ!Q`Q!SbT!p!Q!SQ!t!RQ!u!TT#S!t!uQ!VdR!v!VQ!z!WR#U!zYfOkmn!bR![f",nodeNames:" ForceActionMark PageBreak DualCharacter TitleKey TitleValue Character Transition SynopsisMark SceneHeading GreaterThan LessThan BoneStart BoneEnd EmptyLine Screenplay TitlePage Newline Boneyard Element ActionLine LineParenthetical LParen Inline Underline Underscore ItalicBold TripleAsterisks Bold DoubleAsterisks Italic SingleAsterisk PlainText Note NoteStart NoteEnd WhiteSpace RParen ForcedActionLine CenterLine ForceRight CharacterBlock CharacterCue DialogueLine Parenthetical DualCharacterBlock DualCharacterCue ForceTransition SceneHeadingLine SceneNumber SectionMark Numbers SectionLine SynopsisLine TransitionLine PageBreakLine",maxTerm:66,skippedNodes:[0],repeatNodeCount:10,tokenData:"&V~RdOY!aYZ#XZp!apq#^qs!ast$Qtx!axy$Vyz$[z{$a{!P!a!Q![$v![!^!a!_!}!a!}#O%j#P#Q%u#R#S&Q#S;'S!a;'S;=`#R<%lO!aP!fXpPOY!aZs!atx!a{!P!a!Q!^!a!_!}!a#S;'S!a;'S;=`#R<%lO!aP#UP;=`<%l!a~#^Oa~~#eXt~pPOY!aZs!atx!a{!P!a!Q!^!a!_!}!a#S;'S!a;'S;=`#R<%lO!a~$VO!S~~$[Of~~$aOu~~$fPo~z{$i~$nPm~z{$q~$vOk~R$}X!TQpPOY!aZs!atx!a{!P!a!Q!^!a!_!}!a#S;'S!a;'S;=`#R<%lO!a~%mP!}#O%p~%uOr~~%xP#P#Q%{~&QOs~~&VOi~",tokenizers:[XP,0,1],topRules:{Screenplay:[0,15]},tokenPrec:813}),JP=Qf.define({parser:QP}),ZP=new Map([["SceneHeadingLine","cm-fountain-scene"],["ActionLine","cm-fountain-action"],["ForcedActionLine","cm-fountain-action"],["CharacterCue","cm-fountain-character"],["DualCharacterCue","cm-fountain-character"],["Parenthetical","cm-fountain-parenthetical"],["DialogueLine","cm-fountain-dialogue"],["TransitionLine","cm-fountain-transition"],["SectionLine","cm-fountain-section"],["SynopsisLine","cm-fountain-synopsis"]]),AO=i=>{const e=new qn,t=new Map;for(const{from:n,to:s}of i.visibleRanges)Kt(i.state).iterate({from:n,to:s,enter:l=>{const a=ZP.get(l.type.name);if(!a)return;const c=i.state.doc.lineAt(l.from);t.has(c.from)||t.set(c.from,a)}});for(const[n,s]of t.entries())e.add(n,n,ue.line({class:s}));return e.finish()},eH=lt.fromClass(class{constructor(i){this.view=i,this.decorations=AO(i)}decorations;update(i){(i.docChanged||i.viewportChanged)&&(this.decorations=AO(i.view))}},{decorations:i=>i.decorations}),tH=ee.theme({"&":{height:"100vh",backgroundColor:"transparent",color:"#e0e0e0"},".cm-scroller":{overflow:"auto",fontFamily:"'Courier Prime', 'Courier', monospace"},".cm-content":{caretColor:"white",margin:"0 auto",maxWidth:"60ch",paddingLeft:"2.5ch",paddingRight:"2.5ch",paddingTop:"50vh",paddingBottom:"50vh"},".cm-cursor":{borderLeftColor:"white",borderLeftWidth:"2px"},".cm-gutters":{display:"none"},".cm-activeLine":{backgroundColor:"transparent"},".cm-activeLineGutter":{backgroundColor:"transparent"}}),iH=({documentId:i,supabase:e,currentUserEmail:t,onSetIsOwner:n,onAuthRequired:s})=>{const l=ke.useRef(null),[a]=ke.useState(()=>new sl),{status:c,loadDocument:h,saveDocument:d,cancelSave:p}=bP(e,a),[m,b]=ke.useState(!1),[v,w]=ke.useState(!1),[k,_]=ke.useState(!1);return ke.useEffect(()=>{(async()=>{b(!1);const{data:R}=await e.from("documents").select("owner_id, is_public, public_permission").eq("id",i).maybeSingle();if(!R){t?(_(!0),b(!0)):s();return}const C=(await e.auth.getUser()).data.user?.id;if(R.owner_id===C){w(!1),n(!0),b(!0);return}if(n(!1),R.is_public&&R.public_permission==="editor"){w(!1),b(!0);return}if(!t){w(!0),b(!0);return}const{data:N}=await e.from("document_permissions").select("permission_level").eq("document_id",i).eq("user_email",t).single();w(N?N.permission_level==="viewer":!0),b(!0)})()},[i,t]),ke.useEffect(()=>{if(!m||k)return;const O=(R,C)=>{v||C==="remote"||C==="db-load"||d(i)};return a.on("update",O),()=>{a.off("update",O),p()}},[a,i,v,m,k,d,p]),ke.useEffect(()=>{if(!m||k)return;const O=new sP(a,e,i),R=a.getText("codemirror");O.awareness.setLocalStateField("user",{name:t?.split("@")[0]||"Anonymous",color:"#30bced"});const C=je.create({doc:R.toString(),extensions:[jI,tH,JP,eH,je.readOnly.of(v),JI(R,O.awareness),ee.lineWrapping,ee.scrollMargins.of(j=>{const D=j.dom.clientHeight/2;return{top:D-10,bottom:D-10}})]}),N=new ee({state:C,parent:l.current});return h(i),()=>{N.destroy(),O.destroy()}},[i,e,a,m,v,k]),k?K.jsxs("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:20},children:[K.jsx("h2",{style:{color:"#e0e0e0"},children:"Access Denied"}),K.jsx("p",{style:{color:"#888"},children:"You do not have permission to view this screenplay."}),K.jsx("a",{href:"/",style:{color:"#30bced"},children:"Back to Home"})]}):m?K.jsxs(K.Fragment,{children:[K.jsx("div",{ref:l,style:{width:"100%",height:"100vh",outline:"none"}}),K.jsx("div",{style:{position:"fixed",bottom:20,right:20,color:"#666",fontFamily:"sans-serif",fontSize:"12px",pointerEvents:"none"},children:v?"Read Only":K.jsxs(K.Fragment,{children:[c==="loading"&&"Loading...",c==="saving"&&"Saving...",c==="saved"&&"Saved",c==="error"&&"Sync Error"]})})]}):K.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:"Loading screenplay..."})},nH=({supabase:i})=>{const[e,t]=ke.useState(!1),[n,s]=ke.useState(""),[l,a]=ke.useState(""),[c,h]=ke.useState(!0),[d,p]=ke.useState(""),m=async b=>{b.preventDefault(),t(!0),p("");try{if(c){const{error:v}=await i.auth.signInWithPassword({email:n,password:l});if(v)throw v}else{const{error:v}=await i.auth.signUp({email:n,password:l});if(v)throw v;p("Check your email for the login link!")}}catch(v){p(v.message)}finally{t(!1)}};return K.jsxs("div",{className:"auth-container",children:[K.jsx("h1",{className:"auth-title",children:"Screenplay Editor"}),K.jsxs("form",{onSubmit:m,className:"auth-form",children:[K.jsx("input",{className:"auth-input",type:"email",placeholder:"Email",value:n,onChange:b=>s(b.target.value),required:!0}),K.jsx("input",{className:"auth-input",type:"password",placeholder:"Password",value:l,onChange:b=>a(b.target.value),required:!0}),K.jsx("button",{type:"submit",disabled:e,className:"auth-button",children:e?"Processing...":c?"Log In":"Sign Up"})]}),K.jsx("p",{className:"auth-toggle",onClick:()=>h(!c),children:c?"Need an account? Sign Up":"Have an account? Log In"}),d&&K.jsx("p",{className:"auth-error",children:d})]})},sH=({supabase:i,userId:e,onOpenDocument:t,onShare:n,onClose:s})=>{const[l,a]=ke.useState([]),[c,h]=ke.useState(!0),[d,p]=ke.useState(""),[m,b]=ke.useState(null),[v,w]=ke.useState("");ke.useEffect(()=>{k()},[]);const k=async()=>{const{data:N}=await i.from("documents").select("id, title, updated_at, owner_id, is_public").order("updated_at",{ascending:!1});N&&a(N),h(!1)},_=async()=>{if(!d.trim())return;const{data:N}=await i.from("documents").insert({title:d,owner_id:e,content:"",is_public:!1}).select().single();N&&t(N.id)},O=async(N,j)=>{j.stopPropagation(),confirm("Are you sure?")&&(await i.from("documents").delete().eq("id",N),k())},R=(N,j)=>{N.stopPropagation(),j.owner_id===e&&(b(j.id),w(j.title))},C=async N=>{v.trim()&&(await i.from("documents").update({title:v}).eq("id",N),b(null),k())};return K.jsx("div",{className:"dashboard-overlay",children:K.jsxs("div",{className:"dashboard-modal",children:[K.jsxs("div",{className:"dashboard-header",children:[K.jsx("h2",{children:"My Screenplays"}),K.jsx("button",{onClick:s,className:"dashboard-close",children:"Close"})]}),K.jsxs("div",{className:"dashboard-create-row",children:[K.jsx("input",{className:"dashboard-input",value:d,onChange:N=>p(N.target.value),placeholder:"New Screenplay Title...",onKeyDown:N=>N.key==="Enter"&&_()}),K.jsx("button",{onClick:_,className:"dashboard-create-btn",children:"Create"})]}),c?K.jsx("p",{style:{color:"#666"},children:"Loading..."}):K.jsxs("div",{className:"dashboard-list",children:[l.map(N=>K.jsxs("div",{className:"dashboard-item",onClick:()=>t(N.id),children:[K.jsxs("div",{className:"item-meta",style:{flex:1},children:[m===N.id?K.jsx("input",{autoFocus:!0,className:"dashboard-input",value:v,onChange:j=>w(j.target.value),onBlur:()=>C(N.id),onKeyDown:j=>j.key==="Enter"&&C(N.id),onClick:j=>j.stopPropagation()}):K.jsxs("div",{className:"item-title",title:N.owner_id===e?"Double click to rename":"Shared with you",onDoubleClick:j=>R(j,N),children:[N.title,N.owner_id!==e&&K.jsx("span",{style:{fontSize:"0.7rem",opacity:.6,marginLeft:8},children:" (Shared)"})]}),K.jsx("div",{className:"item-date",children:new Date(N.updated_at).toLocaleDateString()})]}),K.jsxs("div",{style:{display:"flex",gap:"10px"},children:[N.owner_id===e&&K.jsx("button",{className:"item-delete-btn",style:{color:"#30bced",fontSize:"1rem"},onClick:j=>{j.stopPropagation(),n(N.id)},title:"Share",children:"Share"}),N.owner_id===e&&K.jsx("button",{className:"item-delete-btn",onClick:j=>O(N.id,j),title:"Delete",children:""})]})]},N.id)),l.length===0&&K.jsx("p",{className:"dashboard-empty",children:"No scripts found."})]})]})})},rH=({onOpenDashboard:i,onShare:e,isOwner:t})=>K.jsxs("div",{style:{position:"fixed",top:20,left:20,zIndex:50,display:"flex",gap:"10px"},children:[K.jsx("button",{onClick:i,style:{background:"#333",color:"white",border:"none",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",opacity:.7},children:" Files"}),t&&K.jsx("button",{onClick:e,style:{background:"#333",color:"#30bced",border:"none",padding:"8px 12px",borderRadius:"4px",cursor:"pointer",opacity:.7},children:"Share"})]}),lH=({supabase:i,documentId:e,currentUserEmail:t,onClose:n})=>{const[s,l]=ke.useState(!1),[a,c]=ke.useState("viewer"),[h,d]=ke.useState([]),[p,m]=ke.useState(""),[b,v]=ke.useState("editor"),[w,k]=ke.useState(!0),[_,O]=ke.useState(""),[R,C]=ke.useState("Copy link"),N=`${window.location.origin}${window.location.pathname}?id=${e}`;ke.useEffect(()=>{j()},[e]);const j=async()=>{k(!0);const{data:F}=await i.from("documents").select("is_public, public_permission").eq("id",e).single();F&&(l(F.is_public),c(F.public_permission));const{data:re}=await i.from("document_permissions").select("*").eq("document_id",e);re&&d(re),k(!1)},H=async F=>{F.target.value==="restricted"?(l(!1),await i.from("documents").update({is_public:!1}).eq("id",e)):(l(!0),await i.from("documents").update({is_public:!0}).eq("id",e))},D=async F=>{const re=F.target.value;c(re),await i.from("documents").update({public_permission:re}).eq("id",e)},W=async F=>{if(F.preventDefault(),!p.trim())return;if(p===t){O("You are the owner."),setTimeout(()=>O(""),2e3);return}const{error:re}=await i.from("document_permissions").insert({document_id:e,user_email:p.trim(),permission_level:b});re?O(re.message.includes("unique")?"User already added.":re.message):(O(`Added ${p}`),m(""),j()),setTimeout(()=>O(""),3e3)},se=async(F,re)=>{await i.from("document_permissions").update({permission_level:re}).eq("document_id",e).eq("user_email",F),j()},Ce=async F=>{await i.from("document_permissions").delete().eq("document_id",e).eq("user_email",F),j()},fe=()=>{navigator.clipboard.writeText(N),C("Link copied"),setTimeout(()=>C("Copy link"),2e3)},J=F=>F.substring(0,2).toUpperCase();return K.jsx("div",{className:"dashboard-overlay",children:K.jsxs("div",{className:"google-modal",children:[K.jsxs("div",{className:"google-modal-header",children:[K.jsx("h2",{children:'Share "Untitled Screenplay"'}),K.jsx("div",{className:"header-actions",children:K.jsx("button",{className:"icon-btn",onClick:n,children:""})})]}),w?K.jsx("div",{style:{padding:20},children:"Loading..."}):K.jsxs("div",{className:"google-modal-content",children:[K.jsxs("div",{className:"add-people-section",children:[K.jsxs("form",{onSubmit:W,className:"add-people-form",children:[K.jsx("input",{type:"email",placeholder:"Add people and groups",value:p,onChange:F=>m(F.target.value),className:"google-input"}),K.jsxs("select",{value:b,onChange:F=>v(F.target.value),className:"role-select-simple",children:[K.jsx("option",{value:"editor",children:"Editor"}),K.jsx("option",{value:"viewer",children:"Viewer"})]}),K.jsx("button",{type:"submit",className:"google-primary-btn",disabled:!p,children:"Send"})]}),_&&K.jsx("div",{className:"toast-msg",children:_})]}),K.jsxs("div",{className:"people-list-section",children:[K.jsx("div",{className:"section-label",children:"People with access"}),K.jsxs("div",{className:"person-row",children:[K.jsx("div",{className:"avatar-circle",children:J(t||"Me")}),K.jsxs("div",{className:"person-info",children:[K.jsxs("div",{className:"person-name",children:[t," (you)"]}),K.jsx("div",{className:"person-email",children:"Owner"})]}),K.jsx("div",{className:"person-role owner-label",children:"Owner"})]}),h.map(F=>K.jsxs("div",{className:"person-row",children:[K.jsx("div",{className:"avatar-circle",children:J(F.user_email)}),K.jsx("div",{className:"person-info",children:K.jsx("div",{className:"person-name",children:F.user_email})}),K.jsxs("div",{className:"role-dropdown-container",children:[K.jsxs("select",{value:F.permission_level,onChange:re=>se(F.user_email,re.target.value),className:"role-select-ghost",children:[K.jsx("option",{value:"viewer",children:"Viewer"}),K.jsx("option",{value:"editor",children:"Editor"})]}),K.jsx("button",{className:"remove-btn",onClick:()=>Ce(F.user_email),children:""})]})]},F.id))]}),K.jsxs("div",{className:"general-access-section",children:[K.jsx("div",{className:"section-label",children:"General access"}),K.jsxs("div",{className:"access-row",children:[K.jsx("div",{className:"access-icon-circle",children:s?"":""}),K.jsxs("div",{className:"access-info",children:[K.jsxs("select",{value:s?"public":"restricted",onChange:H,className:"access-select",children:[K.jsx("option",{value:"restricted",children:"Restricted"}),K.jsx("option",{value:"public",children:"Anyone with the link"})]}),K.jsx("div",{className:"access-desc",children:s?"Anyone on the internet with the link can view":"Only people with access can open with the link"})]}),s&&K.jsx("div",{className:"role-dropdown-container",children:K.jsxs("select",{value:a,onChange:D,className:"role-select-ghost",style:{fontWeight:500,color:"#e0e0e0"},children:[K.jsx("option",{value:"viewer",children:"Viewer"}),K.jsx("option",{value:"editor",children:"Editor"})]})})]})]}),K.jsxs("div",{className:"google-modal-footer",children:[K.jsxs("button",{className:"copy-link-btn",onClick:fe,children:[K.jsx("span",{style:{marginRight:8},children:""}),R]}),K.jsx("button",{className:"google-done-btn",onClick:n,children:"Done"})]})]})]})})},Jl=cL("https://kktvjaujpqejxiqvopwa.supabase.co","sb_publishable_mE97Q9kBgo-eulQGtx3HHw_ur0aFNh4",{realtime:{params:{eventsPerSecond:10}}});function oH(){const[i,e]=ke.useState(null),[t,n]=ke.useState(null),[s,l]=ke.useState(!1),[a,c]=ke.useState(!1),[h,d]=ke.useState(null),[p,m]=ke.useState(!1),[b,v]=ke.useState(!1);ke.useEffect(()=>{Jl.auth.getSession().then(({data:{session:R}})=>{e(R);const N=new URLSearchParams(window.location.search).get("id");N?n(N):R&&l(!0)});const{data:{subscription:O}}=Jl.auth.onAuthStateChange((R,C)=>{e(C),v(!1)});return()=>O.unsubscribe()},[]);const w=O=>{n(O),l(!1);const R=`${window.location.pathname}?id=${O}`;window.history.pushState({path:R},"",R)},k=O=>{d(O),c(!0)};return b||!i&&!t?K.jsxs(K.Fragment,{children:[b&&K.jsx("div",{style:{position:"absolute",top:0,width:"100%",background:"#ee6352",color:"white",textAlign:"center",padding:"10px",fontSize:"0.9rem"},children:"This document is private. Please log in to view."}),K.jsx(nH,{supabase:Jl})]}):K.jsxs("div",{className:"App",children:[i&&t&&K.jsx(rH,{onOpenDashboard:()=>l(!0),onShare:()=>k(t),isOwner:p}),t?K.jsx(iH,{documentId:t,supabase:Jl,currentUserEmail:i?.user?.email,onSetIsOwner:m,onAuthRequired:()=>v(!0)},t):K.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:K.jsx("button",{onClick:()=>l(!0),className:"dashboard-create-btn",children:"Open Dashboard"})}),i&&s&&K.jsx(sH,{supabase:Jl,userId:i.user.id,onOpenDocument:w,onShare:k,onClose:()=>{t&&l(!1)}}),i&&a&&h&&K.jsx(lH,{supabase:Jl,documentId:h,currentUserEmail:i.user.email,onClose:()=>{c(!1),d(null)}})]})}LR.createRoot(document.getElementById("root")).render(K.jsx(ke.StrictMode,{children:K.jsx(oH,{})}));
